(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    341645,       7993]
NotebookOptionsPosition[    297362,       7375]
NotebookOutlinePosition[    325384,       7714]
CellTagsIndexPosition[    325031,       7703]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Just launch the code below to run the notebook (shift+enter)", "Title",
 CellChangeTimes->{{3.8934376452895875`*^9, 
  3.8934376644509068`*^9}},ExpressionUUID->"cc091cd5-168d-44d1-9a83-\
ebb576c10ceb"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ParallelEvaluate", "[", 
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BlockEvaluation", "[", "tag_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nb", "=", 
      RowBox[{"EvaluationNotebook", "[", "]"}]}], ";", "\n", 
     RowBox[{"NotebookFind", "[", 
      RowBox[{"nb", ",", "tag", ",", "All", ",", "CellTags"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CloseKernels", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LaunchKernels", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"infoDialog", "[", "phrase_", "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<Proceed\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DirectoryQ", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<Auxiliary data\>\""}], "}"}], "]"}], "]"}], "//", 
       "ToString"}], ")"}], "\[Equal]", "\"\<False\>\""}], ",", 
    RowBox[{"CreateDirectory", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<Auxiliary data\>\""}], "}"}], "]"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"choiceslist", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<Tabulated Nevents+sensitivity\>\"", ",", 
     "\"\<Sensitivity only (tabulated Nevents must be produced before)\>\"", 
     ",", "\"\<Acceptance\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"taglist", "[", "\"\<Acceptance\>\"", "]"}], "=", 
   "\"\<Acceptance\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"taglist", "[", "\"\<Tabulated Nevents+sensitivity\>\"", "]"}], 
   "=", "\"\<Number-of-events+sensitivity\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "taglist", "[", 
    "\"\<Sensitivity only (tabulated Nevents must be produced before)\>\"", 
    "]"}], "=", "\"\<Sensitivity\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"computationchoice", "=", 
   RowBox[{"dropdownDialog", "[", 
    RowBox[{
    "choiceslist", ",", 
     "\"\<Do you want to compute the tabulated number of events and then \
sensitivity, or just sensitivity (if the tabulated number of events has been \
already produced)?\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"tagselected", "=", 
  RowBox[{"taglist", "[", "computationchoice", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"BlockEvaluation", "[", "tagselected", "]"}]}], "Input",
 CellChangeTimes->{{3.893437585709897*^9, 3.8934375895369635`*^9}, {
   3.8934376329497385`*^9, 3.893437658846809*^9}, 3.893573113541499*^9, {
   3.89366535580302*^9, 3.8936653565596275`*^9}, {3.895053865536884*^9, 
   3.8950538657696643`*^9}, {3.895127061998116*^9, 3.8951270800527506`*^9}, 
   3.9025629436017327`*^9, 3.9027295382725515`*^9, 3.9028895266343613`*^9, {
   3.9038925204404736`*^9, 3.903892532444302*^9}, {3.914139991725472*^9, 
   3.91413999190073*^9}, 3.9146675649309025`*^9, {3.915682933598644*^9, 
   3.9156829349465213`*^9}, {3.916821955899866*^9, 3.9168219561608887`*^9}, {
   3.9170215754755774`*^9, 3.917021575681873*^9}},
 CellLabel->
  "In[239]:=",ExpressionUUID->"c8a7c6bd-754e-4c81-b344-1b6f8cd06de4"]
}, Closed]],

Cell[CellGroupData[{

Cell["Definitions", "Title",
 CellChangeTimes->{{3.8765025649423122`*^9, 3.876502598054132*^9}, {
  3.876502741347786*^9, 3.876502742695223*^9}, {3.876503237989088*^9, 
  3.876503241621973*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"294691d8-aa8b-4eec-b72c-\
7eddbed8edd7"],

Cell[CellGroupData[{

Cell["Various directories", "Chapter",
 CellChangeTimes->{{3.913804059957842*^9, 3.913804062327417*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"961be1c9-94c9-4c1d-89d7-\
f8d7b8cbf72d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"LLPdirName", "=", "\"\<DP\>\""}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Set", " ", "the", " ", "directory", " ", "for", " ", "the", " ", "search",
     " ", "where", " ", "tabulated", " ", "acceptances", " ", "are", " ", 
    "located"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"directory", "[", "\"\<Acceptances\>\"", "]"}], "=", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Acceptances\>\""}], 
      "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Set", " ", "the", " ", "directory", " ", "for", " ", "the", " ", 
     "search", " ", "where", " ", "tabulated", " ", "angle"}], "-", 
    RowBox[{"energy", " ", "distributions", " ", "are", " ", "located"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"directory", "[", "\"\<Distribution\>\"", "]"}], "=", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", 
       "\"\<spectra/New physics particles spectra\>\"", ",", "LLPdirName"}], 
      "}"}], "]"}]}], ";"}], " ", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "directory", " ", "storing", " ", "production", " ", "weights",
     " ", "of", " ", "the", " ", "given", " ", "LLP"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"directory", "[", "\"\<Production weights\>\"", "]"}], "=", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<phenomenology\>\"", 
       ",", "LLPdirName", ",", "\"\<Production probabilities\>\""}], "}"}], 
     "]"}]}], ";"}], " ", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Directory", " ", "to", " ", "which", " ", "various", " ", "auxillary", 
    " ", "datasets", " ", "will", " ", "be", " ", "stored"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"directory", "[", "\"\<Auxiliary\>\"", "]"}], "=", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Auxiliary data\>\"",
        ",", "LLPdirName"}], "}"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"!", 
      RowBox[{"DirectoryQ", "[", 
       RowBox[{"directory", "[", "\"\<Auxiliary\>\"", "]"}], "]"}]}], ",", 
     RowBox[{"CreateDirectory", "[", 
      RowBox[{"directory", "[", "\"\<Auxiliary\>\"", "]"}], "]"}]}], "]"}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Directory", " ", "containing", " ", "decay", " ", "widths", " ", "of", 
    " ", "the", " ", "LLPs"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"directory", "[", "\"\<Decays\>\"", "]"}], "=", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<phenomenology\>\"", 
       ",", "LLPdirName", ",", "\"\<decay widths\>\""}], "}"}], "]"}]}], 
   ";"}], " "}]}], "Input",
 CellChangeTimes->{{3.913804080271287*^9, 3.913804171309696*^9}, {
   3.913804205284999*^9, 3.913804380241178*^9}, {3.9138103204454637`*^9, 
   3.9138103216469903`*^9}, 3.9138295316757774`*^9, {3.9138664030078764`*^9, 
   3.9138664044074554`*^9}, {3.913871718367205*^9, 3.9138717189543257`*^9}, {
   3.9138854890993285`*^9, 3.9138854893084154`*^9}, {3.91564305953752*^9, 
   3.915643059559283*^9}},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->
  "In[254]:=",ExpressionUUID->"7e8395d1-58ed-4ab9-b1bf-c7ebe3e9a552"]
}, Closed]],

Cell[CellGroupData[{

Cell["Parameters and critical definitions", "Chapter",
 CellChangeTimes->{{3.8765032665997076`*^9, 3.876503268324252*^9}, 
   3.8867405532570024`*^9, {3.913886938897626*^9, 3.91388694220303*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"cf63fabc-7a3b-4498-8bf8-\
f69a301f20dc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"infoDialog", "[", "phrase_", "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<Proceed\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"selectionDialog", "[", 
    RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
   RowBox[{"DialogInput", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"choice", "=", 
       RowBox[{"{", "}"}]}], "}"}], ",", 
     RowBox[{"Column", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", "phrase", "}"}], "]"}], ",", 
        RowBox[{"Pane", "[", 
         RowBox[{
          RowBox[{"TogglerBar", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list", ",", 
            RowBox[{"Appearance", "->", 
             RowBox[{"\"\<Vertical\>\"", "->", 
              RowBox[{"{", 
               RowBox[{"Automatic", ",", "5"}], "}"}]}]}]}], "]"}], ",", 
          RowBox[{"ImageSize", "->", 
           RowBox[{"{", 
            RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], ",", 
          RowBox[{"Scrollbars", "->", 
           RowBox[{"{", 
            RowBox[{"False", ",", "True"}], "}"}]}]}], "]"}], ",", 
        RowBox[{"Button", "[", 
         RowBox[{"\"\<OK\>\"", ",", 
          RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
      "]"}]}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Conversion", " ", "units"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GeVMinusOneTom", "=", 
   RowBox[{"2", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "16"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"chbarval", "=", 
    RowBox[{"3", "*", 
     SuperscriptBox["10", "8"], "*", "6.58", "*", 
     SuperscriptBox["10", 
      RowBox[{"-", "25"}]]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"EM", " ", "coupling"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Alpha]EM", "=", 
    RowBox[{"1", "/", "137"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Mesons", " ", "masses"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"mSM", "[", "\"\<Rho0\>\"", "]"}], ",", 
     RowBox[{"mSM", "[", "\"\<Pi0\>\"", "]"}], ",", 
     RowBox[{"mSM", "[", "\"\<Eta\>\"", "]"}], ",", 
     RowBox[{"mSM", "[", "\"\<EtaPr\>\"", "]"}], ",", 
     RowBox[{"mSM", "[", "\"\<p\>\"", "]"}]}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"0.775", ",", "0.135", ",", "0.547", ",", "0.958", ",", "0.939"}],
     "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalGamma]SM", "[", "\"\<\[Rho]780\>\"", "]"}], "=", 
   "0.149"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]pNucleonInpb", "[", "Atarget_", "]"}], "=", 
   RowBox[{"51", "*", 
    SuperscriptBox["Atarget", 
     RowBox[{"-", "0.29"}]], "*", 
    SuperscriptBox["10", "9"]}]}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQB2IQfXJKx6frD984TpX/B6aV+ay5bgJpL5cGbhD985VM
V9zXN47lN9X6QHRm1uZdIPqZ9IPdIJp/WS5nPJBWWbAGTH+xU0xIANJZYVPz
QXRi5d5SED3rc3sZiP5RnN8Mom2vHG0B0XeF93WB6ICJzt0gesLXlBnpQHrR
XqGZIFpCbdoWEP0hxXQ7iJariXkGou8djQPTKTLqKzKAtLlo6GoQXcB0oU3p
zxvH91JXwLT37/gER6a3jn4TgnJB9L4puatAdMSmtLUgusZL+NZuIO0Sbw2m
Bcwsn25heeu4I2E1mI663OEQzP7WkYNxDph+16P0TkXzreOWX+5fQfQ25xoP
VSB9+UKSJ4i2jVo2C0SnTWWbDaLjrPR3qQNpvb2mYBoAv3fACw==
  "],
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->
  "In[261]:=",ExpressionUUID->"2c1cafc9-37d9-434e-bd2d-c0787bc6f55b"]
}, Closed]],

Cell[CellGroupData[{

Cell["LLP phenomenology: production probabilities, decay widths", "Chapter",
 CellChangeTimes->{{3.835270415198964*^9, 3.8352704154970675`*^9}, {
   3.854441650570236*^9, 3.8544416515373263`*^9}, {3.885016402104937*^9, 
   3.8850164030053596`*^9}, 3.885019196491799*^9, {3.885019273945055*^9, 
   3.88501928458453*^9}, {3.9137189927638807`*^9, 3.9137190046798325`*^9}, {
   3.913885745903579*^9, 3.9138857697080164`*^9}, 3.913954281288325*^9, 
   3.9156430595706387`*^9},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"94b059cc-5312-4be8-9749-\
b24e1b58194e"],

Cell[CellGroupData[{

Cell["Production probabilities", "Section",
 CellChangeTimes->{{3.826713169183443*^9, 3.8267131698544655`*^9}, {
  3.885138658855132*^9, 3.8851386649516826`*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"8f111b29-8491-4838-ab0f-\
75131d945ac9"],

Cell[CellGroupData[{

Cell["Via decays of mesons", "Subsection",
 CellChangeTimes->{{3.8867412989661756`*^9, 3.8867413212030272`*^9}, 
   3.9341784414069138`*^9, {3.934603115035019*^9, 3.9346031150669155`*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"5ab83283-5bb4-4ea2-aaa0-\
a73f4f043e82"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PmotherToLLP", "//", "Clear"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Production", " ", "from", " ", "decays", " ", "of", " ", "mesons", " ", 
    "and", " ", "mixing", " ", "with", " ", 
    SuperscriptBox["\[Rho]", "0"]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Br\[Pi]To\[Gamma]\[Gamma]", "=", "0.98799"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Br\[Eta]To\[Gamma]\[Gamma]", "=", "0.3931181"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Br\[Omega]To\[Pi]\[Gamma]", "=", "0.0834941"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Br\[Eta]prTo\[Gamma]\[Gamma]", "=", "0.0219297"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Br\[Pi]0ToV", "[", "mLLP_", "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"mLLP", "<", 
      RowBox[{"mSM", "[", "\"\<Pi0\>\"", "]"}]}], ",", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"2", "*", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           SuperscriptBox["mLLP", "2"], "/", 
           SuperscriptBox[
            RowBox[{"mSM", "[", "\"\<Pi0\>\"", "]"}], "2"]}]}], ")"}], "3"], 
       "*", "Br\[Pi]To\[Gamma]\[Gamma]"}], "]"}], ",", "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Br\[Eta]ToV", "[", "mLLP_", "]"}], "=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"mLLP", "<", 
       RowBox[{"mSM", "[", "\"\<Eta\>\"", "]"}]}], ",", 
      RowBox[{"Evaluate", "[", 
       RowBox[{"2", "*", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{
            SuperscriptBox["mLLP", "2"], "/", 
            SuperscriptBox[
             RowBox[{"mSM", "[", "\"\<Eta\>\"", "]"}], "2"]}]}], ")"}], "3"], 
        "*", "Br\[Eta]To\[Gamma]\[Gamma]"}], "]"}], ",", "0"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Br\[Omega]ToV", "[", "mLLP_", "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"mLLP", "<", 
        RowBox[{"m\[Omega]", "-", "m\[Pi]0"}]}], ",", 
       RowBox[{"Br\[Omega]To\[Pi]\[Gamma]", "*", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["m\[Omega]", "2"], "-", 
           SuperscriptBox["mLLP", "2"], "-", 
           SuperscriptBox["m\[Pi]0", "2"]}], ")"}], "2"], "*", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["m\[Omega]", "2"], "-", 
              SuperscriptBox["mLLP", "2"], "+", 
              SuperscriptBox["m\[Pi]0", "2"]}], ")"}], "2"], "-", 
           RowBox[{"4", "*", 
            SuperscriptBox["m\[Omega]", "2"], "*", 
            SuperscriptBox["m\[Pi]0", "2"]}]}], "]"}], "/", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["m\[Omega]", "2"], "-", 
            SuperscriptBox["mLLP", "2"]}], ")"}], "3"]}]}], ",", "0"}], 
      "]"}]}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Br\[Eta]prToV", "[", "mLLP_", "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"mLLP", "<", 
      RowBox[{"mSM", "[", "\"\<EtaPr\>\"", "]"}]}], ",", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"2", "*", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           SuperscriptBox["mLLP", "2"], "/", 
           SuperscriptBox[
            RowBox[{"mSM", "[", "\"\<EtaPr\>\"", "]"}], "2"]}]}], ")"}], "3"],
        "*", "Br\[Eta]prTo\[Gamma]\[Gamma]"}], "]"}], ",", "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"BrDecay", "[", 
      RowBox[{"mLLP_", ",", "\[Epsilon]2_", ",", "\"\<Pi0\>\""}], "]"}], ",", 
     RowBox[{"BrDecay", "[", 
      RowBox[{"mLLP_", ",", "\[Epsilon]2_", ",", "\"\<Eta\>\""}], "]"}], ",", 
     RowBox[{"BrDecay", "[", 
      RowBox[{"mLLP_", ",", "\[Epsilon]2_", ",", "\"\<EtaPr\>\""}], "]"}]}], 
    "}"}], "=", 
   RowBox[{"\[Epsilon]2", "*", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Br\[Pi]0ToV", "[", "mLLP", "]"}], ",", 
      RowBox[{"Br\[Eta]ToV", "[", "mLLP", "]"}], ",", 
      RowBox[{"Br\[Eta]prToV", "[", "mLLP", "]"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FacilitiesList", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<SPS\>\"", ",", "\"\<FermilabBD\>\"", ",", "\"\<LHC\>\"", ",", 
     "\"\<FCC-hh\>\"", ",", "\"\<Serpukhov\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"PmotherToLLP", "[", 
      RowBox[{"mLLP_", ",", "\[Epsilon]2_", ",", "part", ",", "Facility"}], 
      "]"}], "=", 
     RowBox[{"BrDecay", "[", 
      RowBox[{"mLLP", ",", "\[Epsilon]2", ",", "part"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"part", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Pi0\>\"", ",", "\"\<Eta\>\"", ",", "\"\<EtaPr\>\""}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.886741324632948*^9, 3.88674133750587*^9}, {
   3.886743349704631*^9, 3.886743469951105*^9}, {3.8867435208363976`*^9, 
   3.886743559442109*^9}, {3.8867436030673923`*^9, 3.8867436380024014`*^9}, {
   3.886743677147029*^9, 3.886743791056388*^9}, {3.886759023397938*^9, 
   3.886759051632529*^9}, {3.886759084894906*^9, 3.886759102806116*^9}, {
   3.886759322833825*^9, 3.886759324091713*^9}, {3.8867597957163935`*^9, 
   3.886760018253701*^9}, {3.8867600560403585`*^9, 3.8867601972064524`*^9}, {
   3.8867608717265434`*^9, 3.886760928433196*^9}, {3.8902877382139034`*^9, 
   3.8902877885168395`*^9}, {3.890287908819491*^9, 3.8902879384574685`*^9}, 
   3.890287972630889*^9, {3.892180139844576*^9, 3.8921801533898745`*^9}, {
   3.895134860239647*^9, 3.8951348618856735`*^9}, {3.913885646039929*^9, 
   3.9138856461076612`*^9}, {3.913886132582429*^9, 3.9138862291902003`*^9}, {
   3.9138862898048983`*^9, 3.913886296467663*^9}, {3.9138863354750943`*^9, 
   3.913886444520909*^9}, {3.913886535421424*^9, 3.9138865559413123`*^9}, {
   3.9138866804744043`*^9, 3.91388669116334*^9}, {3.9138867279182673`*^9, 
   3.913886743667845*^9}, {3.913886776305146*^9, 3.913886808473711*^9}, 
   3.913891300284439*^9, {3.9138914285753727`*^9, 3.9138914308549423`*^9}, {
   3.9140569592224464`*^9, 3.914057049571749*^9}, {3.91405713461141*^9, 
   3.9140573182167463`*^9}, {3.9140575578723235`*^9, 
   3.9140575965440426`*^9}, {3.9140576438565454`*^9, 3.91405766710573*^9}, {
   3.914066702491934*^9, 3.9140667055321317`*^9}, {3.9156430596213613`*^9, 
   3.9156430599242363`*^9}, {3.9168531211335497`*^9, 3.9168531508029346`*^9}, 
   3.916853392897682*^9, {3.9183726881038265`*^9, 3.9183726890585165`*^9}, {
   3.9304926142034054`*^9, 3.930492627348414*^9}, {3.930492673679298*^9, 
   3.930492677532892*^9}, {3.9304929656803293`*^9, 3.9304930113803177`*^9}, {
   3.9304931130163293`*^9, 3.93049322093799*^9}, {3.9304932649586377`*^9, 
   3.9304933298752604`*^9}, 3.9304934971411295`*^9, {3.9304935941993275`*^9, 
   3.9304935978649535`*^9}, {3.930493636619055*^9, 3.9304936428913436`*^9}, {
   3.9341783445584946`*^9, 3.934178375802986*^9}, {3.934178508184925*^9, 
   3.934178544741392*^9}, {3.9344710519821224`*^9, 3.9344710525668373`*^9}, {
   3.934473043593466*^9, 3.9344730438118114`*^9}, {3.934521371622252*^9, 
   3.9345213764502163`*^9}},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->
  "In[270]:=",ExpressionUUID->"70174eea-746d-446e-811b-01df40fa5c0d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Via Drell-Yan", "Subsection",
 CellChangeTimes->{{3.934178450342802*^9, 3.9341784530070715`*^9}},
 CellTags->{
  "Number-of-events+sensitivity", 
   "Acceptance"},ExpressionUUID->"3dd26efe-80ed-4e5e-8b82-2282c4bc12b1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "___", "___", "___", "___", "___", "___", "___", "___", "___", "__"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Production", " ", "from", " ", "Drell"}], "-", 
    RowBox[{"Yan", " ", "process"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "___", "___", "___", "___", "___", "___", "___", "___", "___", "__"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Average", " ", "enhancement", " ", "LO", " ", "vs", " ", "LO"}], 
    "+", 
    RowBox[{
    "NLO", " ", "obtained", " ", "for", " ", "SPS", " ", "energies", " ", 
     "in", " ", "2011.05115"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"kfactorNLO", "=", "1.7"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]DrellYanData", "[", "Facility_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dat", "=", 
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"directory", "[", "\"\<Production weights\>\"", "]"}], 
             ",", 
             RowBox[{
             "\"\<sigmaDrellYan_DP_\>\"", "<>", "Facility", "<>", 
              "\"\<.txt\>\""}]}], "}"}], "]"}], ",", "\"\<Table\>\""}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MinMaxMassesDrellYan", "[", "Facility", "]"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Min", "[", 
           RowBox[{"dat", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"Max", "[", 
           RowBox[{"dat", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"int", "[", "ma_", "]"}], "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"MinMaxMassesDrellYan", "[", "Facility", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", " ", "ma", 
           "\[LessEqual]", 
           RowBox[{
            RowBox[{"MinMaxMassesDrellYan", "[", "Facility", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Interpolation", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Log10", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Log10", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "90"}]]}], "]"}]}], "}"}], "&"}], "/@", 
                 "dat"}], ",", 
                RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
              RowBox[{"Log10", "[", "ma", "]"}], "]"}], ")"}]}], "]"}], ",", 
          "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"PmotherToLLP", "[", 
         RowBox[{
         "mLLP_", ",", "\[Epsilon]2_", ",", "\"\<DrellYan\>\"", ",", 
          "Facility"}], "]"}], "=", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Facility", "==", "\"\<SPS\>\""}], ",", "kfactorNLO", ",", 
           "1"}], "]"}], "*", "\[Epsilon]2", "*", 
         FractionBox[
          RowBox[{"int", "[", "mLLP", "]"}], 
          RowBox[{"\[Sigma]pNucleonInpb", "[", "Atarget", "]"}]]}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{"\[Sigma]DrellYanData", "[", "Facility", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"Facility", ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<SPS\>\"", ",", "\"\<FermilabBD\>\"", ",", "\"\<LHC\>\""}], 
        "}"}]}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.934178591179254*^9, 3.934178591401297*^9}, {
  3.9341803422559166`*^9, 3.934180342695938*^9}, {3.9344730407257247`*^9, 
  3.9344730412754993`*^9}},
 CellTags->{"Number-of-events+sensitivity", "Acceptance"},
 CellLabel->
  "In[280]:=",ExpressionUUID->"f44f4d01-09ef-406a-abf2-39cd6a42275c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Via bremsstrahlung", "Subsection",
 CellChangeTimes->{{3.934178450342802*^9, 3.9341784593374634`*^9}},
 CellTags->{
  "Number-of-events+sensitivity", 
   "Acceptance"},ExpressionUUID->"57230fc2-265e-4259-b86d-d4d204e6a68b"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"___", "___", "___", "___", "___", "_"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "Bremsstrahlung", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"___", "___", "___", "___", "___", "_"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"BremProd", "[", "Facility_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"bremprobfiles", "=", 
        RowBox[{"FileNames", "[", 
         RowBox[{
          RowBox[{"\"\<Pbrem*_\>\"", "<>", "Facility", "<>", "\"\<.m\>\""}], 
          ",", 
          RowBox[{"directory", "[", "\"\<Production weights\>\"", "]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"bremprobfiles", "!=", 
          RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Scanning", " ", "over", " ", "all", " ", "available", " ", "files",
            " ", "with", " ", "the", " ", "bremsstrahlung", " ", 
           RowBox[{"probability", ".", " ", "They"}], " ", "describe", " ", 
           "different", " ", "descriptions", " ", "of", " ", "the", " ", 
           "bremsstrahlung"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Extract", " ", "the", " ", "bremsstrahlung", " ", "description", 
           " ", "from", " ", "the", " ", "filename"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"bremprobfilenames", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Last", "@", 
              RowBox[{"FileNameSplit", "[", "#", "]"}]}], "&"}], "/@", 
            "bremprobfiles"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"bremdescription", "=", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"\"\<Bremsstrahlung-\>\"", "<>", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"StringSplit", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "\"\<Pbrem_\>\"", "<>", "LLPdirName", "<>", "\"\<_\>\""}],
                     ",", "\"\<_\>\""}], "}"}]}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "&"}], "/@", 
             "bremprobfilenames"}], ")"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"datbrem", "[", 
               RowBox[{"mLLP_", ",", "\[Theta]LLP_"}], "]"}], "=", 
              RowBox[{"Import", "[", 
               RowBox[{
                RowBox[{"bremprobfiles", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<MX\>\""}], "]"}]}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"StringContainsQ", "[", 
                RowBox[{
                 RowBox[{"bremdescription", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<Baseline\>\""}], 
                "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"PmotherToLLP", "[", 
                  RowBox[{"mLLP_", ",", "\[Epsilon]2_", ",", 
                   RowBox[{"bremdescription", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "Facility"}], "]"}], 
                 "=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"datbrem", "[", 
                    RowBox[{"mLLP", ",", "\[Theta]LLP"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "*", "\[Epsilon]2"}]}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"ELLPmin", "[", 
                  RowBox[{
                   RowBox[{"bremdescription", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "Facility"}], "]"}], 
                 "=", 
                 RowBox[{"Evaluate", "[", 
                  RowBox[{
                   RowBox[{"datbrem", "[", 
                    RowBox[{"mLLP", ",", "\[Theta]LLP"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"\[Theta]maxBrem", "[", 
                  RowBox[{
                   RowBox[{"bremdescription", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "Facility"}], "]"}], 
                 "=", 
                 RowBox[{"Evaluate", "[", 
                  RowBox[{
                   RowBox[{"datbrem", "[", 
                    RowBox[{"mLLP", ",", "\[Theta]LLP"}], "]"}], "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"ELLPmax", "[", 
                  RowBox[{"mLLP_", ",", "\[Theta]LLP_", ",", 
                   RowBox[{"bremdescription", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "Facility"}], "]"}], 
                 "=", 
                 RowBox[{"Evaluate", "[", 
                  RowBox[{
                   RowBox[{"datbrem", "[", 
                    RowBox[{"mLLP", ",", "\[Theta]LLP"}], "]"}], "[", 
                   RowBox[{"[", "4", "]"}], "]"}], "]"}]}], ";"}], 
               "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
               RowBox[{"Do", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"PmotherToLLP", "[", 
                    RowBox[{"mLLP_", ",", "\[Epsilon]2_", ",", 
                    RowBox[{
                    RowBox[{"bremdescription", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\<-\>\"", "<>", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"datbrem", "[", 
                    RowBox[{"mLLP", ",", "\[Theta]LLP"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", "Facility"}], 
                    "]"}], "=", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"datbrem", "[", 
                    RowBox[{"mLLP", ",", "\[Theta]LLP"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "*", "\[Epsilon]2"}]}], 
                  ";", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"ELLPmin", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"bremdescription", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\<-\>\"", "<>", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"datbrem", "[", 
                    RowBox[{"mLLP", ",", "\[Theta]LLP"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", "Facility"}], 
                    "]"}], "=", 
                   RowBox[{"Evaluate", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"datbrem", "[", 
                    RowBox[{"mLLP", ",", "\[Theta]LLP"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"\[Theta]maxBrem", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"bremdescription", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\<-\>\"", "<>", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"datbrem", "[", 
                    RowBox[{"mLLP", ",", "\[Theta]LLP"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", "Facility"}], 
                    "]"}], "=", 
                   RowBox[{"Evaluate", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"datbrem", "[", 
                    RowBox[{"mLLP", ",", "\[Theta]LLP"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"ELLPmax", "[", 
                    RowBox[{"mLLP_", ",", "\[Theta]LLP_", ",", 
                    RowBox[{
                    RowBox[{"bremdescription", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\<-\>\"", "<>", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"datbrem", "[", 
                    RowBox[{"mLLP", ",", "\[Theta]LLP"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", "Facility"}], 
                    "]"}], "=", 
                   RowBox[{"Evaluate", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"datbrem", "[", 
                    RowBox[{"mLLP", ",", "\[Theta]LLP"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "5", "]"}], "]"}], "]"}]}], ";"}], 
                 "\[IndentingNewLine]", ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "1", ",", 
                   RowBox[{"Length", "[", 
                    RowBox[{"datbrem", "[", 
                    RowBox[{"mLLP", ",", "\[Theta]LLP"}], "]"}], "]"}], ",", 
                   "1"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "bremdescription", "]"}], ",", "1"}], 
             "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"BremProd", "[", "Facility", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"Facility", ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<FCC-hh\>\"", ",", "\"\<Serpukhov\>\"", ",", "\"\<SPS\>\"", ",", 
         "\"\<FermilabBD\>\"", ",", "\"\<LHC\>\""}], "}"}]}], "}"}]}], "]"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.934178879692268*^9, 3.93417892786508*^9}, {
   3.934179061125416*^9, 3.93417906874356*^9}, {3.9341798648031354`*^9, 
   3.934179867892165*^9}, {3.934179928709987*^9, 3.9341799384204144`*^9}, {
   3.9341803211047697`*^9, 3.934180349510409*^9}, {3.9341803870680065`*^9, 
   3.934180415117526*^9}, {3.9341804615924125`*^9, 3.9341804765221124`*^9}, {
   3.934214880611182*^9, 3.9342149181922135`*^9}, {3.934215377448099*^9, 
   3.934215379333004*^9}, 3.9344709898031907`*^9, {3.9344730366502*^9, 
   3.9344730394875703`*^9}, 3.9345555697247343`*^9, 3.935134776288624*^9},
 CellTags->{"Number-of-events+sensitivity", "Acceptance"},
 CellLabel->
  "In[283]:=",ExpressionUUID->"60f9c0f3-6256-4645-9775-12b7c3e2036c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Via mixing", "Subsection",
 CellChangeTimes->{{3.9344709424253836`*^9, 3.934470943472537*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"5246919d-853f-4089-9198-\
71384d19dd68"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"YieldsMixing", "[", "mLLP_", "]"}], "=", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"directory", "[", "\"\<Production weights\>\"", "]"}], ",", 
         "\"\<Yield-Mixing_DP.mx\>\""}], "}"}], "]"}], ",", "\"\<MX\>\""}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Old", " ", "description", " ", "a"}], "-", 
    RowBox[{"la", " ", "2201.05170"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Mixing", " ", "angle", " ", 
      SuperscriptBox["\[Rho]", "0"]}], "-", 
     RowBox[{
      RowBox[{"DP", ".", " ", "Following"}], " ", 
      RowBox[{"https", ":"}]}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{"arxiv", ".", "org"}], "/", "pdf"}], "/", 
     RowBox[{"1810.01879", ".", "pdf"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g\[Rho]0", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]DP\[Rho]02", "[", 
    RowBox[{"mLLP_", ",", "\[Epsilon]2_"}], "]"}], "=", 
   RowBox[{"\[Epsilon]2", "*", 
    FractionBox[
     RowBox[{"4", "Pi", "*", "\[Alpha]EM"}], 
     SuperscriptBox["g\[Rho]0", "2"]], 
    FractionBox[
     SuperscriptBox[
      RowBox[{"mSM", "[", "\"\<Rho0\>\"", "]"}], "4"], 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["mLLP", "2"], "-", 
         SuperscriptBox[
          RowBox[{"mSM", "[", "\"\<Rho0\>\"", "]"}], "2"]}], ")"}], "2"], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"\[CapitalGamma]SM", "[", "\"\<\[Rho]780\>\"", "]"}], "2"], 
       "*", 
       SuperscriptBox[
        RowBox[{"mSM", "[", "\"\<Rho0\>\"", "]"}], "2"]}]}]]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Description of the production via mixing\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"SelectedMixingChoice", "=", 
  RowBox[{"dropdownDialog", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\"\<Revised\>\"", ",", "\"\<Old (2201.05170)\>\""}], "}"}], 
    ",", "\"\<Select the description of the DP production via mixing with \
vector mesons:\>\""}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"SelectedMixingChoice", "==", "\"\<Revised\>\""}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"PmotherToLLP", "[", 
        RowBox[{"mLLP_", ",", "\[Epsilon]2_", ",", "\"\<Mixing\>\"", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"YieldsMixing", "[", "mLLP", "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "=", 
       RowBox[{"\[Epsilon]2", "*", 
        RowBox[{
         RowBox[{
          RowBox[{"YieldsMixing", "[", "mLLP", "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", 
         RowBox[{"YieldsMixing", "[", "mLLP", "]"}], "]"}], ",", "1"}], 
       "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"PmotherToLLP", "[", 
        RowBox[{
        "mLLP_", ",", "\[Epsilon]2_", ",", "\"\<Mixing-Old\>\"", ",", 
         "facility"}], "]"}], "=", 
       RowBox[{"Yield\[Rho]0", "*", 
        RowBox[{"\[Theta]DP\[Rho]02", "[", 
         RowBox[{"mLLP", ",", "\[Epsilon]2"}], "]"}]}]}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"facility", ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<SPS\>\"", ",", "\"\<Serpukhov\>\"", ",", "\"\<FermilabBD\>\"", 
          ",", "\"\<LHC\>\"", ",", "\"\<FCC-hh\>\""}], "}"}]}], "}"}]}], 
     "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WeightsCombinations", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Keys", "[", 
         RowBox[{"DownValues", "@", "PmotherToLLP"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
      RowBox[{"{", 
       RowBox[{"3", ",", "4"}], "}"}]}], "//", "Transpose"}], "//", 
    "Sort"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.934470944210307*^9, 3.9344710692350903`*^9}, {
  3.934471113166834*^9, 3.9344711469034414`*^9}, {3.934472982269247*^9, 
  3.9344730114614*^9}, {3.934473322827702*^9, 3.934473351939787*^9}, {
  3.934473715004074*^9, 3.9344737432851853`*^9}, {3.9344737908876925`*^9, 
  3.9344738349429083`*^9}, {3.934473865593743*^9, 3.9344738702532225`*^9}, {
  3.9344739628834076`*^9, 3.934473975355566*^9}, {3.934521362447957*^9, 
  3.934521367353219*^9}, {3.9355102906915417`*^9, 3.935510290935131*^9}},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->
  "In[285]:=",ExpressionUUID->"7f9a11b3-6cdb-4f46-823c-c636cc8148be"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Scanning for tabulated distributions", "Section",
 CellChangeTimes->{{3.9137150010274553`*^9, 3.9137150224099426`*^9}, {
  3.913715411520641*^9, 3.913715414252445*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"1caa4f1c-1d68-4c34-a8aa-\
219c84a8ceb7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Define", " ", "the", " ", "file", " ", "pattern"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"pattern", "=", "\"\<DoubleDistr_*_*_*.m\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Search", " ", "for", " ", "files", " ", "matching", " ", "the", " ", 
     "pattern", " ", "in", " ", "the", " ", "directory", " ", "and", " ", 
     "its", " ", "subdirectories"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"matchingFiles", "=", 
     RowBox[{"FileNames", "[", 
      RowBox[{"pattern", ",", 
       RowBox[{"{", 
        RowBox[{"directory", "[", "\"\<Distribution\>\"", "]"}], "}"}], ",", 
       "Infinity"}], "]"}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"List", " ", "of", " ", "LLPs"}], ",", " ", 
     RowBox[{"production", " ", "modes"}], ",", " ", 
     RowBox[{
     "and", " ", "facilities", " ", "for", " ", "which", " ", "the", " ", 
      "tabulated", " ", "distributions", " ", "have", " ", "been", " ", 
      "computed", " ", "at", " ", "the", " ", "previous", " ", "stage", " ", 
      "of", " ", "using", " ", "SensCalc"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ExtractedProductionParameters", "=", 
     RowBox[{"Function", "[", 
      RowBox[{"filename", ",", 
       RowBox[{
        RowBox[{"parts", "=", 
         RowBox[{"StringSplit", "[", 
          RowBox[{
           RowBox[{"FileNameTake", "[", "filename", "]"}], ",", "\"\<_\>\""}],
           "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"parts", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"parts", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"StringDrop", "[", 
           RowBox[{
            RowBox[{"parts", "[", 
             RowBox[{"[", "4", "]"}], "]"}], ",", 
            RowBox[{"-", "2"}]}], "]"}]}], "}"}]}]}], " ", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"combinations", " ", "selected", " ", "LLP"}], ",", " ", 
     RowBox[{"production", " ", "channel"}], ",", " ", 
     RowBox[{
     "facility", " ", "for", " ", "which", " ", "the", " ", "tabulated", " ", 
      "distributions", " ", "are", " ", "present"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DistrCombinations", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ExtractedProductionParameters", "/@", "matchingFiles"}], 
       ")"}], "//", "Sort"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"SelectedMixingChoice", "==", "\"\<Revised\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"DistrCombinations", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"DistrCombinations", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "!=", "\"\<Mixing-Old\>\""}], 
          "&"}]}], "]"}]}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{"DistrCombinations", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"DistrCombinations", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "!=", "\"\<Mixing\>\""}], "&"}]}],
         "]"}]}]}], "\[IndentingNewLine]", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"DistrCombinations", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
         "\"\<Bremsstrahlung-FR\>\""}], "]"}], "||", 
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"DistrCombinations", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
         "\"\<Bremsstrahlung-AP\>\""}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FacilitiesFR", "=", 
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{"DistrCombinations", ",", 
           RowBox[{
            RowBox[{"StringContainsQ", "[", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"{", "\"\<FR\>\"", "}"}]}], "]"}], "&"}]}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "3"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"FacilitiesAP", "=", 
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{"DistrCombinations", ",", 
           RowBox[{
            RowBox[{"StringContainsQ", "[", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"{", "\"\<AP\>\"", "}"}]}], "]"}], "&"}]}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "3"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"DistrCombinationsToCheck", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"DistrCombinations", ",", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"StringContainsQ", "[", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<FR\>\"", ",", "\"\<AP\>\""}], "}"}]}], "]"}]}], 
           "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"DistrCombinationsToCheck", "=", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{"DistrCombinationsToCheck", ",", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"LLPdirName", ",", "brem", ",", "fac"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"fac", ",", "FacilitiesFR"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"brem", ",", 
                 RowBox[{
                  RowBox[{"Select", "[", 
                   RowBox[{"WeightsCombinations", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "==", "fac"}], "&&", 
                    RowBox[{"StringContainsQ", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<FR\>\""}], 
                    "]"}]}], "&"}]}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}], 
             ",", "1"}], "]"}], ",", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"LLPdirName", ",", "brem", ",", "fac"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"fac", ",", "FacilitiesAP"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"brem", ",", 
                 RowBox[{
                  RowBox[{"Select", "[", 
                   RowBox[{"WeightsCombinations", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "==", "fac"}], "&&", 
                    RowBox[{"StringContainsQ", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<AP\>\""}], 
                    "]"}]}], "&"}]}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}], 
             ",", "1"}], "]"}]}], "]"}], "//", "Sort"}]}], ";"}], 
      "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{"DistrCombinationsToCheck", "=", "DistrCombinations"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IfCondDistrToWeights", "=", "True"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"IfCondDistrToWeights", "=", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"WeightsCombinations", ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "==", 
             RowBox[{
              RowBox[{"DistrCombinationsToCheck", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "&&", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "==", 
             RowBox[{
              RowBox[{"DistrCombinationsToCheck", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}], "&"}]}], "]"}], "!=", 
        RowBox[{"{", "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"IfCondDistrToWeights", "==", "False"}], ",", 
        RowBox[{"Break", "[", "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "DistrCombinationsToCheck", "]"}], ",", "1"}], 
      "}"}]}], "]"}], "\[IndentingNewLine]", "IfCondDistrToWeights", 
   "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"!", "IfCondDistrToWeights"}], ",", 
     RowBox[{
      RowBox[{
      "infoDialog", "[", 
       "\"\<You have not provided the production probabilities PmotherToLLP \
to all the generated tabulated distributions! Please do this first to avoid \
problems\>\"", "]"}], ";"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9137151636915593`*^9, 3.9137152465178137`*^9}, {
   3.9137153053586187`*^9, 3.913715399589816*^9}, {3.913718678447782*^9, 
   3.913718708673525*^9}, {3.913719203960288*^9, 3.9137192388759937`*^9}, {
   3.913804074855399*^9, 3.913804089247952*^9}, 3.9138043135262485`*^9, {
   3.913810357631002*^9, 3.913810363616334*^9}, {3.9138256248481245`*^9, 
   3.9138256471350822`*^9}, 3.9138665659237595`*^9, {3.9156430596090527`*^9, 
   3.9156430596110473`*^9}, {3.9341794838520145`*^9, 
   3.9341795032326403`*^9}, {3.934179535824199*^9, 3.934179741282941*^9}, {
   3.934179790853141*^9, 3.934179831711254*^9}, {3.934179997114852*^9, 
   3.9341802099881268`*^9}, {3.9341802674304266`*^9, 3.934180310904458*^9}, {
   3.9344738871254234`*^9, 3.93447392834628*^9}, {3.9344740167243133`*^9, 
   3.9344740168355308`*^9}, {3.9345555974250455`*^9, 3.9345556104131613`*^9}, 
   3.9347024091030283`*^9},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->
  "In[292]:=",ExpressionUUID->"3e580ec6-f8ab-4835-a08c-150bfb38f985"]
}, Closed]],

Cell[CellGroupData[{

Cell["Decays", "Section",
 CellChangeTimes->{{3.877584114519929*^9, 3.877584115297123*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"04c8f572-467e-4c76-8fac-\
f5585da995c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Decay", " ", "width", " ", "in", " ", "GeV"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalGamma]LLP", "[", 
      RowBox[{"mLLP_", ",", "\[Epsilon]2_"}], "]"}], "=", 
     RowBox[{"\[Epsilon]2", "*", 
      RowBox[{"10", "^", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Log10", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
               RowBox[{"Log10", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
            RowBox[{"Import", "[", 
             RowBox[{
              RowBox[{"FileNameJoin", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"directory", "[", "\"\<Decays\>\"", "]"}], ",", 
                 "\"\<GammaDarkPhoton.txt\>\""}], "}"}], "]"}], ",", 
              "\"\<Table\>\""}], "]"}]}], ",", 
           RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
         RowBox[{"Log10", "[", "mLLP", "]"}], "]"}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Decay", " ", "length"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"c\[Tau]LLP", "[", 
      RowBox[{"mLLP_", ",", "\[Epsilon]2_"}], "]"}], "=", 
     FractionBox["chbarval", 
      RowBox[{"\[CapitalGamma]LLP", "[", 
       RowBox[{"mLLP", ",", "\[Epsilon]2"}], "]"}]]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ldecayLLP", "[", 
      RowBox[{"mLLP_", ",", "\[Epsilon]2_", ",", "ELLP_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"c\[Tau]LLP", "[", 
       RowBox[{"mLLP", ",", "\[Epsilon]2"}], "]"}], "*", 
      FractionBox[
       SqrtBox[
        RowBox[{
         SuperscriptBox["ELLP", "2"], "-", 
         SuperscriptBox["mLLP", "2"]}]], "mLLP"]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Epsilon]2val", "=", 
     SuperscriptBox["10", 
      RowBox[{"-", "14"}]]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"LogLogPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{"c\[Tau]LLP", "[", 
       RowBox[{"mLLP", ",", 
        SuperscriptBox["10", 
         RowBox[{"-", "14"}]]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"mLLP", ",", "0.05", ",", "4"}], "}"}], ",", 
     RowBox[{"Frame", "->", "True"}], ",", 
     RowBox[{"ImageSize", "->", "Large"}], ",", " ", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", " ", "22"}], "]"}]}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.05", ",", "4"}], "}"}], ",", "All"}], "}"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Darker", "@", 
           RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Darker", "@", "Cyan"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Magenta"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Brown"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", "0.66"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(m\), \(V\)]\) [GeV]\>\"", ",", 
        "\"\<\!\(\*SubscriptBox[\(c\[Tau]\), \(V\)]\) [m]\>\""}], "}"}]}], 
     ",", 
     RowBox[{"PlotLabel", "\[Rule]", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Proper lifetime of dark photon. \!\(\*SuperscriptBox[\(\
\[Epsilon]\), \(2\)]\) = \>\"", ",", 
           RowBox[{"N", "[", "\[Epsilon]2val", "]"}]}], "}"}], "]"}], ",", 
        "18", ",", "Black"}], "]"}]}]}], "]"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.8765027030040936`*^9, 3.876502712230002*^9}, {
   3.8765056490712585`*^9, 3.8765056684143023`*^9}, {3.8775935816940823`*^9, 
   3.877593651036413*^9}, {3.8775936851602736`*^9, 3.877593693594926*^9}, {
   3.8867405804606123`*^9, 3.886740855468573*^9}, {3.886740927115221*^9, 
   3.8867410004506335`*^9}, {3.8867589177998257`*^9, 3.886758933299265*^9}, 
   3.8868371903483343`*^9, {3.892180950096738*^9, 3.892180969099872*^9}, {
   3.8928884714154296`*^9, 3.892888477362914*^9}, {3.904903264799167*^9, 
   3.904903264924593*^9}, {3.9138856219576783`*^9, 3.9138856725915384`*^9}, {
   3.915643059934176*^9, 3.915643059982321*^9}, {3.9305823919738894`*^9, 
   3.9305825230614967`*^9}, {3.9341804917055883`*^9, 
   3.9341804925728483`*^9}, {3.9342806870307083`*^9, 3.934280715926197*^9}, {
   3.9347024134037676`*^9, 3.9347024138536735`*^9}, {3.9352518801282196`*^9, 
   3.9352518827762146`*^9}},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->
  "In[302]:=",ExpressionUUID->"bfe2aed5-8f0a-4cad-a1aa-1740c3919a79"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Loading necessary routines", "Chapter",
 CellChangeTimes->{{3.891315426588935*^9, 3.891315432542842*^9}, {
  3.9165033404709945`*^9, 3.9165033463985844`*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"c2195567-c72b-45b8-82f4-\
a09212ef8e72"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", "inecessary", "]"}], "==", "0"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NotebookEvaluate", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<codes/generic.nb\>\""}], "}"}], "]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"NotebookEvaluate", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<codes/for-sensitivities.nb\>\""}], "}"}], "]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"inecessary", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.890711783488103*^9, 3.89071178348964*^9}, {
   3.8907121412539587`*^9, 3.8907121413711557`*^9}, {3.890712694841427*^9, 
   3.8907126950000925`*^9}, {3.890712790376151*^9, 3.8907128219919777`*^9}, {
   3.891018553068019*^9, 3.8910185548862777`*^9}, {3.914141327087761*^9, 
   3.9141413282588053`*^9}, 3.9165033910195627`*^9, {3.916503434997039*^9, 
   3.9165034401725807`*^9}, {3.9165108789774036`*^9, 
   3.9165108974096084`*^9}, {3.9165109290075464`*^9, 3.916510969839264*^9}},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->
  "In[307]:=",ExpressionUUID->"25a5ddb0-4a9b-4ac7-bc67-62ae0c80c611"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Specifying the experiment and run next sections", "Title",
 CellChangeTimes->{{3.8876177939846563`*^9, 3.8876177965376587`*^9}, {
  3.914140539510558*^9, 3.914140544040797*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"6bf41310-9786-4a2d-9c45-\
da72c297facc"],

Cell[CellGroupData[{

Cell["Specifying the experiment", "Chapter",
 CellChangeTimes->{{3.902729140157612*^9, 3.90272914444062*^9}, {
  3.9141405357221785`*^9, 3.9141405362140307`*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"09993897-08e0-4d65-9fda-\
c55a83b4e5d6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Parent", " ", "directory"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NotebookDirectory", "[", "]"}], "//", "ParentDirectory"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExperimentDirectoriesList", "=", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"FileNames", "[", 
       RowBox[{"\"\<*\>\"", ",", 
        RowBox[{"directory", "[", "\"\<Acceptances\>\"", "]"}], ",", "1"}], 
       "]"}], ",", "DirectoryQ"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"List", " ", "of", " ", "available", " ", "experiments", " ", 
    RowBox[{"(", 
     RowBox[{
     "for", " ", "which", " ", "the", " ", "geometry", " ", "has", " ", 
      "been", " ", "implemented"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentsListTemp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"FileNameTake", "[", 
      RowBox[{
       RowBox[{"ExperimentDirectoriesList", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"-", "1"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "ExperimentDirectoriesList", "]"}], ",", "1"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentsListTemp2", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Partition", "[", 
      RowBox[{"ExperimentsListTemp", ",", "1"}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"TrueQ", "@", 
         RowBox[{"FileExistsQ", "@", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"directory", "[", "\"\<Acceptances\>\"", "]"}], ",", 
             RowBox[{"ExperimentsListTemp", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"ToString", "@", 
              RowBox[{"StringForm", "[", 
               RowBox[{"\"\<Acceptance_``_for_``.m\>\"", ",", 
                RowBox[{"Sequence", "@@", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"ExperimentsListTemp", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "LLPdirName"}], 
                  "}"}]}]}], "]"}]}]}], "}"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "ExperimentsListTemp", "]"}]}], "}"}]}], 
      "]"}], ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ExperimentsList", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{"ExperimentsListTemp2", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "True"}], "&"}]}], "]"}],
     "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", 
   "Sort"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", "ExperimentsList", "]"}], "\[Equal]", "0"}], ",", 
   RowBox[{
   "Print", "[", 
    "\"\<No experiment is available, generate first the acceptance for the \
given experiment using module 1\>\"", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Selected experiments:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"SelectedExperimentList", "=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "ExperimentsList", "]"}], "\[NotEqual]", "0"}], 
    ",", 
    RowBox[{"selectionDialog", "[", 
     RowBox[{"ExperimentsList", ",", "\"\<Select the experiments:\>\""}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"icounter", "=", "1"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8851403254718485`*^9, 3.8851403429411273`*^9}, {
   3.8854395484478483`*^9, 3.885439559226637*^9}, {3.8854397351242537`*^9, 
   3.885439739219259*^9}, {3.8858794196350574`*^9, 3.885879423032172*^9}, 
   3.886141121558817*^9, {3.886821665769628*^9, 3.8868216684602585`*^9}, {
   3.887617086304534*^9, 3.8876170990910044`*^9}, 3.889080211074895*^9, {
   3.890287800311657*^9, 3.890287802587648*^9}, {3.892189472726385*^9, 
   3.8921895121150846`*^9}, 3.892705546310735*^9, 3.8932345108531446`*^9, 
   3.902763528561518*^9, {3.902889537778877*^9, 3.9028895446827335`*^9}, {
   3.9138868703932114`*^9, 3.913886928383787*^9}, 3.915643060000375*^9},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->
  "In[308]:=",ExpressionUUID->"14cf246a-dfe6-4f84-bced-6779a027f776"]
}, Closed]],

Cell[CellGroupData[{

Cell["Running block for next sections", "Chapter",
 CellChangeTimes->{{3.902729140157612*^9, 3.90272914444062*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"bf5cb1ca-586b-421c-9b8f-\
bcdda79a4c7d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BlockEvaluation", "[", "tag_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nb", "=", 
      RowBox[{"EvaluationNotebook", "[", "]"}]}], ";", "\n", 
     RowBox[{"NotebookFind", "[", 
      RowBox[{"nb", ",", "tag", ",", "All", ",", "CellTags"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"tagselected", "==", "\"\<Number-of-events+sensitivity\>\""}], ",",
    "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
      "BlockEvaluation", "[", 
       "\"\<Number-of-events-computation+sensitivity\>\"", "]"}], ";"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"icounter", ",", "1", ",", 
       RowBox[{"Length", "[", "SelectedExperimentList", "]"}], ",", "1"}], 
      "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"tagselected", "==", "\"\<Acceptance\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
        "BlockEvaluation", "[", "\"\<Acceptance-computation\>\"", "]"}], 
        ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"icounter", ",", "1", ",", 
         RowBox[{"Length", "[", "SelectedExperimentList", "]"}], ",", "1"}], 
        "}"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.9027291581950865`*^9, 3.902729215695462*^9}, {
   3.902761777481885*^9, 3.902761802513644*^9}, 3.902889536609843*^9, 
   3.9038925480063467`*^9, 3.914667536575886*^9, {3.915183587630067*^9, 
   3.915183588551358*^9}},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->
  "In[318]:=",ExpressionUUID->"8ccbe0c0-5799-4a13-b89d-58d5d3aa1550"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Number of events", "Title",
 CellChangeTimes->{{3.885140281753849*^9, 3.8851402836781845`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"ec7d1ed4-b833-\
4ca9-b86b-68ef0bdfdc5e"],

Cell[CellGroupData[{

Cell["Particular experiment", "Chapter",
 CellChangeTimes->{{3.9165042001551485`*^9, 3.9165042041207294`*^9}, {
  3.9165090857383037`*^9, 3.916509094318386*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"90e03790-1066-\
4abb-8908-35a37e0278c1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SelectedExperiment", "=", 
   RowBox[{"SelectedExperimentList", "[", 
    RowBox[{"[", 
     RowBox[{"icounter", "++"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"Row", "[", 
    RowBox[{"{", 
     RowBox[{"\"\<Experiment \>\"", ",", 
      RowBox[{"icounter", "-", "1"}], ",", "\"\</\>\"", ",", 
      RowBox[{"Length", "[", "SelectedExperimentList", "]"}]}], "}"}], "]"}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.916672448691073*^9, 3.9166724492284126`*^9}, {
  3.934821787503186*^9, 3.9348218246688805`*^9}, {3.9348220753648005`*^9, 
  3.934822075373316*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[411]:=",ExpressionUUID->"18b4049e-6a0e-4546-98b8-9c919573bc3b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cross-sections, acceptances", "Chapter",
 CellChangeTimes->{{3.885020695565913*^9, 3.885020698644303*^9}, 
   3.887617827187765*^9, {3.89463726983397*^9, 3.894637273109426*^9}},
 CellTags->{
  "Number-of-events-computation", "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"ddc91657-c605-\
432a-9fc4-3dde27689d78"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dataAcceptances", "=", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"directory", "[", "\"\<Acceptances\>\"", "]"}], ",", 
           "SelectedExperiment", ",", 
           RowBox[{"ToString", "@", 
            RowBox[{"StringForm", "[", 
             RowBox[{"\"\<Acceptance_``_for_``.m\>\"", ",", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"{", 
                RowBox[{"SelectedExperiment", ",", "LLPdirName"}], "}"}]}]}], 
             "]"}]}]}], "}"}], "]"}], "}"}], "]"}], ",", "\"\<MX\>\""}], 
     "]"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"FacilityGivenExperiment", ",", "FullAcceptanceData0", ",", 
     RowBox[{"BrVis", "[", "mLLP_", "]"}]}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"dataAcceptances", "[", 
      RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
    RowBox[{"{", 
     RowBox[{"1", ",", "3", ",", "5"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<Total branching ratio of visible decays (computed by notebook 1):\>\"",
   "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LogLogPlot", "[", 
   RowBox[{
    RowBox[{"Evaluate", "[", 
     RowBox[{"BrVis", "[", "mLLP", "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"mLLP", ",", "0.02", ",", "10"}], "}"}], ",", 
    RowBox[{"Frame", "->", "True"}], ",", 
    RowBox[{"ImageSize", "->", "Large"}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", " ", "22"}], "]"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Blue"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
         RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
         RowBox[{"Darker", "@", 
          RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Black"}], "}"}]}], 
      "}"}]}], ",", 
    RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.1", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.01", ",", "1.2"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<m [GeV]\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(Br\), \(vis\)]\)\>\""}], "}"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", " ", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<For \>\"", ",", "SelectedExperiment"}], "}"}], "]"}], 
       ",", " ", "20", ",", " ", "Black"}], "]"}]}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"___", "___", "___", "___", "___", "___", "___", "___", "___"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Interpolation", " ", "of", " ", "the", " ", "tabulated", " ", 
     "azimuthal", " ", "acceptance"}], ",", " ", 
    RowBox[{"extracting", " ", 
     SubscriptBox["\[Theta]", 
      RowBox[{"min", "/", "max"}]]}], ",", " ", 
    RowBox[{"etc", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"___", "___", "___", "___", "___", "___", "___", "___", "___"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"AzimuthalAcceptanceInt", "[", 
       RowBox[{"\[Theta]LLP_", ",", "zLLP_"}], "]"}], ",", 
      "\[Theta]minExpAll", ",", "\[Theta]maxExpAll", ",", "\[Theta]minExp", 
      ",", "\[Theta]maxExp", ",", "zminExp", ",", "zmaxExp", ",", 
      RowBox[{"zmin\[Theta]", "[", "\[Theta]LLP_", "]"}], ",", 
      RowBox[{"zmax\[Theta]", "[", "\[Theta]LLP_", "]"}]}], "}"}], "=", 
    RowBox[{"Block\[Epsilon]Azimuthal", "[", "FullAcceptanceData0", "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Logarithmized", " ", "data", " ", "with", " ", "full", " ", 
     "acceptance"}], ",", " ", 
    RowBox[{
    "and", " ", "also", " ", "decay", " ", "acceptance", " ", "and", " ", 
     "full", " ", "acceptance", " ", "interpolations"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"FullAcceptanceData", ",", 
     RowBox[{"DecayAcceptanceInt", "[", 
      RowBox[{"mLLP_", ",", "\[Theta]LLP_", ",", "ELLP_", ",", "zLLP_"}], 
      "]"}], ",", 
     RowBox[{"FullAcceptanceInt", "[", 
      RowBox[{"mLLP_", ",", "\[Theta]LLP_", ",", "ELLP_", ",", "zLLP_"}], 
      "]"}], ",", "InGridm\[Epsilon]", ",", "InGrid\[Theta]\[Epsilon]", ",", 
     "InGridE\[Epsilon]", ",", "InGridz\[Epsilon]", ",", "\[Epsilon]vals", 
     ",", "\[Epsilon]azvals", ",", "mmin\[Epsilon]", ",", "mmax\[Epsilon]"}], 
    "}"}], "=", 
   RowBox[{"Block\[Epsilon]Decay", "[", 
    RowBox[{"FullAcceptanceData0", ",", "zminExp", ",", "BrVis"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CrossSectionData", "=", 
   RowBox[{
    RowBox[{"dataAcceptances", "[", 
     RowBox[{"[", "4", "]"}], "]"}], "//", "Transpose"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"listquantities", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"#", "//", "ToString"}], ")"}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{
      "Npot", ",", "PPi0", ",", "PEta", ",", "PEtapr", ",", "PRho0", ",", 
       "Atarget"}], "}"}]}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"quantityselector", "[", "quantity_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"CrossSectionData", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "quantity"}], "&"}]}], 
       "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "//", "N"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"NpotGivenExperiment", ",", 
      RowBox[{"ProbMother", "[", "\"\<Pi0\>\"", "]"}], ",", 
      RowBox[{"ProbMother", "[", "\"\<Eta\>\"", "]"}], ",", 
      RowBox[{"ProbMother", "[", "\"\<EtaPr\>\"", "]"}], ",", 
      RowBox[{"ProbMother", "[", "\"\<Rho0\>\"", "]"}], ",", "AtargetVal"}], 
     "}"}], "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"quantityselector", "[", "quantity", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"quantity", ",", "listquantities"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"infoDialog", "[", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{
      "\"\<The number of proton collisions is \>\"", ",", " ", 
       "NpotGivenExperiment", ",", 
       "\"\<. You may change it at the stage of computing the sensitivities\>\
\""}], "}"}], "]"}], "]"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\"\<Search for \>\"", "<>", "LLPdirName", "<>", "\"\< at \>\""}],
     ",", " ", "SelectedExperiment", ",", " ", "\"\< located at \>\"", ",", 
    "FacilityGivenExperiment", ",", 
    "\"\<. \!\(\*SubscriptBox[\(N\), \(collisions\)]\) = \>\"", ",", 
    "NpotGivenExperiment"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\"\<Quantity\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(min\)]\), rad\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(max\)]\), rad\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(min\)]\)(\!\(\*SubscriptBox[\(\
\[Epsilon]\), \(dec\)]\)), rad\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(max\)]\)(\!\(\*SubscriptBox[\(\
\[Epsilon]\), \(dec\)]\)), rad\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(z\), \(min\)]\), m\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(z\), \(max\)]\), m\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Description\>\"", ",", "\"\<Min angle covered by experiment\>\"", 
      ",", "\"\<Max angle covered by experiment\>\"", ",", 
      "\"\<Min angle where \!\(\*SubscriptBox[\(\[Epsilon]\), \(decay\)]\)\
\[NotEqual]0\>\"", ",", 
      "\"\<Max angle where \!\(\*SubscriptBox[\(\[Epsilon]\), \(decay\)]\)\
\[NotEqual]0\>\"", ",", "\"\<Min long. displacement of the decay volume\>\"", 
      ",", "\"\<Max long. displacement of the decay volume\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Value\>\"", ",", "\[Theta]minExpAll", ",", "\[Theta]maxExpAll", ",",
       "\[Theta]minExp", ",", "\[Theta]maxExp", ",", "zminExp", ",", 
      "zmaxExp"}], "}"}]}], "}"}], "//", "TableForm"}]}], "Input",
 CellChangeTimes->{{3.8921748442124033`*^9, 3.892174924863473*^9}, {
   3.892888493615114*^9, 3.892888495922745*^9}, {3.894178999539856*^9, 
   3.8941789997847443`*^9}, 3.894382708283858*^9, {3.8946372752697067`*^9, 
   3.8946372755375957`*^9}, 3.894781717122591*^9, {3.895053884461896*^9, 
   3.895053887613945*^9}, {3.899198252634884*^9, 3.89919827008097*^9}, {
   3.899215227082757*^9, 3.899215228721673*^9}, {3.9027635076975436`*^9, 
   3.902763508122694*^9}, {3.902763783256745*^9, 3.902763785618586*^9}, {
   3.9048896890123234`*^9, 3.9048896904995394`*^9}, {3.9049007877418613`*^9, 
   3.9049008009407682`*^9}, {3.9049010126152215`*^9, 3.904901012646469*^9}, 
   3.9049018234921083`*^9, {3.913885646171348*^9, 3.913885656271843*^9}, {
   3.9138869564213033`*^9, 3.9138870719643497`*^9}, {3.9138871161748323`*^9, 
   3.9138872180306273`*^9}, 3.913887277391947*^9, 3.913887317714735*^9, {
   3.9138874178618784`*^9, 3.9138874521893015`*^9}, 3.9138875140360203`*^9, {
   3.9138907770747414`*^9, 3.9138907840641837`*^9}, {3.9138911582620163`*^9, 
   3.913891163428483*^9}, {3.914062449582265*^9, 3.9140624531783323`*^9}, 
   3.914140029063476*^9, {3.914514981292539*^9, 3.9145149957389956`*^9}, {
   3.9156430600231075`*^9, 3.9156430601427784`*^9}, 3.916672479097767*^9, {
   3.9304938592003307`*^9, 3.9304939002491455`*^9}, {3.930493976125472*^9, 
   3.9304940150842085`*^9}, {3.930494067196113*^9, 3.9304940674831734`*^9}, {
   3.934180523015894*^9, 3.934180523475381*^9}, {3.934705560165065*^9, 
   3.934705586283145*^9}},
 CellTags->{
  "Number-of-events-computation", "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[413]:=",ExpressionUUID->"c815bc21-895a-435e-aff8-c368c51a223c"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Angle-energy distributions and differential yields  for the given experiment\
\>", "Chapter",
 CellChangeTimes->{{3.885020702966837*^9, 3.885020711525731*^9}, {
   3.8850216924759345`*^9, 3.8850216984444695`*^9}, {3.8851404110391607`*^9, 
   3.8851404117847*^9}, 3.8859669420079484`*^9, {3.887617811213402*^9, 
   3.88761781429661*^9}, {3.896334961873438*^9, 3.8963349667311535`*^9}},
 CellTags->{
  "Number-of-events-computation", "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"2ed58b5e-8fa1-\
4a99-b81c-130884bcdd21"],

Cell[CellGroupData[{

Cell["Importing and definitions", "Section",
 CellChangeTimes->{{3.934180644626505*^9, 3.934180647632351*^9}},
 CellTags->{
  "Number-of-events-computation", "Number-of-events-computation+sensitivity", 
   "Acceptance-computation"},ExpressionUUID->"03bef3a9-53ec-43f7-9e2c-\
ababe19cbbef"],

Cell[CellGroupData[{

Cell["Specifying production channels", "Subsection",
 CellChangeTimes->{{3.9341808932682676`*^9, 3.9341808978783426`*^9}, {
  3.934218558336424*^9, 3.9342185679340367`*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"80d39a64-aab6-\
4580-84b1-37c2961be459"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "production", " ", "channels", " ", "for", " ", 
    "the", " ", "selected", " ", "facility"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ProductionPatternSelectedDistr", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"DistrCombinations", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "==", "FacilityGivenExperiment"}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ProductionPatternSelected", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"DistrCombinationsToCheck", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "==", "FacilityGivenExperiment"}], 
        "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ProductionListTemp", "=", 
     RowBox[{
      RowBox[{"ProductionPatternSelected", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], "//", "DeleteDuplicates"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Selecting", " ", "only", " ", "those", " ", "bremsstrahlung", " ", 
      "channels", " ", "for", " ", "which", " ", "the", " ", "distribution", 
      " ", "is", " ", "non"}], "-", "zero"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BremVariantsGivenFacility", "=", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"WeightsCombinations", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "==", "FacilityGivenExperiment"}],
           "&&", 
          RowBox[{"StringContainsQ", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<Bremsstrahlung\>\""}], 
           "]"}]}], "&"}]}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"ProbMother", "[", "channel", "]"}], "=", "1"}], ";"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"channel", ",", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", "\"\<DrellYan\>\"", "}"}], ",", 
         "BremVariantsGivenFacility", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<Mixing\>\"", ",", "\"\<Mixing-Old\>\""}], "}"}]}], 
        "]"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", "\"\<Production list:\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Deciding", " ", "if", " ", "the", " ", "bremsstrahlung", " ", 
     "contributes", " ", "to", " ", "the", " ", "production", " ", "by", " ", 
     "comparing", " ", 
     SubscriptBox["\[Theta]", 
      RowBox[{"max", ",", "brem"}]], " ", "with", " ", 
     SubscriptBox["\[Theta]", 
      RowBox[{"min", ",", "experiment"}]]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"ELLPmax", "[", 
        RowBox[{"mLLP_", ",", "\[Theta]LLP_", ",", "ch"}], "]"}], "=", 
       RowBox[{"ELLPmax", "[", 
        RowBox[{
        "mLLP", ",", "\[Theta]LLP", ",", "ch", ",", 
         "FacilityGivenExperiment"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ELLPmin", "[", "ch", "]"}], "=", 
       RowBox[{"ELLPmin", "[", 
        RowBox[{"ch", ",", "FacilityGivenExperiment"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Theta]maxBrem", "[", "ch", "]"}], "=", 
       RowBox[{"\[Theta]maxBrem", "[", 
        RowBox[{"ch", ",", "FacilityGivenExperiment"}], "]"}]}]}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"ch", ",", "BremVariantsGivenFacility"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ProdListBrem", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"ProductionListTemp", ",", 
       RowBox[{
        RowBox[{"StringContainsQ", "[", 
         RowBox[{"#", ",", "\"\<Bremsstrahlung\>\""}], "]"}], "&"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"ProdListBremSelected", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"ProdListBrem", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Theta]maxBrem", "[", "#", "]"}], ">", "\[Theta]minExp"}],
          "&"}]}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ProdListBremSelected", "=", "ProdListBrem"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"ProductionList", "=", 
    RowBox[{"Join", "[", 
     RowBox[{"ProdListBremSelected", ",", 
      RowBox[{"Select", "[", 
       RowBox[{"ProductionListTemp", ",", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"#", ",", "\"\<Bremsstrahlung\>\""}], "]"}]}], "&"}]}], 
       "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Production", " ", "list", " ", "with", " ", "only", " ", "baseline", " ",
      "bremsstrahlung", " ", "description"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BremSelected", "=", "\"\<Bremsstrahlung-FR-Central\>\""}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ProductionListBaseline", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"ProductionList", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"!", 
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"#", ",", "\"\<Bremsstrahlung\>\""}], "]"}]}], "||", 
         RowBox[{"#", "==", "BremSelected"}]}], "&"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"ProductionList", ",", 
           RowBox[{"_String", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"StringContainsQ", "[", 
               RowBox[{"#", ",", "pattern"}], "]"}], "&"}], ")"}]}]}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"ProductionPatternSelectedDistr", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"ProductionPatternSelectedDistr", ",", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"StringContainsQ", "[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "pattern"}], "]"}]}], 
            "&"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"pattern", ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<AP\>\"", ",", "\"\<Fouroghi-Ritz\>\"", ",", "\"\<Baseline\>\""}],
         "}"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BremVariantsGivenFacility", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"ProductionList", ",", 
       RowBox[{
        RowBox[{"StringContainsQ", "[", 
         RowBox[{"#", ",", "\"\<Bremsstrahlung\>\""}], "]"}], "&"}]}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.9341809008331413`*^9, {3.9342136550621533`*^9, 3.9342136625750804`*^9}, {
   3.9342136936480284`*^9, 3.934213730906671*^9}, {3.9342142521798525`*^9, 
   3.934214329804173*^9}, {3.9342153687217464`*^9, 3.934215408825349*^9}, {
   3.934218470980182*^9, 3.9342184907355137`*^9}, {3.934220014951741*^9, 
   3.9342200324395914`*^9}, {3.9342204747469893`*^9, 
   3.9342204752158785`*^9}, {3.934473129912497*^9, 3.934473139112607*^9}, {
   3.934473221915594*^9, 3.934473241085556*^9}, 3.9344741088583755`*^9, {
   3.9345555682197657`*^9, 3.934555609805334*^9}, 3.934597816924536*^9, {
   3.934600923492016*^9, 3.9346009328711786`*^9}, 3.9351347762966237`*^9},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation", 
   "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[425]:=",ExpressionUUID->"84c2fefd-7917-44f9-be89-abd9cdc2b794"]
}, Closed]],

Cell[CellGroupData[{

Cell["Importing distributions", "Subsection",
 CellChangeTimes->{{3.934180740253267*^9, 3.934180742083174*^9}, {
  3.9344742392407455`*^9, 3.9344742433345695`*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"b5e9e7c7-fde1-\
419c-a976-dc94d5263400"],

Cell[BoxData[{
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"prod", ",", "prodbrem"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"prod", "=", 
       RowBox[{
        RowBox[{"ProductionPatternSelectedDistr", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dirimp", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"prod", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<DrellYan\>\"", ",", "\"\<Mixing\>\""}], "}"}]}], 
           "]"}], "&&", 
          RowBox[{"!", 
           RowBox[{"StringContainsQ", "[", 
            RowBox[{"prod", ",", "\"\<Mixing-Old\>\""}], "]"}]}]}], ",", 
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"directory", "[", "\"\<Distribution\>\"", "]"}], ",", 
            "\"\<Pregenerated\>\""}], "}"}], "]"}], ",", 
         RowBox[{"directory", "[", "\"\<Distribution\>\"", "]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Importing", " ", "the", " ", "data", " ", "with", " ", 
        "distribution"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"prod", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<AP\>\"", ",", "\"\<FR\>\""}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"DistrDataImport", "[", "prod", "]"}], "=", 
          RowBox[{"Abs", "[", 
           RowBox[{"Import", "[", 
            RowBox[{
             RowBox[{"FileNameJoin", "[", 
              RowBox[{"{", 
               RowBox[{"dirimp", ",", 
                RowBox[{
                "\"\<DoubleDistr_\>\"", "<>", "LLPdirName", "<>", "\"\<_\>\"",
                  "<>", "prod", "<>", "\"\<_\>\"", "<>", 
                 "FacilityGivenExperiment", "<>", "\"\<.m\>\""}]}], "}"}], 
              "]"}], ",", "\"\<MX\>\""}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"prod", "==", "\"\<DrellYan\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"DistrDataImport", "[", "prod", "]"}], "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"DistrDataImport", "[", "prod", "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "MinMaxMassesDrellYan", "[", "FacilityGivenExperiment", 
                   "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "<=", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "<=", 
                 RowBox[{
                  RowBox[{
                  "MinMaxMassesDrellYan", "[", "FacilityGivenExperiment", 
                   "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}]}], ";"}]}],
           "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "If", " ", "the", " ", "selected", " ", "channel", " ", "is", " ", 
           "Bremsstrahlung", " ", "under", " ", "the", " ", "description", 
           " ", "of", " ", "AP", " ", "or", " ", "FR"}], ",", " ", 
          RowBox[{
          "then", " ", "there", " ", "are", " ", "variants", " ", "for", " ", 
           "the", " ", "description", " ", "parametrizing", " ", "the", " ", 
           "theoretical", " ", "uncertainty"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"DistrDataImportTemp", "[", "prod", "]"}], "=", 
          RowBox[{"Import", "[", 
           RowBox[{
            RowBox[{"FileNameJoin", "[", 
             RowBox[{"{", 
              RowBox[{"dirimp", ",", 
               RowBox[{
               "\"\<DoubleDistr_\>\"", "<>", "LLPdirName", "<>", "\"\<_\>\"", 
                "<>", "prod", "<>", "\"\<_\>\"", "<>", 
                "FacilityGivenExperiment", "<>", "\"\<.m\>\""}]}], "}"}], 
             "]"}], ",", "\"\<MX\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"prodbrem", "=", 
             RowBox[{"prod", "<>", "\"\<-\>\"", "<>", 
              RowBox[{
               RowBox[{
                RowBox[{"DistrDataImportTemp", "[", "prod", "]"}], "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"DistrDataImport", "[", "prodbrem", "]"}], "=", 
             RowBox[{
              RowBox[{
               RowBox[{"DistrDataImportTemp", "[", "prod", "]"}], "[", 
               RowBox[{"[", "j", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"mlistDistr", "[", "prodbrem", "]"}], "=", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{
               RowBox[{"DistrDataImport", "[", "prodbrem", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"mLLPmin", "[", "prodbrem", "]"}], ",", 
               RowBox[{"mLLPmax", "[", "prodbrem", "]"}]}], "}"}], "=", 
             RowBox[{"MinMax", "[", 
              RowBox[{"mlistDistr", "[", "prodbrem", "]"}], "]"}]}], ";"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"DistrDataImportTemp", "[", "prod", "]"}], "]"}], ",", 
             "1"}], "}"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "ProductionPatternSelectedDistr", "]"}], ",", 
     "1"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"mlistDistr", "[", "prod", "]"}], "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{
         RowBox[{"DistrDataImport", "[", "prod", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"mLLPmin", "[", "prod", "]"}], ",", 
         RowBox[{"mLLPmax", "[", "prod", "]"}]}], "}"}], "=", 
       RowBox[{"MinMax", "[", 
        RowBox[{"mlistDistr", "[", "prod", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DoubleDistrLLPint", "[", 
        RowBox[{"mLLP_", ",", "\[Theta]LLP_", ",", "ELLP_", ",", "prod"}], 
        "]"}], "=", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Interpolation", "[", 
           RowBox[{
            RowBox[{"distrlogComp", "[", 
             RowBox[{"DistrDataImport", "[", "prod", "]"}], "]"}], ",", 
            RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
          RowBox[{
           RowBox[{"Log10", "[", "mLLP", "]"}], ",", 
           RowBox[{"Log10", "[", "\[Theta]LLP", "]"}], ",", 
           RowBox[{"Log10", "[", "ELLP", "]"}]}], "]"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"StringContainsQ", "[", 
         RowBox[{"prod", ",", "\"\<Bremsstrahlung\>\""}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"DoubleDistrLLPint", "[", 
          RowBox[{"mLLP_", ",", "\[Theta]LLP_", ",", "ELLP_", ",", "prod"}], 
          "]"}], "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ELLP", "<=", 
            RowBox[{"ELLPmax", "[", 
             RowBox[{"mLLP", ",", "\[Theta]LLP", ",", "prod"}], "]"}]}], ",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"DoubleDistrLLPint", "[", 
             RowBox[{"mLLP", ",", "\[Theta]LLP", ",", "ELLP", ",", "prod"}], 
             "]"}], "]"}], ",", "0."}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Probability", " ", "to", " ", "produce", " ", "LLP"}], "*)"}],
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ProbLLP", "[", 
        RowBox[{"mLLP_", ",", "finv_", ",", "prod"}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"ProbMother", "[", "prod", "]"}], "*", 
         RowBox[{"PmotherToLLP", "[", 
          RowBox[{
          "mLLP", ",", "finv", ",", "prod", ",", "FacilityGivenExperiment"}], 
          "]"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Atarget", "->", "AtargetVal"}], ",", 
          RowBox[{"Yield\[Rho]0", "->", 
           RowBox[{"ProbMother", "[", "\"\<Rho0\>\"", "]"}]}]}], "}"}]}]}], 
      ";"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"prod", ",", "ProductionList"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"GridInFinal", "[", "prod", "]"}], ",", 
         RowBox[{"DistrVals", "[", "prod", "]"}]}], "}"}], "=", 
       RowBox[{"BlockGridsValsDistr", "[", 
        RowBox[{"prod", ",", "DistrDataImport"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";"}], "//", 
   "AbsoluteTiming"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "___", "___", "___", "___", "___", "___", "___", "___", "___", "_"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Finding", " ", 
    SubscriptBox["E", "max"], 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["m", "LLP"], ",", 
      SubscriptBox["\[Theta]", "LLP"]}], ")"}], " ", "for", " ", "the", " ", 
    "angular", " ", "range", " ", "at", " ", "the", " ", "given", " ", 
    "experiment"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "___", "___", "___", "___", "___", "___", "___", "___", "___", "_"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ELLPmax", "[", 
      RowBox[{"mfip_", ",", "\[Theta]fip_", ",", "prod"}], "]"}], "=", 
     RowBox[{"EmaxBlock", "[", 
      RowBox[{
      "prod", ",", "8", ",", "DistrDataImport", ",", 
       "FacilityGivenExperiment"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"prod", ",", 
      RowBox[{"Select", "[", 
       RowBox[{"ProductionList", ",", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"#", ",", "\"\<Bremsstrahlung\>\""}], "]"}]}], "&"}]}], 
       "]"}]}], "}"}]}], "]"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{
  3.9341807845806675`*^9, 3.934214307032079*^9, {3.9342155410828047`*^9, 
   3.9342155846964006`*^9}, {3.934215620725315*^9, 3.934215703880828*^9}, {
   3.9342157486922917`*^9, 3.9342159080820465`*^9}, {3.9342159447090163`*^9, 
   3.9342159496738663`*^9}, {3.934215980035202*^9, 3.9342159914806213`*^9}, {
   3.934216048453127*^9, 3.9342160921093807`*^9}, {3.9342161417133284`*^9, 
   3.934216164786214*^9}, 3.9342178008978844`*^9, {3.9342183565411205`*^9, 
   3.9342184602415223`*^9}, {3.9344730789929667`*^9, 3.9344730887615805`*^9}, 
   3.9344731187625914`*^9, {3.9344741536938057`*^9, 3.934474157329474*^9}, {
   3.934476009268197*^9, 3.9344760126281433`*^9}, {3.9345555975546775`*^9, 
   3.9345556098154087`*^9}, {3.9346036593850937`*^9, 3.9346036666607723`*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation", 
   "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[439]:=",ExpressionUUID->"39a08be9-ca1a-4f6a-89d2-51bf771b0146"]
}, Closed]],

Cell[CellGroupData[{

Cell["Exporting averaged distribution", "Subsection",
 CellChangeTimes->{{3.934180740253267*^9, 3.934180747742608*^9}, {
  3.9342184269992228`*^9, 3.934218430923875*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"395687af-1da0-\
4489-b4f8-3c0e5ba2e9ce"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"directory", "[", "\"\<Auxiliary-experiment\>\"", "]"}], "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"directory", "[", "\"\<Auxiliary\>\"", "]"}], ",", 
      "SelectedExperiment"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"DirectoryQ", "[", 
      RowBox[{"directory", "[", "\"\<Auxiliary-experiment\>\"", "]"}], 
      "]"}]}], ",", 
    RowBox[{"CreateDirectory", "[", 
     RowBox[{"directory", "[", "\"\<Auxiliary-experiment\>\"", "]"}], "]"}]}],
    "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"directory", "[", "\"\<Auxiliary-experiment\>\"", "]"}], ",", 
       RowBox[{
       "\"\<Double-Distr-Averaged-\>\"", "<>", "LLPdirName", "<>", 
        "\"\<.m\>\""}]}], "}"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"mLLPmin", "[", "prod", "]"}], "<", "mLLP", "<", 
           RowBox[{"mLLPmax", "[", "prod", "]"}]}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"ProbLLP", "[", 
            RowBox[{"mLLP", ",", "1", ",", "prod"}], "]"}], "]"}], ",", "0"}],
          "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"mLLPmin", "[", "prod", "]"}], "<", "mLLP", "<", 
              RowBox[{"mLLPmax", "[", "prod", "]"}]}], ",", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"ProbLLP", "[", 
               RowBox[{"mLLP", ",", "1", ",", "prod"}], "]"}], "]"}], ",", 
             "0"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}]}], ")"}], 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"mLLPmin", "[", "prod", "]"}], "<", "mLLP", "<", 
            RowBox[{"mLLPmax", "[", "prod", "]"}]}], ",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{
             RowBox[{"ProbLLP", "[", 
              RowBox[{"mLLP", ",", "1", ",", "prod"}], "]"}], "*", 
             RowBox[{"DoubleDistrLLPint", "[", 
              RowBox[{"mLLP", ",", "\[Theta]LLP", ",", "ELLP", ",", "prod"}], 
              "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"prod", ",", "ProductionListBaseline"}], "}"}]}], "]"}]}]}],
      "}"}], ",", "\"\<MX\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9138264426995506`*^9, 3.9138265779867573`*^9}, {
   3.913826965658716*^9, 3.9138270942523136`*^9}, 3.913827173058236*^9, 
   3.9138280725351963`*^9, {3.9138685969328623`*^9, 3.9138686662515535`*^9}, {
   3.9138687097216063`*^9, 3.913868827467691*^9}, {3.9138699081836786`*^9, 
   3.913869908527342*^9}, {3.9138700197640233`*^9, 3.913870024259905*^9}, {
   3.913870742059718*^9, 3.913870786176013*^9}, {3.913871804452815*^9, 
   3.9138718044574027`*^9}, {3.9138882251043167`*^9, 
   3.9138882251093035`*^9}, {3.9140573961516905`*^9, 3.914057451010392*^9}, {
   3.9140667249964046`*^9, 3.9140667374592443`*^9}, {3.9140668849922748`*^9, 
   3.9140668860566907`*^9}, 3.915184627030238*^9, {3.9156430601988077`*^9, 
   3.9156430604241543`*^9}, 3.915727587776414*^9, {3.916672566533353*^9, 
   3.9166725686001234`*^9}, {3.9166726094945087`*^9, 
   3.9166726096747155`*^9}, {3.916679849894617*^9, 3.9166798503945646`*^9}, {
   3.9168533614169364`*^9, 3.916853382014995*^9}, {3.916853454789669*^9, 
   3.9168535530919013`*^9}, {3.91685422632805*^9, 3.9168542271898108`*^9}, 
   3.916856429758537*^9, 3.9168567750740905`*^9, {3.916994194511986*^9, 
   3.916994194639786*^9}, 3.928576878808322*^9, {3.9285769295898595`*^9, 
   3.928577135245227*^9}, {3.9304940756391134`*^9, 3.9304942536874704`*^9}, {
   3.930494292641827*^9, 3.9304943056256866`*^9}, {3.9304954383171363`*^9, 
   3.930495439377903*^9}, {3.9304954744111834`*^9, 3.9304955596511307`*^9}, {
   3.930495594730049*^9, 3.93049563725099*^9}, {3.9304956810266666`*^9, 
   3.930495682018281*^9}, {3.934177965824263*^9, 3.934178024335834*^9}, {
   3.9341780660321517`*^9, 3.934178109488278*^9}, {3.9341781687198305`*^9, 
   3.9341782811178565`*^9}, {3.934180632550871*^9, 3.934180632806182*^9}, {
   3.9341806890054445`*^9, 3.9341806931598024`*^9}, {3.934218259952458*^9, 
   3.93421826091879*^9}, {3.934218296442099*^9, 3.9342183541896987`*^9}, {
   3.93421840615699*^9, 3.9342184371250544`*^9}, 3.9345978169333267`*^9},
 CellTags->{
  "Number-of-events-computation", "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[443]:=",ExpressionUUID->"480fd17b-5a11-467d-8339-95713cf8a148"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Plots", "Section",
 CellChangeTimes->{{3.9341806241273217`*^9, 3.9341806246845126`*^9}},
 CellTags->{
  "Number-of-events-computation", "Number-of-events-computation+sensitivity", 
   "Acceptance-computation"},ExpressionUUID->"b56c7d96-1fbc-45ca-9131-\
b352e77d4423"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptenergies", "=", 
   RowBox[{"LogLogPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"ELLPmax", "[", 
         RowBox[{"0.1", ",", "\[Theta]LLP", ",", "prod"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "ProductionListBaseline"}], "}"}]}], "]"}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]LLP", ",", "\[Theta]minExp", ",", "\[Theta]maxExp"}], 
      "}"}], ",", 
     RowBox[{"Frame", "->", "True"}], ",", 
     RowBox[{"ImageSize", "->", "Large"}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"Placed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"#", ",", "15"}], "]"}], "&"}], "/@", 
         "ProductionListBaseline"}], ",", "Right"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ptprodprob", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"prl", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ProductionListBaseline", "/.", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Bremsstrahlung-FR-Central\>\"", "->", 
            "\"\<Bremsstrahlung\>\""}], "}"}]}], "//", "Sort"}], ")"}]}], 
      "}"}], ",", 
     RowBox[{"LogLogPlot", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"ProbLLP", "[", 
           RowBox[{"ma", ",", "1", ",", "prod"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", 
            RowBox[{"Sort", "[", "ProductionListBaseline", "]"}]}], "}"}]}], 
         "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ma", ",", "mmin\[Epsilon]", ",", "mmax\[Epsilon]"}], "}"}], 
       ",", 
       RowBox[{"Frame", "->", "True"}], ",", 
       RowBox[{"ImageSize", "->", "Large"}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"#", ",", "16"}], "]"}], "&"}], "/@", "prl"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.2", ",", "0.28"}], "}"}]}], "]"}]}], ",", " ", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", " ", "25"}], "]"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.02", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            SuperscriptBox["10", 
             RowBox[{"-", "8"}]], ",", "100"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", 
             RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", "Cyan"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Magenta"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Brown"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", "0.66"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<\!\(\*SubscriptBox[\(m\), \(LLP\)]\) [GeV]\>\"", ",", 
          "\"\<\!\(\*SubscriptBox[\(P\), \(prod\)]\)/\!\(\*SuperscriptBox[\(\
\[Epsilon]\), \(2\)]\)\>\""}], "}"}]}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Production probabilities of \>\"", ",", "LLPdirName", ",", 
             "\"\< at \>\"", ",", "FacilityGivenExperiment"}], "}"}], "]"}], 
          ",", "18", ",", "Black"}], "]"}]}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ptprodprobbrem", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"prl", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"BremVariantsGivenFacility", ",", 
         RowBox[{
          RowBox[{"#", "!=", "\"\<Bremsstrahlung-FR-Central\>\""}], "&"}]}], 
        "]"}]}], "}"}], ",", 
     RowBox[{"LogLogPlot", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"ProbLLP", "[", 
           RowBox[{"ma", ",", "1", ",", "prod"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "prl"}], "}"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ma", ",", "mmin\[Epsilon]", ",", "mmax\[Epsilon]"}], "}"}], 
       ",", 
       RowBox[{"Frame", "->", "True"}], ",", 
       RowBox[{"ImageSize", "->", "Large"}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", " ", "25"}], "]"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.02", ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            SuperscriptBox["10", 
             RowBox[{"-", "8"}]], ",", "1000"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Blue", ",", 
            RowBox[{"Dashing", "[", "0.01", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Lighter", "@", 
             RowBox[{"Lighter", "@", "Blue"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Lighter", "@", 
             RowBox[{"Lighter", "@", "Blue"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", "Cyan"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Magenta"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Brown"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", "0.66"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<\!\(\*SubscriptBox[\(m\), \(LLP\)]\) [GeV]\>\"", ",", 
          "\"\<\!\(\*SubscriptBox[\(P\), \(prod\)]\)/\!\(\*SuperscriptBox[\(\
\[Epsilon]\), \(2\)]\)\>\""}], "}"}]}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Production probabilities of \>\"", ",", "LLPdirName", ",", 
             "\"\< at \>\"", ",", "FacilityGivenExperiment"}], "}"}], "]"}], 
          ",", "18", ",", "Black"}], "]"}]}], ",", 
       RowBox[{"Filling", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"2", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "3", "}"}], ",", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Lighter", "@", "Blue"}], ",", 
              RowBox[{"Opacity", "[", "0.1", "]"}]}], "]"}]}], "}"}]}], 
         "}"}]}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Style", "[", 
  RowBox[{
   RowBox[{"Row", "[", 
    RowBox[{"{", 
     RowBox[{"ptenergies", ",", 
      RowBox[{"Show", "[", 
       RowBox[{"ptprodprob", ",", "ptprodprobbrem"}], "]"}]}], "}"}], "]"}], 
   ",", 
   RowBox[{"ImageSizeMultipliers", "->", 
    RowBox[{"{", 
     RowBox[{"1", ",", " ", "1", ",", "1"}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.934218518515441*^9, 3.934218537902442*^9}, 
   3.9342185941166706`*^9, {3.9342186376090508`*^9, 3.9342186376374598`*^9}, {
   3.93421938331448*^9, 3.9342193923497753`*^9}, {3.9345978169333267`*^9, 
   3.934597816943096*^9}, {3.9347398342293386`*^9, 3.9347398367196236`*^9}, {
   3.93525114124*^9, 3.935251187539447*^9}, {3.9352513550984387`*^9, 
   3.935251357686199*^9}, {3.935251397376196*^9, 3.935251423732613*^9}, {
   3.9352514706619773`*^9, 3.935251474443635*^9}, {3.935251755132921*^9, 
   3.93525175815399*^9}, 3.9354199571415243`*^9},
 CellTags->{
  "Number-of-events-computation", "Number-of-events-computation+sensitivity", 
   "Acceptance-computation"},
 CellLabel->
  "In[446]:=",ExpressionUUID->"62acfb65-1702-4136-a9c7-b00e002329b7"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Number of events", "Chapter",
 CellChangeTimes->{{3.8935731783578434`*^9, 3.893573180246764*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"0f308b41-d607-\
4d23-bea6-f98cdbbab013"],

Cell[CellGroupData[{

Cell["Number of events - using the mapping method ", "Section",
 CellChangeTimes->{{3.897198873663946*^9, 3.8971988750678434`*^9}, 
   3.9165065585390453`*^9, 3.9165070655729046`*^9},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"1ee4b6fc-436c-\
44ba-9c25-aac28ca9c035"],

Cell[CellGroupData[{

Cell["Initializing all routines", "Subsection",
 CellChangeTimes->{{3.897199076623907*^9, 3.8971990900052223`*^9}, {
   3.8972009084104066`*^9, 3.897200920680235*^9}, 3.916506561920749*^9, {
   3.9165071319109154`*^9, 3.916507136145134*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"0a1f8dc1-244c-\
4013-a4f6-a6748a821672"],

Cell[BoxData[{
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"OutGrid\[Theta]final", "[", "prod", "]"}], ",", 
      RowBox[{"\[CapitalDelta]\[Theta]vals", "[", "prod", "]"}]}], "}"}], "=", 
    RowBox[{"OutGrid\[Theta]Temp", "[", 
     RowBox[{"InGrid\[Theta]\[Epsilon]", ",", "30", ",", "prod", ",", 
      RowBox[{"\[Theta]maxBrem", "[", "prod", "]"}]}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"prod", ",", "ProductionList"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"OutGridzfinal", ",", "\[CapitalDelta]zvals"}], "}"}], "=", 
    RowBox[{"OutGridszTemp", "[", 
     RowBox[{"InGridz\[Epsilon]", ",", "30", ",", "zminExp"}], "]"}]}], ";"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Final", " ", "energy", " ", 
     RowBox[{"grid", ".", " ", "Mass"}]}], "-", " ", 
    RowBox[{"and", " ", "production", " ", "channel"}], "-", "dependent"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"FacilityGivenExperiment", "!=", "\"\<ESS\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"StepEtemp", "[", "Efip_", "]"}], "=", 
      RowBox[{"Piecewise", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.3", ",", 
           RowBox[{"Efip", "\[LessEqual]", "2.5"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.5", ",", 
           RowBox[{"2.5", "<", "Efip", "<", "35"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", 
           RowBox[{"35", "\[LessEqual]", "Efip", "\[LessEqual]", "50"}]}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", 
           RowBox[{"50", "<", "Efip", "<", "160"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"5", ",", 
           RowBox[{"160", "\[LessEqual]", "Efip", "<=", "400"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"25", ",", 
           RowBox[{"400", "<", "Efip", "<", "600"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"50", ",", 
           RowBox[{"600", "<=", "Efip", "<", "2000"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"200", ",", 
           RowBox[{"2000", "\[LessEqual]", "Efip", "<", "4000"}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"400", ",", 
           RowBox[{"4000", "\[LessEqual]", "Efip", "<", "7000"}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"500", ",", 
           RowBox[{
           "7000", "\[LessEqual]", "Efip", "\[LessEqual]", "50000"}]}], 
          "}"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"OutGridEnergy", "[", 
       RowBox[{"m_", ",", "ProdChannel_"}], "]"}], ":=", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"emin", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"StringContainsQ", "[", 
              RowBox[{"ProdChannel", ",", "\"\<Bremsstrahlung\>\""}], "]"}]}],
             ",", 
            RowBox[{"N", "[", "m", "]"}], ",", 
            RowBox[{"ELLPmin", "[", "ProdChannel", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"egridtemp", "=", 
          RowBox[{
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"start", "=", "emin"}], ",", 
               RowBox[{"end", "=", 
                RowBox[{"ELLPmax", "[", 
                 RowBox[{"m", ",", "\[Theta]minExp", ",", "ProdChannel"}], 
                 "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Log10", "[", 
              RowBox[{"NestWhileList", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "+", 
                  RowBox[{"StepEtemp", "[", "#", "]"}]}], "&"}], ",", "start",
                 ",", 
                RowBox[{
                 RowBox[{"#", "\[LessEqual]", "end"}], "&"}], ",", "1", ",", 
                "\[Infinity]", ",", 
                RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}], "//", "N"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "egridtemp", "]"}], "==", "1"}], ",", 
           RowBox[{"egridtemp", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"egridtemp", ",", 
              RowBox[{"{", 
               RowBox[{"Log10", "[", 
                RowBox[{"2", "*", "emin"}], "]"}], "}"}]}], "]"}]}]}], "]"}], 
         ";", "\[IndentingNewLine]", "egridtemp"}]}], "\[IndentingNewLine]", 
       "]"}]}]}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"StepEtemp", "[", "Efip_", "]"}], "=", "0.001"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"OutGridEnergy", "[", 
       RowBox[{"m_", ",", "ProdChannel_"}], "]"}], ":=", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tabt", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"e", ",", 
            RowBox[{"{", 
             RowBox[{"e", ",", 
              RowBox[{"1.0001", "m"}], ",", 
              RowBox[{"ELLPmax", "[", 
               RowBox[{"m", ",", "\[Theta]minExp", ",", "ProdChannel"}], 
               "]"}], ",", "0.001"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "tabt", "]"}], "==", "1"}], ",", 
           RowBox[{"tabt", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{"tabt", ",", 
                RowBox[{"{", 
                 RowBox[{"ELLPmax", "[", 
                  RowBox[{"m", ",", "\[Theta]minExp", ",", "ProdChannel"}], 
                  "]"}], "}"}]}], "]"}], "//", "Sort"}], "//", 
             "DeleteDuplicates"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Log10", "[", "tabt", "]"}], "//", "N"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}]}], "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
    "___", "___", "___", "___", "___", "___", "___", "_"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Block", " ", "that", " ", "computes", " ", "the", " ", "grid", " ", 
     SubscriptBox["\[Theta]", "S"]}], ",", 
    SubscriptBox["E", "S"], ",", 
    SubscriptBox["z", "S"], ",", " ", 
    RowBox[{
     SubscriptBox["\[Epsilon]", "Full"], "\[Times]", 
     SubscriptBox["f", 
      RowBox[{
       SubscriptBox["\[Theta]", "S"], ",", 
       SubscriptBox["E", "S"]}]]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
    "___", "___", "___", "___", "___", "___", "___", "_"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "The", " ", "block", " ", "which", " ", "sets", " ", "all", " ", "the", 
      " ", "values", " ", "of", " ", 
      SubscriptBox["\[Epsilon]", "Full"], "\[Times]", 
      SubscriptBox["f", 
       RowBox[{"\[Theta]", ",", "E"}]], " ", "for", " ", "which", " ", "E"}], 
     " ", "<", " ", 
     RowBox[{
      SubscriptBox["E", "max"], " ", "to", " ", "zero"}]}], ",", " ", 
    RowBox[{"for", " ", "Bremsstrahlung"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"createCompiledFunctionBrem", "[", "BremChoice_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "func", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"func", "[", 
        RowBox[{"mfip_", ",", "th_"}], "]"}], "=", 
       RowBox[{"ELLPmax", "[", 
        RowBox[{"mfip", ",", "th", ",", "BremChoice"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Hold", "@", 
         RowBox[{"Compile", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"angleenergy", ",", "_Real", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"mfip", ",", "_Real"}], "}"}]}], "}"}], ",", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"angles", ",", "energies", ",", "distrvals", ",", "d"}],
               "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"angles", "=", 
               RowBox[{"Compile`GetElement", "[", 
                RowBox[{"angleenergy", ",", "1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"energies", "=", 
               RowBox[{"Compile`GetElement", "[", 
                RowBox[{"angleenergy", ",", "2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"distrvals", "=", 
               RowBox[{"Compile`GetElement", "[", 
                RowBox[{"angleenergy", ",", "3"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"d", "=", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"energies", "<", 
                  RowBox[{"func", "[", 
                   RowBox[{"mfip", ",", "angles"}], "]"}]}], ",", "distrvals",
                  ",", 
                 RowBox[{"10", "^", 
                  RowBox[{"-", "90."}]}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", "d"}]}], "]"}], ",", 
           RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
           RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
           RowBox[{"RuntimeAttributes", "->", 
            RowBox[{"{", "Listable", "}"}]}], ",", 
           RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], "/.", " ", 
        RowBox[{"DownValues", "@", "func"}]}], "//", "ReleaseHold"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Generate", " ", "a", " ", "dictionary", " ", "of", " ", "compiled", " ", 
    "functions", " ", "for", " ", "each", " ", "variant"}], "*)"}], 
  RowBox[{
   RowBox[{"compiledBremCutter", "=", 
    RowBox[{"AssociationThread", "[", 
     RowBox[{"BremVariantsGivenFacility", ",", 
      RowBox[{
      "createCompiledFunctionBrem", "/@", "BremVariantsGivenFacility"}]}], 
     "]"}]}], ";"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BremCut", "[", 
    RowBox[{
    "OutGrid\[Theta]final_", ",", "OutGridEfinal_", ",", "distr_", ",", 
     "mLLP_", ",", "bremChoice_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"angleenergy", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"10", "^", 
          RowBox[{"Tuples", "[", 
           RowBox[{"{", 
            RowBox[{"OutGrid\[Theta]final", ",", "OutGridEfinal"}], "}"}], 
           "]"}]}], ",", 
         RowBox[{"Partition", "[", 
          RowBox[{"distr", ",", "1"}], "]"}], ",", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"compiledFunc", "=", 
       RowBox[{"compiledBremCutter", "[", "bremChoice", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"compiledFunc", "[", 
       RowBox[{"angleenergy", ",", "mLLP"}], "]"}]}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TableIntegrandDiscret", "[", 
   RowBox[{"m_", ",", "ProdChannel_", ",", "\[Epsilon]DecOp_"}], "]"}], ":=", 
  RowBox[{"TableIntegrandDiscretTemp", "[", 
   RowBox[{
   "m", ",", "ProdChannel", ",", "\[Epsilon]DecOp", ",", "\[Epsilon]vals", 
    ",", "\[Epsilon]azvals", ",", 
    RowBox[{"OutGrid\[Theta]final", "[", "ProdChannel", "]"}], ",", 
    "OutGridzfinal", ",", "OutGridEnergy", ",", "InGridm\[Epsilon]", ",", 
    "InGrid\[Theta]\[Epsilon]", ",", "InGridE\[Epsilon]", ",", 
    "InGridz\[Epsilon]", ",", 
    RowBox[{"\[CapitalDelta]\[Theta]vals", "[", "ProdChannel", "]"}], ",", 
    "\[CapitalDelta]zvals", ",", "zminExp", ",", "GridInFinal", ",", 
    "DistrVals", ",", "FacilityGivenExperiment", ",", "ELLPmax", ",", 
    "\[Theta]minExp"}], "]"}]}]}], "Input",
 CellChangeTimes->{
  3.914065400601883*^9, {3.9144955915086913`*^9, 3.914495605102999*^9}, {
   3.9144963994464297`*^9, 3.91449645003281*^9}, 3.9156429961809263`*^9, 
   3.9162514062581673`*^9, {3.916332203281742*^9, 3.9163322040420866`*^9}, {
   3.916332256159724*^9, 3.916332315776701*^9}, {3.916332682855117*^9, 
   3.9163326972784367`*^9}, {3.916332729581109*^9, 3.9163327827424307`*^9}, {
   3.916332995032469*^9, 3.9163330418518543`*^9}, {3.9163330893535175`*^9, 
   3.9163331201157775`*^9}, {3.9163883031455355`*^9, 
   3.9163883099402237`*^9}, {3.91639027241718*^9, 3.9163902725145645`*^9}, {
   3.916390440036625*^9, 3.9163904429286966`*^9}, {3.9163913725242844`*^9, 
   3.9163913900649643`*^9}, {3.9165060112532883`*^9, 
   3.9165060531405983`*^9}, {3.916506386454261*^9, 3.9165063916867723`*^9}, {
   3.9165064378147545`*^9, 3.9165064402046285`*^9}, {3.9165066063487997`*^9, 
   3.9165066068133373`*^9}, {3.916506770781*^9, 3.916506770986845*^9}, {
   3.916506818360832*^9, 3.9165068344941483`*^9}, {3.91650702210918*^9, 
   3.916507055596775*^9}, 3.9165070945532026`*^9, {3.9165072348013864`*^9, 
   3.916507258828418*^9}, {3.9165082243803825`*^9, 3.9165082246202836`*^9}, {
   3.9165089341902933`*^9, 3.9165089344447165`*^9}, {3.916671056709384*^9, 
   3.9166710572925243`*^9}, {3.916671102174552*^9, 3.9166711025636616`*^9}, 
   3.9166780407550383`*^9, 3.916680838094392*^9, {3.9168544917944636`*^9, 
   3.9168545473601933`*^9}, 3.9181398756136556`*^9, {3.918144219656443*^9, 
   3.9181442212459908`*^9}, {3.934219577450571*^9, 3.934219578950474*^9}, {
   3.9342210560466623`*^9, 3.934221059856845*^9}, 3.934221144529281*^9, {
   3.934221420387479*^9, 3.9342214386984067`*^9}, 3.9347030468763976`*^9, {
   3.9347392939181414`*^9, 3.9347392963294926`*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[450]:=",ExpressionUUID->"6acd5b9d-3d21-4c1b-bfa2-65d6c8a2ce8a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Generalized acceptances", "Subsection",
 CellChangeTimes->{{3.9165071505021195`*^9, 3.9165071536920986`*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"e409be1f-14c9-\
48b7-a089-70f654ff54f3"],

Cell[CellGroupData[{

Cell["Definitions", "Subsubsection",
 CellChangeTimes->{{3.9347377057465973`*^9, 3.9347377246837664`*^9}},
 CellTags->{
  "Number-of-events-computation+sensitivity", 
   "Acceptance-computation"},ExpressionUUID->"d796baed-9379-49b2-9181-\
870a19db5beb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Tabulated", " ", "acceptance"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FactorANUBISceiling", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"SelectedExperiment", "==", "\"\<ANUBIS-ceiling\>\""}], ",", 
       "2", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AcceptanceDiscret", "[", 
     RowBox[{
     "m_", ",", "ProdChannel_", ",", "\[Epsilon]decOp_", ",", "decProb_"}], 
     "]"}], ":=", 
    RowBox[{"AcceptanceDiscretTemp", "[", 
     RowBox[{
     "m", ",", "ProdChannel", ",", "\[Epsilon]decOp", ",", "decProb", ",", 
      "mLLPmin", ",", "mmin\[Epsilon]", ",", "mLLPmax", ",", "mmax\[Epsilon]",
       ",", "ELLPmax", ",", "\[Theta]minExp", ",", "TableIntegrandDiscret", 
      ",", "BrVis", ",", "zmaxExp", ",", "zminExp", ",", 
      "FactorANUBISceiling", ",", "0."}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"mlistAcceptance", "[", "prod", "]"}], "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"m", ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", 
             RowBox[{"1.01", 
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{"mLLPmin", "[", "prod", "]"}], ",", 
                "mmin\[Epsilon]"}], "]"}]}], ",", 
             RowBox[{"0.95", 
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{"mLLPmax", "[", "prod", "]"}], ",", 
                "mmax\[Epsilon]"}], "]"}]}], ",", 
             RowBox[{"Min", "[", 
              RowBox[{
               FractionBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"0.95", 
                   RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"mLLPmax", "[", "prod", "]"}], ",", 
                    "mmax\[Epsilon]"}], "]"}]}], "-", 
                  RowBox[{"1.01", 
                   RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"mLLPmin", "[", "prod", "]"}], ",", 
                    "mmin\[Epsilon]"}], "]"}]}]}], ")"}], "20"], ",", "2"}], 
              "]"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.99", 
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"mLLPmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}], 
            "]"}]}], "}"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], 
    ";"}]}]}]], "Input",
 CellTags->{
  "Number-of-events-computation+sensitivity", "Acceptance-computation"},
 CellLabel->
  "In[457]:=",ExpressionUUID->"6f523e27-7474-4bc3-85a9-e590c4367387"]
}, Closed]],

Cell[CellGroupData[{

Cell["Calculating tabulated acceptances", "Subsubsection",
 CellChangeTimes->{{3.9347377057465973`*^9, 3.9347377186386113`*^9}},
 CellTags->{
  "Number-of-events-computation+sensitivity", 
   "Acceptance-computation"},ExpressionUUID->"e0313994-0412-44d9-9abd-\
42a7f9d81f79"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "=", 
         RowBox[{"ParallelTable", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"m", ",", 
             RowBox[{"AcceptanceDiscret", "[", 
              RowBox[{"m", ",", "prod", ",", "\"\<False\>\"", ",", "0"}], 
              "]"}], ",", 
             RowBox[{"AcceptanceDiscret", "[", 
              RowBox[{"m", ",", "prod", ",", "\"\<True\>\"", ",", "0"}], 
              "]"}], ",", 
             RowBox[{"AcceptanceDiscret", "[", 
              RowBox[{"m", ",", "prod", ",", "\"\<False\>\"", ",", "1"}], 
              "]"}], ",", 
             RowBox[{"AcceptanceDiscret", "[", 
              RowBox[{"m", ",", "prod", ",", "\"\<True\>\"", ",", "1"}], 
              "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", 
             RowBox[{"mlistAcceptance", "[", "prod", "]"}]}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Max", "[", 
                RowBox[{
                 RowBox[{"mLLPmin", "[", "prod", "]"}], ",", 
                 "mmin\[Epsilon]"}], "]"}], "}"}], ",", 
              RowBox[{"Drop", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}]}], "]"}], 
            "}"}], ",", 
           RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Min", "[", 
                RowBox[{
                 RowBox[{"mLLPmax", "[", "prod", "]"}], ",", 
                 "mmax\[Epsilon]"}], "]"}], "}"}], ",", 
              RowBox[{"Drop", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "1"}], "]"}], "]"}], ",", "1"}], "]"}]}], 
             "]"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";"}], "//", 
    "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PlotAcc", "[", "ProdChannel_", "]"}], ":=", 
    RowBox[{"ListLogPlot", "[", 
     RowBox[{
      RowBox[{"Evaluate", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "4"}], "}"}]}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "5"}], "}"}]}], "]"}], "]"}]}], "}"}], "]"}], 
      ",", 
      RowBox[{"FrameStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", " ", "22"}], "]"}]}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Blue"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
           RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
           RowBox[{"Darker", "@", 
            RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Black"}], "}"}]}], 
        "}"}]}], ",", 
      RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"MinMax", "[", 
          RowBox[{
           RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"0.9", 
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{"Min", "[", 
                 RowBox[{
                  RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], 
                  "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}], ",", 
                RowBox[{"Min", "[", 
                 RowBox[{
                  RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], 
                  "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}], "]"}]}], 
             ",", 
             SuperscriptBox["10", 
              RowBox[{"-", "5"}]]}], "]"}], ",", 
           RowBox[{"1.1", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}]}], "]"}]}]}], 
          "}"}]}], "}"}]}], ",", 
      RowBox[{"Joined", "\[Rule]", "True"}], ",", 
      RowBox[{"Frame", "\[Rule]", "True"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(m\), \(LLP\)]\) [GeV]\>\"", ",", 
         "\"\<Acceptance\>\""}], "}"}]}], ",", 
      RowBox[{"PlotLabel", "\[Rule]", " ", 
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"Row", "[", 
          RowBox[{"{", 
           RowBox[{"\"\<From \>\"", ",", "ProdChannel"}], "}"}], "]"}], ",", 
         " ", "20", ",", " ", "Black"}], "]"}]}], ",", 
      RowBox[{"PlotLegends", "\[Rule]", 
       RowBox[{"Placed", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"#", ",", " ", "18"}], "]"}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{
            "\"\<<\!\(\*SubscriptBox[\(\[Epsilon]\), \(LLP\)]\)>\>\"", ",", 
             "\"\<<\!\(\*SubscriptBox[\(\[Epsilon]\), \
\(LLP\)]\)\!\(\*SubscriptBox[\(\[Epsilon]\), \(decay\)]\)>\>\"", ",", 
             "\"\<c\[Tau]<\!\(\*SubscriptBox[\(\[Epsilon]\), \
\(LLP\)]\)\!\(\*SubscriptBox[\(P\), \(decay\)]\)>\>\"", ",", 
             "\"\<c\[Tau]<\!\(\*SubscriptBox[\(\[Epsilon]\), \
\(LLP\)]\)\!\(\*SubscriptBox[\(P\), \(decay\)]\)\!\(\*SubscriptBox[\(\
\[Epsilon]\), \(decay\)]\)>\>\""}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.75", ",", "0.2"}], "}"}]}], "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"Style", "[", 
    RowBox[{
     RowBox[{"Row", "[", 
      RowBox[{"Evaluate", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"PlotAcc", "[", "prod", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "]"}], 
      "]"}], ",", 
     RowBox[{"ImageSizeMultipliers", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"FilenameAcceptance", "[", "prod", "]"}], "=", 
        RowBox[{"ToString", "@", 
         RowBox[{"StringForm", "[", 
          RowBox[{"\"\<Acceptance_ALP-fermion_at_``_From_``.dat\>\"", ",", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"{", 
             RowBox[{"SelectedExperiment", ",", 
              RowBox[{"ExportList", "[", "prod", "]"}]}], "}"}]}]}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], ",", 
            "\"\<Auxiliary data/ALPs with fermion coupling\>\"", ",", 
            "SelectedExperiment", ",", 
            RowBox[{"FilenameAcceptance", "[", "prod", "]"}]}], "}"}], "]"}], 
         ",", 
         RowBox[{
          RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", "4", ",", "5"}], "}"}]}], "]"}], 
          "]"}], ",", "\"\<Table\>\""}], "]"}]}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AccAveraged", "[", 
      RowBox[{"mLLP_", ",", "c\[Tau]_"}], "]"}], "=", 
     RowBox[{"NpotGivenExperiment", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"mLLPmin", "[", "prod", "]"}], "<", "mLLP", "<", 
             RowBox[{"mLLPmax", "[", "prod", "]"}]}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"ProbLLP", "[", 
              RowBox[{"mLLP", ",", "1", ",", "prod"}], "]"}], "]"}], ",", 
            "0"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "ProductionListBaseline"}], "}"}]}], "]"}], 
        ",", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"mLLPmin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}],
               "]"}], "<", "mLLP", "<", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"mLLPmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}],
               "]"}]}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{
              RowBox[{"ProbLLP", "[", 
               RowBox[{"mLLP", ",", "1", ",", "prod"}], "]"}], "*", 
              RowBox[{
               RowBox[{"Interpolation", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
                 RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[",
                "mLLP", "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "ProductionListBaseline"}], "}"}]}], "]"}], 
        ",", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"mLLPmin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}],
               "]"}], "<", "mLLP", "<", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"mLLPmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}],
               "]"}]}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{
              FractionBox[
               RowBox[{"ProbLLP", "[", 
                RowBox[{"mLLP", ",", "1", ",", "prod"}], "]"}], "c\[Tau]"], 
              "*", 
              RowBox[{
               RowBox[{"Interpolation", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "4"}], "}"}]}], "]"}], "]"}], ",", 
                 RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[",
                "mLLP", "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "ProductionListBaseline"}], "}"}]}], "]"}], 
        ",", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"mLLPmin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}],
               "]"}], "<", "mLLP", "<", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"mLLPmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}],
               "]"}]}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{
              FractionBox[
               RowBox[{"ProbLLP", "[", 
                RowBox[{"mLLP", ",", "1", ",", "prod"}], "]"}], "c\[Tau]"], 
              "*", 
              RowBox[{
               RowBox[{"Interpolation", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "5"}], "}"}]}], "]"}], "]"}], ",", 
                 RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[",
                "mLLP", "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "ProductionListBaseline"}], "}"}]}], "]"}]}], 
       "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"directory", "[", "\"\<Auxiliary-experiment\>\"", "]"}], ",", 
         RowBox[{
         "\"\<AcceptanceAveraged-\>\"", "<>", "LLPdirName", "<>", 
          "\"\<.m\>\""}]}], "}"}], "]"}], ",", 
      RowBox[{"AccAveraged", "[", 
       RowBox[{"mLLP", ",", "c\[Tau]"}], "]"}], ",", "\"\<MX\>\""}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9165072608467913`*^9, 3.91650727179105*^9}, {
   3.916511834115503*^9, 3.9165119704481926`*^9}, {3.9166711144696927`*^9, 
   3.9166711149830294`*^9}, {3.928577551907442*^9, 3.9285775525898123`*^9}, {
   3.934219643234742*^9, 3.9342196518452215`*^9}, {3.934597816963075*^9, 
   3.9345978169732704`*^9}, 3.9347377224678707`*^9},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[460]:=",ExpressionUUID->"0da87de1-0190-4840-a5aa-6c481e91b34e"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Rough estimates of the upper and lower bounds", "Subsection",
 CellChangeTimes->{{3.8850328066928463`*^9, 3.8850328135228024`*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"6ff9d28c-eed8-\
4817-92f4-3f387708a5b0"],

Cell[BoxData[{
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"LowerBoundEstimate", "[", 
      RowBox[{"mLLP_", ",", "prod"}], "]"}], "=", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"NpotGivenExperiment", "*", 
          RowBox[{"ProbLLP", "[", 
           RowBox[{"mLLP", ",", "1", ",", "prod"}], "]"}], "*", 
          RowBox[{
           RowBox[{"Interpolation", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "5"}], "}"}]}], "]"}], "]"}], ",", 
             RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
           "mLLP", "]"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"2.3", 
          RowBox[{"ldecayLLP", "[", 
           RowBox[{"mLLP", ",", "1", ",", "ELLP"}], "]"}], 
          FractionBox["mLLP", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["ELLP", "2"], "-", 
             SuperscriptBox["mLLP", "2"]}]]]}], ")"}]}], ")"}], 
      RowBox[{"-", 
       FractionBox["1", "2"]}]]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"UpperBoundEstimate", "[", 
      RowBox[{"mLLP_", ",", "prod"}], "]"}], "=", 
     RowBox[{"(", 
      RowBox[{"Abs", "[", 
       RowBox[{"Re", "[", 
        RowBox[{"Evaluate", "[", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"ProductLog", "[", 
             RowBox[{
              RowBox[{"-", "1"}], ",", 
              RowBox[{
               RowBox[{"-", "2.3"}], "*", 
               FractionBox["b", "a"]}]}], "]"}], "b"]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"a", "\[Rule]", " ", 
             RowBox[{"NpotGivenExperiment", "*", 
              RowBox[{"ProbLLP", "[", 
               RowBox[{"mLLP", ",", "1", ",", "prod"}], "]"}], "*", 
              RowBox[{
               RowBox[{"Interpolation", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
                 RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[",
                "mLLP", "]"}]}]}], ",", 
            RowBox[{"b", "\[Rule]", 
             FractionBox["zminExp", 
              RowBox[{"ldecayLLP", "[", 
               RowBox[{"mLLP", ",", "1", ",", 
                RowBox[{"ELLPmax", "[", 
                 RowBox[{"0.5", ",", "\[Theta]minExp", ",", "prod"}], "]"}]}],
                "]"}]]}]}], "}"}]}], "]"}], "]"}], "]"}], ")"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"prod", ",", "ProductionList"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ProdTest", "=", 
  RowBox[{"ProductionList", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"LogLogPlot", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"0.3", 
       RowBox[{"LowerBoundEstimate", "[", 
        RowBox[{"mLLP", ",", "ProdTest"}], "]"}]}], ",", 
      RowBox[{"1.8", 
       RowBox[{"UpperBoundEstimate", "[", 
        RowBox[{"mLLP", ",", "ProdTest"}], "]"}]}]}], "}"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"mLLP", ",", 
     RowBox[{"Max", "[", 
      RowBox[{
       RowBox[{"mLLPmin", "[", "ProdTest", "]"}], ",", "mmin\[Epsilon]"}], 
      "]"}], ",", 
     RowBox[{"Min", "[", 
      RowBox[{
       RowBox[{"mLLPmax", "[", "ProdTest", "]"}], ",", "mmax\[Epsilon]"}], 
      "]"}]}], "}"}], ",", 
   RowBox[{"Frame", "->", "True"}], ",", 
   RowBox[{"ImageSize", "->", "Large"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8927045521296835`*^9, 3.892704618398532*^9}, {
   3.892704651576499*^9, 3.892704652867281*^9}, 3.8951292466391563`*^9, {
   3.8972064547512426`*^9, 3.8972064548441195`*^9}, {3.8972065272743893`*^9, 
   3.8972065273639555`*^9}, {3.897208556347765*^9, 3.8972085563922853`*^9}, {
   3.8972086426345124`*^9, 3.897208654173244*^9}, {3.897232414966792*^9, 
   3.8972324175870733`*^9}, {3.8972329876997476`*^9, 3.897233009729268*^9}, {
   3.8972333224369483`*^9, 3.8972333287617497`*^9}, 3.897233684153979*^9, {
   3.8972340069416475`*^9, 3.897234007169805*^9}, {3.897234114920539*^9, 
   3.8972341194170074`*^9}, {3.9027273710668883`*^9, 3.902727371070483*^9}, {
   3.9037896747950044`*^9, 3.903789674805071*^9}, {3.903791118363947*^9, 
   3.9037911183684855`*^9}, {3.9037936813200336`*^9, 3.903793682290308*^9}, {
   3.9049231517292624`*^9, 3.904923157976531*^9}, {3.9049231902009006`*^9, 
   3.904923190656528*^9}, 3.904926376200742*^9, {3.911027289230471*^9, 
   3.9110273124658933`*^9}, {3.9110277505648003`*^9, 3.911027764091008*^9}, 
   3.913866752239462*^9, {3.9138675516462307`*^9, 3.9138675637833986`*^9}, {
   3.9138682212474923`*^9, 3.913868221253111*^9}, {3.9138690439766445`*^9, 
   3.913869043981699*^9}, {3.9138691384932814`*^9, 3.913869147288597*^9}, {
   3.913869202156701*^9, 3.9138692055185556`*^9}, {3.913869239652417*^9, 
   3.9138692400334797`*^9}, {3.913869474546574*^9, 3.913869474546574*^9}, {
   3.913870429970599*^9, 3.913870442530464*^9}, {3.9138744135974054`*^9, 
   3.913874414587882*^9}, {3.9156429963777814`*^9, 3.915642996428277*^9}, {
   3.916391759919177*^9, 3.916391773937995*^9}, {3.916512010716703*^9, 
   3.9165120302839413`*^9}, {3.9166727678270264`*^9, 
   3.9166727868341904`*^9}, {3.9177681833526173`*^9, 3.9177681834185057`*^9}, 
   3.917852112310001*^9},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[465]:=",ExpressionUUID->"cf1b132c-0605-4069-a715-693b632def22"]
}, Closed]],

Cell[CellGroupData[{

Cell["Number of events - fast", "Subsection",
 CellChangeTimes->{{3.897206442190997*^9, 3.8972064427846107`*^9}, {
  3.905840324777521*^9, 3.905840328994842*^9}},
 CellTags->{
  "Number-of-events-computation+sensitivity", 
   "Acceptance-computation"},ExpressionUUID->"9568fedf-30f9-450d-900b-\
5ab61536bd06"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FactorLowerBound", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\"\<ANUBIS-shaft-volume-1\>\"", ",", 
          "\"\<ANUBIS-shaft-volume-2\>\"", ",", 
          "\"\<ANUBIS-shaft-volume-3\>\""}], "}"}], ",", 
        "SelectedExperiment"}], "]"}], "==", "True"}], ",", "0.1", ",", 
     "0.3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NeventsDiscret", "[", 
   RowBox[{"m_", ",", "ProdChannel_", ",", "couplinglist_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"NevDiscret", ",", "NpotTimes\[Chi]val", ",", "zshift"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"mLLPmin", "[", "ProdChannel", "]"}], ",", 
         "mmin\[Epsilon]"}], "]"}], "<", "m", "<", 
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"mLLPmax", "[", "ProdChannel", "]"}], ",", 
         "mmax\[Epsilon]"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"integrandtab", "=", 
        RowBox[{"TableIntegrandDiscret", "[", 
         RowBox[{"m", ",", "ProdChannel", ",", "\"\<True\>\""}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NpotTimes\[Chi]val", "[", "coupling_", "]"}], "=", 
        RowBox[{"NpotGivenExperiment", "*", 
         RowBox[{"ProbLLP", "[", 
          RowBox[{"m", ",", "coupling", ",", "ProdChannel"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"lowerbound", ",", "upperbound"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"LowerBoundEstimate", "[", 
           RowBox[{"m", ",", "ProdChannel"}], "]"}], ",", 
          RowBox[{"UpperBoundEstimate", "[", 
           RowBox[{"m", ",", "ProdChannel"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"brvis", "=", 
        RowBox[{"BrVis", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NevDiscret", "[", "coupling_", "]"}], ":=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"0.1", "lowerbound"}], "<", "coupling", "<", 
           RowBox[{"(*", "1.5", "*)"}], 
           RowBox[{"2", "upperbound"}]}], ",", 
          RowBox[{
           RowBox[{"NpotTimes\[Chi]val", "[", "coupling", "]"}], "*", "brvis",
            "*", 
           RowBox[{"sumcompile", "[", 
            RowBox[{"tableprefac", "[", 
             RowBox[{"integrandtab", ",", "m", ",", 
              RowBox[{"c\[Tau]LLP", "[", 
               RowBox[{"m", ",", "coupling"}], "]"}], ",", "1", ",", "0."}], 
             "]"}], "]"}]}], ",", "0."}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"m", ",", 
           RowBox[{"couplinglist", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"NevDiscret", "[", 
            RowBox[{"couplinglist", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "couplinglist", "]"}], ",", "1"}], "}"}]}], 
        "]"}]}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"m", ",", 
          RowBox[{"couplinglist", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "0."}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "couplinglist", "]"}], ",", "1"}], "}"}]}], 
       "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.897200964730176*^9, 3.897200965970766*^9}, {
   3.89720118259857*^9, 3.8972011870868115`*^9}, {3.8972012433916793`*^9, 
   3.8972012434804716`*^9}, {3.8972021109080114`*^9, 3.897202111357911*^9}, {
   3.897205130000824*^9, 3.8972051305748835`*^9}, 3.897206599004672*^9, {
   3.8972085445054307`*^9, 3.8972085493226857`*^9}, {3.897208729717713*^9, 
   3.897208782995672*^9}, {3.8972323557542253`*^9, 3.897232355758215*^9}, {
   3.8972325208882675`*^9, 3.897232579312927*^9}, {3.8972330183637056`*^9, 
   3.8972330186824365`*^9}, {3.8972330557477093`*^9, 
   3.8972330786629725`*^9}, {3.8972331885872264`*^9, 
   3.8972331892740192`*^9}, {3.897233372953797*^9, 3.8972334102237387`*^9}, {
   3.897233632248149*^9, 3.8972337068313646`*^9}, {3.897233770343194*^9, 
   3.897233794850586*^9}, {3.897234027583762*^9, 3.897234039222018*^9}, 
   3.902727371095085*^9, {3.903789674824919*^9, 3.9037896748651905`*^9}, {
   3.903790316364489*^9, 3.903790327604648*^9}, 3.903791118373599*^9, {
   3.903793681334241*^9, 3.903793681337234*^9}, {3.903793815495824*^9, 
   3.9037938405670385`*^9}, {3.9110273360582485`*^9, 3.911027382154455*^9}, {
   3.9110275909078875`*^9, 3.9110276162959757`*^9}, {3.911027735769429*^9, 
   3.9110277360519323`*^9}, {3.91102782490703*^9, 3.9110278664472694`*^9}, {
   3.911027908345337*^9, 3.9110279086712365`*^9}, 3.913867583368688*^9, {
   3.9138687734466343`*^9, 3.9138687783364944`*^9}, 3.913869043987434*^9, {
   3.91386913849867*^9, 3.91386914700126*^9}, {3.9138718044634438`*^9, 
   3.9138718044763327`*^9}, {3.9138744265895786`*^9, 
   3.9138744439740767`*^9}, {3.915642996438535*^9, 3.9156429964465075`*^9}, {
   3.9166711739039955`*^9, 3.9166711755719423`*^9}, {3.9166727968540945`*^9, 
   3.9166728372092457`*^9}},
 CellTags->{
  "Number-of-events-computation+sensitivity", "Acceptance-computation"},
 CellLabel->
  "In[468]:=",ExpressionUUID->"f14e7503-0c2b-42e6-82b3-09c8d2837343"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Number of events - slow (using built-in Mathematica functions Interpolation, \
NIntegrate)\
\>", "Subsection",
 CellChangeTimes->{{3.916673042143861*^9, 3.9166730501366386`*^9}},
 CellTags->{
  "Number-of-events-computation+sensitivity", 
   "Acceptance-computation"},ExpressionUUID->"c29e3e81-7da0-4ea9-b871-\
a5deff1aa7dc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Differential", " ", "decay", " ", "probability", " ", 
     FractionBox["1", "ldecay"], 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "l"}], "/", "ldecay"}], "]"}]}], ",", " ", 
    RowBox[{
    "where", " ", "l", " ", "is", " ", "expressed", " ", "in", " ", "terms", 
     " ", "of", " ", "the", " ", "longitudinal", " ", "displacement", " ", 
     "z", " ", "and", " ", "polar", " ", "angle", " ", "\[Theta]", " ", "as", 
     " ", 
     RowBox[{"z", "/", "cos\[Theta]"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Differential", " ", "decay", " ", "probability", " ", 
     RowBox[{"(", 
      RowBox[{"1", "/", "ldecay"}], ")"}], 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "l"}], "/", "ldecay"}], "]"}]}], ",", " ", 
    RowBox[{
    "where", " ", "l", " ", "is", " ", "expressed", " ", "in", " ", "terms", 
     " ", "of", " ", "the", " ", "longitudinal", " ", "displacement", " ", 
     "z", " ", "and", " ", "polar", " ", "angle", " ", "\[Theta]", " ", "as", 
     " ", 
     RowBox[{"z", "/", "cos\[Theta]"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"PdecayDensity", "[", 
      RowBox[{
      "mLLP_", ",", "coupling_", ",", "\[Theta]LLP_", ",", "ELLP_", ",", 
       "zLLP_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "zLLP"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]LLP", "]"}], "*", 
          RowBox[{"ldecayLLP", "[", 
           RowBox[{"mLLP", ",", "coupling", ",", "ELLP"}], "]"}]}], ")"}]}], 
       "]"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"Cos", "[", "\[Theta]LLP", "]"}], "]"}], "*", 
        RowBox[{"ldecayLLP", "[", 
         RowBox[{"mLLP", ",", "coupling", ",", "ELLP"}], "]"}]}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "The", " ", "integrand", " ", "determining", " ", "the", " ", 
     "differential", " ", "rate", " ", "for", " ", "events"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"IntegrandLLP", "[", 
       RowBox[{
       "mLLP_", ",", "coupling_", ",", "\[Theta]LLP_", ",", "ELLP_", ",", 
        "zLLP_", ",", "prod"}], "]"}], "=", 
      RowBox[{
       RowBox[{"DoubleDistrLLPint", "[", 
        RowBox[{"mLLP", ",", "\[Theta]LLP", ",", "ELLP", ",", "prod"}], "]"}],
        "*", 
       RowBox[{"PdecayDensity", "[", 
        RowBox[{
        "mLLP", ",", "coupling", ",", "\[Theta]LLP", ",", "ELLP", ",", 
         "zLLP"}], "]"}], "*", 
       RowBox[{"AzimuthalAcceptanceInt", "[", 
        RowBox[{"\[Theta]LLP", ",", "zLLP"}], "]"}], "*", 
       RowBox[{"DecayAcceptanceInt", "[", 
        RowBox[{"mLLP", ",", "\[Theta]LLP", ",", "ELLP", ",", "zLLP"}], 
        "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IntegralLLP", "[", 
     RowBox[{"mLLP_", ",", "coupling_", ",", "ProdChannel_"}], "]"}], ":=", 
    RowBox[{"NIntegrate", "[", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"IntegrandLLP", "[", 
         RowBox[{"mLLP", ",", "coupling", ",", "\[Theta]LLP", ",", 
          RowBox[{"Exp", "[", "ELLP", "]"}], ",", "zLLP", ",", 
          "ProdChannel"}], "]"}], 
        RowBox[{"Exp", "[", "ELLP", "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]LLP", ",", "\[Theta]minExp", ",", "\[Theta]maxExp"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ELLP", ",", 
        RowBox[{"Log", "[", "mLLP", "]"}], ",", 
        RowBox[{"Log", "[", 
         RowBox[{"ELLPmax", "[", 
          RowBox[{"mLLP", ",", "\[Theta]LLP", ",", "ProdChannel"}], "]"}], 
         "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"zLLP", ",", 
        RowBox[{"zmin\[Theta]", "[", "\[Theta]LLP", "]"}], ",", 
        RowBox[{"zmax\[Theta]", "[", "\[Theta]LLP", "]"}]}], "}"}], ",", 
      RowBox[{"Method", "\[Rule]", "\"\<AdaptiveMonteCarlo\>\""}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NeventsInt", "[", 
     RowBox[{"mLLP_", ",", "coupling_", ",", "ProdChannel_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"mLLPmin", "[", "ProdChannel", "]"}], "\[LessEqual]", "mLLP", 
        "\[LessEqual]", 
        RowBox[{"mLLPmax", "[", "ProdChannel", "]"}]}], "&&", 
       RowBox[{
        RowBox[{"BrVis", "[", "mLLP", "]"}], "!=", "0"}]}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"0.1", 
          RowBox[{"LowerBoundEstimate", "[", 
           RowBox[{"mLLP", ",", "ProdChannel"}], "]"}]}], "<", "coupling", 
         "<", 
         RowBox[{"2", 
          RowBox[{"UpperBoundEstimate", "[", 
           RowBox[{"mLLP", ",", "ProdChannel"}], "]"}]}]}], ",", 
        RowBox[{"NpotGivenExperiment", "*", 
         RowBox[{"ProbLLP", "[", 
          RowBox[{"mLLP", ",", "coupling", ",", "ProdChannel"}], "]"}], "*", 
         RowBox[{"IntegralLLP", "[", 
          RowBox[{"mLLP", ",", "coupling", ",", "ProdChannel"}], "]"}]}], ",",
         "0."}], "]"}], ",", "0."}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IntegralLLPE", "[", 
     RowBox[{"mLLP_", ",", "coupling_", ",", "ProdChannel_", ",", "ELLP_"}], 
     "]"}], ":=", 
    RowBox[{"NIntegrate", "[", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"IntegrandLLP", "[", 
        RowBox[{
        "mLLP", ",", "coupling", ",", "\[Theta]LLP", ",", "ELLP", ",", "zLLP",
          ",", "ProdChannel"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]LLP", ",", "\[Theta]minExp", ",", "\[Theta]maxExp"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"zLLP", ",", 
        RowBox[{"zmin\[Theta]", "[", "\[Theta]LLP", "]"}], ",", 
        RowBox[{"zmax\[Theta]", "[", "\[Theta]LLP", "]"}]}], "}"}], ",", 
      RowBox[{"Method", "\[Rule]", "\"\<AdaptiveMonteCarlo\>\""}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NeventsDiffInt", "[", 
     RowBox[{"mLLP_", ",", "coupling_", ",", "ProdChannel_", ",", "ELLP_"}], 
     "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"mLLPmin", "[", "ProdChannel", "]"}], "\[LessEqual]", "mLLP", 
        "\[LessEqual]", 
        RowBox[{"mLLPmax", "[", "ProdChannel", "]"}]}], "&&", 
       RowBox[{
        RowBox[{"BrVis", "[", "mLLP", "]"}], "!=", "0"}], "&&", 
       RowBox[{"mLLP", "<", "ELLP", "<=", 
        RowBox[{"ELLPmax", "[", 
         RowBox[{"mLLP", ",", "\[Theta]minExp", ",", "ProdChannel"}], 
         "]"}]}]}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"0.1", 
          RowBox[{"LowerBoundEstimate", "[", 
           RowBox[{"mLLP", ",", "ProdChannel"}], "]"}]}], "<", "coupling", 
         "<", 
         RowBox[{"2", 
          RowBox[{"UpperBoundEstimate", "[", 
           RowBox[{"mLLP", ",", "ProdChannel"}], "]"}]}]}], ",", 
        RowBox[{"NpotGivenExperiment", "*", 
         RowBox[{"ProbLLP", "[", 
          RowBox[{"mLLP", ",", "coupling", ",", "ProdChannel"}], "]"}], "*", 
         RowBox[{"IntegralLLPE", "[", 
          RowBox[{"mLLP", ",", "coupling", ",", "ProdChannel", ",", "ELLP"}], 
          "]"}]}], ",", "0."}], "]"}], ",", "0."}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.916847573666503*^9, 3.9168475797177978`*^9}, {
  3.9342218505000577`*^9, 3.934221854310096*^9}},
 CellTags->{
  "Number-of-events-computation+sensitivity", "Acceptance-computation"},
 CellLabel->
  "In[470]:=",ExpressionUUID->"372d3cc6-07f2-41da-ad5e-4f1e21f8559a"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Tests", "Section",
 CellChangeTimes->{{3.8972012736109533`*^9, 3.897201275449023*^9}, {
  3.9166730149125247`*^9, 3.916673017271925*^9}, {3.9166730902782764`*^9, 
  3.9166730910359907`*^9}},
 CellTags->
  "Number-of-events-computation+sensitivity",ExpressionUUID->"7d9414c6-173d-\
4020-8288-2252992857f1"],

Cell[CellGroupData[{

Cell["Differential number of events", "Subsection",
 CellChangeTimes->{{3.892111289211891*^9, 
  3.892111293865343*^9}},ExpressionUUID->"f77396b5-0a62-4a15-9dac-\
812fd05c1be5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "This", " ", "is", " ", "a", " ", "comparison", " ", "between", " ", 
     "the", " ", "slow", " ", "and", " ", "fast", " ", "integration", " ", 
     RowBox[{"methods", ".", " ", "For"}], " ", "the", " ", "selected", " ", 
     "mass", " ", "and", " ", "production", " ", "channel"}], ",", " ", 
    RowBox[{
    "the", " ", "numbers", " ", "of", " ", "events", " ", "obtained", " ", 
     "using", " ", "the", " ", "methods", " ", "should", " ", "agree", " ", 
     "within", " ", "10", "%"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"If", " ", "the", " ", "agreement", " ", "is", " ", "worse"}], 
    ",", " ", 
    RowBox[{
    "there", " ", "may", " ", "be", " ", "a", " ", "few", " ", "reasons"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"1", ")"}], " ", "The", " ", "grid", " ", "for", " ", "the", " ",
      "fast", " ", "method", " ", "is", " ", "not", " ", "dense", " ", 
     RowBox[{"enough", ".", " ", "Try"}], " ", "to", " ", "increase", " ", 
     "the", " ", "grid", " ", "density", " ", 
     RowBox[{"(", 
      RowBox[{
      "OutGrid\[Theta]final", ",", " ", "OutGridEfinal", ",", " ", 
       "OutGridzfinal"}], ")"}], " ", "to", " ", "see", " ", "whether", " ", 
     "the", " ", "agreement", " ", 
     RowBox[{"improves", ".", " ", "Sometimes"}]}], ",", " ", 
    RowBox[{
    "even", " ", "a", " ", "slightly", " ", "denser", " ", "grid", " ", "for",
      " ", 
     RowBox[{"e", ".", "g", ".", " ", "z"}], " ", "may", " ", "lead", " ", 
     "to", " ", "a", " ", "significant", " ", "improvement", " ", "in", " ", 
     "the", " ", "agrement"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"2", ")"}], " ", "The", " ", "Monte"}], "-", 
      RowBox[{
      "Carlo", " ", "integrator", " ", "for", " ", "the", " ", "slow", " ", 
       "method", " ", "fails", " ", "to", " ", "evaluate", " ", 
       "properly"}]}], ";", " ", 
     RowBox[{
     "this", " ", "may", " ", "happen", " ", "if", " ", "the", " ", "range", 
      " ", "of", " ", "the", " ", "integration", " ", "over", " ", "energies",
       " ", "is", " ", "too", " ", "large", " ", "compared", " ", "to", " ", 
      "the", " ", "domain", " ", "where", " ", "most", " ", "of", " ", "the", 
      " ", "events", " ", "actually", " ", "are", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"off", "-", 
         RowBox[{
         "axis", " ", "experiments", " ", "such", " ", "as", " ", "MATHUSLA", 
          " ", "and", " ", "ANUBIS"}]}], ")"}], ".", " ", "Another"}], " ", 
      "symptom", " ", "is", " ", "that", " ", "for", " ", "the", " ", "given",
       " ", "mass", " ", "and", " ", "coupling", " ", "the", " ", "integral", 
      " ", "\"\<jumps\>\""}]}], ",", " ", 
    RowBox[{"i", ".", "e", "."}], ",", " ", 
    RowBox[{
    "returns", " ", "values", " ", "with", " ", "large", " ", "error"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "A", " ", "separate", " ", "discussion", " ", "should", " ", "be", " ", 
     "made", " ", "for", " ", "the", " ", "couplings", " ", "belong", " ", 
     "to", " ", "the", " ", "domain", " ", "c\[Tau]", " ", "\[Gamma]", " ", 
     RowBox[{
      RowBox[{"<<", " ", 
       SubscriptBox["z", "experiment"]}], ".", " ", "The"}], " ", 
     "discrepancy", " ", "may", " ", "be", " ", "significant"}], ",", " ", 
    RowBox[{
    "and", " ", "the", " ", "reason", " ", "is", " ", "insufficient", " ", 
     "grid", " ", "density", " ", "for", " ", "the", " ", "fast", " ", 
     "integration", " ", 
     RowBox[{"method", ".", " ", "However"}]}], ",", " ", 
    RowBox[{
    "due", " ", "to", " ", "the", " ", "exponential", " ", "suppression", " ",
      "of", " ", "the", " ", "number", " ", "of", " ", "events"}], ",", " ", 
    RowBox[{
    "this", " ", "may", " ", "be", " ", "compensated", " ", "by", " ", "a", 
     " ", "tiny", " ", "shift", " ", "in", " ", "the", " ", "coupling"}], ",",
     " ", 
    RowBox[{
    "so", " ", "the", " ", "discrepancy", " ", "should", " ", "be", " ", 
     "considered", " ", "as", " ", 
     RowBox[{"appropriate", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ProdTest", "=", 
    RowBox[{"ProductionList", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mtest", "=", 
     RowBox[{"Max", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"mLLPmin", "[", "ProdTest", "]"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"mLLPmax", "[", "ProdTest", "]"}], "-", 
           RowBox[{"mLLPmin", "[", "ProdTest", "]"}]}], ")"}], "*", "0.3"}]}],
        ",", 
       RowBox[{"1.2", "*", "mmin\[Epsilon]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Epsilon]2list", "=", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["10", 
          RowBox[{"-", "12"}]], ",", 
         RowBox[{"3", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "12"}]]}], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "12"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "11"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "11"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "10"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "10"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "9"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "9"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "8"}]], ",", 
         RowBox[{"2", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "8"}]]}], ",", 
         RowBox[{"4", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "8"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "7"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"6", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"7", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"8", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"9", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "6"}]], ",", 
         RowBox[{"2", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "6"}]]}]}], "}"}], "//", "N"}], "*)"}], 
     RowBox[{"Table", "[", 
      RowBox[{
       SuperscriptBox["10", "x"], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"-", "17."}], ",", 
         RowBox[{"-", "3."}], ",", "0.3"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dat1", "=", 
      RowBox[{"NeventsDiscret", "[", 
       RowBox[{"mtest", ",", "ProdTest", ",", "\[Epsilon]2list"}], "]"}]}], 
     ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dat2", "=", 
      RowBox[{"ParallelTable", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Epsilon]2list", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"c\[Tau]LLP", "[", 
           RowBox[{"mtest", ",", 
            RowBox[{"\[Epsilon]2list", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"Quiet", "[", 
           RowBox[{"NeventsInt", "[", 
            RowBox[{"mtest", ",", 
             RowBox[{"\[Epsilon]2list", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "ProdTest"}], "]"}], 
           "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "\[Epsilon]2list", "]"}], ",", "1"}], 
         "}"}]}], "]"}]}], ";"}], "//", "AbsoluteTiming"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*FractionBox[SubscriptBox[\(m\), \(LLP\)], \(GeV\)]\)\>\"", 
         ",", "\"\<coupling\>\"", ",", 
         "\"\<\!\(\*FractionBox[\(c\[Tau]\), SubscriptBox[\(z\), \
\(min\)]]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[\(N\), \(events, fast\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[\(N\), \(events, slow\)]\)\>\""}], "}"}], 
       "}"}], ",", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"dat1", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           FractionBox[
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "zminExp"], "}"}], "&"}], "/@", 
         "dat2"}], ",", 
        RowBox[{"dat1", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", "3", "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"dat2", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", "3", "}"}]}], "]"}], "]"}], ",", "2"}], "]"}]}], 
     "]"}], "//", "TableForm"}]}]}]], "Input",
 CellChangeTimes->{{3.892111330393669*^9, 3.8921113703258653`*^9}, {
   3.8921114855521097`*^9, 3.8921114891326914`*^9}, {3.8921115909252915`*^9, 
   3.89211160107533*^9}, {3.892112023350475*^9, 3.8921120715940514`*^9}, {
   3.8921121043874707`*^9, 3.892112190091645*^9}, {3.892112748834139*^9, 
   3.892112748933666*^9}, {3.8921130465455704`*^9, 3.8921130470314426`*^9}, {
   3.8921131989548674`*^9, 3.8921131992395306`*^9}, {3.892113256325259*^9, 
   3.892113256434625*^9}, {3.892113458241603*^9, 3.8921135323303742`*^9}, {
   3.892116361437076*^9, 3.8921163614848557`*^9}, {3.893257780692194*^9, 
   3.893257792940939*^9}, {3.893260545232792*^9, 3.893260566765787*^9}, {
   3.896953530728937*^9, 3.896953531233162*^9}, {3.896953744363188*^9, 
   3.8969537469343243`*^9}, {3.896953883310589*^9, 3.896953884008139*^9}, {
   3.896971240286153*^9, 3.896971246695673*^9}, {3.8969733757056828`*^9, 
   3.896973378633896*^9}, {3.8969760731711082`*^9, 3.896976348233163*^9}, {
   3.8969763786206193`*^9, 3.896976403680397*^9}, {3.8969764343671703`*^9, 
   3.8969764672032614`*^9}, 3.8972088334478965`*^9, 3.8972305813039556`*^9, {
   3.897497510731538*^9, 3.89749751125323*^9}, {3.902767311298179*^9, 
   3.902767314971142*^9}, 3.913885628281992*^9, {3.9138909049631968`*^9, 
   3.9138909075735703`*^9}, {3.9138924586138153`*^9, 3.913892484937354*^9}, {
   3.913977632763244*^9, 3.9139776371781855`*^9}, {3.914060611820261*^9, 
   3.9140606165631547`*^9}, {3.914060754306946*^9, 3.914060758151827*^9}, {
   3.9140661649260087`*^9, 3.914066165299016*^9}, 3.9144928342705812`*^9, {
   3.914493274362196*^9, 3.9144932960373006`*^9}, 3.9144933745468297`*^9, {
   3.914514390791649*^9, 3.914514396799925*^9}, 3.91451500763321*^9, {
   3.9151840345413003`*^9, 3.9151840346541643`*^9}, {3.9151841490177746`*^9, 
   3.9151841512887573`*^9}, {3.9156430652941766`*^9, 3.915643065297191*^9}, 
   3.9166731411610813`*^9, {3.9168490479632063`*^9, 3.9168490515052485`*^9}, {
   3.9186662755999093`*^9, 3.918666278407646*^9}, {3.918671385069278*^9, 
   3.918671385130062*^9}, {3.918671448723364*^9, 3.9186714492693343`*^9}, {
   3.9342220493740664`*^9, 3.9342220620149283`*^9}, 3.934222142519144*^9},
 CellLabel->
  "In[146]:=",ExpressionUUID->"6962c164-b0d4-438c-bc89-a951513665ff"]
}, Closed]],

Cell[CellGroupData[{

Cell["Differential number of events", "Subsection",
 CellChangeTimes->{{3.892111289211891*^9, 3.892111293865343*^9}},
 CellTags->
  "Number-of-events-computation+sensitivity",ExpressionUUID->"f2457af1-76a9-\
47ab-b482-5799da6309cc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Variable", " ", "=", " ", "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\""}],
     ",", "\"\<\!\(\*SubscriptBox[\(z\), \(X\)]\)\>\"", ",", 
    RowBox[{
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", ".", " ", "The"}], 
     " ", "number", " ", "belongs", " ", "to", " ", "the", " ", "column", " ",
      "in", " ", "the", " ", "tabulated", " ", "data"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"iVal", ":=", 
    RowBox[{"Association", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(E\), \(LLP\)]\)\>\"", " ", "\[Rule]", "2"}], 
       ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(LLP\)]\)\>\"", "\[Rule]", 
        "1"}], ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(z\), \(LLP\)]\)\>\"", "\[Rule]", "3"}]}], 
      "}"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
     "\[CapitalDelta]xvals", "[", 
      "\"\<\!\(\*SubscriptBox[\(E\), \(LLP\)]\)\>\"", "]"}], ":=", 
     "\[CapitalDelta]Evals"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
     "\[CapitalDelta]xvals", "[", 
      "\"\<\!\(\*SubscriptBox[\(z\), \(LLP\)]\)\>\"", "]"}], "=", 
     "\[CapitalDelta]zvals"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalDelta]xvals", "[", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", ",", "prod"}], 
        "]"}], "=", 
       RowBox[{"\[CapitalDelta]\[Theta]vals", "[", "prod", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"LegendX", ":=", 
    RowBox[{"Association", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(E\), \(LLP\)]\)\>\"", "\[Rule]", 
        "\"\<\!\(\*SubscriptBox[\(E\), \(LLP\)]\) [GeV]\>\""}], ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(LLP\)]\)\>\"", "\[Rule]", 
        "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(LLP\)]\) [rad]\>\""}], ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(z\), \(LLP\)]\)\>\"", "\[Rule]", " ", 
        "\"\<\!\(\*SubscriptBox[\(z\), \(LLP\)]\) [m]\>\""}]}], "}"}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"LegendY", ":=", 
    RowBox[{"Association", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(E\), \(LLP\)]\)\>\"", "\[Rule]", 
        "\"\<\!\(\*SubscriptBox[\(dN\), \(ev\)]\)/\!\(\*SubscriptBox[\(dE\), \
\(LLP\)]\) [\!\(\*SuperscriptBox[\(GeV\), \(-1\)]\)]\>\""}], ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(LLP\)]\)\>\"", "\[Rule]", 
        "\"\<\!\(\*SubscriptBox[\(dN\), \(ev\)]\)/\!\(\*SubscriptBox[\(d\
\[Theta]\), \(LLP\)]\) [\!\(\*SuperscriptBox[\(rad\), \(-1\)]\)]\>\""}], ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(z\), \(LLP\)]\)\>\"", "\[Rule]", " ", 
        "\"\<\!\(\*SubscriptBox[\(dN\), \(ev\)]\)/\!\(\*SubscriptBox[\(dz\), \
\(LLP\)]\) [\!\(\*SuperscriptBox[\(m\), \(-1\)]\)]\>\""}]}], "}"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Differential", " ", "number", " ", "of", " ", "events"}], "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NeventsDifferentialDiscretProd", "[", 
     RowBox[{"m_", ",", "ProdChannel_", ",", "coupling_", ",", "Variable_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "NpotTimes\[Chi]val", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ival", "=", 
        RowBox[{"iVal", "[", "Variable", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"NpotTimes\[Chi]val", "=", 
        RowBox[{"NpotGivenExperiment", "*", 
         RowBox[{"ProbLLP", "[", 
          RowBox[{"m", ",", "coupling", ",", "ProdChannel"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tablegrid0", "=", 
        RowBox[{"TableIntegrandDiscret", "[", 
         RowBox[{"m", ",", "ProdChannel", ",", "\"\<True\>\""}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"OutGridEfinalTemp", "=", 
        RowBox[{"OutGridEnergy", "[", 
         RowBox[{
          RowBox[{"N", "[", "m", "]"}], ",", "ProdChannel"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[CapitalDelta]Evals", "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Rest", "[", 
           SuperscriptBox["10", "OutGridEfinalTemp"], "]"}], "-", 
          RowBox[{"Most", "[", 
           SuperscriptBox["10", "OutGridEfinalTemp"], "]"}]}], ")"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[CapitalDelta]xval", "=", 
        RowBox[{"\[CapitalDelta]xvals", "[", "Variable", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"c\[Tau]Val", "=", 
        RowBox[{"c\[Tau]LLP", "[", 
         RowBox[{"m", ",", "coupling"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"brvis", "=", 
        RowBox[{"BrVis", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ilist", "=", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"{", 
          RowBox[{"ival", ",", "1", ",", "2", ",", "3"}], "}"}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"tablegrid1", "=", 
        RowBox[{"SortBy", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"ilist", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"ilist", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"ilist", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "&"}], "/@", 
           RowBox[{"tableGridPrefac", "[", 
            RowBox[{"tablegrid0", ",", "m", ",", "c\[Tau]Val", ",", "0."}], 
            "]"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"GridQuantity", "=", 
        RowBox[{
         RowBox[{"tablegrid1", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", 
         "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"LengthPerVariable", "=", 
        RowBox[{
         RowBox[{"Length", "[", "tablegrid1", "]"}], "/", 
         RowBox[{"Length", "[", "GridQuantity", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tab1", "=", 
        RowBox[{"NdiffCompiled", "[", 
         RowBox[{
         "tablegrid1", ",", "GridQuantity", ",", "LengthPerVariable", ",", 
          RowBox[{"NpotTimes\[Chi]val", "*", "brvis"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"tab1", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", "1", "}"}]}], "]"}], "]"}], ",", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"tab1", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}], "*", 
            SuperscriptBox["\[CapitalDelta]xval", 
             RowBox[{"-", "1"}]]}], ",", "1"}], "]"}], ",", "2"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NeventsDifferentialDiscret", "[", 
     RowBox[{"m_", ",", "coupling_", ",", "Variable_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "NdiffInt", ",", "LegendList", ",", "QuantityMinMax", ",", 
        "ValueMinMax"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"prodlisttemp", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"mLLPmin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}], 
             "]"}], "<", "m", "<", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"mLLPmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}], 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"prodlisttemp", "=", 
             RowBox[{"Join", "[", 
              RowBox[{"prodlisttemp", ",", 
               RowBox[{"{", "prod", "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"NdiffData", "[", "prod", "]"}], "=", 
             RowBox[{"NeventsDifferentialDiscretProd", "[", 
              RowBox[{"m", ",", "prod", ",", "coupling", ",", "Variable"}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"XvalminmaxNdiff", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"NdiffData", "[", "prod", "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ">", 
                   SuperscriptBox["10", 
                    RowBox[{"-", "40"}]]}], "&"}]}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "MinMax"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"NdiffInt", "[", 
              RowBox[{"X_", ",", "prod"}], "]"}], "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"XvalminmaxNdiff", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "<", "X", "<", 
                RowBox[{"XvalminmaxNdiff", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               RowBox[{"Evaluate", "[", 
                RowBox[{"10", "^", 
                 RowBox[{
                  RowBox[{"Interpolation", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log10", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Log10", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "90"}]]}], "]"}]}], "}"}], "&"}], "/@", 
                    RowBox[{"NdiffData", "[", "prod", "]"}]}], ",", 
                    RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], 
                  "[", 
                  RowBox[{"Log10", "[", "X", "]"}], "]"}]}], "]"}], ",", 
               "0"}], "]"}]}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"prod", ",", "ProductionListBaseline"}], "}"}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NdiffInt", "[", 
         RowBox[{"X_", ",", "\"\<Total\>\""}], "]"}], "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"NdiffInt", "[", 
           RowBox[{"X", ",", "prod"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "prodlisttemp"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"LegendList", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", "\"\<Total\>\"", "}"}], ",", "prodlisttemp"}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"QuantityMinMax", "=", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"MinMax", "[", 
              RowBox[{
               RowBox[{"NdiffData", "[", "prod", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"prod", ",", "prodlisttemp"}], "}"}]}], "]"}], ",", 
           "1"}], "]"}], "//", "MinMax"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ValueMinMax", "=", 
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"NdiffData", "[", "#", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "&"}], "/@", 
          "prodlisttemp"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"NdiffInt", "[", 
            RowBox[{"X", ",", "prod"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"prod", ",", "LegendList"}], "}"}]}], "]"}], ",", 
         "LegendList", ",", "QuantityMinMax", ",", "ValueMinMax"}], "}"}]}]}],
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mvaltest", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FacilityGivenExperiment", "==", "\"\<ESS\>\""}], ",", "0.04", 
       ",", "0.3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"couplingvaltest", "=", 
     RowBox[{"2", "*", 
      RowBox[{"LowerBoundEstimate", "[", 
       RowBox[{"mvaltest", ",", "\"\<Eta\>\""}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"quantity", "=", "\"\<\!\(\*SubscriptBox[\(E\), \(LLP\)]\)\>\""}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NdiffTab", "[", "X_", "]"}], ",", "LegendList", ",", 
       "QuantityMinMax", ",", "ValueMinMax"}], "}"}], "=", 
     RowBox[{"NeventsDifferentialDiscret", "[", 
      RowBox[{"mvaltest", ",", "couplingvaltest", ",", "quantity"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"prch", "=", 
        RowBox[{"LegendList", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NdiffInt", "[", 
         RowBox[{"X_", ",", "prch"}], "]"}], "=", 
        RowBox[{
         RowBox[{"NdiffTab", "[", "X", "]"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "LegendList", "]"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"plotdiff", "=", 
    RowBox[{"LogLogPlot", "[", 
     RowBox[{
      RowBox[{"Evaluate", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NdiffInt", "[", 
          RowBox[{"X", ",", "prod"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"prod", ",", "LegendList"}], "}"}]}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"X", ",", 
        RowBox[{"QuantityMinMax", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"QuantityMinMax", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"Frame", "\[Rule]", "True"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{
           SuperscriptBox["10", 
            RowBox[{"-", "5"}]], ",", 
           RowBox[{"2", "ValueMinMax"}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Thick", ",", "Black", ",", 
           RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", 
           RowBox[{"Lighter", "@", "Blue"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", 
           RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", 
           RowBox[{"Darker", "@", 
            RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", 
           RowBox[{"Darker", "@", "Cyan"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", "Magenta"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", 
           RowBox[{"Lighter", "@", "Blue"}], ",", 
           RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", 
           RowBox[{"Darker", "@", "Red"}], ",", 
           RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", 
           RowBox[{"Darker", "@", 
            RowBox[{"Darker", "@", "Green"}]}], ",", 
           RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"PlotLegends", "\[Rule]", 
       RowBox[{"Placed", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"#", ",", "16"}], "]"}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{"LegendList", "/.", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Bremsstrahlung-FR-Central\>\"", "->", 
              "\"\<Bremsstrahlung\>\""}], "}"}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"0.82", ",", "0.7"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LegendX", "[", "quantity", "]"}], " ", ",", 
         RowBox[{"LegendY", "[", "quantity", "]"}]}], "}"}]}], ",", 
      RowBox[{"FrameStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", " ", "18"}], "]"}]}], ",", 
      RowBox[{"PlotLabel", "\[Rule]", 
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"Row", "[", 
          RowBox[{"{", 
           RowBox[{
           "SelectedExperiment", ",", 
            "\"\<. \!\(\*SubscriptBox[\(m\), \(LLP\)]\) = \>\"", ",", 
            "mvaltest", ",", 
            "\"\< GeV, \!\(\*SuperscriptBox[\(\[Epsilon]\), \(2\)]\) = \>\"", 
            ",", 
            RowBox[{"couplingvaltest", "//", "N"}]}], "}"}], "]"}], ",", "18",
          ",", "Black"}], "]"}]}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8921163996135225`*^9, 3.8921164016036096`*^9}, {
   3.8921164560955544`*^9, 3.892116475031265*^9}, {3.892116516434699*^9, 
   3.8921165782759094`*^9}, {3.8921166461579666`*^9, 
   3.8921166470109124`*^9}, {3.8921167042134895`*^9, 3.892116729930051*^9}, {
   3.8927049818255663`*^9, 3.8927049991222277`*^9}, {3.8929115471019087`*^9, 
   3.892911593659387*^9}, {3.8929721720425777`*^9, 3.892972173350433*^9}, {
   3.8929722208773427`*^9, 3.8929722211847763`*^9}, {3.8932578131000147`*^9, 
   3.893257813645747*^9}, {3.8934746693595037`*^9, 3.893474675301323*^9}, {
   3.8935154039618015`*^9, 3.893515450284458*^9}, {3.893515943430369*^9, 
   3.893515962817915*^9}, 3.893516005738713*^9, {3.893516036174548*^9, 
   3.893516050479193*^9}, {3.893516088577403*^9, 3.893516089018369*^9}, {
   3.893516189974946*^9, 3.8935161902213464`*^9}, {3.8935162352543807`*^9, 
   3.8935162734266047`*^9}, {3.893516595793399*^9, 3.893516611219179*^9}, {
   3.893606026577932*^9, 3.8936060575609436`*^9}, 3.8955578364377675`*^9, {
   3.8969794021337876`*^9, 3.89697940417612*^9}, {3.897206579842867*^9, 
   3.897206594529684*^9}, {3.8972085445254173`*^9, 3.8972085493347607`*^9}, {
   3.897208919899889*^9, 3.897208931547951*^9}, {3.8972292867488394`*^9, 
   3.89722929702377*^9}, {3.8972306661965404`*^9, 3.8972306721050725`*^9}, {
   3.8975308343870435`*^9, 3.897530869153321*^9}, {3.8975310380863085`*^9, 
   3.89753104461861*^9}, {3.897531900362914*^9, 3.897531900595253*^9}, {
   3.9027678930208297`*^9, 3.9027678936528425`*^9}, 3.9138856283067827`*^9, {
   3.913890462711218*^9, 3.9138904981911244`*^9}, {3.9140605326688194`*^9, 
   3.9140605336567073`*^9}, {3.915643065351285*^9, 3.9156430653710737`*^9}, {
   3.9166731600344844`*^9, 3.9166731605717616`*^9}, {3.916673280296506*^9, 
   3.9166732810468893`*^9}, {3.9166733394090853`*^9, 
   3.9166733620337677`*^9}, {3.9166734368007584`*^9, 3.91667343719798*^9}, {
   3.9168077827280064`*^9, 3.916807788256571*^9}, {3.9168079412877655`*^9, 
   3.9168079435920115`*^9}, {3.9168080122680883`*^9, 
   3.9168080259923544`*^9}, {3.9168080589461308`*^9, 
   3.9168081500481606`*^9}, {3.916809193876444*^9, 3.9168092210599623`*^9}, {
   3.916849826843279*^9, 3.91684984339956*^9}, {3.9168547378018303`*^9, 
   3.916854867699237*^9}, 3.9168549657426524`*^9, {3.928577456960396*^9, 
   3.928577519546383*^9}, {3.934222199547548*^9, 3.934222200399228*^9}, 
   3.9345978176234536`*^9, {3.9351352773777823`*^9, 3.9351352864155703`*^9}, {
   3.935250513577525*^9, 3.9352505721024275`*^9}, {3.935250620074235*^9, 
   3.935250629453693*^9}, {3.935250665496318*^9, 3.9352506811737127`*^9}, {
   3.9352520728875694`*^9, 3.9352520922047424`*^9}, {3.9352521453927894`*^9, 
   3.9352522688880525`*^9}},
 CellTags->"Number-of-events-computation+sensitivity",
 CellLabel->
  "In[476]:=",ExpressionUUID->"fe3b5af1-2caa-4f01-a4d7-4be7307a3eac"]
}, Closed]]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Exporting tabulated number of events", "Title",
 CellChangeTimes->{{3.8850207904521627`*^9, 3.885020796464762*^9}, 
   3.886649940088234*^9},
 CellTags->
  "Number-of-events-computation+sensitivity",ExpressionUUID->"a1ac207f-e5a6-\
41ed-9016-23014b2a6c3e"],

Cell[CellGroupData[{

Cell["Definitions", "Chapter",
 CellChangeTimes->{{3.8850542017641125`*^9, 3.885054203349573*^9}},
 CellTags->
  "Number-of-events-computation+sensitivity",ExpressionUUID->"61d66c6b-87da-\
4009-946a-eb32cc005fd8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"directory", "[", "\"\<Nevents\>\"", "]"}], "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<Tabulated Nevents\>\""}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"directory", "[", "\"\<Nevents-LLP\>\"", "]"}], "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<Tabulated Nevents\>\"", ",", "LLPdirName"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"directory", "[", "\"\<Nevents-LLP-experiment\>\"", "]"}], "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<Tabulated Nevents\>\"", ",", "LLPdirName", ",", 
      "SelectedExperiment"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"DirectoryQ", "[", 
        RowBox[{"directory", "[", "#", "]"}], "]"}]}], ",", 
      RowBox[{"CreateDirectory", "[", 
       RowBox[{"directory", "[", "#", "]"}], "]"}]}], "]"}], "&"}], "/@", 
   RowBox[{"{", 
    RowBox[{
    "\"\<Nevents\>\"", ",", "\"\<Nevents-LLP\>\"", ",", 
     "\"\<Nevents-LLP-experiment\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<Filenames with tabulated \!\(\*SubscriptBox[\(N\), \(events\)]\):\>\"",
   "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"FilenameNeventsInt", "[", "prod", "]"}], "=", 
    RowBox[{"ToString", "@", 
     RowBox[{"StringForm", "[", 
      RowBox[{"\"\<Nevents_``_``_at_``_Npot=``.dat\>\"", ",", 
       RowBox[{"Sequence", "@@", 
        RowBox[{"{", 
         RowBox[{"LLPdirName", ",", "prod", ",", "SelectedExperiment", ",", 
          RowBox[{
           RowBox[{"NpotGivenExperiment", "//", "CForm"}], "//", 
           "ToString"}]}], "}"}]}]}], "]"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"prod", ",", "ProductionList"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FilenameNeventsInt", "[", "#", "]"}], "&"}], "/@", 
  "ProductionList"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"mRangeExport", "[", "prod", "]"}], "=", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "0.021", ",", "0.026", ",", "0.031", ",", "0.036", ",", "0.041", ",",
           "0.046", ",", "0.051", ",", "0.056", ",", "0.061", ",", "0.066", 
          ",", "0.07", ",", "0.08", ",", "0.09", ",", "0.1", ",", "0.11", ",",
           "0.12", ",", "0.125", ",", "0.13", ",", "0.14", ",", "0.15", ",", 
          "0.17", ",", "0.2", ",", "0.215", ",", "0.25", ",", "0.3", ",", 
          "0.35", ",", "0.4", ",", "0.45", ",", "0.46", ",", "0.47", ",", 
          "0.48", ",", "0.5", ",", "0.51", ",", "0.52", ",", "0.53", ",", 
          "0.54", ",", "0.55", ",", "0.575", ",", "0.6", ",", "0.625", ",", 
          "0.65", ",", "0.675", ",", "0.7", ",", "0.72", ",", "0.73", ",", 
          "0.74", ",", "0.75", ",", "0.76", ",", "0.77", ",", "0.775", ",", 
          "0.777", ",", "0.78", ",", "0.782", ",", "0.785", ",", "0.79", ",", 
          "0.795", ",", "0.8", ",", "0.81", ",", "0.82", ",", "0.84", ",", 
          "0.9", ",", "0.95", ",", "0.97", ",", "1", ",", "1.005", ",", 
          "1.01", ",", "1.012", ",", "1.015", ",", "1.017", ",", "1.018", ",",
           "1.02", ",", "1.022", ",", "1.023", ",", "1.024", ",", "1.025", 
          ",", "1.03", ",", "1.05", ",", "1.07", ",", "1.09", ",", "1.1", ",",
           "1.15", ",", "1.2", ",", "1.25", ",", "1.3", ",", "1.35", ",", 
          "1.4", ",", "1.45", ",", "1.475", ",", "1.5", ",", "1.525", ",", 
          "1.55", ",", "1.575", ",", "1.6", ",", "1.62", ",", "1.65", ",", 
          "1.67", ",", "1.7", ",", "1.75", ",", "1.8", ",", "1.85", ",", 
          "1.9", ",", "1.95", ",", "2.", ",", "2.05", ",", "2.1", ",", "2.2", 
          ",", "2.3", ",", "2.4", ",", "2.5", ",", "2.6", ",", "2.7", ",", 
          "2.8", ",", "2.9", ",", "3.", ",", "3.05", ",", "3.1", ",", "3.2"}],
          "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{"mLLP", ",", 
          RowBox[{"{", 
           RowBox[{"mLLP", ",", "3.21", ",", 
            RowBox[{"Max", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"mLLPmax", "[", "prod", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], 
             "]"}], ",", 
            FractionBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"mLLPmax", "[", "prod", "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], 
                "]"}], "-", "3"}], ")"}], "20"]}], "}"}]}], "]"}]}], "]"}], "//",
       "N"}]}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"couplingsRangeExport", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      SuperscriptBox["10", "x"], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"-", "18.8"}], ",", 
        RowBox[{"-", "6"}], ",", "0.03"}], "}"}]}], "]"}], "//", "N"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8850528402073092`*^9, 3.885052964529935*^9}, {
   3.8850529967024455`*^9, 3.88505313318991*^9}, {3.885053172661522*^9, 
   3.885053247354876*^9}, {3.885053717249408*^9, 3.8850537696983976`*^9}, {
   3.885054057416253*^9, 3.88505420740788*^9}, {3.8850542428480587`*^9, 
   3.885054257815028*^9}, {3.885054905514982*^9, 3.885054927992525*^9}, {
   3.88523276755499*^9, 3.885232776819412*^9}, {3.8854556204578223`*^9, 
   3.8854556494874506`*^9}, {3.8854560165278835`*^9, 
   3.8854561921232824`*^9}, {3.8854563516684437`*^9, 
   3.8854563631681647`*^9}, {3.885456439233843*^9, 3.885456605782855*^9}, {
   3.8854567400235205`*^9, 3.885456743964001*^9}, {3.885542660052145*^9, 
   3.8855427304549437`*^9}, {3.8855427881537523`*^9, 3.885542788237467*^9}, {
   3.8855430067620525`*^9, 3.885543013668437*^9}, 3.885966882096207*^9, {
   3.8859669421437807`*^9, 3.8859669421488247`*^9}, {3.885968641323983*^9, 
   3.8859686709916077`*^9}, {3.8859700818035088`*^9, 3.885970116005333*^9}, {
   3.8859726427933483`*^9, 3.8859726621626787`*^9}, {3.8859727076000075`*^9, 
   3.885972770558454*^9}, {3.8860482606809826`*^9, 3.886048270758037*^9}, {
   3.88684029377495*^9, 3.8868404665509343`*^9}, {3.8868414104888535`*^9, 
   3.8868414225159225`*^9}, {3.8890817621378937`*^9, 3.889081762140961*^9}, {
   3.88908460476051*^9, 3.889084604763502*^9}, {3.892188794960414*^9, 
   3.8921888564262486`*^9}, 3.892276504856449*^9, {3.892705877974984*^9, 
   3.8927058964920373`*^9}, {3.89270597977682*^9, 3.892706000159081*^9}, 
   3.892890275686406*^9, 3.892890565684495*^9, {3.8928906683120165`*^9, 
   3.8928906691645193`*^9}, {3.8928921066767316`*^9, 3.892892205794788*^9}, {
   3.8928923091023135`*^9, 3.8928923130853605`*^9}, {3.892893113220736*^9, 
   3.8928931146965623`*^9}, {3.8950540496809034`*^9, 
   3.8950540764821167`*^9}, {3.8950762756864758`*^9, 
   3.8950763083391457`*^9}, {3.895129045455325*^9, 3.895129092773349*^9}, {
   3.896335021554511*^9, 3.896335031114843*^9}, {3.8972293188333693`*^9, 
   3.897229318835312*^9}, {3.904712366400467*^9, 3.9047124185854053`*^9}, {
   3.9047124502939787`*^9, 3.9047124639937067`*^9}, {3.907408873347437*^9, 
   3.907408874085919*^9}, {3.907409082450775*^9, 3.90740910474655*^9}, {
   3.9138856464879036`*^9, 3.9138856464899817`*^9}, {3.913890462716206*^9, 
   3.9138904627202673`*^9}, 3.9138915048050413`*^9, {3.9138915838094063`*^9, 
   3.913891621993849*^9}, {3.9145150076454177`*^9, 3.91451500764841*^9}, {
   3.9151858824445596`*^9, 3.915185899852844*^9}, {3.9156430654976215`*^9, 
   3.9156430655218973`*^9}, {3.9344204565402985`*^9, 3.934420486157995*^9}, {
   3.934429010811154*^9, 3.9344290301496177`*^9}, {3.934523030515656*^9, 
   3.934523042436309*^9}, {3.9347056193385677`*^9, 3.934705619362587*^9}, {
   3.934807855557102*^9, 3.9348078972302475`*^9}, {3.9348164706495886`*^9, 
   3.934816474437056*^9}},
 CellTags->"Number-of-events-computation+sensitivity",
 CellLabel->
  "In[490]:=",ExpressionUUID->"5ff1e429-21ed-463f-b582-04b4f7f4c30e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Exporting", "Chapter",
 CellChangeTimes->{{3.885054212114191*^9, 3.885054213032151*^9}},
 CellTags->
  "Number-of-events-computation+sensitivity",ExpressionUUID->"87d344ed-2d96-\
4345-98c4-a81cc45c1c16"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BlockExport", "[", "ProdChannel_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "mlist", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mlist", "=", 
      RowBox[{"mRangeExport", "[", "ProdChannel", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"TabFrom", "=", 
      RowBox[{"ParallelTable", "[", 
       RowBox[{
        RowBox[{"Quiet", "[", 
         RowBox[{"NeventsDiscret", "[", 
          RowBox[{
           RowBox[{"mlist", "[", 
            RowBox[{"[", "k", "]"}], "]"}], ",", "ProdChannel", ",", 
           "couplingsRangeExport"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", 
          RowBox[{"Length", "[", "mlist", "]"}], ",", "1"}], "}"}]}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"directory", "[", "\"\<Nevents-LLP-experiment\>\"", "]"}], 
          ",", 
          RowBox[{"FilenameNeventsInt", "[", "ProdChannel", "]"}]}], "}"}], 
        "]"}], ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{"TabFrom", ",", "1"}], "]"}], ",", "\"\<Table\>\""}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"prod", "=", 
        RowBox[{"ProductionList", "[", 
         RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"BlockExport", "[", "prod", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", 
        RowBox[{"Length", "[", "ProductionList", "]"}], ",", "1"}], "}"}]}], 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ProgressIndicator", "[", 
        RowBox[{"j", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"Length", "[", "ProductionList", "]"}]}], "}"}]}], "]"}], 
       ",", "\"\< Production mode = \>\"", ",", 
       RowBox[{"ProductionList", "[", 
        RowBox[{"[", "j", "]"}], "]"}], ",", "\"\< (\>\"", ",", " ", "j", 
       ",", "\"\</\>\"", ",", 
       RowBox[{"Length", "[", "ProductionList", "]"}], ",", "\"\<)\>\""}], 
      "}"}], "]"}]}], "]"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"icounter", ">", 
    RowBox[{"Length", "[", "SelectedExperimentList", "]"}]}], ",", 
   RowBox[{"BlockEvaluation", "[", "\"\<Sensitivity\>\"", "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8921886102299604`*^9, 3.892188661864987*^9}, {
   3.892188696661598*^9, 3.892188782889353*^9}, {3.8921888713769283`*^9, 
   3.8921888914281387`*^9}, {3.892190937661848*^9, 3.8921909466626697`*^9}, {
   3.8922765048644934`*^9, 3.8922765048725324`*^9}, {3.892541051864915*^9, 
   3.8925411081031237`*^9}, {3.8925422299627275`*^9, 
   3.8925422591259813`*^9}, {3.892542627960807*^9, 3.8925426356350746`*^9}, {
   3.8927104746862555`*^9, 3.892710508465253*^9}, {3.8950703812229633`*^9, 
   3.895070389767537*^9}, 3.9027274561413517`*^9, {3.9037911184286413`*^9, 
   3.90379111843118*^9}, 3.9037940600873704`*^9, 3.9138695182916346`*^9, {
   3.9138696778224015`*^9, 3.9138697217311115`*^9}, 3.9145150076546106`*^9, {
   3.9146674986335506`*^9, 3.9146675043101397`*^9}, 3.915643065529893*^9},
 CellTags->"Number-of-events-computation+sensitivity",
 CellLabel->
  "In[499]:=",ExpressionUUID->"1f4946c3-23ce-4e70-bc72-93b0971707fc"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Computing sensitivities", "Title",
 CellChangeTimes->{{3.885020809493571*^9, 3.88502081261261*^9}},
 CellTags->
  "Sensitivity",ExpressionUUID->"20138663-2b9a-41fa-8718-2e1c02355f2d"],

Cell[CellGroupData[{

Cell["Basic definitions", "Chapter",
 CellChangeTimes->{{3.9138314745388813`*^9, 3.913831477098402*^9}},
 CellTags->
  "Sensitivity",ExpressionUUID->"e53fa63b-a742-40cf-a205-b2502f696dbd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPdirName", "=", "\"\<DP\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"directory", "[", "\"\<Sensitivity\>\"", "]"}], "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<Sensitivity domains\>\""}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"directory", "[", "\"\<Sensitivity-LLP\>\"", "]"}], "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"directory", "[", "\"\<Sensitivity\>\"", "]"}], ",", 
      "LLPdirName"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"DirectoryQ", "[", 
        RowBox[{"directory", "[", "#", "]"}], "]"}]}], ",", 
      RowBox[{"CreateDirectory", "[", 
       RowBox[{"directory", "[", "#", "]"}], "]"}]}], "]"}], "&"}], "/@", 
   RowBox[{"{", 
    RowBox[{"\"\<Sensitivity\>\"", ",", "\"\<Sensitivity-LLP\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"directory", "[", "\"\<Nevents-LLP\>\"", "]"}], "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<Tabulated Nevents\>\"", ",", "LLPdirName"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"infoDialog", "[", "phrase_", "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<Proceed\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"selectionDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", 
      RowBox[{"{", "}"}]}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{"{", "phrase", "}"}], "]"}], ",", 
       RowBox[{"Pane", "[", 
        RowBox[{
         RowBox[{"TogglerBar", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list", ",", 
           RowBox[{"Appearance", "->", 
            RowBox[{"\"\<Vertical\>\"", "->", 
             RowBox[{"{", 
              RowBox[{"Automatic", ",", "5"}], "}"}]}]}]}], "]"}], ",", 
         RowBox[{"ImageSize", "->", 
          RowBox[{"{", 
           RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], ",", 
         RowBox[{"Scrollbars", "->", 
          RowBox[{"{", 
           RowBox[{"False", ",", "True"}], "}"}]}]}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentDirectoriesListNevents", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"FileNames", "[", 
      RowBox[{"\"\<*\>\"", ",", 
       RowBox[{"directory", "[", "\"\<Nevents-LLP\>\"", "]"}], ",", "1"}], 
      "]"}], ",", "DirectoryQ"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
  "\"\<List of available experiments with tabulated \!\(\*SubscriptBox[\(N\), \
\(events\)]\) for \>\"", " ", "<>", "LLPdirName", "<>", "\"\<:\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentsListNevents", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"FileNameTake", "[", 
       RowBox[{
        RowBox[{"ExperimentDirectoriesListNevents", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "ExperimentDirectoriesListNevents", "]"}], ",",
         "1"}], "}"}]}], "]"}], "//", "Sort"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ExperimentsListNevents", "//", "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", "ExperimentsListNevents", "]"}], "\[Equal]", "0"}],
    ",", 
   RowBox[{
   "Print", "[", 
    "\"\<No experiment is available, generate first the acceptance for the \
given experiment using module 1\>\"", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SelectedExperimentList", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "ExperimentsListNevents", "]"}], "\[NotEqual]",
         "0"}], ",", 
       RowBox[{"selectionDialog", "[", 
        RowBox[{
        "ExperimentsListNevents", ",", 
         "\"\<Select the experiments for which the sensitivity will be \
computed:\>\""}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"icounter", "=", "1"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"BlockEvaluation", "[", "tag_", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nb", "=", 
         RowBox[{"EvaluationNotebook", "[", "]"}]}], ";", "\n", 
        RowBox[{"NotebookFind", "[", 
         RowBox[{"nb", ",", "tag", ",", "All", ",", "CellTags"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
       "BlockEvaluation", "[", "\"\<Sensitivity-computation\>\"", "]"}], 
       ";"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"icounter", ",", "1", ",", 
        RowBox[{"Length", "[", "SelectedExperimentList", "]"}], ",", "1"}], 
       "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.9138315400875525`*^9, 3.91383154039198*^9}, {
   3.913891670421169*^9, 3.913891673276001*^9}, {3.913955090567734*^9, 
   3.9139550906928043`*^9}, 3.914667466503278*^9, 3.915262345075774*^9, {
   3.9156430655419803`*^9, 3.9156430655634193`*^9}, 3.9158204210190673`*^9, {
   3.9344281686886263`*^9, 3.934428170366126*^9}},
 CellTags->"Sensitivity",
 CellLabel->
  "In[502]:=",ExpressionUUID->"99f6e797-c44c-4cdb-b806-3efcbdcad495"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Specifying the experiment and interpolating tabulated number of events\
\>", "Chapter",
 CellChangeTimes->{{3.8865657605515084`*^9, 3.886565789800824*^9}, {
  3.8891547325867977`*^9, 3.8891547373469143`*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"8558a057-a38a-454c-bfce-\
bde3419e907e"],

Cell[CellGroupData[{

Cell["Selecting the experiment", "Section",
 CellChangeTimes->{{3.9139658068606853`*^9, 3.913965811150226*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"d2e4b5e5-7ca9-46d1-8935-\
925aa00d1a4f"],

Cell[BoxData[{
 RowBox[{"Print", "[", "\"\<Selected experiment:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"GivenExperimentForSensitivityComputation", "=", 
  RowBox[{"SelectedExperimentList", "[", 
   RowBox[{"[", 
    RowBox[{"icounter", "++"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CondANUBIS", "=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<ANUBIS-shaft-volume-1\>\"", ",", "\"\<ANUBIS-shaft-volume-2\>\"", 
       ",", "\"\<ANUBIS-shaft-volume-3\>\""}], "}"}], ",", 
     "GivenExperimentForSensitivityComputation"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"CondANUBIS", "\[Equal]", "True"}], ",", 
   RowBox[{"infoDialog", "[", 
    RowBox[{"Row", "[", 
     RowBox[{
     "{", "\"\<One of the modules of ANUBIS-shaft is chosen. The full \
sensitivity includes three modules. The importing will be over all modules, \
so for all ot the the sensitivity has to be computed\>\"", "}"}], "]"}], 
    "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"CondANUBIS", "\[Equal]", "False"}], ",", 
    RowBox[{"GivenExperimentForSensitivityComputationList", "=", 
     RowBox[{"{", "GivenExperimentForSensitivityComputation", "}"}]}], ",", 
    RowBox[{"GivenExperimentForSensitivityComputationList", "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\<ANUBIS-shaft-volume-1\>\"", ",", "\"\<ANUBIS-shaft-volume-2\>\"", 
       ",", "\"\<ANUBIS-shaft-volume-3\>\""}], "}"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PathsNeventsSelected", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{"PathsNeventsSelected", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"PathsNeventsSelected", ",", 
        RowBox[{"FileNames", "[", 
         RowBox[{"\"\<*.dat\>\"", ",", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"directory", "[", "\"\<Nevents-LLP\>\"", "]"}], ",", 
             "exp"}], "}"}], "]"}]}], "]"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "GivenExperimentForSensitivityComputationList"}], 
      "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Creating", " ", "the", " ", "directory", " ", "for", " ", "exporting", 
    " ", "sensitivity", " ", "curves"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentFolder", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"CondANUBIS", "\[Equal]", "True"}], ",", "\"\<ANUBIS\>\"", ",", 
     "GivenExperimentForSensitivityComputation"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"directory", "[", "\"\<Sensitivity-LLP-exp\>\"", "]"}], "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"directory", "[", "\"\<Sensitivity-LLP\>\"", "]"}], ",", 
      "ExperimentFolder"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"!", 
    RowBox[{"DirectoryQ", "[", 
     RowBox[{"directory", "[", "\"\<Sensitivity-LLP-exp\>\"", "]"}], "]"}]}], 
   ",", 
   RowBox[{"CreateDirectory", "[", 
    RowBox[{"directory", "[", "\"\<Sensitivity-LLP-exp\>\"", "]"}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.886840860661646*^9, 3.886840860664637*^9}, 
   3.8890817880618696`*^9, {3.8891547447151575`*^9, 3.8891549444728413`*^9}, {
   3.8891555762544374`*^9, 3.8891555856760416`*^9}, {3.8932345510125337`*^9, 
   3.89323456368647*^9}, {3.89357120648059*^9, 3.8935714592585745`*^9}, {
   3.893571545207655*^9, 3.8935715786721*^9}, {3.8935716945595617`*^9, 
   3.8935717354831114`*^9}, {3.893572484980073*^9, 3.8935725300692596`*^9}, {
   3.895054024169799*^9, 3.8950540417214823`*^9}, 3.89684678645724*^9, 
   3.89919325721731*^9, {3.905403972343326*^9, 3.9054039725337305`*^9}, {
   3.907411978163224*^9, 3.9074119810572186`*^9}, {3.907412091826584*^9, 
   3.907412094086093*^9}, {3.9138856464971056`*^9, 3.9138856465141516`*^9}, {
   3.9138916838349504`*^9, 3.913891827396206*^9}, {3.9138921667513247`*^9, 
   3.913892172717104*^9}, {3.913892368507559*^9, 3.9138923707397146`*^9}, {
   3.913954268074481*^9, 3.9139542724904437`*^9}, 3.913954515586889*^9, {
   3.9139550482633314`*^9, 3.913955048705912*^9}, {3.913955096763817*^9, 
   3.913955158064865*^9}, {3.913955220888626*^9, 3.9139554719164515`*^9}, {
   3.9139555299768157`*^9, 3.913955594188072*^9}, {3.9139558613427095`*^9, 
   3.9139559117838964`*^9}, {3.9139559447796946`*^9, 
   3.9139560410144596`*^9}, {3.913963274949171*^9, 3.913963326902071*^9}, {
   3.9139633600739164`*^9, 3.9139635321188793`*^9}, {3.913963598616632*^9, 
   3.9139636458854485`*^9}, 3.9139640986736097`*^9, {3.9139652026009254`*^9, 
   3.9139652159221773`*^9}, {3.913965669649431*^9, 3.913965669801878*^9}, {
   3.913965852616486*^9, 3.9139658533797336`*^9}, {3.9139739848899965`*^9, 
   3.9139739939318266`*^9}, 3.9145150076636033`*^9, {3.9146674411334615`*^9, 
   3.9146674532611327`*^9}, 3.9146686803003097`*^9, {3.9156430655724087`*^9, 
   3.915643065581047*^9}, {3.9158205477529774`*^9, 3.9158205483157797`*^9}, {
   3.9158208476984944`*^9, 3.915820847707511*^9}},
 CellTags->"Sensitivity-computation",
 CellLabel->
  "In[568]:=",ExpressionUUID->"c04809c2-412f-4207-902a-ca107db71530"]
}, Closed]],

Cell[CellGroupData[{

Cell["Importing data and interpolations", "Section",
 CellChangeTimes->{{3.9139658068606853`*^9, 3.9139658231084366`*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"8dbf4156-fa28-4b8c-98ea-\
b1e3be065ffb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
    "___", "___", "___", "___", "___", "___", "___", "___"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Importing", " ", "and", " ", "interpolation"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
    "___", "___", "___", "___", "___", "___", "___", "___"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Print", "[", "\"\<List of production channels:\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FilenamesNeventsSelected", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Last", "@", 
        RowBox[{"FileNameSplit", "@", 
         RowBox[{"PathsNeventsSelected", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "PathsNeventsSelected", "]"}], ",", "1"}], 
        "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FilenameParameters", "[", "i_", "]"}], ":=", 
    RowBox[{
     RowBox[{"StringCases", "[", 
      RowBox[{
       RowBox[{"FilenamesNeventsSelected", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<Nevents_\>\"", "<>", "LLPdirName", "<>", "\"\<_\>\""}], 
         "~~", "mother__", "~~", "\"\<_at_\>\"", "~~", "experiment__", "~~", 
         "\"\<_Npot=\>\"", "~~", "Npot__", "~~", "\"\<.dat\>\""}], ":>", 
        RowBox[{"{", 
         RowBox[{"mother", ",", "experiment", ",", "Npot"}], "}"}]}]}], "]"}],
      "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ProductionInfoList", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"FilenameParameters", "[", "i", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "FilenamesNeventsSelected", "]"}], ",", "1"}],
         "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
        "\"\<Mother\>\"", ",", "\"\<Experiment\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[\(N\), \(PoT\)]\)\>\""}], "}"}], "}"}], ",", 
      "ProductionInfoList"}], "]"}], "//", "TableForm"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ProductionChannelsList", "=", 
     RowBox[{"ProductionInfoList", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NpotDefault", "=", 
     RowBox[{
      RowBox[{"Interpreter", "[", "\"\<Number\>\"", "]"}], "[", 
      RowBox[{
       RowBox[{"ProductionInfoList", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NeventsTabulated", "//", "Clear"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Epsilon]reco", "[", "mLLP_", "]"}], "=", "1"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"StringContainsQ", "[", 
       RowBox[{
       "GivenExperimentForSensitivityComputation", ",", 
        "\"\<LHCb-downstream\>\""}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Epsilon]reco", "[", "mLLP_", "]"}], "=", "0.4"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"StringContainsQ", "[", 
       RowBox[{
       "GivenExperimentForSensitivityComputation", ",", "\"\<NuCal\>\""}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Epsilon]reco", "[", "mLLP_", "]"}], "=", "0.7"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"StringContainsQ", "[", 
       RowBox[{
       "GivenExperimentForSensitivityComputation", ",", "\"\<CHARM\>\""}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Epsilon]reco", "[", "mLLP_", "]"}], "=", "0.6"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "prod", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"prod", "=", 
         RowBox[{"ProductionChannelsList", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "The", " ", "condition", " ", "if", " ", "one", " ", "sums", " ", 
          "the", " ", "number", " ", "of", " ", "events", " ", "for", " ", 
          "the", " ", "same", " ", "production", " ", "mode", " ", "over", 
          " ", "several", " ", "experiments"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"IfprodExists", "=", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Keys", "[", 
             RowBox[{"DownValues", "@", "NeventsTabulated"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], ",", "prod"}],
           "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NeventsTabulated", "[", "prod", "]"}], "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", "IfprodExists"}], ",", 
           RowBox[{"Import", "[", 
            RowBox[{
             RowBox[{"PathsNeventsSelected", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<Table\>\""}], "]"}], 
           ",", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"NeventsTabulated", "[", "prod", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"NeventsTabulated", "[", "prod", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", 
                 RowBox[{"{", "3", "}"}]}], "]"}], "]"}], "+", 
              RowBox[{
               RowBox[{"Import", "[", 
                RowBox[{
                 RowBox[{"PathsNeventsSelected", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<Table\>\""}], 
                "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", 
                 RowBox[{"{", "3", "}"}]}], "]"}], "]"}]}]}], "]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"mminmax", "[", "prod", "]"}], ",", 
           RowBox[{"couplingminmax", "[", "prod", "]"}]}], "}"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"NeventsTabulated", "[", "prod", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "#"}], "]"}], "]"}], "//", "MinMax"}], 
            ")"}], "&"}], "/@", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NevMax", "[", "prod", "]"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"NeventsTabulated", "[", "prod", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "3"}], "]"}], "]"}], "//", "Max"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NevInt", "[", 
          RowBox[{"mLLP_", ",", "\[Epsilon]2_", ",", "prod"}], "]"}], "=", 
         RowBox[{
          RowBox[{"\[Epsilon]reco", "[", "mLLP", "]"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"mminmax", "[", "prod", "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", " ", "mLLP", 
              "\[LessEqual]", 
              RowBox[{
               RowBox[{"mminmax", "[", "prod", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "&&", 
             RowBox[{
              RowBox[{
               RowBox[{"couplingminmax", "[", "prod", "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", "\[Epsilon]2", 
              "\[LessEqual]", 
              RowBox[{
               RowBox[{"couplingminmax", "[", "prod", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Interpolation", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log10", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Log10", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Log10", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "+", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "90"}]]}], "]"}]}], "}"}], "&"}], "/@", 
                   RowBox[{"NeventsTabulated", "[", "prod", "]"}]}], ",", 
                  RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], 
                "[", 
                RowBox[{
                 RowBox[{"Log10", "[", "mLLP", "]"}], ",", 
                 RowBox[{"Log10", "[", "\[Epsilon]2", "]"}]}], "]"}], ")"}]}],
              "]"}], ",", "0"}], "]"}]}]}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "ProductionInfoList", "]"}], ",", "1"}], 
      "}"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mminmaxOverall", ",", "couplingminmaxOverall"}], "}"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"MinMax", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"#", "[", "prod", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"prod", ",", "ProductionChannelsList"}], "}"}]}], "]"}], "//",
          "Flatten"}], "]"}], "&"}], "/@", 
      RowBox[{"{", 
       RowBox[{"mminmax", ",", "couplingminmax"}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NevMaxOverall", "=", 
     RowBox[{"Max", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NevMax", "[", "prod", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "ProductionChannelsList"}], "}"}]}], "]"}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9139740015576224`*^9, 3.913974002429924*^9}, {
   3.914060453150184*^9, 3.914060473916649*^9}, {3.914062253756744*^9, 
   3.914062273041237*^9}, {3.9145150076813545`*^9, 3.9145150076989536`*^9}, {
   3.9146674208960304`*^9, 3.9146674231345167`*^9}, {3.914670783416334*^9, 
   3.9146707834341106`*^9}, {3.9156430656011753`*^9, 3.915643065649435*^9}, {
   3.9158198101069565`*^9, 3.91581981355842*^9}, {3.9158205477702045`*^9, 
   3.915820569650995*^9}, {3.9158208477184887`*^9, 3.9158208477366295`*^9}, {
   3.917768978419938*^9, 3.9177689945791063`*^9}, {3.917852269986107*^9, 
   3.917852293159746*^9}, {3.917852599273158*^9, 3.9178525992954884`*^9}, {
   3.918668246699964*^9, 3.918668246901412*^9}, {3.920109061264347*^9, 
   3.920109061578763*^9}, {3.9342227843903494`*^9, 3.9342230527607665`*^9}, 
   3.934223092127531*^9, {3.9342231421434155`*^9, 3.9342231483195963`*^9}, 
   3.9342231843098392`*^9, {3.9344209284856024`*^9, 3.9344210264501743`*^9}, {
   3.934421059081024*^9, 3.9344210739498034`*^9}, {3.934421382083383*^9, 
   3.9344213824787145`*^9}, {3.9344218864537897`*^9, 3.934421886908209*^9}},
 CellTags->"Sensitivity-computation",
 CellLabel->
  "In[578]:=",ExpressionUUID->"712e0550-86f1-4004-ba68-1c8c28691518"],

Cell[CellGroupData[{

Cell["Accounting for various bremsstrahlung descriptions", "Subsection",
 CellChangeTimes->{{3.9344213636600704`*^9, 3.934421371467765*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"95e1b614-5556-4859-87ea-\
fe7cd3143b65"],

Cell[BoxData[{
 RowBox[{"Print", "[", "\"\<List of various bremsstrahlung channels:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BremChannelsList", "=", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{"ProductionChannelsList", ",", 
      RowBox[{
       RowBox[{"StringContainsQ", "[", 
        RowBox[{"#", ",", "\"\<Bremsstrahlung\>\""}], "]"}], "&"}]}], "]"}], "//",
     "Sort"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Defining", " ", "the", " ", "baseline", " ", "bremsstrahlung", " ", 
    "setup"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BremChannelBaseline", "=", "\"\<Bremsstrahlung-FR-Central\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"BremChannelsList", "==", 
     RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ProductionChannelsListUnified", "=", "ProductionChannelsList"}],
      ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"BremChannelsList", ",", "BremChannelBaseline"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ProductionChannelsBaseline", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{"ProductionChannelsList", ",", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"StringContainsQ", "[", 
                RowBox[{"#", ",", "\"\<Bremsstrahlung\>\""}], "]"}]}], 
              "&"}]}], "]"}], ",", 
           RowBox[{"{", "BremChannelBaseline", "}"}]}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{"ProductionChannelsBaseline", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"ProductionChannelsList", ",", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"StringContainsQ", "[", 
               RowBox[{"#", ",", "\"\<Bremsstrahlung\>\""}], "]"}]}], "&"}]}],
            "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"BremChannelsList", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ProductionChannelsListUnified", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"ProductionChannelsList", ",", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"StringContainsQ", "[", 
             RowBox[{"#", ",", "\"\<Bremsstrahlung\>\""}], "]"}]}], "&"}]}], 
         "]"}], ",", 
        RowBox[{"{", "\"\<Bremsstrahlung\>\"", "}"}]}], "]"}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"BremNameExportPattern", "[", "#1", "]"}], "=", "#2"}], ")"}], 
     "&"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\"\<Bremsstrahlung-\>\"", "<>", "#"}], ")"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{
        "\"\<FR-Upper\>\"", ",", "\"\<FR-Central\>\"", ",", 
         "\"\<FR-Lower\>\"", ",", "\"\<Baseline\>\"", ",", "\"\<AP-Upper\>\"",
          ",", "\"\<AP-Central\>\"", ",", "\"\<AP-Lower\>\""}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<FR-Upper\>\"", ",", "\"\<FR-Central\>\"", ",", "\"\<FR-Lower\>\"",
         ",", "\"\<Baseline\>\"", ",", "\"\<AP-Upper\>\"", ",", 
        "\"\<AP-Central\>\"", ",", "\"\<AP-Lower\>\""}], "}"}]}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NevIntOverall", "[", 
    RowBox[{"mLLP_", ",", "\[Epsilon]2_"}], "]"}], "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"NevInt", "[", 
      RowBox[{"mLLP", ",", "\[Epsilon]2", ",", "prod"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"prod", ",", "ProductionChannelsBaseline"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pt", "[", "mLLP_", "]"}], ":=", 
  RowBox[{"LogLogPlot", "[", 
   RowBox[{
    RowBox[{"Evaluate", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"NevInt", "[", 
        RowBox[{"mLLP", ",", "y", ",", "prod"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"prod", ",", "ProductionChannelsBaseline"}], "}"}]}], "]"}], 
     "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", 
      RowBox[{"couplingminmaxOverall", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"couplingminmaxOverall", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"Placed", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"#", ",", "15"}], "]"}], "&"}], "/@", 
        "ProductionChannelsBaseline"}], ",", "Right"}], "]"}]}], ",", 
    RowBox[{"PlotRange", "->", 
     RowBox[{"{", 
      RowBox[{"couplingminmaxOverall", ",", 
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["10", 
          RowBox[{"-", "2"}]], ",", "NevMaxOverall"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Frame", "->", "True"}], ",", 
    RowBox[{"ImageSize", "->", "Large"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(\[Epsilon]\), \(2\)]\)\>\"", " ", ",", " ", 
       "\"\<\!\(\*SubscriptBox[\(N\), \(events\)]\)[\!\(\*SubscriptBox[\(m\), \
\(V\)]\),\!\(\*SuperscriptBox[\(\[Epsilon]\), \(2\)]\)]\>\""}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", " ", "23"}], "]"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", 
         RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", 
         RowBox[{"Darker", "@", 
          RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Black"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Blue", ",", 
         RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", 
         RowBox[{"Darker", "@", "Red"}], ",", 
         RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", 
         RowBox[{"Darker", "@", 
          RowBox[{"Darker", "@", "Green"}]}], ",", 
         RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Black", ",", 
         RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{"{", 
         RowBox[{
         "ExperimentFolder", ",", 
          "\"\<. \!\(\*SubscriptBox[\(m\), \(V\)]\) = \>\"", ",", "mLLP", ",",
           " ", "\"\< GeV\>\""}], "}"}], "]"}], ",", "20", ",", "Black"}], 
      "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"pt", "[", "0.7", "]"}]}], "Input",
 CellChangeTimes->{{3.9344214061369877`*^9, 3.9344214204168596`*^9}, {
  3.9344218908614206`*^9, 3.934421911216852*^9}, {3.934421946639409*^9, 
  3.93442203218508*^9}, {3.9344226880216246`*^9, 3.9344226886615286`*^9}, {
  3.9344227585794473`*^9, 3.9344227618807783`*^9}, {3.9344229632846923`*^9, 
  3.934422985720289*^9}, {3.9344232039753017`*^9, 3.9344232051634417`*^9}, {
  3.934425118417382*^9, 3.9344251228031607`*^9}, {3.934555568906765*^9, 
  3.934555609855014*^9}, {3.935134776652753*^9, 3.9351347766547527`*^9}},
 CellTags->"Sensitivity-computation",
 CellLabel->
  "In[593]:=",ExpressionUUID->"eb97b023-365e-4974-b333-ec02097bbc3e"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Sensitivity", "Chapter",
 CellChangeTimes->{{3.8865657605515084`*^9, 3.886565789800824*^9}, {
  3.8891547325867977`*^9, 3.8891547373469143`*^9}, {3.913965830034291*^9, 
  3.9139658311040325`*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"ca66427b-19d6-4877-8ebb-\
41db99aeba92"],

Cell[CellGroupData[{

Cell["Events density plot", "Section",
 CellChangeTimes->{{3.8928925129732084`*^9, 3.8928925141322923`*^9}, {
  3.892910359615284*^9, 3.892910363538608*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"a59ae6cb-9828-417c-bdd1-\
fff95cb38e4f"],

Cell[BoxData[{
 RowBox[{"plot", "=", 
  RowBox[{"DensityPlot", "[", 
   RowBox[{
    RowBox[{"Evaluate", "[", 
     RowBox[{"Log10", "[", 
      RowBox[{"NevIntOverall", "[", 
       RowBox[{"mLLP", ",", "\[Epsilon]2"}], "]"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"mLLP", ",", 
      RowBox[{"mminmaxOverall", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"mminmaxOverall", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Epsilon]2", ",", 
      RowBox[{"couplingminmaxOverall", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"couplingminmaxOverall", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"ScalingFunctions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Log\>\"", ",", "\"\<Log\>\""}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "0.78"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"All", ",", "All", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log10", "[", "2.3", "]"}], ",", 
         RowBox[{"Log10", "[", "NevMaxOverall", "]"}]}], "}"}]}], "}"}]}], 
    ",", 
    RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(m\), \(V\)]\) [GeV]\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Epsilon]\), \(2\)]\)\>\""}], "}"}]}], 
    ",", " ", 
    RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", " ", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", " ", "25"}], "]"}]}], ",", 
    RowBox[{"PlotPoints", "\[Rule]", "100"}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"Placed", "[", 
      RowBox[{
       RowBox[{"BarLegend", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Automatic", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Log10", "[", "2.3", "]"}], ",", 
             RowBox[{"Log10", "[", "NevMaxOverall", "]"}]}], "}"}]}], "}"}], 
         ",", 
         RowBox[{"LegendMarkerSize", "\[Rule]", "340"}], ",", 
         RowBox[{"LegendLabel", "\[Rule]", 
          RowBox[{"Placed", "[", 
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(Log\), \
\(10\)]\)[\!\(\*SubscriptBox[\(N\), \(ev\)]\)]\>\"", ",", "Bottom"}], "]"}]}],
          ",", 
         RowBox[{"LabelStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"FontSize", "\[Rule]", "22"}], "}"}]}], ",", 
         RowBox[{"Method", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
            RowBox[{"AxesStyle", "\[Rule]", "None"}], ",", 
            RowBox[{"TicksStyle", "\[Rule]", "Black"}]}], "}"}]}]}], "]"}], 
       ",", "Right"}], "]"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{"{", "ExperimentFolder", "}"}], "]"}], ",", "20", ",", 
       "Black"}], "]"}]}]}], 
   RowBox[{"(*", 
    RowBox[{",", 
     RowBox[{"FrameTicks", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Automatic", ",", "Automatic"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"TicksPlotx", ",", "None"}], "}"}]}], "}"}]}]}], "*)"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<plots/SensCalc/NeventsDensityPlotExample.pdf\>\""}], "}"}], "]"}], 
   ",", "plot", ",", 
   RowBox[{"\"\<AllowRasterization\>\"", "->", "False"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8929096922410564`*^9, 3.892909806303069*^9}, {
   3.8929100920281754`*^9, 3.8929100955435038`*^9}, {3.8929101335841722`*^9, 
   3.892910162228066*^9}, {3.8929101949082084`*^9, 3.8929101952618375`*^9}, {
   3.893481779378194*^9, 3.893481781603961*^9}, {3.8935713726623445`*^9, 
   3.8935713726663337`*^9}, 3.893571593533576*^9, {3.893600462416499*^9, 
   3.893600464823284*^9}, {3.8936007175747695`*^9, 3.8936007273021555`*^9}, {
   3.8936008794615602`*^9, 3.8936008816425495`*^9}, {3.893605565414917*^9, 
   3.8936055685099897`*^9}, {3.894552167897132*^9, 3.894552190947688*^9}, {
   3.9138856465220795`*^9, 3.9138856465250854`*^9}, {3.9139635639485736`*^9, 
   3.913963579089311*^9}, 3.9139636566744375`*^9, {3.9139640983446198`*^9, 
   3.913964098352851*^9}, {3.9139656696637654`*^9, 3.9139656696674147`*^9}, {
   3.915643066011381*^9, 3.9156430660143795`*^9}},
 CellTags->"Sensitivity-computation",
 CellLabel->
  "In[601]:=",ExpressionUUID->"dfa47edf-f1da-4b2e-b4e4-0bdbee1c1674"]
}, Closed]],

Cell[CellGroupData[{

Cell["Importing constraints", "Section",
 CellChangeTimes->{{3.9139638439670105`*^9, 3.9139638463219385`*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"15df64ef-f8bc-45f8-9d3a-\
b2b9fc3a4c63"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ConstraintsDPtemp", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<contours/DP/constraints-DP.mx\>\""}], "}"}], "]"}], ",", 
     "\"\<MX\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ConstraintsTypeDP", "=", 
  RowBox[{"ConstraintsDPtemp", "[", 
   RowBox[{"[", 
    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ExcludedRegions", "[", 
      RowBox[{"\"\<DP\>\"", ",", 
       RowBox[{
        RowBox[{"ConstraintsDPtemp", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "=", 
     RowBox[{
      RowBox[{"ConstraintsDPtemp", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "ConstraintsDPtemp", "]"}], ",", "1"}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.913954473848921*^9, 3.9139545020914497`*^9}, {
   3.913954538781415*^9, 3.9139547566326075`*^9}, {3.9139551197291293`*^9, 
   3.913955119731121*^9}, {3.913955157942445*^9, 3.913955157944439*^9}, {
   3.9139637161395655`*^9, 3.9139637459797597`*^9}, 3.9139638034238195`*^9, 
   3.9139638559036703`*^9, 3.9146674126897407`*^9, {3.915643066455455*^9, 
   3.91564306646422*^9}, 3.935423980628223*^9},
 CellTags->"Sensitivity-computation",
 CellLabel->
  "In[603]:=",ExpressionUUID->"d222b99d-aa87-4a70-9775-f512810f7932"]
}, Closed]],

Cell[CellGroupData[{

Cell["Sensitivity evaluation", "Section",
 CellChangeTimes->{{3.9139638518488245`*^9, 3.913963854535544*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"b9b04a85-a4aa-45a1-9921-\
706d27f2c6b8"],

Cell[CellGroupData[{

Cell["Sensitivity calculator block", "Subsection",
 CellChangeTimes->{{3.9344284768399067`*^9, 3.9344284803812065`*^9}, {
  3.9345997252424593`*^9, 3.934599726886627*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"4b0acb2b-464a-4780-87c2-\
adee5815e682"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SensitivityExtractor", "[", 
   RowBox[{"SelectedProduction_", ",", "Npot_", ",", "NevMin_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"RegSens", ",", "SensTemp"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"NevTot", "[", 
       RowBox[{"mLLP_", ",", "\[Epsilon]2_"}], "]"}], "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"NevInt", "[", 
         RowBox[{"mLLP", ",", "\[Epsilon]2", ",", "prod"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "SelectedProduction"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RegSens", "=", 
      RowBox[{"RegionPlot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          FractionBox["Npot", "NpotDefault"], 
          RowBox[{"NevTot", "[", 
           RowBox[{
            SuperscriptBox["10", "mLLP"], ",", 
            SuperscriptBox["10", "\[Epsilon]2"]}], "]"}]}], "\[GreaterEqual]",
          "NevMin"}], ",", 
        RowBox[{"{", 
         RowBox[{"mLLP", ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"mminmaxOverall", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"mminmaxOverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Epsilon]2", ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"couplingminmaxOverall", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"couplingminmaxOverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotPoints", "->", "300"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SensTemp", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"Normal", "@", "RegSens"}], ",", 
        RowBox[{
         RowBox[{"Line", "[", "x_", "]"}], "\[RuleDelayed]", "x"}], ",", 
        "Infinity"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"10", "^", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"10", "^", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], "&"}], "/@", 
        RowBox[{"SensTemp", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "SensTemp", "]"}], ",", "1"}], "}"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SensitivityExtractorBrem", "[", 
   RowBox[{"SelectedProduction_", ",", "i_", ",", "Npot_", ",", "NevMin_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"bremch", ",", "selprod"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"bremch", "=", 
      RowBox[{"BremChannelsList", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"selprod", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"SelectedProduction", ",", 
          RowBox[{
           RowBox[{"#", "!=", "\"\<Bremsstrahlung\>\""}], "&"}]}], "]"}], ",", 
        RowBox[{"{", "bremch", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"i", ",", "selprod", ",", 
       RowBox[{"BremNameExportPattern", "[", "bremch", "]"}], ",", 
       RowBox[{"SensitivityExtractor", "[", 
        RowBox[{"selprod", ",", "Npot", ",", "NevMin"}], "]"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SensitivityBlock", "[", 
   RowBox[{"NevMin_", ",", "Npot_", ",", "SelectedProduction_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{"SelectedProduction", ",", "\"\<Bremsstrahlung\>\""}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"TabSens", "=", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"1", ",", "SelectedProduction", ",", "\"\<None\>\"", ",", 
            RowBox[{"SensitivityExtractor", "[", 
             RowBox[{"SelectedProduction", ",", "Npot", ",", "NevMin"}], 
             "]"}]}], "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"TabSens", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"SensitivityExtractorBrem", "[", 
            RowBox[{
            "SelectedProduction", ",", "i", ",", "Npot", ",", "NevMin"}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "BremChannelsList", "]"}], ",", "1"}], 
            "}"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"filenameexport", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"directory", "[", "\"\<Sensitivity-LLP-exp\>\"", "]"}], ",", 
         RowBox[{"ToString", "@", 
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<Sensitivity_``_at_``_Nev=``_Npot=``.\>\"", ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"{", 
              RowBox[{"LLPdirName", ",", "ExperimentFolder", ",", 
               RowBox[{"NevMin", "//", "ToString"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"N", "[", "Npot", "]"}], "//", "CForm"}], "//", 
                "ToString"}]}], "}"}]}]}], "]"}]}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"assocData", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{"\"\<Index\>\"", "->", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<Production modes\>\"", "->", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<Bremsstrahlung description\>\"", "->", 
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<Sensitivity domains\>\"", "->", 
            RowBox[{"#", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}]}], "]"}], "&"}], ",", 
        "TabSens"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"filenameexport", "<>", "\"\<mx\>\""}], ",", "TabSens", ",", 
       "\"\<MX\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"filenameexport", "<>", "\"\<json\>\""}], ",", "assocData", 
       ",", "\"\<JSON\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", "TabSens", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{"filenameexport", "<>", "\"\<mx\>\""}], ",", "\"\<MX\>\""}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.934421479980956*^9, 3.934421485637372*^9}, {
   3.9344215212004547`*^9, 3.9344216544224505`*^9}, {3.934421813294731*^9, 
   3.93442184894899*^9}, {3.9344225795802717`*^9, 3.93442259848044*^9}, {
   3.9344226459818587`*^9, 3.9344226510014877`*^9}, {3.9344230006660337`*^9, 
   3.9344230638395133`*^9}, {3.9344231355251417`*^9, 3.934423156451792*^9}, {
   3.934423215387514*^9, 3.9344232768091245`*^9}, {3.9344234615918875`*^9, 
   3.9344234629753327`*^9}, {3.9344235257969522`*^9, 3.934423532738423*^9}, {
   3.934423565109843*^9, 3.9344235672259784`*^9}, {3.9344236206065826`*^9, 
   3.9344236262941875`*^9}, 3.934423717560384*^9, {3.934424163055132*^9, 
   3.934424289932214*^9}, {3.9344243294173565`*^9, 3.934424340227537*^9}, {
   3.934424459148281*^9, 3.9344245173287725`*^9}, {3.9344246092525973`*^9, 
   3.934424658569865*^9}, {3.934424739992304*^9, 3.9344247632089224`*^9}, {
   3.934424888109357*^9, 3.9344249791220064`*^9}, {3.934425254878038*^9, 
   3.934425258561247*^9}, {3.934425404757271*^9, 3.934425404804878*^9}, {
   3.9344279717944*^9, 3.934428038199317*^9}, {3.9344281562037163`*^9, 
   3.9344281576640196`*^9}, {3.934428813513471*^9, 3.934428827909872*^9}, 
   3.934446479432088*^9, {3.934447035578642*^9, 3.9344470368597403`*^9}, {
   3.9347839860605097`*^9, 3.9347839879068165`*^9}},
 CellTags->"Sensitivity-computation",
 CellLabel->
  "In[606]:=",ExpressionUUID->"77491e31-6ccd-4b4c-9162-3fc7efc33e3f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Sensitivity setup and plot", "Subsection",
 CellChangeTimes->{{3.93442849021461*^9, 3.934428496021304*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"4af71be4-b031-4d3f-aac5-\
c3bd871b62a5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"productionlist", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", "\"\<All\>\"", "}"}], ",", 
     "ProductionChannelsListUnified"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DynamicModule", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"input1", "=", "NpotDefault"}], ",", 
      RowBox[{"input2", "=", "2.3"}], ",", 
      RowBox[{"choice", "=", 
       RowBox[{"{", "\"\<All\>\"", "}"}]}], ",", "list", ",", "phrase"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"DialogInput", "[", 
     RowBox[{"Column", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"ExperimentFolder", ",", "Bold"}], "]"}], ",", 
        RowBox[{
        "TextCell", "[", "\"\<Enter the number of proton collisions:\>\"", 
         "]"}], ",", 
        RowBox[{"InputField", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "input1", "]"}], ",", "Expression"}], "]"}],
         ",", 
        RowBox[{
        "TextCell", "[", 
         "\"\<Enter the value of N_ev,min for which the sensitivity will be \
computed:\>\"", "]"}], ",", 
        RowBox[{"InputField", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "input2", "]"}], ",", "Expression"}], "]"}],
         ",", 
        RowBox[{"Row", "[", 
         RowBox[{
         "{", "\"\<Select the production channels to be used for the \
sensitivity calculation:\>\"", "}"}], "]"}], ",", 
        RowBox[{"Pane", "[", 
         RowBox[{
          RowBox[{"TogglerBar", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", "choice", "]"}], ",", "productionlist", 
            ",", 
            RowBox[{"Appearance", "->", 
             RowBox[{"\"\<Vertical\>\"", "->", 
              RowBox[{"{", 
               RowBox[{"Automatic", ",", "1"}], "}"}]}]}]}], "]"}], ",", 
          RowBox[{"ImageSize", "->", 
           RowBox[{"{", 
            RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], ",", 
          RowBox[{"Scrollbars", "->", 
           RowBox[{"{", 
            RowBox[{"False", ",", "True"}], "}"}]}]}], "]"}], ",", 
        RowBox[{"Button", "[", 
         RowBox[{"\"\<Submit\>\"", ",", 
          RowBox[{"DialogReturn", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"NpotVal", ",", "NevMinVal", ",", "SelectedProduction"}],
              "}"}], "=", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"input1", ",", "input2", ",", "choice"}], "}"}], "//", 
             "N"}]}], "]"}], ",", 
          RowBox[{"ImageSize", "->", "Automatic"}]}], "]"}]}], "}"}], "]"}], 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"MemberQ", "[", 
    RowBox[{"SelectedProduction", ",", "\"\<All\>\""}], "]"}], ",", 
   RowBox[{
    RowBox[{"SelectedProduction", "=", "ProductionChannelsListUnified"}], 
    ";"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(N\), \(PoT\)]\) for computation\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(N\), \(ev, min\)]\)\>\"", ",", 
      "\"\<Selected production modes\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"NpotVal", ",", "NevMinVal", ",", "SelectedProduction"}], 
     "}"}]}], "}"}], "//", "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sens", "=", 
   RowBox[{"SensitivityBlock", "[", 
    RowBox[{"NevMinVal", ",", "NpotVal", ",", "SelectedProduction"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"legends", "=", 
   RowBox[{"sens", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"-", "2"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sensregions", "=", 
   RowBox[{"sens", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ColorsForPlot", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", 
       RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", 
       RowBox[{"Darker", "@", 
        RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", 
       RowBox[{"Darker", "@", "Cyan"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", "Magenta"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", " ", "Black"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", 
       RowBox[{"Lighter", "@", "Brown"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", 
       RowBox[{"Lighter", "@", "Blue"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", 
       RowBox[{"Lighter", "@", "Red"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", 
       RowBox[{"Lighter", "@", "Green"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", "Blue", ",", 
       RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", 
       RowBox[{"Darker", "@", "Red"}], ",", 
       RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", 
       RowBox[{"Darker", "@", 
        RowBox[{"Darker", "@", "Green"}]}], ",", 
       RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", 
       RowBox[{"Darker", "@", "Cyan"}], ",", 
       RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", "Magenta", ",", 
       RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", "Black", ",", 
       RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", 
       RowBox[{"Lighter", "@", "Brown"}], ",", 
       RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", 
       RowBox[{"Lighter", "@", "Blue"}], ",", 
       RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", 
       RowBox[{"Lighter", "@", "Red"}], ",", 
       RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", 
       RowBox[{"Lighter", "@", "Green"}], ",", 
       RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotstylelist", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ConstantArray", "[", 
        RowBox[{
         RowBox[{"ColorsForPlot", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MatrixQ", "[", 
            RowBox[{"sensregions", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "1", ",", 
           RowBox[{"Length", "@", 
            RowBox[{"sensregions", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "sensregions", "]"}], ",", "1"}], "}"}]}], 
      "]"}], ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pt1", "=", 
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListLogLogPlot", "[", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"sensregions", ",", 
         RowBox[{"_", "?", "MatrixQ"}], ",", "All"}], "]"}], ",", 
       RowBox[{"Joined", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"True", ",", "True", ",", "True", ",", "True"}], "}"}]}], 
       ",", 
       RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<\!\(\*SubscriptBox[\(m\), \(V\)]\) [GeV]\>\"", " ", ",", " ", 
          "\"\<\!\(\*SuperscriptBox[\(\[Epsilon]\), \(2\)]\)\>\""}], "}"}]}], 
       ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", " ", "23"}], "]"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", "plotstylelist"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1.01", 
             RowBox[{"mminmaxOverall", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"1.1", 
             RowBox[{"mminmaxOverall", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"couplingminmaxOverall", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"Max", "[", 
             RowBox[{"0.99", 
              RowBox[{"couplingminmaxOverall", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}]}], "}"}]}], 
       ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"{", "\"\<Bremsstrahlung uncertainty\>\"", "}"}], "]"}], 
          ",", "18", ",", "Black"}], "]"}]}]}], "]"}], ",", 
     RowBox[{"LogLogPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "1", ",", "10"}], "}"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"DeleteDuplicates", "[", "plotstylelist", "]"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1.01", 
             RowBox[{"mminmaxOverall", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"1.1", 
             RowBox[{"mminmaxOverall", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"couplingminmaxOverall", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"Max", "[", 
             RowBox[{"0.2", ",", 
              RowBox[{"0.99", 
               RowBox[{"couplingminmaxOverall", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}], "}"}]}], "}"}]}],
        ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{
            "GivenExperimentForSensitivityComputation", ",", 
             "\"\<, \!\(\*SubscriptBox[\(N\), \(events\)]\) \[GreaterEqual] \
\>\"", ",", "NevMinVal"}], "}"}], "]"}], ",", "18", ",", "Black"}], "]"}]}], 
       ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"#", ",", "15"}], "]"}], "&"}], "/@", "legends"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.75", ",", "0.75"}], "}"}]}], "]"}]}]}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pt2", "=", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"ListLogLogPlot", "[", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"ExcludedRegions", "[", 
          RowBox[{"LLPdirName", ",", "\"\<FR-Central\>\""}], "]"}], ",", 
         RowBox[{"_", "?", "MatrixQ"}], ",", "All"}], "]"}], ",", 
       RowBox[{"Joined", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"True", ",", "True", ",", "True", ",", "True"}], "}"}]}], 
       ",", 
       RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<\!\(\*SubscriptBox[\(m\), \(V\)]\) [GeV]\>\"", " ", ",", " ", 
          "\"\<\!\(\*SuperscriptBox[\(\[Epsilon]\), \(2\)]\)\>\""}], "}"}]}], 
       ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", " ", "23"}], "]"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", "Gray"}], "}"}], "}"}]}], ",", 
       RowBox[{"Filling", "\[Rule]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"i", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"True", ",", 
             RowBox[{"Directive", "[", 
              RowBox[{"Gray", ",", 
               RowBox[{"Opacity", "[", "0.3", "]"}]}], "]"}]}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "10", ",", "1"}], "}"}]}], "]"}]}], 
       ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1.01", 
             RowBox[{"mminmaxOverall", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"1.1", 
             RowBox[{"mminmaxOverall", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"0.3", 
             RowBox[{"Min", "[", 
              RowBox[{"Flatten", "[", "sensregions", "]"}], "]"}]}], ",", 
            RowBox[{"0.99", 
             RowBox[{"couplingminmaxOverall", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{
            "GivenExperimentForSensitivityComputation", ",", 
             "\"\<, \!\(\*SubscriptBox[\(N\), \(events\)]\) \[GreaterEqual] \
\>\"", ",", "NevMinVal"}], "}"}], "]"}], ",", "18", ",", "Black"}], "]"}]}]}],
       "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ListLogLogPlot", "[", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"sensregions", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"_", "?", "MatrixQ"}], ",", "All"}], "]"}], ",", 
       RowBox[{"Joined", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"True", ",", "True", ",", "True", ",", "True"}], "}"}]}], 
       ",", 
       RowBox[{"PlotStyle", "\[Rule]", "plotstylelist"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1.01", 
             RowBox[{"mminmaxOverall", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"1.1", 
             RowBox[{"mminmaxOverall", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"couplingminmaxOverall", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"Max", "[", 
             RowBox[{"0.2", ",", 
              RowBox[{"0.99", 
               RowBox[{"couplingminmaxOverall", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}], "}"}]}], 
         "}"}]}]}], "]"}], ",", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Text", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Excluded\>\"", ",", "24", ",", "Black"}], "]"}], ",", 
         RowBox[{"Scaled", "[", 
          RowBox[{"{", 
           RowBox[{"0.2", ",", "0.5"}], "}"}], "]"}]}], "]"}], "}"}], "]"}], 
     ",", 
     RowBox[{"LogLogPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "1", ",", "10"}], "}"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"DeleteDuplicates", "[", "plotstylelist", "]"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1.01", 
             RowBox[{"mminmaxOverall", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"1.1", 
             RowBox[{"mminmaxOverall", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"couplingminmaxOverall", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"Max", "[", 
             RowBox[{"0.2", ",", 
              RowBox[{"0.99", 
               RowBox[{"couplingminmaxOverall", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}], "}"}]}], "}"}]}],
        ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{
            "GivenExperimentForSensitivityComputation", ",", 
             "\"\<, \!\(\*SubscriptBox[\(N\), \(events\)]\) \[GreaterEqual] \
\>\"", ",", "NevMinVal"}], "}"}], "]"}], ",", "18", ",", "Black"}], "]"}]}], 
       ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"#", ",", "15"}], "]"}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{"legends", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"0.2", ",", "0.15"}], "}"}]}], "]"}]}]}], "]"}]}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"Style", "[", 
  RowBox[{"Row", "[", 
   RowBox[{"{", 
    RowBox[{"pt2", ",", "pt1"}], "}"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8891549915062704`*^9, 3.889154993345764*^9}, {
   3.8891550726092916`*^9, 3.8891550770006027`*^9}, {3.889155121639572*^9, 
   3.8891551652523565`*^9}, {3.8891552062371397`*^9, 3.889155265897581*^9}, {
   3.889155479601365*^9, 3.8891554816320353`*^9}, {3.893571372676326*^9, 
   3.8935713726903877`*^9}, {3.893571601881855*^9, 3.893571615039663*^9}, {
   3.895053897017438*^9, 3.895053913667447*^9}, {3.8950539675027623`*^9, 
   3.895053982046572*^9}, {3.8950547143224044`*^9, 3.8950547266846137`*^9}, {
   3.8950767393111925`*^9, 3.8950767394248295`*^9}, 3.8950767893304987`*^9, {
   3.895124505321786*^9, 3.89512453121947*^9}, {3.8956553541843185`*^9, 
   3.8956554026141047`*^9}, {3.8961546653491325`*^9, 
   3.8961546658914757`*^9}, {3.896155101225853*^9, 3.89615510727777*^9}, {
   3.8963350116975923`*^9, 3.896335014109411*^9}, 3.9061946955346165`*^9, {
   3.9072588156578064`*^9, 3.9072588179012136`*^9}, 3.9121559814843984`*^9, {
   3.9138856465382867`*^9, 3.9138856465433846`*^9}, {3.913891860173438*^9, 
   3.9138918659831095`*^9}, {3.913963752775922*^9, 3.9139638379784517`*^9}, {
   3.913963934973338*^9, 3.9139639785347033`*^9}, {3.91396409837434*^9, 
   3.913964098390565*^9}, 3.913965549614134*^9, {3.913965669687707*^9, 
   3.913965669702223*^9}, {3.9146673955031853`*^9, 3.914667401790114*^9}, 
   3.914667704420864*^9, {3.9152623903935328`*^9, 3.915262416380659*^9}, 
   3.9152624585549393`*^9, {3.915262489482725*^9, 3.9152624919616766`*^9}, {
   3.915298261386327*^9, 3.915298267152412*^9}, {3.915643066483992*^9, 
   3.9156430665113087`*^9}, {3.917341578038809*^9, 3.9173415782277284`*^9}, {
   3.9342232470497665`*^9, 3.934223247777672*^9}, 3.934421094054416*^9, {
   3.9344250421277943`*^9, 3.934425056537165*^9}, {3.9344277859634514`*^9, 
   3.9344278167695284`*^9}, {3.9344285452056046`*^9, 3.934428633683076*^9}, {
   3.9344287308014545`*^9, 3.9344287340235643`*^9}, {3.9344289007439384`*^9, 
   3.934428913837747*^9}, {3.9344488990680714`*^9, 3.934448935852513*^9}, {
   3.9354239112232237`*^9, 3.9354239185605106`*^9}, 3.9354240483157787`*^9, {
   3.9354240957161293`*^9, 3.935424113261174*^9}, 3.93545564732802*^9, {
   3.935561205553789*^9, 3.9355612161759386`*^9}},
 CellTags->"Sensitivity-computation",
 CellLabel->
  "In[609]:=",ExpressionUUID->"140a9c48-3c60-400f-bb3d-41932b0b01fa"],

Cell[BoxData[" "], "Input",
 CellChangeTimes->{
  3.935423783179746*^9},ExpressionUUID->"3e753374-796f-4f38-bd6d-\
2c5f6b110986"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.935424128695882*^9, 3.9354242366123295`*^9}, {
   3.9354242669323497`*^9, 3.935424344896575*^9}, 
   3.935455643586623*^9},ExpressionUUID->"eae7e182-2481-442c-862e-\
bce7c8618c93"]
}, Closed]]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Deleting generated cells", "Title",
 CellChangeTimes->{{3.9025559465149946`*^9, 
  3.9025559494966087`*^9}},ExpressionUUID->"ffb96111-011a-40fa-9682-\
858963d62183"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FrontEndTokenExecute", "[", "\"\<DeleteGeneratedCells\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FrontEndTokenExecute", "[", "\"\<SelectAll\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "FrontEndTokenExecute", "[", "\"\<SelectionCloseAllGroups\>\"", "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9025559062888603`*^9, 3.9025559062888603`*^9}, {
   3.902555964086707*^9, 3.902555989355214*^9}, 3.9027635395877576`*^9, {
   3.902767344895295*^9, 3.9027673476276693`*^9}, {3.902889573287343*^9, 
   3.902889583599063*^9}, 3.9039719548816566`*^9, {3.918148939669592*^9, 
   3.918148941687619*^9}, 3.9200483052977896`*^9},
 CellLabel->
  "In[1356]:=",ExpressionUUID->"f52ba2e2-b5c4-48a5-92ca-6113d843928f"]
}, Closed]]
},
WindowSize->{1142.1, 642.9},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
ShowCellTags->True,
Magnification:>0.8 Inherited,
FrontEndVersion->"14.1 for Microsoft Windows (64-bit) (July 16, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"c227874f-ccbf-4b4b-be50-fce7ba0e72d3"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Acceptance"->{
  Cell[5570, 150, 317, 7, 68, "Title",ExpressionUUID->"294691d8-aa8b-4eec-b72c-7eddbed8edd7",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[5912, 161, 227, 5, 65, "Chapter",ExpressionUUID->"961be1c9-94c9-4c1d-89d7-f8d7b8cbf72d",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[6142, 168, 3805, 97, 201, "Input",ExpressionUUID->"7e8395d1-58ed-4ab9-b1bf-c7ebe3e9a552",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[9984, 270, 318, 6, 65, "Chapter",ExpressionUUID->"cf63fabc-7a3b-4498-8bf8-f69a301f20dc",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[10305, 278, 4554, 122, 246, "Input",ExpressionUUID->"2c1cafc9-37d9-434e-bd2d-c0787bc6f55b",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[14896, 405, 594, 10, 65, "Chapter",ExpressionUUID->"94b059cc-5312-4be8-9749-b24e1b58194e",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[15515, 419, 285, 6, 64, "Section",ExpressionUUID->"8f111b29-8491-4838-ab0f-75131d945ac9",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[15825, 429, 311, 6, 53, "Subsection",ExpressionUUID->"5ab83283-5bb4-4ea2-aaa0-a73f4f043e82",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[16139, 437, 7823, 187, 255, "Input",ExpressionUUID->"70174eea-746d-446e-811b-01df40fa5c0d",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[23999, 629, 224, 4, 53, "Subsection",ExpressionUUID->"3dd26efe-80ed-4e5e-8b82-2282c4bc12b1",
   CellTags->{"Number-of-events+sensitivity", "Acceptance"}],
  Cell[24226, 635, 4610, 118, 253, "Input",ExpressionUUID->"f44f4d01-09ef-406a-abf2-39cd6a42275c",
   CellTags->{"Number-of-events+sensitivity", "Acceptance"}],
  Cell[28873, 758, 229, 4, 42, "Subsection",ExpressionUUID->"57230fc2-265e-4259-b86d-d4d204e6a68b",
   CellTags->{"Number-of-events+sensitivity", "Acceptance"}],
  Cell[29105, 764, 11498, 248, 505, "Input",ExpressionUUID->"60f9c0f3-6256-4645-9775-12b7c3e2036c",
   CellTags->{"Number-of-events+sensitivity", "Acceptance"}],
  Cell[40640, 1017, 223, 5, 53, "Subsection",ExpressionUUID->"5246919d-853f-4089-9198-71384d19dd68",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[40866, 1024, 5154, 134, 302, "Input",ExpressionUUID->"7f9a11b3-6cdb-4f46-823c-c636cc8148be",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[46069, 1164, 297, 6, 64, "Section",ExpressionUUID->"1caa4f1c-1d68-4c34-a8aa-219c84a8ceb7",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[46369, 1172, 10869, 262, 520, "Input",ExpressionUUID->"3e580ec6-f8ab-4835-a08c-150bfb38f985",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[57275, 1439, 214, 5, 64, "Section",ExpressionUUID->"04c8f572-467e-4c76-8fac-f5585da995c8",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[57492, 1446, 5459, 136, 231, "Input",ExpressionUUID->"bfe2aed5-8f0a-4cad-a1aa-1740c3919a79",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[63000, 1588, 287, 6, 65, "Chapter",ExpressionUUID->"c2195567-c72b-45b8-82f4-a09212ef8e72",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[63290, 1596, 1483, 34, 94, "Input",ExpressionUUID->"25a5ddb0-4a9b-4ac7-bc67-62ae0c80c611",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[64822, 1636, 306, 6, 68, "Title",ExpressionUUID->"6bf41310-9786-4a2d-9c45-da72c297facc",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[65153, 1646, 285, 6, 65, "Chapter",ExpressionUUID->"09993897-08e0-4d65-9fda-c55a83b4e5d6",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[65441, 1654, 4647, 115, 277, "Input",ExpressionUUID->"14cf246a-dfe6-4f84-bced-6779a027f776",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[70125, 1774, 238, 5, 65, "Chapter",ExpressionUUID->"bf5cb1ca-586b-421c-9b8f-bcdda79a4c7d",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[70366, 1781, 2050, 50, 246, "Input",ExpressionUUID->"8ccbe0c0-5799-4a13-b89d-58d5d3aa1550",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}]},
 "Number-of-events+sensitivity"->{
  Cell[5570, 150, 317, 7, 68, "Title",ExpressionUUID->"294691d8-aa8b-4eec-b72c-7eddbed8edd7",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[5912, 161, 227, 5, 65, "Chapter",ExpressionUUID->"961be1c9-94c9-4c1d-89d7-f8d7b8cbf72d",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[6142, 168, 3805, 97, 201, "Input",ExpressionUUID->"7e8395d1-58ed-4ab9-b1bf-c7ebe3e9a552",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[9984, 270, 318, 6, 65, "Chapter",ExpressionUUID->"cf63fabc-7a3b-4498-8bf8-f69a301f20dc",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[10305, 278, 4554, 122, 246, "Input",ExpressionUUID->"2c1cafc9-37d9-434e-bd2d-c0787bc6f55b",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[14896, 405, 594, 10, 65, "Chapter",ExpressionUUID->"94b059cc-5312-4be8-9749-b24e1b58194e",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[15515, 419, 285, 6, 64, "Section",ExpressionUUID->"8f111b29-8491-4838-ab0f-75131d945ac9",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[15825, 429, 311, 6, 53, "Subsection",ExpressionUUID->"5ab83283-5bb4-4ea2-aaa0-a73f4f043e82",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[16139, 437, 7823, 187, 255, "Input",ExpressionUUID->"70174eea-746d-446e-811b-01df40fa5c0d",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[23999, 629, 224, 4, 53, "Subsection",ExpressionUUID->"3dd26efe-80ed-4e5e-8b82-2282c4bc12b1",
   CellTags->{"Number-of-events+sensitivity", "Acceptance"}],
  Cell[24226, 635, 4610, 118, 253, "Input",ExpressionUUID->"f44f4d01-09ef-406a-abf2-39cd6a42275c",
   CellTags->{"Number-of-events+sensitivity", "Acceptance"}],
  Cell[28873, 758, 229, 4, 42, "Subsection",ExpressionUUID->"57230fc2-265e-4259-b86d-d4d204e6a68b",
   CellTags->{"Number-of-events+sensitivity", "Acceptance"}],
  Cell[29105, 764, 11498, 248, 505, "Input",ExpressionUUID->"60f9c0f3-6256-4645-9775-12b7c3e2036c",
   CellTags->{"Number-of-events+sensitivity", "Acceptance"}],
  Cell[40640, 1017, 223, 5, 53, "Subsection",ExpressionUUID->"5246919d-853f-4089-9198-71384d19dd68",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[40866, 1024, 5154, 134, 302, "Input",ExpressionUUID->"7f9a11b3-6cdb-4f46-823c-c636cc8148be",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[46069, 1164, 297, 6, 64, "Section",ExpressionUUID->"1caa4f1c-1d68-4c34-a8aa-219c84a8ceb7",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[46369, 1172, 10869, 262, 520, "Input",ExpressionUUID->"3e580ec6-f8ab-4835-a08c-150bfb38f985",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[57275, 1439, 214, 5, 64, "Section",ExpressionUUID->"04c8f572-467e-4c76-8fac-f5585da995c8",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[57492, 1446, 5459, 136, 231, "Input",ExpressionUUID->"bfe2aed5-8f0a-4cad-a1aa-1740c3919a79",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[63000, 1588, 287, 6, 65, "Chapter",ExpressionUUID->"c2195567-c72b-45b8-82f4-a09212ef8e72",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[63290, 1596, 1483, 34, 94, "Input",ExpressionUUID->"25a5ddb0-4a9b-4ac7-bc67-62ae0c80c611",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[64822, 1636, 306, 6, 68, "Title",ExpressionUUID->"6bf41310-9786-4a2d-9c45-da72c297facc",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[65153, 1646, 285, 6, 65, "Chapter",ExpressionUUID->"09993897-08e0-4d65-9fda-c55a83b4e5d6",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[65441, 1654, 4647, 115, 277, "Input",ExpressionUUID->"14cf246a-dfe6-4f84-bced-6779a027f776",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[70125, 1774, 238, 5, 65, "Chapter",ExpressionUUID->"bf5cb1ca-586b-421c-9b8f-bcdda79a4c7d",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[70366, 1781, 2050, 50, 246, "Input",ExpressionUUID->"8ccbe0c0-5799-4a13-b89d-58d5d3aa1550",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}]},
 "Number-of-events-computation"->{
  Cell[72465, 1837, 254, 5, 68, "Title",ExpressionUUID->"ec7d1ed4-b833-4ca9-b86b-68ef0bdfdc5e",
   CellTags->{"Number-of-events-computation", "Number-of-events-computation+sensitivity"}],
  Cell[73922, 1879, 362, 6, 65, "Chapter",ExpressionUUID->"ddc91657-c605-432a-9fc4-3dde27689d78",
   CellTags->{"Number-of-events-computation", "Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[74287, 1887, 10946, 262, 400, "Input",ExpressionUUID->"c815bc21-895a-435e-aff8-c368c51a223c",
   CellTags->{"Number-of-events-computation", "Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[85270, 2154, 573, 10, 65, "Chapter",ExpressionUUID->"2ed58b5e-8fa1-4a99-b81c-130884bcdd21",
   CellTags->{"Number-of-events-computation", "Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[85868, 2168, 289, 5, 64, "Section",ExpressionUUID->"03bef3a9-53ec-43f7-9e2c-ababe19cbbef",
   CellTags->{"Number-of-events-computation", "Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[86182, 2177, 352, 6, 53, "Subsection",ExpressionUUID->"80d39a64-aab6-4580-84b1-37c2961be459",
   CellTags->{"Acceptance-computation", "Number-of-events-computation", "Number-of-events-computation+sensitivity"}],
  Cell[86537, 2185, 8293, 212, 460, "Input",ExpressionUUID->"84c2fefd-7917-44f9-be89-abd9cdc2b794",
   CellTags->{"Acceptance-computation", "Number-of-events-computation", "Number-of-events-computation+sensitivity"}],
  Cell[94867, 2402, 343, 6, 53, "Subsection",ExpressionUUID->"b5e9e7c7-fde1-419c-a976-dc94d5263400",
   CellTags->{"Acceptance-computation", "Number-of-events-computation", "Number-of-events-computation+sensitivity"}],
  Cell[95213, 2410, 12434, 298, 627, "Input",ExpressionUUID->"39a08be9-ca1a-4f6a-89d2-51bf771b0146",
   CellTags->{"Acceptance-computation", "Number-of-events-computation", "Number-of-events-computation+sensitivity"}],
  Cell[107684, 2713, 349, 6, 53, "Subsection",ExpressionUUID->"395687af-1da0-4489-b4f8-3c0e5ba2e9ce",
   CellTags->{"Acceptance-computation", "Number-of-events-computation", "Number-of-events-computation+sensitivity"}],
  Cell[108036, 2721, 5078, 108, 109, "Input",ExpressionUUID->"480fd17b-5a11-467d-8339-95713cf8a148",
   CellTags->{"Number-of-events-computation", "Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[113163, 2835, 273, 5, 64, "Section",ExpressionUUID->"b56c7d96-1fbc-45ca-9131-b352e77d4423",
   CellTags->{"Number-of-events-computation", "Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[113439, 2842, 8705, 224, 250, "Input",ExpressionUUID->"62acfb65-1702-4136-a9c7-b00e002329b7",
   CellTags->{"Number-of-events-computation", "Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[122193, 3072, 256, 5, 65, "Chapter",ExpressionUUID->"0f308b41-d607-4d23-bea6-f98cdbbab013",
   CellTags->{"Number-of-events-computation", "Number-of-events-computation+sensitivity"}]},
 "Number-of-events-computation+sensitivity"->{
  Cell[72465, 1837, 254, 5, 68, "Title",ExpressionUUID->"ec7d1ed4-b833-4ca9-b86b-68ef0bdfdc5e",
   CellTags->{"Number-of-events-computation", "Number-of-events-computation+sensitivity"}],
  Cell[72744, 1846, 308, 6, 65, "Chapter",ExpressionUUID->"90e03790-1066-4abb-8908-35a37e0278c1",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[73055, 1854, 830, 20, 49, "Input",ExpressionUUID->"18b4049e-6a0e-4546-98b8-9c919573bc3b",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[73922, 1879, 362, 6, 65, "Chapter",ExpressionUUID->"ddc91657-c605-432a-9fc4-3dde27689d78",
   CellTags->{"Number-of-events-computation", "Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[74287, 1887, 10946, 262, 400, "Input",ExpressionUUID->"c815bc21-895a-435e-aff8-c368c51a223c",
   CellTags->{"Number-of-events-computation", "Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[85270, 2154, 573, 10, 65, "Chapter",ExpressionUUID->"2ed58b5e-8fa1-4a99-b81c-130884bcdd21",
   CellTags->{"Number-of-events-computation", "Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[85868, 2168, 289, 5, 64, "Section",ExpressionUUID->"03bef3a9-53ec-43f7-9e2c-ababe19cbbef",
   CellTags->{"Number-of-events-computation", "Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[86182, 2177, 352, 6, 53, "Subsection",ExpressionUUID->"80d39a64-aab6-4580-84b1-37c2961be459",
   CellTags->{"Acceptance-computation", "Number-of-events-computation", "Number-of-events-computation+sensitivity"}],
  Cell[86537, 2185, 8293, 212, 460, "Input",ExpressionUUID->"84c2fefd-7917-44f9-be89-abd9cdc2b794",
   CellTags->{"Acceptance-computation", "Number-of-events-computation", "Number-of-events-computation+sensitivity"}],
  Cell[94867, 2402, 343, 6, 53, "Subsection",ExpressionUUID->"b5e9e7c7-fde1-419c-a976-dc94d5263400",
   CellTags->{"Acceptance-computation", "Number-of-events-computation", "Number-of-events-computation+sensitivity"}],
  Cell[95213, 2410, 12434, 298, 627, "Input",ExpressionUUID->"39a08be9-ca1a-4f6a-89d2-51bf771b0146",
   CellTags->{"Acceptance-computation", "Number-of-events-computation", "Number-of-events-computation+sensitivity"}],
  Cell[107684, 2713, 349, 6, 53, "Subsection",ExpressionUUID->"395687af-1da0-4489-b4f8-3c0e5ba2e9ce",
   CellTags->{"Acceptance-computation", "Number-of-events-computation", "Number-of-events-computation+sensitivity"}],
  Cell[108036, 2721, 5078, 108, 109, "Input",ExpressionUUID->"480fd17b-5a11-467d-8339-95713cf8a148",
   CellTags->{"Number-of-events-computation", "Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[113163, 2835, 273, 5, 64, "Section",ExpressionUUID->"b56c7d96-1fbc-45ca-9131-b352e77d4423",
   CellTags->{"Number-of-events-computation", "Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[113439, 2842, 8705, 224, 250, "Input",ExpressionUUID->"62acfb65-1702-4136-a9c7-b00e002329b7",
   CellTags->{"Number-of-events-computation", "Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[122193, 3072, 256, 5, 65, "Chapter",ExpressionUUID->"0f308b41-d607-4d23-bea6-f98cdbbab013",
   CellTags->{"Number-of-events-computation", "Number-of-events-computation+sensitivity"}],
  Cell[122474, 3081, 330, 6, 64, "Section",ExpressionUUID->"1ee4b6fc-436c-44ba-9c25-aac28ca9c035",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[122829, 3091, 388, 7, 53, "Subsection",ExpressionUUID->"0a1f8dc1-244c-4013-a4f6-a6748a821672",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[123220, 3100, 14409, 342, 674, "Input",ExpressionUUID->"6acd5b9d-3d21-4c1b-bfa2-65d6c8a2ce8a",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[137666, 3447, 262, 5, 53, "Subsection",ExpressionUUID->"e409be1f-14c9-48b7-a089-70f654ff54f3",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[137953, 3456, 253, 5, 46, "Subsubsection",ExpressionUUID->"d796baed-9379-49b2-9181-870a19db5beb",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[138209, 3463, 2797, 72, 170, "Input",ExpressionUUID->"6f523e27-7474-4bc3-85a9-e590c4367387",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[141043, 3540, 275, 5, 46, "Subsubsection",ExpressionUUID->"e0313994-0412-44d9-9abd-42a7f9d81f79",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[141321, 3547, 15542, 390, 507, "Input",ExpressionUUID->"0da87de1-0190-4840-a5aa-6c481e91b34e",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[156912, 3943, 284, 5, 53, "Subsection",ExpressionUUID->"6ff9d28c-eed8-4817-92f4-3f387708a5b0",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[157199, 3950, 5864, 133, 305, "Input",ExpressionUUID->"cf1b132c-0605-4069-a715-693b632def22",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[163100, 4088, 309, 6, 53, "Subsection",ExpressionUUID->"9568fedf-30f9-450d-900b-5ab61536bd06",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[163412, 4096, 5726, 125, 185, "Input",ExpressionUUID->"f14e7503-0c2b-42e6-82b3-09c8d2837343",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[169175, 4226, 335, 8, 53, "Subsection",ExpressionUUID->"c29e3e81-7da0-4ea9-b871-a5deff1aa7dc",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[169513, 4236, 7808, 195, 298, "Input",ExpressionUUID->"372d3cc6-07f2-41da-ad5e-4f1e21f8559a",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[177370, 4437, 311, 6, 64, "Section",ExpressionUUID->"7d9414c6-173d-4020-8288-2252992857f1",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[189697, 4732, 232, 4, 41, "Subsection",ExpressionUUID->"f2457af1-76a9-47ab-b482-5799da6309cc",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[189932, 4738, 21615, 509, 840, "Input",ExpressionUUID->"fe3b5af1-2caa-4f01-a4d7-4be7307a3eac",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[211620, 5255, 262, 5, 68, "Title",ExpressionUUID->"a1ac207f-e5a6-41ed-9016-23014b2a6c3e",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[211907, 5264, 213, 4, 65, "Chapter",ExpressionUUID->"61d66c6b-87da-4009-946a-eb32cc005fd8",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[212123, 5270, 8643, 178, 331, "Input",ExpressionUUID->"5ff1e429-21ed-463f-b582-04b4f7f4c30e",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[220803, 5453, 209, 4, 65, "Chapter",ExpressionUUID->"87d344ed-2d96-4345-98c4-a81cc45c1c16",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[221015, 5459, 3610, 82, 185, "Input",ExpressionUUID->"1f4946c3-23ce-4e70-bc72-93b0971707fc",
   CellTags->"Number-of-events-computation+sensitivity"]},
 "Acceptance-computation"->{
  Cell[72744, 1846, 308, 6, 65, "Chapter",ExpressionUUID->"90e03790-1066-4abb-8908-35a37e0278c1",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[73055, 1854, 830, 20, 49, "Input",ExpressionUUID->"18b4049e-6a0e-4546-98b8-9c919573bc3b",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[73922, 1879, 362, 6, 65, "Chapter",ExpressionUUID->"ddc91657-c605-432a-9fc4-3dde27689d78",
   CellTags->{"Number-of-events-computation", "Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[74287, 1887, 10946, 262, 400, "Input",ExpressionUUID->"c815bc21-895a-435e-aff8-c368c51a223c",
   CellTags->{"Number-of-events-computation", "Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[85270, 2154, 573, 10, 65, "Chapter",ExpressionUUID->"2ed58b5e-8fa1-4a99-b81c-130884bcdd21",
   CellTags->{"Number-of-events-computation", "Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[85868, 2168, 289, 5, 64, "Section",ExpressionUUID->"03bef3a9-53ec-43f7-9e2c-ababe19cbbef",
   CellTags->{"Number-of-events-computation", "Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[86182, 2177, 352, 6, 53, "Subsection",ExpressionUUID->"80d39a64-aab6-4580-84b1-37c2961be459",
   CellTags->{"Acceptance-computation", "Number-of-events-computation", "Number-of-events-computation+sensitivity"}],
  Cell[86537, 2185, 8293, 212, 460, "Input",ExpressionUUID->"84c2fefd-7917-44f9-be89-abd9cdc2b794",
   CellTags->{"Acceptance-computation", "Number-of-events-computation", "Number-of-events-computation+sensitivity"}],
  Cell[94867, 2402, 343, 6, 53, "Subsection",ExpressionUUID->"b5e9e7c7-fde1-419c-a976-dc94d5263400",
   CellTags->{"Acceptance-computation", "Number-of-events-computation", "Number-of-events-computation+sensitivity"}],
  Cell[95213, 2410, 12434, 298, 627, "Input",ExpressionUUID->"39a08be9-ca1a-4f6a-89d2-51bf771b0146",
   CellTags->{"Acceptance-computation", "Number-of-events-computation", "Number-of-events-computation+sensitivity"}],
  Cell[107684, 2713, 349, 6, 53, "Subsection",ExpressionUUID->"395687af-1da0-4489-b4f8-3c0e5ba2e9ce",
   CellTags->{"Acceptance-computation", "Number-of-events-computation", "Number-of-events-computation+sensitivity"}],
  Cell[108036, 2721, 5078, 108, 109, "Input",ExpressionUUID->"480fd17b-5a11-467d-8339-95713cf8a148",
   CellTags->{"Number-of-events-computation", "Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[113163, 2835, 273, 5, 64, "Section",ExpressionUUID->"b56c7d96-1fbc-45ca-9131-b352e77d4423",
   CellTags->{"Number-of-events-computation", "Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[113439, 2842, 8705, 224, 250, "Input",ExpressionUUID->"62acfb65-1702-4136-a9c7-b00e002329b7",
   CellTags->{"Number-of-events-computation", "Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[122474, 3081, 330, 6, 64, "Section",ExpressionUUID->"1ee4b6fc-436c-44ba-9c25-aac28ca9c035",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[122829, 3091, 388, 7, 53, "Subsection",ExpressionUUID->"0a1f8dc1-244c-4013-a4f6-a6748a821672",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[123220, 3100, 14409, 342, 674, "Input",ExpressionUUID->"6acd5b9d-3d21-4c1b-bfa2-65d6c8a2ce8a",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[137666, 3447, 262, 5, 53, "Subsection",ExpressionUUID->"e409be1f-14c9-48b7-a089-70f654ff54f3",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[137953, 3456, 253, 5, 46, "Subsubsection",ExpressionUUID->"d796baed-9379-49b2-9181-870a19db5beb",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[138209, 3463, 2797, 72, 170, "Input",ExpressionUUID->"6f523e27-7474-4bc3-85a9-e590c4367387",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[141043, 3540, 275, 5, 46, "Subsubsection",ExpressionUUID->"e0313994-0412-44d9-9abd-42a7f9d81f79",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[141321, 3547, 15542, 390, 507, "Input",ExpressionUUID->"0da87de1-0190-4840-a5aa-6c481e91b34e",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[156912, 3943, 284, 5, 53, "Subsection",ExpressionUUID->"6ff9d28c-eed8-4817-92f4-3f387708a5b0",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[157199, 3950, 5864, 133, 305, "Input",ExpressionUUID->"cf1b132c-0605-4069-a715-693b632def22",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[163100, 4088, 309, 6, 53, "Subsection",ExpressionUUID->"9568fedf-30f9-450d-900b-5ab61536bd06",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[163412, 4096, 5726, 125, 185, "Input",ExpressionUUID->"f14e7503-0c2b-42e6-82b3-09c8d2837343",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[169175, 4226, 335, 8, 53, "Subsection",ExpressionUUID->"c29e3e81-7da0-4ea9-b871-a5deff1aa7dc",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[169513, 4236, 7808, 195, 298, "Input",ExpressionUUID->"372d3cc6-07f2-41da-ad5e-4f1e21f8559a",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}]},
 "Sensitivity"->{
  Cell[224674, 5547, 189, 3, 68, "Title",ExpressionUUID->"20138663-2b9a-41fa-8718-2e1c02355f2d",
   CellTags->"Sensitivity"],
  Cell[224888, 5554, 188, 3, 65, "Chapter",ExpressionUUID->"e53fa63b-a742-40cf-a205-b2502f696dbd",
   CellTags->"Sensitivity"],
  Cell[225079, 5559, 7128, 187, 429, "Input",ExpressionUUID->"99f6e797-c44c-4cdb-b806-3efcbdcad495",
   CellTags->"Sensitivity"]},
 "Sensitivity-computation"->{
  Cell[232244, 5751, 316, 7, 65, "Chapter",ExpressionUUID->"8558a057-a38a-454c-bfce-bde3419e907e",
   CellTags->"Sensitivity-computation"],
  Cell[232585, 5762, 209, 4, 64, "Section",ExpressionUUID->"d2e4b5e5-7ca9-46d1-8935-925aa00d1a4f",
   CellTags->"Sensitivity-computation"],
  Cell[232797, 5768, 5390, 115, 262, "Input",ExpressionUUID->"c04809c2-412f-4207-902a-ca107db71530",
   CellTags->"Sensitivity-computation"],
  Cell[238224, 5888, 220, 4, 64, "Section",ExpressionUUID->"8dbf4156-fa28-4b8c-98ea-b1e3be065ffb",
   CellTags->"Sensitivity-computation"],
  Cell[238447, 5894, 12213, 298, 564, "Input",ExpressionUUID->"712e0550-86f1-4004-ba68-1c8c28691518",
   CellTags->"Sensitivity-computation"],
  Cell[250685, 6196, 238, 4, 54, "Subsection",ExpressionUUID->"95e1b614-5556-4859-87ea-fe7cd3143b65",
   CellTags->"Sensitivity-computation"],
  Cell[250926, 6202, 7952, 201, 377, "Input",ExpressionUUID->"eb97b023-365e-4974-b333-ec02097bbc3e",
   CellTags->"Sensitivity-computation"],
  Cell[258939, 6410, 300, 6, 57, "Chapter",ExpressionUUID->"ca66427b-19d6-4877-8ebb-41db99aeba92",
   CellTags->"Sensitivity-computation"],
  Cell[259264, 6420, 255, 5, 64, "Section",ExpressionUUID->"a59ae6cb-9828-417c-bdd1-fff95cb38e4f",
   CellTags->"Sensitivity-computation"],
  Cell[259522, 6427, 4693, 112, 131, "Input",ExpressionUUID->"dfa47edf-f1da-4b2e-b4e4-0bdbee1c1674",
   CellTags->"Sensitivity-computation"],
  Cell[264252, 6544, 208, 4, 64, "Section",ExpressionUUID->"15df64ef-f8bc-45f8-9d3a-b2b9fc3a4c63",
   CellTags->"Sensitivity-computation"],
  Cell[264463, 6550, 1697, 41, 94, "Input",ExpressionUUID->"d222b99d-aa87-4a70-9775-f512810f7932",
   CellTags->"Sensitivity-computation"],
  Cell[266197, 6596, 207, 4, 64, "Section",ExpressionUUID->"b9b04a85-a4aa-45a1-9921-706d27f2c6b8",
   CellTags->"Sensitivity-computation"],
  Cell[266429, 6604, 269, 5, 53, "Subsection",ExpressionUUID->"4b0acb2b-464a-4780-87c2-adee5815e682",
   CellTags->"Sensitivity-computation"],
  Cell[266701, 6611, 8771, 203, 467, "Input",ExpressionUUID->"77491e31-6ccd-4b4c-9162-3fc7efc33e3f",
   CellTags->"Sensitivity-computation"],
  Cell[275509, 6819, 211, 4, 53, "Subsection",ExpressionUUID->"4af71be4-b031-4d3f-aac5-c3bd871b62a5",
   CellTags->"Sensitivity-computation"],
  Cell[275723, 6825, 20222, 506, 569, "Input",ExpressionUUID->"140a9c48-3c60-400f-bb3d-41932b0b01fa",
   CellTags->"Sensitivity-computation"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Acceptance", 297807, 7389},
 {"Number-of-events+sensitivity", 302015, 7442},
 {"Number-of-events-computation", 306223, 7495},
 {"Number-of-events-computation+sensitivity", 309268, 7524},
 {"Acceptance-computation", 316555, 7601},
 {"Sensitivity", 322189, 7658},
 {"Sensitivity-computation", 322604, 7665}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 207, 3, 77, "Title",ExpressionUUID->"cc091cd5-168d-44d1-9a83-ebb576c10ceb"],
Cell[790, 27, 4743, 118, 358, "Input",ExpressionUUID->"c8a7c6bd-754e-4c81-b344-1b6f8cd06de4"]
}, Closed]],
Cell[CellGroupData[{
Cell[5570, 150, 317, 7, 68, "Title",ExpressionUUID->"294691d8-aa8b-4eec-b72c-7eddbed8edd7",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[CellGroupData[{
Cell[5912, 161, 227, 5, 65, "Chapter",ExpressionUUID->"961be1c9-94c9-4c1d-89d7-f8d7b8cbf72d",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[6142, 168, 3805, 97, 201, "Input",ExpressionUUID->"7e8395d1-58ed-4ab9-b1bf-c7ebe3e9a552",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[9984, 270, 318, 6, 65, "Chapter",ExpressionUUID->"cf63fabc-7a3b-4498-8bf8-f69a301f20dc",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[10305, 278, 4554, 122, 246, "Input",ExpressionUUID->"2c1cafc9-37d9-434e-bd2d-c0787bc6f55b",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[14896, 405, 594, 10, 65, "Chapter",ExpressionUUID->"94b059cc-5312-4be8-9749-b24e1b58194e",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[CellGroupData[{
Cell[15515, 419, 285, 6, 64, "Section",ExpressionUUID->"8f111b29-8491-4838-ab0f-75131d945ac9",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[CellGroupData[{
Cell[15825, 429, 311, 6, 53, "Subsection",ExpressionUUID->"5ab83283-5bb4-4ea2-aaa0-a73f4f043e82",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[16139, 437, 7823, 187, 255, "Input",ExpressionUUID->"70174eea-746d-446e-811b-01df40fa5c0d",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[23999, 629, 224, 4, 53, "Subsection",ExpressionUUID->"3dd26efe-80ed-4e5e-8b82-2282c4bc12b1",
 CellTags->{"Number-of-events+sensitivity", "Acceptance"}],
Cell[24226, 635, 4610, 118, 253, "Input",ExpressionUUID->"f44f4d01-09ef-406a-abf2-39cd6a42275c",
 CellTags->{"Number-of-events+sensitivity", "Acceptance"}]
}, Closed]],
Cell[CellGroupData[{
Cell[28873, 758, 229, 4, 42, "Subsection",ExpressionUUID->"57230fc2-265e-4259-b86d-d4d204e6a68b",
 CellTags->{"Number-of-events+sensitivity", "Acceptance"}],
Cell[29105, 764, 11498, 248, 505, "Input",ExpressionUUID->"60f9c0f3-6256-4645-9775-12b7c3e2036c",
 CellTags->{"Number-of-events+sensitivity", "Acceptance"}]
}, Closed]],
Cell[CellGroupData[{
Cell[40640, 1017, 223, 5, 53, "Subsection",ExpressionUUID->"5246919d-853f-4089-9198-71384d19dd68",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[40866, 1024, 5154, 134, 302, "Input",ExpressionUUID->"7f9a11b3-6cdb-4f46-823c-c636cc8148be",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[46069, 1164, 297, 6, 64, "Section",ExpressionUUID->"1caa4f1c-1d68-4c34-a8aa-219c84a8ceb7",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[46369, 1172, 10869, 262, 520, "Input",ExpressionUUID->"3e580ec6-f8ab-4835-a08c-150bfb38f985",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[57275, 1439, 214, 5, 64, "Section",ExpressionUUID->"04c8f572-467e-4c76-8fac-f5585da995c8",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[57492, 1446, 5459, 136, 231, "Input",ExpressionUUID->"bfe2aed5-8f0a-4cad-a1aa-1740c3919a79",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[63000, 1588, 287, 6, 65, "Chapter",ExpressionUUID->"c2195567-c72b-45b8-82f4-a09212ef8e72",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[63290, 1596, 1483, 34, 94, "Input",ExpressionUUID->"25a5ddb0-4a9b-4ac7-bc67-62ae0c80c611",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[64822, 1636, 306, 6, 68, "Title",ExpressionUUID->"6bf41310-9786-4a2d-9c45-da72c297facc",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[CellGroupData[{
Cell[65153, 1646, 285, 6, 65, "Chapter",ExpressionUUID->"09993897-08e0-4d65-9fda-c55a83b4e5d6",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[65441, 1654, 4647, 115, 277, "Input",ExpressionUUID->"14cf246a-dfe6-4f84-bced-6779a027f776",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[70125, 1774, 238, 5, 65, "Chapter",ExpressionUUID->"bf5cb1ca-586b-421c-9b8f-bcdda79a4c7d",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[70366, 1781, 2050, 50, 246, "Input",ExpressionUUID->"8ccbe0c0-5799-4a13-b89d-58d5d3aa1550",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[72465, 1837, 254, 5, 68, "Title",ExpressionUUID->"ec7d1ed4-b833-4ca9-b86b-68ef0bdfdc5e",
 CellTags->{"Number-of-events-computation", "Number-of-events-computation+sensitivity"}],
Cell[CellGroupData[{
Cell[72744, 1846, 308, 6, 65, "Chapter",ExpressionUUID->"90e03790-1066-4abb-8908-35a37e0278c1",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[73055, 1854, 830, 20, 49, "Input",ExpressionUUID->"18b4049e-6a0e-4546-98b8-9c919573bc3b",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[73922, 1879, 362, 6, 65, "Chapter",ExpressionUUID->"ddc91657-c605-432a-9fc4-3dde27689d78",
 CellTags->{"Number-of-events-computation", "Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[74287, 1887, 10946, 262, 400, "Input",ExpressionUUID->"c815bc21-895a-435e-aff8-c368c51a223c",
 CellTags->{"Number-of-events-computation", "Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[85270, 2154, 573, 10, 65, "Chapter",ExpressionUUID->"2ed58b5e-8fa1-4a99-b81c-130884bcdd21",
 CellTags->{"Number-of-events-computation", "Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[CellGroupData[{
Cell[85868, 2168, 289, 5, 64, "Section",ExpressionUUID->"03bef3a9-53ec-43f7-9e2c-ababe19cbbef",
 CellTags->{"Number-of-events-computation", "Number-of-events-computation+sensitivity", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[86182, 2177, 352, 6, 53, "Subsection",ExpressionUUID->"80d39a64-aab6-4580-84b1-37c2961be459",
 CellTags->{"Acceptance-computation", "Number-of-events-computation", "Number-of-events-computation+sensitivity"}],
Cell[86537, 2185, 8293, 212, 460, "Input",ExpressionUUID->"84c2fefd-7917-44f9-be89-abd9cdc2b794",
 CellTags->{"Acceptance-computation", "Number-of-events-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[94867, 2402, 343, 6, 53, "Subsection",ExpressionUUID->"b5e9e7c7-fde1-419c-a976-dc94d5263400",
 CellTags->{"Acceptance-computation", "Number-of-events-computation", "Number-of-events-computation+sensitivity"}],
Cell[95213, 2410, 12434, 298, 627, "Input",ExpressionUUID->"39a08be9-ca1a-4f6a-89d2-51bf771b0146",
 CellTags->{"Acceptance-computation", "Number-of-events-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[107684, 2713, 349, 6, 53, "Subsection",ExpressionUUID->"395687af-1da0-4489-b4f8-3c0e5ba2e9ce",
 CellTags->{"Acceptance-computation", "Number-of-events-computation", "Number-of-events-computation+sensitivity"}],
Cell[108036, 2721, 5078, 108, 109, "Input",ExpressionUUID->"480fd17b-5a11-467d-8339-95713cf8a148",
 CellTags->{"Number-of-events-computation", "Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[113163, 2835, 273, 5, 64, "Section",ExpressionUUID->"b56c7d96-1fbc-45ca-9131-b352e77d4423",
 CellTags->{"Number-of-events-computation", "Number-of-events-computation+sensitivity", "Acceptance-computation"}],
Cell[113439, 2842, 8705, 224, 250, "Input",ExpressionUUID->"62acfb65-1702-4136-a9c7-b00e002329b7",
 CellTags->{"Number-of-events-computation", "Number-of-events-computation+sensitivity", "Acceptance-computation"}]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[122193, 3072, 256, 5, 65, "Chapter",ExpressionUUID->"0f308b41-d607-4d23-bea6-f98cdbbab013",
 CellTags->{"Number-of-events-computation", "Number-of-events-computation+sensitivity"}],
Cell[CellGroupData[{
Cell[122474, 3081, 330, 6, 64, "Section",ExpressionUUID->"1ee4b6fc-436c-44ba-9c25-aac28ca9c035",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[CellGroupData[{
Cell[122829, 3091, 388, 7, 53, "Subsection",ExpressionUUID->"0a1f8dc1-244c-4013-a4f6-a6748a821672",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[123220, 3100, 14409, 342, 674, "Input",ExpressionUUID->"6acd5b9d-3d21-4c1b-bfa2-65d6c8a2ce8a",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[137666, 3447, 262, 5, 53, "Subsection",ExpressionUUID->"e409be1f-14c9-48b7-a089-70f654ff54f3",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[CellGroupData[{
Cell[137953, 3456, 253, 5, 46, "Subsubsection",ExpressionUUID->"d796baed-9379-49b2-9181-870a19db5beb",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
Cell[138209, 3463, 2797, 72, 170, "Input",ExpressionUUID->"6f523e27-7474-4bc3-85a9-e590c4367387",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}]
}, Closed]],
Cell[CellGroupData[{
Cell[141043, 3540, 275, 5, 46, "Subsubsection",ExpressionUUID->"e0313994-0412-44d9-9abd-42a7f9d81f79",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
Cell[141321, 3547, 15542, 390, 507, "Input",ExpressionUUID->"0da87de1-0190-4840-a5aa-6c481e91b34e",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[156912, 3943, 284, 5, 53, "Subsection",ExpressionUUID->"6ff9d28c-eed8-4817-92f4-3f387708a5b0",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[157199, 3950, 5864, 133, 305, "Input",ExpressionUUID->"cf1b132c-0605-4069-a715-693b632def22",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[163100, 4088, 309, 6, 53, "Subsection",ExpressionUUID->"9568fedf-30f9-450d-900b-5ab61536bd06",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
Cell[163412, 4096, 5726, 125, 185, "Input",ExpressionUUID->"f14e7503-0c2b-42e6-82b3-09c8d2837343",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}]
}, Closed]],
Cell[CellGroupData[{
Cell[169175, 4226, 335, 8, 53, "Subsection",ExpressionUUID->"c29e3e81-7da0-4ea9-b871-a5deff1aa7dc",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
Cell[169513, 4236, 7808, 195, 298, "Input",ExpressionUUID->"372d3cc6-07f2-41da-ad5e-4f1e21f8559a",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[177370, 4437, 311, 6, 64, "Section",ExpressionUUID->"7d9414c6-173d-4020-8288-2252992857f1",
 CellTags->"Number-of-events-computation+sensitivity"],
Cell[CellGroupData[{
Cell[177706, 4447, 177, 3, 42, "Subsection",ExpressionUUID->"f77396b5-0a62-4a15-9dac-812fd05c1be5"],
Cell[177886, 4452, 11774, 275, 287, "Input",ExpressionUUID->"6962c164-b0d4-438c-bc89-a951513665ff"]
}, Closed]],
Cell[CellGroupData[{
Cell[189697, 4732, 232, 4, 41, "Subsection",ExpressionUUID->"f2457af1-76a9-47ab-b482-5799da6309cc",
 CellTags->"Number-of-events-computation+sensitivity"],
Cell[189932, 4738, 21615, 509, 840, "Input",ExpressionUUID->"fe3b5af1-2caa-4f01-a4d7-4be7307a3eac",
 CellTags->"Number-of-events-computation+sensitivity"]
}, Closed]]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[211620, 5255, 262, 5, 68, "Title",ExpressionUUID->"a1ac207f-e5a6-41ed-9016-23014b2a6c3e",
 CellTags->"Number-of-events-computation+sensitivity"],
Cell[CellGroupData[{
Cell[211907, 5264, 213, 4, 65, "Chapter",ExpressionUUID->"61d66c6b-87da-4009-946a-eb32cc005fd8",
 CellTags->"Number-of-events-computation+sensitivity"],
Cell[212123, 5270, 8643, 178, 331, "Input",ExpressionUUID->"5ff1e429-21ed-463f-b582-04b4f7f4c30e",
 CellTags->"Number-of-events-computation+sensitivity"]
}, Closed]],
Cell[CellGroupData[{
Cell[220803, 5453, 209, 4, 65, "Chapter",ExpressionUUID->"87d344ed-2d96-4345-98c4-a81cc45c1c16",
 CellTags->"Number-of-events-computation+sensitivity"],
Cell[221015, 5459, 3610, 82, 185, "Input",ExpressionUUID->"1f4946c3-23ce-4e70-bc72-93b0971707fc",
 CellTags->"Number-of-events-computation+sensitivity"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[224674, 5547, 189, 3, 68, "Title",ExpressionUUID->"20138663-2b9a-41fa-8718-2e1c02355f2d",
 CellTags->"Sensitivity"],
Cell[CellGroupData[{
Cell[224888, 5554, 188, 3, 65, "Chapter",ExpressionUUID->"e53fa63b-a742-40cf-a205-b2502f696dbd",
 CellTags->"Sensitivity"],
Cell[225079, 5559, 7128, 187, 429, "Input",ExpressionUUID->"99f6e797-c44c-4cdb-b806-3efcbdcad495",
 CellTags->"Sensitivity"]
}, Closed]],
Cell[CellGroupData[{
Cell[232244, 5751, 316, 7, 65, "Chapter",ExpressionUUID->"8558a057-a38a-454c-bfce-bde3419e907e",
 CellTags->"Sensitivity-computation"],
Cell[CellGroupData[{
Cell[232585, 5762, 209, 4, 64, "Section",ExpressionUUID->"d2e4b5e5-7ca9-46d1-8935-925aa00d1a4f",
 CellTags->"Sensitivity-computation"],
Cell[232797, 5768, 5390, 115, 262, "Input",ExpressionUUID->"c04809c2-412f-4207-902a-ca107db71530",
 CellTags->"Sensitivity-computation"]
}, Closed]],
Cell[CellGroupData[{
Cell[238224, 5888, 220, 4, 64, "Section",ExpressionUUID->"8dbf4156-fa28-4b8c-98ea-b1e3be065ffb",
 CellTags->"Sensitivity-computation"],
Cell[238447, 5894, 12213, 298, 564, "Input",ExpressionUUID->"712e0550-86f1-4004-ba68-1c8c28691518",
 CellTags->"Sensitivity-computation"],
Cell[CellGroupData[{
Cell[250685, 6196, 238, 4, 54, "Subsection",ExpressionUUID->"95e1b614-5556-4859-87ea-fe7cd3143b65",
 CellTags->"Sensitivity-computation"],
Cell[250926, 6202, 7952, 201, 377, "Input",ExpressionUUID->"eb97b023-365e-4974-b333-ec02097bbc3e",
 CellTags->"Sensitivity-computation"]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[258939, 6410, 300, 6, 57, "Chapter",ExpressionUUID->"ca66427b-19d6-4877-8ebb-41db99aeba92",
 CellTags->"Sensitivity-computation"],
Cell[CellGroupData[{
Cell[259264, 6420, 255, 5, 64, "Section",ExpressionUUID->"a59ae6cb-9828-417c-bdd1-fff95cb38e4f",
 CellTags->"Sensitivity-computation"],
Cell[259522, 6427, 4693, 112, 131, "Input",ExpressionUUID->"dfa47edf-f1da-4b2e-b4e4-0bdbee1c1674",
 CellTags->"Sensitivity-computation"]
}, Closed]],
Cell[CellGroupData[{
Cell[264252, 6544, 208, 4, 64, "Section",ExpressionUUID->"15df64ef-f8bc-45f8-9d3a-b2b9fc3a4c63",
 CellTags->"Sensitivity-computation"],
Cell[264463, 6550, 1697, 41, 94, "Input",ExpressionUUID->"d222b99d-aa87-4a70-9775-f512810f7932",
 CellTags->"Sensitivity-computation"]
}, Closed]],
Cell[CellGroupData[{
Cell[266197, 6596, 207, 4, 64, "Section",ExpressionUUID->"b9b04a85-a4aa-45a1-9921-706d27f2c6b8",
 CellTags->"Sensitivity-computation"],
Cell[CellGroupData[{
Cell[266429, 6604, 269, 5, 53, "Subsection",ExpressionUUID->"4b0acb2b-464a-4780-87c2-adee5815e682",
 CellTags->"Sensitivity-computation"],
Cell[266701, 6611, 8771, 203, 467, "Input",ExpressionUUID->"77491e31-6ccd-4b4c-9162-3fc7efc33e3f",
 CellTags->"Sensitivity-computation"]
}, Closed]],
Cell[CellGroupData[{
Cell[275509, 6819, 211, 4, 53, "Subsection",ExpressionUUID->"4af71be4-b031-4d3f-aac5-c3bd871b62a5",
 CellTags->"Sensitivity-computation"],
Cell[275723, 6825, 20222, 506, 569, "Input",ExpressionUUID->"140a9c48-3c60-400f-bb3d-41932b0b01fa",
 CellTags->"Sensitivity-computation"],
Cell[295948, 7333, 129, 3, 22, "Input",ExpressionUUID->"3e753374-796f-4f38-bd6d-2c5f6b110986"],
Cell[296080, 7338, 229, 4, 22, "Input",ExpressionUUID->"eae7e182-2481-442c-862e-bce7c8618c93"]
}, Closed]]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[296382, 7350, 171, 3, 57, "Title",ExpressionUUID->"ffb96111-011a-40fa-9682-858963d62183"],
Cell[296556, 7355, 790, 17, 54, "Input",ExpressionUUID->"f52ba2e2-b5c4-48a5-92ca-6113d843928f"]
}, Closed]]
}
]
*)

