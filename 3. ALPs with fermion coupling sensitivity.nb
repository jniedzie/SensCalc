(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    332427,       8074]
NotebookOptionsPosition[    293788,       7476]
NotebookOutlinePosition[    317503,       7798]
CellTagsIndexPosition[    317233,       7788]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Just launch the code below to run the notebook (shift+enter)", "Title",
 CellChangeTimes->{{3.8934376452895875`*^9, 
  3.8934376644509068`*^9}},ExpressionUUID->"0839ea5b-1982-4dfb-8c5d-\
195bcd99f6e9"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BlockEvaluation", "[", "tag_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nb", "=", 
      RowBox[{"EvaluationNotebook", "[", "]"}]}], ";", "\n", 
     RowBox[{"NotebookFind", "[", 
      RowBox[{"nb", ",", "tag", ",", "All", ",", "CellTags"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"infoDialog", "[", "phrase_", "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<Proceed\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DirectoryQ", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<Auxiliary data\>\""}], "}"}], "]"}], "]"}], "//", 
       "ToString"}], ")"}], "\[Equal]", "\"\<False\>\""}], ",", 
    RowBox[{"CreateDirectory", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<Auxiliary data\>\""}], "}"}], "]"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DirectoryQ", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<Auxiliary data/ALPs with fermion coupling\>\""}], "}"}], 
         "]"}], "]"}], "//", "ToString"}], ")"}], "\[Equal]", 
     "\"\<False\>\""}], ",", 
    RowBox[{"CreateDirectory", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<Auxiliary data/ALPs with fermion coupling\>\""}], "}"}], "]"}], 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"choiceslist", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<Acceptance\>\"", ",", "\"\<Tabulated number of events\>\"", ",", 
     "\"\<Sensitivity\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"taglist", "[", "\"\<Acceptance\>\"", "]"}], "=", 
   "\"\<Acceptance\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"taglist", "[", "\"\<Tabulated number of events\>\"", "]"}], "=", 
   "\"\<Number-of-events\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"taglist", "[", "\"\<Sensitivity\>\"", "]"}], "=", 
   "\"\<Sensitivity\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"computationchoice", "=", 
   RowBox[{"dropdownDialog", "[", 
    RowBox[{
    "choiceslist", ",", 
     "\"\<Do you want to compute the tabulated number of events and then \
sensitivity, or just sensitivity (if the tabulated number of events has been \
already produced)?\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"tagselected", "=", 
  RowBox[{"taglist", "[", "computationchoice", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"BlockEvaluation", "[", "tagselected", "]"}]}], "Input",
 CellChangeTimes->{{3.893437585709897*^9, 3.8934375895369635`*^9}, {
   3.8934376329497385`*^9, 3.893437658846809*^9}, 3.8935730495823717`*^9, {
   3.8936653425702004`*^9, 3.8936653432627907`*^9}, {3.8950526655121717`*^9, 
   3.895052665712869*^9}, {3.895126994040556*^9, 3.8951270001060944`*^9}, {
   3.902561886909021*^9, 3.9025619879179907`*^9}, {3.902562067085945*^9, 
   3.9025620673227577`*^9}, 3.9027294885937986`*^9, {3.903788557154269*^9, 
   3.9037885613831005`*^9}, {3.9038033934699326`*^9, 
   3.9038034371611333`*^9}, {3.903854932333012*^9, 3.9038549328265457`*^9}},
 CellLabel->
  "In[420]:=",ExpressionUUID->"3ff672e3-e982-49fe-8fe3-e69285f06990"]
}, Closed]],

Cell[CellGroupData[{

Cell["Preliminary definitions", "Title",
 CellChangeTimes->{{3.7552434949579296`*^9, 3.755243495237189*^9}, {
   3.88501652694691*^9, 3.885016532955313*^9}, {3.8850204805201235`*^9, 
   3.885020485584347*^9}, 3.887617574733776*^9},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"dc98cc40-afde-45ba-ae22-74afbd95ce04"],

Cell[CellGroupData[{

Cell["Parameters and various functions", "Chapter",
 CellChangeTimes->{{3.8846619009140606`*^9, 3.884661902476644*^9}, {
  3.885017296053095*^9, 3.8850172996856313`*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"9e90539e-357b-496f-b4bb-a60bd5224fbd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"infoDialog", "[", "phrase_", "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<Proceed\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"selectionDialog", "[", 
    RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
   RowBox[{"DialogInput", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"choice", "=", 
       RowBox[{"{", "}"}]}], "}"}], ",", 
     RowBox[{"Column", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{
         "{", "\"\<Select the experiments for which the number of events will \
be computed:\>\"", "}"}], "]"}], ",", 
        RowBox[{"Pane", "[", 
         RowBox[{
          RowBox[{"TogglerBar", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list", ",", 
            RowBox[{"Appearance", "->", 
             RowBox[{"\"\<Vertical\>\"", "->", 
              RowBox[{"{", 
               RowBox[{"Automatic", ",", "5"}], "}"}]}]}]}], "]"}], ",", 
          RowBox[{"ImageSize", "->", 
           RowBox[{"{", 
            RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], ",", 
          RowBox[{"Scrollbars", "->", 
           RowBox[{"{", 
            RowBox[{"False", ",", "True"}], "}"}]}]}], "]"}], ",", 
        RowBox[{"Button", "[", 
         RowBox[{"\"\<OK\>\"", ",", 
          RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
      "]"}]}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", "chbar", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"chbar", "=", " ", 
    RowBox[{"6.6", "*", 
     SuperscriptBox["10", 
      RowBox[{"-", "25"}]], "*", "3", "*", 
     SuperscriptBox["10", "8"]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Decay", " ", "width", " ", "of", " ", "mesons"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Tau]\[Pi]0", "=", 
   RowBox[{"8.52", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "17"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalGamma]\[Pi]0", "=", 
   FractionBox["chbar", "\[Tau]\[Pi]0"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Tau]B", "=", 
   RowBox[{"1.64", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "12"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hbar", "=", 
   RowBox[{"6.58", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "25"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalGamma]BdecayGeV", "=", 
    FractionBox["hbar", "\[Tau]B"]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Bare", " ", "quark", " ", "masses", " ", "from", " ", "pdg"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"md", "=", 
   RowBox[{"4.67", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "3"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mu", "=", 
   RowBox[{"2.16", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "3"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ms", "=", "0.093"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Masses", " ", "of", " ", "various", " ", "SM", " ", "particles"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mB", "=", "5.279"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mK", "=", "0.495"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mW", "=", "80"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mKstar", "=", "0.892"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m\[Pi]0", "=", "0.135"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m\[Eta]", "=", "0.547"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"m\[Eta]pr", "=", "0.958"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "Scales", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalLambda]wVal", "=", "80"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalLambda]QCDval", "=", "0.34"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Coupling", " ", "constants"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]EM", "=", 
   RowBox[{"1", "/", "137"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]W", "=", 
   RowBox[{"1", "/", "29."}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f\[Pi]", "=", "0.093"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]\[Eta]\[Eta]pr", "=", 
    RowBox[{"ArcSin", "[", 
     RowBox[{
      RowBox[{"-", "1"}], "/", "3."}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Cross", "-", "sections"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]pNucleonInpb", "[", "Atarget_", "]"}], "=", 
   RowBox[{"51", "*", 
    SuperscriptBox["Atarget", 
     RowBox[{"-", "0.29"}]], "*", 
    SuperscriptBox["10", "9"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]ppLHC", "=", 
    RowBox[{"72", "*", 
     SuperscriptBox["10", "9"]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Alpha]S", "[", "ma_", "]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"Interpolation", "[", 
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"NotebookDirectory", "[", "]"}], ",", 
             "\"\<phenomenology/AlphaS.txt\>\""}], "}"}], "]"}], ",", 
          "\"\<Table\>\""}], "]"}], ",", 
        RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "ma", 
      "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fragmentation", " ", "fractions", " ", "at", " ", "the", " ", "LHC"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fbtob0LHC", "=", 
   RowBox[{"fbtobplusLHC", "=", "0.324"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fbtobsLHC", "=", "0.09"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"b", "\[Rule]", 
    RowBox[{
    "B", " ", "fragmentation", " ", "fractions", " ", "at", " ", "SPS"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fbtobsSPS", "=", "0.11"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fbtob0SPS", "=", 
    RowBox[{"fbtobplusSPS", "=", "0.411"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"b", "\[Rule]", 
    RowBox[{"B", " ", "fragmentation", " ", "fractions", " ", "at", " ", 
     RowBox[{"FermilabBD", ".", " ", "Assumed"}], " ", "to", " ", "be", " ", 
     "the", " ", "same", " ", "as", " ", "at", " ", "SPS"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fbtobsFermilabBD", "=", "0.11"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fbtob0FermilabBD", "=", 
   RowBox[{"fbtobplusFermilabBD", "=", "0.411"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.884661904994011*^9, 3.884661921540403*^9}, {
   3.8850164522887964`*^9, 3.8850165245568185`*^9}, {3.885016628097911*^9, 
   3.8850166282886553`*^9}, 3.885016710182028*^9, {3.8850167568987885`*^9, 
   3.885016762395402*^9}, {3.885016799450395*^9, 3.8850170557864246`*^9}, {
   3.88501712653312*^9, 3.885017216885895*^9}, {3.8850173024453783`*^9, 
   3.8850173372383676`*^9}, {3.885017399572728*^9, 3.88501741270778*^9}, {
   3.8850174625354366`*^9, 3.885017462658634*^9}, {3.8850175591211877`*^9, 
   3.8850175593408356`*^9}, {3.8850182535473127`*^9, 
   3.8850182538962827`*^9}, {3.885018314394388*^9, 3.885018333197164*^9}, {
   3.8850189741121674`*^9, 3.885018974433589*^9}, 3.8850190966970725`*^9, {
   3.885019721482507*^9, 3.8850197654258046`*^9}, {3.885019828534438*^9, 
   3.8850198661946564`*^9}, {3.88501995528426*^9, 3.8850201480526233`*^9}, {
   3.885020185062007*^9, 3.8850201894992275`*^9}, {3.885020291896063*^9, 
   3.8850203335305076`*^9}, {3.885020432284384*^9, 3.8850204475138783`*^9}, {
   3.8850205949824495`*^9, 3.885020600587699*^9}, {3.8850212843213625`*^9, 
   3.88502132833275*^9}, {3.885032891250867*^9, 3.8850329826946216`*^9}, {
   3.885033159126209*^9, 3.885033161690289*^9}, {3.8850331946913424`*^9, 
   3.8850331954065113`*^9}, {3.8850336204217644`*^9, 
   3.8850336226032686`*^9}, {3.8850342557191987`*^9, 
   3.8850344920061417`*^9}, {3.8850345924696712`*^9, 3.885034596199212*^9}, {
   3.885137383509305*^9, 3.8851374066552467`*^9}, {3.8851374685027866`*^9, 
   3.8851376554160604`*^9}, {3.885137692569293*^9, 3.885137784659045*^9}, {
   3.8851378255007744`*^9, 3.885137825675703*^9}, {3.8851383907242584`*^9, 
   3.885138392478346*^9}, {3.88513944801902*^9, 3.8851394797221875`*^9}, {
   3.885139512250944*^9, 3.8851395456971464`*^9}, {3.8851395939313083`*^9, 
   3.885139596117799*^9}, {3.885962358064992*^9, 3.8859624268736916`*^9}, {
   3.8859624953843336`*^9, 3.8859626830961175`*^9}, {3.885962735843563*^9, 
   3.8859627976972876`*^9}, {3.8859628301191607`*^9, 3.885962890857554*^9}, {
   3.885963158435935*^9, 3.885963249728134*^9}, {3.885964057005262*^9, 
   3.885964083223074*^9}, {3.8859661974588585`*^9, 3.8859662142093754`*^9}, {
   3.885966318198004*^9, 3.885966320641197*^9}, {3.885966447872212*^9, 
   3.885966506060196*^9}, {3.8859675052817345`*^9, 3.8859675311750975`*^9}, {
   3.885967601307781*^9, 3.885967609066586*^9}, {3.8859683762378*^9, 
   3.885968381214256*^9}, {3.8859738304157605`*^9, 3.8859738349173265`*^9}, {
   3.8865683607492385`*^9, 3.886568363243331*^9}, {3.886574653457847*^9, 
   3.8865746733313556`*^9}, {3.8866746207176623`*^9, 3.886674629953519*^9}, {
   3.8866936475288982`*^9, 3.8866936498862143`*^9}, {3.8902888345172024`*^9, 
   3.890288834677594*^9}, {3.8934972089819107`*^9, 3.8934972163689437`*^9}, {
   3.893520919046756*^9, 3.8935209190527515`*^9}, {3.893740434030961*^9, 
   3.893740543984796*^9}, {3.893745916046507*^9, 3.8937459169433384`*^9}, {
   3.8956586709714384`*^9, 3.895658671930601*^9}, {3.905231730357545*^9, 
   3.905231734237323*^9}},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->"In[14]:=",ExpressionUUID->"81abd027-7ae4-4675-ae59-2bfc340f66bb"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Alpha]", "strong"], TraditionalForm]],ExpressionUUID->
  "3ea45a80-d2f8-4118-a831-57756e86519a"],
 " (a rough fit from https://arxiv.org/abs/2201.05170)"
}], "Section",
 CellChangeTimes->{{3.8866936676352615`*^9, 3.8866936710660887`*^9}, {
  3.893742189097562*^9, 3.893742216894745*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"7c55ffb2-0d9e-426c-8145-0f4c17afabe4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"fitfunc", "[", 
    RowBox[{"a1_", ",", "a2_", ",", "a3_", ",", "a4_", ",", "ma_"}], "]"}], 
   "=", 
   RowBox[{"a1", "+", 
    RowBox[{"a2", "*", "ma"}], "+", 
    RowBox[{"a3", "*", 
     SuperscriptBox["ma", "2"]}], "+", 
    RowBox[{"a4", "*", 
     SuperscriptBox["ma", "3"]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coefsols", "=", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"fitfunc", "[", 
         RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4", ",", "1"}], "]"}], 
        "\[Equal]", "1"}], "&&", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"fitfunc", "[", 
             RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4", ",", "ma"}], 
             "]"}], ",", "ma"}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"ma", "\[Rule]", "1"}], "}"}]}], ")"}], "\[Equal]", "0"}], 
       "&&", 
       RowBox[{
        RowBox[{"fitfunc", "[", 
         RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4", ",", "1.5"}], "]"}], "==", 
        FractionBox[
         RowBox[{"4", "*", "Pi"}], 
         RowBox[{"7", "*", "2", "*", 
          RowBox[{"Log", "[", 
           FractionBox["1.5", "0.34"], "]"}]}]]}], "&&", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"fitfunc", "[", 
             RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4", ",", "ma"}], 
             "]"}], ",", "ma"}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"ma", "\[Rule]", "1.5"}], "}"}]}], ")"}], "\[Equal]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"4", "*", "Pi"}], 
             RowBox[{"7", "*", "2", "*", 
              RowBox[{"Log", "[", 
               FractionBox["ma", "0.34"], "]"}]}]], ",", "ma"}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"ma", "\[Rule]", "1.5"}], "}"}]}], ")"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Alpha]S", "[", "ma_", "]"}], "=", 
   RowBox[{"Piecewise", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"ma", "\[LessEqual]", "1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"fitfunc", "[", 
          RowBox[{
           RowBox[{"a1", "/.", "coefsols"}], ",", 
           RowBox[{"a2", "/.", "coefsols"}], ",", 
           RowBox[{"a3", "/.", "coefsols"}], ",", 
           RowBox[{"a4", "/.", "coefsols"}], ",", "ma"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"1", "<", "ma", "\[LessEqual]", "1.5"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{"4", "*", "Pi"}], 
         RowBox[{"7", "*", "2", "*", 
          RowBox[{"Log", "[", 
           FractionBox["ma", "0.34"], "]"}]}]], ",", 
        RowBox[{"ma", ">", "1.5"}]}], "}"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogLogPlot", "[", 
  RowBox[{
   RowBox[{"\[Alpha]S", "[", "ma", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"ma", ",", "0.5", ",", "3"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8866936834284678`*^9, 3.8866937901201963`*^9}, {
   3.893742186438052*^9, 3.893742187521503*^9}, 3.893742240238215*^9},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->"In[47]:=",ExpressionUUID->"ff9f349f-4e9a-429c-bf55-03b67960b621"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "ALP phenomenology ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"y", "=", 
     RowBox[{"2", 
      RowBox[{
       SubscriptBox["v", "h"], "/", "f"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"2806f65a-4238-499d-ad68-09d1b096d2a3"],
 ")"
}], "Chapter",
 CellChangeTimes->{{3.8851378652235947`*^9, 3.885137868355297*^9}, {
   3.88597161695352*^9, 3.885971618272816*^9}, 3.885973766532051*^9, {
   3.8937422451016216`*^9, 3.893742254441326*^9}, {3.9037902704546976`*^9, 
   3.9037902934649353`*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"490d0d1a-3e44-4a63-8903-e0e537cb7123"],

Cell[CellGroupData[{

Cell["Production probabilities", "Section",
 CellChangeTimes->{{3.826713169183443*^9, 3.8267131698544655`*^9}, {
  3.885138658855132*^9, 3.8851386649516826`*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"78ee7ba3-4532-4920-80f8-e1fc4e784430"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ProductionProbabilitiesCoefs", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<phenomenology/ALPs with fermion coupling/branching ratios\>\"", 
        ",", "\"\<Coefs-production-Fermion universal-scale-1000.-GeV.m\>\""}],
        "}"}], "]"}], ",", "\"\<MX\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vh", "=", "246."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]am02", "[", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", "ma_", ",", 
       "y_"}], "]"}], ",", 
     RowBox[{"\[Theta]am02", "[", 
      RowBox[{"\"\<\[Eta]\>\"", ",", "ma_", ",", "y_"}], "]"}], ",", 
     RowBox[{"\[Theta]am02", "[", 
      RowBox[{"\"\<\[Eta]'\>\"", ",", "ma_", ",", "y_"}], "]"}], ",", 
     RowBox[{"BrBtoALPtotal", "[", 
      RowBox[{"ma_", ",", "y_"}], "]"}], ",", 
     RowBox[{"cGGeff", "[", 
      RowBox[{"ma_", ",", "y_"}], "]"}], ",", 
     RowBox[{"BrBtoALPKplus", "[", 
      RowBox[{"ma_", ",", "y_"}], "]"}], ",", 
     RowBox[{"BrBtoALPKstar", "[", 
      RowBox[{"ma_", ",", "y_"}], "]"}]}], "}"}], "=", 
   RowBox[{"ProductionProbabilitiesCoefs", "/.", 
    RowBox[{"{", 
     RowBox[{"f", "->", 
      FractionBox[
       RowBox[{"2", "vh"}], "y"]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"alpfermionselection", "=", 
  RowBox[{"dropdownDialog", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\"\<Revised\>\"", ",", "\"\<Old\>\""}], "}"}], ",", 
    "\"\<Use the revised phenomenology (2310.03524), or the old one \
(1901.09966; no hadronic decays, production only via B+/B*)? Must be \
consistent with the choice made in 1. Acceptances.nb\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LogLogPlot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]am02", "[", 
       RowBox[{
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", "ma", ",", 
        "1"}], "]"}], ",", 
      RowBox[{"\[Theta]am02", "[", 
       RowBox[{"\"\<\[Eta]\>\"", ",", "ma", ",", "1"}], "]"}], ",", 
      RowBox[{"\[Theta]am02", "[", 
       RowBox[{"\"\<\[Eta]'\>\"", ",", "ma", ",", "1"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"ma", ",", "0.1", ",", "10"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Production", " ", "from", " ", "B"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"BplusB0fraction", "[", "\"\<FermilabBD\>\"", "]"}], ",", 
     RowBox[{"BplusB0fraction", "[", "\"\<SPS\>\"", "]"}], ",", 
     RowBox[{"BplusB0fraction", "[", "\"\<LHC\>\"", "]"}], ",", 
     RowBox[{"BplusB0fraction", "[", "\"\<FCC-hh\>\"", "]"}]}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fbtobplusSPS", "+", "fbtob0SPS"}], ",", 
     RowBox[{"fbtobplusSPS", "+", "fbtob0SPS"}], ",", 
     RowBox[{"fbtobplusLHC", "+", "fbtob0LHC"}], ",", 
     RowBox[{"fbtobplusLHC", "+", "fbtob0LHC"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"facilitylist", "=", 
  RowBox[{
   RowBox[{"Keys", "[", 
    RowBox[{"DownValues", "@", "BplusB0fraction"}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"All", ",", "1", ",", "1"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"pBtoALPfacility", "[", 
      RowBox[{"ma_", ",", "y_", ",", "facility"}], "]"}], "=", 
     RowBox[{
      RowBox[{"BplusB0fraction", "[", "facility", "]"}], "*", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"alpfermionselection", "==", "\"\<Revised\>\""}], ",", 
        RowBox[{"BrBtoALPtotal", "[", 
         RowBox[{"ma", ",", "y"}], "]"}], ",", 
        RowBox[{
         RowBox[{"BrBtoALPKplus", "[", 
          RowBox[{"ma", ",", "y"}], "]"}], "+", 
         RowBox[{"BrBtoALPKstar", "[", 
          RowBox[{"ma", ",", "y"}], "]"}]}]}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"facility", ",", "facilitylist"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Prouction", " ", "from", " ", "Drell"}], "-", 
    RowBox[{"Yan", " ", "process"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]DrellYanData", "[", "file_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dat", "=", 
      RowBox[{"Import", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<phenomenology/ALPs with gluon coupling/branching ratios\>\"", 
           ",", "file"}], "}"}], "]"}], ",", "\"\<Table\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"MinMaxMassesDrellYan", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Min", "[", 
         RowBox[{"dat", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{"4", ",", 
          RowBox[{"Max", "[", 
           RowBox[{"dat", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}]}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"MinMaxMassesDrellYan", ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MinMaxMassesDrellYan", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", " ", "ma", 
          "\[LessEqual]", 
          RowBox[{"MinMaxMassesDrellYan", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Interpolation", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Log10", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                   RowBox[{"Log10", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "90"}]]}], "]"}]}], "}"}], "&"}], "/@", 
                "dat"}], ",", 
               RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
             RowBox[{"Log10", "[", "ma", "]"}], "]"}], ")"}]}], "]"}], ",", 
         "0"}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mDrellYanMinLHC", ",", "mDrellYanMaxLHC"}], "}"}], ",", 
     RowBox[{"\[Sigma]DrellYanpbLHCatLO", "[", "mV_", "]"}]}], "}"}], "=", 
   RowBox[{
   "\[Sigma]DrellYanData", "[", "\"\<sigmaDrellYan-ALPgluon-LHC.txt\>\"", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mDrellYanMinSPS", ",", "mDrellYanMaxSPS"}], "}"}], ",", 
     RowBox[{"\[Sigma]DrellYanpbSPSatLO", "[", "mV_", "]"}]}], "}"}], "=", 
   RowBox[{
   "\[Sigma]DrellYanData", "[", "\"\<sigmaDrellYan-ALPgluon-SPS.txt\>\"", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mDrellYanMinFermilabBD", ",", "mDrellYanMaxFermilabBD"}], 
      "}"}], ",", 
     RowBox[{"\[Sigma]DrellYanpbFermilabBDatLO", "[", "mV_", "]"}]}], "}"}], 
   "=", 
   RowBox[{
   "\[Sigma]DrellYanData", "[", 
    "\"\<sigmaDrellYan-ALPgluon-FermilabBD.txt\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PDrellYanFacility", "[", 
      RowBox[{"ma_", ",", "y_", ",", "Atarget_", ",", "\"\<FermilabBD\>\""}], 
      "]"}], ",", 
     RowBox[{"PDrellYanFacility", "[", 
      RowBox[{"ma_", ",", "y_", ",", "Atarget_", ",", "\"\<SPS\>\""}], "]"}], 
     ",", 
     RowBox[{"PDrellYanFacility", "[", 
      RowBox[{"ma_", ",", "y_", ",", "Atarget_", ",", "\"\<LHC\>\""}], "]"}], 
     ",", 
     RowBox[{"PDrellYanFacility", "[", 
      RowBox[{"ma_", ",", "y_", ",", "Atarget_", ",", "\"\<FCC-hh\>\""}], 
      "]"}]}], "}"}], "=", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"Abs", "[", 
      RowBox[{"cGGeff", "[", 
       RowBox[{"ma", ",", "y"}], "]"}], "]"}], "2"], "*", 
    RowBox[{"{", 
     RowBox[{
      FractionBox[
       RowBox[{"\[Sigma]DrellYanpbFermilabBDatLO", "[", "ma", "]"}], 
       RowBox[{"\[Sigma]pNucleonInpb", "[", "Atarget", "]"}]], ",", 
      FractionBox[
       RowBox[{"\[Sigma]DrellYanpbSPSatLO", "[", "ma", "]"}], 
       RowBox[{"\[Sigma]pNucleonInpb", "[", "Atarget", "]"}]], ",", 
      FractionBox[
       RowBox[{"\[Sigma]DrellYanpbLHCatLO", "[", "ma", "]"}], 
       RowBox[{"\[Sigma]ppLHC", "//", "N"}]], ",", "0"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.903789100961299*^9, 3.9037893216023073`*^9}, {
  3.903789523395295*^9, 3.9037895724096284`*^9}, {3.9037896047683144`*^9, 
  3.9037897735656195`*^9}, {3.9037898903249865`*^9, 3.9037899000449486`*^9}, {
  3.9037899642050085`*^9, 3.9037900057850637`*^9}, {3.9037900367013836`*^9, 
  3.9037900569756083`*^9}, {3.903790184930455*^9, 3.9037902290750723`*^9}, {
  3.903790296392641*^9, 3.9037903616060886`*^9}, {3.9052322085806866`*^9, 
  3.905232251160842*^9}, {3.9057041721278706`*^9, 3.905704172799265*^9}},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->"In[51]:=",ExpressionUUID->"fec40a05-ba64-4ab5-86c9-a0eb22a607d0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["ALP lifetime and branching ratios", "Section",
 CellChangeTimes->{{3.7725113836218624`*^9, 3.7725113869263587`*^9}, {
   3.826651830998455*^9, 3.826651834218698*^9}, {3.8267130444352474`*^9, 
   3.8267130466742153`*^9}, {3.885139954002949*^9, 3.8851399560519075`*^9}, 
   3.8859669419752054`*^9},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"12e0bee4-6a1a-451c-b99f-fa0db8a155eb"],

Cell[CellGroupData[{

Cell["Lifetimes and branching ratios", "Subsection",
 CellChangeTimes->{{3.826651853928807*^9, 3.8266518561959257`*^9}, {
   3.877248260034466*^9, 3.8772482610102777`*^9}, 3.8851399575347958`*^9, {
   3.903790416325832*^9, 3.9037904195043745`*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"0a5caafb-270c-4b49-8d0a-a733f8c6fed5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DecayWidthsDataTemp", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<phenomenology/ALPs with fermion coupling/decay \
widths/Widths-model-Fermion universal-scale-1000.-GeV.m\>\""}], "}"}], "]"}], 
     ",", "\"\<MX\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DecayWidthsDataTemp2", "=", 
   RowBox[{"DecayWidthsDataTemp", "[", 
    RowBox[{"[", "4", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{"i", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", 
         RowBox[{"DecayWidthsDataTemp2", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "1"}], "}"}]}], "]"}], 
    ",", 
    RowBox[{"DecayWidthsDataTemp2", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "//", 
  "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DecayWidthsData", "=", 
    RowBox[{"Drop", "[", 
     RowBox[{"DecayWidthsDataTemp2", ",", "3"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Total", " ", "decay", " ", "width", " ", "and", " ", "lifetime"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"totalwidthdata", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"alpfermionselection", "==", "\"\<Revised\>\""}], ",", 
     RowBox[{"DecayWidthsData", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"DecayWidthsData", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{"{", "1", "}"}]}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"DecayWidthsData", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}], "]"}], "+", 
        RowBox[{"DecayWidthsData", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", "3", "}"}]}], "]"}], "]"}], "+", 
        RowBox[{"DecayWidthsData", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", "4", "}"}]}], "]"}], "]"}]}], ",", "2"}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalGamma]ALPtotal", "[", 
    RowBox[{"ma_", ",", "y_"}], "]"}], "=", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["1", 
       RowBox[{"2", "vh"}]], ")"}], "2"], 
    SuperscriptBox["y", "2"], 
    RowBox[{
     RowBox[{"Interpolation", "[", 
      RowBox[{"totalwidthdata", ",", 
       RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", "ma", 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"c\[Tau]ALP", "[", 
    RowBox[{"ma_", ",", "y_"}], "]"}], "=", 
   FractionBox["chbar", 
    RowBox[{"\[CapitalGamma]ALPtotal", "[", 
     RowBox[{"ma", ",", "y"}], "]"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ldecayALP", "[", 
    RowBox[{"ma_", ",", "y_", ",", "Ea_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"c\[Tau]ALP", "[", 
     RowBox[{"ma", ",", "y"}], "]"}], 
    FractionBox[
     SqrtBox[
      RowBox[{
       SuperscriptBox["Ea", "2"], "-", 
       SuperscriptBox["ma", "2"]}]], "ma"]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8859667506271453`*^9, 3.8859667912060575`*^9}, {
   3.8859668364245796`*^9, 3.8859669074950113`*^9}, 3.8859669419823914`*^9, {
   3.8859715979950085`*^9, 3.8859716035792685`*^9}, {3.885974695642521*^9, 
   3.885974721565711*^9}, {3.886673217124567*^9, 3.886673218603608*^9}, {
   3.889769657115446*^9, 3.8897697543792963`*^9}, {3.903789673385208*^9, 
   3.903789673405342*^9}, {3.9037903163143153`*^9, 3.9037903275646253`*^9}, {
   3.903790500628828*^9, 3.903790729474674*^9}, {3.9037907845403433`*^9, 
   3.9037908533741627`*^9}, {3.9037908912108645`*^9, 
   3.9037911007246227`*^9}, {3.9037933373491344`*^9, 3.903793339945244*^9}, {
   3.9037937001663465`*^9, 3.903793717204276*^9}, {3.904902837278482*^9, 
   3.904902837561043*^9}, {3.904902887149907*^9, 3.9049028887197638`*^9}, {
   3.905231744853395*^9, 3.905231948969136*^9}, {3.9052320214476357`*^9, 
   3.9052320316413155`*^9}, {3.9057040844572673`*^9, 
   3.9057041222670794`*^9}, {3.905704159567094*^9, 3.905704160407111*^9}, {
   3.9059620387064934`*^9, 3.905962043600975*^9}},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->"In[64]:=",ExpressionUUID->"6b40e71e-4d73-422f-a8a1-e2d1d3309f91"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Compilable interpolation function mapping one grid into another\
\>", "Chapter",
 CellChangeTimes->{{3.891315426588935*^9, 3.891315432542842*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"c9967d9e-0dfa-4ef8-95ab-cf6e6b36fed3"],

Cell[CellGroupData[{

Cell["3D to 3D", "Subsection",
 CellChangeTimes->{{3.8906627216475997`*^9, 3.8906627248020773`*^9}, {
  3.8907326559924955`*^9, 3.89073265766968*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"77ee91eb-9cfb-4628-805f-ec9b94526fb9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nd", "=", "3"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"cf3", "=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"xgvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<xg\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"igvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<ig\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"tgvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<tg\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"ivars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<i\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"svars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<s\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"tvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<t\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"jvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<j\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}]}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Inactivate", "[", 
         RowBox[{
          RowBox[{"Compile", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"seq", "@", 
               RowBox[{"{", 
                RowBox[{"xgvars", ",", "_Real", ",", "1"}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", "_Real", ",", "nd"}], "}"}]}], "}"}], ",", 
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"seq", "@", "igvars"}], ",", 
                RowBox[{"seq", "@", "tgvars"}], ",", 
                RowBox[{"seq", "@", "ivars"}], ",", 
                RowBox[{"seq", "@", "svars"}], ",", 
                RowBox[{"seq", "@", "tvars"}]}], "}"}], ",", 
              RowBox[{
               RowBox[{"seq", "[", 
                RowBox[{"igvars", "=", 
                 RowBox[{
                  RowBox[{"Floor", "[", "xgvars", "]"}], "-", 
                  RowBox[{"UnitStep", "[", 
                   RowBox[{"xgvars", "-", 
                    RowBox[{"indexed", "@", 
                    RowBox[{"Dimensions", "@", "y"}]}]}], "]"}]}]}], "]"}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"seq", "[", 
                RowBox[{"tgvars", "=", 
                 RowBox[{"xgvars", "-", "igvars"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"seq", "[", 
                   RowBox[{"tvars", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"tgvars", ",", "jvars"}], "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"seq", "[", 
                   RowBox[{"ivars", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"igvars", ",", "jvars"}], "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"seq", "[", 
                   RowBox[{"svars", "=", 
                    RowBox[{"1.", "-", "tvars"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"eval", "@", 
                   RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Times", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], " ", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], "]"}]}], 
                    "&"}], "/@", 
                    RowBox[{"Tuples", "@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"svars", ",", "ivars"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"tvars", ",", 
                    RowBox[{"ivars", "+", "1"}]}], "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}]}]}], 
                    "]"}]}]}], ",", 
                 RowBox[{"seq", "@", 
                  RowBox[{"{", 
                   RowBox[{"jvars", ",", 
                    RowBox[{"Length", "@", "igvars"}]}], "}"}]}]}], "]"}]}]}],
              "]"}], ",", 
            RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
            RowBox[{"RuntimeAttributes", "\[Rule]", 
             RowBox[{"{", "Listable", "}"}]}], ",", 
            RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
            RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}], 
          ",", 
          RowBox[{"Except", "[", 
           RowBox[{"seq", "|", "eval", "|", "indexed"}], "]"}]}], "]"}], "/.", 
        RowBox[{
         RowBox[{"seq", "[", "expr_", "]"}], "\[RuleDelayed]", 
         RowBox[{"RuleCondition", "@", 
          RowBox[{"(", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Inactivate", "[", 
                RowBox[{"expr", ",", 
                 RowBox[{"Except", "[", 
                  RowBox[{"slist", "|", "indexed"}], "]"}]}], "]"}], "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"l_slist", "\[RuleDelayed]", 
                  RowBox[{"l", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"indexed", "[", "l_", "]"}], "\[RuleDelayed]", 
                  RowBox[{
                   RowBox[{"Inactive", "[", "Compile`GetElement", "]"}], "[", 
                   RowBox[{"l", ",", "i"}], "]"}]}]}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "nd"}], "}"}]}], "]"}]}], ")"}]}]}]}], "/.", 
       RowBox[{
        RowBox[{"eval", "@", "expr_"}], "\[RuleDelayed]", 
        RowBox[{"RuleCondition", "[", 
         RowBox[{"Activate", "[", 
          RowBox[{"expr", "/.", 
           RowBox[{"slist", "\[Rule]", "List"}]}], "]"}], "]"}]}]}]}], "]"}], 
    "//", "Activate"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.890711783488103*^9, 3.89071178348964*^9}, {
  3.8907121412539587`*^9, 3.8907121413711557`*^9}, {3.890712694841427*^9, 
  3.8907126950000925`*^9}, {3.890712790376151*^9, 3.8907128219919777`*^9}, {
  3.891018553068019*^9, 3.8910185548862777`*^9}},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->"In[72]:=",ExpressionUUID->"32dd4f2f-1ac0-470c-95e5-55c362bea948"]
}, Open  ]],

Cell[CellGroupData[{

Cell["4D to 4D", "Subsection",
 CellChangeTimes->{{3.8906627216475997`*^9, 3.8906627248020773`*^9}, {
  3.8907326559924955`*^9, 3.890732670187893*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"a1fbc33e-9a65-4c68-8299-5eb60b8c134b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nd", "=", "4"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"cf4", "=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"xgvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<xg\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"igvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<ig\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"tgvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<tg\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"ivars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<i\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"svars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<s\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"tvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<t\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"jvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<j\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}]}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Inactivate", "[", 
         RowBox[{
          RowBox[{"Compile", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"seq", "@", 
               RowBox[{"{", 
                RowBox[{"xgvars", ",", "_Real", ",", "1"}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", "_Real", ",", "nd"}], "}"}]}], "}"}], ",", 
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"seq", "@", "igvars"}], ",", 
                RowBox[{"seq", "@", "tgvars"}], ",", 
                RowBox[{"seq", "@", "ivars"}], ",", 
                RowBox[{"seq", "@", "svars"}], ",", 
                RowBox[{"seq", "@", "tvars"}]}], "}"}], ",", 
              RowBox[{
               RowBox[{"seq", "[", 
                RowBox[{"igvars", "=", 
                 RowBox[{
                  RowBox[{"Floor", "[", "xgvars", "]"}], "-", 
                  RowBox[{"UnitStep", "[", 
                   RowBox[{"xgvars", "-", 
                    RowBox[{"indexed", "@", 
                    RowBox[{"Dimensions", "@", "y"}]}]}], "]"}]}]}], "]"}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"seq", "[", 
                RowBox[{"tgvars", "=", 
                 RowBox[{"xgvars", "-", "igvars"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"seq", "[", 
                   RowBox[{"tvars", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"tgvars", ",", "jvars"}], "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"seq", "[", 
                   RowBox[{"ivars", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"igvars", ",", "jvars"}], "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"seq", "[", 
                   RowBox[{"svars", "=", 
                    RowBox[{"1.", "-", "tvars"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"eval", "@", 
                   RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Times", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], " ", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], "]"}]}], 
                    "&"}], "/@", 
                    RowBox[{"Tuples", "@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"svars", ",", "ivars"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"tvars", ",", 
                    RowBox[{"ivars", "+", "1"}]}], "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}]}]}], 
                    "]"}]}]}], ",", 
                 RowBox[{"seq", "@", 
                  RowBox[{"{", 
                   RowBox[{"jvars", ",", 
                    RowBox[{"Length", "@", "igvars"}]}], "}"}]}]}], "]"}]}]}],
              "]"}], ",", 
            RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
            RowBox[{"RuntimeAttributes", "\[Rule]", 
             RowBox[{"{", "Listable", "}"}]}], ",", 
            RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
            RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}], 
          ",", 
          RowBox[{"Except", "[", 
           RowBox[{"seq", "|", "eval", "|", "indexed"}], "]"}]}], "]"}], "/.", 
        RowBox[{
         RowBox[{"seq", "[", "expr_", "]"}], "\[RuleDelayed]", 
         RowBox[{"RuleCondition", "@", 
          RowBox[{"(", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Inactivate", "[", 
                RowBox[{"expr", ",", 
                 RowBox[{"Except", "[", 
                  RowBox[{"slist", "|", "indexed"}], "]"}]}], "]"}], "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"l_slist", "\[RuleDelayed]", 
                  RowBox[{"l", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"indexed", "[", "l_", "]"}], "\[RuleDelayed]", 
                  RowBox[{
                   RowBox[{"Inactive", "[", "Compile`GetElement", "]"}], "[", 
                   RowBox[{"l", ",", "i"}], "]"}]}]}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "nd"}], "}"}]}], "]"}]}], ")"}]}]}]}], "/.", 
       RowBox[{
        RowBox[{"eval", "@", "expr_"}], "\[RuleDelayed]", 
        RowBox[{"RuleCondition", "[", 
         RowBox[{"Activate", "[", 
          RowBox[{"expr", "/.", 
           RowBox[{"slist", "\[Rule]", "List"}]}], "]"}], "]"}]}]}]}], "]"}], 
    "//", "Activate"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8907148978688216`*^9, 3.890714898931299*^9}, {
  3.8910185630697727`*^9, 3.8910185650759544`*^9}},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->"In[74]:=",ExpressionUUID->"c0481e96-de9b-4b81-92c2-b7f086453260"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Specifying the experiments", "Title",
 CellChangeTimes->{{3.8876174764645414`*^9, 3.887617482214775*^9}, 
   3.903805898537039*^9},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"bd147158-f526-489d-afb7-12c825eddce3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Parent", " ", "directory"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NotebookDirectory", "[", "]"}], "//", "ParentDirectory"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AcceptanceDirectory", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Acceptances\>\""}], 
     "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExperimentDirectoriesList", "=", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"FileNames", "[", 
       RowBox[{"\"\<*\>\"", ",", "AcceptanceDirectory", ",", "1"}], "]"}], 
      ",", "DirectoryQ"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"List", " ", "of", " ", "available", " ", "experiments", " ", 
    RowBox[{"(", 
     RowBox[{
     "for", " ", "which", " ", "the", " ", "geometry", " ", "has", " ", 
      "been", " ", "implemented"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentsListTemp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"FileNameTake", "[", 
      RowBox[{
       RowBox[{"ExperimentDirectoriesList", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"-", "1"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "ExperimentDirectoriesList", "]"}], ",", "1"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentsListTemp2", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Partition", "[", 
      RowBox[{"ExperimentsListTemp", ",", "1"}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"TrueQ", "@", 
         RowBox[{"FileExistsQ", "@", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"NotebookDirectory", "[", "]"}], ",", 
             "\"\<Acceptances\>\"", ",", 
             RowBox[{"ExperimentsListTemp", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"ToString", "@", 
              RowBox[{"StringForm", "[", 
               RowBox[{"\"\<Acceptance_``_for_ALP-fermion.m\>\"", ",", 
                RowBox[{"ExperimentsListTemp", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], "}"}], 
           "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "ExperimentsListTemp", "]"}]}], "}"}]}], 
      "]"}], ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ExperimentsList", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{"ExperimentsListTemp2", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "True"}], "&"}]}], "]"}],
     "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", 
   "Sort"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", "ExperimentsList", "]"}], "\[Equal]", "0"}], ",", 
   RowBox[{
   "Print", "[", 
    "\"\<No experiment is available, generate first the acceptance for the \
given experiment using module 1\>\"", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Selected experiments:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"SelectedExperimentList", "=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "ExperimentsList", "]"}], "\[NotEqual]", "0"}], 
    ",", 
    RowBox[{"selectionDialog", "[", 
     RowBox[{"ExperimentsList", ",", "\"\<Select the experiments:\>\""}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"icounter", "=", "1"}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8851403254718485`*^9, 3.8851403429411273`*^9}, {
   3.8854395484478483`*^9, 3.885439559226637*^9}, {3.8854397351242537`*^9, 
   3.885439739219259*^9}, {3.8858794196350574`*^9, 3.885879423032172*^9}, 
   3.886141121558817*^9, {3.8876173384285884`*^9, 3.8876173431379876`*^9}, 
   3.8879528512136784`*^9, 3.888910953061735*^9, {3.8889918645451765`*^9, 
   3.888991864973507*^9}, {3.8902889299209604`*^9, 3.890288929973218*^9}, {
   3.892132996360413*^9, 3.8921329963973475`*^9}, {3.8922734872098565`*^9, 
   3.892273493459851*^9}, 3.89323426738691*^9, {3.893234348855938*^9, 
   3.89323434901425*^9}, 3.893348200726568*^9, 3.902557307526181*^9, {
   3.902762608567563*^9, 3.902762613326627*^9}, 3.9037911191735964`*^9, {
   3.9037911899337234`*^9, 3.903791190104163*^9}, {3.905231719911791*^9, 
   3.9052317257412796`*^9}},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->"In[76]:=",ExpressionUUID->"c05031d8-0efd-4502-a294-675e6231eb7c"],

Cell[CellGroupData[{

Cell["Running block for next sections", "Chapter",
 CellChangeTimes->{{3.902729140157612*^9, 3.90272914444062*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"f6b19458-661d-4b9a-84b2-be5f3bbf270c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BlockEvaluation", "[", "tag_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nb", "=", 
      RowBox[{"EvaluationNotebook", "[", "]"}]}], ";", "\n", 
     RowBox[{"NotebookFind", "[", 
      RowBox[{"nb", ",", "tag", ",", "All", ",", "CellTags"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"tagselected", "==", "\"\<Number-of-events\>\""}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
      "BlockEvaluation", "[", "\"\<Number-of-events-computation\>\"", "]"}], 
      ";"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"icounter", ",", "1", ",", 
       RowBox[{"Length", "[", "SelectedExperimentList", "]"}], ",", "1"}], 
      "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"tagselected", "==", "\"\<Acceptance\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
        "BlockEvaluation", "[", "\"\<Acceptance-computation\>\"", "]"}], 
        ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"icounter", ",", "1", ",", 
         RowBox[{"Length", "[", "SelectedExperimentList", "]"}], ",", "1"}], 
        "}"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.9027291581950865`*^9, 3.902729215695462*^9}, {
   3.902761777481885*^9, 3.902761802513644*^9}, {3.9037911874337673`*^9, 
   3.9037911876837664`*^9}, 3.903803493616716*^9},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->"In[87]:=",ExpressionUUID->"4c060b6c-ecc3-4469-86c0-269c265b419b"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Number of events", "Title",
 CellChangeTimes->{{3.885140281753849*^9, 3.8851402836781845`*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"3e9a02fd-97c3-44ee-9f5b-\
9ca3983b66da"],

Cell[CellGroupData[{

Cell["Cross-sections, acceptances", "Chapter",
 CellChangeTimes->{{3.8876175155563755`*^9, 3.8876175192967377`*^9}, {
  3.8946372037023845`*^9, 3.8946372090126057`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"4cb86986-b7a3-4409-91ed-\
f7461f351ed0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SelectedExperiment", "=", 
   RowBox[{"SelectedExperimentList", "[", 
    RowBox[{"[", 
     RowBox[{"icounter", "++"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dataAcceptances", "=", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<Acceptances\>\"", ",", "SelectedExperiment", ",", 
           RowBox[{"ToString", "@", 
            RowBox[{"StringForm", "[", 
             RowBox[{
             "\"\<Acceptance_``_for_ALP-fermion.m\>\"", ",", 
              "SelectedExperiment"}], "]"}]}]}], "}"}], "]"}], "}"}], "]"}], 
      ",", "\"\<MX\>\""}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FacilityGivenExperiment", "=", 
   RowBox[{"dataAcceptances", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ECALoption", "=", 
   RowBox[{"dataAcceptances", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullAcceptanceData0", "=", 
   RowBox[{"dataAcceptances", "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BrVisTemp", "[", "mFIP_", "]"}], "=", 
   RowBox[{"dataAcceptances", "[", 
    RowBox[{"[", "5", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlistBr", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"Table", "[", 
     RowBox[{"m", ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0.02", ",", "5.1", ",", "0.005"}], "}"}]}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BrVis", "[", "mFIP_", "]"}], "=", 
    RowBox[{
     RowBox[{"Interpolation", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"mFIP", ",", 
           RowBox[{"BrVisTemp", "[", "mFIP", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"mFIP", ",", "mlistBr"}], "}"}]}], "]"}], ",", 
       RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", "mFIP", 
     "]"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{"LogLogPlot", "[", 
  RowBox[{
   RowBox[{"BrVis", "[", "mFIP", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"mFIP", ",", "0.02", ",", "10"}], "}"}], ",", 
   RowBox[{"Frame", "->", "True"}], ",", 
   RowBox[{"ImageSize", "->", "Large"}], ",", 
   RowBox[{"FrameStyle", "\[Rule]", 
    RowBox[{"Directive", "[", 
     RowBox[{"Black", ",", " ", "22"}], "]"}]}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Blue"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
        RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
        RowBox[{"Darker", "@", 
         RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Black"}], "}"}]}], 
     "}"}]}], ",", 
   RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"MinMax", "[", "mlistBr", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.01", ",", "1.2"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<m [GeV]\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(Br\), \(vis\)]\)\>\""}], "}"}]}], ",", 
   RowBox[{"PlotLabel", "\[Rule]", " ", 
    RowBox[{"Style", "[", 
     RowBox[{
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<For \>\"", ",", "SelectedExperiment"}], "}"}], "]"}], 
      ",", " ", "20", ",", " ", "Black"}], "]"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Theta]minExpAll", ",", "\[Theta]maxExpAll"}], "}"}], "=", 
   RowBox[{"MinMax", "[", 
    RowBox[{"FullAcceptanceData0", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Theta]minExp", ",", "\[Theta]maxExp"}], "}"}], "=", 
   RowBox[{"MinMax", "[", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"FullAcceptanceData0", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "6", "]"}], "]"}], "\[NotEqual]", "0"}], "&"}]}], 
      "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"zminExp", ",", "zmaxExp"}], "}"}], "=", 
   RowBox[{"MinMax", "[", 
    RowBox[{"FullAcceptanceData0", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AzimuthalAcceptanceData", "=", 
    RowBox[{
     RowBox[{"DeleteDuplicatesBy", "[", 
      RowBox[{"FullAcceptanceData0", ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "&"}]}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "4", ",", "5"}], "}"}]}], "]"}], "]"}]}], ";"}], "//",
   "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]Grid", "=", 
   RowBox[{"DeleteDuplicates", "[", 
    RowBox[{"AzimuthalAcceptanceData", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zminmax\[Theta]data", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"MinMax", "[", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"AzimuthalAcceptanceData", ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "==", 
            RowBox[{"\[Theta]Grid", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "&&", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "\[NotEqual]", "0"}]}], "&"}]}], 
        "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "\[Theta]Grid", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zmin\[Theta]", "[", "\[Theta]a_", "]"}], "=", 
   RowBox[{
    RowBox[{"Interpolation", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{"\[Theta]Grid", ",", "1"}], "]"}], ",", 
        RowBox[{"zminmax\[Theta]data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", "1", "}"}]}], "]"}], "]"}], ",", "2"}], "]"}], ",", 
      RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
    "\[Theta]a", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zmax\[Theta]", "[", "\[Theta]a_", "]"}], "=", 
   RowBox[{
    RowBox[{"Interpolation", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{"\[Theta]Grid", ",", "1"}], "]"}], ",", 
        RowBox[{"zminmax\[Theta]data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}], "]"}], ",", "2"}], "]"}], ",", 
      RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
    "\[Theta]a", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AzimuthalAcceptanceALPfermion", "[", 
   RowBox[{"\[Theta]a_", ",", "za_"}], "]"}], "=", 
  RowBox[{
   RowBox[{"Interpolation", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"#", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}], "/@", 
      "AzimuthalAcceptanceData"}], ",", 
     RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
   RowBox[{"\[Theta]a", ",", "za"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DecAccDataLogarithmizedComp", "=", 
   RowBox[{
    RowBox[{"Hold", "@", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"FullAcceptanceData", ",", "_Real", ",", "2"}], "}"}], "}"}],
        ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Log10", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
           RowBox[{"Log10", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
           RowBox[{"Log10", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
           RowBox[{"Log10", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "6", "]"}], "]"}], ">", "0."}], ",", 
             RowBox[{"Log10", "[", 
              RowBox[{"#", "[", 
               RowBox[{"[", "6", "]"}], "]"}], "]"}], ",", 
             RowBox[{"-", "90."}]}], "]"}]}], "}"}], "&"}], "/@", 
        "FullAcceptanceData"}]}], "]"}]}], "//", "ReleaseHold"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"DecayAcceptanceALPfermion", "[", 
      RowBox[{"ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "za_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"BrVis", "[", "ma", "]"}], "*", 
      RowBox[{"10", "^", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{
           RowBox[{
           "DecAccDataLogarithmizedComp", "[", "FullAcceptanceData0", "]"}], 
           ",", 
           RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
         RowBox[{
          RowBox[{"Log10", "[", "ma", "]"}], ",", 
          RowBox[{"Log10", "[", "\[Theta]a", "]"}], ",", 
          RowBox[{"Log10", "[", "Ea", "]"}], ",", 
          RowBox[{"Log10", "[", "za", "]"}]}], "]"}], ")"}]}]}]}], ";"}], "//",
    "AbsoluteTiming"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Interpolation", " ", "for", " ", "the", " ", "full", " ", "acceptance"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"acccomp", "=", 
    RowBox[{
     RowBox[{"Hold", "@", 
      RowBox[{"Compile", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"data", ",", "_Real", ",", "2"}], "}"}], "}"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Log10", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
            RowBox[{"Log10", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
            RowBox[{"Log10", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
            RowBox[{"Log10", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "4", "]"}], "]"}], "]"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "5", "]"}], "]"}], "*", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "6", "]"}], "]"}]}], "\[Equal]", "0"}], ",", 
              RowBox[{"-", "90"}], ",", 
              RowBox[{"Log10", "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "5", "]"}], "]"}], "*", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "6", "]"}], "]"}]}], "]"}]}], "]"}]}], "}"}], 
          "&"}], "/@", 
         RowBox[{"SortBy", "[", 
          RowBox[{"data", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "&"}]}], "]"}]}]}], 
       "]"}]}], "//", "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Interpolation", " ", "for", " ", "the", " ", "full", " ", "acceptance"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FullAcceptanceData", "=", 
    RowBox[{"acccomp", "[", "FullAcceptanceData0", "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FullAcceptanceALPfermion", "[", 
     RowBox[{"ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "za_"}], "]"}], "=", 
    RowBox[{"10", "^", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Interpolation", "[", 
        RowBox[{"FullAcceptanceData", ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
       RowBox[{
        RowBox[{"Log10", "[", "ma", "]"}], ",", 
        RowBox[{"Log10", "[", "\[Theta]a", "]"}], ",", 
        RowBox[{"Log10", "[", "Ea", "]"}], ",", 
        RowBox[{"Log10", "[", "za", "]"}]}], "]"}], ")"}]}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CrossSectionData", "=", 
   RowBox[{
    RowBox[{"dataAcceptances", "[", 
     RowBox[{"[", "4", "]"}], "]"}], "//", "Transpose"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NpotGivenExperiment", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"CrossSectionData", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<Npot\>\""}], 
         "&"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "//", "N"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Chi]prod", "[", "\"\<B\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"CrossSectionData", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<Pb\>\""}], "&"}]}],
       "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "\[Chi]prod", "[", "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", 
    "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"CrossSectionData", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<PPi0\>\""}], 
        "&"}]}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Chi]prod", "[", "\"\<\[Eta]\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"CrossSectionData", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<PEta\>\""}], 
        "&"}]}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Chi]prod", "[", "\"\<\[Eta]'\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"CrossSectionData", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<PEtapr\>\""}], 
        "&"}]}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AtargetVal", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"CrossSectionData", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<Atarget\>\""}], 
        "&"}]}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(\[Chi]\), \(b\\\ or\\\ \*OverscriptBox[\(b\), \
\(_\)]\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(\[Chi]\), SuperscriptBox[\(\[Pi]\), \
\(0\)]]\)\>\"", ",", "\"\<\!\(\*SubscriptBox[\(\[Chi]\), \(\[Eta]\)]\)\>\"", 
       ",", "\"\<\!\(\*SubscriptBox[\(\[Chi]\), \(\[Eta]'\)]\)\>\""}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Chi]prod", "[", "\"\<B\>\"", "]"}], ",", 
       RowBox[{
       "\[Chi]prod", "[", "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", 
        "]"}], ",", 
       RowBox[{"\[Chi]prod", "[", "\"\<\[Eta]\>\"", "]"}], ",", 
       RowBox[{"\[Chi]prod", "[", "\"\<\[Eta]'\>\"", "]"}]}], "}"}]}], "}"}], 
   "//", "TableForm"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"infoDialog", "[", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{
      "\"\<The number of proton collisions is \>\"", ",", " ", 
       "NpotGivenExperiment", ",", 
       "\"\<. You may change it at the stage of computing the sensitivities\>\
\""}], "}"}], "]"}], "]"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{
   "\"\<Search for ALPs coupled to fermions at \>\"", ",", " ", 
    "SelectedExperiment", ",", " ", "\"\< located at \>\"", ",", 
    "FacilityGivenExperiment", ",", 
    "\"\<. \!\(\*SubscriptBox[\(N\), \(collisions\)]\) = \>\"", ",", 
    "NpotGivenExperiment"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\"\<Quantity\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(min\)]\), rad\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(max\)]\), rad\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(min\)]\)(\!\(\*SubscriptBox[\(\
\[Epsilon]\), \(dec\)]\)), rad\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(max\)]\)(\!\(\*SubscriptBox[\(\
\[Epsilon]\), \(dec\)]\)), rad\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(z\), \(min\)]\), m\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(z\), \(max\)]\), m\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Description\>\"", ",", "\"\<Min angle covered by experiment\>\"", 
      ",", "\"\<Max angle covered by experiment\>\"", ",", 
      "\"\<Min angle where \!\(\*SubscriptBox[\(\[Epsilon]\), \(decay\)]\)\
\[NotEqual]0\>\"", ",", 
      "\"\<Max angle where \!\(\*SubscriptBox[\(\[Epsilon]\), \(decay\)]\)\
\[NotEqual]0\>\"", ",", "\"\<Min long. displacement of the decay volume\>\"", 
      ",", "\"\<Max long. displacement of the decay volume\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Value\>\"", ",", "\[Theta]minExpAll", ",", "\[Theta]maxExpAll", ",",
       "\[Theta]minExp", ",", "\[Theta]maxExp", ",", "zminExp", ",", 
      "zmaxExp"}], "}"}]}], "}"}], "//", "TableForm"}]}], "Input",
 CellChangeTimes->{{3.887616632812935*^9, 3.8876168497686005`*^9}, {
   3.8876169572233744`*^9, 3.8876169847184906`*^9}, {3.887617065527506*^9, 
   3.887617076894349*^9}, 3.8876171069556227`*^9, {3.8876171406331663`*^9, 
   3.8876171534880905`*^9}, 3.8876171853380766`*^9, {3.8876172773004613`*^9, 
   3.8876172910033817`*^9}, {3.887617348810663*^9, 3.887617349563163*^9}, {
   3.887617380771906*^9, 3.887617387749444*^9}, {3.887954851237727*^9, 
   3.887954882480399*^9}, {3.888910969072772*^9, 3.8889109863023443`*^9}, {
   3.8897697592296686`*^9, 3.889769783989515*^9}, {3.8902889949311543`*^9, 
   3.8902890054797287`*^9}, {3.890289046677289*^9, 3.890289091235558*^9}, {
   3.890289310042413*^9, 3.890289348842971*^9}, {3.8921325536562467`*^9, 
   3.8921327449707036`*^9}, {3.8921327781536665`*^9, 3.89213297677147*^9}, {
   3.892133046488756*^9, 3.8921330543237505`*^9}, {3.8921359392522163`*^9, 
   3.892135940765498*^9}, 3.892136039490557*^9, {3.892136892048996*^9, 
   3.892136892680512*^9}, {3.8921370374571185`*^9, 3.892137038158225*^9}, 
   3.893348204595518*^9, {3.894178873045617*^9, 3.89417888661617*^9}, {
   3.89463720120516*^9, 3.8946372014907866`*^9}, {3.8950529552788453`*^9, 
   3.895052958705437*^9}, {3.899198460033712*^9, 3.8991984775370417`*^9}, {
   3.902762641227653*^9, 3.9027626417289543`*^9}, {3.9027638647415314`*^9, 
   3.9027638672989907`*^9}, {3.903791118063882*^9, 3.9037911180785627`*^9}, {
   3.9038058586140475`*^9, 3.9038058750916357`*^9}, {3.904889549715294*^9, 
   3.9048895680170975`*^9}, {3.9049015890518956`*^9, 3.9049015949499874`*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->"In[89]:=",ExpressionUUID->"5e37716e-c5ef-4959-a8f2-3412a62b2217"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Angle-energy distributions for the given experiment", "Chapter",
 CellChangeTimes->{{3.885020702966837*^9, 3.885020711525731*^9}, {
   3.8850216924759345`*^9, 3.8850216984444695`*^9}, {3.8851404110391607`*^9, 
   3.8851404117847*^9}, 3.8859669420079484`*^9, {3.8876173662884827`*^9, 
   3.8876173699611483`*^9}, {3.896334866051643*^9, 3.896334870004681*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"9c0a6fa2-083d-438f-84cb-\
5fa122f734c4"],

Cell[CellGroupData[{

Cell["ALP distributions", "Section",
 CellChangeTimes->{{3.8850207275443482`*^9, 3.885020730624566*^9}, 
   3.8850217020674453`*^9, {3.8851404135605536`*^9, 3.8851404142703238`*^9}, 
   3.885966942012986*^9},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"272bdbd8-414b-4e3f-abc9-\
1cfc79f82795"],

Cell[BoxData[{
 RowBox[{"ALPDistributionFileNames", ":=", 
  RowBox[{"Association", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<SPS\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<DoubleDistr-ALPfermions-From-B-SPS.dat\>\"", ",", 
        "\"\<DoubleDistr-ALPfermion-mixing-from-Pi0-SPS.dat\>\"", ",", 
        "\"\<DoubleDistr-ALPfermion-mixing-from-Eta-SPS.dat\>\"", ",", 
        "\"\<DoubleDistr-ALPfermion-mixing-from-EtaPr-SPS.dat\>\""}], "}"}]}],
      ",", 
     RowBox[{"\"\<LHC\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<DoubleDistr-ALPfermions-From-B-LHC.dat\>\"", ",", 
        "\"\<DoubleDistr-ALPfermion-mixing-from-Pi0-LHC.dat\>\"", ",", 
        "\"\<DoubleDistr-ALPfermion-mixing-from-Eta-LHC.dat\>\"", ",", 
        "\"\<DoubleDistr-ALPfermion-mixing-from-EtaPr-LHC.dat\>\""}], "}"}]}],
      ",", 
     RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<DoubleDistr-ALPfermions-From-B-FCC-hh.dat\>\"", ",", 
        "\"\<DoubleDistr-ALPfermion-mixing-from-Pi0-FCC-hh.dat\>\"", ",", 
        "\"\<DoubleDistr-ALPfermion-mixing-from-Eta-FCC-hh.dat\>\"", ",", 
        "\"\<DoubleDistr-ALPfermion-mixing-from-EtaPr-FCC-hh.dat\>\""}], 
       "}"}]}], ",", 
     RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<DoubleDistr-ALPfermions-From-B-FermilabBD.dat\>\"", ",", 
        "\"\<DoubleDistr-ALPfermion-mixing-from-Pi0-FermilabBD.dat\>\"", ",", 
        "\"\<DoubleDistr-ALPfermion-mixing-from-Eta-FermilabBD.dat\>\"", ",", 
        "\"\<DoubleDistr-ALPfermion-mixing-from-EtaPr-FermilabBD.dat\>\""}], 
       "}"}]}]}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ALPDistributionFileNamesGivenExp", "=", 
   RowBox[{
   "ALPDistributionFileNames", "[", "FacilityGivenExperiment", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"!", 
      RowBox[{"TrueQ", "@", 
       RowBox[{"FileExistsQ", "@", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<spectra/New physics particles spectra/ALPs with fermion \
coupling/\>\"", ",", 
           RowBox[{"ALPDistributionFileNamesGivenExp", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "}"}], "]"}]}]}]}], ",", 
     RowBox[{"Print", "[", 
      RowBox[{
       RowBox[{"ALPDistributionFileNamesGivenExp", "[", 
        RowBox[{"[", "j", "]"}], "]"}], ",", 
       "\"\< does not exist Generate it using module 2!\>\""}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "1", ",", 
     RowBox[{"Length", "[", "ALPDistributionFileNamesGivenExp", "]"}], ",", 
     "1"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "j", "]"}]}], "Input",
 CellChangeTimes->{
  3.88502354836834*^9, {3.8850295938036337`*^9, 3.885029595916194*^9}, {
   3.8851404366578946`*^9, 3.8851404845456142`*^9}, {3.885438338435359*^9, 
   3.8854384585798616`*^9}, 3.8855484092677927`*^9, {3.8859669420224924`*^9, 
   3.885966942043624*^9}, {3.885967092081048*^9, 3.8859671770851784`*^9}, {
   3.8935209191830187`*^9, 3.8935209191870174`*^9}, {3.903791118103599*^9, 
   3.903791118133996*^9}, {3.90379318307411*^9, 3.903793200573433*^9}, {
   3.9037934176453876`*^9, 3.9037934282766066`*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[122]:=",ExpressionUUID->"c2e1f390-8eeb-4f4b-823d-659fa5eaeb0e"],

Cell[CellGroupData[{

Cell["Importing distributions", "Subsection",
 CellChangeTimes->{{3.885021707174692*^9, 3.8850217096287813`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"888f7dff-ab99-41c0-b897-\
159b52ae3fe1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dataDistr", "[", "filename_", "]"}], ":=", 
  RowBox[{"Import", "[", 
   RowBox[{
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", 
       "\"\<spectra/New physics particles spectra/ALPs with fermion coupling/\
\>\"", ",", "filename"}], "}"}], "]"}], ",", "\"\<Table\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Chi]Xtimes\[Chi]XtoALPfermion", "[", 
      RowBox[{"ma_", ",", "y_", ",", "\"\<B\>\""}], "]"}], ",", 
     RowBox[{"\[Chi]Xtimes\[Chi]XtoALPfermion", "[", 
      RowBox[{
      "ma_", ",", "y_", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\""}], "]"}], ",", 
     RowBox[{"\[Chi]Xtimes\[Chi]XtoALPfermion", "[", 
      RowBox[{"ma_", ",", "y_", ",", "\"\<\[Eta]\>\""}], "]"}], ",", 
     RowBox[{"\[Chi]Xtimes\[Chi]XtoALPfermion", "[", 
      RowBox[{"ma_", ",", "y_", ",", "\"\<\[Eta]'\>\""}], "]"}]}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Chi]prod", "[", "\"\<B\>\"", "]"}], "*", 
      RowBox[{"pBtoALPfacility", "[", 
       RowBox[{"ma", ",", "y", ",", "FacilityGivenExperiment"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{
      "\[Chi]prod", "[", "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", 
       "]"}], "*", 
      RowBox[{"\[Theta]am02", "[", 
       RowBox[{
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", "ma", ",", 
        "y"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"\[Chi]prod", "[", "\"\<\[Eta]\>\"", "]"}], "*", 
      RowBox[{"\[Theta]am02", "[", 
       RowBox[{"\"\<\[Eta]\>\"", ",", "ma", ",", "y"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"\[Chi]prod", "[", "\"\<\[Eta]'\>\"", "]"}], "*", 
      RowBox[{"\[Theta]am02", "[", 
       RowBox[{"\"\<\[Eta]'\>\"", ",", "ma", ",", "y"}], "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DataDistrALPfermion", "[", "\"\<B\>\"", "]"}], ",", 
      RowBox[{
      "DataDistrALPfermion", "[", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", "]"}], ",", 
      RowBox[{"DataDistrALPfermion", "[", "\"\<\[Eta]\>\"", "]"}], ",", 
      RowBox[{"DataDistrALPfermion", "[", "\"\<\[Eta]'\>\"", "]"}]}], "}"}], 
    "=", 
    RowBox[{
     RowBox[{
      RowBox[{"dataDistr", "[", 
       RowBox[{"ALPDistributionFileNamesGivenExp", "[", 
        RowBox[{"[", "#", "]"}], "]"}], "]"}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductionList", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"alpfermionselection", "==", "\"\<Revised\>\""}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<B\>\"", ",", "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", 
       ",", "\"\<\[Eta]\>\"", ",", "\"\<\[Eta]'\>\""}], "}"}], ",", 
     RowBox[{"{", "\"\<B\>\"", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ExportList", ":=", 
  RowBox[{"Association", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
     "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", "->", 
      "\"\<Pi0\>\""}], ",", 
     RowBox[{"\"\<\[Eta]\>\"", "->", "\"\<Eta\>\""}], ",", 
     RowBox[{"\"\<\[Eta]'\>\"", "->", "\"\<Etapr\>\""}], ",", 
     RowBox[{"\"\<B\>\"", "->", "\"\<B\>\""}], ",", 
     RowBox[{"\"\<Drell-Yan\>\"", "->", " ", "\"\<Drell-Yan\>\""}]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"FacilityGivenExperiment", "\[NotEqual]", "\"\<FCC-hh\>\""}], "&&", 
    RowBox[{"alpfermionselection", "==", "\"\<Revised\>\""}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ProductionList", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"ProductionList", ",", 
       RowBox[{"{", "\"\<Drell-Yan\>\"", "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Chi]Xtimes\[Chi]XtoALPfermion", "[", 
      RowBox[{"ma_", ",", "y_", ",", "\"\<Drell-Yan\>\""}], "]"}], "=", 
     RowBox[{"PDrellYanFacility", "[", 
      RowBox[{
      "ma", ",", "y", ",", "AtargetVal", ",", "FacilityGivenExperiment"}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DataDistrALPfermion", "[", "\"\<Drell-Yan\>\"", "]"}], "=", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"Import", "[", 
        RowBox[{
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], ",", 
            "\"\<spectra/New physics particles spectra/ALPs with gluon \
coupling/Pregenerated/\>\"", ",", 
            RowBox[{"ToString", "@", 
             RowBox[{"StringForm", "[", 
              RowBox[{"\"\<DoubleDistrALPsGluonDrellYan-``.txt\>\"", ",", 
               RowBox[{"Sequence", "@@", 
                RowBox[{"{", "FacilityGivenExperiment", "}"}]}]}], "]"}]}]}], 
           "}"}], "]"}], ",", "\"\<Table\>\""}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ">", "1.2"}], "&"}]}], "]"}]}], 
    ";"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mmin\[Epsilon]Dec", "=", 
   RowBox[{
    RowBox[{"10", "^", 
     RowBox[{"FullAcceptanceData", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "//", "Min"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"DoubleDistrALPfermion", "[", 
       RowBox[{"ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "prod"}], "]"}], 
      "=", 
      RowBox[{"10", "^", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Log10", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
               RowBox[{"Log10", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
               RowBox[{"Log10", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
               RowBox[{"Log10", "[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "4", "]"}], "]"}], "+", 
                 SuperscriptBox["10", 
                  RowBox[{"-", "80"}]]}], "]"}]}], "}"}], "&"}], "/@", 
            RowBox[{"DataDistrALPfermion", "[", "prod", "]"}]}], ",", 
           RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
         RowBox[{
          RowBox[{"Log10", "[", "ma", "]"}], ",", 
          RowBox[{"Log10", "[", "\[Theta]a", "]"}], ",", 
          RowBox[{"Log10", "[", "Ea", "]"}]}], "]"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mlistALPfermionTemp", "=", 
      RowBox[{"DeleteDuplicates", "[", 
       RowBox[{
        RowBox[{"DataDistrALPfermion", "[", "prod", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mlistALPfermionTemp1", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"mmin\[Epsilon]Dec", ">", 
         RowBox[{"(", 
          RowBox[{"mlistALPfermionTemp", "//", "Min"}], ")"}]}], ",", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", "mmin\[Epsilon]Dec", "}"}], ",", 
          RowBox[{"Select", "[", 
           RowBox[{"mlistALPfermionTemp", ",", 
            RowBox[{
             RowBox[{"#", ">", 
              RowBox[{"1.001", "mmin\[Epsilon]Dec"}]}], "&"}]}], "]"}]}], 
         "]"}], ",", "mlistALPfermionTemp"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mlistALPfermion", "[", "prod", "]"}], "=", 
      "mlistALPfermionTemp1"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"mamin", "[", "prod", "]"}], ",", 
        RowBox[{"mamax", "[", "prod", "]"}]}], "}"}], "=", 
      RowBox[{"MinMax", "[", 
       RowBox[{"mlistALPfermion", "[", "prod", "]"}], "]"}]}], ";"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{"LogLogPlot", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"\[Chi]Xtimes\[Chi]XtoALPfermion", "[", 
       RowBox[{"ma", ",", "1", ",", "prod"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"ma", ",", "0.1", ",", "3"}], "}"}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"All", ",", "All"}], "}"}]}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"Placed", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"#", ",", "15"}], "]"}], "&"}], "/@", "ProductionList"}], 
      ",", "Right"}], "]"}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DirectoryQ", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<Auxiliary data/ALPs with fermion coupling\>\"", ",", 
           "SelectedExperiment"}], "}"}], "]"}], "]"}], "//", "ToString"}], 
      ")"}], "\[Equal]", "\"\<False\>\""}], ",", 
    RowBox[{"CreateDirectory", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<Auxiliary data/ALPs with fermion coupling\>\"", ",", 
        "SelectedExperiment"}], "}"}], "]"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<Auxiliary data/ALPs with fermion coupling\>\"", ",", 
      "SelectedExperiment", ",", 
      "\"\<Double-Distr-Averaged-ALP-fermion.m\>\""}], "}"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"mamin", "[", "prod", "]"}], "<", "ma", "<", 
          RowBox[{"mamax", "[", "prod", "]"}]}], ",", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"\[Chi]Xtimes\[Chi]XtoALPfermion", "[", 
           RowBox[{"ma", ",", "1", ",", "prod"}], "]"}], "]"}], ",", "0"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ",", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"mamin", "[", "prod", "]"}], "<", "ma", "<", 
            RowBox[{"mamax", "[", "prod", "]"}]}], ",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"\[Chi]Xtimes\[Chi]XtoALPfermion", "[", 
             RowBox[{"ma", ",", "1", ",", "prod"}], "]"}], "]"}], ",", "0"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}]], 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"mamin", "[", "prod", "]"}], "<", "ma", "<", 
           RowBox[{"mamax", "[", "prod", "]"}]}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"\[Chi]Xtimes\[Chi]XtoALPfermion", "[", 
             RowBox[{"ma", ",", "1", ",", "prod"}], "]"}], "*", 
            RowBox[{"DoubleDistrALPfermion", "[", 
             RowBox[{"ma", ",", "\[Theta]a", ",", "Ea", ",", "prod"}], 
             "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}]}]}], "}"}], 
   ",", "\"\<MX\>\""}], "]"}]}], "Input",
 CellChangeTimes->{{3.885439467061742*^9, 3.885439478554178*^9}, {
   3.8854395866810803`*^9, 3.885439721624913*^9}, {3.885439773115856*^9, 
   3.8854397786227837`*^9}, {3.885439884692011*^9, 3.88544004900488*^9}, {
   3.885449061634671*^9, 3.885449079115692*^9}, {3.88544918407437*^9, 
   3.885449194723466*^9}, {3.8854505516411715`*^9, 3.8854505530614524`*^9}, {
   3.885452711851215*^9, 3.88545272923171*^9}, {3.8854527922834806`*^9, 
   3.885452792400185*^9}, 3.885548406217807*^9, {3.885966843748063*^9, 
   3.885966843785842*^9}, {3.885966881939496*^9, 3.885966906554226*^9}, {
   3.8859669420541277`*^9, 3.8859669420541277`*^9}, {3.885967189589274*^9, 
   3.8859672043427315`*^9}, {3.8859681297543335`*^9, 
   3.8859681297543335`*^9}, {3.885968191733053*^9, 3.8859682100948997`*^9}, {
   3.885968249759838*^9, 3.8859682619809675`*^9}, {3.8859684700618005`*^9, 
   3.8859685816577706`*^9}, {3.885968625078349*^9, 3.885968980265416*^9}, {
   3.8859700540768647`*^9, 3.88597005728553*^9}, {3.88597035780177*^9, 
   3.885970358115872*^9}, {3.8859720936753244`*^9, 3.885972140252653*^9}, {
   3.8859735806451674`*^9, 3.8859736018350296`*^9}, {3.8859736329468355`*^9, 
   3.8859736499303026`*^9}, {3.8866939599759817`*^9, 3.886693960132989*^9}, {
   3.88891417929208*^9, 3.8889141815198326`*^9}, {3.8902891367205744`*^9, 
   3.890289161969797*^9}, {3.8902892579513407`*^9, 3.890289263325519*^9}, {
   3.892136002721193*^9, 3.892136028261282*^9}, {3.892136070977207*^9, 
   3.892136203242567*^9}, {3.8921362338846245`*^9, 3.892136460511897*^9}, {
   3.892137416022106*^9, 3.8921374188002872`*^9}, {3.892137726252984*^9, 
   3.8921377414045053`*^9}, {3.892137779068042*^9, 3.892137796631941*^9}, {
   3.892137905157999*^9, 3.89213794848816*^9}, {3.8927068135594764`*^9, 
   3.8927070532732463`*^9}, {3.8927071084582105`*^9, 3.892707108969979*^9}, {
   3.8927076317679253`*^9, 3.892707731477847*^9}, {3.8927077688365555`*^9, 
   3.892707844376734*^9}, {3.8927078974109135`*^9, 3.892707982287819*^9}, {
   3.8934971285157847`*^9, 3.8934971287833996`*^9}, {3.8934972371246815`*^9, 
   3.8934972613021517`*^9}, {3.893497376405422*^9, 3.893497403834486*^9}, {
   3.893497436455064*^9, 3.893497637306222*^9}, {3.8934978526172023`*^9, 
   3.8934978765309143`*^9}, {3.8934979317022295`*^9, 3.893497953966854*^9}, 
   3.893520919199011*^9, {3.8937451106529083`*^9, 3.893745110982256*^9}, {
   3.894178906365926*^9, 3.89417890691463*^9}, {3.8951276469335113`*^9, 
   3.895127647570271*^9}, {3.8972335583074894`*^9, 3.8972335635367355`*^9}, 
   3.9025625827531595`*^9, {3.9025626209730835`*^9, 3.902562620976071*^9}, {
   3.9027273387454753`*^9, 3.902727400623392*^9}, {3.9028488604584303`*^9, 
   3.902848864428564*^9}, {3.9028566549381557`*^9, 3.9028566582381334`*^9}, {
   3.902887663043301*^9, 3.9028876796771946`*^9}, {3.9037896735372953`*^9, 
   3.9037896735752788`*^9}, {3.903790316334838*^9, 3.9037903275846663`*^9}, {
   3.9037911181439123`*^9, 3.9037911182535105`*^9}, {3.903793446452463*^9, 
   3.90379351833288*^9}, {3.9037951967988997`*^9, 3.9037952033026886`*^9}, {
   3.9049212188799915`*^9, 3.9049212458631067`*^9}, {3.9052321024114857`*^9, 
   3.905232140564152*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[126]:=",ExpressionUUID->"89608f05-b91a-4977-9b44-4a2a5451a6ae"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Determining min/max energies of scalars for the given polar angle. Needed for \
stability of Monte-Carlo integration\
\>", "Subsection",
 CellChangeTimes->{{3.8850217140541673`*^9, 3.8850217339343953`*^9}, {
  3.885449618401306*^9, 3.8854496389805627`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"11ae4d55-c8c0-431e-bf80-\
f13a64697e88"],

Cell[CellGroupData[{

Cell["Common definition", "Subsubsection",
 CellChangeTimes->{{3.8851480658530207`*^9, 3.885148069648714*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"634a1178-f388-46bb-8612-\
dee03ec19c49"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"EfromXmax", "[", 
   RowBox[{"mass_", ",", "data_", ",", "LogMin_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "distr", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"datt", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"data", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "mass"}], "&"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"EmaxVal", "=", 
      RowBox[{
       RowBox[{"datt", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "3"}], "]"}], "]"}], "//", "Max"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Theta]list", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"x", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "\[Theta]minExp", ",", "\[Theta]maxExp", ",", 
          FractionBox[
           RowBox[{"(", 
            RowBox[{"\[Theta]maxExp", "-", "\[Theta]minExp"}], ")"}], "5"]}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"distr", "[", 
       RowBox[{"\[Theta]a_", ",", "Ea_"}], "]"}], "=", 
      RowBox[{"Abs", "[", 
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", "3", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "4", "]"}], "]"}], "+", 
                SuperscriptBox["10", 
                 RowBox[{"-", "90"}]]}]}], "}"}], "&"}], "/@", "datt"}], ",", 
           RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
         RowBox[{"\[Theta]a", ",", "Ea"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DoubleDistrIntList", "[", "i_", "]"}], ":=", 
      RowBox[{
       RowBox[{"Interpolation", "[", 
        RowBox[{
         RowBox[{"ParallelTable", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Ea", ",", 
             RowBox[{"Quiet", "[", 
              RowBox[{"NIntegrate", "[", 
               RowBox[{
                RowBox[{"distr", "[", 
                 RowBox[{"\[Theta]a", ",", "Ea"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"\[Theta]a", ",", 
                  RowBox[{"\[Theta]list", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", 
                  RowBox[{"\[Theta]list", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"Method", "\[Rule]", "\"\<AdaptiveMonteCarlo\>\""}]}],
                "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Ea", ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               SuperscriptBox["10", "x"], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{"Log10", "[", 
                  RowBox[{"1.1", "*", "mass"}], "]"}], ",", 
                 RowBox[{"Log10", "[", "EmaxVal", "]"}], ",", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"Log10", "[", "EmaxVal", "]"}], "-", 
                   RowBox[{"Log10", "[", 
                    RowBox[{"1.1", "*", "mass"}], "]"}]}], "50."]}], "}"}]}], 
              "]"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "Ea", 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]adistrlist", "[", "Ea_", "]"}], "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"\[Theta]list", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "+", 
            RowBox[{"\[Theta]list", "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "2"], ",", 
          RowBox[{"DoubleDistrIntList", "[", "i", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{
           RowBox[{"Length", "[", "\[Theta]list", "]"}], "-", "1"}], ",", 
          "1"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Theta]EmaxList", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"\[Theta]adistrlist", "[", "Ea", "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"SortBy", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Ea", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Theta]adistrlist", "[", "Ea", "]"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Ea", ",", "mass", ",", "EmaxVal", ",", "1"}], 
                 "}"}]}], "]"}], ",", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"\[Theta]adistrlist", "[", "Ea", "]"}], "]"}], ",", "1"}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]EmaxListInt", "[", "\[Theta]a_", "]"}], "=", 
      RowBox[{
       RowBox[{"Interpolation", "[", 
        RowBox[{"\[Theta]EmaxList", ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
       "\[Theta]a", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"NormVals", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"\[Theta]adistrlist", "[", "Ea", "]"}], "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", 
           SuperscriptBox["10", 
            RowBox[{"-", "90."}]]}], ",", 
          RowBox[{"{", 
           RowBox[{"Ea", ",", "mass", ",", "EmaxVal"}], "}"}], ",", 
          RowBox[{
          "Method", "\[Rule]", "\"\<InterpolationPointsSubdivision\>\""}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"\[Theta]adistrlist", "[", "Ea", "]"}], "]"}], ",", "1"}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cdf", "[", 
       RowBox[{"es_", ",", "i_"}], "]"}], ":=", 
      RowBox[{"1", "-", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"NormVals", "[", 
          RowBox[{"[", "i", "]"}], "]"}]], 
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"\[Theta]adistrlist", "[", "Ea", "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"Ea", ",", "mass", ",", "es"}], "}"}], ",", 
          RowBox[{
          "Method", "\[Rule]", "\"\<InterpolationPointsSubdivision\>\""}]}], 
         "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cdftab", "[", "Ea_", "]"}], "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"\[Theta]adistrlist", "[", "Ea", "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"Interpolation", "[", 
            RowBox[{
             RowBox[{"ParallelTable", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"10", "^", "es"}], ",", 
                 RowBox[{"Quiet", "[", 
                  RowBox[{"cdf", "[", 
                   RowBox[{
                    RowBox[{"10", "^", "es"}], ",", "i"}], "]"}], "]"}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"es", ",", 
                 RowBox[{"Log10", "[", "mass", "]"}], ",", 
                 RowBox[{"Log10", "[", "EmaxVal", "]"}], ",", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"Log10", "[", "EmaxVal", "]"}], "-", 
                   RowBox[{"Log10", "[", "mass", "]"}]}], "50"]}], "}"}]}], 
              "]"}], ",", 
             RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
           "Ea", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"\[Theta]adistrlist", "[", "Ea", "]"}], "]"}], ",", "1"}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"logmin", "[", "\[Theta]a_", "]"}], "=", "LogMin"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Estart", "[", "\[Theta]a_", "]"}], "=", 
      RowBox[{"Min", "[", 
       RowBox[{
        RowBox[{"2", "*", 
         RowBox[{"\[Theta]EmaxListInt", "[", "\[Theta]a", "]"}]}], ",", 
        RowBox[{"0.9", "*", "EmaxVal"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Emaxv", "[", "i_", "]"}], ":=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"NormVals", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "<", 
         SuperscriptBox["10", 
          RowBox[{"-", "15"}]]}], ",", "mass", ",", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"Ea", "/.", 
           RowBox[{"FindRoot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Log10", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"cdftab", "[", 
                  SuperscriptBox["10", "Ea"], "]"}], "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], "\[Equal]", 
              RowBox[{"logmin", "[", 
               RowBox[{
                RowBox[{"\[Theta]EmaxList", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"Ea", ",", 
               RowBox[{"Log10", "[", 
                RowBox[{"Estart", "[", 
                 RowBox[{
                  RowBox[{"\[Theta]EmaxList", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"Log10", "[", 
                RowBox[{
                 RowBox[{"\[Theta]EmaxList", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
               RowBox[{"Log10", "[", "EmaxVal", "]"}]}], "}"}]}], "]"}]}], 
          ")"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tabtemp", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Theta]EmaxList", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"Emaxv", "[", "i", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "\[Theta]EmaxList", "]"}], ",", "1"}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tab", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"\[Theta]minExp", ",", 
           RowBox[{
            RowBox[{"tabtemp", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "}"}], ",", 
        RowBox[{"Drop", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{"tabtemp", ",", "1"}], "]"}], ",", 
          RowBox[{"-", "1"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"\[Theta]maxExp", ",", 
           RowBox[{
            RowBox[{"tabtemp", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"10", "^", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Log10", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
              RowBox[{"Log10", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
           "tab"}], ",", 
          RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
        RowBox[{"Log10", "[", "\[Theta]a", "]"}], "]"}], ")"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EamaxBlock", "[", 
   RowBox[{"data_", ",", "logmin_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "mlist", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mlist", "=", 
      RowBox[{"Drop", "[", 
       RowBox[{
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"EmaxTemp", "[", 
       RowBox[{"ma_", ",", "\[Theta]a_"}], "]"}], "=", 
      RowBox[{"Max", "[", 
       RowBox[{"ma", ",", 
        RowBox[{"EfromXmax", "[", 
         RowBox[{
          RowBox[{"mlist", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "data", ",", "logmin"}], 
         "]"}], ",", 
        RowBox[{"EfromXmax", "[", 
         RowBox[{
          RowBox[{"mlist", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], ",", "data", ",", "logmin"}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Theta]list", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"x", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "\[Theta]minExp", ",", "\[Theta]maxExp", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Theta]maxExp", "-", "\[Theta]minExp"}], ")"}], "/", 
           "10"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"10", "^", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"Log10", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
              RowBox[{"Log10", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"ma", ",", "\[Theta]a", ",", 
                 RowBox[{"EmaxTemp", "[", 
                  RowBox[{"ma", ",", "\[Theta]a"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"ma", ",", 
                 RowBox[{"mlist", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"mlist", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"mlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"mlist", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", "10"}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"\[Theta]a", ",", "\[Theta]list"}], "}"}]}], "]"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ",", 
          RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
        RowBox[{"ma", ",", 
         RowBox[{"Log10", "[", "\[Theta]a", "]"}]}], "]"}], ")"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Eamax", "[", 
       RowBox[{"ma_", ",", "\[Theta]a_", ",", "prod"}], "]"}], "=", 
      RowBox[{"EamaxBlock", "[", 
       RowBox[{
        RowBox[{"DataDistrALPfermion", "[", "prod", "]"}], ",", 
        RowBox[{"-", "7"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{"LogLogPlot", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Eamax", "[", 
       RowBox[{"1.5", ",", "\[Theta]a", ",", "prod"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Theta]a", ",", "\[Theta]minExp", ",", "\[Theta]maxExp"}], 
    "}"}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"All", ",", "All"}], "}"}]}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"Placed", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"#", ",", "15"}], "]"}], "&"}], "/@", "ProductionList"}], 
      ",", "Right"}], "]"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.885148084467116*^9, 3.885148248479889*^9}, {
   3.8851482989957933`*^9, 3.8851483493083973`*^9}, {3.8851484063554387`*^9, 
   3.8851484068571916`*^9}, {3.8852228484402695`*^9, 
   3.8852228841962533`*^9}, {3.885224401910403*^9, 3.8852244120061765`*^9}, {
   3.885224885137532*^9, 3.885224944143616*^9}, {3.8852249849251437`*^9, 
   3.88522503277181*^9}, {3.8852250820240493`*^9, 3.8852250833651195`*^9}, {
   3.8852255247123723`*^9, 3.8852255362799845`*^9}, {3.8852261807199936`*^9, 
   3.885226182942499*^9}, {3.8852271814880905`*^9, 3.885227195878027*^9}, {
   3.8853542861804843`*^9, 3.885354416029894*^9}, {3.8853544784296722`*^9, 
   3.885354483251371*^9}, {3.885354517144206*^9, 3.885354538902566*^9}, {
   3.885354903942062*^9, 3.8853549049320507`*^9}, {3.8853790449621615`*^9, 
   3.885379047122514*^9}, {3.88537908973895*^9, 3.88537909078761*^9}, {
   3.8853791272449913`*^9, 3.8853791320747995`*^9}, {3.885379220617199*^9, 
   3.8853792208975644`*^9}, {3.885379600558668*^9, 3.885379606494396*^9}, {
   3.8853798728114595`*^9, 3.885379890399393*^9}, {3.8853803814172516`*^9, 
   3.885380383398796*^9}, {3.8853805048204*^9, 3.8853805131399064`*^9}, {
   3.88544831672608*^9, 3.8854484887165213`*^9}, {3.885448535946783*^9, 
   3.8854485812517896`*^9}, {3.885448619241871*^9, 3.885448637306032*^9}, {
   3.885448697726526*^9, 3.885448709541115*^9}, {3.8854487438125606`*^9, 
   3.885448765875434*^9}, {3.885448925652766*^9, 3.8854489264414215`*^9}, {
   3.885449048506912*^9, 3.885449074318219*^9}, {3.885449213197753*^9, 
   3.8854492178649426`*^9}, {3.885449253485854*^9, 3.885449280106469*^9}, {
   3.8854494883928027`*^9, 3.8854494889095163`*^9}, {3.8854497564476986`*^9, 
   3.88544975668421*^9}, {3.885966906569843*^9, 3.885966906695243*^9}, {
   3.8859684700776205`*^9, 3.885968537185751*^9}, {3.8859700817332706`*^9, 
   3.885970174274954*^9}, {3.885970390181278*^9, 3.8859703947566185`*^9}, {
   3.885970477868355*^9, 3.8859704851773577`*^9}, {3.8859705168033495`*^9, 
   3.885970516897041*^9}, {3.885973621088171*^9, 3.8859736275167923`*^9}, {
   3.885975683201931*^9, 3.8859756834663815`*^9}, {3.886567033343726*^9, 
   3.886567057758112*^9}, {3.892136504693529*^9, 3.892136537557208*^9}, {
   3.8956589089250245`*^9, 3.895658909115163*^9}, {3.89723357647534*^9, 
   3.897233576671338*^9}, 3.9037911182835617`*^9},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[137]:=",ExpressionUUID->"b6c14546-6f66-42c6-b926-1e9c5a1be97c"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Number of events", "Chapter",
 CellChangeTimes->{{3.8935731783578434`*^9, 3.893573180246764*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"913a2300-dec2-4b0f-8b44-\
4b75cf0adccf"],

Cell[CellGroupData[{

Cell["Definitions", "Section",
 CellChangeTimes->{{3.897198873663946*^9, 3.8971988750678434`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"b0772e57-8882-4e3d-a1f7-\
c9c6f58dc7ac"],

Cell[CellGroupData[{

Cell["\<\
Grids for the initial data with acceptances and distributions\
\>", "Subsection",
 CellChangeTimes->{{3.897198934328184*^9, 3.89719895293719*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"527871dc-8ba8-4387-abde-\
9e9eb8d8ab6d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Grid", " ", 
     SubscriptBox["m", "S"]}], ",", " ", 
    SubscriptBox["\[Theta]", "S"], ",", " ", 
    SubscriptBox["E", "S"], ",", " ", 
    RowBox[{
     SubscriptBox["z", "S"], " ", "for", " ", "the", " ", "initial", " ", 
     "acceptance", " ", "data"}], ",", " ", "logarithmized"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"InGridm\[Epsilon]", "=", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"FullAcceptanceData", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InGrid\[Theta]\[Epsilon]", "=", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"FullAcceptanceData", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InGridE\[Epsilon]", "=", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"FullAcceptanceData", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InGridz\[Epsilon]", "=", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"FullAcceptanceData", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Array", " ", "of", " ", "values", " ", "of", " ", "the", " ", "initial",
       " ", "acceptance", " ", "data"}], ",", " ", "reshaped"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Epsilon]vals", "=", 
     RowBox[{"ArrayReshape", "[", 
      RowBox[{
       RowBox[{"FullAcceptanceData", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "5"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Length", "[", "InGridm\[Epsilon]", "]"}], ",", 
         RowBox[{"Length", "[", "InGrid\[Theta]\[Epsilon]", "]"}], ",", 
         RowBox[{"Length", "[", "InGridE\[Epsilon]", "]"}], ",", 
         RowBox[{"Length", "[", "InGridz\[Epsilon]", "]"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Epsilon]azValscomp", "=", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"data", ",", "_Real", ",", "2"}], "}"}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"data", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "5", "]"}], "]"}], "==", "0"}], ",", 
           RowBox[{"-", "90."}], ",", 
           RowBox[{"Log10", "[", 
            RowBox[{
             RowBox[{"data", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "5", "]"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "data", "]"}], ",", "1"}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
       RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Epsilon]azvals", "=", 
     RowBox[{"ArrayReshape", "[", 
      RowBox[{
       RowBox[{"\[Epsilon]azValscomp", "[", "FullAcceptanceData0", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Length", "[", "InGridm\[Epsilon]", "]"}], ",", 
         RowBox[{"Length", "[", "InGrid\[Theta]\[Epsilon]", "]"}], ",", 
         RowBox[{"Length", "[", "InGridE\[Epsilon]", "]"}], ",", 
         RowBox[{"Length", "[", "InGridz\[Epsilon]", "]"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
     "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
     "___", "__"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Grid", " ", 
      SubscriptBox["m", "S"]}], ",", " ", 
     SubscriptBox["\[Theta]", "S"], ",", " ", 
     RowBox[{
      SubscriptBox["E", "S"], " ", "for", " ", "the", " ", "initial", " ", 
      "FIP", " ", "distribution", " ", "data"}], ",", " ", "logarithmized"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"DataLogarithmiedComp", "=", 
    RowBox[{
     RowBox[{"Hold", "@", 
      RowBox[{"Compile", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"data", ",", "_Real", ",", "2"}], "}"}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"data", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "4", "]"}], "]"}], "\[Equal]", "0"}], ",", 
            RowBox[{"-", "90."}], ",", 
            RowBox[{"Log10", "[", 
             RowBox[{
              RowBox[{"data", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "4", "]"}], "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "data", "]"}], ",", "1"}], "}"}]}], "]"}], 
        ",", 
        RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
        RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}]}], "//",
      "ReleaseHold"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockGridsValsDistr", "[", "ProdChannel_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"GridIn", ",", "vals"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"GridIn", "=", 
        RowBox[{"Log10", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{
             RowBox[{"DataDistrALPfermion", "[", "ProdChannel", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "#"}], "]"}], "]"}], "]"}], "&"}], "/@", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"vals", "=", 
        RowBox[{"ArrayReshape", "[", 
         RowBox[{
          RowBox[{"DataLogarithmiedComp", "[", 
           RowBox[{"DataDistrALPfermion", "[", "ProdChannel", "]"}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"GridIn", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
            RowBox[{"Length", "[", 
             RowBox[{"GridIn", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
            RowBox[{"Length", "[", 
             RowBox[{"GridIn", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"GridIn", ",", "vals"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"GridInFinal", "[", "prod", "]"}], ",", 
          RowBox[{"DistrVals", "[", "prod", "]"}]}], "}"}], "=", 
        RowBox[{"BlockGridsValsDistr", "[", "prod", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";"}], "//", 
    "AbsoluteTiming"}]}]}]], "Input",
 CellChangeTimes->{{3.897199659637949*^9, 3.8971996790804834`*^9}, {
   3.897208285005845*^9, 3.8972083314493256`*^9}, 3.89720836608294*^9, {
   3.8972322751312885`*^9, 3.897232278854822*^9}, {3.8972329306560636`*^9, 
   3.897232936165907*^9}, {3.89723383238743*^9, 3.897233837940078*^9}, {
   3.9037911183053303`*^9, 3.9037911183053303`*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[141]:=",ExpressionUUID->"b9365511-4a55-4c8f-a5bb-71604d175873"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Grid to be used to calculate the number of events", "Subsection",
 CellChangeTimes->{{3.8971989779703307`*^9, 3.8971989844379535`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"1941173e-e2fc-4b86-910f-\
f0ae2d58c545"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Grid", " ", 
     SubscriptBox["\[Theta]", "S"]}], ",", " ", 
    RowBox[{
     SubscriptBox["z", "S"], " ", "for", " ", "the", " ", "final", " ", 
     "acceptance", " ", "data"}], ",", " ", "logarithmized"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"OutGrid\[Theta]final", "=", 
     RowBox[{"(*", "InGrid\[Theta]\[Epsilon]", "*)"}], 
     RowBox[{"Log10", "[", 
      RowBox[{"Table", "[", 
       RowBox[{"x", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"10", "^", 
           RowBox[{"Min", "[", "InGrid\[Theta]\[Epsilon]", "]"}]}], ",", 
          RowBox[{"10", "^", 
           RowBox[{"Max", "[", "InGrid\[Theta]\[Epsilon]", "]"}]}], ",", 
          FractionBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"10", "^", 
              RowBox[{"Max", "[", "InGrid\[Theta]\[Epsilon]", "]"}]}], "-", 
             RowBox[{"10", "^", 
              RowBox[{"Min", "[", "InGrid\[Theta]\[Epsilon]", "]"}]}]}], 
            ")"}], "30"]}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"OutGridzfinal", "=", 
     RowBox[{"Log10", "[", 
      RowBox[{"Table", "[", 
       RowBox[{"x", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          SuperscriptBox["10", 
           RowBox[{"InGridz\[Epsilon]", "[", 
            RowBox[{"[", "1", "]"}], "]"}]], ",", 
          SuperscriptBox["10", 
           RowBox[{"InGridz\[Epsilon]", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]], ",", 
          RowBox[{"Min", "[", 
           RowBox[{
            FractionBox[
             RowBox[{
              SuperscriptBox["10", 
               RowBox[{"InGridz\[Epsilon]", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}]], "-", 
              SuperscriptBox["10", 
               RowBox[{"InGridz\[Epsilon]", "[", 
                RowBox[{"[", "1", "]"}], "]"}]]}], "5"], ",", 
            RowBox[{"Max", "[", 
             RowBox[{"0.5", ",", 
              FractionBox[
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["10", 
                  RowBox[{"InGridz\[Epsilon]", "[", 
                   RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]], "-", 
                 SuperscriptBox["10", 
                  RowBox[{"InGridz\[Epsilon]", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]]}], ")"}], "30"]}], "]"}]}],
            "]"}]}], "}"}]}], "]"}], "]"}]}], 
    RowBox[{"(*", "InGridz\[Epsilon]", "*)"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalDelta]xVals", "[", "list_", "]"}], ":=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        FractionBox[
         RowBox[{
          RowBox[{"list", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"list", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "2"], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"list", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "-", 
          RowBox[{"list", "[", 
           RowBox[{"[", 
            RowBox[{"i", "-", "1"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"Length", "[", "list", "]"}], ",", "1"}], "}"}]}], "]"}]}],
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalDelta]\[Theta]vals", "=", 
     RowBox[{"\[CapitalDelta]xVals", "[", 
      SuperscriptBox["10", "OutGrid\[Theta]final"], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalDelta]zvals", "=", 
     RowBox[{"\[CapitalDelta]xVals", "[", 
      SuperscriptBox["10", "OutGridzfinal"], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Final", " ", "energy", " ", 
      RowBox[{"grid", ".", " ", "Mass"}]}], "-", " ", 
     RowBox[{"and", " ", "production", " ", "channel"}], "-", "dependent"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"StepEtemp", "[", "Efip_", "]"}], "=", 
     RowBox[{"Piecewise", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.3", ",", 
          RowBox[{"Efip", "\[LessEqual]", "2.5"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.5", ",", 
          RowBox[{"2.5", "<", "Efip", "<", "35"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", 
          RowBox[{"35", "\[LessEqual]", "Efip", "\[LessEqual]", "50"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", 
          RowBox[{"50", "<", "Efip", "<", "160"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5", ",", 
          RowBox[{"160", "\[LessEqual]", "Efip", "<", "300"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"40", ",", 
          RowBox[{"300", "\[LessEqual]", "Efip", "<", "700"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"50", ",", 
          RowBox[{"700", "\[LessEqual]", "Efip", "<", "2000"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"200", ",", 
          RowBox[{"2000", "\[LessEqual]", "Efip", "<", "4000"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"400", ",", 
          RowBox[{"4000", "\[LessEqual]", "Efip", "<", "7000"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"500", ",", 
          RowBox[{"7000", "\[LessEqual]", "Efip", "\[LessEqual]", "50000"}]}],
          "}"}]}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"OutGridEnergy", "[", 
     RowBox[{"m_", ",", "ProdChannel_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"start", "=", 
            RowBox[{"1.01", "m"}]}], ",", 
           RowBox[{"end", "=", 
            RowBox[{"Eamax", "[", 
             RowBox[{"m", ",", "\[Theta]minExp", ",", "ProdChannel"}], 
             "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Log10", "[", 
          RowBox[{"NestWhileList", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "+", 
              RowBox[{"StepEtemp", "[", "#", "]"}]}], "&"}], ",", "start", 
            ",", 
            RowBox[{
             RowBox[{"#", "\[LessEqual]", "end"}], "&"}], ",", "1", ",", 
            "\[Infinity]", ",", 
            RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}], "//", "N"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalDelta]xValsTotComp", "=", 
     RowBox[{
      RowBox[{"Hold", "@", 
       RowBox[{"Compile", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[CapitalDelta]\[Theta]vals", ",", "_Real", ",", "1"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[CapitalDelta]Evals", ",", "_Real", ",", "1"}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"\[CapitalDelta]zvals", ",", "_Real", ",", "1"}], "}"}]}],
           "}"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[CapitalDelta]\[Theta]vals", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "*", 
             RowBox[{"\[CapitalDelta]Evals", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "*", 
             RowBox[{"\[CapitalDelta]zvals", "[", 
              RowBox[{"[", "k", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "\[CapitalDelta]\[Theta]vals", "]"}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "\[CapitalDelta]Evals", "]"}]}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", 
             RowBox[{"Length", "[", "\[CapitalDelta]zvals", "]"}]}], "}"}]}], 
          "]"}], ",", 
         RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
         RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}]}], "//",
       "ReleaseHold"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8972023930977507`*^9, 3.8972024003159914`*^9}, {
  3.8972037912719955`*^9, 3.897203794873706*^9}, {3.8972042319753127`*^9, 
  3.8972042376735725`*^9}, {3.8972043473390894`*^9, 3.897204353429783*^9}, {
  3.8972047978657155`*^9, 3.89720480634333*^9}, {3.897208409815923*^9, 
  3.89720841003522*^9}, {3.897232284543871*^9, 3.8972322845774384`*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[151]:=",ExpressionUUID->"56dc563a-f204-42ed-92d5-4178465a4587"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Code that computes the number of events - using the mapping method \
\>", "Subsection",
 CellChangeTimes->{{3.897199076623907*^9, 3.8971990900052223`*^9}, {
  3.8972009084104066`*^9, 3.897200920680235*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"09bda361-200e-4474-a4eb-\
51f045b744b2"],

Cell[CellGroupData[{

Cell["Grid for distribution times acceptance", "Subsubsection",
 CellChangeTimes->{{3.8972000893750353`*^9, 3.897200100182712*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"310ab4ae-abf8-473c-91d1-\
fbd6da1eee7d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Block", " ", "that", " ", "computes", " ", "the", " ", "grid", " ", 
     SubscriptBox["\[Theta]", "S"]}], ",", 
    SubscriptBox["E", "S"], ",", 
    SubscriptBox["z", "S"], ",", " ", 
    RowBox[{
     SubscriptBox["\[Epsilon]", "Full"], "\[Times]", 
     SubscriptBox["f", 
      RowBox[{
       SubscriptBox["\[Theta]", "S"], ",", 
       SubscriptBox["E", "S"]}]]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"TableIntegrandDiscret", "[", 
    RowBox[{"m_", ",", "ProdChannel_", ",", "\[Epsilon]DecOp_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"OutGridEfinal", "=", 
       RowBox[{"OutGridEnergy", "[", 
        RowBox[{
         RowBox[{"N", "[", "m", "]"}], ",", "ProdChannel"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalDelta]Evals", "=", 
       RowBox[{"\[CapitalDelta]xVals", "[", 
        SuperscriptBox["10", "OutGridEfinal"], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalDelta]xValsTot", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"\[CapitalDelta]xValsTotComp", "[", 
          RowBox[{
          "\[CapitalDelta]\[Theta]vals", ",", "\[CapitalDelta]Evals", ",", 
           "\[CapitalDelta]zvals"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"OutGridFinal", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Log10", "[", 
            RowBox[{"N", "[", "m", "]"}], "]"}], "}"}], ",", 
          "OutGrid\[Theta]final", ",", "OutGridEfinal", ",", 
          "OutGridzfinal"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"OutGridFinal1", "=", 
       RowBox[{"10", "^", 
        RowBox[{"OutGridFinal", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "3", ",", "4"}], "}"}]}], "]"}], "]"}]}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"g\[Epsilon]", "=", 
       RowBox[{"{", 
        RowBox[{
        "InGridm\[Epsilon]", ",", "InGrid\[Theta]\[Epsilon]", ",", 
         "InGridE\[Epsilon]", ",", "InGridz\[Epsilon]"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xg\[Epsilon]", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Log10", "[", 
           RowBox[{"N", "[", "m", "]"}], "]"}], "}"}], ",", 
         "OutGrid\[Theta]final", ",", "OutGridEfinal", ",", "OutGridzfinal"}],
         "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xig\[Epsilon]", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Interpolation", "[", 
            RowBox[{
             RowBox[{"Transpose", "@", 
              RowBox[{"{", 
               RowBox[{"#", ",", 
                RowBox[{"Range", "@", 
                 RowBox[{"Length", "@", "#"}]}]}], "}"}]}], ",", 
             RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
           "#2", "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"g\[Epsilon]", ",", "xg\[Epsilon]"}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"\[Epsilon]Result", "=", 
       RowBox[{"10", "^", 
        RowBox[{"Flatten", "@", 
         RowBox[{"cf4", "[", 
          RowBox[{
           RowBox[{"Sequence", "@@", "xig\[Epsilon]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"\[Epsilon]DecOp", "==", "\"\<True\>\""}], ",", 
             "\[Epsilon]vals", ",", "\[Epsilon]azvals"}], "]"}]}], 
          "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gDistr", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"GridInFinal", "[", "ProdChannel", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"GridInFinal", "[", "ProdChannel", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"GridInFinal", "[", "ProdChannel", "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xgDistr", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Log10", "[", 
           RowBox[{"N", "[", "m", "]"}], "]"}], "}"}], ",", 
         "OutGrid\[Theta]final", ",", "OutGridEfinal"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xigDistr", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Interpolation", "[", 
            RowBox[{
             RowBox[{"Transpose", "@", 
              RowBox[{"{", 
               RowBox[{"#", ",", 
                RowBox[{"Range", "@", 
                 RowBox[{"Length", "@", "#"}]}]}], "}"}]}], ",", 
             RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
           "#2", "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"gDistr", ",", "xgDistr"}], "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"DistrResult", "=", 
       RowBox[{"10", "^", 
        RowBox[{"Flatten", "@", 
         RowBox[{"cf3", "[", 
          RowBox[{
           RowBox[{"Sequence", "@@", "xigDistr"}], ",", 
           RowBox[{"DistrVals", "[", "ProdChannel", "]"}]}], "]"}]}]}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"TabTemp0", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"OutGridFinal1", ",", 
         RowBox[{"List", "/@", 
          RowBox[{"Flatten", "[", 
           RowBox[{"DistrResult", " ", 
            RowBox[{"Partition", "[", 
             RowBox[{"\[Epsilon]Result", ",", 
              RowBox[{"Length", "[", "OutGridzfinal", "]"}]}], "]"}]}], 
           "]"}]}], ",", "\[CapitalDelta]xValsTot", ",", "2"}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8971994275280633`*^9, 3.897199455815837*^9}, {
  3.897199582357897*^9, 3.897199655914138*^9}, {3.897199710190297*^9, 
  3.8971997629515643`*^9}, {3.8971998392552953`*^9, 3.897199857485531*^9}, {
  3.8971999081472673`*^9, 3.897199913176509*^9}, {3.897200806217702*^9, 
  3.897200808930355*^9}, {3.8972008448098516`*^9, 3.897200868455401*^9}, {
  3.8972021893667536`*^9, 3.897202196806899*^9}, {3.89720660886187*^9, 
  3.8972066089868507`*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[159]:=",ExpressionUUID->"db6fa112-734d-4c0b-bb6e-89495929f1dc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Convoluting acceptances with pre-factor", "Subsubsection",
 CellChangeTimes->{{3.8972001073570213`*^9, 3.8972001113381767`*^9}, {
  3.897200680751539*^9, 3.8972006887621703`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"412f2b64-f66f-4f79-8961-\
cbd8cee5cd4c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Values", " ", 
     SubscriptBox["f", "FIP"], "\[Times]", 
     SubscriptBox["\[Epsilon]", "FIP"], "\[Times]", 
     FractionBox[
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", 
         SubscriptBox["z", "FIP"]}], "/", 
        RowBox[{"(", 
         RowBox[{"cos", 
          RowBox[{"(", 
           SubscriptBox["\[Theta]", "FIP"], ")"}], 
          SubscriptBox["c\[Tau]", "FIP"], 
          RowBox[{
           SubscriptBox["p", "FIP"], "/", 
           SubscriptBox["m", "FIP"]}]}], ")"}]}], "]"}], 
      RowBox[{"cos", 
       RowBox[{"(", 
        SubscriptBox["\[Theta]", "FIP"], ")"}], 
       SubscriptBox["c\[Tau]", "FIP"], 
       RowBox[{
        SubscriptBox["p", "FIP"], "/", 
        SubscriptBox["m", "FIP"]}]}]], "\[Times]", 
     SubscriptBox["\[Epsilon]", "decay"], 
     SubscriptBox["\[CapitalDelta]z", "FIP"], 
     SubscriptBox["\[CapitalDelta]E", "FIP"], 
     SubscriptBox["\[CapitalDelta]\[Theta]", "FIP"], " ", "for", " ", "the", 
     " ", "grid", " ", "of", " ", "values", " ", 
     SubscriptBox["\[Theta]", "FIP"]}], ",", " ", 
    SubscriptBox["E", "FIP"], ",", " ", 
    RowBox[{
     SubscriptBox["z", "FIP"], " ", "fixed", " ", "values", " ", "of", " ", 
     SubscriptBox["c\[Tau]", "FIP"], " ", "and", " ", 
     SubscriptBox["m", "FIP"]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tableprefac", "=", 
     RowBox[{
      RowBox[{"Hold", "@", 
       RowBox[{"Compile", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"tabb", ",", "_Real", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", "_Real"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c\[Tau]", ",", "_Real"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"decProb", ",", "_Integer"}], "}"}]}], "}"}], ",", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "angles", ",", "energies", ",", "zv", ",", "values", ",", 
             "\[CapitalDelta]s", ",", "prefactor"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"values", "=", 
             RowBox[{"Compile`GetElement", "[", 
              RowBox[{"tabb", ",", "4"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"\[CapitalDelta]s", "=", 
             RowBox[{"Compile`GetElement", "[", 
              RowBox[{"tabb", ",", "5"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"decProb", "==", "1"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"angles", "=", 
                RowBox[{"Compile`GetElement", "[", 
                 RowBox[{"tabb", ",", "1"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"energies", "=", 
                RowBox[{"Compile`GetElement", "[", 
                 RowBox[{"tabb", ",", "2"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"zv", "=", 
                RowBox[{"Compile`GetElement", "[", 
                 RowBox[{"tabb", ",", "3"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"prefactor", "=", 
                FractionBox[
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", "zv"}], "/", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Cos", "[", "angles", "]"}], "*", "c\[Tau]", "*", 
                    FractionBox[
                    SqrtBox[
                    RowBox[{
                    SuperscriptBox["energies", "2"], "-", 
                    SuperscriptBox["m", "2"]}]], "m"]}], ")"}]}], "]"}], 
                 RowBox[{
                  RowBox[{"Cos", "[", "angles", "]"}], "*", "c\[Tau]", "*", 
                  FractionBox[
                   SqrtBox[
                    RowBox[{
                    SuperscriptBox["energies", "2"], "-", 
                    SuperscriptBox["m", "2"]}]], "m"]}]]}]}], ",", 
              RowBox[{"prefactor", "=", "1."}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"prefactor", "*", "\[CapitalDelta]s", "*", "values"}]}]}],
           "]"}], ",", 
         RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
         RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
         RowBox[{"Parallelization", "\[Rule]", "\"\<True\>\""}], ",", 
         RowBox[{"RuntimeAttributes", "\[Rule]", 
          RowBox[{"{", "Listable", "}"}]}]}], "]"}]}], "//", 
      "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Summation", " ", "of", " ", "the", " ", "values", " ", "above"}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sumcompile", "=", 
     RowBox[{
      RowBox[{"Hold", "@", 
       RowBox[{"Compile", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"tabc\[Tau]m", ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
         RowBox[{"Total", "[", "tabc\[Tau]m", "]"}], ",", 
         RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
         RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
         RowBox[{"Parallelization", "\[Rule]", "\"\<True\>\""}]}], "]"}]}], "//",
       "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mmin\[Epsilon]", ",", "mmax\[Epsilon]"}], "}"}], "=", 
    RowBox[{"10", "^", 
     RowBox[{"MinMax", "[", "InGridm\[Epsilon]", "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{
  3.897200675960476*^9, {3.8972040486175427`*^9, 3.897204049008037*^9}, {
   3.897204079641328*^9, 3.8972040859999785`*^9}, {3.8972057591435843`*^9, 
   3.8972057626279507`*^9}, {3.89720886889474*^9, 3.897208869001661*^9}, {
   3.897233157406136*^9, 3.8972331674582524`*^9}, {3.897233865708329*^9, 
   3.8972338698480544`*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[160]:=",ExpressionUUID->"06159947-5912-4f17-9c32-3847f74c6719"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Acceptances", "Subsubsection",
 CellChangeTimes->{{3.8972009286929445`*^9, 3.8972009324601674`*^9}, 
   3.897201517674982*^9},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"5e750db1-dfad-49e9-8b9d-\
ffa968b87add"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FactorANUBISceiling", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"SelectedExperiment", "==", "\"\<ANUBIS-ceiling\>\""}], ",", "2",
      ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AcceptanceDiscret", "[", 
   RowBox[{
   "m_", ",", "ProdChannel_", ",", "\[Epsilon]decOp_", ",", "decProb_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"NevDiscret", ",", "NpotTimes\[Chi]val"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"mamin", "[", "ProdChannel", "]"}], ",", "mmin\[Epsilon]"}],
          "]"}], "<", "m", "<", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"mamax", "[", "ProdChannel", "]"}], ",", "mmax\[Epsilon]"}],
          "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"integrandtab", "=", 
         RowBox[{"TableIntegrandDiscret", "[", 
          RowBox[{"m", ",", "ProdChannel", ",", "\[Epsilon]decOp"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"brvis", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"\[Epsilon]decOp", "==", "1"}], ",", 
           RowBox[{"BrVis", "[", "m", "]"}], ",", "1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Test", " ", "lifetime", " ", "for", " ", "the", " ", "acceptance"}],
          "*)"}], "\[IndentingNewLine]", 
        RowBox[{"c\[Tau]acc", "=", 
         SuperscriptBox["10", "9"]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Prefactor", " ", "for", " ", "the", " ", 
          RowBox[{"acceptance", ".", " ", "If"}], " ", "only", " ", 
          "azimuthal", " ", "and"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"prefacacc", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"decProb", "==", "1"}], ",", "c\[Tau]acc", ",", 
           FractionBox["1", 
            RowBox[{"zmaxExp", "-", "zminExp"}]]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"accdiscret", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"brvis", "!=", "0"}], ",", 
           RowBox[{"FactorANUBISceiling", "*", "brvis", "*", "prefacacc", "*", 
            RowBox[{"sumcompile", "[", 
             RowBox[{"tableprefac", "[", 
              RowBox[{
              "integrandtab", ",", "m", ",", "c\[Tau]acc", ",", "decProb"}], 
              "]"}], "]"}]}], ",", "0"}], "]"}]}]}], ",", 
       RowBox[{"accdiscret", "=", "0"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "accdiscret"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.8972011084712963`*^9, 3.897201128340288*^9}, {
   3.8972011891481795`*^9, 3.89720124049387*^9}, {3.8972012897384634`*^9, 
   3.897201325360157*^9}, {3.897201589075931*^9, 3.8972016624203763`*^9}, {
   3.8972018160050974`*^9, 3.8972018498780518`*^9}, {3.89720191795713*^9, 
   3.8972019346903367`*^9}, {3.8972020225483*^9, 3.8972020975166674`*^9}, {
   3.8972023111284375`*^9, 3.897202311275799*^9}, 3.8972023780567894`*^9, {
   3.897205334073205*^9, 3.8972053351996293`*^9}, {3.897206603491517*^9, 
   3.8972066036108027`*^9}, {3.8972084496286616`*^9, 
   3.8972084523229027`*^9}, {3.8972085258638744`*^9, 
   3.8972085259988823`*^9}, {3.8972088775622473`*^9, 
   3.8972088779176054`*^9}, {3.8972323011460724`*^9, 
   3.8972323031331143`*^9}, {3.8972331398975024`*^9, 3.897233154318738*^9}, {
   3.8972332655240684`*^9, 3.897233267351106*^9}, {3.897233880898526*^9, 
   3.8972338829697065`*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[163]:=",ExpressionUUID->"306022e5-63c1-4a7e-a916-61fc87f47d67"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Acceptances and approximate lower/upper bounds computation", "Section",
 CellChangeTimes->{{3.8972012648879433`*^9, 3.897201267668914*^9}, {
  3.8972059482630224`*^9, 3.8972059524445267`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"5dd0508c-7522-497d-88fa-\
c56f756f8b51"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"mlistAcceptance", "[", "prod", "]"}], "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"m", ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", 
           RowBox[{"1.01", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"mamin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}], 
             "]"}]}], ",", 
           RowBox[{"0.95", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"mamax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}], 
             "]"}]}], ",", 
           RowBox[{"Min", "[", 
            RowBox[{
             FractionBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"0.95", 
                 RowBox[{"Min", "[", 
                  RowBox[{
                   RowBox[{"mamax", "[", "prod", "]"}], ",", 
                   "mmax\[Epsilon]"}], "]"}]}], "-", 
                RowBox[{"1.01", 
                 RowBox[{"Max", "[", 
                  RowBox[{
                   RowBox[{"mamin", "[", "prod", "]"}], ",", 
                   "mmin\[Epsilon]"}], "]"}]}]}], ")"}], "20"], ",", "2"}], 
            "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.99", 
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"mamax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}], 
          "]"}]}], "}"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"m", ",", 
          RowBox[{"AcceptanceDiscret", "[", 
           RowBox[{"m", ",", "prod", ",", "\"\<False\>\"", ",", "0"}], "]"}], 
          ",", 
          RowBox[{"AcceptanceDiscret", "[", 
           RowBox[{"m", ",", "prod", ",", "\"\<True\>\"", ",", "0"}], "]"}], 
          ",", 
          RowBox[{"AcceptanceDiscret", "[", 
           RowBox[{"m", ",", "prod", ",", "\"\<False\>\"", ",", "1"}], "]"}], 
          ",", 
          RowBox[{"AcceptanceDiscret", "[", 
           RowBox[{"m", ",", "prod", ",", "\"\<True\>\"", ",", "1"}], "]"}]}],
          "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"m", ",", 
          RowBox[{"mlistAcceptance", "[", "prod", "]"}]}], "}"}]}], "]"}]}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlotAcc", "[", "ProdChannel_", "]"}], ":=", 
  RowBox[{"ListLogPlot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "4"}], "}"}]}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "5"}], "}"}]}], "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", " ", "22"}], "]"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Blue"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
         RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
         RowBox[{"Darker", "@", 
          RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Black"}], "}"}]}], 
      "}"}]}], ",", 
    RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"MinMax", "[", 
        RowBox[{
         RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.9", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}], "]"}]}], ",", 
         RowBox[{"1.1", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}]}], "]"}]}]}], 
        "}"}]}], "}"}]}], ",", 
    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<m [GeV]\>\"", ",", "\"\<Acceptance\>\""}], "}"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", " ", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<From \>\"", ",", "ProdChannel"}], "}"}], "]"}], ",", 
       " ", "20", ",", " ", "Black"}], "]"}]}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"Placed", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"#", ",", " ", "18"}], "]"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{
          "\"\<<\!\(\*SubscriptBox[\(\[Epsilon]\), \(FIP\)]\)>\>\"", ",", 
           "\"\<<\!\(\*SubscriptBox[\(\[Epsilon]\), \
\(FIP\)]\)\!\(\*SubscriptBox[\(\[Epsilon]\), \(decay\)]\)>\>\"", ",", 
           "\"\<c\[Tau]<\!\(\*SubscriptBox[\(\[Epsilon]\), \
\(FIP\)]\)\!\(\*SubscriptBox[\(P\), \(decay\)]\)>\>\"", ",", 
           "\"\<c\[Tau]<\!\(\*SubscriptBox[\(\[Epsilon]\), \
\(FIP\)]\)\!\(\*SubscriptBox[\(P\), \(decay\)]\)\!\(\*SubscriptBox[\(\
\[Epsilon]\), \(decay\)]\)>\>\""}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.75", ",", "0.2"}], "}"}]}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Style", "[", 
   RowBox[{
    RowBox[{"Row", "[", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"PlotAcc", "[", "prod", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "]"}], 
     "]"}], ",", 
    RowBox[{"ImageSizeMultipliers", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"FilenameAcceptance", "[", "prod", "]"}], "=", 
       RowBox[{"ToString", "@", 
        RowBox[{"StringForm", "[", 
         RowBox[{"\"\<Acceptance_ALP-fermion_at_``_From_``.dat\>\"", ",", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"{", 
            RowBox[{"SelectedExperiment", ",", 
             RowBox[{"ExportList", "[", "prod", "]"}]}], "}"}]}]}], "]"}]}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<Auxiliary data/ALPs with fermion coupling\>\"", ",", 
           "SelectedExperiment", ",", 
           RowBox[{"FilenameAcceptance", "[", "prod", "]"}]}], "}"}], "]"}], 
        ",", 
        RowBox[{
         RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "4", ",", "5"}], "}"}]}], "]"}], 
         "]"}], ",", "\"\<Table\>\""}], "]"}]}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AccAveraged", "[", "ma_", "]"}], "=", 
   RowBox[{"NpotGivenExperiment", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"mamin", "[", "prod", "]"}], "<", "ma", "<", 
           RowBox[{"mamax", "[", "prod", "]"}]}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"\[Chi]Xtimes\[Chi]XtoALPfermion", "[", 
            RowBox[{"ma", ",", "1", ",", "prod"}], "]"}], "]"}], ",", "0"}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ",", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"mamin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}], 
            "]"}], "<", "ma", "<", 
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"mamax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}], 
            "]"}]}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"\[Chi]Xtimes\[Chi]XtoALPfermion", "[", 
             RowBox[{"ma", ",", "1", ",", "prod"}], "]"}], "*", 
            RowBox[{
             RowBox[{"Interpolation", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
               RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
             "ma", "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ",", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"mamin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}], 
            "]"}], "<", "ma", "<", 
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"mamax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}], 
            "]"}]}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"\[Chi]Xtimes\[Chi]XtoALPfermion", "[", 
              RowBox[{"ma", ",", "1", ",", "prod"}], "]"}], "c\[Tau]acc"], 
            "*", 
            RowBox[{
             RowBox[{"Interpolation", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "4"}], "}"}]}], "]"}], "]"}], ",", 
               RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
             "ma", "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ",", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"mamin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}], 
            "]"}], "<", "ma", "<", 
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"mamax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}], 
            "]"}]}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"\[Chi]Xtimes\[Chi]XtoALPfermion", "[", 
              RowBox[{"ma", ",", "1", ",", "prod"}], "]"}], "c\[Tau]acc"], 
            "*", 
            RowBox[{
             RowBox[{"Interpolation", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "5"}], "}"}]}], "]"}], "]"}], ",", 
               RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
             "ma", "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}]}], "}"}]}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<Auxiliary data/ALPs with fermion coupling\>\"", ",", 
      "SelectedExperiment", ",", "\"\<AcceptanceAveragedALPfermion.m\>\""}], 
     "}"}], "]"}], ",", 
   RowBox[{"AccAveraged", "[", "ma", "]"}], ",", "\"\<MX\>\""}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.897205194596387*^9, 3.8972052417988367`*^9}, {
   3.897205309605931*^9, 3.89720539403836*^9}, {3.8972055297271395`*^9, 
   3.89720562453496*^9}, {3.8972056761558304`*^9, 3.897205703295968*^9}, {
   3.897205781529233*^9, 3.8972057841962852`*^9}, {3.897205893477086*^9, 
   3.897205918862975*^9}, {3.897206478456417*^9, 3.8972065044154882`*^9}, {
   3.8972085444868965`*^9, 3.897208578779801*^9}, {3.8972323557288723`*^9, 
   3.897232384030597*^9}, {3.8972329066377125`*^9, 3.8972329106422553`*^9}, {
   3.8972331787918997`*^9, 3.8972332447413106`*^9}, 3.897233307738046*^9, {
   3.8972338917748327`*^9, 3.8972339127093463`*^9}, 3.89723397243079*^9, {
   3.8975324456663704`*^9, 3.897532448727004*^9}, {3.902650895445283*^9, 
   3.9026508956653843`*^9}, {3.902727369863983*^9, 3.9027273698759756`*^9}, {
   3.902856673457388*^9, 3.902856681518236*^9}, {3.9037911183237505`*^9, 
   3.90379111834355*^9}, {3.903891888110244*^9, 3.9038918913310447`*^9}, 
   3.9038919234709387`*^9, {3.9039417324410973`*^9, 3.9039417331995296`*^9}, {
   3.9058403630780907`*^9, 3.905840378877389*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[165]:=",ExpressionUUID->"e596472c-a488-4d38-bf82-f6d092e93877"],

Cell[CellGroupData[{

Cell["Rough estimates of the upper and lower bounds", "Subsection",
 CellChangeTimes->{{3.8850328066928463`*^9, 3.8850328135228024`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"1f64e19f-68db-451d-9c11-\
af942b7e295b"],

Cell[CellGroupData[{

Cell["Definitions", "Subsubsection",
 CellChangeTimes->{{3.877676708463168*^9, 3.877676711193803*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"302d1c5e-c6d1-4ad1-a0b1-\
edca90a5022b"],

Cell[BoxData[{
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"yminEstimate", "[", 
      RowBox[{"ma_", ",", "prod"}], "]"}], "=", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox[
        RowBox[{"NpotGivenExperiment", "*", 
         RowBox[{"\[Chi]Xtimes\[Chi]XtoALPfermion", "[", 
          RowBox[{"ma", ",", "1", ",", "prod"}], "]"}], "*", 
         RowBox[{
          RowBox[{"Interpolation", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "5"}], "}"}]}], "]"}], "]"}], ",", 
            RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
          "ma", "]"}]}], 
        RowBox[{"2.3", 
         RowBox[{"ldecayALP", "[", 
          RowBox[{"ma", ",", "1", ",", "Ea"}], "]"}], 
         FractionBox["ma", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["Ea", "2"], "-", 
            SuperscriptBox["ma", "2"]}]]]}]], ")"}], 
      RowBox[{"-", 
       FractionBox["1", "4"]}]]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ymaxEstimate", "[", 
      RowBox[{"ma_", ",", "prod"}], "]"}], "=", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"Abs", "[", 
        RowBox[{"Re", "[", 
         RowBox[{"Evaluate", "[", 
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             RowBox[{"ProductLog", "[", 
              RowBox[{
               RowBox[{"-", "1"}], ",", 
               RowBox[{
                RowBox[{"-", "2.3"}], "*", 
                FractionBox["b", "a"]}]}], "]"}], "b"]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a", "\[Rule]", " ", 
              RowBox[{"NpotGivenExperiment", "*", 
               RowBox[{"\[Chi]Xtimes\[Chi]XtoALPfermion", "[", 
                RowBox[{"ma", ",", "1", ",", "prod"}], "]"}], "*", 
               RowBox[{
                RowBox[{"Interpolation", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
                  RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], 
                "[", "ma", "]"}]}]}], ",", 
             RowBox[{"b", "\[Rule]", 
              FractionBox["zminExp", 
               RowBox[{"ldecayALP", "[", 
                RowBox[{"ma", ",", "1", ",", 
                 RowBox[{"Eamax", "[", 
                  RowBox[{"0.5", ",", "\[Theta]minExp", ",", "prod"}], 
                  "]"}]}], "]"}]]}]}], "}"}]}], "]"}], "]"}], "]"}], ")"}], 
      FractionBox["1", "2"]]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"prod", ",", "ProductionList"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"LogLogPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.3", 
      RowBox[{"yminEstimate", "[", 
       RowBox[{
       "ma", ",", "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\""}], 
       "]"}]}], ",", 
     RowBox[{"1.8", 
      RowBox[{"ymaxEstimate", "[", 
       RowBox[{
       "ma", ",", "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\""}], 
       "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"ma", ",", "0.3", ",", "2.6"}], "}"}], ",", 
   RowBox[{"Frame", "->", "True"}], ",", 
   RowBox[{"ImageSize", "->", "Large"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8927045521296835`*^9, 3.892704618398532*^9}, {
   3.892704651576499*^9, 3.892704652867281*^9}, 3.8951292466391563`*^9, {
   3.8972064547512426`*^9, 3.8972064548441195`*^9}, {3.8972065272743893`*^9, 
   3.8972065273639555`*^9}, {3.897208556347765*^9, 3.8972085563922853`*^9}, {
   3.8972086426345124`*^9, 3.897208654173244*^9}, {3.897232414966792*^9, 
   3.8972324175870733`*^9}, {3.8972329876997476`*^9, 3.897233009729268*^9}, {
   3.8972333224369483`*^9, 3.8972333287617497`*^9}, 3.897233684153979*^9, {
   3.8972340069416475`*^9, 3.897234007169805*^9}, {3.897234114920539*^9, 
   3.8972341194170074`*^9}, {3.9027273710668883`*^9, 3.902727371070483*^9}, {
   3.9037896747950044`*^9, 3.903789674805071*^9}, {3.903791118363947*^9, 
   3.9037911183684855`*^9}, {3.9037936813200336`*^9, 3.903793682290308*^9}, {
   3.9049231517292624`*^9, 3.904923157976531*^9}, {3.9049231902009006`*^9, 
   3.904923190656528*^9}, 3.904926376200742*^9},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[171]:=",ExpressionUUID->"2013639a-846d-4ea2-a0b9-81d0edd1cc67"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Interpolation", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Epsilon]GeomTabs", "[", "\"\<B\>\"", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "5"}], "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "ma", 
   "]"}], "/.", 
  RowBox[{"{", 
   RowBox[{"ma", "\[Rule]", "0.1"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.9059619044574738`*^9, 3.9059619486575947`*^9}},
 CellLabel->
  "In[595]:=",ExpressionUUID->"2df6a9d4-8288-4364-a432-21ff29933e0e"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Number of events", "Section",
 CellChangeTimes->{{3.8972012736109533`*^9, 3.897201275449023*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"d97cf69b-14d7-4226-84be-\
25aa41979380"],

Cell[CellGroupData[{

Cell["Number of events - fast", "Subsection",
 CellChangeTimes->{{3.897206442190997*^9, 3.8972064427846107`*^9}, {
  3.905840324777521*^9, 3.905840328994842*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"42ab82d5-4d7e-4d06-8eb9-\
6e821b04db69"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FactorLowerBound", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\"\<ANUBIS-shaft-volume-1\>\"", ",", 
          "\"\<ANUBIS-shaft-volume-2\>\"", ",", 
          "\"\<ANUBIS-shaft-volume-3\>\""}], "}"}], ",", 
        "SelectedExperiment"}], "]"}], "==", "True"}], ",", "0.1", ",", 
     "0.3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NeventsDiscret", "[", 
   RowBox[{"m_", ",", "ProdChannel_", ",", "ylist_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"NevDiscret", ",", "NpotTimes\[Chi]val", ",", "zshift"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"mamin", "[", "ProdChannel", "]"}], ",", "mmin\[Epsilon]"}], 
        "]"}], "<", "m", "<", 
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"mamax", "[", "ProdChannel", "]"}], ",", "mmax\[Epsilon]"}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"integrandtab", "=", 
        RowBox[{"TableIntegrandDiscret", "[", 
         RowBox[{"m", ",", "ProdChannel", ",", "\"\<True\>\""}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NpotTimes\[Chi]val", "[", "y_", "]"}], "=", 
        RowBox[{"NpotGivenExperiment", "*", 
         RowBox[{"\[Chi]Xtimes\[Chi]XtoALPfermion", "[", 
          RowBox[{"m", ",", "y", ",", "ProdChannel"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"lowerbound", ",", "upperbound"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"yminEstimate", "[", 
           RowBox[{"m", ",", "ProdChannel"}], "]"}], ",", 
          RowBox[{"ymaxEstimate", "[", 
           RowBox[{"m", ",", "ProdChannel"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"brvis", "=", 
        RowBox[{"BrVis", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NevDiscret", "[", "y_", "]"}], ":=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"0.1", "lowerbound"}], "<", "y", "<", 
           RowBox[{"(*", "1.5", "*)"}], 
           RowBox[{"2", "upperbound"}]}], ",", 
          RowBox[{
           RowBox[{"NpotTimes\[Chi]val", "[", "y", "]"}], "*", "brvis", "*", 
           RowBox[{"sumcompile", "[", 
            RowBox[{"tableprefac", "[", 
             RowBox[{"integrandtab", ",", "m", ",", 
              RowBox[{"c\[Tau]ALP", "[", 
               RowBox[{"m", ",", "y"}], "]"}], ",", "1"}], "]"}], "]"}]}], 
          ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"m", ",", 
           RowBox[{"ylist", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"NevDiscret", "[", 
            RowBox[{"ylist", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "ylist", "]"}], ",", "1"}], "}"}]}], 
        "]"}]}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"m", ",", 
          RowBox[{"ylist", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "ylist", "]"}], ",", "1"}], "}"}]}], "]"}]}],
      "]"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.897200964730176*^9, 3.897200965970766*^9}, {
   3.89720118259857*^9, 3.8972011870868115`*^9}, {3.8972012433916793`*^9, 
   3.8972012434804716`*^9}, {3.8972021109080114`*^9, 3.897202111357911*^9}, {
   3.897205130000824*^9, 3.8972051305748835`*^9}, 3.897206599004672*^9, {
   3.8972085445054307`*^9, 3.8972085493226857`*^9}, {3.897208729717713*^9, 
   3.897208782995672*^9}, {3.8972323557542253`*^9, 3.897232355758215*^9}, {
   3.8972325208882675`*^9, 3.897232579312927*^9}, {3.8972330183637056`*^9, 
   3.8972330186824365`*^9}, {3.8972330557477093`*^9, 
   3.8972330786629725`*^9}, {3.8972331885872264`*^9, 
   3.8972331892740192`*^9}, {3.897233372953797*^9, 3.8972334102237387`*^9}, {
   3.897233632248149*^9, 3.8972337068313646`*^9}, {3.897233770343194*^9, 
   3.897233794850586*^9}, {3.897234027583762*^9, 3.897234039222018*^9}, 
   3.902727371095085*^9, {3.903789674824919*^9, 3.9037896748651905`*^9}, {
   3.903790316364489*^9, 3.903790327604648*^9}, 3.903791118373599*^9, {
   3.903793681334241*^9, 3.903793681337234*^9}, {3.903793815495824*^9, 
   3.9037938405670385`*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[173]:=",ExpressionUUID->"963c4344-4087-43c6-b6e8-508b30bff543"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Number of events - slow (using built-in Mathematica functions Interpolation, \
NIntegrate)\
\>", "Subsection",
 CellChangeTimes->{{3.8972050850842867`*^9, 3.897205097581136*^9}, {
  3.905840331093692*^9, 3.9058403423886027`*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"eadf166c-43bc-48fd-b978-\
8f5e610e46ab"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Differential", " ", "decay", " ", "probability", " ", 
     FractionBox["1", "ldecay"], 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "l"}], "/", "ldecay"}], "]"}]}], ",", " ", 
    RowBox[{
    "where", " ", "l", " ", "is", " ", "expressed", " ", "in", " ", "terms", 
     " ", "of", " ", "the", " ", "longitudinal", " ", "displacement", " ", 
     "z", " ", "and", " ", "polar", " ", "angle", " ", "\[Theta]", " ", "as", 
     " ", 
     RowBox[{"z", "/", "cos\[Theta]"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Differential", " ", "decay", " ", "probability", " ", 
     RowBox[{"(", 
      RowBox[{"1", "/", "ldecay"}], ")"}], 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "l"}], "/", "ldecay"}], "]"}]}], ",", " ", 
    RowBox[{
    "where", " ", "l", " ", "is", " ", "expressed", " ", "in", " ", "terms", 
     " ", "of", " ", "the", " ", "longitudinal", " ", "displacement", " ", 
     "z", " ", "and", " ", "polar", " ", "angle", " ", "\[Theta]", " ", "as", 
     " ", 
     RowBox[{"z", "/", "cos\[Theta]"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"PdecayDensity", "[", 
      RowBox[{"ma_", ",", "y_", ",", "\[Theta]a_", ",", "Ea_", ",", "za_"}], 
      "]"}], "=", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "za"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]a", "]"}], "*", 
          RowBox[{"ldecayALP", "[", 
           RowBox[{"ma", ",", "y", ",", "Ea"}], "]"}]}], ")"}]}], "]"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]a", "]"}], "*", 
        RowBox[{"ldecayALP", "[", 
         RowBox[{"ma", ",", "y", ",", "Ea"}], "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "The", " ", "integrand", " ", "determining", " ", "the", " ", 
     "differential", " ", "rate", " ", "for", " ", "events"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"IntegrandALP", "[", 
       RowBox[{
       "ma_", ",", "y_", ",", "\[Theta]a_", ",", "Ea_", ",", "za_", ",", 
        "prod"}], "]"}], "=", 
      RowBox[{
       RowBox[{"DoubleDistrALPfermion", "[", 
        RowBox[{"ma", ",", "\[Theta]a", ",", "Ea", ",", "prod"}], "]"}], "*", 
       RowBox[{"PdecayDensity", "[", 
        RowBox[{"ma", ",", "y", ",", "\[Theta]a", ",", "Ea", ",", "za"}], 
        "]"}], "*", 
       RowBox[{"AzimuthalAcceptanceALPfermion", "[", 
        RowBox[{"\[Theta]a", ",", "za"}], "]"}], "*", 
       RowBox[{"DecayAcceptanceALPfermion", "[", 
        RowBox[{"ma", ",", "\[Theta]a", ",", "Ea", ",", "za"}], "]"}]}]}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IntegralALP", "[", 
     RowBox[{"ma_", ",", "y_", ",", "ProdChannel_"}], "]"}], ":=", 
    RowBox[{"NIntegrate", "[", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"IntegrandALP", "[", 
        RowBox[{
        "ma", ",", "y", ",", "\[Theta]a", ",", "Ea", ",", "za", ",", 
         "ProdChannel"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]a", ",", "\[Theta]minExp", ",", "\[Theta]maxExp"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Ea", ",", "ma", ",", 
        RowBox[{"Eamax", "[", 
         RowBox[{"ma", ",", "\[Theta]a", ",", "ProdChannel"}], "]"}]}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"za", ",", 
        RowBox[{"zmin\[Theta]", "[", "\[Theta]a", "]"}], ",", 
        RowBox[{"zmax\[Theta]", "[", "\[Theta]a", "]"}]}], "}"}], ",", 
      RowBox[{"Method", "\[Rule]", "\"\<AdaptiveMonteCarlo\>\""}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Nevents", "[", 
     RowBox[{"ma_", ",", "y_", ",", "ProdChannel_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"mamin", "[", "ProdChannel", "]"}], "\[LessEqual]", "ma", 
        "\[LessEqual]", 
        RowBox[{"mamax", "[", "ProdChannel", "]"}]}], "&&", 
       RowBox[{
        RowBox[{"BrVis", "[", "ma", "]"}], "!=", "0"}]}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"0.1", 
          RowBox[{"yminEstimate", "[", 
           RowBox[{"ma", ",", "ProdChannel"}], "]"}]}], "<", "y", "<", 
         RowBox[{"2", 
          RowBox[{"ymaxEstimate", "[", 
           RowBox[{"ma", ",", "ProdChannel"}], "]"}]}]}], ",", 
        RowBox[{"NpotGivenExperiment", "*", 
         RowBox[{"\[Chi]Xtimes\[Chi]XtoALPfermion", "[", 
          RowBox[{"ma", ",", "y", ",", "ProdChannel"}], "]"}], "*", 
         RowBox[{"IntegralALP", "[", 
          RowBox[{"ma", ",", "y", ",", "ProdChannel"}], "]"}]}], ",", "0"}], 
       "]"}], ",", "0"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.897206676519309*^9, 3.8972066766919394`*^9}, {
   3.8972085445134306`*^9, 3.897208556457489*^9}, 3.897208709167758*^9, {
   3.8972087938407507`*^9, 3.897208802487779*^9}, {3.897232355764817*^9, 
   3.897232355767809*^9}, {3.8972324564736366`*^9, 3.8972324601648207`*^9}, {
   3.897233045098506*^9, 3.897233051556747*^9}, {3.8972336051259527`*^9, 
   3.8972336231195955`*^9}, {3.8972341400150976`*^9, 
   3.8972341430674677`*^9}, {3.9027273711042843`*^9, 3.902727387742993*^9}, {
   3.9037896748753386`*^9, 3.9037896748950043`*^9}, {3.9037903163746753`*^9, 
   3.9037903220246954`*^9}, {3.903791118373599*^9, 3.903791118383997*^9}, {
   3.9037936813443747`*^9, 3.903793681347371*^9}, {3.903793796653015*^9, 
   3.9037938067190323`*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[175]:=",ExpressionUUID->"92da45d9-8d3d-47de-957a-1a264ba0ad10"],

Cell[CellGroupData[{

Cell["Test", "Subsubsection",
 CellChangeTimes->{{3.8921113169894333`*^9, 3.8921113174761143`*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"b2664c72-6d2a-4377-a483-\
21ff81ad0559"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "This", " ", "is", " ", "a", " ", "comparison", " ", "between", " ", 
     "the", " ", "slow", " ", "and", " ", "fast", " ", "integration", " ", 
     RowBox[{"methods", ".", " ", "For"}], " ", "the", " ", "selected", " ", 
     "mass", " ", "and", " ", "production", " ", "channel"}], ",", " ", 
    RowBox[{
    "the", " ", "numbers", " ", "of", " ", "events", " ", "obtained", " ", 
     "using", " ", "the", " ", "methods", " ", "should", " ", "agree", " ", 
     "within", " ", "10", "%"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"If", " ", "the", " ", "agreement", " ", "is", " ", "worse"}], 
    ",", " ", 
    RowBox[{
    "there", " ", "may", " ", "be", " ", "a", " ", "few", " ", "reasons"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"1", ")"}], " ", "The", " ", "grid", " ", "for", " ", "the", " ",
      "fast", " ", "method", " ", "is", " ", "not", " ", "dense", " ", 
     RowBox[{"enough", ".", " ", "Try"}], " ", "to", " ", "increase", " ", 
     "the", " ", "grid", " ", "density", " ", 
     RowBox[{"(", 
      RowBox[{
      "OutGrid\[Theta]final", ",", " ", "OutGridEfinal", ",", " ", 
       "OutGridzfinal"}], ")"}], " ", "to", " ", "see", " ", "whether", " ", 
     "the", " ", "agreement", " ", 
     RowBox[{"improves", ".", " ", "Sometimes"}]}], ",", " ", 
    RowBox[{
    "even", " ", "a", " ", "slightly", " ", "denser", " ", "grid", " ", "for",
      " ", 
     RowBox[{"e", ".", "g", ".", " ", "z"}], " ", "may", " ", "lead", " ", 
     "to", " ", "a", " ", "significant", " ", "improvement", " ", "in", " ", 
     "the", " ", "agrement"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"2", ")"}], " ", "The", " ", "Monte"}], "-", 
      RowBox[{
      "Carlo", " ", "integrator", " ", "for", " ", "the", " ", "slow", " ", 
       "method", " ", "fails", " ", "to", " ", "evaluate", " ", 
       "properly"}]}], ";", " ", 
     RowBox[{
     "this", " ", "may", " ", "happen", " ", "if", " ", "the", " ", "range", 
      " ", "of", " ", "the", " ", "integration", " ", "over", " ", "energies",
       " ", "is", " ", "too", " ", "large", " ", "compared", " ", "to", " ", 
      "the", " ", "domain", " ", "where", " ", "most", " ", "of", " ", "the", 
      " ", "events", " ", "actually", " ", "are", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"off", "-", 
         RowBox[{
         "axis", " ", "experiments", " ", "such", " ", "as", " ", "MATHUSLA", 
          " ", "and", " ", "ANUBIS"}]}], ")"}], ".", " ", "Another"}], " ", 
      "symptom", " ", "is", " ", "that", " ", "for", " ", "the", " ", "given",
       " ", "mass", " ", "and", " ", "coupling", " ", "the", " ", "integral", 
      " ", "\"\<jumps\>\""}]}], ",", " ", 
    RowBox[{"i", ".", "e", "."}], ",", " ", 
    RowBox[{
    "returns", " ", "values", " ", "with", " ", "large", " ", "error"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"mtest", "=", "0.4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ProdTest", "=", "\"\<B\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"galist", "=", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["10", 
          RowBox[{"-", "12"}]], ",", 
         RowBox[{"3", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "12"}]]}], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "12"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "11"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "11"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "10"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "10"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "9"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "9"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "8"}]], ",", 
         RowBox[{"2", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "8"}]]}], ",", 
         RowBox[{"4", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "8"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "7"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"6", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"7", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"8", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"9", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "6"}]], ",", 
         RowBox[{"2", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "6"}]]}]}], "}"}], "//", "N"}], "*)"}], 
     RowBox[{"Table", "[", 
      RowBox[{
       SuperscriptBox["10", "x"], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"-", "4.5"}], ",", 
         RowBox[{"-", "0.3"}], ",", "0.3"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dat1", "=", 
      RowBox[{"NeventsDiscret", "[", 
       RowBox[{"mtest", ",", "ProdTest", ",", "galist"}], "]"}]}], ";"}], "//",
     "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dat2", "=", 
      RowBox[{"ParallelTable", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"galist", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"c\[Tau]ALP", "[", 
           RowBox[{"mtest", ",", 
            RowBox[{"galist", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"Nevents", "[", 
           RowBox[{"mtest", ",", 
            RowBox[{"galist", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "ProdTest"}], "]"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "galist", "]"}], ",", "1"}], "}"}]}], 
       "]"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{"dat1", ",", 
      RowBox[{"dat2", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "2"}], "}"}]}], "]"}], "]"}], ",", "2"}], "]"}], "//",
     "TableForm"}]}]}]], "Input",
 CellChangeTimes->{{3.892111330393669*^9, 3.8921113703258653`*^9}, {
   3.8921114855521097`*^9, 3.8921114891326914`*^9}, {3.8921115909252915`*^9, 
   3.89211160107533*^9}, {3.892112023350475*^9, 3.8921120715940514`*^9}, {
   3.8921121043874707`*^9, 3.892112190091645*^9}, {3.892112748834139*^9, 
   3.892112748933666*^9}, {3.8921130465455704`*^9, 3.8921130470314426`*^9}, {
   3.8921131989548674`*^9, 3.8921131992395306`*^9}, {3.892113256325259*^9, 
   3.892113256434625*^9}, {3.892113458241603*^9, 3.8921135323303742`*^9}, {
   3.892116361437076*^9, 3.8921163614848557`*^9}, {3.893257780692194*^9, 
   3.893257792940939*^9}, {3.893260545232792*^9, 3.893260566765787*^9}, {
   3.896953530728937*^9, 3.896953531233162*^9}, {3.896953744363188*^9, 
   3.8969537469343243`*^9}, {3.896953883310589*^9, 3.896953884008139*^9}, {
   3.896971240286153*^9, 3.896971246695673*^9}, {3.8969733757056828`*^9, 
   3.896973378633896*^9}, {3.8969760731711082`*^9, 3.896976348233163*^9}, {
   3.8969763786206193`*^9, 3.896976403680397*^9}, {3.8969764343671703`*^9, 
   3.8969764672032614`*^9}, 3.8972088334478965`*^9, 3.8972326136604834`*^9, 
   3.897233424756247*^9, 3.8972340704293666`*^9, {3.9037938624346867`*^9, 
   3.9037938636976957`*^9}, {3.9049233552208714`*^9, 
   3.9049233846445026`*^9}, {3.905233491599722*^9, 3.9052334916831083`*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[179]:=",ExpressionUUID->"6608ca61-80df-4c49-a1f8-56118e7339da"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Differential number of events", "Subsection",
 CellChangeTimes->{{3.892111289211891*^9, 3.892111293865343*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"748b8b59-c490-462f-bf37-\
7dc6537c8d0d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "same", " ", "as", " ", "tableprefac", " ", "but", " ", "also",
     " ", "including", " ", "the", " ", "grid"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tableGridPrefac", "=", 
     RowBox[{
      RowBox[{"Hold", "@", 
       RowBox[{"Compile", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"tabb", ",", "_Real", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"mS", ",", "_Real"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c\[Tau]", ",", "_Real"}], "}"}]}], "}"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "*", "c\[Tau]", 
                    "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[Sqrt]", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "2"], "-", 
                    SuperscriptBox["mS", "2"]}], ")"}]}], ")"}], "/", "mS"}], 
                    ")"}]}], ")"}]}], "]"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Cos", "[", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "*", "c\[Tau]", 
                  "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[Sqrt]", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "2"], "-", 
                    SuperscriptBox["mS", "2"]}], ")"}]}], ")"}], "/", "mS"}], 
                   ")"}]}], ")"}]}], ")"}], 
              RowBox[{"#", "[", 
               RowBox[{"[", "4", "]"}], "]"}], "*", 
              RowBox[{"#", "[", 
               RowBox[{"[", "5", "]"}], "]"}]}]}], "}"}], "&"}], "/@", 
          "tabb"}], ",", 
         RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
         RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
         RowBox[{"Parallelization", "\[Rule]", "\"\<True\>\""}], ",", 
         RowBox[{"RuntimeAttributes", "\[Rule]", 
          RowBox[{"{", "Listable", "}"}]}]}], "]"}]}], "//", 
      "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Summation", " ", "returning", " ", "the", " ", "differential", " ", 
      "number", " ", "of", " ", "events", " ", "X"}], ",", " ", 
     RowBox[{"df", "/", "dX"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"NdiffCompiled", "=", 
    RowBox[{
     RowBox[{"Hold", "@", 
      RowBox[{"Compile", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"tabNdiff", ",", "_Real", ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"GridQuantity", ",", "_Real", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"LengthPerVariable", ",", "_Integer"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"NPoTtimesPprod", ",", "_Real"}], "}"}]}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"tabNdiff", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"LengthPerVariable", "*", 
                 RowBox[{"(", 
                  RowBox[{"i", "-", "1"}], ")"}]}], "+", "1"}], "]"}], "]"}], 
             "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"NPoTtimesPprod", "*", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"tabNdiff", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"LengthPerVariable", "*", 
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}]}], "+", "j"}], "]"}], 
                 "]"}], "[", 
                RowBox[{"[", "4", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", "LengthPerVariable", ",", "1"}], 
                "}"}]}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "GridQuantity", "]"}], ",", "1"}], "}"}]}],
          "]"}], ",", 
        RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
        RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
        RowBox[{"Parallelization", "\[Rule]", "\"\<True\>\""}]}], "]"}]}], "//",
      "ReleaseHold"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Variable", " ", "=", " ", 
      "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\""}], ",", 
     "\"\<\!\(\*SubscriptBox[\(x\), \(x\)]\)\>\"", ",", 
     RowBox[{
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", ".", " ", "The"}], 
      " ", "number", " ", "belongs", " ", "to", " ", "the", " ", "column", 
      " ", "in", " ", "the", " ", "tabulated", " ", "data"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"iVal", ":=", 
    RowBox[{"Association", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\"", " ", "\[Rule]", "2"}], 
       ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", "\[Rule]", "1"}], 
       ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(x\), \(x\)]\)\>\"", "\[Rule]", "3"}]}], 
      "}"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Differential", " ", "number", " ", "of", " ", "events"}], "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NeventsDifferentialDiscret", "[", 
     RowBox[{"m_", ",", "ProdChannel_", ",", "y_", ",", "Variable_"}], "]"}], 
    ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "NpotTimes\[Chi]val", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ival", "=", 
        RowBox[{"iVal", "[", "Variable", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"NpotTimes\[Chi]val", "=", 
        RowBox[{"NpotGivenExperiment", "*", 
         RowBox[{"\[Chi]Xtimes\[Chi]XtoALPfermion", "[", 
          RowBox[{"m", ",", "y", ",", "ProdChannel"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tablegrid0", "=", 
        RowBox[{"TableIntegrandDiscret", "[", 
         RowBox[{"m", ",", "ProdChannel", ",", "\"\<True\>\""}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"\[CapitalDelta]xvals", ":=", 
        RowBox[{"Association", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\"", "\[Rule]", 
            "\[CapitalDelta]Evals"}], ",", 
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", "\[Rule]", 
            " ", "\[CapitalDelta]\[Theta]vals"}], ",", 
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(x\), \(X\)]\)\>\"", "\[Rule]", " ", 
            "\[CapitalDelta]zvals"}]}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[CapitalDelta]xval", "=", 
        RowBox[{"\[CapitalDelta]xvals", "[", "Variable", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"c\[Tau]Val", "=", 
        RowBox[{"c\[Tau]ALP", "[", 
         RowBox[{"m", ",", "y"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"brvis", "=", 
        RowBox[{"BrVis", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ilist", "=", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"{", 
          RowBox[{"ival", ",", "1", ",", "2", ",", "3"}], "}"}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"tablegrid1", "=", 
        RowBox[{"SortBy", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"ilist", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"ilist", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"ilist", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "&"}], "/@", 
           RowBox[{"tableGridPrefac", "[", 
            RowBox[{"tablegrid0", ",", "m", ",", "c\[Tau]Val"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"GridQuantity", "=", 
        RowBox[{
         RowBox[{"tablegrid1", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", 
         "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"LengthPerVariable", "=", 
        RowBox[{
         RowBox[{"Length", "[", "tablegrid1", "]"}], "/", 
         RowBox[{"Length", "[", "GridQuantity", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tab1", "=", 
        RowBox[{"NdiffCompiled", "[", 
         RowBox[{
         "tablegrid1", ",", "GridQuantity", ",", "LengthPerVariable", ",", 
          RowBox[{"NpotTimes\[Chi]val", "*", "brvis"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"tab1", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", "1", "}"}]}], "]"}], "]"}], ",", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"tab1", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}], "*", 
            SuperscriptBox["\[CapitalDelta]xval", 
             RowBox[{"-", "1"}]]}], ",", "1"}], "]"}], ",", "2"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mvaltest", "=", "0.6"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ytest", "=", 
     SuperscriptBox["10", 
      RowBox[{"-", "3"}]]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"quantity", "=", "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"LegendX", ":=", 
    RowBox[{"Association", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\"", "\[Rule]", 
        "\"\<\!\(\*SubscriptBox[\(E\), \(a\)]\) [GeV]\>\""}], ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", "\[Rule]", 
        "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(a\)]\) [rad]\>\""}], ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(x\), \(X\)]\)\>\"", "\[Rule]", " ", 
        "\"\<\!\(\*SubscriptBox[\(z\), \(a\)]\) [m]\>\""}]}], "}"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"LegendY", ":=", 
    RowBox[{"Association", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\"", "\[Rule]", 
        "\"\<\!\(\*SubscriptBox[\(dN\), \(ev\)]\)/\!\(\*SubscriptBox[\(dE\), \
\(a\)]\) [\!\(\*SuperscriptBox[\(GeV\), \(-1\)]\)]\>\""}], ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", "\[Rule]", 
        "\"\<\!\(\*SubscriptBox[\(dN\), \(ev\)]\)/\!\(\*SubscriptBox[\(d\
\[Theta]\), \(a\)]\) [\!\(\*SuperscriptBox[\(rad\), \(-1\)]\)]\>\""}], ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(x\), \(X\)]\)\>\"", "\[Rule]", " ", 
        "\"\<\!\(\*SubscriptBox[\(dN\), \(ev\)]\)/\!\(\*SubscriptBox[\(dz\), \
\(a\)]\) [\!\(\*SuperscriptBox[\(m\), \(-1\)]\)]\>\""}]}], "}"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"prodlisttemp", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{"mamin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}], 
          "]"}], "<", "mvaltest", "<", 
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"mamax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"prodlisttemp", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"prodlisttemp", ",", 
            RowBox[{"{", "prod", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"NdiffData", "[", "prod", "]"}], "=", 
          RowBox[{"NeventsDifferentialDiscret", "[", 
           RowBox[{"mvaltest", ",", "prod", ",", "ytest", ",", "quantity"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"XvalminmaxNdiff", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"NdiffData", "[", "prod", "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ">", 
                SuperscriptBox["10", 
                 RowBox[{"-", "40"}]]}], "&"}]}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "MinMax"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"NdiffInt", "[", 
           RowBox[{"X_", ",", "prod"}], "]"}], "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"XvalminmaxNdiff", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "<", "X", "<", 
             RowBox[{"XvalminmaxNdiff", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"10", "^", 
              RowBox[{
               RowBox[{"Interpolation", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log10", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Log10", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "90"}]]}], "]"}]}], "}"}], "&"}], "/@", 
                  RowBox[{"NdiffData", "[", "prod", "]"}]}], ",", 
                 RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
               RowBox[{"Log10", "[", "X", "]"}], "]"}]}], "]"}], ",", "0"}], 
           "]"}]}]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NdiffInt", "[", 
      RowBox[{"X_", ",", "\"\<Total\>\""}], "]"}], "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"NdiffInt", "[", 
        RowBox[{"X", ",", "prod"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"prod", ",", "prodlisttemp"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LegendList", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", "\"\<Total\>\"", "}"}], ",", "prodlisttemp"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"QuantityMinMax", "=", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"MinMax", "[", 
          RowBox[{
           RowBox[{"NdiffData", "[", "prod", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"prod", ",", "prodlisttemp"}], "}"}]}], "]"}], ",", "1"}], 
      "]"}], "//", "MinMax"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ValueMinMax", "=", 
     RowBox[{"Max", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"NdiffData", "[", "#", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "&"}], "/@", 
       "prodlisttemp"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"LogLogPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NdiffInt", "[", 
         RowBox[{"X", ",", "prod"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "LegendList"}], "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"X", ",", 
       RowBox[{"QuantityMinMax", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"QuantityMinMax", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox["10", 
           RowBox[{"-", "5"}]], ",", 
          RowBox[{"2", "ValueMinMax"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Black"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Darker", "@", 
           RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Darker", "@", "Cyan"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Magenta"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Blue", ",", 
          RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Darker", "@", "Red"}], ",", 
          RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Darker", "@", 
           RowBox[{"Darker", "@", "Green"}]}], ",", 
          RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"Placed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"#", ",", "20"}], "]"}], "&"}], "/@", "LegendList"}], ",", 
        "Right"}], "]"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"LegendX", "[", "quantity", "]"}], " ", ",", 
        RowBox[{"LegendY", "[", "quantity", "]"}]}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", " ", "23"}], "]"}]}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{
          "SelectedExperiment", ",", 
           "\"\<. \!\(\*SubscriptBox[\(m\), \(a\)]\) = \>\"", ",", "mvaltest",
            ",", "\"\< GeV, y = \>\"", ",", 
           RowBox[{"ytest", "//", "N"}]}], "}"}], "]"}], ",", "20", ",", 
        "Black"}], "]"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8921163996135225`*^9, 3.8921164016036096`*^9}, {
   3.8921164560955544`*^9, 3.892116475031265*^9}, {3.892116516434699*^9, 
   3.8921165782759094`*^9}, {3.8921166461579666`*^9, 
   3.8921166470109124`*^9}, {3.8921167042134895`*^9, 3.892116729930051*^9}, {
   3.8927049818255663`*^9, 3.8927049991222277`*^9}, {3.8929115471019087`*^9, 
   3.892911593659387*^9}, {3.8929721720425777`*^9, 3.892972173350433*^9}, {
   3.8929722208773427`*^9, 3.8929722211847763`*^9}, {3.8932578131000147`*^9, 
   3.893257813645747*^9}, {3.8934746693595037`*^9, 3.893474675301323*^9}, {
   3.8935154039618015`*^9, 3.893515450284458*^9}, {3.893515943430369*^9, 
   3.893515962817915*^9}, 3.893516005738713*^9, {3.893516036174548*^9, 
   3.893516050479193*^9}, {3.893516088577403*^9, 3.893516089018369*^9}, {
   3.893516189974946*^9, 3.8935161902213464`*^9}, {3.8935162352543807`*^9, 
   3.8935162734266047`*^9}, {3.893516595793399*^9, 3.893516611219179*^9}, {
   3.893606026577932*^9, 3.8936060575609436`*^9}, 3.8955578364377675`*^9, {
   3.8969794021337876`*^9, 3.89697940417612*^9}, {3.897206579842867*^9, 
   3.897206594529684*^9}, {3.8972085445254173`*^9, 3.8972085493347607`*^9}, {
   3.897208919899889*^9, 3.897208931547951*^9}, {3.897232355781791*^9, 
   3.8972323557889285`*^9}, {3.897232650441552*^9, 3.8972326556138897`*^9}, {
   3.8972334458167295`*^9, 3.8972334518776407`*^9}, {3.8972337389260225`*^9, 
   3.8972337484870095`*^9}, {3.8972341759970245`*^9, 3.8972341805239077`*^9}, 
   3.9027273711383595`*^9, 3.903790322052125*^9, 3.9037911184037747`*^9, {
   3.90379388260617*^9, 3.90379391368436*^9}, {3.903793985440897*^9, 
   3.9037939966975904`*^9}, {3.903806138641766*^9, 3.9038061415710564`*^9}, {
   3.9049234022965193`*^9, 3.904923404719922*^9}, {3.9049234552044992`*^9, 
   3.9049234557077*^9}, {3.905241298600586*^9, 3.905241322456391*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[185]:=",ExpressionUUID->"46c1a4a5-1c46-489a-a061-206c6b7873bc"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Exporting tabulated number of events", "Title",
 CellChangeTimes->{{3.8850207904521627`*^9, 3.885020796464762*^9}, 
   3.886649940088234*^9},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"0923b405-c0ba-437a-a0a1-\
eb2d8707c8c5"],

Cell[CellGroupData[{

Cell["Definitions", "Chapter",
 CellChangeTimes->{{3.8850542017641125`*^9, 3.885054203349573*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"2ada0cc1-1695-4a57-a86b-\
b11e240b979f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DirectoryQ", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<Tabulated Nevents\>\""}], "}"}], "]"}], "]"}], "//", 
       "ToString"}], ")"}], "\[Equal]", "\"\<False\>\""}], ",", 
    RowBox[{"CreateDirectory", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<Tabulated Nevents\>\""}], "}"}], "]"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DirectoryQ", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<Tabulated Nevents/ALPs with fermion coupling\>\""}], "}"}], 
         "]"}], "]"}], "//", "ToString"}], ")"}], "\[Equal]", 
     "\"\<False\>\""}], ",", 
    RowBox[{"CreateDirectory", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<Tabulated Nevents/ALPs with fermion coupling\>\""}], "}"}], 
      "]"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DirectoryQ", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<Tabulated Nevents/ALPs with fermion coupling\>\"", ",", 
           "SelectedExperiment"}], "}"}], "]"}], "]"}], "//", "ToString"}], 
      ")"}], "\[Equal]", "\"\<False\>\""}], ",", 
    RowBox[{"CreateDirectory", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<Tabulated Nevents/ALPs with fermion coupling\>\"", ",", 
        "SelectedExperiment"}], "}"}], "]"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<Filenames with tabulated \!\(\*SubscriptBox[\(N\), \(events\)]\):\>\"",
   "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"FilenameNevents", "[", "prod", "]"}], "=", 
    RowBox[{"ToString", "@", 
     RowBox[{"StringForm", "[", 
      RowBox[{"\"\<Nevents_ALP-fermion_at_``_Npot=``_From_``.dat\>\"", ",", 
       RowBox[{"Sequence", "@@", 
        RowBox[{"{", 
         RowBox[{"SelectedExperiment", ",", 
          RowBox[{
           RowBox[{"NpotGivenExperiment", "//", "CForm"}], "//", "ToString"}],
           ",", 
          RowBox[{"ExportList", "[", "prod", "]"}]}], "}"}]}]}], "]"}]}]}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"prod", ",", "ProductionList"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"FilenameNevents", "[", "prod", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "//", 
  "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlistALPfermionExport", "=", 
   RowBox[{"{", 
    RowBox[{
    "0.02", ",", "0.03", ",", "0.04", ",", "0.05", ",", "0.06", ",", "0.07", 
     ",", "0.08", ",", "0.09", ",", "0.1", ",", "0.11", ",", "0.12", ",", 
     "0.13", ",", "0.14", ",", "0.151", ",", "0.2", ",", "0.21", ",", "0.215",
      ",", "0.22", ",", "0.225", ",", "0.23", ",", "0.24", ",", "0.25", ",", 
     "0.27", ",", "0.301", ",", "0.35", ",", "0.4", ",", "0.425", ",", "0.45",
      ",", "0.47", ",", "0.5", ",", "0.51", ",", "0.52", ",", "0.53", ",", 
     "0.535", ",", "0.54", ",", "0.543", ",", "0.544", ",", "0.545", ",", 
     "0.546", ",", "0.55", ",", "0.56", ",", "0.57", ",", "0.58", ",", "0.6", 
     ",", "0.625", ",", "0.65", ",", "0.67", ",", "0.7", ",", "0.725", ",", 
     "0.75", ",", "0.77", ",", "0.8", ",", "0.825", ",", "0.85", ",", "0.87", 
     ",", "0.88", ",", "0.89", ",", "0.9", ",", "0.92", ",", "0.93", ",", 
     "0.94", ",", "0.95", ",", "0.953", ",", "0.954", ",", "0.955", ",", 
     "0.956", ",", "0.96", ",", "0.961", ",", "0.962", ",", "0.963", ",", 
     "0.966", ",", "0.97", ",", "0.973", ",", "0.975", ",", "0.98", ",", "1.",
      ",", "1.03", ",", "1.05", ",", "1.07", ",", "1.1", ",", "1.12", ",", 
     "1.15", ",", "1.2", ",", "1.25", ",", "1.3", ",", "1.4", ",", "1.5", ",",
      "1.6", ",", "1.7", ",", "1.8", ",", "1.9", ",", "2.", ",", "2.1", ",", 
     "2.2", ",", "2.3", ",", "2.4", ",", "2.5", ",", "2.6", ",", "2.7", ",", 
     "2.9", ",", "3.2", ",", "3.3", ",", "3.4", ",", "3.5", ",", "3.6", ",", 
     "3.7", ",", "3.8", ",", "3.9", ",", "4.", ",", "4.1", ",", "4.2", ",", 
     "4.3", ",", "4.4", ",", "4.5", ",", "4.6", ",", "4.7", ",", "4.76"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ylist", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SuperscriptBox["10", "x"], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "7"}], ",", 
       RowBox[{"-", "1"}], ",", "0.02"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8850528402073092`*^9, 3.885052964529935*^9}, {
   3.8850529967024455`*^9, 3.88505313318991*^9}, {3.885053172661522*^9, 
   3.885053247354876*^9}, {3.885053717249408*^9, 3.8850537696983976`*^9}, {
   3.885054057416253*^9, 3.88505420740788*^9}, {3.8850542428480587`*^9, 
   3.885054257815028*^9}, {3.885054905514982*^9, 3.885054927992525*^9}, {
   3.88523276755499*^9, 3.885232776819412*^9}, {3.8854556204578223`*^9, 
   3.8854556494874506`*^9}, {3.8854560165278835`*^9, 
   3.8854561921232824`*^9}, {3.8854563516684437`*^9, 
   3.8854563631681647`*^9}, {3.885456439233843*^9, 3.885456605782855*^9}, {
   3.8854567400235205`*^9, 3.885456743964001*^9}, {3.885542660052145*^9, 
   3.8855427304549437`*^9}, {3.8855427881537523`*^9, 3.885542788237467*^9}, {
   3.8855430067620525`*^9, 3.885543013668437*^9}, 3.885966882096207*^9, {
   3.8859669421437807`*^9, 3.8859669421488247`*^9}, {3.885968641323983*^9, 
   3.8859686709916077`*^9}, {3.8859700818035088`*^9, 3.885970116005333*^9}, {
   3.8859726427933483`*^9, 3.8859726621626787`*^9}, {3.8859727076000075`*^9, 
   3.885972770558454*^9}, {3.8860482606809826`*^9, 3.886048270758037*^9}, 
   3.8927074033680506`*^9, {3.892710424494131*^9, 3.8927104396943245`*^9}, {
   3.8929125643997126`*^9, 3.8929125705695467`*^9}, {3.893498037302079*^9, 
   3.893498051475497*^9}, {3.8950528099087305`*^9, 3.8950528378354964`*^9}, {
   3.895069852359413*^9, 3.895069870098545*^9}, {3.8950705608302083`*^9, 
   3.895070565809863*^9}, {3.89507701915416*^9, 3.8950770253258543`*^9}, {
   3.8951278228356895`*^9, 3.8951278681121364`*^9}, {3.8955602017177663`*^9, 
   3.895560203921951*^9}, {3.9027274496040297`*^9, 3.902727450274849*^9}, {
   3.9037911184139233`*^9, 3.903791118423604*^9}, {3.903794012559026*^9, 
   3.903794083915003*^9}, {3.9037944167176495`*^9, 3.9037944454163094`*^9}, {
   3.9037952705519886`*^9, 3.903795270602932*^9}, {3.903797141226776*^9, 
   3.903797172010522*^9}, {3.9037975243027196`*^9, 3.903797527105424*^9}, {
   3.9052336822497454`*^9, 3.9052336869139786`*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[201]:=",ExpressionUUID->"d36d89ea-2d97-457b-aa5b-4b098e8235d8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Exporting", "Chapter",
 CellChangeTimes->{{3.885054212114191*^9, 3.885054213032151*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"a58bd3a7-f345-470d-ba5e-\
82c520e24a7e"],

Cell[CellGroupData[{

Cell["Common definition", "Section",
 CellChangeTimes->{{3.8921886043857117`*^9, 3.8921886076155424`*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"d9a2b292-24ca-4f51-9905-\
1bcde103c869"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BlockExport", "[", "ProdChannel_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"ProductionList", ",", 
         RowBox[{
          RowBox[{"#", "\[Equal]", "ProdChannel"}], "&"}]}], "]"}], 
       "\[Equal]", 
       RowBox[{"{", "}"}]}], ",", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mlist", "=", "mlistALPfermionExport"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"TabFrom", "=", 
        RowBox[{"Monitor", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"NeventsDiscret", "[", 
             RowBox[{
              RowBox[{"mlist", "[", 
               RowBox[{"[", "k", "]"}], "]"}], ",", "ProdChannel", ",", 
              "ylist"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", 
              RowBox[{"Length", "[", "mlist", "]"}], ",", "1"}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"Row", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ProgressIndicator", "[", 
               RowBox[{"k", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"Length", "[", "mlist", "]"}]}], "}"}]}], "]"}], 
              ",", "\"\<i = \>\"", ",", "k", ",", "\"\</\>\"", ",", 
              RowBox[{"Length", "[", "mlist", "]"}], ",", "\"\<, m = \>\"", 
              ",", 
              RowBox[{"mlist", "[", 
               RowBox[{"[", "k", "]"}], "]"}], ",", "\"\< GeV\>\""}], "}"}], 
            ",", "\"\< \>\""}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], ",", 
            "\"\<Tabulated Nevents/ALPs with fermion coupling\>\"", ",", 
            "SelectedExperiment", ",", 
            RowBox[{"FilenameNevents", "[", "ProdChannel", "]"}]}], "}"}], 
          "]"}], ",", 
         RowBox[{"Flatten", "[", 
          RowBox[{"TabFrom", ",", "1"}], "]"}], ",", "\"\<Table\>\""}], 
        "]"}]}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8921886102299604`*^9, 3.892188661864987*^9}, {
   3.892188696661598*^9, 3.892188782889353*^9}, {3.8921888713769283`*^9, 
   3.8921888914281387`*^9}, {3.892190937661848*^9, 3.8921909466626697`*^9}, {
   3.8922765048644934`*^9, 3.8922765048725324`*^9}, {3.892541051864915*^9, 
   3.8925411081031237`*^9}, {3.8925422299627275`*^9, 
   3.8925422591259813`*^9}, {3.892542627960807*^9, 3.8925426356350746`*^9}, {
   3.8927104746862555`*^9, 3.892710508465253*^9}, {3.8950703812229633`*^9, 
   3.895070389767537*^9}, 3.9027274561413517`*^9, {3.9037911184286413`*^9, 
   3.90379111843118*^9}, 3.9037940600873704`*^9},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[209]:=",ExpressionUUID->"b5ddb613-f8ce-4354-bf3e-3dc63b62f3d5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["From B", "Section",
 CellChangeTimes->{{3.8850542186134644`*^9, 3.8850542291940546`*^9}, {
  3.8850543968830786`*^9, 3.8850543972568283`*^9}, {3.8854566349217353`*^9, 
  3.885456635821289*^9}, {3.885972781535964*^9, 3.8859727816462245`*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"168fde9a-2458-4e60-a88f-\
8cb7595771cb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BlockExport", "[", "\"\<B\>\"", "]"}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.892139834260936*^9, 3.8921398923701935`*^9}, {
  3.8927074033858204`*^9, 3.8927074033910418`*^9}, {3.892710519534188*^9, 
  3.8927105263543444`*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[210]:=",ExpressionUUID->"c0da0c6d-6988-4b78-bde2-c9a416e59d5a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "From ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Pi]", "0"], TraditionalForm]],ExpressionUUID->
  "75998f46-42b8-4192-8df8-8adc163c3579"]
}], "Section",
 CellChangeTimes->{{3.8850542186134644`*^9, 3.8850542193674097`*^9}, {
  3.8854566234521356`*^9, 3.8854566261318445`*^9}, {3.8859727833974495`*^9, 
  3.885972784062454*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"46608a90-91e3-49a0-b2e7-\
5a7cb3d4118d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
   "BlockExport", "[", "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", 
    "]"}], ";"}], "//", "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8850542358688993`*^9, 3.8850542382094545`*^9}, {
   3.885054277631763*^9, 3.885054363431921*^9}, {3.8854560510752897`*^9, 
   3.8854560510763087`*^9}, 3.8854563630285983`*^9, {3.8854565716829195`*^9, 
   3.885456571685834*^9}, {3.885456613051569*^9, 3.885456619872187*^9}, {
   3.8854567159384456`*^9, 3.8854567461856785`*^9}, {3.885966882111861*^9, 
   3.885966882111861*^9}, 3.88596694225861*^9, {3.8859686709916077`*^9, 
   3.8859686709916077`*^9}, 3.8859700984977875`*^9, {3.8859711713390193`*^9, 
   3.8859711713546066`*^9}, 3.885972642809*^9, {3.8859728028497868`*^9, 
   3.8859728172346563`*^9}, {3.8859734318322124`*^9, 
   3.8859734424226294`*^9}, {3.892139901571684*^9, 3.8921399221812086`*^9}, {
   3.892707403396619*^9, 3.892707403396619*^9}, {3.8927105290381885`*^9, 
   3.892710530946664*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[211]:=",ExpressionUUID->"dda9eaf9-70b3-41b6-aa9f-05447750c383"]
}, Open  ]],

Cell[CellGroupData[{

Cell["From \[Eta]", "Section",
 CellChangeTimes->{{3.8850542186134644`*^9, 3.8850542262841854`*^9}, {
  3.885456652772599*^9, 3.8854566559423475`*^9}, {3.885972849826418*^9, 
  3.8859728504409485`*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"adef9038-3c90-4d63-9685-\
663b3972f0a8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BlockExport", "[", "\"\<\[Eta]\>\"", "]"}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8850542358688993`*^9, 3.8850542382094545`*^9}, {
   3.885054277631763*^9, 3.8850543855153503`*^9}, {3.885456042480401*^9, 
   3.8854560424814262`*^9}, 3.8854561637649994`*^9, {3.88545657204498*^9, 
   3.885456572050495*^9}, {3.885456661477639*^9, 3.885456668992567*^9}, 
   3.8854567150256567`*^9, {3.885456747613888*^9, 3.885456747806327*^9}, {
   3.885966882111861*^9, 3.885966882111861*^9}, 3.88596694225861*^9, {
   3.885968649553114*^9, 3.885968649553114*^9}, 3.88597010984126*^9, {
   3.8859711713546066`*^9, 3.8859711713546066`*^9}, 3.8859726428246174`*^9, {
   3.8859728172346563`*^9, 3.885972835680069*^9}, {3.8859734334967036`*^9, 
   3.8859734464846907`*^9}, {3.8921399299079905`*^9, 
   3.8921399424748044`*^9}, {3.8927074034058094`*^9, 
   3.8927074034083943`*^9}, {3.892710534194907*^9, 3.892710536706311*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[212]:=",ExpressionUUID->"a38eea6f-c52b-4931-9cc5-cb09ca702395"]
}, Open  ]],

Cell[CellGroupData[{

Cell["From \[Eta]\[CloseCurlyQuote]", "Section",
 CellChangeTimes->{{3.8850542186134644`*^9, 3.88505422780166*^9}, {
  3.8854566729323483`*^9, 3.8854566730023046`*^9}, {3.8854567532255774`*^9, 
  3.8854567544560757`*^9}, {3.885972845923894*^9, 3.8859728471400375`*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"1a74cb31-7815-4595-8f2e-\
52cebfb9e416"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BlockExport", "[", "\"\<\[Eta]'\>\"", "]"}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8850544007056713`*^9, 3.885054414558234*^9}, {
   3.8854560332901382`*^9, 3.8854560332917004`*^9}, 3.885456351259536*^9, {
   3.885456572052494*^9, 3.8854565720560255`*^9}, {3.8854566760728145`*^9, 
   3.885456710104888*^9}, {3.885456749954727*^9, 3.885456750125414*^9}, {
   3.885966882129011*^9, 3.885966882129011*^9}, 3.8859669422742825`*^9, {
   3.885968641323983*^9, 3.885968641323983*^9}, 3.885970116005333*^9, {
   3.8859711713546066`*^9, 3.8859711713546066`*^9}, 3.8859726428246174`*^9, {
   3.8859728172346563`*^9, 3.88597284134222*^9}, {3.8859733655214477`*^9, 
   3.8859733677543306`*^9}, {3.8859734210983605`*^9, 
   3.8859734260296836`*^9}, {3.89213995300185*^9, 3.892139962724166*^9}, {
   3.892707403416979*^9, 3.892707403422662*^9}, {3.8927105392652855`*^9, 
   3.892710541735204*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[213]:=",ExpressionUUID->"9a62fcbe-cfe2-40d5-9514-39b21e90fd25"]
}, Open  ]],

Cell[CellGroupData[{

Cell["From Drell-Yan", "Section",
 CellChangeTimes->{{3.8850542186134644`*^9, 3.88505422780166*^9}, {
  3.8854566729323483`*^9, 3.8854566730023046`*^9}, {3.8854567532255774`*^9, 
  3.8854567544560757`*^9}, {3.885972845923894*^9, 3.8859728471400375`*^9}, {
  3.8934980593086863`*^9, 3.893498061285187*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"f3460011-e0e7-485d-b7d1-\
d4fc48b1193d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BlockExport", "[", "\"\<Drell-Yan\>\"", "]"}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8850544007056713`*^9, 3.885054414558234*^9}, {
   3.8854560332901382`*^9, 3.8854560332917004`*^9}, 3.885456351259536*^9, {
   3.885456572052494*^9, 3.8854565720560255`*^9}, {3.8854566760728145`*^9, 
   3.885456710104888*^9}, {3.885456749954727*^9, 3.885456750125414*^9}, {
   3.885966882129011*^9, 3.885966882129011*^9}, 3.8859669422742825`*^9, {
   3.885968641323983*^9, 3.885968641323983*^9}, 3.885970116005333*^9, {
   3.8859711713546066`*^9, 3.8859711713546066`*^9}, 3.8859726428246174`*^9, {
   3.8859728172346563`*^9, 3.88597284134222*^9}, {3.8859733655214477`*^9, 
   3.8859733677543306`*^9}, {3.8859734210983605`*^9, 
   3.8859734260296836`*^9}, {3.89213995300185*^9, 3.892139962724166*^9}, {
   3.892707403416979*^9, 3.892707403422662*^9}, {3.8927105392652855`*^9, 
   3.892710541735204*^9}, {3.8934980628111825`*^9, 3.893498065770106*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[214]:=",ExpressionUUID->"965e1996-69d5-4edd-bef1-51b13fe3df5a"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Computing sensitivities", "Title",
 CellChangeTimes->{{3.885020809493571*^9, 3.88502081261261*^9}},
 CellTags->{
  "Sensitivity", 
   "Re-evaluation"},ExpressionUUID->"43632709-93c8-43ea-aac4-c4cdd9738fd6"],

Cell[CellGroupData[{

Cell["\<\
Specifying the experiment and interpolating the tabulated number of events\
\>", "Chapter",
 CellChangeTimes->{{3.8865657605515084`*^9, 3.886565789800824*^9}, {
  3.889154717919751*^9, 3.88915472812621*^9}},
 CellTags->{
  "Sensitivity", 
   "Re-evaluation"},ExpressionUUID->"4f28db5f-3e98-48c2-a98d-ef371754d56f"],

Cell[BoxData[{
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"DirectoryQ", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", 
          "\"\<Sensitivity domains\>\""}], "}"}], "]"}], "]"}], "//", 
      "ToString"}], ")"}], "\[Equal]", "\"\<False\>\""}], ",", 
   RowBox[{"CreateDirectory", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", 
       "\"\<Sensitivity domains\>\""}], "}"}], "]"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"DirectoryQ", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", 
          "\"\<Sensitivity domains\>\"", ",", 
          "\"\<ALPs with fermion coupling\>\""}], "}"}], "]"}], "]"}], "//", 
      "ToString"}], ")"}], "\[Equal]", "\"\<False\>\""}], ",", 
   RowBox[{"CreateDirectory", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", 
       "\"\<Sensitivity domains\>\"", ",", 
       "\"\<ALPs with fermion coupling\>\""}], "}"}], "]"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NeventsDirectory", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<Tabulated Nevents\>\"", ",", 
      "\"\<ALPs with fermion coupling\>\""}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentDirectoriesListNevents", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"FileNames", "[", 
      RowBox[{"\"\<*\>\"", ",", "NeventsDirectory", ",", "1"}], "]"}], ",", 
     "DirectoryQ"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<List of available experiments with tabulated \!\(\*SubscriptBox[\(N\), \
\(events\)]\) for ALPs with the coupling to fermions:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentsListNevents", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"FileNameTake", "[", 
       RowBox[{
        RowBox[{"ExperimentDirectoriesListNevents", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "ExperimentDirectoriesListNevents", "]"}], ",",
         "1"}], "}"}]}], "]"}], "//", "Sort"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ExperimentsListNevents", "//", "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", "ExperimentsListNevents", "]"}], "\[Equal]", "0"}],
    ",", 
   RowBox[{
   "Print", "[", 
    "\"\<No experiment is available, generate first the acceptance for the \
given experiment using module 1\>\"", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Selected experiment:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", "ExperimentsListNevents", "]"}], "\[NotEqual]", 
    "0"}], ",", 
   RowBox[{"SelExp", "=", 
    RowBox[{"dropdownDialog", "[", 
     RowBox[{
     "ExperimentsListNevents", ",", "\"\<Select the experiment:\>\""}], 
     "]"}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CondANUBIS", "=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<ANUBIS-shaft-volume-1\>\"", ",", "\"\<ANUBIS-shaft-volume-2\>\"", 
       ",", "\"\<ANUBIS-shaft-volume-3\>\""}], "}"}], ",", "SelExp"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"CondANUBIS", "\[Equal]", "True"}], ",", 
   RowBox[{"infoDialog", "[", 
    RowBox[{"Row", "[", 
     RowBox[{
     "{", "\"\<One of the modules of ANUBIS-shaft is chosen. The full \
sensitivity includes three modules. The importing will be over all modules, \
so for all ot the the sensitivity has to be computed\>\"", "}"}], "]"}], 
    "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"CondANUBIS", "\[Equal]", "False"}], ",", 
    RowBox[{"SelExpList", "=", 
     RowBox[{"{", "SelExp", "}"}]}], ",", 
    RowBox[{"SelExpList", "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\<ANUBIS-shaft-volume-1\>\"", ",", "\"\<ANUBIS-shaft-volume-2\>\"", 
       ",", "\"\<ANUBIS-shaft-volume-3\>\""}], "}"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filesNevents", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"filesNevents", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"filesNevents", ",", 
       RowBox[{"FileNames", "[", 
        RowBox[{"\"\<*.dat\>\"", ",", 
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], ",", 
            "\"\<Tabulated Nevents/ALPs with fermion coupling\>\"", ",", 
            "exp"}], "}"}], "]"}]}], "]"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "SelExpList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<List of production channels:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FilenamesNevents", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Last", "@", 
      RowBox[{"FileNameSplit", "@", 
       RowBox[{"filesNevents", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "filesNevents", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FilenameParameters", "[", "i_", "]"}], ":=", 
  RowBox[{
   RowBox[{"StringCases", "[", 
    RowBox[{
     RowBox[{"FilenamesNevents", "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{
      "\"\<Nevents_ALP-fermion_at_\>\"", "~~", "experiment__", "~~", 
       "\"\<_Npot=\>\"", "~~", "Npot__", "~~", "\"\<_From_\>\"", "~~", 
       "mother__", "~~", "\"\<.dat\>\""}], ":>", 
      RowBox[{"{", 
       RowBox[{"experiment", ",", "Npot", ",", "mother"}], "}"}]}]}], "]"}], 
   "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductionChannelsList", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"FilenameParameters", "[", "i", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "FilenamesNevents", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Experiment\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(N\), \(PoT\)]\)\>\"", ",", 
       "\"\<Mother\>\""}], "}"}], "}"}], ",", "ProductionChannelsList"}], 
   "]"}], "//", "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NpotDefault", "=", 
   RowBox[{
    RowBox[{"Interpreter", "[", "\"\<Number\>\"", "]"}], "[", 
    RowBox[{
     RowBox[{"ProductionChannelsList", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NeventsTabulatedList", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{"filesNevents", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<Table\>\""}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "filesNevents", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IfzeroList", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"NeventsTabulatedList", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ">", 
              SuperscriptBox["10", 
               RowBox[{"-", "5"}]]}], "&"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}], "==", "0"}], ",", 
       "0", ",", "1"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "NeventsTabulatedList", "]"}], ",", "1"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NeventsTabulatedList", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"IfzeroList", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "==", "1"}], ",", 
         RowBox[{"NeventsTabulatedList", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "IfzeroList", "]"}], ",", "1"}], "}"}]}], 
      "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"{", "Null", "}"}], ",", "#"}], "]"}], "==", "False"}], 
      "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mminmaxTabulated", "[", "i_", "]"}], ":=", 
  RowBox[{"MinMax", "[", 
   RowBox[{
    RowBox[{"NeventsTabulatedList", "[", 
     RowBox[{"[", "i", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yminmaxtabulated", "[", "i_", "]"}], ":=", 
  RowBox[{"MinMax", "[", 
   RowBox[{
    RowBox[{"NeventsTabulatedList", "[", 
     RowBox[{"[", "i", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mminmaxOverall", "=", 
   RowBox[{"MinMax", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"mminmaxTabulated", "[", "i", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "NeventsTabulatedList", "]"}], ",", "1"}], 
        "}"}]}], "]"}], "//", "Flatten"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yminmaxoverall", "=", 
   RowBox[{"MinMax", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"yminmaxtabulated", "[", "i", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "NeventsTabulatedList", "]"}], ",", "1"}], 
        "}"}]}], "]"}], "//", "Flatten"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nevint", "[", "i_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"mminmaxTabulated", "[", "i", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", " ", "ma", 
      "\[LessEqual]", 
      RowBox[{
       RowBox[{"mminmaxTabulated", "[", "i", "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "&&", 
     RowBox[{
      RowBox[{
       RowBox[{"yminmaxtabulated", "[", "i", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", "y", "\[LessEqual]", 
      " ", 
      RowBox[{
       RowBox[{"yminmaxtabulated", "[", "i", "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
    RowBox[{"Evaluate", "[", 
     RowBox[{"10", "^", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Log10", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
              RowBox[{"Log10", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
              RowBox[{"Log10", "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "+", 
                SuperscriptBox["10", 
                 RowBox[{"-", "90"}]]}], "]"}]}], "}"}], "&"}], "/@", 
           RowBox[{"NeventsTabulatedList", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
        RowBox[{
         RowBox[{"Log10", "[", "ma", "]"}], ",", 
         RowBox[{"Log10", "[", "y", "]"}]}], "]"}], ")"}]}], "]"}], ",", 
    "0"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Epsilon]reco", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"StringContainsQ", "[", 
       RowBox[{"SelExp", ",", "\"\<CHARM\>\""}], "]"}], "==", "True"}], ",", 
     "0.75", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NevIntList", "[", 
    RowBox[{"ma_", ",", "y_"}], "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Nevint", "[", "i", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "NeventsTabulatedList", "]"}], ",", "1"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pt", "[", "ma_", "]"}], ":=", 
  RowBox[{"LogLogPlot", "[", 
   RowBox[{
    RowBox[{"Evaluate", "[", 
     RowBox[{"NevIntList", "[", 
      RowBox[{"ma", ",", "y"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", 
      SuperscriptBox["10", 
       RowBox[{"-", "4"}]], ",", 
      SuperscriptBox["10", 
       RowBox[{"-", "2"}]]}], "}"}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"Placed", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"#", ",", "15"}], "]"}], "&"}], "/@", 
        RowBox[{"ProductionChannelsList", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "3"}], "]"}], "]"}]}], ",", "Right"}], "]"}]}], 
    ",", 
    RowBox[{"PlotRange", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["10", 
          RowBox[{"-", "4"}]], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "2"}]]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["10", 
          RowBox[{"-", "3"}]], ",", "100"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Frame", "->", "True"}], ",", 
    RowBox[{"ImageSize", "->", "Large"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<y\>\"", " ", ",", " ", 
       "\"\<\!\(\*SubscriptBox[\(N\), \(events\)]\)[\!\(\*SubscriptBox[\(m\), \
\(a\)]\),y]\>\""}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", " ", "23"}], "]"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", 
         RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", 
         RowBox[{"Darker", "@", 
          RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Cyan"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Black"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{"{", 
         RowBox[{
         "SelExp", ",", "\"\<. \!\(\*SubscriptBox[\(m\), \(a\)]\) = \>\"", 
          ",", "ma", ",", " ", "\"\< GeV\>\""}], "}"}], "]"}], ",", "20", ",",
        "Black"}], "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"pt", "[", "0.6", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NevTot", "[", 
    RowBox[{"ma_", ",", "y_"}], "]"}], "=", 
   RowBox[{"\[Epsilon]reco", "*", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NevIntList", "[", 
        RowBox[{"ma", ",", "y"}], "]"}], "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", 
         RowBox[{"NevIntList", "[", 
          RowBox[{"ma", ",", "y"}], "]"}], "]"}], ",", "1"}], "}"}]}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentFolder", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"CondANUBIS", "\[Equal]", "True"}], ",", "\"\<ANUBIS-shaft\>\"", 
     ",", "SelExp"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"DirectoryQ", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", 
          "\"\<Sensitivity domains\>\"", ",", 
          "\"\<ALPs with fermion coupling\>\"", ",", "ExperimentFolder"}], 
         "}"}], "]"}], "]"}], "//", "ToString"}], ")"}], "\[Equal]", 
    "\"\<False\>\""}], ",", 
   RowBox[{"CreateDirectory", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", 
       "\"\<Sensitivity domains\>\"", ",", 
       "\"\<ALPs with fermion coupling\>\"", ",", "ExperimentFolder"}], "}"}],
      "]"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8889934219191484`*^9, 3.8889934572936487`*^9}, {
   3.888993488436164*^9, 3.8889935196298246`*^9}, {3.888993631131192*^9, 
   3.8889936317673717`*^9}, {3.8889941168931828`*^9, 3.888994131488901*^9}, {
   3.8891549520226474`*^9, 3.8891549556386333`*^9}, {3.88915555629116*^9, 
   3.889155565695465*^9}, {3.8932343882289743`*^9, 3.89323440249368*^9}, {
   3.8935709181807127`*^9, 3.8935709459623632`*^9}, {3.8935709969349823`*^9, 
   3.893571049142565*^9}, {3.893571774685277*^9, 3.8935717805547934`*^9}, {
   3.8935723217820005`*^9, 3.893572363431644*^9}, {3.893744918014161*^9, 
   3.893744938342885*^9}, {3.8950528479286084`*^9, 3.895052904223016*^9}, {
   3.896846565306531*^9, 3.896846570642375*^9}, 3.8991934061928263`*^9, {
   3.9037911184438295`*^9, 3.903791118468619*^9}, {3.903793882094927*^9, 
   3.9037938820984917`*^9}, {3.903797026745615*^9, 3.9037970452607574`*^9}, {
   3.9049216111057444`*^9, 3.904921662274201*^9}, {3.9049217218934107`*^9, 
   3.9049217261997075`*^9}, {3.90492396885961*^9, 3.9049239690813828`*^9}, {
   3.9049240804362497`*^9, 3.9049240805085564`*^9}, {3.904924179607125*^9, 
   3.904924179705194*^9}, {3.9052412440770025`*^9, 3.90524124436055*^9}, {
   3.905242084580451*^9, 3.9052420935576477`*^9}, {3.9052421641249113`*^9, 
   3.905242164296854*^9}, {3.9052422710738254`*^9, 3.905242280663824*^9}, 
   3.9052780094855423`*^9, {3.9054038445509152`*^9, 3.905403844832307*^9}, 
   3.9058346238696585`*^9, {3.9058347300087337`*^9, 3.905834752542229*^9}},
 CellTags->{"Sensitivity", "Re-evaluation"},
 CellLabel->
  "In[633]:=",ExpressionUUID->"933c8a14-e475-435b-9eee-64b877f62c55"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubscriptBox["N", "events"], TraditionalForm]],ExpressionUUID->
  "138b09af-34cd-46c7-9754-d34d2f7fdc5b"],
 " density plot"
}], "Section",
 CellChangeTimes->{{3.892912581226515*^9, 3.892912582686805*^9}, {
  3.8929126354946766`*^9, 3.8929126370083904`*^9}},
 CellTags->{
  "Sensitivity", 
   "Re-evaluation"},ExpressionUUID->"d1f628ba-3bad-4159-94f9-0c8b5549e590"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Nevmax", "=", 
   RowBox[{"Max", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{"NeventsTabulatedList", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "NeventsTabulatedList", "]"}], ",", "1"}], 
       "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"plot", "=", 
  RowBox[{"DensityPlot", "[", 
   RowBox[{
    RowBox[{"Evaluate", "[", 
     RowBox[{"Log10", "[", 
      RowBox[{"NevTot", "[", 
       RowBox[{"ma", ",", "y"}], "]"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"ma", ",", 
      RowBox[{"mminmaxOverall", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"mminmaxOverall", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", 
      RowBox[{"yminmaxoverall", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"yminmaxoverall", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"ScalingFunctions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Log\>\"", ",", "\"\<Log\>\""}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "0.78"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"All", ",", "All", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log10", "[", "2.3", "]"}], ",", 
         RowBox[{"Log10", "[", "Nevmax", "]"}]}], "}"}]}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(m\), \(a\)]\) [GeV]\>\"", ",", 
       "\"\<y = 2\!\(\*SubscriptBox[\(v\), \(h\)]\)/f\>\""}], " ", "}"}]}], 
    ",", " ", 
    RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", " ", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", " ", "25"}], "]"}]}], ",", 
    RowBox[{"PlotPoints", "\[Rule]", "100"}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"Placed", "[", 
      RowBox[{
       RowBox[{"BarLegend", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Automatic", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Log10", "[", "2.3", "]"}], ",", 
             RowBox[{"Log10", "[", "Nevmax", "]"}]}], "}"}]}], "}"}], ",", 
         RowBox[{"LegendMarkerSize", "\[Rule]", "340"}], ",", 
         RowBox[{"LegendLabel", "\[Rule]", 
          RowBox[{"Placed", "[", 
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(Log\), \
\(10\)]\)[\!\(\*SubscriptBox[\(N\), \(ev\)]\)]\>\"", ",", "Bottom"}], "]"}]}],
          ",", 
         RowBox[{"LabelStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"FontSize", "\[Rule]", "22"}], "}"}]}], ",", 
         RowBox[{"Method", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
            RowBox[{"AxesStyle", "\[Rule]", "None"}], ",", 
            RowBox[{"TicksStyle", "\[Rule]", "Black"}]}], "}"}]}]}], "]"}], 
       ",", "Right"}], "]"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{"{", "ExperimentFolder", "}"}], "]"}], ",", "20", ",", 
       "Black"}], "]"}]}]}], 
   RowBox[{"(*", 
    RowBox[{",", 
     RowBox[{"FrameTicks", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Automatic", ",", "Automatic"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"TicksPlotx", ",", "None"}], "}"}]}], "}"}]}]}], "*)"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<NeventsDensityPlotExample.pdf\>\""}], "}"}], "]"}], ",", 
     "plot"}], "]"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.8929126599219103`*^9, 3.8929126956857305`*^9}, {
  3.893571057642872*^9, 3.893571063922956*^9}, {3.893744928154723*^9, 
  3.893744928154723*^9}, {3.8937450416896353`*^9, 3.8937450720779657`*^9}, {
  3.8937454492214108`*^9, 3.8937454519340353`*^9}, {3.9037896751851945`*^9, 
  3.9037896751902313`*^9}, {3.903790322054761*^9, 3.903790327609686*^9}, {
  3.9037945809753046`*^9, 3.903794589179802*^9}, {3.90379703592099*^9, 
  3.9037970359259777`*^9}},
 CellTags->{"Sensitivity", "Re-evaluation"},
 CellLabel->
  "In[669]:=",ExpressionUUID->"30f23ecc-adae-4e4e-bb37-3bcb631d2638"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Sensitivity computation", "Chapter",
 CellChangeTimes->{{3.8889936571476183`*^9, 3.8889936597112193`*^9}},
 CellTags->{
  "Sensitivity", 
   "Re-evaluation"},ExpressionUUID->"70b84e06-d773-437f-8360-f1845520d830"],

Cell[CellGroupData[{

Cell["Data importing", "Section",
 CellChangeTimes->{{3.895052713576123*^9, 3.895052715327282*^9}},
 CellTags->{
  "Sensitivity", 
   "Re-evaluation"},ExpressionUUID->"f8bcca72-97f4-4877-af48-43288ca88e21"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"BC10excluded", "=", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], ",", 
         "\"\<contours/BC10/BC10-excluded.txt\>\""}], "}"}], "]"}], ",", 
      "\"\<Table\>\""}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.903794607976071*^9, 3.9037946091391277`*^9}, 
   3.9037950242375803`*^9},
 CellTags->{"Sensitivity", "Re-evaluation"},
 CellLabel->
  "In[671]:=",ExpressionUUID->"c305b913-cdc5-4677-8d25-2c15d3b88372"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Sensitivity", "Section",
 CellChangeTimes->{{3.895052721789363*^9, 3.8950527227812586`*^9}},
 CellTags->{
  "Sensitivity", 
   "Re-evaluation"},ExpressionUUID->"93105a27-56ff-4fc6-9267-69c09e4a4e65"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SensitivityBlock", "[", 
   RowBox[{"Nev_", ",", "Npot_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RegSens1", "=", 
      RowBox[{"RegionPlot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          FractionBox["Npot", "NpotDefault"], 
          RowBox[{"NevTot", "[", 
           RowBox[{
            SuperscriptBox["10", "ma"], ",", 
            SuperscriptBox["10", "ga"]}], "]"}], "*", 
          RowBox[{"Boole", "[", 
           RowBox[{"!", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"0.125", "<", 
               SuperscriptBox["10", "ma"], "<", "0.14"}], "||", 
              RowBox[{"0.538", "<", 
               SuperscriptBox["10", "ma"], "<", "0.555"}], "||", 
              RowBox[{"0.94", "<", 
               SuperscriptBox["10", "ma"], "<", "0.974"}]}], ")"}]}], "]"}]}],
          "\[GreaterEqual]", "Nev"}], ",", 
        RowBox[{"{", 
         RowBox[{"ma", ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"mminmaxOverall", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Log10", "[", "0.125", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"ga", ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"yminmaxoverall", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"yminmaxoverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotPoints", "->", "200"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RegSens2", "=", 
      RowBox[{"RegionPlot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          FractionBox["Npot", "NpotDefault"], 
          RowBox[{"NevTot", "[", 
           RowBox[{
            SuperscriptBox["10", "ma"], ",", 
            SuperscriptBox["10", "ga"]}], "]"}], "*", 
          RowBox[{"Boole", "[", 
           RowBox[{"!", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"0.125", "<", 
               SuperscriptBox["10", "ma"], "<", "0.14"}], "||", 
              RowBox[{"0.538", "<", 
               SuperscriptBox["10", "ma"], "<", "0.555"}], "||", 
              RowBox[{"0.94", "<", 
               SuperscriptBox["10", "ma"], "<", "0.974"}]}], ")"}]}], "]"}]}],
          "\[GreaterEqual]", "Nev"}], ",", 
        RowBox[{"{", 
         RowBox[{"ma", ",", 
          RowBox[{"Log10", "[", "0.14", "]"}], ",", 
          RowBox[{"Log10", "[", "0.538", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"ga", ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"yminmaxoverall", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"yminmaxoverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotPoints", "->", "200"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RegSens3", "=", 
      RowBox[{"RegionPlot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          FractionBox["Npot", "NpotDefault"], 
          RowBox[{"NevTot", "[", 
           RowBox[{
            SuperscriptBox["10", "ma"], ",", 
            SuperscriptBox["10", "ga"]}], "]"}], "*", 
          RowBox[{"Boole", "[", 
           RowBox[{"!", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"0.125", "<", 
               SuperscriptBox["10", "ma"], "<", "0.14"}], "||", 
              RowBox[{"0.538", "<", 
               SuperscriptBox["10", "ma"], "<", "0.555"}], "||", 
              RowBox[{"0.94", "<", 
               SuperscriptBox["10", "ma"], "<", "0.974"}]}], ")"}]}], "]"}]}],
          "\[GreaterEqual]", "Nev"}], ",", 
        RowBox[{"{", 
         RowBox[{"ma", ",", 
          RowBox[{"Log10", "[", "0.538", "]"}], ",", 
          RowBox[{"Log10", "[", "0.94", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"ga", ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"yminmaxoverall", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"yminmaxoverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotPoints", "->", "200"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RegSens4", "=", 
      RowBox[{"RegionPlot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          FractionBox["Npot", "NpotDefault"], 
          RowBox[{"NevTot", "[", 
           RowBox[{
            SuperscriptBox["10", "ma"], ",", 
            SuperscriptBox["10", "ga"]}], "]"}], "*", 
          RowBox[{"Boole", "[", 
           RowBox[{"!", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"0.125", "<", 
               SuperscriptBox["10", "ma"], "<", "0.14"}], "||", 
              RowBox[{"0.538", "<", 
               SuperscriptBox["10", "ma"], "<", "0.555"}], "||", 
              RowBox[{"0.94", "<", 
               SuperscriptBox["10", "ma"], "<", "0.974"}]}], ")"}]}], "]"}]}],
          "\[GreaterEqual]", "Nev"}], ",", 
        RowBox[{"{", 
         RowBox[{"ma", ",", 
          RowBox[{"Log10", "[", "0.974", "]"}], ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"mminmaxOverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"ga", ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"yminmaxoverall", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"yminmaxoverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotPoints", "->", "200"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Sens", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"10", "^", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"10", "^", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], "&"}], "/@", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"Normal", "@", "RegSens"}], ",", 
              RowBox[{
               RowBox[{"Line", "[", "x_", "]"}], "\[RuleDelayed]", "x"}], ",",
               "Infinity"}], "]"}], "]"}], ",", "2"}], "]"}]}]}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"SensTemp", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"Normal", "@", "#"}], ",", 
          RowBox[{
           RowBox[{"Line", "[", "x_", "]"}], "\[RuleDelayed]", "x"}], ",", 
          "Infinity"}], "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{
        "RegSens1", ",", "RegSens2", ",", "RegSens3", ",", "RegSens4"}], 
        "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"SensTemp1", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"SensTemp", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"SensTemp", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"SensTemp", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", 
        RowBox[{"SensTemp", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Sens", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"10", "^", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"10", "^", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], "&"}], "/@", 
         RowBox[{"SensTemp1", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "SensTemp1", "]"}], ",", "1"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", 
          "\"\<Sensitivity domains\>\"", ",", 
          "\"\<ALPs with fermion coupling\>\"", ",", "ExperimentFolder", ",", 
          RowBox[{"ToString", "@", 
           RowBox[{"StringForm", "[", 
            RowBox[{
            "\"\<Sensitivity_ALP-fermion_at_``_Nev=``_Npot=``.xls\>\"", ",", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"{", 
               RowBox[{"ExperimentFolder", ",", 
                RowBox[{"Nev", "//", "ToString"}], ",", 
                RowBox[{
                 RowBox[{"Npot", "//", "CForm"}], "//", "ToString"}]}], 
               "}"}]}]}], "]"}]}]}], "}"}], "]"}], ",", "Sens"}], "]"}], ";", 
     "\[IndentingNewLine]", "Sens"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<The number of proton collisions:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"NpotVal", "=", 
  RowBox[{
   RowBox[{"DialogInput", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"br", "=", "NpotDefault"}], "}"}], ",", 
     RowBox[{"Column", "[", 
      RowBox[{"{", 
       RowBox[{"\"\<Enter the number of proton collisions\>\"", ",", 
        RowBox[{"InputField", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "br", "]"}], ",", "Expression"}], "]"}], 
        ",", 
        RowBox[{"Button", "[", 
         RowBox[{"\"\<Proceed\>\"", ",", 
          RowBox[{"DialogReturn", "[", "br", "]"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Automatic"}]}], "]"}]}], "}"}], 
      "]"}]}], "]"}], "//", "N"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<The minimal number of events \!\(\*SubscriptBox[\(N\), \(events, \
min\)]\) for which the sensitivity will be computed:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"NevMinVal", "=", 
  RowBox[{
   RowBox[{"DialogInput", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nev", "=", "2.3"}], "}"}], ",", 
     RowBox[{"Column", "[", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Enter the value of \!\(\*SubscriptBox[\(N\), \(events, min\)]\) \
for which the sensitivity will be computed:\>\"", ",", 
        RowBox[{"InputField", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "nev", "]"}], ",", "Expression"}], "]"}], 
        ",", 
        RowBox[{"Button", "[", 
         RowBox[{"\"\<Proceed\>\"", ",", 
          RowBox[{"DialogReturn", "[", "nev", "]"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Automatic"}]}], "]"}]}], "}"}], 
      "]"}]}], "]"}], "//", "N"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sens", "=", 
   RowBox[{"SensitivityBlock", "[", 
    RowBox[{"NevMinVal", ",", "NpotVal"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListLogLogPlot", "[", 
    RowBox[{
     RowBox[{"Cases", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"sens", ",", "BC10excluded"}], "}"}], ",", 
       RowBox[{"_", "?", "MatrixQ"}], ",", "All"}], "]"}], ",", 
     RowBox[{"Joined", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"True", ",", "True", ",", "True", ",", "True"}], "}"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(m\), \(a\)]\) [GeV]\>\"", " ", ",", " ", 
        "\"\<y\>\""}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", " ", "23"}], "]"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ConstantArray", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MatrixQ", "[", "sens", "]"}], ",", "1", ",", 
              RowBox[{"Length", "@", "sens"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Thick", ",", "Gray"}], "}"}], ",", "3"}], "]"}]}], 
         "}"}], ",", "1"}], "]"}]}], ",", 
     RowBox[{"Filling", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "sens", "]"}], "+", "1"}], "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"True", ",", 
           RowBox[{"Directive", "[", 
            RowBox[{"Gray", ",", 
             RowBox[{"Opacity", "[", "0.3", "]"}]}], "]"}]}], "}"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "sens", "]"}], "+", "2"}], "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"True", ",", 
           RowBox[{"Directive", "[", 
            RowBox[{"Gray", ",", 
             RowBox[{"Opacity", "[", "0.3", "]"}]}], "]"}]}], "}"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "sens", "]"}], "+", "3"}], "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"True", ",", 
           RowBox[{"Directive", "[", 
            RowBox[{"Gray", ",", 
             RowBox[{"Opacity", "[", "0.3", "]"}]}], "]"}]}], "}"}]}]}], 
       "}"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1.01", 
           RowBox[{"mminmaxOverall", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"1.1", 
           RowBox[{"mminmaxOverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"yminmaxoverall", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"0.99", 
           RowBox[{"yminmaxoverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{
          "\"\<\!\(\*SubscriptBox[\(N\), \(events\)]\) \[GreaterEqual] \>\"", 
           ",", "NevMinVal"}], "}"}], "]"}], ",", "18", ",", "Black"}], 
       "]"}]}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"Placed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"#", ",", "15"}], "]"}], "&"}], "/@", 
         RowBox[{"{", "ExperimentFolder", "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"0.2", ",", "0.15"}], "}"}]}], "]"}]}]}], "]"}], 
   RowBox[{"(*", 
    RowBox[{",", 
     RowBox[{"LogLogPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", 
         SuperscriptBox["x", "2"], ",", 
         SuperscriptBox["x", "3"], ",", 
         SuperscriptBox["x", "4"], ",", 
         SuperscriptBox["x", "5"], ",", 
         SuperscriptBox["x", "6"]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0.05", ",", "62.49"}], "}"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.006", "]"}], ",", "Blue"}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.006", "]"}], ",", 
            RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.006", "]"}], ",", 
            RowBox[{"Darker", "@", "Red"}], ",", 
            RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.006", "]"}], ",", "Black"}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.01", "]"}], ",", 
            RowBox[{"Darker", "@", "Cyan"}], ",", 
            RowBox[{"Dashing", "[", "0.007", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", 
             RowBox[{"Darker", "@", "Green"}]}], ",", 
            RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", "Red"}]}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"#", ",", "15"}], "]"}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{
            "\"\<SHiP\>\"", ",", 
             "\"\<\!\(\*SubscriptBox[\(SHADOWS\), \(specified\\\ in\\\ LoI\)]\
\)\>\"", ",", 
             "\"\<\!\(\*SubscriptBox[\(SHADOWS\), \(specified\\\ by\\\ \
Gaia\)]\)\>\"", ",", " ", 
             "\"\<\!\(\*SubscriptBox[\(SHADOWS\), \(collab\\\ estimate\)]\)\>\
\""}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"0.26", ",", "0.15"}], "}"}]}], "]"}]}]}], "]"}]}], "*)"}],
    ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{"Text", "[", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"\"\<Excluded\>\"", ",", "24", ",", "Black"}], "]"}], ",", 
       RowBox[{"Scaled", "[", 
        RowBox[{"{", 
         RowBox[{"0.7", ",", "0.95"}], "}"}], "]"}]}], "]"}], "}"}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8889936997762337`*^9, 3.8889937382921906`*^9}, {
   3.88899385262287*^9, 3.888993853042823*^9}, {3.8889939031947403`*^9, 
   3.8889939052817664`*^9}, {3.8889939588761787`*^9, 3.888994072394391*^9}, {
   3.8889941392721796`*^9, 3.8889941490041194`*^9}, {3.8889941930377913`*^9, 
   3.888994195131672*^9}, {3.8889942375929303`*^9, 3.888994293018688*^9}, 
   3.889155194091461*^9, {3.8891555444676304`*^9, 3.889155549549215*^9}, {
   3.893571069154917*^9, 3.893571071767774*^9}, {3.8935717622889104`*^9, 
   3.893571762661867*^9}, {3.8937449281930075`*^9, 3.8937449281930075`*^9}, {
   3.895052697251217*^9, 3.8950527065423837`*^9}, {3.895052741520686*^9, 
   3.895052773888977*^9}, {3.8950531140499244`*^9, 3.8950531238647213`*^9}, {
   3.8950534729321213`*^9, 3.8950534805926685`*^9}, {3.895054123563283*^9, 
   3.895054124582183*^9}, {3.89506997775191*^9, 3.895069978330577*^9}, 
   3.8950768982807426`*^9, {3.8955602490044713`*^9, 3.895560287932702*^9}, {
   3.895560370984571*^9, 3.8955603759796324`*^9}, {3.895560785367902*^9, 
   3.895560786049657*^9}, {3.8956541535400777`*^9, 3.895654263939839*^9}, {
   3.8956543140076876`*^9, 3.895654320367178*^9}, {3.895654423200385*^9, 
   3.8956544481154737`*^9}, {3.895654565591157*^9, 3.895654588365079*^9}, {
   3.8956549560646706`*^9, 3.8956549563255477`*^9}, {3.8961553899588184`*^9, 
   3.8961553997391524`*^9}, {3.897234346691803*^9, 3.897234358286152*^9}, {
   3.8975468465813923`*^9, 3.8975468508167267`*^9}, {3.8975468853793488`*^9, 
   3.897546895875827*^9}, {3.903791118494033*^9, 3.903791118498568*^9}, 
   3.9037950980239325`*^9, {3.9037970359365463`*^9, 3.903797035991943*^9}, 
   3.9037971257176876`*^9, {3.903797196741515*^9, 3.903797301701374*^9}, 
   3.903854322563696*^9, {3.906194481542715*^9, 3.9061945201280785`*^9}, {
   3.9072587100895395`*^9, 3.9072587160108223`*^9}},
 CellTags->{
  "Sensitivity", 
   "Re-evaluation"},ExpressionUUID->"9ff01d3d-2235-405c-ab36-8ec261f4d137"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Deleting generated cells", "Title",
 CellChangeTimes->{{3.9025559465149946`*^9, 3.9025559494966087`*^9}},
 CellTags->{
  "Re-evaluation", 
   "Sensitivity"},ExpressionUUID->"519ed843-8f32-4e91-84d0-5f5d5f152eee"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"relaunch", "=", 
  RowBox[{"dropdownDialog", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\"\<Yes\>\"", ",", "\"\<No\>\""}], "}"}], ",", 
    RowBox[{"Row", "[", 
     RowBox[{
     "{", "\"\<Would you like to re-launch the sensitivity calculation for \
another experiment after the given computation?\>\"", "}"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"relaunch", "==", "\"\<Yes\>\""}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nb", "=", 
     RowBox[{"EvaluationNotebook", "[", "]"}]}], ";", "\n", 
    RowBox[{"NotebookFind", "[", 
     RowBox[{
     "nb", ",", "\"\<Re-evaluation\>\"", ",", "All", ",", "CellTags"}], "]"}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"relaunch", "==", "\"\<No\>\""}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"deletecellsopt", "=", 
     RowBox[{"dropdownDialog", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<Yes\>\"", ",", "\"\<No\>\""}], "}"}], ",", 
       RowBox[{"Row", "[", 
        RowBox[{
        "{", "\"\<Would you like to remove all the generated output \
cells?\>\"", "}"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"deletecellsopt", "==", "\"\<Yes\>\""}], ",", 
      RowBox[{
      "FrontEndTokenExecute", "[", "\"\<DeleteGeneratedCells\>\"", "]"}]}], 
     "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.9025559062888603`*^9, 3.9025559062888603`*^9}, {
  3.902555964086707*^9, 3.902555989355214*^9}, {3.9025615684818387`*^9, 
  3.9025615698168364`*^9}, {3.902729327686987*^9, 3.9027293300327225`*^9}, {
  3.9027673630554657`*^9, 3.902767365763246*^9}, {3.9028567330422525`*^9, 
  3.902856748718687*^9}, {3.9039717334857006`*^9, 3.903971734143115*^9}},
 CellTags->{"Re-evaluation", "Sensitivity"},
 CellLabel->
  "In[679]:=",ExpressionUUID->"da6a725b-270d-45e0-bd71-6f5132a81d48"]
}, Open  ]]
},
WindowSize->{1027.5, 570.75},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
ShowCellTags->True,
Magnification:>0.8 Inherited,
FrontEndVersion->"13.2 for Microsoft Windows (64-bit) (November 18, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"ccc6192f-1aa7-4a75-996f-24f618e62e06"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Acceptance"->{
  Cell[5792, 158, 340, 6, 69, "Title",ExpressionUUID->"dc98cc40-afde-45ba-ae22-74afbd95ce04",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[6157, 168, 279, 5, 66, "Chapter",ExpressionUUID->"9e90539e-357b-496f-b4bb-a60bd5224fbd",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[6439, 175, 11043, 264, 790, "Input",ExpressionUUID->"81abd027-7ae4-4675-ae59-2bfc340f66bb",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[17507, 443, 457, 11, 67, "Section",ExpressionUUID->"7c55ffb2-0d9e-426c-8145-0f4c17afabe4",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[17967, 456, 3674, 102, 206, "Input",ExpressionUUID->"ff9f349f-4e9a-429c-bf55-03b67960b621",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[21690, 564, 639, 18, 66, "Chapter",ExpressionUUID->"490d0d1a-3e44-4a63-8903-e0e537cb7123",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[22354, 586, 271, 5, 66, "Section",ExpressionUUID->"78ee7ba3-4532-4920-80f8-e1fc4e784430",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[22628, 593, 9886, 254, 531, "Input",ExpressionUUID->"fec40a05-ba64-4ab5-86c9-a0eb22a607d0",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[32551, 852, 411, 7, 66, "Section",ExpressionUUID->"12e0bee4-6a1a-451c-b99f-fa0db8a155eb",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[32987, 863, 357, 6, 54, "Subsection",ExpressionUUID->"0a5caafb-270c-4b49-8d0a-a733f8c6fed5",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[33347, 871, 4660, 120, 258, "Input",ExpressionUUID->"6b40e71e-4d73-422f-a8a1-e2d1d3309f91",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[38068, 998, 265, 6, 66, "Chapter",ExpressionUUID->"c9967d9e-0dfa-4ef8-95ab-cf6e6b36fed3",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[38358, 1008, 259, 5, 54, "Subsection",ExpressionUUID->"77ee91eb-9cfb-4628-805f-ec9b94526fb9",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[38620, 1015, 7671, 183, 281, "Input",ExpressionUUID->"32dd4f2f-1ac0-470c-95e5-55c362bea948",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[46328, 1203, 260, 5, 54, "Subsection",ExpressionUUID->"a1fbc33e-9a65-4c68-8299-5eb60b8c134b",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[46591, 1210, 7524, 181, 281, "Input",ExpressionUUID->"c0481e96-de9b-4b81-92c2-b7f086453260",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[54176, 1398, 246, 5, 69, "Title",ExpressionUUID->"bd147158-f526-489d-afb7-12c825eddce3",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[54425, 1405, 4925, 121, 278, "Input",ExpressionUUID->"c05031d8-0efd-4502-a294-675e6231eb7c",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[59375, 1530, 224, 4, 66, "Chapter",ExpressionUUID->"f6b19458-661d-4b9a-84b2-be5f3bbf270c",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[59602, 1536, 1957, 47, 248, "Input",ExpressionUUID->"4c060b6c-ecc3-4469-86c0-269c265b419b",
   CellTags->{"Number-of-events", "Acceptance"}]},
 "Acceptance-computation"->{
  Cell[61837, 1597, 304, 6, 66, "Chapter",ExpressionUUID->"4cb86986-b7a3-4409-91ed-f7461f351ed0",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[62144, 1605, 21598, 578, 844, "Input",ExpressionUUID->"5e37716e-c5ef-4959-a8f2-3412a62b2217",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[83779, 2188, 499, 8, 66, "Chapter",ExpressionUUID->"9c0a6fa2-083d-438f-84cb-5fa122f734c4",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[84303, 2200, 343, 7, 66, "Section",ExpressionUUID->"272bdbd8-414b-4e3f-abc9-1cfc79f82795",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[84649, 2209, 3568, 78, 278, "Input",ExpressionUUID->"c2e1f390-8eeb-4f4b-823d-659fa5eaeb0e",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[88242, 2291, 248, 5, 54, "Subsection",ExpressionUUID->"888f7dff-ab99-41c0-b897-159b52ae3fe1",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[88493, 2298, 15608, 364, 587, "Input",ExpressionUUID->"89608f05-b91a-4977-9b44-4a2a5451a6ae",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[104138, 2667, 402, 9, 54, "Subsection",ExpressionUUID->"11ae4d55-c8c0-431e-bf80-f13a64697e88",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[104565, 2680, 245, 5, 47, "Subsubsection",ExpressionUUID->"634a1178-f388-46bb-8612-dee03ec19c49",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[104813, 2687, 20834, 514, 766, "Input",ExpressionUUID->"b6c14546-6f66-42c6-b926-1e9c5a1be97c",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[125951, 3217, 233, 5, 66, "Section",ExpressionUUID->"b0772e57-8882-4e3d-a1f7-c9c6f58dc7ac",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[126209, 3226, 291, 7, 54, "Subsection",ExpressionUUID->"527871dc-8ba8-4387-abde-9e9eb8d8ab6d",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[126503, 3235, 8057, 206, 340, "Input",ExpressionUUID->"b9365511-4a55-4c8f-a5bb-71604d175873",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[134597, 3446, 276, 5, 54, "Subsection",ExpressionUUID->"1941173e-e2fc-4b86-910f-f0ae2d58c545",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[134876, 3453, 8895, 227, 343, "Input",ExpressionUUID->"56dc563a-f204-42ed-92d5-4178465a4587",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[143808, 3685, 351, 8, 54, "Subsection",ExpressionUUID->"09bda361-200e-4474-a4eb-51f045b744b2",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[144184, 3697, 266, 5, 47, "Subsubsection",ExpressionUUID->"310ab4ae-abf8-473c-91d1-fbd6da1eee7d",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[144453, 3704, 6614, 164, 287, "Input",ExpressionUUID->"db6fa112-734d-4c0b-bb6e-89495929f1dc",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[151104, 3873, 320, 6, 47, "Subsubsection",ExpressionUUID->"412f2b64-f66f-4f79-8961-cbd8cee5cd4c",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[151427, 3881, 6171, 145, 300, "Input",ExpressionUUID->"06159947-5912-4f17-9c32-3847f74c6719",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[157635, 4031, 267, 6, 47, "Subsubsection",ExpressionUUID->"5e750db1-dfad-49e9-8b9d-ffa968b87add",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[157905, 4039, 3840, 85, 247, "Input",ExpressionUUID->"306022e5-63c1-4a7e-a916-61fc87f47d67",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[161806, 4131, 333, 6, 66, "Section",ExpressionUUID->"5dd0508c-7522-497d-88fa-c56f756f8b51",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[162142, 4139, 15363, 391, 570, "Input",ExpressionUUID->"e596472c-a488-4d38-bf82-f6d092e93877",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[177530, 4534, 272, 5, 54, "Subsection",ExpressionUUID->"1f64e19f-68db-451d-9c11-af942b7e295b",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[177827, 4543, 237, 5, 47, "Subsubsection",ExpressionUUID->"302d1c5e-c6d1-4ad1-a0b1-edca90a5022b",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[178067, 4550, 4686, 112, 343, "Input",ExpressionUUID->"2013639a-846d-4ea2-a0b9-81d0edd1cc67",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}]},
 "Number-of-events"->{
  Cell[5792, 158, 340, 6, 69, "Title",ExpressionUUID->"dc98cc40-afde-45ba-ae22-74afbd95ce04",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[6157, 168, 279, 5, 66, "Chapter",ExpressionUUID->"9e90539e-357b-496f-b4bb-a60bd5224fbd",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[6439, 175, 11043, 264, 790, "Input",ExpressionUUID->"81abd027-7ae4-4675-ae59-2bfc340f66bb",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[17507, 443, 457, 11, 67, "Section",ExpressionUUID->"7c55ffb2-0d9e-426c-8145-0f4c17afabe4",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[17967, 456, 3674, 102, 206, "Input",ExpressionUUID->"ff9f349f-4e9a-429c-bf55-03b67960b621",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[21690, 564, 639, 18, 66, "Chapter",ExpressionUUID->"490d0d1a-3e44-4a63-8903-e0e537cb7123",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[22354, 586, 271, 5, 66, "Section",ExpressionUUID->"78ee7ba3-4532-4920-80f8-e1fc4e784430",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[22628, 593, 9886, 254, 531, "Input",ExpressionUUID->"fec40a05-ba64-4ab5-86c9-a0eb22a607d0",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[32551, 852, 411, 7, 66, "Section",ExpressionUUID->"12e0bee4-6a1a-451c-b99f-fa0db8a155eb",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[32987, 863, 357, 6, 54, "Subsection",ExpressionUUID->"0a5caafb-270c-4b49-8d0a-a733f8c6fed5",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[33347, 871, 4660, 120, 258, "Input",ExpressionUUID->"6b40e71e-4d73-422f-a8a1-e2d1d3309f91",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[38068, 998, 265, 6, 66, "Chapter",ExpressionUUID->"c9967d9e-0dfa-4ef8-95ab-cf6e6b36fed3",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[38358, 1008, 259, 5, 54, "Subsection",ExpressionUUID->"77ee91eb-9cfb-4628-805f-ec9b94526fb9",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[38620, 1015, 7671, 183, 281, "Input",ExpressionUUID->"32dd4f2f-1ac0-470c-95e5-55c362bea948",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[46328, 1203, 260, 5, 54, "Subsection",ExpressionUUID->"a1fbc33e-9a65-4c68-8299-5eb60b8c134b",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[46591, 1210, 7524, 181, 281, "Input",ExpressionUUID->"c0481e96-de9b-4b81-92c2-b7f086453260",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[54176, 1398, 246, 5, 69, "Title",ExpressionUUID->"bd147158-f526-489d-afb7-12c825eddce3",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[54425, 1405, 4925, 121, 278, "Input",ExpressionUUID->"c05031d8-0efd-4502-a294-675e6231eb7c",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[59375, 1530, 224, 4, 66, "Chapter",ExpressionUUID->"f6b19458-661d-4b9a-84b2-be5f3bbf270c",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[59602, 1536, 1957, 47, 248, "Input",ExpressionUUID->"4c060b6c-ecc3-4469-86c0-269c265b419b",
   CellTags->{"Number-of-events", "Acceptance"}]},
 "Number-of-events-computation"->{
  Cell[61608, 1589, 204, 4, 69, "Title",ExpressionUUID->"3e9a02fd-97c3-44ee-9f5b-9ca3983b66da",
   CellTags->"Number-of-events-computation"],
  Cell[61837, 1597, 304, 6, 66, "Chapter",ExpressionUUID->"4cb86986-b7a3-4409-91ed-f7461f351ed0",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[62144, 1605, 21598, 578, 844, "Input",ExpressionUUID->"5e37716e-c5ef-4959-a8f2-3412a62b2217",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[83779, 2188, 499, 8, 66, "Chapter",ExpressionUUID->"9c0a6fa2-083d-438f-84cb-5fa122f734c4",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[84303, 2200, 343, 7, 66, "Section",ExpressionUUID->"272bdbd8-414b-4e3f-abc9-1cfc79f82795",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[84649, 2209, 3568, 78, 278, "Input",ExpressionUUID->"c2e1f390-8eeb-4f4b-823d-659fa5eaeb0e",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[88242, 2291, 248, 5, 54, "Subsection",ExpressionUUID->"888f7dff-ab99-41c0-b897-159b52ae3fe1",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[88493, 2298, 15608, 364, 587, "Input",ExpressionUUID->"89608f05-b91a-4977-9b44-4a2a5451a6ae",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[104138, 2667, 402, 9, 54, "Subsection",ExpressionUUID->"11ae4d55-c8c0-431e-bf80-f13a64697e88",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[104565, 2680, 245, 5, 47, "Subsubsection",ExpressionUUID->"634a1178-f388-46bb-8612-dee03ec19c49",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[104813, 2687, 20834, 514, 766, "Input",ExpressionUUID->"b6c14546-6f66-42c6-b926-1e9c5a1be97c",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[125720, 3209, 206, 4, 66, "Chapter",ExpressionUUID->"913a2300-dec2-4b0f-8b44-4b75cf0adccf",
   CellTags->"Number-of-events-computation"],
  Cell[125951, 3217, 233, 5, 66, "Section",ExpressionUUID->"b0772e57-8882-4e3d-a1f7-c9c6f58dc7ac",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[126209, 3226, 291, 7, 54, "Subsection",ExpressionUUID->"527871dc-8ba8-4387-abde-9e9eb8d8ab6d",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[126503, 3235, 8057, 206, 340, "Input",ExpressionUUID->"b9365511-4a55-4c8f-a5bb-71604d175873",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[134597, 3446, 276, 5, 54, "Subsection",ExpressionUUID->"1941173e-e2fc-4b86-910f-f0ae2d58c545",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[134876, 3453, 8895, 227, 343, "Input",ExpressionUUID->"56dc563a-f204-42ed-92d5-4178465a4587",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[143808, 3685, 351, 8, 54, "Subsection",ExpressionUUID->"09bda361-200e-4474-a4eb-51f045b744b2",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[144184, 3697, 266, 5, 47, "Subsubsection",ExpressionUUID->"310ab4ae-abf8-473c-91d1-fbd6da1eee7d",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[144453, 3704, 6614, 164, 287, "Input",ExpressionUUID->"db6fa112-734d-4c0b-bb6e-89495929f1dc",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[151104, 3873, 320, 6, 47, "Subsubsection",ExpressionUUID->"412f2b64-f66f-4f79-8961-cbd8cee5cd4c",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[151427, 3881, 6171, 145, 300, "Input",ExpressionUUID->"06159947-5912-4f17-9c32-3847f74c6719",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[157635, 4031, 267, 6, 47, "Subsubsection",ExpressionUUID->"5e750db1-dfad-49e9-8b9d-ffa968b87add",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[157905, 4039, 3840, 85, 247, "Input",ExpressionUUID->"306022e5-63c1-4a7e-a916-61fc87f47d67",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[161806, 4131, 333, 6, 66, "Section",ExpressionUUID->"5dd0508c-7522-497d-88fa-c56f756f8b51",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[162142, 4139, 15363, 391, 570, "Input",ExpressionUUID->"e596472c-a488-4d38-bf82-f6d092e93877",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[177530, 4534, 272, 5, 54, "Subsection",ExpressionUUID->"1f64e19f-68db-451d-9c11-af942b7e295b",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[177827, 4543, 237, 5, 47, "Subsubsection",ExpressionUUID->"302d1c5e-c6d1-4ad1-a0b1-edca90a5022b",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[178067, 4550, 4686, 112, 343, "Input",ExpressionUUID->"2013639a-846d-4ea2-a0b9-81d0edd1cc67",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[183428, 4688, 206, 4, 66, "Section",ExpressionUUID->"d97cf69b-14d7-4226-84be-25aa41979380",
   CellTags->"Number-of-events-computation"],
  Cell[183659, 4696, 265, 5, 54, "Subsection",ExpressionUUID->"42ab82d5-4d7e-4d06-8eb9-6e821b04db69",
   CellTags->"Number-of-events-computation"],
  Cell[183927, 4703, 4939, 115, 188, "Input",ExpressionUUID->"963c4344-4087-43c6-b6e8-508b30bff543",
   CellTags->"Number-of-events-computation"],
  Cell[188903, 4823, 342, 8, 54, "Subsection",ExpressionUUID->"eadf166c-43bc-48fd-b978-8f5e610e46ab",
   CellTags->"Number-of-events-computation"],
  Cell[189248, 4833, 5828, 140, 199, "Input",ExpressionUUID->"92da45d9-8d3d-47de-957a-1a264ba0ad10",
   CellTags->"Number-of-events-computation"],
  Cell[195101, 4977, 202, 4, 47, "Subsubsection",ExpressionUUID->"b2664c72-6d2a-4377-a483-21ff81ad0559",
   CellTags->"Number-of-events-computation"],
  Cell[195306, 4983, 8204, 197, 267, "Input",ExpressionUUID->"6608ca61-80df-4c49-a1f8-56118e7339da",
   CellTags->"Number-of-events-computation"],
  Cell[203559, 5186, 220, 4, 54, "Subsection",ExpressionUUID->"748b8b59-c490-462f-bf37-7dc6537c8d0d",
   CellTags->"Number-of-events-computation"],
  Cell[203782, 5192, 22594, 550, 813, "Input",ExpressionUUID->"46c1a4a5-1c46-489a-a061-206c6b7873bc",
   CellTags->"Number-of-events-computation"],
  Cell[226449, 5750, 250, 5, 69, "Title",ExpressionUUID->"0923b405-c0ba-437a-a0a1-eb2d8707c8c5",
   CellTags->"Number-of-events-computation"],
  Cell[226724, 5759, 201, 4, 65, "Chapter",ExpressionUUID->"2ada0cc1-1695-4a57-a86b-b11e240b979f",
   CellTags->"Number-of-events-computation"],
  Cell[226928, 5765, 7402, 157, 298, "Input",ExpressionUUID->"d36d89ea-2d97-457b-aa5b-4b098e8235d8",
   CellTags->"Number-of-events-computation"],
  Cell[234367, 5927, 197, 4, 65, "Chapter",ExpressionUUID->"a58bd3a7-f345-470d-ba5e-82c520e24a7e",
   CellTags->"Number-of-events-computation"],
  Cell[234589, 5935, 209, 4, 64, "Section",ExpressionUUID->"d9a2b292-24ca-4f51-9905-1bcde103c869",
   CellTags->"Number-of-events-computation"],
  Cell[234801, 5941, 3113, 71, 142, "Input",ExpressionUUID->"b5ddb613-f8ce-4354-bf3e-3dc63b62f3d5",
   CellTags->"Number-of-events-computation"],
  Cell[237951, 6017, 350, 6, 64, "Section",ExpressionUUID->"168fde9a-2458-4e60-a88f-8cb7595771cb",
   CellTags->"Number-of-events-computation"],
  Cell[238304, 6025, 429, 10, 32, "Input",ExpressionUUID->"c0da0c6d-6988-4b78-bde2-c9a416e59d5a",
   CellTags->"Number-of-events-computation"],
  Cell[238770, 6040, 453, 12, 64, "Section",ExpressionUUID->"46608a90-91e3-49a0-b2e7-5a7cb3d4118d",
   CellTags->"Number-of-events-computation"],
  Cell[239226, 6054, 1132, 20, 35, "Input",ExpressionUUID->"dda9eaf9-70b3-41b6-aa9f-05447750c383",
   CellTags->"Number-of-events-computation"],
  Cell[240395, 6079, 305, 6, 64, "Section",ExpressionUUID->"adef9038-3c90-4d63-9685-663b3972f0a8",
   CellTags->"Number-of-events-computation"],
  Cell[240703, 6087, 1109, 19, 32, "Input",ExpressionUUID->"a38eea6f-c52b-4931-9cc5-cb09ca702395",
   CellTags->"Number-of-events-computation"],
  Cell[241849, 6111, 372, 6, 64, "Section",ExpressionUUID->"1a74cb31-7815-4595-8f2e-52cebfb9e416",
   CellTags->"Number-of-events-computation"],
  Cell[242224, 6119, 1087, 19, 32, "Input",ExpressionUUID->"9a62fcbe-cfe2-40d5-9514-39b21e90fd25",
   CellTags->"Number-of-events-computation"],
  Cell[243348, 6143, 408, 7, 64, "Section",ExpressionUUID->"f3460011-e0e7-485d-b7d1-d4fc48b1193d",
   CellTags->"Number-of-events-computation"],
  Cell[243759, 6152, 1137, 19, 32, "Input",ExpressionUUID->"965e1996-69d5-4edd-bef1-51b13fe3df5a",
   CellTags->"Number-of-events-computation"]},
 "Re-evaluation"->{
  Cell[244957, 6178, 212, 4, 69, "Title",ExpressionUUID->"43632709-93c8-43ea-aac4-c4cdd9738fd6",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[245194, 6186, 324, 7, 66, "Chapter",ExpressionUUID->"4f28db5f-3e98-48c2-a98d-ef371754d56f",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[245521, 6195, 19056, 517, 781, "Input",ExpressionUUID->"933c8a14-e475-435b-9eee-64b877f62c55",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[264602, 6716, 409, 11, 66, "Section",ExpressionUUID->"d1f628ba-3bad-4159-94f9-0c8b5549e590",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[265014, 6729, 4702, 121, 141, "Input",ExpressionUUID->"30f23ecc-adae-4e4e-bb37-3bcb631d2638",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[269765, 6856, 219, 4, 66, "Chapter",ExpressionUUID->"70b84e06-d773-437f-8360-f1845520d830",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[270009, 6864, 206, 4, 66, "Section",ExpressionUUID->"f8bcca72-97f4-4877-af48-43288ca88e21",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[270218, 6870, 613, 16, 50, "Input",ExpressionUUID->"c305b913-cdc5-4677-8d25-2c15d3b88372",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[270868, 6891, 205, 4, 66, "Section",ExpressionUUID->"93105a27-56ff-4fc6-9267-69c09e4a4e65",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[271076, 6897, 19681, 496, 714, "Input",ExpressionUUID->"9ff01d3d-2235-405c-ab36-8ec261f4d137",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[290818, 7400, 218, 4, 89, "Title",ExpressionUUID->"519ed843-8f32-4e91-84d0-5f5d5f152eee",
   CellTags->{"Re-evaluation", "Sensitivity"}],
  Cell[291039, 7406, 2733, 67, 187, "Input",ExpressionUUID->"da6a725b-270d-45e0-bd71-6f5132a81d48",
   CellTags->{"Re-evaluation", "Sensitivity"}]},
 "Sensitivity"->{
  Cell[244957, 6178, 212, 4, 69, "Title",ExpressionUUID->"43632709-93c8-43ea-aac4-c4cdd9738fd6",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[245194, 6186, 324, 7, 66, "Chapter",ExpressionUUID->"4f28db5f-3e98-48c2-a98d-ef371754d56f",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[245521, 6195, 19056, 517, 781, "Input",ExpressionUUID->"933c8a14-e475-435b-9eee-64b877f62c55",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[264602, 6716, 409, 11, 66, "Section",ExpressionUUID->"d1f628ba-3bad-4159-94f9-0c8b5549e590",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[265014, 6729, 4702, 121, 141, "Input",ExpressionUUID->"30f23ecc-adae-4e4e-bb37-3bcb631d2638",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[269765, 6856, 219, 4, 66, "Chapter",ExpressionUUID->"70b84e06-d773-437f-8360-f1845520d830",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[270009, 6864, 206, 4, 66, "Section",ExpressionUUID->"f8bcca72-97f4-4877-af48-43288ca88e21",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[270218, 6870, 613, 16, 50, "Input",ExpressionUUID->"c305b913-cdc5-4677-8d25-2c15d3b88372",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[270868, 6891, 205, 4, 66, "Section",ExpressionUUID->"93105a27-56ff-4fc6-9267-69c09e4a4e65",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[271076, 6897, 19681, 496, 714, "Input",ExpressionUUID->"9ff01d3d-2235-405c-ab36-8ec261f4d137",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[290818, 7400, 218, 4, 89, "Title",ExpressionUUID->"519ed843-8f32-4e91-84d0-5f5d5f152eee",
   CellTags->{"Re-evaluation", "Sensitivity"}],
  Cell[291039, 7406, 2733, 67, 187, "Input",ExpressionUUID->"da6a725b-270d-45e0-bd71-6f5132a81d48",
   CellTags->{"Re-evaluation", "Sensitivity"}]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Acceptance", 294196, 7489},
 {"Acceptance-computation", 297194, 7530},
 {"Number-of-events", 301954, 7585},
 {"Number-of-events-computation", 304958, 7626},
 {"Re-evaluation", 313652, 7735},
 {"Sensitivity", 315440, 7760}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 207, 3, 78, "Title",ExpressionUUID->"0839ea5b-1982-4dfb-8c5d-195bcd99f6e9"],
Cell[790, 27, 4965, 126, 344, "Input",ExpressionUUID->"3ff672e3-e982-49fe-8fe3-e69285f06990"]
}, Closed]],
Cell[CellGroupData[{
Cell[5792, 158, 340, 6, 69, "Title",ExpressionUUID->"dc98cc40-afde-45ba-ae22-74afbd95ce04",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[CellGroupData[{
Cell[6157, 168, 279, 5, 66, "Chapter",ExpressionUUID->"9e90539e-357b-496f-b4bb-a60bd5224fbd",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[6439, 175, 11043, 264, 790, "Input",ExpressionUUID->"81abd027-7ae4-4675-ae59-2bfc340f66bb",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[CellGroupData[{
Cell[17507, 443, 457, 11, 67, "Section",ExpressionUUID->"7c55ffb2-0d9e-426c-8145-0f4c17afabe4",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[17967, 456, 3674, 102, 206, "Input",ExpressionUUID->"ff9f349f-4e9a-429c-bf55-03b67960b621",
 CellTags->{"Number-of-events", "Acceptance"}]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[21690, 564, 639, 18, 66, "Chapter",ExpressionUUID->"490d0d1a-3e44-4a63-8903-e0e537cb7123",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[CellGroupData[{
Cell[22354, 586, 271, 5, 66, "Section",ExpressionUUID->"78ee7ba3-4532-4920-80f8-e1fc4e784430",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[22628, 593, 9886, 254, 531, "Input",ExpressionUUID->"fec40a05-ba64-4ab5-86c9-a0eb22a607d0",
 CellTags->{"Number-of-events", "Acceptance"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[32551, 852, 411, 7, 66, "Section",ExpressionUUID->"12e0bee4-6a1a-451c-b99f-fa0db8a155eb",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[CellGroupData[{
Cell[32987, 863, 357, 6, 54, "Subsection",ExpressionUUID->"0a5caafb-270c-4b49-8d0a-a733f8c6fed5",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[33347, 871, 4660, 120, 258, "Input",ExpressionUUID->"6b40e71e-4d73-422f-a8a1-e2d1d3309f91",
 CellTags->{"Number-of-events", "Acceptance"}]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[38068, 998, 265, 6, 66, "Chapter",ExpressionUUID->"c9967d9e-0dfa-4ef8-95ab-cf6e6b36fed3",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[CellGroupData[{
Cell[38358, 1008, 259, 5, 54, "Subsection",ExpressionUUID->"77ee91eb-9cfb-4628-805f-ec9b94526fb9",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[38620, 1015, 7671, 183, 281, "Input",ExpressionUUID->"32dd4f2f-1ac0-470c-95e5-55c362bea948",
 CellTags->{"Number-of-events", "Acceptance"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[46328, 1203, 260, 5, 54, "Subsection",ExpressionUUID->"a1fbc33e-9a65-4c68-8299-5eb60b8c134b",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[46591, 1210, 7524, 181, 281, "Input",ExpressionUUID->"c0481e96-de9b-4b81-92c2-b7f086453260",
 CellTags->{"Number-of-events", "Acceptance"}]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[54176, 1398, 246, 5, 69, "Title",ExpressionUUID->"bd147158-f526-489d-afb7-12c825eddce3",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[54425, 1405, 4925, 121, 278, "Input",ExpressionUUID->"c05031d8-0efd-4502-a294-675e6231eb7c",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[CellGroupData[{
Cell[59375, 1530, 224, 4, 66, "Chapter",ExpressionUUID->"f6b19458-661d-4b9a-84b2-be5f3bbf270c",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[59602, 1536, 1957, 47, 248, "Input",ExpressionUUID->"4c060b6c-ecc3-4469-86c0-269c265b419b",
 CellTags->{"Number-of-events", "Acceptance"}]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[61608, 1589, 204, 4, 69, "Title",ExpressionUUID->"3e9a02fd-97c3-44ee-9f5b-9ca3983b66da",
 CellTags->"Number-of-events-computation"],
Cell[CellGroupData[{
Cell[61837, 1597, 304, 6, 66, "Chapter",ExpressionUUID->"4cb86986-b7a3-4409-91ed-f7461f351ed0",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[62144, 1605, 21598, 578, 844, "Input",ExpressionUUID->"5e37716e-c5ef-4959-a8f2-3412a62b2217",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[83779, 2188, 499, 8, 66, "Chapter",ExpressionUUID->"9c0a6fa2-083d-438f-84cb-5fa122f734c4",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[84303, 2200, 343, 7, 66, "Section",ExpressionUUID->"272bdbd8-414b-4e3f-abc9-1cfc79f82795",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[84649, 2209, 3568, 78, 278, "Input",ExpressionUUID->"c2e1f390-8eeb-4f4b-823d-659fa5eaeb0e",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[88242, 2291, 248, 5, 54, "Subsection",ExpressionUUID->"888f7dff-ab99-41c0-b897-159b52ae3fe1",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[88493, 2298, 15608, 364, 587, "Input",ExpressionUUID->"89608f05-b91a-4977-9b44-4a2a5451a6ae",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[104138, 2667, 402, 9, 54, "Subsection",ExpressionUUID->"11ae4d55-c8c0-431e-bf80-f13a64697e88",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[104565, 2680, 245, 5, 47, "Subsubsection",ExpressionUUID->"634a1178-f388-46bb-8612-dee03ec19c49",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[104813, 2687, 20834, 514, 766, "Input",ExpressionUUID->"b6c14546-6f66-42c6-b926-1e9c5a1be97c",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[125720, 3209, 206, 4, 66, "Chapter",ExpressionUUID->"913a2300-dec2-4b0f-8b44-4b75cf0adccf",
 CellTags->"Number-of-events-computation"],
Cell[CellGroupData[{
Cell[125951, 3217, 233, 5, 66, "Section",ExpressionUUID->"b0772e57-8882-4e3d-a1f7-c9c6f58dc7ac",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[126209, 3226, 291, 7, 54, "Subsection",ExpressionUUID->"527871dc-8ba8-4387-abde-9e9eb8d8ab6d",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[126503, 3235, 8057, 206, 340, "Input",ExpressionUUID->"b9365511-4a55-4c8f-a5bb-71604d175873",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[134597, 3446, 276, 5, 54, "Subsection",ExpressionUUID->"1941173e-e2fc-4b86-910f-f0ae2d58c545",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[134876, 3453, 8895, 227, 343, "Input",ExpressionUUID->"56dc563a-f204-42ed-92d5-4178465a4587",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[143808, 3685, 351, 8, 54, "Subsection",ExpressionUUID->"09bda361-200e-4474-a4eb-51f045b744b2",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[144184, 3697, 266, 5, 47, "Subsubsection",ExpressionUUID->"310ab4ae-abf8-473c-91d1-fbd6da1eee7d",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[144453, 3704, 6614, 164, 287, "Input",ExpressionUUID->"db6fa112-734d-4c0b-bb6e-89495929f1dc",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[151104, 3873, 320, 6, 47, "Subsubsection",ExpressionUUID->"412f2b64-f66f-4f79-8961-cbd8cee5cd4c",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[151427, 3881, 6171, 145, 300, "Input",ExpressionUUID->"06159947-5912-4f17-9c32-3847f74c6719",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[157635, 4031, 267, 6, 47, "Subsubsection",ExpressionUUID->"5e750db1-dfad-49e9-8b9d-ffa968b87add",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[157905, 4039, 3840, 85, 247, "Input",ExpressionUUID->"306022e5-63c1-4a7e-a916-61fc87f47d67",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[161806, 4131, 333, 6, 66, "Section",ExpressionUUID->"5dd0508c-7522-497d-88fa-c56f756f8b51",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[162142, 4139, 15363, 391, 570, "Input",ExpressionUUID->"e596472c-a488-4d38-bf82-f6d092e93877",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[177530, 4534, 272, 5, 54, "Subsection",ExpressionUUID->"1f64e19f-68db-451d-9c11-af942b7e295b",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[177827, 4543, 237, 5, 47, "Subsubsection",ExpressionUUID->"302d1c5e-c6d1-4ad1-a0b1-edca90a5022b",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[178067, 4550, 4686, 112, 343, "Input",ExpressionUUID->"2013639a-846d-4ea2-a0b9-81d0edd1cc67",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[182756, 4664, 611, 17, 22, "Input",ExpressionUUID->"2df6a9d4-8288-4364-a432-21ff29933e0e"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[183428, 4688, 206, 4, 66, "Section",ExpressionUUID->"d97cf69b-14d7-4226-84be-25aa41979380",
 CellTags->"Number-of-events-computation"],
Cell[CellGroupData[{
Cell[183659, 4696, 265, 5, 54, "Subsection",ExpressionUUID->"42ab82d5-4d7e-4d06-8eb9-6e821b04db69",
 CellTags->"Number-of-events-computation"],
Cell[183927, 4703, 4939, 115, 188, "Input",ExpressionUUID->"963c4344-4087-43c6-b6e8-508b30bff543",
 CellTags->"Number-of-events-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[188903, 4823, 342, 8, 54, "Subsection",ExpressionUUID->"eadf166c-43bc-48fd-b978-8f5e610e46ab",
 CellTags->"Number-of-events-computation"],
Cell[189248, 4833, 5828, 140, 199, "Input",ExpressionUUID->"92da45d9-8d3d-47de-957a-1a264ba0ad10",
 CellTags->"Number-of-events-computation"],
Cell[CellGroupData[{
Cell[195101, 4977, 202, 4, 47, "Subsubsection",ExpressionUUID->"b2664c72-6d2a-4377-a483-21ff81ad0559",
 CellTags->"Number-of-events-computation"],
Cell[195306, 4983, 8204, 197, 267, "Input",ExpressionUUID->"6608ca61-80df-4c49-a1f8-56118e7339da",
 CellTags->"Number-of-events-computation"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[203559, 5186, 220, 4, 54, "Subsection",ExpressionUUID->"748b8b59-c490-462f-bf37-7dc6537c8d0d",
 CellTags->"Number-of-events-computation"],
Cell[203782, 5192, 22594, 550, 813, "Input",ExpressionUUID->"46c1a4a5-1c46-489a-a061-206c6b7873bc",
 CellTags->"Number-of-events-computation"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[226449, 5750, 250, 5, 69, "Title",ExpressionUUID->"0923b405-c0ba-437a-a0a1-eb2d8707c8c5",
 CellTags->"Number-of-events-computation"],
Cell[CellGroupData[{
Cell[226724, 5759, 201, 4, 65, "Chapter",ExpressionUUID->"2ada0cc1-1695-4a57-a86b-b11e240b979f",
 CellTags->"Number-of-events-computation"],
Cell[226928, 5765, 7402, 157, 298, "Input",ExpressionUUID->"d36d89ea-2d97-457b-aa5b-4b098e8235d8",
 CellTags->"Number-of-events-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[234367, 5927, 197, 4, 65, "Chapter",ExpressionUUID->"a58bd3a7-f345-470d-ba5e-82c520e24a7e",
 CellTags->"Number-of-events-computation"],
Cell[CellGroupData[{
Cell[234589, 5935, 209, 4, 64, "Section",ExpressionUUID->"d9a2b292-24ca-4f51-9905-1bcde103c869",
 CellTags->"Number-of-events-computation"],
Cell[234801, 5941, 3113, 71, 142, "Input",ExpressionUUID->"b5ddb613-f8ce-4354-bf3e-3dc63b62f3d5",
 CellTags->"Number-of-events-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[237951, 6017, 350, 6, 64, "Section",ExpressionUUID->"168fde9a-2458-4e60-a88f-8cb7595771cb",
 CellTags->"Number-of-events-computation"],
Cell[238304, 6025, 429, 10, 32, "Input",ExpressionUUID->"c0da0c6d-6988-4b78-bde2-c9a416e59d5a",
 CellTags->"Number-of-events-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[238770, 6040, 453, 12, 64, "Section",ExpressionUUID->"46608a90-91e3-49a0-b2e7-5a7cb3d4118d",
 CellTags->"Number-of-events-computation"],
Cell[239226, 6054, 1132, 20, 35, "Input",ExpressionUUID->"dda9eaf9-70b3-41b6-aa9f-05447750c383",
 CellTags->"Number-of-events-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[240395, 6079, 305, 6, 64, "Section",ExpressionUUID->"adef9038-3c90-4d63-9685-663b3972f0a8",
 CellTags->"Number-of-events-computation"],
Cell[240703, 6087, 1109, 19, 32, "Input",ExpressionUUID->"a38eea6f-c52b-4931-9cc5-cb09ca702395",
 CellTags->"Number-of-events-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[241849, 6111, 372, 6, 64, "Section",ExpressionUUID->"1a74cb31-7815-4595-8f2e-52cebfb9e416",
 CellTags->"Number-of-events-computation"],
Cell[242224, 6119, 1087, 19, 32, "Input",ExpressionUUID->"9a62fcbe-cfe2-40d5-9514-39b21e90fd25",
 CellTags->"Number-of-events-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[243348, 6143, 408, 7, 64, "Section",ExpressionUUID->"f3460011-e0e7-485d-b7d1-d4fc48b1193d",
 CellTags->"Number-of-events-computation"],
Cell[243759, 6152, 1137, 19, 32, "Input",ExpressionUUID->"965e1996-69d5-4edd-bef1-51b13fe3df5a",
 CellTags->"Number-of-events-computation"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[244957, 6178, 212, 4, 69, "Title",ExpressionUUID->"43632709-93c8-43ea-aac4-c4cdd9738fd6",
 CellTags->{"Sensitivity", "Re-evaluation"}],
Cell[CellGroupData[{
Cell[245194, 6186, 324, 7, 66, "Chapter",ExpressionUUID->"4f28db5f-3e98-48c2-a98d-ef371754d56f",
 CellTags->{"Sensitivity", "Re-evaluation"}],
Cell[245521, 6195, 19056, 517, 781, "Input",ExpressionUUID->"933c8a14-e475-435b-9eee-64b877f62c55",
 CellTags->{"Sensitivity", "Re-evaluation"}],
Cell[CellGroupData[{
Cell[264602, 6716, 409, 11, 66, "Section",ExpressionUUID->"d1f628ba-3bad-4159-94f9-0c8b5549e590",
 CellTags->{"Sensitivity", "Re-evaluation"}],
Cell[265014, 6729, 4702, 121, 141, "Input",ExpressionUUID->"30f23ecc-adae-4e4e-bb37-3bcb631d2638",
 CellTags->{"Sensitivity", "Re-evaluation"}]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[269765, 6856, 219, 4, 66, "Chapter",ExpressionUUID->"70b84e06-d773-437f-8360-f1845520d830",
 CellTags->{"Sensitivity", "Re-evaluation"}],
Cell[CellGroupData[{
Cell[270009, 6864, 206, 4, 66, "Section",ExpressionUUID->"f8bcca72-97f4-4877-af48-43288ca88e21",
 CellTags->{"Sensitivity", "Re-evaluation"}],
Cell[270218, 6870, 613, 16, 50, "Input",ExpressionUUID->"c305b913-cdc5-4677-8d25-2c15d3b88372",
 CellTags->{"Sensitivity", "Re-evaluation"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[270868, 6891, 205, 4, 66, "Section",ExpressionUUID->"93105a27-56ff-4fc6-9267-69c09e4a4e65",
 CellTags->{"Sensitivity", "Re-evaluation"}],
Cell[271076, 6897, 19681, 496, 714, "Input",ExpressionUUID->"9ff01d3d-2235-405c-ab36-8ec261f4d137",
 CellTags->{"Sensitivity", "Re-evaluation"}]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[290818, 7400, 218, 4, 89, "Title",ExpressionUUID->"519ed843-8f32-4e91-84d0-5f5d5f152eee",
 CellTags->{"Re-evaluation", "Sensitivity"}],
Cell[291039, 7406, 2733, 67, 187, "Input",ExpressionUUID->"da6a725b-270d-45e0-bd71-6f5132a81d48",
 CellTags->{"Re-evaluation", "Sensitivity"}]
}, Open  ]]
}
]
*)

