(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    803431,      19814]
NotebookOptionsPosition[    740389,      18654]
NotebookOutlinePosition[    773431,      19181]
CellTagsIndexPosition[    772966,      19163]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Just launch the code below to run the notebook (shift+enter)", "Title",
 CellChangeTimes->{{3.8934376452895875`*^9, 
  3.8934376644509068`*^9}},ExpressionUUID->"be5b0a69-a859-4e14-9302-\
15ea02706e41"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nb", "=", 
   RowBox[{"EvaluationNotebook", "[", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"NotebookFind", "[", 
   RowBox[{"nb", ",", "\"\<Evaluation\>\"", ",", "All", ",", "CellTags"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}], "Input",
 CellChangeTimes->{{3.893437585709897*^9, 3.8934375895369635`*^9}, {
  3.8934376329497385`*^9, 3.893437658846809*^9}, {3.8936903789422555`*^9, 
  3.8936903792002773`*^9}, {3.8938170802646403`*^9, 3.8938170903183107`*^9}, {
  3.894125105994251*^9, 3.89412510682006*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"91675345-8e36-4745-9302-f9529663728a"]
}, Closed]],

Cell[CellGroupData[{

Cell["I. Definitions (launch this section first)", "Title",
 CellChangeTimes->{{3.8850097993899145`*^9, 3.8850098013435984`*^9}, {
  3.8850119060647106`*^9, 3.8850119106997366`*^9}, {3.8877814539576287`*^9, 
  3.8877814542613525`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"f0d20480-5665-403d-a88a-e38db6e4fff2"],

Cell[CellGroupData[{

Cell["Critical definitions required to launch this notebook", "Chapter",
 CellChangeTimes->{{3.893817051441402*^9, 3.893817059390691*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"b35f6bf0-7567-479d-b31b-629f7c8b6923"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"ruleDown", ",", "HoldAll"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ruleDown", "[", "list_", "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"DownValues", "/@", 
    RowBox[{"(", 
     RowBox[{"Unevaluated", "@", "list"}], ")"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"ruleOwn", ",", "HoldAll"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ruleOwn", "[", "list_", "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"OwnValues", "/@", 
    RowBox[{"(", 
     RowBox[{"Unevaluated", "@", "list"}], ")"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"choicesDialog", "[", 
   RowBox[{"LLP_", ",", "spec_List"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", 
      RowBox[{"spec", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"Flatten", "@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "LLP", "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", "=", "i"}], "}"}], ",", 
            RowBox[{"Column", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"TextCell", "[", 
                RowBox[{"spec", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"PopupMenu", "[", 
                RowBox[{
                 RowBox[{"Dynamic", "[", 
                  RowBox[{"choice", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"spec", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}]}], "}"}], 
             "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "@", "spec"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"Button", "[", 
         RowBox[{"\"\<OK\>\"", ",", 
          RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}]}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"infoDialog", "[", "phrase_", "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<Proceed\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"SetOptions", "[", 
  RowBox[{"$FrontEnd", ",", 
   RowBox[{"\"\<DynamicEvaluationTimeout\>\"", "\[Rule]", "300"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"SetSystemOptions", "[", 
  RowBox[{"\"\<SimplificationOptions\>\"", "->", 
   RowBox[{"\"\<AutosimplifyTrigs\>\"", "->", "False"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "FeynCalc`"}]}], "Input",
 CellChangeTimes->{{3.893817065391258*^9, 3.893817082937214*^9}, {
   3.89409198990086*^9, 3.894091990576394*^9}, {3.8967773747044973`*^9, 
   3.8967773782376595`*^9}, {3.9053585308615303`*^9, 
   3.9053585311068344`*^9}, {3.9121597861087885`*^9, 3.912159786487363*^9}, 
   3.9121607306423364`*^9, {3.914093028609653*^9, 3.9140930341165714`*^9}, {
   3.914516499625929*^9, 3.914516499774582*^9}, {3.916889936968649*^9, 
   3.916889936968649*^9}},
 CellTags->"Evaluation",
 CellLabel->"In[5]:=",ExpressionUUID->"cbf2546a-f572-4ac9-8b33-b22abc10dab6"]
}, Closed]],

Cell[CellGroupData[{

Cell["Parameters", "Chapter",
 CellChangeTimes->{{3.8903727395443363`*^9, 3.890372740946503*^9}, {
  3.8967773546314726`*^9, 3.89677735749397*^9}, {3.89869930182826*^9, 
  3.898699302731386*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"1ff2cef8-8f58-4db0-9a05-69980a5a669e"],

Cell[CellGroupData[{

Cell["Properties of SM particles", "Section",
 CellChangeTimes->{{3.8903727476205883`*^9, 3.89037275142794*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"9999c1f5-ee8b-445f-9d6d-aeca7091d16b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "PDG", " ", "identifiers", " ", "of", " ", "the", " ", "decay", " ", 
     RowBox[{"products", ".", " ", 
      OverscriptBox["g", "_"]}], " ", "is", " ", "formally", " ", 
     "introduced", " ", "as", " ", "an", " ", "antiparticle", " ", "to", " ", 
     "g"}], ",", " ", 
    RowBox[{
     RowBox[{
     "to", " ", "allow", " ", "the", " ", "routine", " ", "calculating", " ", 
      "the", " ", "decay", " ", "acceptance", " ", "for", " ", "experiments", 
      " ", "without", " ", "calorimeter", " ", "decay", " ", 
      RowBox[{"e", ".", "g", ".", " ", "S"}]}], "\[Rule]", "gg"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ListSMparticlesSymbols", "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(e\), \(-\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(e\), \(+\)]\)\>\"", ",", "\"\<\[Nu]\>\"", 
       ",", "\"\<\!\(\*OverscriptBox[\(\[Nu]\), \(_\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(e\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(\[Mu]\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(\[Tau]\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Nu]\), \(_\)], \(e\)]\)\>\"",
        ",", "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Nu]\), \(_\)], \(\[Mu]\
\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Nu]\), \(_\)], \(\[Tau]\)]\)\
\>\"", ",", "\"\<\!\(\*SubscriptBox[\(K\), \(L\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(K\), \(S\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(K\), \(+\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(K\), \(-\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(-\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Rho]\), \(0\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Rho]\), \(+\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Rho]\), \(-\)]\)\>\"", ",", 
       "\"\<\[Eta]\>\"", ",", "\"\<\[Gamma]\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(-\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Tau]\), \(-\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Tau]\), \(+\)]\)\>\"", ",", 
       "\"\<Null\>\"", ",", "\"\<Intermediate\>\"", ",", "\"\<jet\>\"", ",", 
       "\"\<\!\(\*OverscriptBox[\(jet\), \(_\)]\)\>\"", ",", "\"\<g\>\"", 
       ",", "\"\<\!\(\*OverscriptBox[\(g\), \(_\)]\)\>\"", ",", "\"\<s\>\"", 
       ",", "\"\<\!\(\*OverscriptBox[\(s\), \(_\)]\)\>\"", ",", "\"\<c\>\"", 
       ",", "\"\<\!\(\*OverscriptBox[\(c\), \(_\)]\)\>\"", ",", "\"\<b\>\"", 
       ",", "\"\<\!\(\*OverscriptBox[\(b\), \(_\)]\)\>\"", ",", "\"\<u\>\"", 
       ",", "\"\<\!\(\*OverscriptBox[\(u\), \(_\)]\)\>\"", ",", "\"\<d\>\"", 
       ",", "\"\<\!\(\*OverscriptBox[\(d\), \(_\)]\)\>\"", ",", 
       "\"\<\[Omega]\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(K\), \(\(*\)\(+\)\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(K\), \(\(*\)\(-\)\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(K\), \(\(*\)\(0\)\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[OverscriptBox[\(K\), \(_\)], \(\(*\)\(0\)\)]\
\)\>\"", ",", "\"\<\[Eta]'\>\"", ",", "\"\<p\>\"", ",", 
       "\"\<\!\(\*OverscriptBox[\(p\), \(_\)]\)\>\"", ",", "\"\<n\>\"", ",", 
       "\"\<\!\(\*OverscriptBox[\(n\), \(_\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(a\), \(1\)]\)\>\"", ",", "\"\<\[Phi]\>\""}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ListPDGs", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"11", ",", 
        RowBox[{"-", "11"}], ",", "12", ",", 
        RowBox[{"-", "12"}], ",", "12", ",", "14", ",", "16", ",", 
        RowBox[{"-", "12"}], ",", 
        RowBox[{"-", "14"}], ",", 
        RowBox[{"-", "16"}], ",", "130", ",", "310", ",", "321", ",", 
        RowBox[{"-", "321"}], ",", "111", ",", "211", ",", 
        RowBox[{"-", "211"}], ",", "113", ",", "213", ",", 
        RowBox[{"-", "213"}], ",", "221", ",", "22", ",", "13", ",", 
        RowBox[{"-", "13"}], ",", "15", ",", 
        RowBox[{"-", "15"}], ",", "999999", ",", 
        RowBox[{"-", "12345678"}], ",", "2", ",", 
        RowBox[{"-", "2"}], ",", "21", ",", 
        RowBox[{"-", "21"}], ",", "3", ",", 
        RowBox[{"-", "3"}], ",", "4", ",", 
        RowBox[{"-", "4"}], ",", "5", ",", 
        RowBox[{"-", "5"}], ",", "2", ",", 
        RowBox[{"-", "2"}], ",", "1", ",", 
        RowBox[{"-", "1"}], ",", "223", ",", "323", ",", 
        RowBox[{"-", "323"}], ",", "313", ",", 
        RowBox[{"-", "313"}], ",", "331", ",", "2212", ",", 
        RowBox[{"-", "2212"}], ",", "2112", ",", 
        RowBox[{"-", "2112"}], ",", "20113", ",", "333"}], "}"}], "//", 
      "N"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ParamProductToPDGid", "[", "#1", "]"}], "=", "#2"}], ")"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"ListSMparticlesSymbols", ",", "ListPDGs"}], "}"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ParamPDGidToProduct", "[", "#1", "]"}], "=", "#2"}], ")"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"ListPDGs", ",", "ListSMparticlesSymbols"}], "}"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Whether", " ", "the", " ", "decay", " ", "product", " ", "is", " ", 
      "stable", " ", "at", " ", "the", " ", "scale", " ", "of", " ", "the", 
      " ", 
      RowBox[{"experiment", ".", " ", 
       SubscriptBox["K", "L"]}]}], ",", 
     SuperscriptBox["K", "+"], ",", 
     SuperscriptBox["\[Pi]", "+"], ",", 
     RowBox[{
      SuperscriptBox["\[Mu]", "+"], " ", "are", " ", "considered", " ", 
      "stable"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ParamProductStability", "[", "#1", "]"}], "=", "#2"}], 
        ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"ListPDGs", ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
           ",", "1", ",", "1", ",", "1", ",", "1", ",", "0", ",", "1", ",", 
           "1", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0", ",", 
           "1", ",", "0", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
           ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
           "1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", "0", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
           "0", ",", "0"}], "}"}], "//", "N"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Mass", " ", "of", " ", "decay", " ", 
      RowBox[{"product", ".", " ", "For"}], " ", "jets"}], ",", " ", 
     RowBox[{
     "their", " ", "mass", " ", "is", " ", "assumed", " ", "to", " ", "be", 
      " ", "te", " ", "mass", " ", "of", " ", "the", " ", "lightest", " ", 
      "constituent"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ParamProductMass", "[", "#1", "]"}], "=", "#2"}], ")"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"ListPDGs", ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "0.0005", ",", "0.0005", ",", "0.", ",", "0.", ",", "0.", ",", "0.",
            ",", "0.", ",", "0.", ",", "0.", ",", "0.", ",", "0.4976", ",", 
           "0.4976", ",", "0.4937", ",", "0.4937", ",", "0.135", ",", "0.14", 
           ",", "0.14", ",", "0.775", ",", "0.775", ",", "0.775", ",", 
           "0.547", ",", "0.", ",", "0.105", ",", "0.105", ",", "1.77", ",", 
           "1.77", ",", "0.", ",", "123.", ",", "0.135", ",", "0.135", ",", 
           "0.135", ",", "0.135", ",", "0.495", ",", "0.495", ",", "1.87", 
           ",", "1.87", ",", "5.279", ",", "5.279", ",", "0.135", ",", 
           "0.135", ",", "0.135", ",", "0.135", ",", "0.782", ",", "0.892", 
           ",", "0.892`", ",", "0.892`", ",", "0.892", ",", "0.958", ",", 
           "0.938", ",", "0.938", ",", "0.939", ",", "0.939", ",", "1.26", 
           ",", "1.02"}], "}"}], "//", "N"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Electric", " ", "charges", " ", "of", " ", "decay", " ", 
      RowBox[{"products", ".", " ", "For"}], " ", 
      RowBox[{"jets", "/", "gluons"}]}], ",", " ", 
     RowBox[{
      RowBox[{"electric", " ", "charges"}], " ", "\[Equal]", " ", 
      RowBox[{"1", "/", 
       RowBox[{"-", "1"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ParamProductCharge", "[", "#1", "]"}], "=", "#2"}], ")"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"ListPDGs", ",", 
        RowBox[{
         FormBox[
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1."}], ",", "1.", ",", "0.", ",", "0.", ",", "0.", 
            ",", "0.", ",", "0.", ",", "0.", ",", "0.", ",", "0.", ",", "0.", 
            ",", "0.", ",", "1.", ",", 
            RowBox[{"-", "1."}], ",", "0.", ",", "1.", ",", 
            RowBox[{"-", "1."}], ",", "0.", ",", "1.", ",", 
            RowBox[{"-", "1."}], ",", "0.", ",", "0.", ",", 
            RowBox[{"-", "1."}], ",", "1.", ",", 
            RowBox[{"-", "1."}], ",", "1.", ",", "0.", ",", "0.", ",", "1.", 
            ",", 
            RowBox[{"-", "1."}], ",", "1.", ",", 
            RowBox[{"-", "1."}], ",", "1.", ",", 
            RowBox[{"-", "1."}], ",", "1.", ",", 
            RowBox[{"-", "1."}], ",", "1.", ",", 
            RowBox[{"-", "1."}], ",", "1.", ",", 
            RowBox[{"-", "1."}], ",", "1.", ",", 
            RowBox[{"-", "1."}], ",", "0.", ",", "1.", ",", 
            RowBox[{"-", "1."}], ",", "0.", ",", "0.", ",", "0.", ",", "1.", 
            ",", 
            RowBox[{"-", "1."}], ",", "0.", ",", "0.", ",", "0.", ",", "0."}],
            "}"}],
          TraditionalForm], "//", "N"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "Print", "[", "\"\<Full information about decay products:\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "\"\<Product\>\"", "}"}], ",", 
        RowBox[{"{", "\"\<PDG ID\>\"", "}"}], ",", 
        RowBox[{"{", "\"\<Stability\>\"", "}"}], ",", 
        RowBox[{"{", "\"\<Mass\>\"", "}"}], ",", 
        RowBox[{"{", "\"\<Electric charge\>\"", "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ListSMparticlesSymbols", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"ParamProductToPDGid", "[", "#", "]"}], "&"}], "/@", 
         "ListSMparticlesSymbols"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"ParamProductStability", "[", "#", "]"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"ParamProductToPDGid", "[", "#", "]"}], "&"}], "/@", 
           "ListSMparticlesSymbols"}], ")"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"ParamProductMass", "[", "#", "]"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"ParamProductToPDGid", "[", "#", "]"}], "&"}], "/@", 
           "ListSMparticlesSymbols"}], ")"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"ParamProductCharge", "[", "#", "]"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"ParamProductToPDGid", "[", "#", "]"}], "&"}], "/@", 
           "ListSMparticlesSymbols"}], ")"}]}]}], "}"}], ",", "2"}], "]"}], "//",
     "TableForm"}], "\[IndentingNewLine]", 
   RowBox[{
   "Print", "[", "\"\<List of recognizable decay products:\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Keys", "[", 
     RowBox[{"DownValues", "@", "ParamProductToPDGid"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
   "Print", "[", "\"\<List of PDG ids that may be detected:\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"detectablepdgs", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1.", ",", 
       RowBox[{"-", "1."}], ",", "2.", ",", 
       RowBox[{"-", "2."}], ",", "3.", ",", 
       RowBox[{"-", "3."}], ",", "4.", ",", 
       RowBox[{"-", "4."}], ",", "5.", ",", 
       RowBox[{"-", "5."}], ",", "21.", ",", 
       RowBox[{"-", "21."}], ",", "22.", ",", "11.", ",", 
       RowBox[{"-", "11."}], ",", "13.", ",", 
       RowBox[{"-", "13."}], ",", "211.", ",", 
       RowBox[{"-", "211."}], ",", "130.", ",", "321.", ",", 
       RowBox[{"-", "321."}], ",", "2112.", ",", 
       RowBox[{"-", "2112."}], ",", "2212.", ",", 
       RowBox[{"-", "2212."}]}], "}"}], "//", "Sort"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8903858795402575`*^9, 3.890385892073469*^9}, {
   3.891398230449129*^9, 3.8913982487653456`*^9}, {3.8913995362682076`*^9, 
   3.8913995391227827`*^9}, {3.8914161123738165`*^9, 3.891416114533451*^9}, {
   3.8914191460933065`*^9, 3.891419147432455*^9}, {3.8914202707443523`*^9, 
   3.8914202715985146`*^9}, {3.8914226111349373`*^9, 
   3.8914226123617134`*^9}, {3.891442806652629*^9, 3.8914428443398046`*^9}, {
   3.8914430685909147`*^9, 3.8914431092656*^9}, {3.8914437501265416`*^9, 
   3.8914437598327403`*^9}, 3.8914498145880513`*^9, {3.891451303128127*^9, 
   3.891451324381563*^9}, {3.891452087638418*^9, 3.891452347079662*^9}, {
   3.891452423159066*^9, 3.8914524483497953`*^9}, {3.8914524920344696`*^9, 
   3.8914525343411837`*^9}, {3.89148416982592*^9, 3.8914841773982143`*^9}, 
   3.8914871957545085`*^9, {3.8922890747363677`*^9, 3.8922891234633102`*^9}, {
   3.892305479437621*^9, 3.892305501601224*^9}, {3.892306322852328*^9, 
   3.892306333321186*^9}, {3.8923089389944096`*^9, 3.8923089450228453`*^9}, {
   3.892308976683608*^9, 3.8923089865667133`*^9}, {3.8923090293567*^9, 
   3.892309069804802*^9}, {3.8923091162092495`*^9, 3.892309448407855*^9}, 
   3.8923095245921383`*^9, {3.892309998729916*^9, 3.892310002972072*^9}, {
   3.8923109446831584`*^9, 3.892311002786911*^9}, {3.8923111872799907`*^9, 
   3.892311187412429*^9}, {3.8923113787385597`*^9, 3.892311388818329*^9}, {
   3.892401987044947*^9, 3.892402006195115*^9}, {3.892737982767573*^9, 
   3.892737982806735*^9}, {3.8927396468934417`*^9, 3.8927397310371895`*^9}, {
   3.8927398419633884`*^9, 3.8927398420441384`*^9}, {3.892789015826012*^9, 
   3.89278901641591*^9}, {3.892822467236706*^9, 3.892822560987276*^9}, {
   3.892870831941684*^9, 3.89287086156954*^9}, {3.8928708966211357`*^9, 
   3.8928709799575253`*^9}, {3.8933912181843014`*^9, 3.893391274012459*^9}, {
   3.8934352398266664`*^9, 3.8934352406068773`*^9}, {3.8967773659141703`*^9, 
   3.8967773669605503`*^9}, {3.8970216966779604`*^9, 
   3.8970217444235506`*^9}, {3.9017173586915145`*^9, 3.901717475189951*^9}, {
   3.9040361663306603`*^9, 3.904036391515148*^9}, {3.904036507086973*^9, 
   3.9040365321061954`*^9}, {3.9040934077505803`*^9, 3.904093460900056*^9}, {
   3.9048339096288233`*^9, 3.904833913486054*^9}, {3.9048351527012153`*^9, 
   3.904835216516715*^9}, {3.9048394411641855`*^9, 3.904839462330653*^9}, 
   3.9048397011318226`*^9, {3.9048785642934437`*^9, 3.904878579303549*^9}, {
   3.904887010170261*^9, 3.9048870350993857`*^9}, {3.904887177619439*^9, 
   3.9048872412774773`*^9}, {3.9048879967353287`*^9, 
   3.9048880330887766`*^9}, {3.9049002207390213`*^9, 
   3.9049002247416325`*^9}, {3.9050980394071617`*^9, 3.90509804799116*^9}, {
   3.9056219501793933`*^9, 3.905621967223824*^9}, {3.912078995790445*^9, 
   3.9120789959412785`*^9}, {3.912498059873448*^9, 3.9124981786052504`*^9}, {
   3.9161263073393664`*^9, 3.916126331765745*^9}, {3.916126362881298*^9, 
   3.91612637680122*^9}, {3.916155610022653*^9, 3.9161556732817883`*^9}, 
   3.916155722096068*^9, {3.916155953519191*^9, 3.9161559696065073`*^9}, {
   3.9161560097795935`*^9, 3.9161560945882235`*^9}, {3.9161561410806212`*^9, 
   3.9161561677773995`*^9}, {3.916158494338337*^9, 3.916158532651111*^9}, {
   3.9161585695998588`*^9, 3.916158589059121*^9}, {3.9161589901382675`*^9, 
   3.9161590909248486`*^9}, {3.9161595786629467`*^9, 
   3.9161596158973007`*^9}, {3.9161596808177776`*^9, 3.916159683431061*^9}, {
   3.9161599873577204`*^9, 3.9161600010580516`*^9}, 3.9161600384073324`*^9, 
   3.9161602649728785`*^9, {3.916160476393891*^9, 3.9161605738264475`*^9}, {
   3.916162140087556*^9, 3.9161621884076138`*^9}},
 CellTags->"Evaluation",
 CellLabel->"In[15]:=",ExpressionUUID->"defb41e9-f75c-4e83-a741-84207b36cb89"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Kinematics", "Chapter",
 CellChangeTimes->{{3.888290790118643*^9, 3.888290795208439*^9}, {
  3.888378326897606*^9, 3.888378328638748*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"2e6dc84e-7eae-4401-b746-25315d0f950b"],

Cell[CellGroupData[{

Cell["Lorentz boosts", "Section",
 CellChangeTimes->{{3.8883781064755583`*^9, 3.8883781080722437`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"248bcdfc-6a6d-4069-a173-80b1bd55024a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Position", " ", "of", " ", "the", " ", "point", " ", "in", " ", 
    "coordinate", " ", "space", " ", "in", " ", "terms", " ", "of", " ", 
    "spherical", " ", "coordinates"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]Val", "[", 
    RowBox[{"px_", ",", "py_"}], "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"py", ">", "0"}], ",", 
     RowBox[{"ArcCos", "[", 
      FractionBox["px", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["px", "2"], "+", 
         SuperscriptBox["py", "2"]}]]], "]"}], ",", 
     RowBox[{"-", 
      RowBox[{"ArcCos", "[", 
       FractionBox["px", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["px", "2"], "+", 
          SuperscriptBox["py", "2"]}]]], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Theta]Val", "[", 
     RowBox[{"px_", ",", "py_", ",", "pz_"}], "]"}], "=", 
    RowBox[{"ArcCos", "[", 
     RowBox[{"pz", "/", 
      RowBox[{"(", 
       RowBox[{"\[Sqrt]", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["px", "2"], "+", 
          SuperscriptBox["py", "2"], "+", 
          SuperscriptBox["pz", "2"]}], ")"}]}], ")"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Decaying", " ", "particle", " ", "momentum", " ", "and", " ", "velocity",
      " ", "at", " ", "its", " ", "lab", " ", 
     RowBox[{"frame", ".", " ", "Since"}], " ", "the", " ", "experiment", " ",
      "geometry", " ", "is", " ", "convenient", " ", "to", " ", 
     "characterize", " ", "in", " ", "terms", " ", "of", " ", "spherical", 
     " ", "coordinates"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "given", " ", "here", " ", "in", " ", "both", " ", 
     "spherical", " ", "and", " ", "cartesian", " ", "coordinates"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pMotherVecCart", "[", 
    RowBox[{"px_", ",", "py_", ",", "pz_"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"px", ",", "py", ",", "pz"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"vMotherVecCart", "[", 
     RowBox[{"Ev_", ",", "px_", ",", "py_", ",", "pz_"}], "]"}], "=", 
    RowBox[{"+", 
     FractionBox[
      RowBox[{"pMotherVecCart", "[", 
       RowBox[{"px", ",", "py", ",", "pz"}], "]"}], "Ev"]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"\[Gamma]", ",", 
    RowBox[{"\[CapitalGamma]", " ", "factors"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]Factor", "[", 
    RowBox[{"ELLP_", ",", "mLLP_"}], "]"}], "=", 
   FractionBox["ELLP", "mLLP"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalGamma]factor", "[", 
    RowBox[{"ELLP_", ",", "mLLP_"}], "]"}], "=", 
   RowBox[{"Simplify", "[", 
    FractionBox[
     RowBox[{
      RowBox[{"\[Gamma]Factor", "[", 
       RowBox[{"ELLP", ",", "mLLP"}], "]"}], "-", "1"}], 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"v", "/.", 
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Gamma]Factor", "[", 
             RowBox[{"ELLP", ",", "mLLP"}], "]"}], "\[Equal]", 
            FractionBox["1", 
             SqrtBox[
              RowBox[{"1", "-", 
               SuperscriptBox["v", "2"]}]]]}], ",", "v"}], "]"}]}], ")"}], 
       "2"], "[", 
      RowBox[{"[", "1", "]"}], "]"}]], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pprod", "=", 
   RowBox[{"{", 
    RowBox[{"pxd", ",", "pyd", ",", "pzd"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vmotherlab", "=", 
   RowBox[{"vMotherVecCart", "[", 
    RowBox[{"Em", ",", "pxm", ",", "pym", ",", "pzm"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pproductLabVecCart", "[", 
    RowBox[{
    "pxm_", ",", "pym_", ",", "pzm_", ",", "Em_", ",", "mm_", ",", "pxd_", 
     ",", "pyd_", ",", "pzd_", ",", "Ed_"}], "]"}], "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"pprod", "+", 
     RowBox[{
      RowBox[{"\[Gamma]Factor", "[", 
       RowBox[{"Em", ",", "mm"}], "]"}], "*", "vmotherlab", "*", "Ed"}], "+", 
     RowBox[{
      RowBox[{"\[CapitalGamma]factor", "[", 
       RowBox[{"Em", ",", "mm"}], "]"}], "*", "vmotherlab", 
      RowBox[{"(", 
       RowBox[{"vmotherlab", ".", "pprod"}], ")"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EproductLabCart", "[", 
    RowBox[{
    "pxm_", ",", "pym_", ",", "pzm_", ",", "Em_", ",", "mm_", ",", "pxd_", 
     ",", "pyd_", ",", "pzd_", ",", "Ed_"}], "]"}], "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"\[Gamma]Factor", "[", 
      RowBox[{"Em", ",", "mm"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"Ed", "+", 
       RowBox[{"vmotherlab", ".", "pprod"}]}], ")"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"pproductLab1Cart", "[", 
      RowBox[{
      "pxm_", ",", "pym_", ",", "pzm_", ",", "Em_", ",", "mm_", ",", "pxd_", 
       ",", "pyd_", ",", "pzd_", ",", "Ed_"}], "]"}], ",", 
     RowBox[{"pproductLab2Cart", "[", 
      RowBox[{
      "pxm_", ",", "pym_", ",", "pzm_", ",", "Em_", ",", "mm_", ",", "pxd_", 
       ",", "pyd_", ",", "pzd_", ",", "Ed_"}], "]"}], ",", 
     RowBox[{"pproductLab3Cart", "[", 
      RowBox[{
      "pxm_", ",", "pym_", ",", "pzm_", ",", "Em_", ",", "mm_", ",", "pxd_", 
       ",", "pyd_", ",", "pzd_", ",", "Ed_"}], "]"}]}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"pproductLabVecCart", "[", 
        RowBox[{
        "pxm", ",", "pym", ",", "pzm", ",", "Em", ",", "mm", ",", "pxd", ",", 
         "pyd", ",", "pzd", ",", "Ed"}], "]"}], "[", 
       RowBox[{"[", "#", "]"}], "]"}], "]"}], "&"}], "/@", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "3"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<Check that \!\(\*SubscriptBox[SuperscriptBox[\(E\), \(2\)], \
\(boosted\)]\) - \!\(\*SubscriptBox[SuperscriptBox[OverscriptBox[\(p\), \
\(_\)], \(2\)], \(boosted\)]\) = \!\(\*SuperscriptBox[\(m\), \(2\)]\):\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testExpr", "[", 
    RowBox[{
    "pxm_", ",", "pym_", ",", "pzm_", ",", "Em_", ",", "mm_", ",", "pxd_", 
     ",", "pyd_", ",", "pzd_", ",", "Ed_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"EproductLabCart", "[", 
              RowBox[{
              "pxm", ",", "pym", ",", "pzm", ",", "Em", ",", "mm", ",", "pxd",
                ",", "pyd", ",", "pzd", ",", "Ed"}], "]"}], "2"], "-", 
            SuperscriptBox[
             RowBox[{"pproductLab1Cart", "[", 
              RowBox[{
              "pxm", ",", "pym", ",", "pzm", ",", "Em", ",", "mm", ",", "pxd",
                ",", "pyd", ",", "pzd", ",", "Ed"}], "]"}], "2"], "-", 
            SuperscriptBox[
             RowBox[{"pproductLab2Cart", "[", 
              RowBox[{
              "pxm", ",", "pym", ",", "pzm", ",", "Em", ",", "mm", ",", "pxd",
                ",", "pyd", ",", "pzd", ",", "Ed"}], "]"}], "2"], "-", 
            SuperscriptBox[
             RowBox[{"pproductLab3Cart", "[", 
              RowBox[{
              "pxm", ",", "pym", ",", "pzm", ",", "Em", ",", "mm", ",", "pxd",
                ",", "pyd", ",", "pzd", ",", "Ed"}], "]"}], "2"]}], "//", 
           "Expand"}], "//", "Simplify"}], ")"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox["pxm", "2"], "\[Rule]", 
          RowBox[{
           SuperscriptBox["Em", "2"], "-", 
           SuperscriptBox["pym", "2"], "-", 
           SuperscriptBox["pzm", "2"], "-", 
           SuperscriptBox["mm", "2"]}]}], "}"}]}], "//", "Expand"}], "//", 
      "Simplify"}], ")"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox["Em", "2"], "\[Rule]", 
      RowBox[{
       SuperscriptBox["pxm", "2"], "+", 
       SuperscriptBox["pym", "2"], "+", 
       SuperscriptBox["pzm", "2"], "+", 
       SuperscriptBox["mm", "2"]}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testExpr", "[", 
    RowBox[{"pxm", ",", "pym", ",", "pzm", ",", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["pxm", "2"], "+", 
       SuperscriptBox["pym", "2"], "+", 
       SuperscriptBox["pzm", "2"], "+", 
       SuperscriptBox["mm", "2"]}]], ",", "mm", ",", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["Ed", "2"], "-", 
       SuperscriptBox["pyd", "2"], "-", 
       SuperscriptBox["pzd", "2"], "-", 
       SuperscriptBox["m", "2"]}]], ",", "pyd", ",", "pzd", ",", "Ed"}], 
    "]"}], "//", "Simplify"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "same", " ", "but", " ", "assuming", " ", "that", " ", "the", 
     " ", "mother", " ", "3"}], "-", 
    RowBox[{
    "momentum", " ", "is", " ", "given", " ", "in", " ", "terms", " ", "of", 
     " ", "spherical", " ", "coordinates"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pMotherVecSpher", "[", 
    RowBox[{"ELLP_", ",", "mLLP_", ",", "\[Theta]LLP_", ",", "\[Phi]LLP_"}], 
    "]"}], "=", 
   RowBox[{
    SqrtBox[
     RowBox[{
      SuperscriptBox["ELLP", "2"], "-", 
      SuperscriptBox["mLLP", "2"]}]], 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]LLP", "]"}], "*", 
       RowBox[{"Cos", "[", "\[Phi]LLP", "]"}]}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]LLP", "]"}], "*", 
       RowBox[{"Sin", "[", "\[Phi]LLP", "]"}]}], ",", 
      RowBox[{"Cos", "[", "\[Theta]LLP", "]"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vMotherVecSpher", "[", 
    RowBox[{"ELLP_", ",", "mLLP_", ",", "\[Theta]LLP_", ",", "\[Phi]LLP_"}], 
    "]"}], "=", 
   RowBox[{"+", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"pMotherVecSpher", "[", 
       RowBox[{"ELLP", ",", "mLLP", ",", "\[Theta]LLP", ",", "\[Phi]LLP"}], 
       "]"}], "/", "ELLP"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pproductLabVecSpher", "[", 
    RowBox[{
    "ELLP_", ",", "mLLP_", ",", "\[Theta]LLP_", ",", "\[Phi]LLP_", ",", 
     "pxd_", ",", "pyd_", ",", "pzd_", ",", "Ed_"}], "]"}], "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"pprod", "+", 
     RowBox[{
      RowBox[{"\[Gamma]Factor", "[", 
       RowBox[{"ELLP", ",", "mLLP"}], "]"}], "*", 
      RowBox[{"vMotherVecSpher", "[", 
       RowBox[{"ELLP", ",", "mLLP", ",", "\[Theta]LLP", ",", "\[Phi]LLP"}], 
       "]"}], "*", "Ed"}], "+", 
     RowBox[{
      RowBox[{"\[CapitalGamma]factor", "[", 
       RowBox[{"ELLP", ",", "mLLP"}], "]"}], "*", 
      RowBox[{"vMotherVecSpher", "[", 
       RowBox[{"ELLP", ",", "mLLP", ",", "\[Theta]LLP", ",", "\[Phi]LLP"}], 
       "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"vMotherVecSpher", "[", 
         RowBox[{"ELLP", ",", "mLLP", ",", "\[Theta]LLP", ",", "\[Phi]LLP"}], 
         "]"}], ".", "pprod"}], ")"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EproductLabSpher", "[", 
    RowBox[{
    "ELLP_", ",", "mLLP_", ",", "\[Theta]LLP_", ",", "\[Phi]LLP_", ",", 
     "pxd_", ",", "pyd_", ",", "pzd_", ",", "Ed_"}], "]"}], "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"\[Gamma]Factor", "[", 
      RowBox[{"ELLP", ",", "mLLP"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"Ed", "+", 
       RowBox[{
        RowBox[{"vMotherVecSpher", "[", 
         RowBox[{"ELLP", ",", "mLLP", ",", "\[Theta]LLP", ",", "\[Phi]LLP"}], 
         "]"}], ".", "pprod"}]}], ")"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"pproductLab1Spher", "[", 
      RowBox[{
      "ELLP_", ",", "mLLP_", ",", "\[Theta]LLP_", ",", "\[Phi]LLP_", ",", 
       "pxd_", ",", "pyd_", ",", "pzd_", ",", "Ed_"}], "]"}], ",", 
     RowBox[{"pproductLab2Spher", "[", 
      RowBox[{
      "ELLP_", ",", "mLLP_", ",", "\[Theta]LLP_", ",", "\[Phi]LLP_", ",", 
       "pxd_", ",", "pyd_", ",", "pzd_", ",", "Ed_"}], "]"}], ",", 
     RowBox[{"pproductLab3Spher", "[", 
      RowBox[{
      "ELLP_", ",", "mLLP_", ",", "\[Theta]LLP_", ",", "\[Phi]LLP_", ",", 
       "pxd_", ",", "pyd_", ",", "pzd_", ",", "Ed_"}], "]"}]}], "}"}], "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"pproductLabVecSpher", "[", 
        RowBox[{
        "ELLP", ",", "mLLP", ",", "\[Theta]LLP", ",", "\[Phi]LLP", ",", "pxd",
          ",", "pyd", ",", "pzd", ",", "Ed"}], "]"}], "[", 
       RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<Check that \!\(\*SubscriptBox[SuperscriptBox[\(E\), \(2\)], \
\(boosted\)]\) - \!\(\*SubscriptBox[SuperscriptBox[OverscriptBox[\(p\), \
\(_\)], \(2\)], \(boosted\)]\) = \!\(\*SuperscriptBox[\(m\), \(2\)]\) - for \
the formulas expressed in spherical LLP coordinates:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testExpr2", "[", 
   RowBox[{
   "ELLP_", ",", "mLLP_", ",", "\[Theta]LLP_", ",", "\[Phi]LLP_", ",", "pxd_",
     ",", "pyd_", ",", "pzd_", ",", "Ed_"}], "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"EproductLabSpher", "[", 
       RowBox[{
       "ELLP", ",", "mLLP", ",", "\[Theta]LLP", ",", "\[Phi]LLP", ",", "pxd", 
        ",", "pyd", ",", "pzd", ",", "Ed"}], "]"}], "2"], "-", 
     SuperscriptBox[
      RowBox[{"pproductLab1Spher", "[", 
       RowBox[{
       "ELLP", ",", "mLLP", ",", "\[Theta]LLP", ",", "\[Phi]LLP", ",", "pxd", 
        ",", "pyd", ",", "pzd", ",", "Ed"}], "]"}], "2"], "-", 
     SuperscriptBox[
      RowBox[{"pproductLab2Spher", "[", 
       RowBox[{
       "ELLP", ",", "mLLP", ",", "\[Theta]LLP", ",", "\[Phi]LLP", ",", "pxd", 
        ",", "pyd", ",", "pzd", ",", "Ed"}], "]"}], "2"], "-", 
     SuperscriptBox[
      RowBox[{"pproductLab3Spher", "[", 
       RowBox[{
       "ELLP", ",", "mLLP", ",", "\[Theta]LLP", ",", "\[Phi]LLP", ",", "pxd", 
        ",", "pyd", ",", "pzd", ",", "Ed"}], "]"}], "2"]}], "//", "Expand"}], 
   "//", "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.825441359259295*^9, 3.8254415696527977`*^9}, {
   3.825441610483986*^9, 3.825441628098878*^9}, {3.82544166108582*^9, 
   3.825441741560773*^9}, {3.825441789217719*^9, 3.825441885961294*^9}, {
   3.8254419184704294`*^9, 3.8254419506503477`*^9}, {3.8254420226369767`*^9, 
   3.8254422277154675`*^9}, {3.825442267403395*^9, 3.8254423717673054`*^9}, {
   3.825448269629992*^9, 3.8254483735898113`*^9}, {3.825448407032854*^9, 
   3.8254484233296366`*^9}, 3.8254485223966055`*^9, {3.8254485635401917`*^9, 
   3.825448624668242*^9}, 3.825485226250142*^9, {3.825783712403296*^9, 
   3.8257837250106726`*^9}, {3.82578544729158*^9, 3.825785463626895*^9}, {
   3.8257857874388676`*^9, 3.8257858905579505`*^9}, {3.825879470558152*^9, 
   3.825879474003669*^9}, {3.8260105287566776`*^9, 3.826010529570136*^9}, {
   3.82608004333467*^9, 3.8260800439452915`*^9}, {3.8262750295087357`*^9, 
   3.826275030030158*^9}, {3.8263553900897007`*^9, 3.8263553905561905`*^9}, {
   3.853580091868972*^9, 3.853580092797665*^9}, {3.8771513982732787`*^9, 
   3.877151404894223*^9}, {3.8848396447043896`*^9, 3.88483972072639*^9}, {
   3.885010026206823*^9, 3.8850100285391293`*^9}, {3.887133225754771*^9, 
   3.8871333154565353`*^9}, {3.8871333872857423`*^9, 
   3.8871334251606693`*^9}, {3.88713355395287*^9, 3.8871335542043*^9}, {
   3.8876857660819044`*^9, 3.8876857804053564`*^9}, {3.887685820864749*^9, 
   3.8876860901131144`*^9}, {3.8876862974252043`*^9, 3.887686338494213*^9}, {
   3.8876863705017967`*^9, 3.887686671332944*^9}, {3.8876867220159903`*^9, 
   3.887686755214772*^9}, {3.88768679976367*^9, 3.8876868756634135`*^9}, {
   3.8876895562670083`*^9, 3.887689647691675*^9}, 3.887701540663432*^9, {
   3.88837811671988*^9, 3.8883781174550943`*^9}, {3.888996749056075*^9, 
   3.888996821645772*^9}, {3.8927858534819336`*^9, 3.8927859459368677`*^9}, {
   3.8927971605024757`*^9, 3.8927971862529545`*^9}, {3.892797252854179*^9, 
   3.8927973934933467`*^9}, {3.8927974270093746`*^9, 3.892797486665472*^9}, {
   3.8927975215347977`*^9, 3.8927975758783913`*^9}, {3.8927977041726627`*^9, 
   3.892797723513829*^9}, {3.8927977759359026`*^9, 3.892797812726123*^9}, 
   3.8927978919198284`*^9, {3.8927979297721715`*^9, 3.892797939074438*^9}, 
   3.8927979901809573`*^9, {3.893742699799855*^9, 3.893742713512537*^9}, {
   3.9154371845461893`*^9, 3.9154371848491807`*^9}, {3.9158583827222743`*^9, 
   3.915858395829399*^9}, {3.9161577341644373`*^9, 3.9161577384748416`*^9}},
 CellTags->"Evaluation",
 CellLabel->"In[28]:=",ExpressionUUID->"a7475b3a-4fa2-4f13-b3e0-208df08d3e19"]
}, Closed]],

Cell[CellGroupData[{

Cell["Kinematics of 3-body decays", "Section",
 CellChangeTimes->{{3.88837805314929*^9, 3.8883780571688633`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"4aafee20-0ca5-4c67-a588-9d66bbadf25c"],

Cell[CellGroupData[{

Cell[TextData[{
 "Phase space in terms of energies ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["E", "1"], ",", 
    SubscriptBox["E", "3"]}], TraditionalForm]],ExpressionUUID->
  "f9a4091b-bbce-4906-9b96-f852fcc5107e"]
}], "Subsection",
 CellChangeTimes->{{3.853559048218363*^9, 3.853559101627491*^9}, {
  3.8850098900640697`*^9, 3.8850098970747585`*^9}, {3.8883780640453424`*^9, 
  3.888378095761384*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"7bcaf136-4b89-4e60-8ac5-23f41e11375a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Kinematics", " ", "of", " ", "3"}], "-", 
    RowBox[{"body", " ", "decays"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"pPar", "[", 
      RowBox[{"En_", ",", "mn_"}], "]"}], "=", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["En", "2"], "-", 
       SuperscriptBox["mn", "2"]}]]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"E2valEnergies", "[", 
      RowBox[{"m_", ",", "E1_", ",", "E3_"}], "]"}], "=", 
     RowBox[{"m", "-", "E1", "-", "E3"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Rotation", " ", "matrices", " ", "with", " ", "around", " ", "z", " ", 
     "axis", " ", 
     RowBox[{"(", 
      RowBox[{"\[Phi]", " ", "angle"}], ")"}], " ", "and", " ", "x", " ", 
     "axis", " ", 
     RowBox[{"(", 
      RowBox[{"\[Theta]", " ", "angle"}], ")"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]RotMatrix", "[", "\[Phi]_", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", 
         RowBox[{"Sin", "[", "\[Phi]", "]"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
         RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]RotMatrix", "[", "\[Theta]_", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"cos", " ", "between", " ", "particles", " ", "1"}], ",", 
     RowBox[{"2", " ", "and", " ", "1"}], ",", 
     RowBox[{
      RowBox[{
      "3", " ", "at", " ", "rest", " ", "frame", " ", "of", " ", "decaying", 
       " ", "particle", " ", "0"}], " ", "\[Rule]", " ", 
      RowBox[{"1", "+", "2", "+", 
       RowBox[{
       "3", " ", "parametrized", " ", "in", " ", "terms", " ", "of", " ", 
        SubscriptBox["E", "1"]}]}]}], ",", 
     SubscriptBox["E", "3"]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cos\[Theta]12", "[", 
      RowBox[{
      "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], 
      "]"}], "=", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"pPar", "[", 
         RowBox[{"E3", ",", "m3"}], "]"}], "2"], "-", 
       SuperscriptBox[
        RowBox[{"pPar", "[", 
         RowBox[{"E1", ",", "m1"}], "]"}], "2"], "-", 
       SuperscriptBox[
        RowBox[{"pPar", "[", 
         RowBox[{
          RowBox[{"E2valEnergies", "[", 
           RowBox[{"m", ",", "E1", ",", "E3"}], "]"}], ",", "m2"}], "]"}], 
        "2"]}], 
      RowBox[{"2", 
       RowBox[{"pPar", "[", 
        RowBox[{"E1", ",", "m1"}], "]"}], "*", 
       RowBox[{"pPar", "[", 
        RowBox[{
         RowBox[{"E2valEnergies", "[", 
          RowBox[{"m", ",", "E1", ",", "E3"}], "]"}], ",", "m2"}], "]"}]}]]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cos\[Theta]13", "[", 
      RowBox[{
      "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], 
      "]"}], "=", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"pPar", "[", 
         RowBox[{
          RowBox[{"E2valEnergies", "[", 
           RowBox[{"m", ",", "E1", ",", "E3"}], "]"}], ",", "m2"}], "]"}], 
        "2"], "-", 
       SuperscriptBox[
        RowBox[{"pPar", "[", 
         RowBox[{"E1", ",", "m1"}], "]"}], "2"], "-", 
       SuperscriptBox[
        RowBox[{"pPar", "[", 
         RowBox[{"E3", ",", "m3"}], "]"}], "2"]}], 
      RowBox[{"2", 
       RowBox[{"pPar", "[", 
        RowBox[{"E1", ",", "m1"}], "]"}], "*", 
       RowBox[{"pPar", "[", 
        RowBox[{"E3", ",", "m3"}], "]"}]}]]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]12", "[", 
      RowBox[{
      "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], 
      "]"}], "=", 
     RowBox[{"ArcCos", "[", 
      RowBox[{"cos\[Theta]12", "[", 
       RowBox[{"E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
       "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]13", "[", 
      RowBox[{
      "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], 
      "]"}], "=", 
     RowBox[{"ArcCos", "[", 
      RowBox[{"cos\[Theta]13", "[", 
       RowBox[{"E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
       "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Values", " ", "of", " ", "\[Theta]12"}], ",", 
     RowBox[{"\[Theta]13", " ", "-", " ", 
      RowBox[{"compiled", " ", 
       RowBox[{"(", 
        RowBox[{"for", " ", "faster", " ", "code"}], ")"}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]12comp", "=", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
        "}"}], ",", 
       RowBox[{"(*", 
        RowBox[{"ArcCos", "[", 
         RowBox[{"cos\[Theta]12", "[", 
          RowBox[{
          "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}],
          "]"}], "*)"}], 
       RowBox[{"\[Theta]12", "[", 
        RowBox[{"E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
        "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]13comp", "=", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
        "}"}], ",", 
       RowBox[{"(*", 
        RowBox[{"ArcCos", "[", 
         RowBox[{"cos\[Theta]13", "[", 
          RowBox[{
          "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}],
          "]"}], "*)"}], 
       RowBox[{"\[Theta]13", "[", 
        RowBox[{"E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
        "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Domain", " ", "of", " ", "definition", " ", "of", " ", 
       SubscriptBox["E", "1"], " ", "and", " ", 
       SubscriptBox["E", "3"], " ", "in", " ", "decay", " ", "0"}], "\[Rule]", 
      RowBox[{"1", "+", "2", "+", 
       RowBox[{
       "3", " ", "at", " ", "rest", " ", "frame", " ", "of", " ", "0"}]}]}], 
     ",", " ", 
     RowBox[{
      SubscriptBox["E", 
       RowBox[{"3", ",", 
        RowBox[{"min", "/", "max"}]}]], " ", "=", " ", 
      RowBox[{"f", 
       RowBox[{"(", 
        SubscriptBox["E", "1"], ")"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"E3domain", "[", 
     RowBox[{"E1_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], 
    "=", 
    RowBox[{"E3", "/.", 
     RowBox[{"(*", 
      RowBox[{"Assuming", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"m", ">", "0"}], "&&", 
         RowBox[{"E1", ">", "m1", ">", "0"}]}], ","}]}], "*)"}], 
     RowBox[{"Simplify", "[", 
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"cos\[Theta]12", "[", 
          RowBox[{
          "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}],
          "\[Equal]", "1"}], ",", "E3"}], "]"}], "]"}]}]}], 
   RowBox[{"(*", "]", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"E3domainMin", "[", 
      RowBox[{"E1_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], 
     "=", 
     RowBox[{
      RowBox[{"E3domain", "[", 
       RowBox[{"E1", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"E3domainMax", "[", 
      RowBox[{"E1_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], 
     "=", 
     RowBox[{
      RowBox[{"E3domain", "[", 
       RowBox[{"E1", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalDelta]E3", "[", 
     RowBox[{"E1_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], 
    "=", 
    RowBox[{
     RowBox[{
      RowBox[{"E3domainMax", "[", 
       RowBox[{"E1", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}], "-", 
      RowBox[{"E3domainMin", "[", 
       RowBox[{"E1", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}]}], "//",
      "Simplify"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"E1domainMin", "[", 
       RowBox[{"m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], ",", 
      RowBox[{"E1domainMax", "[", 
       RowBox[{"m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}]}], "}"}], 
    "=", 
    RowBox[{
     RowBox[{"E1domain", "[", 
      RowBox[{"m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"E1", "/.", 
         RowBox[{
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"\[CapitalDelta]E3", "[", 
               RowBox[{"E1", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
               "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], ",", "E1"}], 
           "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", 
        RowBox[{"E1", "/.", 
         RowBox[{
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"\[CapitalDelta]E3", "[", 
               RowBox[{"E1", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
               "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], ",", "E1"}], 
           "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], "//", "Simplify"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Domain", " ", "of", " ", "definition", " ", "of", " ", 
       SubscriptBox["E", "1"], " ", "and", " ", 
       SubscriptBox["E", "3"], " ", "in", " ", "decay", " ", "0"}], "\[Rule]", 
      RowBox[{"1", "+", "2", "+", 
       RowBox[{
       "3", " ", "at", " ", "rest", " ", "frame", " ", "of", " ", "0"}]}]}], 
     ",", " ", 
     RowBox[{
      RowBox[{"now", " ", 
       SubscriptBox["E", 
        RowBox[{"1", ",", 
         RowBox[{"min", "/", "max"}]}]]}], " ", "=", " ", 
      RowBox[{"f", 
       RowBox[{"(", 
        SubscriptBox["E", "3"], ")"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"E1domain1", "[", 
      RowBox[{"E1_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], 
     "=", 
     RowBox[{"E1", "/.", 
      RowBox[{"(*", 
       RowBox[{"Assuming", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"m", ">", "0"}], "&&", 
          RowBox[{"E1", ">", "m1", ">", "0"}]}], ","}]}], "*)"}], 
      RowBox[{"Simplify", "[", 
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"cos\[Theta]12", "[", 
           RowBox[{
           "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
           "]"}], "\[Equal]", "1"}], ",", "E1"}], "]"}], "]"}]}]}], 
    RowBox[{"(*", "]", "*)"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"E1domain1Min", "[", 
      RowBox[{"E1_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], 
     "=", 
     RowBox[{
      RowBox[{"E1domain1", "[", 
       RowBox[{"E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"E1domain1Max", "[", 
      RowBox[{"E1_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], 
     "=", 
     RowBox[{
      RowBox[{"E1domain1", "[", 
       RowBox[{"E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalDelta]E1", "[", 
      RowBox[{"E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], 
     "=", 
     RowBox[{
      RowBox[{
       RowBox[{"E1domain1Max", "[", 
        RowBox[{"E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}], "-", 
       RowBox[{"E1domain1Min", "[", 
        RowBox[{"E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}]}], "//",
       "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"E3domain1Min", "[", 
        RowBox[{"m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], ",", 
       RowBox[{"E3domain1Max", "[", 
        RowBox[{"m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}]}], "}"}], 
     "=", 
     RowBox[{
      RowBox[{"E3domain1", "[", 
       RowBox[{"m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"E3", "/.", 
          RowBox[{
           RowBox[{"Solve", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"\[CapitalDelta]E1", "[", 
                RowBox[{"E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
                "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], ",", "E3"}],
             "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{"E3", "/.", 
          RowBox[{
           RowBox[{"Solve", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"\[CapitalDelta]E1", "[", 
                RowBox[{"E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
                "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], ",", "E3"}],
             "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], "//", "Simplify"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Mandelstam", " ", "invariants", " ", "in", " ", "terms", " ", "of", " ", 
     "energies"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"M13", "[", 
     RowBox[{"E1_", ",", "E3_"}], "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"E1", "+", "E3"}], ")"}], "2"], "-", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"pPar", "[", 
           RowBox[{"E1", ",", "m1"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"pPar", "[", 
           RowBox[{"E3", ",", "m3"}], "]"}], "2"], "+", 
         RowBox[{"2", "*", 
          RowBox[{"pPar", "[", 
           RowBox[{"E1", ",", "m1"}], "]"}], "*", 
          RowBox[{"pPar", "[", 
           RowBox[{"E3", ",", "m3"}], "]"}], "*", 
          RowBox[{"cos\[Theta]13", "[", 
           RowBox[{
           "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
           "]"}]}]}], ")"}]}], "//", "Expand"}], "//", "Simplify"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"M12", "[", 
     RowBox[{"E1_", ",", "E3_"}], "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"E1", "+", 
          RowBox[{"E2valEnergies", "[", 
           RowBox[{"m", ",", "E1", ",", "E3"}], "]"}]}], ")"}], "2"], "-", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"pPar", "[", 
           RowBox[{"E1", ",", "m1"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"pPar", "[", 
           RowBox[{
            RowBox[{"E2valEnergies", "[", 
             RowBox[{"m", ",", "E1", ",", "E3"}], "]"}], ",", "m2"}], "]"}], 
          "2"], "+", 
         RowBox[{"2", "*", 
          RowBox[{"pPar", "[", 
           RowBox[{"E1", ",", "m1"}], "]"}], "*", 
          RowBox[{"pPar", "[", 
           RowBox[{
            RowBox[{"E2valEnergies", "[", 
             RowBox[{"m", ",", "E1", ",", "E3"}], "]"}], ",", "m2"}], "]"}], 
          "*", 
          RowBox[{"cos\[Theta]12", "[", 
           RowBox[{
           "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
           "]"}]}]}], ")"}]}], "//", "Expand"}], "//", "Simplify"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Q2", "[", 
      RowBox[{"E1_", ",", "E3_", ",", "m_", ",", "m2_"}], "]"}], "=", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["m", "2"], "+", 
       SuperscriptBox["m2", "2"], "-", 
       RowBox[{"2", "*", "m", "*", 
        RowBox[{"E2valEnergies", "[", 
         RowBox[{"m", ",", "E1", ",", "E3"}], "]"}]}]}], ")"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Rotation", " ", "matrices", " ", "with", " ", "around", " ", "z", " ", 
     "axis", " ", 
     RowBox[{"(", 
      RowBox[{"\[Phi]", " ", "angle"}], ")"}], " ", "and", " ", "x", " ", 
     "axis", " ", 
     RowBox[{"(", 
      RowBox[{"\[Theta]", " ", "angle"}], ")"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]RotMatrix", "[", "\[Phi]_", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", 
         RowBox[{"Sin", "[", "\[Phi]", "]"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
         RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]RotMatrix", "[", "\[Theta]_", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Domain", " ", "of", " ", "the", " ", "parameter", " ", "space", " ", 
      "E1"}], ",", 
     RowBox[{"E3", " ", "for", " ", 
      SubscriptBox["E", "1"], " ", "ranging", " ", "between", " ", 
      SubscriptBox["E", "min"]}], ",", 
     SubscriptBox["E", "max"]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"E12E23domain", "[", 
     RowBox[{
     "m_", ",", "m1_", ",", "m2_", ",", "m3_", ",", "Emin_", ",", "Emax_"}], 
     "]"}], ":=", 
    RowBox[{"NIntegrate", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"UnitStep", "[", 
        RowBox[{"E3v", "-", "Emin"}], "]"}], "*", 
       RowBox[{"UnitStep", "[", 
        RowBox[{"Emax", "-", "E3v"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"E1v", ",", 
        RowBox[{
         RowBox[{"E1domain", "[", 
          RowBox[{"m", ",", "m1", ",", "m2", ",", "m3"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"E1domain", "[", 
          RowBox[{"m", ",", "m1", ",", "m2", ",", "m3"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"E3v", ",", 
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"E3domain", "[", 
            RowBox[{"E1v", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}],
            "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "Emin"}], "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{"Emax", ",", 
          RowBox[{
           RowBox[{"E3domain", "[", 
            RowBox[{"E1v", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}],
            "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"Method", "\[Rule]", "\"\<AdaptiveMonteCarlo\>\""}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8662192582435064`*^9, 3.8662192582584667`*^9}, {
   3.866610001675725*^9, 3.866610002626925*^9}, {3.8666139006159744`*^9, 
   3.8666139334906783`*^9}, {3.8757646808677473`*^9, 3.87576470481641*^9}, {
   3.8757647448275733`*^9, 3.875764745173166*^9}, {3.876214597403404*^9, 
   3.876214626337657*^9}, {3.8762147942378926`*^9, 3.8762149382839117`*^9}, {
   3.877148153494171*^9, 3.877148164766815*^9}, {3.8834977012591114`*^9, 
   3.8834977075782557`*^9}, {3.9156131925566483`*^9, 
   3.9156131929108653`*^9}, {3.9156144517821426`*^9, 3.9156144710290174`*^9}, 
   3.9156150785712*^9, {3.9156159064194365`*^9, 3.915615930107775*^9}, {
   3.9156159746517076`*^9, 3.915615975819049*^9}, {3.91615438896396*^9, 
   3.916154555930756*^9}, {3.916154979282052*^9, 3.916154997843158*^9}},
 CellTags->"Evaluation",
 CellLabel->"In[50]:=",ExpressionUUID->"b16454d7-342d-4f95-b605-96d825394282"],

Cell[CellGroupData[{

Cell["Scalar products in terms of energies 1,3", "Subsubsection",
 CellChangeTimes->{3.8883780749272103`*^9},
 CellTags->
  "Evaluation",ExpressionUUID->"3cce2902-2ab2-4e73-8344-a98668894cd3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ProductKK", "=", 
   SuperscriptBox["m", "2"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductK2K2", "=", 
   SuperscriptBox["m2", "2"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductK3K3", "=", 
   SuperscriptBox["m3", "2"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductK1K1", "=", 
   SuperscriptBox["m1", "2"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductKK2energy", "=", 
   RowBox[{"m", "*", 
    RowBox[{"E2valEnergies", "[", 
     RowBox[{"m", ",", "E1", ",", "E3"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductKK1energy", "=", 
   RowBox[{"m", "*", "E1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductKK3energy", "=", 
   RowBox[{"m", "*", "E3"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductK1K3energy", "=", 
   FractionBox[
    RowBox[{
     RowBox[{"M13", "[", 
      RowBox[{"E1", ",", "E3"}], "]"}], "-", 
     SuperscriptBox["m1", "2"], "-", 
     SuperscriptBox["m3", "2"]}], "2"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductK1K2energy", "=", 
   FractionBox[
    RowBox[{
     RowBox[{"M12", "[", 
      RowBox[{"E1", ",", "E3"}], "]"}], "-", 
     SuperscriptBox["m1", "2"], "-", 
     SuperscriptBox["m2", "2"]}], "2"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductK2K3energy", "=", 
   FractionBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["m", "2"], "+", 
      SuperscriptBox["m1", "2"], "-", 
      RowBox[{"2", "*", "m", "*", "E1"}], "-", 
      SuperscriptBox["m2", "2"], "-", 
      SuperscriptBox["m3", "2"]}], ")"}], "2"]}], ";"}]}], "Input",
 CellChangeTimes->{{3.866213385575988*^9, 3.8662134560507917`*^9}, 
   3.8662192582704344`*^9, 3.8666099365476866`*^9, 3.8666100179144545`*^9, {
   3.877148140739134*^9, 3.8771481417900867`*^9}},
 CellTags->"Evaluation",
 CellLabel->"In[76]:=",ExpressionUUID->"f698d818-b761-470e-abe1-b122f33e56f3"]
}, Closed]],

Cell[CellGroupData[{

Cell["Scalar products in terms of Mandelstam variables", "Subsubsection",
 CellChangeTimes->{{3.901259637348508*^9, 3.901259639971365*^9}, {
  3.906087867493623*^9, 3.906087871968361*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"efaf8abf-53d9-4f0b-b43d-12006d8589a2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ProductKK1mandelstam", "=", 
   FractionBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["m", "2"], "+", 
      SuperscriptBox["m1", "2"], "-", "m23"}], ")"}], "2"]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductKK3mandelstam", "=", 
   FractionBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["m", "2"], "+", 
      SuperscriptBox["m3", "2"], "-", "m12"}], ")"}], "2"]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductKK2mandelstam", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["m", "2"], "-", "ProductKK1mandelstam", "-", 
      "ProductKK3mandelstam"}], ")"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductK1K2mandelstam", "=", 
   FractionBox[
    RowBox[{"(", 
     RowBox[{"m12", "-", 
      SuperscriptBox["m1", "2"], "-", 
      SuperscriptBox["m2", "2"]}], ")"}], "2"]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductK2K3mandelstam", "=", 
   FractionBox[
    RowBox[{"(", 
     RowBox[{"m23", "-", 
      SuperscriptBox["m2", "2"], "-", 
      SuperscriptBox["m3", "2"]}], ")"}], "2"]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductK1K3mandelstam", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["m", "2"], "-", 
       RowBox[{"2", "ProductKK2mandelstam"}], "+", 
       SuperscriptBox["m2", "2"], "-", 
       SuperscriptBox["m1", "2"], "-", 
       SuperscriptBox["m3", "2"]}], ")"}], "2"], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ScalarProduct3body", "[", 
    RowBox[{"1", ",", "2"}], "]"}], "=", "ProductK1K2mandelstam"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ScalarProduct3body", "[", 
    RowBox[{"2", ",", "3"}], "]"}], "=", "ProductK2K3mandelstam"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ScalarProduct3body", "[", 
    RowBox[{"1", ",", "3"}], "]"}], "=", "ProductK1K3mandelstam"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ScalarProduct3body", "[", 
    RowBox[{"1", ",", "1"}], "]"}], "=", 
   SuperscriptBox["m1", "2"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ScalarProduct3body", "[", 
    RowBox[{"2", ",", "2"}], "]"}], "=", 
   SuperscriptBox["m2", "2"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ScalarProduct3body", "[", 
    RowBox[{"3", ",", "3"}], "]"}], "=", 
   SuperscriptBox["m3", "2"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "ProductKK", "-", "ProductK1K1", "-", "ProductK2K2", "-", "ProductK3K3", 
   "-", 
   RowBox[{"2", "*", 
    RowBox[{"(", 
     RowBox[{
     "ProductK1K2mandelstam", "+", "ProductK2K3mandelstam", "+", 
      "ProductK1K3mandelstam"}], ")"}]}]}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.866213352248226*^9, 3.866213379888481*^9}, {
   3.8662135374875436`*^9, 3.8662135727793503`*^9}, {3.8662136178225775`*^9, 
   3.866213642481532*^9}, {3.8662136837232947`*^9, 3.8662138305956106`*^9}, {
   3.866213884907527*^9, 3.8662139114273834`*^9}, {3.866213988475068*^9, 
   3.8662139909787397`*^9}, {3.866609412856109*^9, 3.866609418292795*^9}, {
   3.866609810712554*^9, 3.8666098109191327`*^9}, {3.8666144472253723`*^9, 
   3.8666144539551277`*^9}, {3.8666146012314844`*^9, 3.866614608054815*^9}, {
   3.86661484121432*^9, 3.8666148426241455`*^9}, {3.86661501713356*^9, 
   3.8666150172737417`*^9}, {3.9024174461637278`*^9, 3.9024174464222617`*^9}, 
   3.906087889116532*^9},
 CellTags->"Evaluation",
 CellLabel->"In[86]:=",ExpressionUUID->"e501226f-51a1-46c8-ad34-6f00cc1b7a29"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "4-momenta of decay products at rest frame as a function of energies ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["E", "1"], ",", 
    SubscriptBox["E", "3"]}], TraditionalForm]],ExpressionUUID->
  "96b0b611-7def-4e63-bac2-e67f09c9d7ee"]
}], "Subsubsection",
 CellChangeTimes->{3.88837808739474*^9},
 CellTags->
  "Evaluation",ExpressionUUID->"016ac244-a4b2-4c0e-94e4-6b9dfe729efb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Rotation", " ", "matrices", " ", "with", " ", "around", " ", "z", " ", 
    "axis", " ", 
    RowBox[{"(", 
     RowBox[{"\[Phi]", " ", "angle"}], ")"}], " ", "and", " ", "x", " ", 
    "axis", " ", 
    RowBox[{"(", 
     RowBox[{"\[Theta]", " ", "angle"}], ")"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]RotMatrix", "[", "\[Phi]_", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", 
         RowBox[{"Sin", "[", "\[Phi]", "]"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
         RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]RotMatrix", "[", "\[Theta]_", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pvecUnrotated", "[", 
      RowBox[{"px_", ",", "py_", ",", "pz_"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"px", ",", "py", ",", "pz"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pvecRotated", "[", 
      RowBox[{
      "px_", ",", "py_", ",", "pz_", ",", "\[Theta]V_", ",", "\[Phi]V_"}], 
      "]"}], "=", 
     RowBox[{
      RowBox[{"\[Phi]RotMatrix", "[", "\[Phi]V", "]"}], ".", 
      RowBox[{"\[Theta]RotMatrix", "[", "\[Theta]V", "]"}], ".", 
      RowBox[{"pvecUnrotated", "[", 
       RowBox[{"px", ",", "py", ",", "pz"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Momenta", " ", "at", " ", "frame", " ", "where", " ", 
     SubscriptBox["p", "1"], " ", "is", " ", "aligned", " ", "along", " ", 
     "z", " ", "axis"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p1unrotated", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"pPar", "[", 
        RowBox[{"E1", ",", "m1"}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p2unrotated", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"pPar", "[", 
         RowBox[{
          RowBox[{"E2valEnergies", "[", 
           RowBox[{"m", ",", "E1", ",", "E3"}], "]"}], ",", "m2"}], "]"}], 
        "*", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]12", "[", 
          RowBox[{
          "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}],
          "]"}], "*", 
        RowBox[{"Sin", "[", "\[Kappa]", "]"}]}], ",", 
       RowBox[{
        RowBox[{"pPar", "[", 
         RowBox[{
          RowBox[{"E2valEnergies", "[", 
           RowBox[{"m", ",", "E1", ",", "E3"}], "]"}], ",", "m2"}], "]"}], 
        "*", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]12", "[", 
          RowBox[{
          "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}],
          "]"}], "*", 
        RowBox[{"Cos", "[", "\[Kappa]", "]"}]}], ",", 
       RowBox[{
        RowBox[{"pPar", "[", 
         RowBox[{
          RowBox[{"E2valEnergies", "[", 
           RowBox[{"m", ",", "E1", ",", "E3"}], "]"}], ",", "m2"}], "]"}], 
        "*", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]12", "[", 
          RowBox[{
          "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}],
          "]"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p3unrotated", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"pPar", "[", 
          RowBox[{"E3", ",", "m3"}], "]"}]}], "*", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]13", "[", 
          RowBox[{
          "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}],
          "]"}], "*", 
        RowBox[{"Sin", "[", "\[Kappa]", "]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"pPar", "[", 
          RowBox[{"E3", ",", "m3"}], "]"}]}], "*", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]13", "[", 
          RowBox[{
          "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}],
          "]"}], "*", 
        RowBox[{"Cos", "[", "\[Kappa]", "]"}]}], ",", 
       RowBox[{
        RowBox[{"pPar", "[", 
         RowBox[{"E3", ",", "m3"}], "]"}], "*", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]13", "[", 
          RowBox[{
          "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}],
          "]"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\[Theta]rand", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", "Pi"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Phi]rand", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], "]"}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p1rotated", "[", 
      RowBox[{"E1_", ",", "m1_", ",", "\[Theta]V_", ",", "\[Phi]V_"}], "]"}], 
     "=", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"\[Phi]RotMatrix", "[", "\[Phi]V", "]"}], ".", 
       RowBox[{"\[Theta]RotMatrix", "[", "\[Theta]V", "]"}], ".", 
       "p1Unrotated"}], "*)"}], 
     RowBox[{"pvecRotated", "[", 
      RowBox[{
       RowBox[{"p1unrotated", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"p1unrotated", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"p1unrotated", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", "\[Theta]V", ",", "\[Phi]V"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p1rotatedX", "[", 
      RowBox[{"E1_", ",", "m1_", ",", "\[Theta]V_", ",", "\[Phi]V_"}], "]"}], 
     "=", 
     RowBox[{
      RowBox[{"p1rotated", "[", 
       RowBox[{"E1", ",", "m1", ",", "\[Theta]V", ",", "\[Phi]V"}], "]"}], 
      "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p1rotatedY", "[", 
      RowBox[{"E1_", ",", "m1_", ",", "\[Theta]V_", ",", "\[Phi]V_"}], "]"}], 
     "=", 
     RowBox[{
      RowBox[{"p1rotated", "[", 
       RowBox[{"E1", ",", "m1", ",", "\[Theta]V", ",", "\[Phi]V"}], "]"}], 
      "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p1rotatedZ", "[", 
      RowBox[{"E1_", ",", "m1_", ",", "\[Theta]V_", ",", "\[Phi]V_"}], "]"}], 
     "=", 
     RowBox[{
      RowBox[{"p1rotated", "[", 
       RowBox[{"E1", ",", "m1", ",", "\[Theta]V", ",", "\[Phi]V"}], "]"}], 
      "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p2rotated", "[", 
      RowBox[{
      "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_", ",", 
       "\[Theta]V_", ",", "\[Phi]V_", ",", "\[Kappa]_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"pvecRotated", "[", 
       RowBox[{
        RowBox[{"p2unrotated", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"p2unrotated", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"p2unrotated", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", "\[Theta]V", ",", "\[Phi]V"}], 
       "]"}], "//", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p2rotatedX", "[", 
      RowBox[{
      "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_", ",", 
       "\[Theta]V_", ",", "\[Phi]V_", ",", "\[Kappa]_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"p2rotated", "[", 
       RowBox[{
       "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3", ",", 
        "\[Theta]V", ",", "\[Phi]V", ",", "\[Kappa]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p2rotatedY", "[", 
      RowBox[{
      "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_", ",", 
       "\[Theta]V_", ",", "\[Phi]V_", ",", "\[Kappa]_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"p2rotated", "[", 
       RowBox[{
       "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3", ",", 
        "\[Theta]V", ",", "\[Phi]V", ",", "\[Kappa]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p2rotatedZ", "[", 
      RowBox[{
      "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_", ",", 
       "\[Theta]V_", ",", "\[Phi]V_", ",", "\[Kappa]_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"p2rotated", "[", 
       RowBox[{
       "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3", ",", 
        "\[Theta]V", ",", "\[Phi]V", ",", "\[Kappa]"}], "]"}], "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p3rotated", "[", 
      RowBox[{
      "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_", ",", 
       "\[Theta]V_", ",", "\[Phi]V_", ",", "\[Kappa]_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"pvecRotated", "[", 
       RowBox[{
        RowBox[{"p3unrotated", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"p3unrotated", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"p3unrotated", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", "\[Theta]V", ",", "\[Phi]V"}], 
       "]"}], "//", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p3rotatedX", "[", 
      RowBox[{
      "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_", ",", 
       "\[Theta]V_", ",", "\[Phi]V_", ",", "\[Kappa]_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"p3rotated", "[", 
       RowBox[{
       "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3", ",", 
        "\[Theta]V", ",", "\[Phi]V", ",", "\[Kappa]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p3rotatedY", "[", 
      RowBox[{
      "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_", ",", 
       "\[Theta]V_", ",", "\[Phi]V_", ",", "\[Kappa]_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"p3rotated", "[", 
       RowBox[{
       "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3", ",", 
        "\[Theta]V", ",", "\[Phi]V", ",", "\[Kappa]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p3rotatedZ", "[", 
      RowBox[{
      "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_", ",", 
       "\[Theta]V_", ",", "\[Phi]V_", ",", "\[Kappa]_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"p3rotated", "[", 
       RowBox[{
       "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3", ",", 
        "\[Theta]V", ",", "\[Phi]V", ",", "\[Kappa]"}], "]"}], "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.875774080283636*^9, 3.8757740812840986`*^9}},
 CellTags->"Evaluation",
 CellLabel->"In[99]:=",ExpressionUUID->"17029912-dbcc-4c64-877a-10704f81d486"]
}, Closed]]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Decays of various LLPs: processes, branching ratios, matrix elements\
\>", "Chapter",
 CellChangeTimes->{{3.890548171896737*^9, 3.890548187260339*^9}, {
  3.8905484908153534`*^9, 3.8905484933139133`*^9}, {3.8971452522571464`*^9, 
  3.8971452634244976`*^9}, {3.903896390044148*^9, 3.9038963922808466`*^9}, {
  3.9154354886653767`*^9, 3.9154354889499288`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"0d1bd182-eac0-447d-ba67-c82fb46e0d37"],

Cell[CellGroupData[{

Cell["Definitions", "Section",
 CellChangeTimes->{{3.9038865547496924`*^9, 3.9038865562526064`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"dd16eefb-96fb-4f43-a3b3-11b24ee6c151"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"procList", "[", "LLP_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Keys", "[", 
          RowBox[{"DownValues", "@", "ListBrRatiosTemp"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "3"}], "}"}]}], "//", "Transpose"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "==", "LLP"}], "&"}]}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"procListnoecal", "[", "LLP_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"prl", "=", 
      RowBox[{"procList", "[", "LLP", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "For", " ", "the", " ", "list", " ", "of", " ", "final", " ", "states",
         " ", "for", " ", "the", " ", "given", " ", "decays"}], ",", " ", 
       RowBox[{"select", " ", "only", " ", "charged"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"chargedprods", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"prl", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"ListDecayProducts", "[", 
             RowBox[{"LLP", ",", 
              RowBox[{"prl", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "\"\<\[Gamma]\>\"", ",", 
                  "\"\<\!\(\*SubscriptBox[\(K\), \(L\)]\)\>\"", ",", 
                  "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", 
                  "\"\<Null\>\"", ",", "\"\<\[Nu]\>\"", ",", 
                  "\"\<\!\(\*OverscriptBox[\(\[Nu]\), \(_\)]\)\>\"", ",", 
                  "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(e\)]\)\>\"", ",", 
                  "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Nu]\), \(_\)], \
\(e\)]\)\>\"", ",", "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(\[Mu]\)]\)\>\"", 
                  ",", "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Nu]\), \
\(_\)], \(\[Mu]\)]\)\>\"", ",", 
                  "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(\[Tau]\)]\)\>\"", ",", 
                  "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Nu]\), \(_\)], \(\
\[Tau]\)]\)\>\""}], "}"}], ",", "#"}], "]"}], "==", "False"}], "&"}]}], 
           "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "prl", "]"}], ",", "1"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"chargedprods", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "!=", 
          RowBox[{"{", "}"}]}], "&"}]}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.9038865686597695`*^9, 3.90388692941195*^9}, {
   3.9038869723236256`*^9, 3.903886974427346*^9}, {3.9038870135008707`*^9, 
   3.903887049076475*^9}, {3.903896231456202*^9, 3.903896231667673*^9}, {
   3.904798485428092*^9, 3.904798487429279*^9}, {3.915437184863742*^9, 
   3.91543718487681*^9}, 3.9161554089129725`*^9, {3.9161567874996605`*^9, 
   3.9161567880612645`*^9}, 3.9161568645876446`*^9, {3.916156934654274*^9, 
   3.916156935127883*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[118]:=",ExpressionUUID->"9ec27b8b-9043-4a5a-a5d2-70c74445e4e7"]
}, Closed]],

Cell[CellGroupData[{

Cell["Scalar", "Section",
 CellChangeTimes->{{3.8896886292454453`*^9, 3.889688637118582*^9}, {
  3.8905481817730513`*^9, 3.8905481835847673`*^9}, {3.914999896750478*^9, 
  3.9149998975251455`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"9e23489f-deb3-4031-b732-56602a865d5c"],

Cell[CellGroupData[{

Cell["\<\
List of decay processes and sets of decay products for them, branching ratios\
\>", "Subsection",
 CellChangeTimes->{{3.8905482184733267`*^9, 3.890548219964122*^9}, 
   3.903889051795726*^9, 3.9047977278997974`*^9},
 CellTags->
  "Evaluation",ExpressionUUID->"eed76010-8733-46c2-9b12-fd21d2af2264"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Branching", " ", "ratios"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"LLPsel", "=", "\"\<Scalar\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BrRatiosTableTemp", "=", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"Import", "[", 
        RowBox[{
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], ",", 
            "\"\<phenomenology\>\"", ",", "LLPsel", ",", 
            "\"\<decay widths/BrRatios.m\>\""}], "}"}], "]"}], ",", 
         "\"\<MX\>\""}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", "2"}], "&"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Table", "[", 
        RowBox[{"i", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"BrRatiosTableTemp", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "1"}], "}"}]}], 
        "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"BrRatiosTableTemp", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "}"}]}], "]"}], "//", "TableForm"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BrRatiosTable", "=", 
     RowBox[{"Drop", "[", 
      RowBox[{"BrRatiosTableTemp", ",", "1"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BrRatioScalar", "[", 
      RowBox[{"mLLP_", ",", "i_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Interpolation", "[", 
       RowBox[{
        RowBox[{"BrRatiosTable", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "i"}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "mLLP", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"proc", "=", "\"\<e-pair\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ListBrRatiosTemp", "[", 
        RowBox[{"LLPsel", ",", "mLLP_", ",", "proc"}], "]"}], ",", 
       RowBox[{"ListDecayProducts", "[", 
        RowBox[{"LLPsel", ",", "proc"}], "]"}], ",", 
       RowBox[{"JetsPresence", "[", 
        RowBox[{"LLPsel", ",", "proc"}], "]"}]}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"BrRatioScalar", "[", 
        RowBox[{"mLLP", ",", "2"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(e\), \(+\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(e\), \(-\)]\)\>\"", ",", "\"\<Null\>\"", 
         ",", "\"\<Null\>\""}], "}"}], ",", "\"\<No\>\""}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"proc", "=", "\"\<\[Mu]-pair\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ListBrRatiosTemp", "[", 
        RowBox[{"LLPsel", ",", "mLLP_", ",", "proc"}], "]"}], ",", 
       RowBox[{"ListDecayProducts", "[", 
        RowBox[{"LLPsel", ",", "proc"}], "]"}], ",", 
       RowBox[{"JetsPresence", "[", 
        RowBox[{"LLPsel", ",", "proc"}], "]"}]}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"BrRatioScalar", "[", 
        RowBox[{"mLLP", ",", "3"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(-\)]\)\>\"", ",", 
         "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}], ",", "\"\<No\>\""}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"proc", "=", "\"\<\[Tau]-pair\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ListBrRatiosTemp", "[", 
        RowBox[{"LLPsel", ",", "mLLP_", ",", "proc"}], "]"}], ",", 
       RowBox[{"ListDecayProducts", "[", 
        RowBox[{"LLPsel", ",", "proc"}], "]"}], ",", 
       RowBox[{"JetsPresence", "[", 
        RowBox[{"LLPsel", ",", "proc"}], "]"}]}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"BrRatioScalar", "[", 
        RowBox[{"mLLP", ",", "8"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(\[Tau]\), \(+\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(\[Tau]\), \(-\)]\)\>\"", ",", 
         "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}], ",", "\"\<No\>\""}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Uncomment", " ", "the", " ", "pieces", " ", "of", " ", "code", " ", 
     "below", " ", "if", " ", "you", " ", "want", " ", "to", " ", "compare", 
     " ", "with", " ", "SensMC"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "proc", "=", "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)-pair\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ListBrRatiosTemp", "[", 
        RowBox[{"LLPsel", ",", "mLLP_", ",", "proc"}], "]"}], ",", 
       RowBox[{"ListDecayProducts", "[", 
        RowBox[{"LLPsel", ",", "proc"}], "]"}], ",", 
       RowBox[{"JetsPresence", "[", 
        RowBox[{"LLPsel", ",", "proc"}], "]"}]}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox["1", "3"], 
        RowBox[{"BrRatioScalar", "[", 
         RowBox[{"mLLP", ",", "4"}], "]"}]}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"+", 
          FractionBox["1", "3"]}], 
         RowBox[{"BrRatioScalar", "[", 
          RowBox[{"mLLP", ",", "6"}], "]"}]}], "*)"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", 
         "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}], ",", "\"\<No\>\""}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "proc", "=", 
     "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(charged\)]\)-pair\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ListBrRatiosTemp", "[", 
        RowBox[{"LLPsel", ",", "mLLP_", ",", "proc"}], "]"}], ",", 
       RowBox[{"ListDecayProducts", "[", 
        RowBox[{"LLPsel", ",", "proc"}], "]"}], ",", 
       RowBox[{"JetsPresence", "[", 
        RowBox[{"LLPsel", ",", "proc"}], "]"}]}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox["2", "3"], 
        RowBox[{"BrRatioScalar", "[", 
         RowBox[{"mLLP", ",", "4"}], "]"}]}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"+", 
          FractionBox["2", "3"]}], 
         RowBox[{"BrRatioScalar", "[", 
          RowBox[{"mLLP", ",", "6"}], "]"}]}], "*)"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(-\)]\)\>\"", ",", 
         "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}], ",", "\"\<No\>\""}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Comment", " ", "the", " ", "two", " ", "strings", " ", "below", " ", 
     "if", " ", "you", " ", "want", " ", "to", " ", "compare", " ", "with", 
     " ", "SensMC"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"proc", "=", "\"\<4\[Pi]\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ListBrRatiosTemp", "[", 
        RowBox[{"LLPsel", ",", "mLLP_", ",", "proc"}], "]"}], ",", 
       RowBox[{"ListDecayProducts", "[", 
        RowBox[{"LLPsel", ",", "proc"}], "]"}], ",", 
       RowBox[{"JetsPresence", "[", 
        RowBox[{"LLPsel", ",", "proc"}], "]"}]}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"BrRatioScalar", "[", 
        RowBox[{"mLLP", ",", "6"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(-\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(-\)]\)\>\""}], "}"}], ",", 
       "\"\<No\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "proc", "=", "\"\<\!\(\*SuperscriptBox[\(K\), \(charged\)]\)-pair\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ListBrRatiosTemp", "[", 
        RowBox[{"LLPsel", ",", "mLLP_", ",", "proc"}], "]"}], ",", 
       RowBox[{"ListDecayProducts", "[", 
        RowBox[{"LLPsel", ",", "proc"}], "]"}], ",", 
       RowBox[{"JetsPresence", "[", 
        RowBox[{"LLPsel", ",", "proc"}], "]"}]}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"mLLP", "<=", "2"}], ",", 
         RowBox[{"Evaluate", "[", 
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"BrRatioScalar", "[", 
            RowBox[{"mLLP", ",", "5"}], "]"}]}], "]"}], ",", "0"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(K\), \(+\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(K\), \(-\)]\)\>\"", ",", "\"\<Null\>\"", 
         ",", "\"\<Null\>\""}], "}"}], " ", ",", "\"\<No\>\""}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"proc", "=", "\"\<KS-pair\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ListBrRatiosTemp", "[", 
        RowBox[{"LLPsel", ",", "mLLP_", ",", "proc"}], "]"}], ",", 
       RowBox[{"ListDecayProducts", "[", 
        RowBox[{"LLPsel", ",", "proc"}], "]"}], ",", 
       RowBox[{"JetsPresence", "[", 
        RowBox[{"LLPsel", ",", "proc"}], "]"}]}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"mLLP", "<=", "2"}], ",", 
         RowBox[{"Evaluate", "[", 
          RowBox[{
           FractionBox["1", "8"], 
           RowBox[{"BrRatioScalar", "[", 
            RowBox[{"mLLP", ",", "5"}], "]"}]}], "]"}], ",", "0"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(K\), \(S\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[\(K\), \(S\)]\)\>\"", ",", "\"\<Null\>\"", 
         ",", "\"\<Null\>\""}], "}"}], ",", "\"\<No\>\""}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"proc", "=", "\"\<KL-pair\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ListBrRatiosTemp", "[", 
        RowBox[{"LLPsel", ",", "mLLP_", ",", "proc"}], "]"}], ",", 
       RowBox[{"ListDecayProducts", "[", 
        RowBox[{"LLPsel", ",", "proc"}], "]"}], ",", 
       RowBox[{"JetsPresence", "[", 
        RowBox[{"LLPsel", ",", "proc"}], "]"}]}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"mLLP", "<=", "2"}], ",", 
         RowBox[{"Evaluate", "[", 
          RowBox[{
           FractionBox["1", "8"], 
           RowBox[{"BrRatioScalar", "[", 
            RowBox[{"mLLP", ",", "5"}], "]"}]}], "]"}], ",", "0"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(K\), \(L\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[\(K\), \(L\)]\)\>\"", ",", "\"\<Null\>\"", 
         ",", "\"\<Null\>\""}], "}"}], ",", "\"\<No\>\""}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"proc", "=", "\"\<KLKS-pair\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ListBrRatiosTemp", "[", 
        RowBox[{"LLPsel", ",", "mLLP_", ",", "proc"}], "]"}], ",", 
       RowBox[{"ListDecayProducts", "[", 
        RowBox[{"LLPsel", ",", "proc"}], "]"}], ",", 
       RowBox[{"JetsPresence", "[", 
        RowBox[{"LLPsel", ",", "proc"}], "]"}]}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"mLLP", "<=", "2"}], ",", 
         RowBox[{"Evaluate", "[", 
          RowBox[{
           FractionBox["1", "4"], 
           RowBox[{"BrRatioScalar", "[", 
            RowBox[{"mLLP", ",", "5"}], "]"}]}], "]"}], ",", "0"}], "]"}], 
       ",", " ", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(K\), \(L\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[\(K\), \(S\)]\)\>\"", ",", "\"\<Null\>\"", 
         ",", "\"\<Null\>\""}], "}"}], ",", "\"\<No\>\""}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"proc", "=", "\"\<Jets-ss\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ListBrRatiosTemp", "[", 
        RowBox[{"LLPsel", ",", "mLLP_", ",", "proc"}], "]"}], ",", 
       RowBox[{"ListDecayProducts", "[", 
        RowBox[{"LLPsel", ",", "proc"}], "]"}], ",", 
       RowBox[{"JetsPresence", "[", 
        RowBox[{"LLPsel", ",", "proc"}], "]"}]}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"2", "<", "mLLP", "<=", "3.8"}], ",", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"BrRatioScalar", "[", 
           RowBox[{"mLLP", ",", "5"}], "]"}], "]"}], ",", "0"}], "]"}], ",", 
       " ", 
       RowBox[{"{", 
        RowBox[{
        "\"\<s\>\"", ",", "\"\<\!\(\*OverscriptBox[\(s\), \(_\)]\)\>\"", ",", 
         "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}], ",", "\"\<Yes\>\""}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"proc", "=", "\"\<Jets-cc\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ListBrRatiosTemp", "[", 
        RowBox[{"LLPsel", ",", "mLLP_", ",", "proc"}], "]"}], ",", 
       RowBox[{"ListDecayProducts", "[", 
        RowBox[{"LLPsel", ",", "proc"}], "]"}], ",", 
       RowBox[{"JetsPresence", "[", 
        RowBox[{"LLPsel", ",", "proc"}], "]"}]}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"mLLP", "<", "17"}], ",", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"BrRatioScalar", "[", 
           RowBox[{"mLLP", ",", "9"}], "]"}], "]"}], ",", "0"}], "]"}], ",", 
       " ", 
       RowBox[{"{", 
        RowBox[{
        "\"\<c\>\"", ",", "\"\<\!\(\*OverscriptBox[\(c\), \(_\)]\)\>\"", ",", 
         "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}], ",", "\"\<Yes\>\""}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"proc", "=", "\"\<Jets-GG\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ListBrRatiosTemp", "[", 
        RowBox[{"LLPsel", ",", "mLLP_", ",", "proc"}], "]"}], ",", 
       RowBox[{"ListDecayProducts", "[", 
        RowBox[{"LLPsel", ",", "proc"}], "]"}], ",", 
       RowBox[{"JetsPresence", "[", 
        RowBox[{"LLPsel", ",", "proc"}], "]"}]}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"mLLP", "<", "5"}], ",", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"BrRatioScalar", "[", 
           RowBox[{"mLLP", ",", "7"}], "]"}], "]"}], ",", "0"}], "]"}], ",", 
       " ", 
       RowBox[{"{", 
        RowBox[{
        "\"\<g\>\"", ",", "\"\<\!\(\*OverscriptBox[\(g\), \(_\)]\)\>\"", ",", 
         "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}], ",", "\"\<Yes\>\""}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"proc", "=", "\"\<Jets-bb\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ListBrRatiosTemp", "[", 
        RowBox[{"LLPsel", ",", "mLLP_", ",", "proc"}], "]"}], ",", 
       RowBox[{"ListDecayProducts", "[", 
        RowBox[{"LLPsel", ",", "proc"}], "]"}], ",", 
       RowBox[{"JetsPresence", "[", 
        RowBox[{"LLPsel", ",", "proc"}], "]"}]}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{"BrRatioScalar", "[", 
         RowBox[{"mLLP", ",", "10"}], "]"}], "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
        "\"\<b\>\"", ",", "\"\<\!\(\*OverscriptBox[\(b\), \(_\)]\)\>\"", ",", 
         "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}], ",", "\"\<Yes\>\""}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
   "Print", "[", 
    "\"\<All processes with at least two charged/neutral particles:\>\"", 
    "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ProcessesList", "[", 
      RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "=", 
     RowBox[{"procList", "[", "LLPsel", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"ProcessesList", "[", 
           RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"ListDecayProducts", "[", 
          RowBox[{"LLPsel", ",", 
           RowBox[{
            RowBox[{"ProcessesList", "[", 
             RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"ProcessesList", "[", 
           RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "]"}], ",", "1"}], 
        "}"}]}], "]"}], "//", "Transpose"}], "//", "TableForm"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "The", " ", "total", " ", "br", " ", "ratio", " ", "must", " ", "be", 
      " ", 
      RowBox[{"one", ".", " ", "However"}]}], ",", " ", 
     RowBox[{
     "due", " ", "to", " ", "some", " ", "missing", " ", "unimportant", " ", 
      "channels", " ", "and", " ", "some", " ", "approximations"}], ",", " ", 
     RowBox[{"it", " ", "is", " ", "typically", " ", "slightly", " ", 
      RowBox[{"smaller", ".", " ", "Therefore"}]}], ",", " ", 
     RowBox[{
     "the", " ", "br", " ", "ratios", " ", "are", " ", "refined", " ", "to", 
      " ", "be", " ", "normalized", " ", "by", " ", "1"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ListBrRatios", "[", 
       RowBox[{"LLPsel", ",", "mLLP_", ",", "proc"}], "]"}], "=", 
      FractionBox[
       RowBox[{"ListBrRatiosTemp", "[", 
        RowBox[{"LLPsel", ",", "mLLP", ",", "proc"}], "]"}], 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"ListBrRatiosTemp", "[", 
          RowBox[{"LLPsel", ",", "mLLP", ",", "pr"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"pr", ",", 
           RowBox[{"ProcessesList", "[", 
            RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}]}], "}"}]}], 
        "]"}]]}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"proc", ",", 
       RowBox[{"ProcessesList", "[", 
        RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}]}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "Print", "[", "\"\<All processes with at least two charged particles:\>\"",
     "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ProcessesList", "[", 
     RowBox[{"LLPsel", ",", "\"\<False\>\""}], "]"}], "=", 
    RowBox[{"procListnoecal", "[", "LLPsel", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", "\"\<Processes with jets:\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"ProcessesList", "[", 
      RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"JetsPresence", "[", 
        RowBox[{"LLPsel", ",", "#"}], "]"}], "==", "\"\<Yes\>\""}], "&"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdz1kow3EAB/A5Qu3BwxxreGCRrSkpU65MWaOUyG2TLVYiZO4QSYpy5s4D
4428yBGRzBFmecDfMTVztf7KPRJ+39/Dt8/Tt75ff3VZaqEjh8MRksAl6dsJ
z4uVZdXtnEOpm/s1FD81uHgQ63VSLtQZBgPhxFCLGNZKDFRrWvWpNzGo3oeB
OUyXBZoeRqm+mk0HPrGqmaXqmhMHcomqpqohmNEzOQZ5/Zcz8Ih7tQcjF+eO
of4u7AyOmvKpve0BD1BRZLZBgUf6OyxQDNjhz8jjL7SvqVzziPPDs1wY3XfA
g7FTz3OFxITsl224ICrdh5aVZRMc31bai4hNF+XU1dXQiGKiRKChfp9rlEZv
Vlby16aGLqdyLbz0HCuFsdyQ/CPid6u8BmYL+ZPQFqCiKjOvD+CJdsMEB83r
DAx32qIaNz7NkL+isMKK4LiLG6KzsYZ6H/36YSXeTrNfUJvkk3xHFMQLqR2M
LuMTfc9u6m7OcvIPdsUwadB+eChKFbEydYpQDPU23x6BhJX1VUZRr/R+8XUh
5F+WP9XSGS6H08bGRPgPsO8OgA==
  "],
 CellTags->"Evaluation",
 CellLabel->
  "In[120]:=",ExpressionUUID->"43a18e11-283b-420a-92fc-aff251f5a80c"]
}, Closed]],

Cell["Matrix elements", "Subsection",
 CellChangeTimes->{{3.90388977224391*^9, 3.9038897776543636`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"f9f9144a-e7bf-4b4f-93b4-6ed626e83341"]
}, Closed]],

Cell[CellGroupData[{

Cell["DP", "Section",
 CellChangeTimes->{{3.892869864534724*^9, 3.892869865777609*^9}, {
  3.9149998943225365`*^9, 3.91499989446436*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"41ddb9fd-8c27-452a-8458-7602c6b0d4bf"],

Cell[CellGroupData[{

Cell["\<\
List of decay processes and sets of decay products for them, branching ratios\
\>", "Subsection",
 CellChangeTimes->{{3.8905482184733267`*^9, 3.890548219964122*^9}, 
   3.903889051795726*^9},
 CellTags->
  "Evaluation",ExpressionUUID->"997f043b-e20c-4b42-aa24-2862493e38cd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPsel", "=", "\"\<DP\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BrRatiosDPdata", "[", "mV_", "]"}], "=", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], ",", 
         "\"\<phenomenology\>\"", ",", "LLPsel", ",", 
         "\"\<decay widths/BrRatios.m\>\""}], "}"}], "]"}], ",", 
      "\"\<MX\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "all", " ", "representative", " ", "processes"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ProcessesList", "[", 
     RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "=", 
    RowBox[{
     RowBox[{"BrRatiosDPdata", "[", "mV", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "mass", " ", "above", " ", "which", " ", "all", " ", 
    "hadronic", " ", "decays", " ", "are", " ", "approximated", " ", "by", 
    " ", "decays", " ", "into", " ", "jets"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"procsel", "=", 
     RowBox[{
      RowBox[{"ProcessesList", "[", 
       RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListBrRatiosTemp", "[", 
      RowBox[{"LLPsel", ",", "mLLP_", ",", "procsel"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"BrRatiosDPdata", "[", "mLLP", "]"}], "[", 
       RowBox[{"[", "3", "]"}], "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListDecayProducts", "[", 
      RowBox[{"LLPsel", ",", "procsel"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"BrRatiosDPdata", "[", "ma", "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"JetsPresence", "[", 
      RowBox[{"LLPsel", ",", "procsel"}], "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<Jets-light\>\"", ",", "\"\<Jets-cc\>\""}], "}"}], ",", 
         "procsel"}], "]"}], ",", "\"\<Yes\>\"", ",", "\"\<No\>\""}], 
      "]"}]}]}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", 
      RowBox[{
       RowBox[{"BrRatiosDPdata", "[", "mLLP", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "1"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<All processes with at least two charged/neutral particles:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"ProcessesList", "[", 
         RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"ListDecayProducts", "[", 
        RowBox[{"LLPsel", ",", 
         RowBox[{
          RowBox[{"ProcessesList", "[", 
           RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"ProcessesList", "[", 
         RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "]"}], ",", "1"}], 
      "}"}]}], "]"}], "//", "Transpose"}], "//", 
  "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"ListBrRatios", "[", 
     RowBox[{"LLPsel", ",", "mLLP_", ",", "proc"}], "]"}], "=", 
    FractionBox[
     RowBox[{"ListBrRatiosTemp", "[", 
      RowBox[{"LLPsel", ",", "mLLP", ",", "proc"}], "]"}], 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"ListBrRatiosTemp", "[", 
        RowBox[{"LLPsel", ",", "mLLP", ",", "pr"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"pr", ",", 
         RowBox[{"ProcessesList", "[", 
          RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}]}], "}"}]}], "]"}]]}],
    "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"proc", ",", 
     RowBox[{"ProcessesList", "[", 
      RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<All processes with at least two charged particles:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProcessesList", "[", 
   RowBox[{"LLPsel", ",", "\"\<False\>\""}], "]"}], "=", 
  RowBox[{"procListnoecal", "[", "LLPsel", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Processes with jets:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Select", "[", 
  RowBox[{
   RowBox[{"ProcessesList", "[", 
    RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"JetsPresence", "[", 
      RowBox[{"LLPsel", ",", "#"}], "]"}], "==", "\"\<Yes\>\""}], "&"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8928698695146074`*^9, 3.8928699093413143`*^9}, {
  3.892869967056516*^9, 3.892870045863139*^9}, {3.892870084834973*^9, 
  3.8928701425044723`*^9}, {3.8928706138148975`*^9, 3.892870629455335*^9}, {
  3.8928706820345755`*^9, 3.8928707051111665`*^9}, {3.892871374100378*^9, 
  3.892871383854616*^9}, {3.903889945343773*^9, 3.903889955610688*^9}, {
  3.903890021429636*^9, 3.903890258798191*^9}, {3.903890324909803*^9, 
  3.9038903895503206`*^9}, {3.9038973571631775`*^9, 3.90389736052628*^9}, {
  3.904056980390107*^9, 3.9040571501705356`*^9}, {3.9047985343274117`*^9, 
  3.9047985450384064`*^9}, {3.9048054807738094`*^9, 3.9048055232739906`*^9}, {
  3.9048097954671974`*^9, 3.90480979933045*^9}, {3.9139781678546076`*^9, 
  3.913978181238665*^9}, {3.915437185866849*^9, 3.915437185937766*^9}, {
  3.9161554090490775`*^9, 3.9161554090520697`*^9}, {3.9161554416776037`*^9, 
  3.916155467940677*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[161]:=",ExpressionUUID->"5d4b8158-0d1a-47d1-b423-3c41be7e66aa"]
}, Closed]],

Cell[CellGroupData[{

Cell["Matrix elements", "Subsection",
 CellChangeTimes->{{3.90388977224391*^9, 3.9038897776543636`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"9932a970-60aa-47a4-b3f9-9ecfce9cb1c3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Msquared3BodyLLP", "[", 
    RowBox[{
    "\"\<DP\>\"", ",", "\"\<KK\[Pi]\>\"", ",", "E1_", ",", "E3_", ",", 
     "mFIP_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Msquared3BodyLLP", "[", 
     RowBox[{
     "\"\<DP\>\"", ",", 
      "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\!\(\*SuperscriptBox[\(\
\[Pi]\), \(-\)]\)\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", "E1_", 
      ",", "E3_", ",", "mFIP_"}], "]"}], "=", "1"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.904810697961238*^9, 3.9048107189350843`*^9}, {
  3.9154371859427686`*^9, 3.915437185944763*^9}, {3.9154379659628067`*^9, 
  3.9154379794638433`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[172]:=",ExpressionUUID->"1d24b829-a1f5-49ff-8e85-029379d3e58a"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["HNL", "Section",
 CellChangeTimes->{{3.8905481946213627`*^9, 3.89054819518093*^9}, 
   3.914999891882063*^9},
 CellTags->
  "Evaluation",ExpressionUUID->"00f3a20e-73db-4965-86fd-fcf10490284e"],

Cell[CellGroupData[{

Cell["\<\
List of decay processes and sets of decay products for them, branching ratios\
\>", "Subsection",
 CellChangeTimes->{{3.8905482184733267`*^9, 3.890548219964122*^9}, {
  3.9038857318470097`*^9, 3.9038857567964077`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"5fdec02b-4b00-4b0a-877b-d957108f2457"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HNLsList", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<HNL-mixing-e\>\"", ",", "\"\<HNL-mixing-mu\>\"", ",", 
     "\"\<HNL-mixing-tau\>\""}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9150017181778774`*^9, 3.915001732671895*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[173]:=",ExpressionUUID->"336bc10f-b3d9-40b0-b911-7b972fc0105b"],

Cell[CellGroupData[{

Cell["Mixing e", "Subsubsection",
 CellChangeTimes->{{3.9038859293357916`*^9, 3.903885930164573*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"e9418a91-e5ac-47cf-ba8b-5430e173b126"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BrRatiosHNLdata", "[", "mN_", "]"}], "=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<phenomenology/HNL/decay widths/BrExclusiveMixinge.m\>\""}], 
       "}"}], "]"}], ",", "\"\<MX\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LLPsel", "=", 
    RowBox[{"HNLsList", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "all", " ", "representative", " ", "processes"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ProcessesList", "[", 
     RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "=", 
    RowBox[{"Drop", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"BrRatiosHNLdata", "[", "mV", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"-", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "mass", " ", "above", " ", "which", " ", "all", " ", 
    "hadronic", " ", "decays", " ", "are", " ", "approximated", " ", "by", 
    " ", "decays", " ", "into", " ", "jets"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"procsel", "=", 
     RowBox[{
      RowBox[{"ProcessesList", "[", 
       RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListBrRatiosTemp", "[", 
      RowBox[{"LLPsel", ",", "mLLP_", ",", "procsel"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"BrRatiosHNLdata", "[", "mLLP", "]"}], "[", 
       RowBox[{"[", "3", "]"}], "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListDecayProducts", "[", 
      RowBox[{"LLPsel", ",", "procsel"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"BrRatiosHNLdata", "[", "mN", "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"JetsPresence", "[", 
      RowBox[{"LLPsel", ",", "procsel"}], "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<Jets-qql\>\"", ",", "\"\<Jets-qqv\>\""}], "}"}], ",", 
         "procsel"}], "]"}], ",", "\"\<Yes\>\"", ",", "\"\<No\>\""}], 
      "]"}]}]}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{
        RowBox[{"BrRatiosHNLdata", "[", "mLLP", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "1"}], ",", "1"}], 
    "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<All processes with at least two charged/neutral particles:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"ProcessesList", "[", 
         RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"ListDecayProducts", "[", 
        RowBox[{"LLPsel", ",", 
         RowBox[{
          RowBox[{"ProcessesList", "[", 
           RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"ProcessesList", "[", 
         RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "]"}], ",", "1"}], 
      "}"}]}], "]"}], "//", "Transpose"}], "//", 
  "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"ListBrRatios", "[", 
     RowBox[{"LLPsel", ",", "mLLP_", ",", "proc"}], "]"}], "=", 
    FractionBox[
     RowBox[{"ListBrRatiosTemp", "[", 
      RowBox[{"LLPsel", ",", "mLLP", ",", "proc"}], "]"}], 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"ListBrRatiosTemp", "[", 
         RowBox[{"LLPsel", ",", "mLLP", ",", "pr"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"pr", ",", 
          RowBox[{"ProcessesList", "[", 
           RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}]}], "}"}]}], "]"}], 
      "+", 
      RowBox[{
       RowBox[{
        RowBox[{"BrRatiosHNLdata", "[", "mLLP", "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}]]}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"proc", ",", 
     RowBox[{"ProcessesList", "[", 
      RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<All processes with at least two charged particles:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProcessesList", "[", 
   RowBox[{"LLPsel", ",", "\"\<False\>\""}], "]"}], "=", 
  RowBox[{"procListnoecal", "[", "LLPsel", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Processes with jets:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Select", "[", 
  RowBox[{
   RowBox[{"ProcessesList", "[", 
    RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"JetsPresence", "[", 
      RowBox[{"LLPsel", ",", "#"}], "]"}], "==", "\"\<Yes\>\""}], "&"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"LogLogPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Evaluate", "[", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"ListBrRatios", "[", 
        RowBox[{"LLPsel", ",", "mN", ",", "pr"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"pr", ",", 
         RowBox[{"ProcessesList", "[", 
          RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}]}], "}"}]}], "]"}], 
     "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"mN", ",", "0.05", ",", "40"}], "}"}], ",", 
   RowBox[{"PlotRange", "->", "All"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.9048091805470095`*^9, 3.9048092717494445`*^9}, {
   3.9048093178876867`*^9, 3.904809324843322*^9}, {3.904809461572714*^9, 
   3.9048094710727882`*^9}, {3.904809690242631*^9, 3.9048096904653306`*^9}, 
   3.9048097704439344`*^9, 3.9048098167231193`*^9, {3.9048363812606893`*^9, 
   3.9048364813788815`*^9}, 3.914999942024043*^9, {3.9150017458200226`*^9, 
   3.9150017465808697`*^9}, {3.9154371859544315`*^9, 
   3.9154371860386243`*^9}, {3.9161554090585947`*^9, 3.916155409062584*^9}, {
   3.9161554416813755`*^9, 3.9161554679516306`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[174]:=",ExpressionUUID->"4a18ca05-02fe-49f8-aaa2-13ec7d0cd569"]
}, Closed]],

Cell[CellGroupData[{

Cell["Mixing \[Mu]", "Subsubsection",
 CellChangeTimes->{{3.9038859293357916`*^9, 3.9038859391033506`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"8651dd6c-7b20-43d5-a4df-1b14d9456834"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BrRatiosHNLdata", "[", "mN_", "]"}], "=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<phenomenology/HNL/decay widths/BrExclusiveMixing\[Mu].m\>\""}], 
       "}"}], "]"}], ",", "\"\<MX\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LLPsel", "=", 
    RowBox[{"HNLsList", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "all", " ", "representative", " ", "processes"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ProcessesList", "[", 
     RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "=", 
    RowBox[{"Drop", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"BrRatiosHNLdata", "[", "mN", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"-", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "mass", " ", "above", " ", "which", " ", "all", " ", 
    "hadronic", " ", "decays", " ", "are", " ", "approximated", " ", "by", 
    " ", "decays", " ", "into", " ", "jets"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"procsel", "=", 
     RowBox[{
      RowBox[{"ProcessesList", "[", 
       RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListBrRatiosTemp", "[", 
      RowBox[{"LLPsel", ",", "mLLP_", ",", "procsel"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"BrRatiosHNLdata", "[", "mLLP", "]"}], "[", 
       RowBox[{"[", "3", "]"}], "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListDecayProducts", "[", 
      RowBox[{"LLPsel", ",", "procsel"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"BrRatiosHNLdata", "[", "mN", "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"JetsPresence", "[", 
      RowBox[{"LLPsel", ",", "procsel"}], "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<Jets-qql\>\"", ",", "\"\<Jets-qqv\>\""}], "}"}], ",", 
         "procsel"}], "]"}], ",", "\"\<Yes\>\"", ",", "\"\<No\>\""}], 
      "]"}]}]}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{
        RowBox[{"BrRatiosHNLdata", "[", "mLLP", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "1"}], ",", "1"}], 
    "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<All processes with at least two charged/neutral particles:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"ProcessesList", "[", 
         RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"ListDecayProducts", "[", 
        RowBox[{"LLPsel", ",", 
         RowBox[{
          RowBox[{"ProcessesList", "[", 
           RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"ProcessesList", "[", 
         RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "]"}], ",", "1"}], 
      "}"}]}], "]"}], "//", "Transpose"}], "//", 
  "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"ListBrRatios", "[", 
     RowBox[{"LLPsel", ",", "mLLP_", ",", "proc"}], "]"}], "=", 
    FractionBox[
     RowBox[{"ListBrRatiosTemp", "[", 
      RowBox[{"LLPsel", ",", "mLLP", ",", "proc"}], "]"}], 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"ListBrRatiosTemp", "[", 
         RowBox[{"LLPsel", ",", "mLLP", ",", "pr"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"pr", ",", 
          RowBox[{"ProcessesList", "[", 
           RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}]}], "}"}]}], "]"}], 
      "+", 
      RowBox[{
       RowBox[{
        RowBox[{"BrRatiosHNLdata", "[", "mLLP", "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}]]}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"proc", ",", 
     RowBox[{"ProcessesList", "[", 
      RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<All processes with at least two charged particles:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProcessesList", "[", 
   RowBox[{"LLPsel", ",", "\"\<False\>\""}], "]"}], "=", 
  RowBox[{"procListnoecal", "[", "LLPsel", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Processes with jets:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Select", "[", 
  RowBox[{
   RowBox[{"ProcessesList", "[", 
    RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"JetsPresence", "[", 
      RowBox[{"LLPsel", ",", "#"}], "]"}], "==", "\"\<Yes\>\""}], "&"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"LogLogPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Evaluate", "[", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"ListBrRatios", "[", 
        RowBox[{"LLPsel", ",", "mN", ",", "pr"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"pr", ",", 
         RowBox[{"ProcessesList", "[", 
          RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}]}], "}"}]}], "]"}], 
     "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"mN", ",", "0.05", ",", "20"}], "}"}], ",", 
   RowBox[{"PlotRange", "->", "All"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.904809699821054*^9, 3.9048097026815333`*^9}, 
   3.9048106092421255`*^9, {3.9048364583791103`*^9, 3.904836510454241*^9}, 
   3.904836559470274*^9, {3.915001752402686*^9, 3.9150017531238527`*^9}, {
   3.915437186048725*^9, 3.9154371861389832`*^9}, {3.91615540906958*^9, 
   3.9161554090725727`*^9}, {3.9161554416885667`*^9, 3.916155467965708*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[186]:=",ExpressionUUID->"53898b75-321e-4175-9623-05ff4405cf70"]
}, Closed]],

Cell[CellGroupData[{

Cell["Mixing \[Tau]", "Subsubsection",
 CellChangeTimes->{{3.9038859293357916`*^9, 3.903885940790678*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"eaeed452-3f96-499a-987c-f590d6d211a8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BrRatiosHNLdata", "[", "mN_", "]"}], "=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<phenomenology/HNL/decay widths/BrExclusiveMixing\[Tau].m\>\""}], 
       "}"}], "]"}], ",", "\"\<MX\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LLPsel", "=", 
    RowBox[{"HNLsList", "[", 
     RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "all", " ", "representative", " ", "processes"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ProcessesList", "[", 
     RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "=", 
    RowBox[{"Drop", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"BrRatiosHNLdata", "[", "mV", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"-", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "mass", " ", "above", " ", "which", " ", "all", " ", 
    "hadronic", " ", "decays", " ", "are", " ", "approximated", " ", "by", 
    " ", "decays", " ", "into", " ", "jets"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"procsel", "=", 
     RowBox[{
      RowBox[{"ProcessesList", "[", 
       RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListBrRatiosTemp", "[", 
      RowBox[{"LLPsel", ",", "mLLP_", ",", "procsel"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"BrRatiosHNLdata", "[", "mLLP", "]"}], "[", 
       RowBox[{"[", "3", "]"}], "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListDecayProducts", "[", 
      RowBox[{"LLPsel", ",", "procsel"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"BrRatiosHNLdata", "[", "mN", "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"JetsPresence", "[", 
      RowBox[{"LLPsel", ",", "procsel"}], "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<Jets-qql\>\"", ",", "\"\<Jets-qqv\>\""}], "}"}], ",", 
         "procsel"}], "]"}], ",", "\"\<Yes\>\"", ",", "\"\<No\>\""}], 
      "]"}]}]}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{
        RowBox[{"BrRatiosHNLdata", "[", "mLLP", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "1"}], ",", "1"}], 
    "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<All processes with at least two charged/neutral particles:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"ProcessesList", "[", 
         RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"ListDecayProducts", "[", 
        RowBox[{"LLPsel", ",", 
         RowBox[{
          RowBox[{"ProcessesList", "[", 
           RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"ProcessesList", "[", 
         RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "]"}], ",", "1"}], 
      "}"}]}], "]"}], "//", "Transpose"}], "//", 
  "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"ListBrRatios", "[", 
     RowBox[{"LLPsel", ",", "mLLP_", ",", "proc"}], "]"}], "=", 
    FractionBox[
     RowBox[{"ListBrRatiosTemp", "[", 
      RowBox[{"LLPsel", ",", "mLLP", ",", "proc"}], "]"}], 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"ListBrRatiosTemp", "[", 
         RowBox[{"LLPsel", ",", "mLLP", ",", "pr"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"pr", ",", 
          RowBox[{"ProcessesList", "[", 
           RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}]}], "}"}]}], "]"}], 
      "+", 
      RowBox[{
       RowBox[{
        RowBox[{"BrRatiosHNLdata", "[", "mLLP", "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}]]}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"proc", ",", 
     RowBox[{"ProcessesList", "[", 
      RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<All processes with at least two charged particles:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProcessesList", "[", 
   RowBox[{"LLPsel", ",", "\"\<False\>\""}], "]"}], "=", 
  RowBox[{"procListnoecal", "[", "LLPsel", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Processes with jets:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Select", "[", 
  RowBox[{
   RowBox[{"ProcessesList", "[", 
    RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"JetsPresence", "[", 
      RowBox[{"LLPsel", ",", "#"}], "]"}], "==", "\"\<Yes\>\""}], "&"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"LogLogPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Evaluate", "[", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"ListBrRatios", "[", 
        RowBox[{"LLPsel", ",", "mN", ",", "pr"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"pr", ",", 
         RowBox[{"ProcessesList", "[", 
          RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}]}], "}"}]}], "]"}], 
     "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"mN", ",", "0.05", ",", "20"}], "}"}], ",", 
   RowBox[{"PlotRange", "->", "All"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.9038860671155977`*^9, 3.9038861237508535`*^9}, {
   3.90388620315804*^9, 3.9038862228103704`*^9}, {3.9038873353995724`*^9, 
   3.903887452820258*^9}, {3.9038968939759216`*^9, 3.9038968944048986`*^9}, {
   3.9038972298466816`*^9, 3.9038972302415824`*^9}, {3.904057409334317*^9, 
   3.904057480838933*^9}, 3.904063161474887*^9, {3.904065478546543*^9, 
   3.9040656349712105`*^9}, {3.9040695502579613`*^9, 3.904069554931514*^9}, {
   3.904794001563752*^9, 3.9047940237275496`*^9}, {3.9048106430432034`*^9, 
   3.9048106547973595`*^9}, {3.9048365174238224`*^9, 3.904836542239779*^9}, {
   3.904837237052538*^9, 3.9048372375053687`*^9}, {3.915001756745147*^9, 
   3.915001757628356*^9}, {3.9154371861485214`*^9, 3.915437186230893*^9}, {
   3.9161554090805683`*^9, 3.916155409084558*^9}, {3.9161554416967397`*^9, 
   3.916155467976704*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[198]:=",ExpressionUUID->"57b30cc8-7707-4b83-9049-3de463d79e9d"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Matrix elements", "Subsection",
 CellChangeTimes->{{3.890548260660879*^9, 3.890548262247324*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"e94bdfe6-c3b0-4fd4-a617-4332a0f6a405"],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{"N", "->", 
   RowBox[{"\[Pi]\[Pi]\[Nu]", "/", "\[Pi]\[Pi]l"}]}], 
  TraditionalForm]],ExpressionUUID->"b28d512b-bb7c-4028-88cc-923c56d2a0b9"]], \
"Subsubsection",
 CellChangeTimes->{{3.9151229761690035`*^9, 3.915122988037482*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"50e0c4bd-37c7-4619-83fd-fd0e87cdf809"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MNtol\[Pi]\[Pi]", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      FractionBox["1", 
       SqrtBox["2"]], 
      RowBox[{
       RowBox[{"SpinorUBar", "[", 
        RowBox[{"p3", ",", "m3"}], "]"}], ".", 
       RowBox[{"GA", "[", "\[Mu]", "]"}], ".", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"GA", "[", "5", "]"}]}], ")"}], ".", 
       RowBox[{"SpinorU", "[", 
        RowBox[{"p", ",", "m"}], "]"}]}], "*", 
      FractionBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"MT", "[", 
           RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}]}], "+", 
         FractionBox[
          RowBox[{
           RowBox[{"FV", "[", 
            RowBox[{
             RowBox[{"p", "-", "p3"}], ",", "\[Mu]"}], "]"}], "*", 
           RowBox[{"FV", "[", 
            RowBox[{
             RowBox[{"p", "-", "p3"}], ",", "\[Nu]"}], "]"}]}], 
          SuperscriptBox["m\[Rho]", "2"]]}], ")"}], 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ExpandScalarProduct", "[", 
             RowBox[{"ScalarProduct", "[", 
              RowBox[{
               RowBox[{"p", "-", "p3"}], ",", 
               RowBox[{"p", "-", "p3"}]}], "]"}], "]"}], "-", 
            SuperscriptBox["m\[Rho]", "2"]}], ")"}], "2"], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalGamma]\[Rho]", "2"], "*", 
          SuperscriptBox["m\[Rho]", "2"]}]}]]], "*", 
      RowBox[{"(", 
       RowBox[{"FV", "[", 
        RowBox[{
         RowBox[{"p2", "-", "p1"}], ",", "\[Nu]"}], "]"}], ")"}]}], "//", 
     "Contract"}], "//", "ExpandScalarProduct"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MNtol\[Pi]\[Pi]Star", "=", 
   RowBox[{"ComplexConjugate", "[", "MNtol\[Pi]\[Pi]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MNtol\[Pi]\[Pi]SquaredTemp", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"FermionSpinSum", "[", 
         RowBox[{"MNtol\[Pi]\[Pi]", "*", "MNtol\[Pi]\[Pi]Star"}], "]"}]}], "/.", 
       RowBox[{"DiracTrace", "\[Rule]", "TR"}]}], "//", "Contract"}], "//", 
     "Simplify"}], "//", "ExpandScalarProduct"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MNtol\[Pi]\[Pi]SquaredTemp2", "[", 
    RowBox[{
    "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}],
    "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"MNtol\[Pi]\[Pi]SquaredTemp", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ScalarProduct", "[", 
            RowBox[{"p", ",", "p1"}], "]"}], "->", "ProductKK1energy"}], ",", 
          RowBox[{
           RowBox[{"ScalarProduct", "[", 
            RowBox[{"p", ",", "p2"}], "]"}], "->", "ProductKK2energy"}], ",", 
          RowBox[{
           RowBox[{"ScalarProduct", "[", 
            RowBox[{"p1", ",", "p2"}], "]"}], "->", "ProductK1K2energy"}], 
          ",", 
          RowBox[{
           RowBox[{"ScalarProduct", "[", 
            RowBox[{"p", ",", "p"}], "]"}], "->", "ProductKK"}], ",", 
          RowBox[{
           RowBox[{"ScalarProduct", "[", 
            RowBox[{"p", ",", "p3"}], "]"}], "->", "ProductKK3energy"}], ",", 
          RowBox[{
           RowBox[{"ScalarProduct", "[", 
            RowBox[{"p2", ",", "p2"}], "]"}], "->", "ProductK2K2"}], ",", 
          RowBox[{
           RowBox[{"ScalarProduct", "[", 
            RowBox[{"p3", ",", "p3"}], "]"}], "->", "ProductK3K3"}], ",", 
          RowBox[{
           RowBox[{"ScalarProduct", "[", 
            RowBox[{"p2", ",", "p3"}], "]"}], "->", "ProductK2K3energy"}], 
          ",", 
          RowBox[{
           RowBox[{"ScalarProduct", "[", 
            RowBox[{"p1", ",", "p3"}], "]"}], "->", "ProductK1K3energy"}], 
          ",", 
          RowBox[{
           RowBox[{"ScalarProduct", "[", 
            RowBox[{"p1", ",", "p1"}], "]"}], "->", "ProductK1K1"}]}], 
         "}"}]}], "//", "Expand"}], "//", "Simplify"}], ")"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[CapitalGamma]\[Rho]", "->", "0.1478"}], ",", 
      RowBox[{"m\[Rho]", "->", 
       RowBox[{"ParamProductMass", "[", "113", "]"}]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"fip", "=", "LLP"}], ";", "\[IndentingNewLine]", 
    RowBox[{"proc", "=", "PROC"}], ";", "\[IndentingNewLine]", 
    RowBox[{"mprodlist", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"ParamProductMass", "[", "#", "]"}], "&"}], "/@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"ParamProductToPDGid", "[", "#", "]"}], "&"}], "/@", 
        RowBox[{"ListDecayProducts", "[", 
         RowBox[{"fip", ",", "proc"}], "]"}]}], ")"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Msquared3BodyLLP", "[", 
      RowBox[{"fip", ",", "proc", ",", "E1_", ",", "E3_", ",", "mLLP_"}], 
      "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"MNtol\[Pi]\[Pi]SquaredTemp2", "[", 
        RowBox[{
        "E1", ",", "E3", ",", "mLLP", ",", "m1", ",", "m2", ",", "m3"}], 
        "]"}], "/.", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Symbol", "[", 
           RowBox[{"\"\<m\>\"", "<>", 
            RowBox[{"ToString", "[", "i", "]"}]}], "]"}], "->", 
          RowBox[{"mprodlist", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "3", ",", "1"}], "}"}]}], "]"}]}], "//",
       "Simplify"}]}]}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"PROC", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<2\[Pi]l\>\"", ",", "\"\<2\[Pi]\[Nu]\>\""}], "}"}]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{"LLP", ",", "HNLsList"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.9151229901891394`*^9, 3.9151231753876486`*^9}, {
   3.9151232170178895`*^9, 3.915123217987553*^9}, {3.91512328706763*^9, 
   3.9151233508889823`*^9}, {3.9151233914979177`*^9, 3.915123410368494*^9}, {
   3.915123441151003*^9, 3.9151235236885586`*^9}, 3.915436661107315*^9, {
   3.9154371862348013`*^9, 3.9154371862428885`*^9}, {3.9157822846719155`*^9, 
   3.9157822856393347`*^9}, {3.9157823305312986`*^9, 3.9157823308742013`*^9}, 
   3.9161554090885706`*^9, {3.916155610042941*^9, 3.9161556222042117`*^9}, {
   3.9161556732933607`*^9, 3.9161556732964067`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[210]:=",ExpressionUUID->"1bf083cf-0ca6-4620-9c3d-78f01f9b0a75"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"N", "\[Rule]", " ", 
    RowBox[{"q", "+", 
     RowBox[{
      OverscriptBox["q", "_"], "'"}], "+", "l"}]}], ",", " ", 
   RowBox[{"q", "+", 
    OverscriptBox["q", "_"], "+", "\[Nu]", " "}]}], 
  TraditionalForm]],ExpressionUUID->"2716eab2-6d56-4550-b435-9496adc14676"]], \
"Subsubsection",
 CellChangeTimes->{{3.8535592268006334`*^9, 3.853559247457441*^9}, {
   3.885009951914181*^9, 3.8850099537688904`*^9}, 3.888378238996126*^9, 
   3.9149999714733963`*^9, {3.9150006603834715`*^9, 3.9150006714749937`*^9}, {
   3.9154366189030323`*^9, 3.915436637753731*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"c3cc3e7f-a5a0-47ef-b19c-cdbeda81c260"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
    "___", "___", "___", "___", "___", "___", "___", "_"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"qq", "\[VeryThinSpace]", "l"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
    "___", "___", "___", "___", "___", "___", "___", "_"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"M3bodyqql", "=", 
     RowBox[{
      RowBox[{
       FractionBox["1", 
        RowBox[{"2", 
         SqrtBox["2"]}]], 
       RowBox[{
        RowBox[{"SpinorUBar", "[", 
         RowBox[{"k3", ",", "m3"}], "]"}], ".", 
        RowBox[{"GA", "[", "\[Mu]", "]"}], ".", 
        RowBox[{"(", 
         RowBox[{"1", "-", "GA5"}], ")"}], ".", 
        RowBox[{"SpinorU", "[", 
         RowBox[{"k", ",", "m"}], "]"}]}], "*", 
       RowBox[{
        RowBox[{"SpinorUBar", "[", 
         RowBox[{"k1", ",", "m1"}], "]"}], ".", 
        RowBox[{"GA", "[", "\[Mu]", "]"}], ".", 
        RowBox[{"(", 
         RowBox[{"1", "-", "GA5"}], ")"}], ".", 
        RowBox[{"SpinorV", "[", 
         RowBox[{"k2", ",", "m2"}], "]"}]}]}], "//", "Contract"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"M3bodyqqlStar", "=", 
     RowBox[{"ComplexConjugate", "[", "M3bodyqql", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"M3bodyqqlSquared", "[", 
     RowBox[{
     "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], 
     "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{"Expand", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"FermionSpinSum", "[", 
            RowBox[{"M3bodyqql", " ", "M3bodyqqlStar"}], "]"}], "/.", 
           RowBox[{"DiracTrace", "\[Rule]", "TR"}]}], "//", "Contract"}], "//",
          "Simplify"}], "]"}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"ScalarProduct", "[", 
          RowBox[{"k", ",", "k"}], "]"}], "\[Rule]", "ProductKK"}], ",", 
        RowBox[{
         RowBox[{"ScalarProduct", "[", 
          RowBox[{"k2", ",", "k2"}], "]"}], "\[Rule]", "ProductK2K2"}], ",", 
        RowBox[{
         RowBox[{"ScalarProduct", "[", 
          RowBox[{"k", ",", "k2"}], "]"}], "\[Rule]", "ProductKK2energy"}], 
        ",", 
        RowBox[{
         RowBox[{"ScalarProduct", "[", 
          RowBox[{"k", ",", "k1"}], "]"}], "\[Rule]", " ", 
         "ProductKK1energy"}], ",", 
        RowBox[{
         RowBox[{"ScalarProduct", "[", 
          RowBox[{"k", ",", "k3"}], "]"}], "\[Rule]", "ProductKK3energy"}], 
        ",", 
        RowBox[{
         RowBox[{"ScalarProduct", "[", 
          RowBox[{"k1", ",", "k3"}], "]"}], "\[Rule]", "ProductK1K3energy"}], 
        " ", ",", 
        RowBox[{
         RowBox[{"ScalarProduct", "[", 
          RowBox[{"k1", ",", "k2"}], "]"}], "\[Rule]", "ProductK1K2energy"}], 
        ",", 
        RowBox[{
         RowBox[{"ScalarProduct", "[", 
          RowBox[{"k2", ",", "k3"}], "]"}], "\[Rule]", " ", 
         "ProductK2K3energy"}]}], "}"}]}], "//", "Simplify"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"fip", "=", "LLP"}], ";", "\[IndentingNewLine]", 
      RowBox[{"proc", "=", "\"\<Jets-qql\>\""}], ";", "\[IndentingNewLine]", 
      RowBox[{"mprodlist", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"ParamProductMass", "[", "#", "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"ParamProductToPDGid", "[", "#", "]"}], "&"}], "/@", 
          RowBox[{"ListDecayProducts", "[", 
           RowBox[{"fip", ",", "proc"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Msquared3BodyLLP", "[", 
        RowBox[{"fip", ",", "proc", ",", "E1_", ",", "E3_", ",", "mLLP_"}], 
        "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"M3bodyqqlSquared", "[", 
           RowBox[{
           "E1", ",", "E3", ",", "mLLP", ",", "m1", ",", "m2", ",", "m3"}], 
           "]"}], "/.", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Symbol", "[", 
              RowBox[{"\"\<m\>\"", "<>", 
               RowBox[{"ToString", "[", "i", "]"}]}], "]"}], "->", 
             RowBox[{"mprodlist", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "3", ",", "1"}], "}"}]}], "]"}]}], "//",
          "Chop"}], "//", "Simplify"}]}]}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"LLP", ",", "HNLsList"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
     "___", "___", "___", "___", "___", "___", "___", "_"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"qq", "\[VeryThinSpace]", "\[Nu]"}], ",", " ", 
     RowBox[{
     "assuming", " ", "that", " ", "the", " ", "main", " ", "contribution", 
      " ", "comes", " ", "from", " ", 
      RowBox[{"u", "/", "d"}], " ", "quarks"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
     "___", "___", "___", "___", "___", "___", "___", "_"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"M3bodyqq\[Nu]", "=", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], "*", 
       FractionBox["1", 
        RowBox[{"4", 
         SqrtBox["2"]}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"SpinorUBar", "[", 
            RowBox[{"k3", ",", "m3"}], "]"}], ".", 
           RowBox[{"GA", "[", "\[Mu]", "]"}], ".", 
           RowBox[{"(", 
            RowBox[{"1", "-", "GA5"}], ")"}], ".", 
           RowBox[{"SpinorU", "[", 
            RowBox[{"k", ",", "m"}], "]"}]}], "*", 
          RowBox[{
           RowBox[{"SpinorUBar", "[", 
            RowBox[{"k1", ",", "m1"}], "]"}], ".", 
           RowBox[{"GA", "[", "\[Mu]", "]"}], ".", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{
              FractionBox["4", "3"], "sin2\[Theta]w"}], "-", "GA5"}], ")"}], 
           ".", 
           RowBox[{"SpinorV", "[", 
            RowBox[{"k2", ",", "m2"}], "]"}]}]}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"SpinorUBar", "[", 
            RowBox[{"k3", ",", "m3"}], "]"}], ".", 
           RowBox[{"GA", "[", "\[Mu]", "]"}], ".", 
           RowBox[{"(", 
            RowBox[{"1", "-", "GA5"}], ")"}], ".", 
           RowBox[{"SpinorU", "[", 
            RowBox[{"k", ",", "m"}], "]"}]}], "*", 
          RowBox[{
           RowBox[{"SpinorUBar", "[", 
            RowBox[{"k1", ",", "m1"}], "]"}], ".", 
           RowBox[{"GA", "[", "\[Mu]", "]"}], ".", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{
              FractionBox["8", "3"], "sin2\[Theta]w"}], "-", "GA5"}], ")"}], 
           ".", 
           RowBox[{"SpinorV", "[", 
            RowBox[{"k2", ",", "m2"}], "]"}]}]}]}], ")"}]}], "//", 
      "Contract"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"M3bodyqq\[Nu]Star", "=", 
     RowBox[{"ComplexConjugate", "[", "M3bodyqq\[Nu]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"M3bodyqq\[Nu]Squared", "[", 
     RowBox[{
     "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], 
     "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{"Expand", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"FermionSpinSum", "[", 
            RowBox[{"M3bodyqq\[Nu]", " ", "M3bodyqq\[Nu]Star"}], "]"}], "/.", 
           RowBox[{"DiracTrace", "\[Rule]", "TR"}]}], "//", "Contract"}], "//",
          "Simplify"}], "]"}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"ScalarProduct", "[", 
          RowBox[{"k", ",", "k"}], "]"}], "\[Rule]", "ProductKK"}], ",", 
        RowBox[{
         RowBox[{"ScalarProduct", "[", 
          RowBox[{"k2", ",", "k2"}], "]"}], "\[Rule]", "ProductK2K2"}], ",", 
        RowBox[{
         RowBox[{"ScalarProduct", "[", 
          RowBox[{"k", ",", "k2"}], "]"}], "\[Rule]", "ProductKK2energy"}], 
        ",", 
        RowBox[{
         RowBox[{"ScalarProduct", "[", 
          RowBox[{"k", ",", "k1"}], "]"}], "\[Rule]", " ", 
         "ProductKK1energy"}], ",", 
        RowBox[{
         RowBox[{"ScalarProduct", "[", 
          RowBox[{"k", ",", "k3"}], "]"}], "\[Rule]", "ProductKK3energy"}], 
        ",", 
        RowBox[{
         RowBox[{"ScalarProduct", "[", 
          RowBox[{"k1", ",", "k3"}], "]"}], "\[Rule]", "ProductK1K3energy"}], 
        " ", ",", 
        RowBox[{
         RowBox[{"ScalarProduct", "[", 
          RowBox[{"k1", ",", "k2"}], "]"}], "\[Rule]", "ProductK1K2energy"}], 
        ",", 
        RowBox[{
         RowBox[{"ScalarProduct", "[", 
          RowBox[{"k2", ",", "k3"}], "]"}], "\[Rule]", " ", 
         "ProductK2K3energy"}]}], "}"}]}], "//", "Simplify"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"fip", "=", "LLP"}], ";", "\[IndentingNewLine]", 
      RowBox[{"proc", "=", "\"\<Jets-qqv\>\""}], ";", "\[IndentingNewLine]", 
      RowBox[{"mprodlist", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"ParamProductMass", "[", "#", "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"ParamProductToPDGid", "[", "#", "]"}], "&"}], "/@", 
          RowBox[{"ListDecayProducts", "[", 
           RowBox[{"fip", ",", "proc"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Msquared3BodyLLP", "[", 
        RowBox[{"fip", ",", "proc", ",", "E1_", ",", "E3_", ",", "mLLP_"}], 
        "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"M3bodyqq\[Nu]Squared", "[", 
            RowBox[{
            "E1", ",", "E3", ",", "mLLP", ",", "m1", ",", "m2", ",", "m3"}], 
            "]"}], "/.", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Symbol", "[", 
               RowBox[{"\"\<m\>\"", "<>", 
                RowBox[{"ToString", "[", "i", "]"}]}], "]"}], "->", 
              RowBox[{"mprodlist", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "3", ",", "1"}], "}"}]}], "]"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{"sin2\[Theta]w", "->", "0.23"}], "}"}]}], "//", "Chop"}], "//",
         "Simplify"}]}]}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"LLP", ",", "HNLsList"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.915000187663577*^9, 3.9150002297129707`*^9}, {
  3.915000271527567*^9, 3.9150002759307594`*^9}, {3.915000438866624*^9, 
  3.9150006265496464`*^9}, {3.915000677254943*^9, 3.9150007759053802`*^9}, {
  3.915001771456135*^9, 3.9150017781396713`*^9}, {3.9150018409820175`*^9, 
  3.915001862902348*^9}, {3.9150114204476204`*^9, 3.9150114206376266`*^9}, {
  3.915011463766672*^9, 3.91501150595673*^9}, {3.9150889572758083`*^9, 
  3.915088960255096*^9}, {3.9154366654275875`*^9, 3.915436701687518*^9}, {
  3.9154371862488747`*^9, 3.91543718629165*^9}, {3.915604744619646*^9, 
  3.915604750082438*^9}, {3.9161554090960603`*^9, 3.9161554091010923`*^9}, {
  3.9161556100496235`*^9, 3.916155622216009*^9}, {3.9161556733034286`*^9, 
  3.916155673307504*^9}, {3.9168980779773417`*^9, 3.9168980815517216`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[215]:=",ExpressionUUID->"05913f27-fde0-42bd-842c-7a0ce4b32ced"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{"N", "->", 
   RowBox[{"l", "+", 
    RowBox[{"l", "'"}], "+", "\[Nu]"}]}], 
  TraditionalForm]],ExpressionUUID->"a8fbcbb5-f7cb-46d2-a279-1a6da4545e96"]], \
"Subsubsection",
 CellChangeTimes->{{3.9150008159032288`*^9, 3.91500082071872*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"d2a994bd-5350-4d79-b690-0a540322322e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"procsleptonic", "[", 
    RowBox[{"HNLsList", "[", 
     RowBox[{"[", "3", "]"}], "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<\[Tau]e\[Nu]\>\"", ",", "\"\<\[Tau]\[Mu]\[Nu]\>\"", ",", 
     "\"\<ee\[Nu]\>\"", ",", "\"\<\[Mu]\[Mu]\[Nu]\>\"", ",", 
     "\"\<\[Tau]\[Tau]\[Nu]\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"procsleptonic", "[", 
    RowBox[{"HNLsList", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<\[Mu]e\[Nu]\>\"", ",", "\"\<\[Mu]\[Tau]\[Nu]\>\"", ",", 
     "\"\<ee\[Nu]\>\"", ",", "\"\<\[Mu]\[Mu]\[Nu]\>\"", ",", 
     "\"\<\[Tau]\[Tau]\[Nu]\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"procsleptonic", "[", 
     RowBox[{"HNLsList", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
     "\"\<e\[Mu]\[Nu]\>\"", ",", "\"\<e\[Tau]\[Nu]\>\"", ",", 
      "\"\<ee\[Nu]\>\"", ",", "\"\<\[Mu]\[Mu]\[Nu]\>\"", ",", 
      "\"\<\[Tau]\[Tau]\[Nu]\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
    "__"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"l", " ", "!=", " ", 
    RowBox[{"l", "'"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
    "__"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M3bodyllpr\[Nu]", "=", 
   RowBox[{
    RowBox[{
     FractionBox["1", 
      RowBox[{"2", 
       SqrtBox["2"]}]], 
     RowBox[{
      RowBox[{"SpinorUBar", "[", 
       RowBox[{"k1", ",", "m1"}], "]"}], ".", 
      RowBox[{"GA", "[", "\[Mu]", "]"}], ".", 
      RowBox[{"(", 
       RowBox[{"1", "-", "GA5"}], ")"}], ".", 
      RowBox[{"SpinorU", "[", 
       RowBox[{"k", ",", "m"}], "]"}]}], "*", 
     RowBox[{
      RowBox[{"SpinorUBar", "[", 
       RowBox[{"k2", ",", "m2"}], "]"}], ".", 
      RowBox[{"GA", "[", "\[Mu]", "]"}], ".", 
      RowBox[{"(", 
       RowBox[{"1", "-", "GA5"}], ")"}], ".", 
      RowBox[{"SpinorV", "[", 
       RowBox[{"k3", ",", "m3"}], "]"}]}]}], "//", "Contract"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M3bodyllpr\[Nu]Star", "=", 
   RowBox[{"ComplexConjugate", "[", "M3bodyllpr\[Nu]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M3bodyllpr\[Nu]Squared", "[", 
   RowBox[{"E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}],
    "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{"Expand", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"FermionSpinSum", "[", 
          RowBox[{"M3bodyllpr\[Nu]", " ", "M3bodyllpr\[Nu]Star"}], "]"}], "/.", 
         RowBox[{"DiracTrace", "\[Rule]", "TR"}]}], "//", "Contract"}], "//", 
       "Simplify"}], "]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"ScalarProduct", "[", 
        RowBox[{"k", ",", "k"}], "]"}], "\[Rule]", "ProductKK"}], ",", 
      RowBox[{
       RowBox[{"ScalarProduct", "[", 
        RowBox[{"k2", ",", "k2"}], "]"}], "\[Rule]", "ProductK2K2"}], ",", 
      RowBox[{
       RowBox[{"ScalarProduct", "[", 
        RowBox[{"k", ",", "k2"}], "]"}], "\[Rule]", "ProductKK2energy"}], ",", 
      RowBox[{
       RowBox[{"ScalarProduct", "[", 
        RowBox[{"k", ",", "k1"}], "]"}], "\[Rule]", " ", "ProductKK1energy"}],
       ",", 
      RowBox[{
       RowBox[{"ScalarProduct", "[", 
        RowBox[{"k", ",", "k3"}], "]"}], "\[Rule]", "ProductKK3energy"}], ",", 
      RowBox[{
       RowBox[{"ScalarProduct", "[", 
        RowBox[{"k1", ",", "k3"}], "]"}], "\[Rule]", "ProductK1K3energy"}], 
      " ", ",", 
      RowBox[{
       RowBox[{"ScalarProduct", "[", 
        RowBox[{"k1", ",", "k2"}], "]"}], "\[Rule]", "ProductK1K2energy"}], 
      ",", 
      RowBox[{
       RowBox[{"ScalarProduct", "[", 
        RowBox[{"k2", ",", "k3"}], "]"}], "\[Rule]", " ", 
       "ProductK2K3energy"}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fip", "=", "LLP"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"mprodlist", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ParamProductMass", "[", "#", "]"}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"ParamProductToPDGid", "[", "#", "]"}], "&"}], "/@", 
            RowBox[{"ListDecayProducts", "[", 
             RowBox[{"LLP", ",", "proc"}], "]"}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Msquared3BodyLLP", "[", 
          RowBox[{"LLP", ",", "proc", ",", "E1_", ",", "E3_", ",", "mLLP_"}], 
          "]"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"M3bodyllpr\[Nu]Squared", "[", 
             RowBox[{
             "E1", ",", "E3", ",", "mLLP", ",", "m1", ",", "m2", ",", "m3"}], 
             "]"}], "/.", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Symbol", "[", 
                RowBox[{"\"\<m\>\"", "<>", 
                 RowBox[{"ToString", "[", "i", "]"}]}], "]"}], "->", 
               RowBox[{"mprodlist", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "3", ",", "1"}], "}"}]}], "]"}]}], 
           "//", "Chop"}], "//", "Simplify"}]}]}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"proc", ",", 
         RowBox[{"Drop", "[", 
          RowBox[{
           RowBox[{"procsleptonic", "[", "fip", "]"}], ",", 
           RowBox[{"-", "3"}]}], "]"}]}], "}"}]}], "]"}]}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"LLP", ",", "HNLsList"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
    "__"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"l", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"l", "'"}], ".", " ", "Two"}], " ", "contributions"}], " ", 
     "-", " ", 
     RowBox[{
     "from", " ", "charged", " ", "and", " ", "from", " ", "neutral", " ", 
      "currents"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
    "__"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M3bodyll\[Nu]", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", 
        RowBox[{"2", 
         SqrtBox["2"]}]], 
       RowBox[{
        RowBox[{"SpinorUBar", "[", 
         RowBox[{"k1", ",", "m1"}], "]"}], ".", 
        RowBox[{"GA", "[", "\[Mu]", "]"}], ".", 
        RowBox[{"(", 
         RowBox[{"1", "-", "GA5"}], ")"}], ".", 
        RowBox[{"SpinorU", "[", 
         RowBox[{"k", ",", "m"}], "]"}]}], "*", 
       RowBox[{
        RowBox[{"SpinorUBar", "[", 
         RowBox[{"k3", ",", "m3"}], "]"}], ".", 
        RowBox[{"GA", "[", "\[Mu]", "]"}], ".", 
        RowBox[{"(", 
         RowBox[{"1", "-", "GA5"}], ")"}], ".", 
        RowBox[{"SpinorV", "[", 
         RowBox[{"k2", ",", "m2"}], "]"}]}]}], "//", "Contract"}], ")"}], "+", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", 
        RowBox[{"4", 
         SqrtBox["2"]}]], 
       RowBox[{
        RowBox[{"SpinorUBar", "[", 
         RowBox[{"k3", ",", "m3"}], "]"}], ".", 
        RowBox[{"GA", "[", "\[Mu]", "]"}], ".", 
        RowBox[{"(", 
         RowBox[{"1", "-", "GA5"}], ")"}], ".", 
        RowBox[{"SpinorU", "[", 
         RowBox[{"k", ",", "m"}], "]"}]}], "*", 
       RowBox[{
        RowBox[{"SpinorUBar", "[", 
         RowBox[{"k1", ",", "m1"}], "]"}], ".", 
        RowBox[{"GA", "[", "\[Mu]", "]"}], ".", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"4", "sin2\[Theta]w"}], "-", "GA5"}], ")"}], ".", 
        RowBox[{"SpinorV", "[", 
         RowBox[{"k2", ",", "m2"}], "]"}]}]}], "//", "Contract"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M3bodyll\[Nu]Star", "=", 
   RowBox[{"ComplexConjugate", "[", "M3bodyll\[Nu]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M3bodyll\[Nu]Squared", "[", 
   RowBox[{"E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}],
    "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"Simplify", "[", 
      RowBox[{"Expand", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"FermionSpinSum", "[", 
           RowBox[{"M3bodyll\[Nu]", " ", "M3bodyll\[Nu]Star"}], "]"}], "/.", 
          RowBox[{"DiracTrace", "\[Rule]", "TR"}]}], "//", "Contract"}], "//",
         "Simplify"}], "]"}], "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"ScalarProduct", "[", 
        RowBox[{"k", ",", "k"}], "]"}], "\[Rule]", "ProductKK"}], ",", 
      RowBox[{
       RowBox[{"ScalarProduct", "[", 
        RowBox[{"k2", ",", "k2"}], "]"}], "\[Rule]", "ProductK2K2"}], ",", 
      RowBox[{
       RowBox[{"ScalarProduct", "[", 
        RowBox[{"k", ",", "k2"}], "]"}], "\[Rule]", "ProductKK2energy"}], ",", 
      RowBox[{
       RowBox[{"ScalarProduct", "[", 
        RowBox[{"k", ",", "k1"}], "]"}], "\[Rule]", " ", "ProductKK1energy"}],
       ",", 
      RowBox[{
       RowBox[{"ScalarProduct", "[", 
        RowBox[{"k", ",", "k3"}], "]"}], "\[Rule]", "ProductKK3energy"}], ",", 
      RowBox[{
       RowBox[{"ScalarProduct", "[", 
        RowBox[{"k1", ",", "k3"}], "]"}], "\[Rule]", "ProductK1K3energy"}], 
      " ", ",", 
      RowBox[{
       RowBox[{"ScalarProduct", "[", 
        RowBox[{"k1", ",", "k2"}], "]"}], "\[Rule]", "ProductK1K2energy"}], 
      ",", 
      RowBox[{
       RowBox[{"ScalarProduct", "[", 
        RowBox[{"k2", ",", "k3"}], "]"}], "\[Rule]", " ", 
       "ProductK2K3energy"}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"fip", "=", "LLP"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"mprodlist", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ParamProductMass", "[", "#", "]"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"ParamProductToPDGid", "[", "#", "]"}], "&"}], "/@", 
           RowBox[{"ListDecayProducts", "[", 
            RowBox[{"fip", ",", "proc"}], "]"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Msquared3BodyLLP", "[", 
         RowBox[{
         "LLP", ",", "proc", ",", "E1_", ",", "E3_", ",", " ", "mLLP_"}], 
         "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"M3bodyll\[Nu]Squared", "[", 
             RowBox[{
             "E1", ",", "E3", ",", "mLLP", ",", "m1", ",", "m2", ",", "m3"}], 
             "]"}], "/.", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Symbol", "[", 
                RowBox[{"\"\<m\>\"", "<>", 
                 RowBox[{"ToString", "[", "i", "]"}]}], "]"}], "->", 
               RowBox[{"mprodlist", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "3", ",", "1"}], "}"}]}], "]"}]}], 
           "/.", 
           RowBox[{"{", 
            RowBox[{"sin2\[Theta]w", "->", "0.23"}], "}"}]}], "//", "Chop"}], 
         "//", "Simplify"}]}]}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"proc", ",", 
        RowBox[{"Drop", "[", 
         RowBox[{
          RowBox[{"procsleptonic", "[", "fip", "]"}], ",", "2"}], "]"}]}], 
       "}"}]}], "]"}]}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"LLP", ",", "HNLsList"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.891010092536611*^9, 3.8910100957866955`*^9}, {
   3.8941764213347774`*^9, 3.8941764234104056`*^9}, {3.903887519304772*^9, 
   3.90388757323549*^9}, {3.903890770585346*^9, 3.9038907880254383`*^9}, {
   3.9040574937912507`*^9, 3.904057498961843*^9}, {3.9040631283604918`*^9, 
   3.9040631611544075`*^9}, {3.904065712337265*^9, 3.9040658743452997`*^9}, {
   3.9048108137719965`*^9, 3.90481082845654*^9}, {3.904810867411179*^9, 
   3.9048109669786406`*^9}, {3.9048366553532705`*^9, 
   3.9048366840014954`*^9}, {3.906801393625865*^9, 3.906801412285822*^9}, {
   3.91499998437124*^9, 3.9150000034131007`*^9}, {3.9150000711259933`*^9, 
   3.915000079987942*^9}, {3.9150002887518806`*^9, 3.9150004338092146`*^9}, {
   3.9150008245492544`*^9, 3.915000851910133*^9}, {3.915001225962349*^9, 
   3.9150013511518855`*^9}, {3.915001381293515*^9, 3.9150014085362806`*^9}, {
   3.915001454431863*^9, 3.9150014570876603`*^9}, {3.9150015916625595`*^9, 
   3.915001607243252*^9}, {3.915001642936663*^9, 3.915001688042386*^9}, {
   3.9150018960635023`*^9, 3.915001976293064*^9}, {3.91500202538128*^9, 
   3.9150020900194783`*^9}, {3.9150021515645604`*^9, 3.915002217573068*^9}, {
   3.9150084588230925`*^9, 3.915008463550321*^9}, {3.915009391137583*^9, 
   3.9150093924347143`*^9}, 3.9150099463778176`*^9, {3.915010111318649*^9, 
   3.9150101215075397`*^9}, {3.915011370457554*^9, 3.915011400747755*^9}, 
   3.915011514896694*^9, {3.915436681188373*^9, 3.91543668977318*^9}, {
   3.915437186297673*^9, 3.915437186362314*^9}, 3.9155364421086783`*^9, {
   3.9155365593030977`*^9, 3.9155365618686438`*^9}, {3.9155366475572796`*^9, 
   3.9155366723331437`*^9}, {3.9155929116468897`*^9, 
   3.9155929396796217`*^9}, {3.916155409107092*^9, 3.916155409110085*^9}, {
   3.916155610060695*^9, 3.9161556222257495`*^9}, {3.9161556733124895`*^9, 
   3.9161556733166313`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[223]:=",ExpressionUUID->"3e8f5c91-875c-4cc2-9fac-799e334e4796"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["ALPs coupled to gluons", "Section",
 CellChangeTimes->{{3.890548205242524*^9, 3.890548233837968*^9}, {
  3.9038932905205584`*^9, 3.903893291439942*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"ea766b8e-6762-49cc-a1b9-274a472815cd"],

Cell[CellGroupData[{

Cell["\<\
List of decay processes and sets of decay products for them, branching ratios\
\>", "Subsection",
 CellChangeTimes->{{3.8905482184733267`*^9, 3.890548219964122*^9}, {
  3.9038857318470097`*^9, 3.9038857567964077`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"1aacebd3-7931-4ad0-988a-968a791f6675"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPsel", "=", "\"\<ALP-gluon\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BrRatiosALPgluonData", "[", "ma_", "]"}], "=", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], ",", 
         "\"\<phenomenology\>\"", ",", "LLPsel", ",", 
         "\"\<decay widths/Br-ratios-SensCalc-model-Gluon-scale-1000.-GeV.m\>\
\""}], "}"}], "]"}], ",", "\"\<MX\>\""}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "all", " ", "representative", " ", "processes"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ProcessesList", "[", 
     RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"BrRatiosALPgluonData", "[", "ma", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{"\"\<Jets\>\"", "->", "\"\<Jets-GG\>\""}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "mass", " ", "above", " ", "which", " ", "all", " ", 
    "hadronic", " ", "decays", " ", "are", " ", "approximated", " ", "by", 
    " ", "decays", " ", "into", " ", "jets"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"procsel", "=", 
     RowBox[{
      RowBox[{"ProcessesList", "[", 
       RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListBrRatiosTemp", "[", 
      RowBox[{"LLPsel", ",", "mLLP_", ",", "procsel"}], "]"}], "=", 
     RowBox[{
      RowBox[{"ListBrRatios", "[", 
       RowBox[{"LLPsel", ",", "mLLP_", ",", "procsel"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"BrRatiosALPgluonData", "[", "mLLP", "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], "[", 
       RowBox[{"[", "i", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListDecayProducts", "[", 
      RowBox[{"LLPsel", ",", "procsel"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"BrRatiosALPgluonData", "[", "ma", "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"JetsPresence", "[", 
      RowBox[{"LLPsel", ",", "procsel"}], "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<Jets-ss\>\"", ",", "\"\<Jets-cc\>\"", ",", 
            "\"\<Jets-GG\>\""}], "}"}], ",", "procsel"}], "]"}], "==", 
        "True"}], ",", "\"\<Yes\>\"", ",", "\"\<No\>\""}], "]"}]}]}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", 
      RowBox[{
       RowBox[{"BrRatiosALPgluonData", "[", "mLLP", "]"}], "[", 
       RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", "1"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProcessesList", "[", 
    RowBox[{"LLPsel", ",", "\"\<False\>\""}], "]"}], "=", 
   RowBox[{"procListnoecal", "[", "LLPsel", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"ProcessesList", "[", 
         RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"ListDecayProducts", "[", 
        RowBox[{"LLPsel", ",", 
         RowBox[{
          RowBox[{"ProcessesList", "[", 
           RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"ProcessesList", "[", 
         RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "]"}], ",", "1"}], 
      "}"}]}], "]"}], "//", "Transpose"}], "//", 
  "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<All processes with at least two charged/neutral particles:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ProcessesList", "[", 
  RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<All processes with at least two charged particles:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ProcessesList", "[", 
  RowBox[{"LLPsel", ",", "\"\<False\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Processes with jets:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Select", "[", 
  RowBox[{
   RowBox[{"ProcessesList", "[", 
    RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"JetsPresence", "[", 
      RowBox[{"LLPsel", ",", "#"}], "]"}], "==", "\"\<Yes\>\""}], "&"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"LogLogPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Evaluate", "[", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"ListBrRatiosTemp", "[", 
        RowBox[{"LLPsel", ",", "mN", ",", "pr"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"pr", ",", 
         RowBox[{"ProcessesList", "[", 
          RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}]}], "}"}]}], "]"}], 
     "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"mN", ",", "0.05", ",", "4.5"}], "}"}], ",", 
   RowBox[{"PlotRange", "->", "All"}]}], "]"}]}], "Input",
 CellChangeTimes->{
  3.890550139666936*^9, {3.890550225678339*^9, 3.8905502571105175`*^9}, {
   3.9037089371677756`*^9, 3.9037089439815345`*^9}, {3.903708979372821*^9, 
   3.903709071842332*^9}, {3.903709123667943*^9, 3.903709226373082*^9}, {
   3.903709360274336*^9, 3.903709364947524*^9}, {3.903709483835615*^9, 
   3.9037096654511623`*^9}, {3.9037097177970533`*^9, 
   3.9037098360539303`*^9}, {3.9037103532952595`*^9, 
   3.9037103632426353`*^9}, {3.903710395751079*^9, 3.903710408113423*^9}, {
   3.903710492251489*^9, 3.903710494171282*^9}, {3.903710532838067*^9, 
   3.9037105578595686`*^9}, {3.9037105941769485`*^9, 3.903710656587475*^9}, {
   3.903710703287961*^9, 3.903710787202149*^9}, {3.903710830833022*^9, 
   3.90371097286856*^9}, {3.9037118073187575`*^9, 3.903711830251164*^9}, {
   3.903712519797754*^9, 3.9037125202464137`*^9}, {3.903712590022724*^9, 
   3.903712669073572*^9}, {3.903712804384085*^9, 3.903712807490596*^9}, {
   3.9037197386198025`*^9, 3.903719741955517*^9}, {3.9038905956628914`*^9, 
   3.9038906116934423`*^9}, {3.9038932950007358`*^9, 
   3.9038933309309044`*^9}, {3.9038939361046124`*^9, 3.903893952667847*^9}, {
   3.9040575119764867`*^9, 3.904057592271948*^9}, {3.904057838543812*^9, 
   3.9040578425946937`*^9}, {3.9048111295239396`*^9, 3.9048111366151*^9}, {
   3.904811742583556*^9, 3.9048117427610893`*^9}, {3.90561990473059*^9, 
   3.9056199241457167`*^9}, {3.913978227884476*^9, 3.913978236861379*^9}, {
   3.9154371863706703`*^9, 3.9154371864254*^9}, 3.916155409116582*^9, {
   3.9161554417047253`*^9, 3.916155467984451*^9}, {3.9161595100643635`*^9, 
   3.916159510358947*^9}, {3.916160848196581*^9, 3.916160851839265*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[234]:=",ExpressionUUID->"f6e36b4a-78e2-4a93-b131-229beee2f190"]
}, Closed]],

Cell[CellGroupData[{

Cell["Squared matrix elements", "Subsection",
 CellChangeTimes->{{3.9037089202194157`*^9, 3.903708930067422*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"a8d77950-e6b3-40bb-8c1e-7a713b7a62fe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPsel", "=", "\"\<ALP-gluon\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MatrixElementsALPgluonList", "[", "ma_", "]"}], "=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<phenomenology\>\"",
         ",", "LLPsel", ",", 
        "\"\<decay \
widths/Matrix-elements-squared-model-Gluon-scale-1000.-GeV.m\>\""}], "}"}], 
      "]"}], ",", "\"\<MX\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Msquared3BodyLLP", "[", 
      RowBox[{"LLPsel", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"MatrixElementsALPgluonList", "[", "ma", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "E1_", ",", "E3_", ",", 
       "mLLP_"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"MatrixElementsALPgluonList", "[", "mLLP", "]"}], "[", 
       RowBox[{"[", "3", "]"}], "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", 
       RowBox[{
        RowBox[{"MatrixElementsALPgluonList", "[", "ma", "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", "1"}], "}"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.903712811374471*^9, 3.903712854088001*^9}, {
   3.9037129020451794`*^9, 3.903712903886897*^9}, {3.903716359631694*^9, 
   3.903716450747261*^9}, {3.903719991648651*^9, 3.903719993789119*^9}, {
   3.9037200601850424`*^9, 3.903720062251648*^9}, {3.903720199487424*^9, 
   3.9037202036425085`*^9}, {3.9038934131609106`*^9, 3.903893419809375*^9}, {
   3.903893568949911*^9, 3.903893615450827*^9}, {3.9038939754298515`*^9, 
   3.9038939819446187`*^9}, {3.904057602963617*^9, 3.904057618951599*^9}, {
   3.9044948684480925`*^9, 3.904494877547179*^9}, {3.9048878256809883`*^9, 
   3.904887852761117*^9}, 3.913978251341043*^9, {3.9154367349370403`*^9, 
   3.915436742450658*^9}, {3.9154371864273944`*^9, 3.915437186439887*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[247]:=",ExpressionUUID->"15d703f0-9e4f-42aa-9a82-6d76df0055b2"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["ALPs coupled to fermions", "Section",
 CellChangeTimes->{{3.890548205242524*^9, 3.890548233837968*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"fe9117b4-795b-46d1-b007-e1256f913147"],

Cell[CellGroupData[{

Cell["\<\
List of decay processes and sets of decay products for them, branching ratios\
\>", "Subsection",
 CellChangeTimes->{{3.8905482184733267`*^9, 3.890548219964122*^9}, {
  3.9038857318470097`*^9, 3.9038857567964077`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"22b626f4-2eac-4626-a398-c1e830fc3980"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPsel", "=", "\"\<ALP-fermion\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BrRatiosALPfermionData", "[", "ma_", "]"}], "=", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], ",", 
         "\"\<phenomenology\>\"", ",", "LLPsel", ",", 
         "\"\<decay widths/Br-ratios-SensCalc-model-Fermion \
universal-scale-1000.-GeV.m\>\""}], "}"}], "]"}], ",", "\"\<MX\>\""}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "all", " ", "representative", " ", "processes"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ProcessesList", "[", 
     RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"BrRatiosALPfermionData", "[", "ma", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{"\"\<Jets\>\"", "->", "\"\<Jets-GG\>\""}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "mass", " ", "above", " ", "which", " ", "all", " ", 
    "hadronic", " ", "decays", " ", "are", " ", "approximated", " ", "by", 
    " ", "decays", " ", "into", " ", "jets"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"procsel", "=", 
     RowBox[{
      RowBox[{"ProcessesList", "[", 
       RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListBrRatiosTemp", "[", 
      RowBox[{"LLPsel", ",", "mLLP_", ",", "procsel"}], "]"}], "=", 
     RowBox[{
      RowBox[{"ListBrRatios", "[", 
       RowBox[{"LLPsel", ",", "mLLP_", ",", "procsel"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"BrRatiosALPfermionData", "[", "mLLP", "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], "[", 
       RowBox[{"[", "i", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListDecayProducts", "[", 
      RowBox[{"LLPsel", ",", "procsel"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"BrRatiosALPfermionData", "[", "ma", "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"JetsPresence", "[", 
      RowBox[{"LLPsel", ",", "procsel"}], "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<Jets-ss\>\"", ",", "\"\<Jets-cc\>\"", ",", 
            "\"\<Jets-GG\>\""}], "}"}], ",", "procsel"}], "]"}], "==", 
        "True"}], ",", "\"\<Yes\>\"", ",", "\"\<No\>\""}], "]"}]}]}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", 
      RowBox[{
       RowBox[{"BrRatiosALPfermionData", "[", "mLLP", "]"}], "[", 
       RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", "1"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProcessesList", "[", 
    RowBox[{"LLPsel", ",", "\"\<False\>\""}], "]"}], "=", 
   RowBox[{"procListnoecal", "[", "LLPsel", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<All processes with at least two charged/neutral particles:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ProcessesList", "[", 
  RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<All processes with at least two charged particles:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ProcessesList", "[", 
  RowBox[{"LLPsel", ",", "\"\<False\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Processes with jets:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Select", "[", 
  RowBox[{
   RowBox[{"ProcessesList", "[", 
    RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"JetsPresence", "[", 
      RowBox[{"LLPsel", ",", "#"}], "]"}], "==", "\"\<Yes\>\""}], "&"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"LogLogPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Evaluate", "[", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"ListBrRatiosTemp", "[", 
        RowBox[{"LLPsel", ",", "mN", ",", "pr"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"pr", ",", 
         RowBox[{"ProcessesList", "[", 
          RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}]}], "}"}]}], "]"}], 
     "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"mN", ",", "0.05", ",", "4.5"}], "}"}], ",", 
   RowBox[{"PlotRange", "->", "All"}]}], "]"}]}], "Input",
 CellChangeTimes->{
  3.890550139666936*^9, {3.890550225678339*^9, 3.8905502571105175`*^9}, {
   3.9037089371677756`*^9, 3.9037089439815345`*^9}, {3.903708979372821*^9, 
   3.903709071842332*^9}, {3.903709123667943*^9, 3.903709226373082*^9}, {
   3.903709360274336*^9, 3.903709364947524*^9}, {3.903709483835615*^9, 
   3.9037096654511623`*^9}, {3.9037097177970533`*^9, 
   3.9037098360539303`*^9}, {3.9037103532952595`*^9, 
   3.9037103632426353`*^9}, {3.903710395751079*^9, 3.903710408113423*^9}, {
   3.903710492251489*^9, 3.903710494171282*^9}, {3.903710532838067*^9, 
   3.9037105578595686`*^9}, {3.9037105941769485`*^9, 3.903710656587475*^9}, {
   3.903710703287961*^9, 3.903710787202149*^9}, {3.903710830833022*^9, 
   3.90371097286856*^9}, {3.9037118073187575`*^9, 3.903711830251164*^9}, {
   3.903712519797754*^9, 3.9037125202464137`*^9}, {3.903712590022724*^9, 
   3.903712669073572*^9}, {3.903712804384085*^9, 3.903712807490596*^9}, {
   3.9037197386198025`*^9, 3.903719741955517*^9}, {3.9038905956628914`*^9, 
   3.9038906116934423`*^9}, 3.9040576433552656`*^9, {3.9040576840438805`*^9, 
   3.9040576904235263`*^9}, {3.9040578262073174`*^9, 
   3.9040578322293296`*^9}, {3.9048110831533213`*^9, 3.904811147309662*^9}, {
   3.9056199398047037`*^9, 3.9056199429410725`*^9}, {3.9139782591992173`*^9, 
   3.913978267591053*^9}, {3.915437186448371*^9, 3.915437186498675*^9}, 
   3.9161554091235695`*^9, {3.916155441708729*^9, 3.9161554679911823`*^9}, {
   3.916160829408192*^9, 3.9161608322763567`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[250]:=",ExpressionUUID->"459f62a8-1a49-4970-b885-3c2c821d7e75"],

Cell[CellGroupData[{

Cell["Old description from 1901.09966 - no hadronic decays", "Subsubsection",
 CellChangeTimes->{{3.9052304975227523`*^9, 3.9052305226734266`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"fe6e38c6-7109-4245-97d4-d07f1457aa5a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"LLPsel", "=", "\"\<ALP-fermion-no-hadronic-decays\>\""}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "all", " ", "representative", " ", "processes"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ProcessesList", "[", 
     RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "=", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"ProcessesList", "[", 
       RowBox[{"\"\<ALP-fermion\>\"", ",", "\"\<True\>\""}], "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<2e\>\"", ",", "\"\<2\[Mu]\>\"", ",", "\"\<2\[Tau]\>\""}], 
           "}"}], ",", "#"}], "]"}], "==", "True"}], "&"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "mass", " ", "above", " ", "which", " ", "all", " ", 
    "hadronic", " ", "decays", " ", "are", " ", "approximated", " ", "by", 
    " ", "decays", " ", "into", " ", "jets"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"procsel", "=", 
     RowBox[{
      RowBox[{"ProcessesList", "[", 
       RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListBrRatiosTemp", "[", 
      RowBox[{"LLPsel", ",", "mLLP_", ",", "procsel"}], "]"}], "=", 
     RowBox[{
      RowBox[{"ListBrRatios", "[", 
       RowBox[{"LLPsel", ",", "mLLP_", ",", "procsel"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"ListBrRatios", "[", 
         RowBox[{"\"\<ALP-fermion\>\"", ",", "mLLP", ",", "procsel"}], "]"}], 
        "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ListBrRatios", "[", 
           RowBox[{"\"\<ALP-fermion\>\"", ",", "mLLP", ",", "\"\<2e\>\""}], 
           "]"}], "+", 
          RowBox[{"ListBrRatios", "[", 
           RowBox[{
           "\"\<ALP-fermion\>\"", ",", "mLLP", ",", "\"\<2\[Mu]\>\""}], "]"}],
           "+", 
          RowBox[{"ListBrRatios", "[", 
           RowBox[{
           "\"\<ALP-fermion\>\"", ",", "mLLP", ",", "\"\<2\[Tau]\>\""}], 
           "]"}]}], ")"}]}], "//", "Simplify"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListDecayProducts", "[", 
      RowBox[{"LLPsel", ",", "procsel"}], "]"}], "=", 
     RowBox[{"ListDecayProducts", "[", 
      RowBox[{"\"\<ALP-fermion\>\"", ",", "procsel"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"JetsPresence", "[", 
      RowBox[{"LLPsel", ",", "procsel"}], "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"procsel", "==", "\"\<Jets-GG\>\""}], ",", "\"\<Yes\>\"", ",", 
       "\"\<No\>\""}], "]"}]}]}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", 
      RowBox[{"ProcessesList", "[", 
       RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "]"}], ",", "1"}], 
    "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProcessesList", "[", 
    RowBox[{"LLPsel", ",", "\"\<False\>\""}], "]"}], "=", 
   RowBox[{"procListnoecal", "[", "LLPsel", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<All processes with at least two charged/neutral particles:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ProcessesList", "[", 
  RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<All processes with at least two charged particles:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ProcessesList", "[", 
  RowBox[{"LLPsel", ",", "\"\<False\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Processes with jets:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Select", "[", 
  RowBox[{
   RowBox[{"ProcessesList", "[", 
    RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"JetsPresence", "[", 
      RowBox[{"LLPsel", ",", "#"}], "]"}], "==", "\"\<Yes\>\""}], "&"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"LogLogPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Evaluate", "[", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"ListBrRatiosTemp", "[", 
        RowBox[{"LLPsel", ",", "mN", ",", "pr"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"pr", ",", 
         RowBox[{"ProcessesList", "[", 
          RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}]}], "}"}]}], "]"}], 
     "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"mN", ",", "0.05", ",", "4.5"}], "}"}], ",", 
   RowBox[{"PlotRange", "->", "All"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.905230554667918*^9, 3.905230705335285*^9}, {
  3.9154371865075693`*^9, 3.9154371865677524`*^9}, {3.9161554091604137`*^9, 
  3.916155409163413*^9}, {3.916155441714713*^9, 3.916155467997715*^9}, {
  3.916160817551086*^9, 3.9161608209866295`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[262]:=",ExpressionUUID->"53c4c9a6-438c-4944-9fa9-cdad5017a9d0"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Squared matrix elements", "Subsection",
 CellChangeTimes->{{3.9037089202194157`*^9, 3.903708930067422*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"054e6167-fe2d-46e7-b18a-d2c0e8b4862d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPsel", "=", "\"\<ALP-fermion\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MatrixElementsALPfermionList", "[", "ma_", "]"}], "=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<phenomenology\>\"",
         ",", "LLPsel", ",", 
        "\"\<decay widths/Matrix-elements-squared-model-Fermion \
universal-scale-1000.-GeV.m\>\""}], "}"}], "]"}], ",", "\"\<MX\>\""}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Msquared3BodyLLP", "[", 
      RowBox[{"LLPsel", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"MatrixElementsALPfermionList", "[", "ma", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "E1_", ",", "E3_", ",", 
       "mLLP_"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"MatrixElementsALPfermionList", "[", "mLLP", "]"}], "[", 
       RowBox[{"[", "3", "]"}], "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", 
       RowBox[{
        RowBox[{"MatrixElementsALPfermionList", "[", "ma", "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", "1"}], "}"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.903712811374471*^9, 3.903712854088001*^9}, {
   3.9037129020451794`*^9, 3.903712903886897*^9}, {3.903716359631694*^9, 
   3.903716450747261*^9}, {3.903719991648651*^9, 3.903719993789119*^9}, {
   3.9037200601850424`*^9, 3.903720062251648*^9}, {3.903720199487424*^9, 
   3.9037202036425085`*^9}, {3.903894000331823*^9, 3.903894025882821*^9}, {
   3.904057647477174*^9, 3.9040576558029976`*^9}, {3.9044949053322973`*^9, 
   3.9044949096329985`*^9}, {3.9048876854779997`*^9, 3.904887736205*^9}, {
   3.904887774986719*^9, 3.9048877780142303`*^9}, 3.9139782809258156`*^9, {
   3.9154367524180183`*^9, 3.915436756670272*^9}, {3.915437186569745*^9, 
   3.915437186580812*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[273]:=",ExpressionUUID->"45927e91-2484-4aa4-ae94-c5dc93a90cc5"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["B-L mediator", "Section",
 CellChangeTimes->{{3.8940915032848034`*^9, 3.8940915038725634`*^9}, {
  3.894094143763838*^9, 3.8940941450360746`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"f5888daf-dc6d-4b79-8340-d2eb4d2eef5e"],

Cell[CellGroupData[{

Cell["\<\
List of decay processes and sets of decay products for them, branching ratios\
\>", "Subsection",
 CellChangeTimes->{{3.8940915418624434`*^9, 3.8940915428134766`*^9}, 
   3.9038905421771708`*^9},
 CellTags->
  "Evaluation",ExpressionUUID->"67e077de-a854-4ed9-bb6e-0f56d558757e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPsel", "=", "\"\<B-L\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BrRatiosBLdata", "[", "mV_", "]"}], "=", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], ",", 
         "\"\<phenomenology\>\"", ",", "LLPsel", ",", 
         "\"\<decay widths/BrRatiosBL.m\>\""}], "}"}], "]"}], ",", 
      "\"\<MX\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "all", " ", "representative", " ", "processes"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ProcessesList", "[", 
     RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "=", 
    RowBox[{
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"BrRatiosBLdata", "[", "ma", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"-", "1"}]}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{"\"\<Jets\>\"", "->", "\"\<Jets-light\>\""}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "mass", " ", "above", " ", "which", " ", "all", " ", 
    "hadronic", " ", "decays", " ", "are", " ", "approximated", " ", "by", 
    " ", "decays", " ", "into", " ", "jets"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"procsel", "=", 
     RowBox[{
      RowBox[{"ProcessesList", "[", 
       RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListBrRatiosTemp", "[", 
      RowBox[{"LLPsel", ",", "mLLP_", ",", "procsel"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"BrRatiosBLdata", "[", "mLLP", "]"}], "[", 
       RowBox[{"[", "3", "]"}], "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListDecayProducts", "[", 
      RowBox[{"LLPsel", ",", "procsel"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"BrRatiosBLdata", "[", "ma", "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"JetsPresence", "[", 
      RowBox[{"LLPsel", ",", "procsel"}], "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<Jets-light\>\"", ",", "\"\<Jets-cc\>\""}], "}"}], ",",
           "procsel"}], "]"}], "==", "True"}], ",", "\"\<Yes\>\"", ",", 
       "\"\<No\>\""}], "]"}]}]}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{
        RowBox[{"BrRatiosBLdata", "[", "mLLP", "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], "]"}], "-", "1"}], ",", "1"}], 
    "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"ListBrRatios", "[", 
     RowBox[{"LLPsel", ",", "mLLP_", ",", "proc"}], "]"}], "=", 
    FractionBox[
     RowBox[{"ListBrRatiosTemp", "[", 
      RowBox[{"LLPsel", ",", "mLLP", ",", "proc"}], "]"}], 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"ListBrRatiosTemp", "[", 
         RowBox[{"LLPsel", ",", "mLLP", ",", "pr"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"pr", ",", 
          RowBox[{"ProcessesList", "[", 
           RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}]}], "}"}]}], "]"}], 
      "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"BrRatiosBLdata", "[", "mV", "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{"mV", "->", "mLLP"}], "}"}]}], ")"}]}]]}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"proc", ",", 
     RowBox[{"ProcessesList", "[", 
      RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProcessesList", "[", 
    RowBox[{"LLPsel", ",", "\"\<False\>\""}], "]"}], "=", 
   RowBox[{"procListnoecal", "[", "LLPsel", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<All processes with at least two charged/neutral particles:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ProcessesList", "[", 
  RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<All processes with at least two charged particles:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ProcessesList", "[", 
  RowBox[{"LLPsel", ",", "\"\<False\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Processes with jets:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Select", "[", 
  RowBox[{
   RowBox[{"ProcessesList", "[", 
    RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"JetsPresence", "[", 
      RowBox[{"LLPsel", ",", "#"}], "]"}], "==", "\"\<Yes\>\""}], "&"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"LogLogPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Evaluate", "[", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"ListBrRatios", "[", 
        RowBox[{"LLPsel", ",", "mN", ",", "pr"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"pr", ",", 
         RowBox[{"ProcessesList", "[", 
          RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}]}], "}"}]}], "]"}], 
     "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"mN", ",", "0.05", ",", "4.5"}], "}"}], ",", 
   RowBox[{"PlotRange", "->", "All"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.904818152150199*^9, 3.904818224121564*^9}, {
   3.9048183185937552`*^9, 3.9048183227656956`*^9}, {3.9048185128357043`*^9, 
   3.9048185768577943`*^9}, {3.904818695977891*^9, 3.9048187098730288`*^9}, {
   3.9048356957237616`*^9, 3.9048356961609097`*^9}, {3.9139782870665865`*^9, 
   3.91397829408912*^9}, {3.9154371865907593`*^9, 3.9154371866637974`*^9}, 
   3.9161554091694803`*^9, {3.916155441729222*^9, 3.916155468007345*^9}, {
   3.916160809036352*^9, 3.9161608110256643`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[276]:=",ExpressionUUID->"b6a47b0c-812e-4eb8-9fec-6594ccfcbf4b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Squared matrix elements", "Subsection",
 CellChangeTimes->{{3.8940915418624434`*^9, 3.8940915528966784`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"d3d1a7f3-957f-45e0-b845-bf4c768d7134"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"B", "->"}], TraditionalForm]],ExpressionUUID->
  "0d3e7f48-51d9-4a2c-a419-43037a9cd382"],
 "3\[Pi] (following https://arxiv.org/pdf/1404.4370.pdf and Ref. therein)"
}], "Subsubsection",
 CellChangeTimes->{{3.8940915740826826`*^9, 3.8940915813116074`*^9}, {
  3.8940916342346153`*^9, 3.8940916509538717`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"9166f2c9-b344-47cc-b044-43f89b5eada0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Propagator\[Rho]", "[", 
    RowBox[{"p_", ",", "m\[Rho]_", ",", "\[Mu]_", ",", "\[Nu]_"}], "]"}], "=", 
   FractionBox[
    RowBox[{
     RowBox[{"-", 
      RowBox[{"MT", "[", 
       RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}]}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"FV", "[", 
        RowBox[{"p", ",", "\[Mu]"}], "]"}], 
       RowBox[{"FV", "[", 
        RowBox[{"p", ",", "\[Nu]"}], "]"}]}], 
      SuperscriptBox["m\[Rho]", "2"]]}], 
    RowBox[{
     RowBox[{"ScalarProduct", "[", 
      RowBox[{"p", ",", "p"}], "]"}], "-", 
     SuperscriptBox["m\[Rho]", "2"]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p\[Pi]0", "=", 
    RowBox[{"p", "-", "p\[Pi]plus", "-", "p\[Pi]minus"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "B\[Rho]0", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MBLTo3\[Pi]1", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"LeviCivita", "[", 
        RowBox[{"\[Mu]", ",", "\[Nu]", ",", "\[Rho]", ",", "\[Sigma]"}], 
        "]"}], "*", 
       RowBox[{"FV", "[", 
        RowBox[{"p", ",", "\[Mu]"}], "]"}], "*", 
       RowBox[{"PolarizationVector", "[", 
        RowBox[{"p", ",", "\[Nu]"}], "]"}], "*", 
       RowBox[{"FV", "[", 
        RowBox[{
         RowBox[{"p", "-", "p\[Pi]0"}], ",", "\[Rho]"}], "]"}], "*", 
       RowBox[{"Propagator\[Rho]", "[", 
        RowBox[{
         RowBox[{"p", "-", "p\[Pi]0"}], ",", "m\[Rho]", ",", "\[Sigma]", ",", 
         "\[Delta]"}], "]"}], "*", 
       RowBox[{"FV", "[", 
        RowBox[{
         RowBox[{"p\[Pi]plus", "-", "p\[Pi]minus"}], ",", "\[Delta]"}], 
        "]"}]}], "//", "Contract"}], "//", "Simplify"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"B\[Rho]", "+"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MBLTo3\[Pi]2", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"LeviCivita", "[", 
        RowBox[{"\[Mu]", ",", "\[Nu]", ",", "\[Rho]", ",", "\[Sigma]"}], 
        "]"}], "*", 
       RowBox[{"FV", "[", 
        RowBox[{"p", ",", "\[Mu]"}], "]"}], "*", 
       RowBox[{"PolarizationVector", "[", 
        RowBox[{"p", ",", "\[Nu]"}], "]"}], "*", 
       RowBox[{"FV", "[", 
        RowBox[{
         RowBox[{"p", "-", "p\[Pi]minus"}], ",", "\[Rho]"}], "]"}], "*", 
       RowBox[{"Propagator\[Rho]", "[", 
        RowBox[{
         RowBox[{"p", "-", "p\[Pi]minus"}], ",", "m\[Rho]", ",", "\[Sigma]", 
         ",", "\[Delta]"}], "]"}], "*", 
       RowBox[{"FV", "[", 
        RowBox[{
         RowBox[{"p\[Pi]plus", "-", "p\[Pi]0"}], ",", "\[Delta]"}], "]"}]}], "//",
       "Contract"}], "//", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"B\[Rho]", "-"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MBLTo3\[Pi]3", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"LeviCivita", "[", 
       RowBox[{"\[Mu]", ",", "\[Nu]", ",", "\[Rho]", ",", "\[Sigma]"}], "]"}],
       "*", 
      RowBox[{"FV", "[", 
       RowBox[{"p", ",", "\[Mu]"}], "]"}], "*", 
      RowBox[{"PolarizationVector", "[", 
       RowBox[{"p", ",", "\[Nu]"}], "]"}], "*", 
      RowBox[{"FV", "[", 
       RowBox[{
        RowBox[{"p", "-", "p\[Pi]plus"}], ",", "\[Rho]"}], "]"}], "*", 
      RowBox[{"Propagator\[Rho]", "[", 
       RowBox[{
        RowBox[{"p", "-", "p\[Pi]plus"}], ",", "m\[Rho]", ",", "\[Sigma]", 
        ",", "\[Delta]"}], "]"}], "*", 
      RowBox[{"FV", "[", 
       RowBox[{
        RowBox[{"p\[Pi]0", "-", "p\[Pi]minus"}], ",", "\[Delta]"}], "]"}]}], "//",
      "Contract"}], "//", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MBLTo3\[Pi]", "=", 
   RowBox[{"MBLTo3\[Pi]1", "+", "MBLTo3\[Pi]2", "+", "MBLTo3\[Pi]3"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MBLTo3\[Pi]Star", "=", 
   RowBox[{"ComplexConjugate", "[", "MBLTo3\[Pi]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MBLTo3\[Pi]SquaredTemp", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DoPolarizationSums", "[", 
        RowBox[{
         RowBox[{"MBLTo3\[Pi]", " ", "MBLTo3\[Pi]Star"}], ",", "p"}], "]"}], "//",
        "Contract"}], ")"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"ScalarProduct", "[", 
         RowBox[{"p\[Pi]minus", ",", "p\[Pi]minus"}], "]"}], "->", 
        SuperscriptBox["m\[Pi]", "2"]}], ",", 
       RowBox[{
        RowBox[{"ScalarProduct", "[", 
         RowBox[{"p\[Pi]plus", ",", "p\[Pi]plus"}], "]"}], "->", 
        SuperscriptBox["m\[Pi]", "2"]}], ",", 
       RowBox[{
        RowBox[{"ScalarProduct", "[", 
         RowBox[{"p\[Pi]0", ",", "p\[Pi]0"}], "]"}], "->", 
        SuperscriptBox["m\[Pi]", "2"]}], ",", 
       RowBox[{
        RowBox[{"ScalarProduct", "[", 
         RowBox[{"p", ",", "p"}], "]"}], "->", 
        SuperscriptBox["m", "2"]}]}], "}"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"p\[Pi]0", "//", "Clear"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Msquared3BodyLLP", "[", 
    RowBox[{
    "\"\<B-L\>\"", ",", 
     "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \
\(+\)]\)\!\(\*SuperscriptBox[\(\[Pi]\), \
\(-\)]\)\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", "E1_", ",", "E3_",
      ",", "mLLP_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"MBLTo3\[Pi]SquaredTemp", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ScalarProduct", "[", 
            RowBox[{"p\[Pi]plus", ",", "p\[Pi]minus"}], "]"}], "\[Rule]", 
           "ProductK1K2energy"}], ",", 
          RowBox[{
           RowBox[{"ScalarProduct", "[", 
            RowBox[{"p", ",", "p\[Pi]plus"}], "]"}], "->", 
           "ProductKK1energy"}], ",", 
          RowBox[{
           RowBox[{"ScalarProduct", "[", 
            RowBox[{"p", ",", "p\[Pi]minus"}], "]"}], "->", 
           "ProductKK2energy"}]}], "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"m1", "\[Rule]", "m\[Pi]"}], ",", 
         RowBox[{"m2", "\[Rule]", "m\[Pi]"}], ",", 
         RowBox[{"m3", "\[Rule]", "m\[Pi]"}], ",", 
         RowBox[{"mB", "->", "mLLP"}], ",", 
         RowBox[{"m", "->", "mLLP"}]}], "}"}]}], "//", "Simplify"}], ")"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"m\[Pi]", "->", 
       RowBox[{"ParamProductMass", "[", "211", "]"}]}], ",", 
      RowBox[{"m\[Rho]", "->", 
       RowBox[{"ParamProductMass", "[", "113", "]"}]}]}], "}"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8940919560021267`*^9, 3.894091967986726*^9}, {
   3.894092020347856*^9, 3.8940920586685576`*^9}, {3.894092366987154*^9, 
   3.89409247084031*^9}, {3.894092520737632*^9, 3.8940925327903147`*^9}, {
   3.8940926060688405`*^9, 3.8940926841271296`*^9}, {3.894092792092761*^9, 
   3.894092832345261*^9}, {3.89409286497683*^9, 3.894093095120883*^9}, {
   3.894093131235201*^9, 3.8940931337326536`*^9}, {3.8940931818741803`*^9, 
   3.894093227616976*^9}, {3.8940932779385824`*^9, 3.8940933003846874`*^9}, {
   3.8940933499419413`*^9, 3.8940934112020187`*^9}, {3.8940935005050535`*^9, 
   3.894093522349084*^9}, {3.8940940180350676`*^9, 3.8940941151448927`*^9}, {
   3.894094154196066*^9, 3.894094233637742*^9}, 3.8940942911447315`*^9, {
   3.8940984266733065`*^9, 3.894098441044433*^9}, {3.90388854215014*^9, 
   3.9038886209460125`*^9}, {3.9038888027835946`*^9, 
   3.9038888056228976`*^9}, {3.9048117781500635`*^9, 
   3.9048117851329055`*^9}, {3.9154367694089346`*^9, 3.915436787189971*^9}, {
   3.9154371866667895`*^9, 3.915437186673362*^9}, {3.9154380481351585`*^9, 
   3.9154380849936523`*^9}, {3.915681545721033*^9, 3.915681627989109*^9}, {
   3.9157706440394297`*^9, 3.915770662653706*^9}, {3.9161556733231196`*^9, 
   3.9161556733256245`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[289]:=",ExpressionUUID->"15a1cbfa-206b-4f17-9cfd-bef8df901f4d"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"B", "-", 
    RowBox[{"3", 
     SubscriptBox["L", "\[Mu]"]}]}], TraditionalForm]],ExpressionUUID->
  "99c7fc64-df88-400b-8d82-86b41990dd0c"],
 " mediator"
}], "Section",
 CellChangeTimes->{{3.8940915032848034`*^9, 3.8940915038725634`*^9}, {
  3.894094143763838*^9, 3.8940941450360746`*^9}, {3.8963237761732655`*^9, 
  3.896323777189696*^9}, {3.903967717716303*^9, 3.9039677185315485`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"28cb1a40-2b68-4b15-9d83-e0666ac7f19c"],

Cell[CellGroupData[{

Cell["\<\
List of decay processes and sets of decay products for them, branching ratios\
\>", "Subsection",
 CellChangeTimes->{{3.8940915418624434`*^9, 3.8940915428134766`*^9}, 
   3.9038905453322144`*^9},
 CellTags->
  "Evaluation",ExpressionUUID->"f9bb6349-e588-4163-9585-0d29bc8465e6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPsel", "=", "\"\<B-3Lmu\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BrRatiosBLdata", "[", "mV_", "]"}], "=", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], ",", 
         "\"\<phenomenology\>\"", ",", "LLPsel", ",", 
         "\"\<decay widths/BrRatiosBL.m\>\""}], "}"}], "]"}], ",", 
      "\"\<MX\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "all", " ", "representative", " ", "processes"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ProcessesList", "[", 
     RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "=", 
    RowBox[{
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"BrRatiosBLdata", "[", "ma", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"-", "1"}]}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{"\"\<Jets\>\"", "->", "\"\<Jets-light\>\""}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "mass", " ", "above", " ", "which", " ", "all", " ", 
    "hadronic", " ", "decays", " ", "are", " ", "approximated", " ", "by", 
    " ", "decays", " ", "into", " ", "jets"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"procsel", "=", 
     RowBox[{
      RowBox[{"ProcessesList", "[", 
       RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListBrRatiosTemp", "[", 
      RowBox[{"LLPsel", ",", "mLLP_", ",", "procsel"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"BrRatiosBLdata", "[", "mLLP", "]"}], "[", 
       RowBox[{"[", "3", "]"}], "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListDecayProducts", "[", 
      RowBox[{"LLPsel", ",", "procsel"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"BrRatiosBLdata", "[", "ma", "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"JetsPresence", "[", 
      RowBox[{"LLPsel", ",", "procsel"}], "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<Jets-light\>\"", ",", "\"\<Jets-cc\>\""}], "}"}], ",",
           "procsel"}], "]"}], "==", "True"}], ",", "\"\<Yes\>\"", ",", 
       "\"\<No\>\""}], "]"}]}]}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{
        RowBox[{"BrRatiosBLdata", "[", "mLLP", "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], "]"}], "-", "1"}], ",", "1"}], 
    "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"ListBrRatios", "[", 
     RowBox[{"LLPsel", ",", "mLLP_", ",", "proc"}], "]"}], "=", 
    FractionBox[
     RowBox[{"ListBrRatiosTemp", "[", 
      RowBox[{"LLPsel", ",", "mLLP", ",", "proc"}], "]"}], 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"ListBrRatiosTemp", "[", 
         RowBox[{"LLPsel", ",", "mLLP", ",", "pr"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"pr", ",", 
          RowBox[{"ProcessesList", "[", 
           RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}]}], "}"}]}], "]"}], 
      "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"BrRatiosBLdata", "[", "mV", "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{"mV", "->", "mLLP"}], "}"}]}], ")"}]}]]}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"proc", ",", 
     RowBox[{"ProcessesList", "[", 
      RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProcessesList", "[", 
    RowBox[{"LLPsel", ",", "\"\<False\>\""}], "]"}], "=", 
   RowBox[{"procListnoecal", "[", "LLPsel", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<All processes with at least two charged/neutral particles:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ProcessesList", "[", 
  RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<All processes with at least two charged particles:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ProcessesList", "[", 
  RowBox[{"LLPsel", ",", "\"\<False\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Processes with jets:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Select", "[", 
  RowBox[{
   RowBox[{"ProcessesList", "[", 
    RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"JetsPresence", "[", 
      RowBox[{"LLPsel", ",", "#"}], "]"}], "==", "\"\<Yes\>\""}], "&"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"LogLogPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Evaluate", "[", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"ListBrRatios", "[", 
        RowBox[{"LLPsel", ",", "mN", ",", "pr"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"pr", ",", 
         RowBox[{"ProcessesList", "[", 
          RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}]}], "}"}]}], "]"}], 
     "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"mN", ",", "0.05", ",", "4.5"}], "}"}], ",", 
   RowBox[{"PlotRange", "->", "All"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8940979068121023`*^9, 3.8940980607920666`*^9}, {
   3.896323779777932*^9, 3.8963238314766684`*^9}, {3.896323884059519*^9, 
   3.896323898137414*^9}, {3.896323931787507*^9, 3.896323936873105*^9}, 
   3.903888761062112*^9, {3.903897790425865*^9, 3.9038977967681828`*^9}, {
   3.9040578920691147`*^9, 3.9040579410114145`*^9}, 3.904818337816102*^9, {
   3.9048185872406435`*^9, 3.904818599011217*^9}, {3.9048186589162407`*^9, 
   3.9048186850137186`*^9}, {3.904818740170369*^9, 3.9048187485116987`*^9}, {
   3.9048357119315042`*^9, 3.904835712531798*^9}, {3.9139783041037264`*^9, 
   3.913978308352779*^9}, {3.9154371866814733`*^9, 3.9154371867558403`*^9}, 
   3.916155409174467*^9, {3.9161554417363005`*^9, 3.9161554680164456`*^9}, {
   3.9161607938875084`*^9, 3.916160796088403*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[299]:=",ExpressionUUID->"0fe4e2f4-7774-4aa1-b1b2-b44abd9e6132"]
}, Closed]],

Cell[CellGroupData[{

Cell["Matrix elements", "Subsection",
 CellChangeTimes->{{3.903888776623946*^9, 3.903888778472537*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"e3338e34-6461-4f4e-81a2-53e1a8470b12"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPsel", "=", "\"\<B-3Lmu\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Msquared3BodyLLP", "[", 
    RowBox[{
    "LLPsel", ",", 
     "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \
\(+\)]\)\!\(\*SuperscriptBox[\(\[Pi]\), \
\(-\)]\)\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", "E1_", ",", "E3_",
      ",", "mLLP_"}], "]"}], "=", 
   RowBox[{"Msquared3BodyLLP", "[", 
    RowBox[{
    "\"\<B-L\>\"", ",", 
     "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \
\(+\)]\)\!\(\*SuperscriptBox[\(\[Pi]\), \
\(-\)]\)\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", "E1", ",", "E3", 
     ",", "mLLP"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.903888785563194*^9, 3.9038888312965903`*^9}, {
  3.904818765912978*^9, 3.9048187690922594`*^9}, {3.9048188320723257`*^9, 
  3.9048188326401267`*^9}, {3.913978314045225*^9, 3.9139783530901356`*^9}, {
  3.9154367915322456`*^9, 3.915436797195064*^9}, {3.9154371867578125`*^9, 
  3.915437186770603*^9}, {3.9161606413065014`*^9, 3.9161606418170214`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[312]:=",ExpressionUUID->"55816ca9-af9a-4ccf-9f3d-d838b909efbd"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"B", "-", 
    RowBox[{"3", " ", 
     SubscriptBox["L", "e"]}], "-", 
    SubscriptBox["L", "\[Mu]"], "+", 
    SubscriptBox["L", "\[Tau]"]}], TraditionalForm]],ExpressionUUID->
  "0c09697f-8966-4ca5-ba9b-abd6d7b5bd16"],
 " mediator"
}], "Section",
 CellChangeTimes->{{3.8940915032848034`*^9, 3.8940915038725634`*^9}, {
  3.894094143763838*^9, 3.8940941450360746`*^9}, {3.8963237761732655`*^9, 
  3.896323777189696*^9}, {3.8963239457754703`*^9, 3.8963239490520477`*^9}, {
  3.9039677206678314`*^9, 3.903967739480022*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"06eb5843-69b2-4415-a4d4-3ec60c36d233"],

Cell[CellGroupData[{

Cell["\<\
List of decay processes and sets of decay products for them, branching ratios\
\>", "Subsection",
 CellChangeTimes->{{3.8940915418624434`*^9, 3.8940915428134766`*^9}, 
   3.903890548755209*^9},
 CellTags->
  "Evaluation",ExpressionUUID->"41d4b3d0-e7c2-4f72-9454-72959a435735"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPsel", "=", "\"\<B-3Le-Lmu+Ltau\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BrRatiosBLdata", "[", "mV_", "]"}], "=", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], ",", 
         "\"\<phenomenology\>\"", ",", "LLPsel", ",", 
         "\"\<decay widths/BrRatiosBL.m\>\""}], "}"}], "]"}], ",", 
      "\"\<MX\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "all", " ", "representative", " ", "processes"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ProcessesList", "[", 
     RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "=", 
    RowBox[{"Drop", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"BrRatiosBLdata", "[", "ma", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"-", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "mass", " ", "above", " ", "which", " ", "all", " ", 
    "hadronic", " ", "decays", " ", "are", " ", "approximated", " ", "by", 
    " ", "decays", " ", "into", " ", "jets"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"procsel", "=", 
     RowBox[{
      RowBox[{"ProcessesList", "[", 
       RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListBrRatiosTemp", "[", 
      RowBox[{"LLPsel", ",", "mLLP_", ",", "procsel"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"BrRatiosBLdata", "[", "mLLP", "]"}], "[", 
       RowBox[{"[", "3", "]"}], "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListDecayProducts", "[", 
      RowBox[{"LLPsel", ",", "procsel"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"BrRatiosBLdata", "[", "ma", "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"JetsPresence", "[", 
      RowBox[{"LLPsel", ",", "procsel"}], "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<Jets-light\>\"", ",", "\"\<Jets-cc\>\""}], "}"}], ",",
           "procsel"}], "]"}], "==", "True"}], ",", "\"\<Yes\>\"", ",", 
       "\"\<No\>\""}], "]"}]}]}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{
        RowBox[{"BrRatiosBLdata", "[", "mLLP", "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], "]"}], "-", "1"}], ",", "1"}], 
    "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProcessesList", "[", 
    RowBox[{"LLPsel", ",", "\"\<False\>\""}], "]"}], "=", 
   RowBox[{"procListnoecal", "[", "LLPsel", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"ListBrRatios", "[", 
     RowBox[{"LLPsel", ",", "mLLP_", ",", "proc"}], "]"}], "=", 
    FractionBox[
     RowBox[{"ListBrRatiosTemp", "[", 
      RowBox[{"LLPsel", ",", "mLLP", ",", "proc"}], "]"}], 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"ListBrRatiosTemp", "[", 
         RowBox[{"LLPsel", ",", "mLLP", ",", "pr"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"pr", ",", 
          RowBox[{"ProcessesList", "[", 
           RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}]}], "}"}]}], "]"}], 
      "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"BrRatiosBLdata", "[", "mV", "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{"mV", "->", "mLLP"}], "}"}]}], ")"}]}]]}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"proc", ",", 
     RowBox[{"ProcessesList", "[", 
      RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<All processes with at least two charged/neutral particles:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ProcessesList", "[", 
  RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<All processes with at least two charged particles:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ProcessesList", "[", 
  RowBox[{"LLPsel", ",", "\"\<False\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Processes with jets:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Select", "[", 
  RowBox[{
   RowBox[{"ProcessesList", "[", 
    RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"JetsPresence", "[", 
      RowBox[{"LLPsel", ",", "#"}], "]"}], "==", "\"\<Yes\>\""}], "&"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"LogLogPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Evaluate", "[", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"ListBrRatios", "[", 
        RowBox[{"LLPsel", ",", "mN", ",", "pr"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"pr", ",", 
         RowBox[{"ProcessesList", "[", 
          RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}]}], "}"}]}], "]"}], 
     "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"mN", ",", "0.05", ",", "4.5"}], "}"}], ",", 
   RowBox[{"PlotRange", "->", "All"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8940979068121023`*^9, 3.8940980607920666`*^9}, {
   3.896323779777932*^9, 3.8963238314766684`*^9}, {3.896323884059519*^9, 
   3.896323898137414*^9}, {3.896323931787507*^9, 3.896324011414894*^9}, {
   3.90388885205902*^9, 3.9038888541103616`*^9}, {3.903888896667493*^9, 
   3.903888901314123*^9}, {3.903897753522126*^9, 3.903897766550063*^9}, {
   3.904057965659316*^9, 3.904058031174044*^9}, {3.904818786275302*^9, 
   3.904818808956691*^9}, {3.9048357242031727`*^9, 3.9048357253441176`*^9}, {
   3.91397833550995*^9, 3.9139783436716733`*^9}, {3.915437186779785*^9, 
   3.915437186853894*^9}, 3.9161554091825347`*^9, {3.9161554417422924`*^9, 
   3.91615546802606*^9}, {3.9161607016478777`*^9, 3.9161607148365116`*^9}, {
   3.9161607573055506`*^9, 3.916160759817873*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[314]:=",ExpressionUUID->"223099e3-ae64-43e7-836e-97de94303b69"]
}, Closed]],

Cell[CellGroupData[{

Cell["Matrix elements", "Subsection",
 CellChangeTimes->{{3.903888776623946*^9, 3.903888778472537*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"ac48ae3d-943c-4136-91ba-50511572c0ac"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPsel", "=", "\"\<B-3Le-Lmu+Ltau\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Msquared3BodyLLP", "[", 
    RowBox[{
    "LLPsel", ",", 
     "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \
\(+\)]\)\!\(\*SuperscriptBox[\(\[Pi]\), \
\(-\)]\)\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", "E1_", ",", "E3_",
      ",", "mLLP_"}], "]"}], "=", 
   RowBox[{"Msquared3BodyLLP", "[", 
    RowBox[{
    "\"\<B-L\>\"", ",", 
     "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \
\(+\)]\)\!\(\*SuperscriptBox[\(\[Pi]\), \
\(-\)]\)\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", "E1", ",", "E3", 
     ",", "mLLP"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.903888785563194*^9, 3.9038888312965903`*^9}, {
  3.9038890037304726`*^9, 3.9038890066589017`*^9}, {3.9048188160311966`*^9, 
  3.9048188275450416`*^9}, {3.913978359194762*^9, 3.913978362916895*^9}, {
  3.915436804339191*^9, 3.9154368076432686`*^9}, {3.915437186856016*^9, 
  3.9154371868680983`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[327]:=",ExpressionUUID->"c575eadb-a8ad-4d4a-b2e8-619a739765b0"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"B", "-", 
    SubscriptBox["L", "e"], "-", 
    RowBox[{"3", 
     SubscriptBox["L", "\[Mu]"]}], "+", 
    SubscriptBox["L", "\[Tau]"]}], TraditionalForm]],ExpressionUUID->
  "49b32111-ca14-4dc7-84fa-5c0f23ed4d6b"],
 " mediator"
}], "Section",
 CellChangeTimes->{{3.8940915032848034`*^9, 3.8940915038725634`*^9}, {
  3.894094143763838*^9, 3.8940941450360746`*^9}, {3.8963237761732655`*^9, 
  3.896323777189696*^9}, {3.8963239457754703`*^9, 3.8963239490520477`*^9}, {
  3.8963240688839245`*^9, 3.896324069685693*^9}, {3.9039677431008015`*^9, 
  3.903967753667745*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"9f6a6e02-9a25-4aa8-b6f1-d87380e40126"],

Cell[CellGroupData[{

Cell["\<\
List of decay processes and sets of decay products for them, branching ratios\
\>", "Subsection",
 CellChangeTimes->{{3.8940915418624434`*^9, 3.8940915428134766`*^9}, 
   3.9038905507383904`*^9},
 CellTags->
  "Evaluation",ExpressionUUID->"b7c1f35c-21d3-4197-949b-6cad819cbb9e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPsel", "=", "\"\<B-Le-3Lmu+Ltau\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BrRatiosBLdata", "[", "mV_", "]"}], "=", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], ",", 
         "\"\<phenomenology\>\"", ",", "LLPsel", ",", 
         "\"\<decay widths/BrRatiosBL.m\>\""}], "}"}], "]"}], ",", 
      "\"\<MX\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "all", " ", "representative", " ", "processes"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ProcessesList", "[", 
     RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "=", 
    RowBox[{"Drop", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"BrRatiosBLdata", "[", "ma", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"-", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "mass", " ", "above", " ", "which", " ", "all", " ", 
    "hadronic", " ", "decays", " ", "are", " ", "approximated", " ", "by", 
    " ", "decays", " ", "into", " ", "jets"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"procsel", "=", 
     RowBox[{
      RowBox[{"ProcessesList", "[", 
       RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListBrRatiosTemp", "[", 
      RowBox[{"LLPsel", ",", "mLLP_", ",", "procsel"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"BrRatiosBLdata", "[", "mLLP", "]"}], "[", 
       RowBox[{"[", "3", "]"}], "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListDecayProducts", "[", 
      RowBox[{"LLPsel", ",", "procsel"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"BrRatiosBLdata", "[", "ma", "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"JetsPresence", "[", 
      RowBox[{"LLPsel", ",", "procsel"}], "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<Jets-light\>\"", ",", "\"\<Jets-cc\>\""}], "}"}], ",",
           "procsel"}], "]"}], "==", "True"}], ",", "\"\<Yes\>\"", ",", 
       "\"\<No\>\""}], "]"}]}]}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{
        RowBox[{"BrRatiosBLdata", "[", "mLLP", "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], "]"}], "-", "1"}], ",", "1"}], 
    "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"ListBrRatios", "[", 
     RowBox[{"LLPsel", ",", "mLLP_", ",", "proc"}], "]"}], "=", 
    FractionBox[
     RowBox[{"ListBrRatiosTemp", "[", 
      RowBox[{"LLPsel", ",", "mLLP", ",", "proc"}], "]"}], 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"ListBrRatiosTemp", "[", 
         RowBox[{"LLPsel", ",", "mLLP", ",", "pr"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"pr", ",", 
          RowBox[{"ProcessesList", "[", 
           RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}]}], "}"}]}], "]"}], 
      "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"BrRatiosBLdata", "[", "mV", "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{"mV", "->", "mLLP"}], "}"}]}], ")"}]}]]}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"proc", ",", 
     RowBox[{"ProcessesList", "[", 
      RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProcessesList", "[", 
    RowBox[{"LLPsel", ",", "\"\<False\>\""}], "]"}], "=", 
   RowBox[{"procListnoecal", "[", "LLPsel", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<All processes with at least two charged/neutral particles:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ProcessesList", "[", 
  RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<All processes with at least two charged particles:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ProcessesList", "[", 
  RowBox[{"LLPsel", ",", "\"\<False\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Processes with jets:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Select", "[", 
  RowBox[{
   RowBox[{"ProcessesList", "[", 
    RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"JetsPresence", "[", 
      RowBox[{"LLPsel", ",", "#"}], "]"}], "==", "\"\<Yes\>\""}], "&"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"LogLogPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Evaluate", "[", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"ListBrRatios", "[", 
        RowBox[{"LLPsel", ",", "mN", ",", "pr"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"pr", ",", 
         RowBox[{"ProcessesList", "[", 
          RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}]}], "}"}]}], "]"}], 
     "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"mN", ",", "0.05", ",", "4.5"}], "}"}], ",", 
   RowBox[{"PlotRange", "->", "All"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8940979068121023`*^9, 3.8940980607920666`*^9}, {
   3.896323779777932*^9, 3.8963238314766684`*^9}, {3.896323884059519*^9, 
   3.896323898137414*^9}, {3.896323931787507*^9, 3.896324011414894*^9}, {
   3.8963240739954414`*^9, 3.896324082682149*^9}, {3.9038889518335214`*^9, 
   3.903888984911126*^9}, {3.903897771290021*^9, 3.903897781718315*^9}, {
   3.904058042448268*^9, 3.9040581032457533`*^9}, {3.90481885173393*^9, 
   3.904818858556907*^9}, {3.9048357393204937`*^9, 3.9048357396274433`*^9}, {
   3.9139783644562836`*^9, 3.9139783744531116`*^9}, {3.9154371868797007`*^9, 
   3.915437186954745*^9}, 3.9161554091887407`*^9, {3.9161554417482996`*^9, 
   3.916155468036748*^9}, {3.9161607776566052`*^9, 3.9161607811469975`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[329]:=",ExpressionUUID->"1ac9d6ea-33b0-4c81-888c-d344bd52a579"]
}, Closed]],

Cell[CellGroupData[{

Cell["Matrix elements", "Subsection",
 CellChangeTimes->{{3.903888776623946*^9, 3.903888778472537*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"276a2c97-947c-4da9-97fb-9cae6ccef417"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPsel", "=", "\"\<B-Le-3Lmu+Ltau\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Msquared3BodyLLP", "[", 
    RowBox[{
    "LLPsel", ",", 
     "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \
\(+\)]\)\!\(\*SuperscriptBox[\(\[Pi]\), \
\(-\)]\)\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", "E1_", ",", "E3_",
      ",", "mLLP_"}], "]"}], "=", 
   RowBox[{"Msquared3BodyLLP", "[", 
    RowBox[{
    "\"\<B-L\>\"", ",", 
     "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \
\(+\)]\)\!\(\*SuperscriptBox[\(\[Pi]\), \
\(-\)]\)\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", "E1", ",", "E3", 
     ",", "mLLP"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.903888785563194*^9, 3.9038888312965903`*^9}, {
  3.9038889959899883`*^9, 3.903888999612791*^9}, {3.9048338954866657`*^9, 
  3.9048338980579166`*^9}, {3.9139783809177585`*^9, 3.913978384473735*^9}, {
  3.91543681481307*^9, 3.9154368181042333`*^9}, {3.915437186957312*^9, 
  3.9154371869707623`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[342]:=",ExpressionUUID->"bcb9455b-1c67-4401-ac7a-1ef81d817f1b"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["ALPs coupled to photons", "Section",
 CellChangeTimes->{{3.903890468061607*^9, 3.903890470823762*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"37cd9831-53d8-4b2c-981e-30c88bc5ef3b"],

Cell[CellGroupData[{

Cell["\<\
List of decay processes and sets of decay products for them, branching ratios\
\>", "Subsection",
 CellChangeTimes->{{3.9038905338612175`*^9, 3.903890554383395*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"1164b49a-4ab3-444b-b6c7-e6498c0cb8e7"],

Cell[BoxData[{
 RowBox[{"LLPsel", "=", "\"\<ALP-photon\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ListBrRatiosTemp", "[", 
      RowBox[{
      "\"\<ALP-photon\>\"", ",", "mLLP_", ",", "\"\<\[Gamma]-pair\>\""}], 
      "]"}], ",", 
     RowBox[{"ListDecayProducts", "[", 
      RowBox[{"\"\<ALP-photon\>\"", ",", "\"\<\[Gamma]-pair\>\""}], "]"}], 
     ",", 
     RowBox[{"JetsPresence", "[", 
      RowBox[{"\"\<ALP-photon\>\"", ",", "\"\<\[Gamma]-pair\>\""}], "]"}]}], 
    "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\[Gamma]\>\"", ",", "\"\<\[Gamma]\>\"", ",", "\"\<Null\>\"", ",", 
       "\"\<Null\>\""}], "}"}], ",", "\"\<No\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ListBrRatios", "[", 
    RowBox[{
    "\"\<ALP-photon\>\"", ",", "mLLP_", ",", "\"\<\[Gamma]-pair\>\""}], "]"}],
    "=", 
   RowBox[{"ListBrRatiosTemp", "[", 
    RowBox[{"\"\<ALP-photon\>\"", ",", "mLLP", ",", "\"\<\[Gamma]-pair\>\""}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<All processes with at least two charged/neutral particles:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProcessesList", "[", 
   RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], "=", 
  RowBox[{"procList", "[", "LLPsel", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<All processes with at least two charged particles:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProcessesList", "[", 
   RowBox[{"LLPsel", ",", "\"\<False\>\""}], "]"}], "=", 
  RowBox[{"procListnoecal", "[", "LLPsel", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Processes with jets:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Select", "[", 
  RowBox[{
   RowBox[{"ProcessesList", "[", 
    RowBox[{"LLPsel", ",", "\"\<True\>\""}], "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"JetsPresence", "[", 
      RowBox[{"LLPsel", ",", "#"}], "]"}], "==", "\"\<Yes\>\""}], "&"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.9038904751017675`*^9, 3.9038905157153997`*^9}, {
   3.9040581168951807`*^9, 3.904058139037302*^9}, {3.904834004563221*^9, 
   3.904834014113075*^9}, {3.9048377652368736`*^9, 3.9048377696049395`*^9}, {
   3.915437186976845*^9, 3.9154371870006566`*^9}, 3.9161554091957245`*^9, {
   3.916155441754284*^9, 3.916155468043769*^9}, {3.9161567187636194`*^9, 
   3.9161567271626825`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[344]:=",ExpressionUUID->"93637fcd-b2a5-45f3-81c4-00c0428b83fa"]
}, Closed]],

Cell["Matrix elements", "Subsection",
 CellChangeTimes->{{3.903890525098297*^9, 3.90389052790034*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"6ed24e69-aa48-4f5a-91d7-fa281655f0b4"]
}, Closed]],

Cell[CellGroupData[{

Cell["LLPs - total", "Section",
 CellChangeTimes->{{3.903890422626404*^9, 3.9038904246387916`*^9}, 
   3.9154371870076437`*^9},
 CellTags->
  "Evaluation",ExpressionUUID->"9ff1bc08-ec30-4e57-94cb-930d33ed3e9c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPlist", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Keys", "[", 
      RowBox[{"DownValues", "@", "ProcessesList"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], "//", 
    "DeleteDuplicates"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "If", " ", "decay", " ", "products", " ", "may", " ", "be", " ", 
    "uncharged", " ", 
    RowBox[{"only", "/", "metastable"}], " ", "decay", " ", "product", " ", 
    "itself", " ", "is", " ", "uncharged"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OnlyUnch", "[", "\"\<\[Omega]\>\"", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "OnlyUnch", "[", "\"\<\!\(\*SuperscriptBox[\(\[Rho]\), \(0\)]\)\>\"", 
    "]"}], "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OnlyUnch", "[", "\"\<\[Eta]\>\"", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OnlyUnch", "[", "\"\<\[Eta]'\>\"", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "OnlyUnch", "[", "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", "]"}],
    "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "OnlyUnch", "[", "\"\<\!\(\*SubscriptBox[\(K\), \(L\)]\)\>\"", "]"}], "=", 
   "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "OnlyUnch", "[", "\"\<\!\(\*SubscriptBox[\(K\), \(S\)]\)\>\"", "]"}], "=", 
   "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "OnlyUnch", "[", "\"\<\!\(\*SuperscriptBox[\(K\), \(\(*\)\(0\)\)]\)\>\"", 
    "]"}], "=", 
   RowBox[{
    RowBox[{
    "OnlyUnch", "[", 
     "\"\<\!\(\*SuperscriptBox[OverscriptBox[\(K\), \(_\)], \(\(*\)\(0\)\)]\)\
\>\"", "]"}], "=", "0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "OnlyUnch", "[", "\"\<\!\(\*SubscriptBox[\(a\), \(1\)]\)\>\"", "]"}], "=", 
   "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OnlyUnch", "[", "\"\<\[Phi]\>\"", "]"}], "=", "0"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "probability", " ", "with", " ", "which", " ", "the", " ", 
    "given", " ", "decay", " ", "products", " ", "will", " ", "give", " ", 
    "at", " ", "least", " ", "two", " ", "charged", " ", "tracks"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ecalfactor", "[", 
   RowBox[{"LLP_", ",", "proc_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"decayprodlist", "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"ListDecayProducts", "[", 
         RowBox[{"LLP", ",", "proc"}], "]"}], ",", 
        RowBox[{
         RowBox[{"#", "!=", "\"\<Null\>\""}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"decayprodpdglist", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"ParamProductToPDGid", "[", "#", "]"}], "&"}], "/@", 
       "decayprodlist"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"chargedprodscounter", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ParamProductCharge", "[", 
            RowBox[{"decayprodpdglist", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "!=", "0."}], ",", "1", 
          ",", "0"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "decayprodpdglist", "]"}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"chargedprodscounter", ">=", "2"}], ",", 
       RowBox[{"val", "=", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"stability", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ParamProductStability", "[", "#", "]"}], "&"}], "/@", 
          "decayprodpdglist"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"val", "=", 
         RowBox[{"1", "-", 
          RowBox[{"Product", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"stability", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "==", "0."}], ",", 
              RowBox[{"OnlyUnch", "[", 
               RowBox[{"decayprodlist", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "1"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "decayprodlist", "]"}], ",", "1"}], 
             "}"}]}], "]"}]}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "val"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
      "\"\<LLP\>\"", ",", "\"\<Process\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(P\), \(\(>\)\(2\\\ charged\\\ particles\)\)]\
\)\>\""}], "}"}], "}"}], ",", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"LLP", ",", "proc", ",", 
          RowBox[{"ecalfactor", "[", 
           RowBox[{"LLP", ",", "proc"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"LLP", ",", "LLPlist"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"proc", ",", 
          RowBox[{"ProcessesList", "[", 
           RowBox[{"LLP", ",", "\"\<True\>\""}], "]"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BrVisibleGivenSetup", "[", 
   RowBox[{"LLP_", ",", "mLLP_", ",", "proclist_", ",", "ECALoption_"}], 
   "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ListBrRatios", "[", 
        RowBox[{"LLP", ",", "mLLP", ",", 
         RowBox[{"proclist", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "*", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ECALoption", "==", "\"\<True\>\""}], ",", "1", ",", 
         RowBox[{"ecalfactor", "[", 
          RowBox[{"LLP", ",", 
           RowBox[{"proclist", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "proclist", "]"}], ",", "1"}], "}"}]}], 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.9038904300343843`*^9, 3.9038904467633495`*^9}, {
   3.9038974232518253`*^9, 3.9038974246177225`*^9}, {3.9048779761248674`*^9, 
   3.9048780930220118`*^9}, {3.9048783142877655`*^9, 
   3.9048783384580374`*^9}, {3.90487837008333*^9, 3.9048783719565516`*^9}, {
   3.904878431410695*^9, 3.9048785339761205`*^9}, {3.9048785970841255`*^9, 
   3.9048789305243125`*^9}, {3.9048791979269485`*^9, 3.904879198036928*^9}, {
   3.904879462528535*^9, 3.9048795089280105`*^9}, {3.904879599007524*^9, 
   3.9048796190666046`*^9}, {3.904887636719679*^9, 3.9048876513576403`*^9}, {
   3.9048880531897497`*^9, 3.904888112563091*^9}, {3.9048883347416267`*^9, 
   3.9048884863904457`*^9}, {3.912163504116641*^9, 3.9121635767619534`*^9}, {
   3.9154371870147343`*^9, 3.915437187058205*^9}, 3.9161554092002907`*^9, 
   3.9161554417582965`*^9, {3.916155610078227*^9, 3.9161556515348563`*^9}, 
   3.916155722113119*^9, {3.916163402748659*^9, 3.916163418029608*^9}, {
   3.916675569302534*^9, 3.916675583222969*^9}, {3.916675624232687*^9, 
   3.9166756244534187`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[353]:=",ExpressionUUID->"90b579f1-0233-4b93-ae6f-5f912193c54e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Unstable SM particles", "Section",
 CellChangeTimes->{{3.9038906938534837`*^9, 3.903890696581911*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"13911d2c-878e-4efb-99cf-9fc58317f0a7"],

Cell[CellGroupData[{

Cell["List of decay processes and decay products", "Subsection",
 CellChangeTimes->{{3.8933470120697165`*^9, 3.893347014625548*^9}, {
  3.893347587520714*^9, 3.8933475887111607`*^9}, {3.903890703722373*^9, 
  3.9038907150220394`*^9}, {3.9120970893257675`*^9, 3.912097090294301*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"0e7b00e6-10b3-4b9d-972b-4dff8fb5d317"],

Cell[CellGroupData[{

Cell["\[Tau] leptons", "Subsubsection",
 CellChangeTimes->{{3.9120973086530933`*^9, 3.912097310633312*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"7b90e0a0-a42a-4bb8-805b-8ca2c07a02d9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ListDecayProducts", "[", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(\[Tau]\), \(+\)]\)\>\"", ",", 
       "\"\<e\[Nu]\[Nu]\>\""}], "]"}], ",", 
     RowBox[{"ListDecayProducts", "[", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(\[Tau]\), \(+\)]\)\>\"", ",", 
       "\"\<\[Mu]\[Nu]\[Nu]\>\""}], "]"}], ",", 
     RowBox[{"ListDecayProducts", "[", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(\[Tau]\), \(+\)]\)\>\"", ",", 
       "\"\<\[Pi]\[Nu]\>\""}], "]"}], ",", 
     RowBox[{"ListDecayProducts", "[", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(\[Tau]\), \(+\)]\)\>\"", ",", 
       "\"\<2\[Pi]\[Nu]\>\""}], "]"}]}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(e\), \(+\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(e\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Nu]\), \(_\)], \(\[Tau]\)]\)\
\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(\[Mu]\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Nu]\), \(_\)], \(\[Tau]\)]\)\
\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Nu]\), \(_\)], \(\[Tau]\)]\)\
\>\"", ",", "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Nu]\), \(_\)], \(\[Tau]\)]\)\
\>\"", ",", "\"\<Null\>\""}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ListDecayProducts", "[", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(\[Tau]\), \(-\)]\)\>\"", ",", 
       "\"\<e\[Nu]\[Nu]\>\""}], "]"}], ",", 
     RowBox[{"ListDecayProducts", "[", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(\[Tau]\), \(-\)]\)\>\"", ",", 
       "\"\<\[Mu]\[Nu]\[Nu]\>\""}], "]"}], ",", 
     RowBox[{"ListDecayProducts", "[", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(\[Tau]\), \(-\)]\)\>\"", ",", 
       "\"\<\[Pi]\[Nu]\>\""}], "]"}], ",", 
     RowBox[{"ListDecayProducts", "[", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(\[Tau]\), \(-\)]\)\>\"", ",", 
       "\"\<2\[Pi]\[Nu]\>\""}], "]"}]}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(e\), \(-\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Nu]\), \(_\)], \(e\)]\)\>\"",
        ",", "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(\[Tau]\)]\)\>\"", ",", 
       "\"\<Null\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(-\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Nu]\), \(_\)], \
\(\[Mu]\)]\)\>\"", ",", "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(\[Tau]\)]\)\>\"",
        ",", "\"\<Null\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(-\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(\[Tau]\)]\)\>\"", ",", 
       "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(-\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(\[Tau]\)]\)\>\"", ",", 
       "\"\<Null\>\""}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Omega]process", "[", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(\[Tau]\), \(+\)]\)\>\"", ",", 
       "\"\<e\[Nu]\[Nu]\>\""}], "]"}], ",", 
     RowBox[{"\[Omega]process", "[", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(\[Tau]\), \(+\)]\)\>\"", ",", 
       "\"\<\[Mu]\[Nu]\[Nu]\>\""}], "]"}], ",", 
     RowBox[{"\[Omega]process", "[", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(\[Tau]\), \(+\)]\)\>\"", ",", 
       "\"\<\[Pi]\[Nu]\>\""}], "]"}], ",", 
     RowBox[{"\[Omega]process", "[", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(\[Tau]\), \(+\)]\)\>\"", ",", 
       "\"\<2\[Pi]\[Nu]\>\""}], "]"}]}], "}"}], "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Omega]process", "[", 
       RowBox[{
       "\"\<\!\(\*SuperscriptBox[\(\[Tau]\), \(-\)]\)\>\"", ",", 
        "\"\<e\[Nu]\[Nu]\>\""}], "]"}], ",", 
      RowBox[{"\[Omega]process", "[", 
       RowBox[{
       "\"\<\!\(\*SuperscriptBox[\(\[Tau]\), \(-\)]\)\>\"", ",", 
        "\"\<\[Mu]\[Nu]\[Nu]\>\""}], "]"}], ",", 
      RowBox[{"\[Omega]process", "[", 
       RowBox[{
       "\"\<\!\(\*SuperscriptBox[\(\[Tau]\), \(-\)]\)\>\"", ",", 
        "\"\<\[Pi]\[Nu]\>\""}], "]"}], ",", 
      RowBox[{"\[Omega]process", "[", 
       RowBox[{
       "\"\<\!\(\*SuperscriptBox[\(\[Tau]\), \(-\)]\)\>\"", ",", 
        "\"\<2\[Pi]\[Nu]\>\""}], "]"}]}], "}"}], "=", 
    RowBox[{"{", 
     RowBox[{"0.1739", ",", "0.1782", ",", "0.1082", ",", "0.2549"}], 
     "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9161633531124687`*^9, 3.9161633531366415`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[367]:=",ExpressionUUID->"78f8477d-c430-40b1-839f-0ce3f2d38eef"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{"\[Eta]", ",", 
   RowBox[{"\[Eta]", "'"}], ",", 
   SuperscriptBox["\[Pi]", "0"]}], 
  TraditionalForm]],ExpressionUUID->"e14cafe2-43b4-466d-b191-c6623550afd8"]], \
"Subsubsection",
 CellChangeTimes->{{3.9120973086530933`*^9, 3.9120973315623064`*^9}, {
  3.9161316194376864`*^9, 3.91613162041004*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"5c10c41a-5fb4-4845-a002-49c1f8f8b0c6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ListDecayProducts", "[", 
      RowBox[{
      "\"\<\[Eta]\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\!\(\*SuperscriptBox[\(\
\[Pi]\), \(-\)]\)\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\""}], "]"}], ",", 
     RowBox[{"ListDecayProducts", "[", 
      RowBox[{
      "\"\<\[Eta]\>\"", ",", 
       "\"\<3\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\""}], "]"}], ",", 
     RowBox[{"ListDecayProducts", "[", 
      RowBox[{"\"\<\[Eta]\>\"", ",", "\"\<\[Gamma]-pair\>\""}], "]"}]}], 
    "}"}], "=", 
   RowBox[{"{", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(-\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", 
       "\"\<Null\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", 
       "\"\<Null\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\[Gamma]\>\"", ",", "\"\<\[Gamma]\>\"", ",", "\"\<Null\>\"", ",", 
       "\"\<Null\>\""}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Omega]process", "[", 
      RowBox[{
      "\"\<\[Eta]\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\!\(\*SuperscriptBox[\(\
\[Pi]\), \(-\)]\)\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\""}], "]"}], ",", 
     RowBox[{"\[Omega]process", "[", 
      RowBox[{
      "\"\<\[Eta]\>\"", ",", 
       "\"\<3\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\""}], "]"}], ",", 
     RowBox[{"\[Omega]process", "[", 
      RowBox[{"\"\<\[Eta]\>\"", ",", "\"\<\[Gamma]-pair\>\""}], "]"}]}], 
    "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"0.2302", ",", "0.3257", ",", "0.3936"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ListDecayProducts", "[", 
      RowBox[{
      "\"\<\[Eta]'\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\!\(\*SuperscriptBox[\(\
\[Pi]\), \(-\)]\)\[Eta]\>\""}], "]"}], ",", 
     RowBox[{"ListDecayProducts", "[", 
      RowBox[{
      "\"\<\[Eta]'\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Rho]\), \(0\)]\)\[Gamma]\>\""}], "]"}], 
     ",", 
     RowBox[{"ListDecayProducts", "[", 
      RowBox[{
      "\"\<\[Eta]'\>\"", ",", 
       "\"\<2\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\[Eta]\>\""}], "]"}]}], 
    "}"}], "=", 
   RowBox[{"{", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(-\)]\)\>\"", ",", 
       "\"\<\[Eta]\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(\[Rho]\), \(0\)]\)\>\"", ",", 
       "\"\<\[Gamma]\>\"", ",", "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", 
       "\"\<\[Eta]\>\"", ",", "\"\<Null\>\""}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Omega]process", "[", 
      RowBox[{
      "\"\<\[Eta]'\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\!\(\*SuperscriptBox[\(\
\[Pi]\), \(-\)]\)\[Eta]\>\""}], "]"}], ",", 
     RowBox[{"\[Omega]process", "[", 
      RowBox[{
      "\"\<\[Eta]'\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Rho]\), \(0\)]\)\[Gamma]\>\""}], "]"}], 
     ",", 
     RowBox[{"\[Omega]process", "[", 
      RowBox[{
      "\"\<\[Eta]'\>\"", ",", 
       "\"\<2\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\[Eta]\>\""}], "]"}]}], 
    "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"0.425", ",", "0.295", ",", "0.224"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ListDecayProducts", "[", 
    RowBox[{
    "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", 
     "\"\<\[Gamma]-pair\>\""}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<\[Gamma]\>\"", ",", "\"\<\[Gamma]\>\"", ",", "\"\<Null\>\"", ",", 
     "\"\<Null\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Omega]process", "[", 
    RowBox[{
    "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", 
     "\"\<\[Gamma]-pair\>\""}], "]"}], "=", "1"}], ";"}]}], "Input",
 CellChangeTimes->{{3.912097620939726*^9, 3.9120976850262957`*^9}, {
   3.9120977224134684`*^9, 3.912097795834564*^9}, 3.9120985456398253`*^9, {
   3.916131617627967*^9, 3.916131617873298*^9}, {3.9161633531416388`*^9, 
   3.916163353158725*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[370]:=",ExpressionUUID->"d99502b0-5776-4e98-bdd4-d144c1ff2a82"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{"\[Rho]", ",", " ", "\[Omega]", ",", " ", "\[Phi]", ",", " ", 
   SubscriptBox["a", "1"]}], 
  TraditionalForm]],ExpressionUUID->"48981224-89fd-4c8e-af91-b58b26493f96"]], \
"Subsubsection",
 CellChangeTimes->{{3.9120973086530933`*^9, 3.912097340384476*^9}, {
  3.916131558893556*^9, 3.9161315597203145`*^9}, {3.916131622809354*^9, 
  3.916131622809354*^9}, {3.916131738267232*^9, 3.916131739640629*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"261f66b9-4bd4-428a-8e24-61f625a4fc0f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ListDecayProducts", "[", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(\[Rho]\), \(+\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\!\(\*SuperscriptBox[\(\
\[Pi]\), \(0\)]\)\>\""}], "]"}], ",", 
     RowBox[{"ListDecayProducts", "[", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(\[Rho]\), \(-\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(-\)]\)\!\(\*SuperscriptBox[\(\
\[Pi]\), \(0\)]\)\>\""}], "]"}], ",", 
     RowBox[{"ListDecayProducts", "[", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(\[Rho]\), \(0\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(charged\)]\)-pair\>\""}], 
      "]"}]}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", 
       "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(-\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", 
       "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(-\)]\)\>\"", ",", 
       "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Omega]process", "[", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(\[Rho]\), \(+\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\!\(\*SuperscriptBox[\(\
\[Pi]\), \(0\)]\)\>\""}], "]"}], ",", 
     RowBox[{"\[Omega]process", "[", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(\[Rho]\), \(-\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(-\)]\)\!\(\*SuperscriptBox[\(\
\[Pi]\), \(0\)]\)\>\""}], "]"}], ",", 
     RowBox[{"\[Omega]process", "[", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(\[Rho]\), \(0\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(charged\)]\)-pair\>\""}], 
      "]"}]}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ListDecayProducts", "[", 
      RowBox[{
      "\"\<\[Omega]\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\!\(\*SuperscriptBox[\(\
\[Pi]\), \(-\)]\)\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\""}], "]"}], ",", 
     RowBox[{"ListDecayProducts", "[", 
      RowBox[{"\"\<\[Omega]\>\"", ",", "\"\<\[Pi]\[Gamma]\>\""}], "]"}]}], 
    "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(-\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", 
       "\"\<Null\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", 
       "\"\<\[Gamma]\>\"", ",", "\"\<Null\>\"", ",", "\"\<Null\>\""}], 
      "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Omega]process", "[", 
      RowBox[{
      "\"\<\[Omega]\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\!\(\*SuperscriptBox[\(\
\[Pi]\), \(-\)]\)\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\""}], "]"}], ",", 
     RowBox[{"\[Omega]process", "[", 
      RowBox[{"\"\<\[Omega]\>\"", ",", "\"\<\[Pi]\[Gamma]\>\""}], "]"}]}], 
    "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"0.892", ",", "0.0835"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ListDecayProducts", "[", 
      RowBox[{
      "\"\<\[Phi]\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Rho]\), \(-\)]\)\!\(\*SuperscriptBox[\(\
\[Pi]\), \(+\)]\)\>\""}], "]"}], ",", 
     RowBox[{"ListDecayProducts", "[", 
      RowBox[{
      "\"\<\[Phi]\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Rho]\), \(+\)]\)\!\(\*SuperscriptBox[\(\
\[Pi]\), \(-\)]\)\>\""}], "]"}], ",", 
     RowBox[{"ListDecayProducts", "[", 
      RowBox[{
      "\"\<\[Phi]\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(K\), \(+\)]\)\!\(\*SuperscriptBox[\(K\), \
\(-\)]\)\>\""}], "]"}], ",", 
     RowBox[{"ListDecayProducts", "[", 
      RowBox[{
      "\"\<\[Phi]\>\"", ",", 
       "\"\<2\!\(\*SuperscriptBox[\(K\), \(0\)]\)\>\""}], "]"}]}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(\[Rho]\), \(-\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\>\"", ",", 
       "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(\[Rho]\), \(+\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(-\)]\)\>\"", ",", 
       "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(K\), \(+\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(K\), \(-\)]\)\>\"", ",", "\"\<Null\>\"", 
       ",", "\"\<Null\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(K\), \(L\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(K\), \(S\)]\)\>\"", ",", "\"\<Null\>\"", 
       ",", "\"\<Null\>\""}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Omega]process", "[", 
      RowBox[{
      "\"\<\[Phi]\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Rho]\), \(-\)]\)\!\(\*SuperscriptBox[\(\
\[Pi]\), \(+\)]\)\>\""}], "]"}], ",", 
     RowBox[{"\[Omega]process", "[", 
      RowBox[{
      "\"\<\[Phi]\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Rho]\), \(+\)]\)\!\(\*SuperscriptBox[\(\
\[Pi]\), \(-\)]\)\>\""}], "]"}], ",", 
     RowBox[{"\[Omega]process", "[", 
      RowBox[{
      "\"\<\[Phi]\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(K\), \(+\)]\)\!\(\*SuperscriptBox[\(K\), \
\(-\)]\)\>\""}], "]"}], ",", 
     RowBox[{"\[Omega]process", "[", 
      RowBox[{
      "\"\<\[Phi]\>\"", ",", 
       "\"\<2\!\(\*SuperscriptBox[\(K\), \(0\)]\)\>\""}], "]"}]}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["0.1532", "2"], ",", 
     FractionBox["0.1532", "2"], ",", "0.489", ",", "0.342"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ListDecayProducts", "[", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(a\), \(1\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Rho]\), \(+\)]\)\!\(\*SuperscriptBox[\(\
\[Pi]\), \(-\)]\)\>\""}], "]"}], ",", 
     RowBox[{"ListDecayProducts", "[", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(a\), \(1\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Rho]\), \(-\)]\)\!\(\*SuperscriptBox[\(\
\[Pi]\), \(+\)]\)\>\""}], "]"}]}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(\[Rho]\), \(+\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(-\)]\)\>\"", ",", 
       "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(\[Rho]\), \(-\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\>\"", ",", 
       "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Omega]process", "[", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(a\), \(1\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Rho]\), \(+\)]\)\!\(\*SuperscriptBox[\(\
\[Pi]\), \(-\)]\)\>\""}], "]"}], ",", 
     RowBox[{"\[Omega]process", "[", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(a\), \(1\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Rho]\), \(-\)]\)\!\(\*SuperscriptBox[\(\
\[Pi]\), \(+\)]\)\>\""}], "]"}]}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.5"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9120973474422483`*^9, 3.912097446376546*^9}, {
  3.9120975104876213`*^9, 3.9120976163072877`*^9}, {3.916131611109199*^9, 
  3.916131958463072*^9}, {3.916163353166272*^9, 3.916163353194466*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[376]:=",ExpressionUUID->"29d6e60d-3d82-455c-b45f-10d08c5e84d5"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   SuperscriptBox["K", "*"], ",", 
   SubscriptBox["K", "S"]}], 
  TraditionalForm]],ExpressionUUID->"cf976e9c-5c1b-48f4-8bc9-d8eaa701547b"]], \
"Subsubsection",
 CellChangeTimes->{{3.9120973086530933`*^9, 3.912097310633312*^9}, {
  3.912097692434881*^9, 3.9120977012846813`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"dfed6dc9-54e9-482c-91f1-56aeacd12223"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ListDecayProducts", "[", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(K\), \(\(*\)\(+\)\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(K\), \
\(+\)]\)\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\""}], "]"}], ",", 
     RowBox[{"ListDecayProducts", "[", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(K\), \(\(*\)\(-\)\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(K\), \
\(-\)]\)\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\""}], "]"}], ",", 
     RowBox[{"ListDecayProducts", "[", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(K\), \(\(*\)\(0\)\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(K\), \
\(+\)]\)\!\(\*SuperscriptBox[\(\[Pi]\), \(-\)]\)\>\""}], "]"}], ",", 
     RowBox[{"ListDecayProducts", "[", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[OverscriptBox[\(K\), \(_\)], \
\(\(*\)\(0\)\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(K\), \
\(-\)]\)\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\>\""}], "]"}]}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(K\), \(+\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", 
       "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(K\), \(-\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", 
       "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(K\), \(+\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(-\)]\)\>\"", ",", 
       "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(K\), \(-\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\>\"", ",", 
       "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Omega]process", "[", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(K\), \(\(*\)\(+\)\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(K\), \
\(+\)]\)\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\""}], "]"}], ",", 
     RowBox[{"\[Omega]process", "[", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(K\), \(\(*\)\(-\)\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(K\), \
\(-\)]\)\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\""}], "]"}], ",", 
     RowBox[{"\[Omega]process", "[", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(K\), \(\(*\)\(0\)\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(K\), \
\(+\)]\)\!\(\*SuperscriptBox[\(\[Pi]\), \(-\)]\)\>\""}], "]"}], ",", 
     RowBox[{"\[Omega]process", "[", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[OverscriptBox[\(K\), \(_\)], \
\(\(*\)\(0\)\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(K\), \
\(-\)]\)\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\>\""}], "]"}]}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ListDecayProducts", "[", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(K\), \(S\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\!\(\*SuperscriptBox[\(\
\[Pi]\), \(-\)]\)\>\""}], "]"}], ",", 
     RowBox[{"ListDecayProducts", "[", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(K\), \(S\)]\)\>\"", ",", 
       "\"\<2\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\""}], "]"}]}], "}"}], 
   "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(-\)]\)\>\"", ",", 
       "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", 
       "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Omega]process", "[", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(K\), \(S\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\!\(\*SuperscriptBox[\(\
\[Pi]\), \(-\)]\)\>\""}], "]"}], ",", 
     RowBox[{"\[Omega]process", "[", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(K\), \(S\)]\)\>\"", ",", 
       "\"\<2\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\""}], "]"}]}], "}"}], 
   "=", 
   RowBox[{"{", 
    RowBox[{"0.6920", ",", "0.3069"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9120978029542828`*^9, 3.9120978966815825`*^9}, 
   3.9120981945835285`*^9, {3.9161633532012863`*^9, 3.9161633532167397`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[384]:=",ExpressionUUID->"a325ae9e-495b-417d-a8aa-3e0c89f50f33"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Matrix elements", "Subsection",
 CellChangeTimes->{{3.9038907238365707`*^9, 3.9038907256424522`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"fdea899d-b657-4b1b-a48b-c05bbbaddca5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ListSMdecays", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Partition", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Keys", "[", 
         RowBox[{"DownValues", "@", "\[Omega]process"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], ",", "1"}], "]"}],
      ",", 
     RowBox[{"Partition", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Keys", "[", 
         RowBox[{"DownValues", "@", "\[Omega]process"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1", ",", "2"}], "]"}], "]"}], ",", "1"}], "]"}],
      ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Msquared3BodySMparticles", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ListSMdecays", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"ListSMdecays", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", "E1_", ",", "E3_", ",", "m_"}], 
     "]"}], "=", "1"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "ListSMdecays", "]"}], ",", "1"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"part", "=", 
          RowBox[{
           RowBox[{"ListSMdecays", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"proc", "=", 
          RowBox[{
           RowBox[{"ListSMdecays", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"{", 
         RowBox[{"part", ",", "proc", ",", 
          RowBox[{
           RowBox[{"ListDecayProducts", "[", 
            RowBox[{"part", ",", "proc"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"ListDecayProducts", "[", 
            RowBox[{"part", ",", "proc"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"ListDecayProducts", "[", 
            RowBox[{"part", ",", "proc"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"ListDecayProducts", "[", 
            RowBox[{"part", ",", "proc"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{"\[Omega]process", "[", 
           RowBox[{"part", ",", "proc"}], "]"}]}], "}"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "ListSMdecays", "]"}], ",", "1"}], "}"}]}], 
    "]"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.9038908512893653`*^9, 3.9038909408452697`*^9}, {
  3.912098226793417*^9, 3.9120982274333878`*^9}, {3.912098697407384*^9, 
  3.912098701973116*^9}, {3.915436855574023*^9, 3.915436855718285*^9}, {
  3.916163353219303*^9, 3.9161633532242904`*^9}, {3.9162149249830065`*^9, 
  3.9162149291772966`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[388]:=",ExpressionUUID->"17dcbf02-6f8d-4a7c-afff-a857c096b0f9"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Phase space of decay products at the rest frame of the decaying LLP \
\>", "Chapter",
 CellChangeTimes->{{3.877157155189598*^9, 3.877157157027459*^9}, {
  3.885009818405767*^9, 3.885009832273227*^9}, {3.91543549320864*^9, 
  3.915435493542472*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"cd02dbae-e64d-4e38-9189-47d7c3a03e99"],

Cell[CellGroupData[{

Cell["Phase space of decay products - generated on-flight", "Section",
 CellChangeTimes->{{3.8896808751910667`*^9, 3.8896808925929117`*^9}, {
  3.8896810405865717`*^9, 3.889681040711938*^9}, {3.8928219291767955`*^9, 
  3.8928219311819687`*^9}, {3.9017176077887716`*^9, 3.901717612886634*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"b2d5f626-56ad-4f1d-b77b-14d03938e14e"],

Cell[CellGroupData[{

Cell["\<\
Phase space of LLP\[CloseCurlyQuote]s decays at its rest frame - 2-body decays\
\>", "Subsection",
 CellChangeTimes->{{3.8896809985063643`*^9, 3.8896810040625315`*^9}, {
   3.8896810441944137`*^9, 3.889681047221568*^9}, {3.892821936878008*^9, 
   3.8928219532696333`*^9}, {3.892822893838851*^9, 3.8928228975488696`*^9}, 
   3.915437187064143*^9},
 CellTags->
  "Evaluation",ExpressionUUID->"cc1c5e0c-1ece-4ae5-80f2-f9816b9a0646"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Computation", " ", "of", " ", "the", " ", "phase", " ", "space", " ", 
      "of", " ", "2"}], "-", 
     RowBox[{"body", " ", 
      RowBox[{"products", ":", " ", 
       RowBox[{"4", "-", "momenta"}]}]}]}], ",", " ", "mass", ",", " ", "pdg",
     ",", " ", 
    RowBox[{"electric", " ", "charge"}], ",", " ", 
    RowBox[{"whether", " ", "stable", " ", "or", " ", "not"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"nVectorParticles", "=", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Theta]vals", ",", "_Real"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Phi]vals", ",", "_Real"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"E1", ",", "_Real"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"E2", ",", "_Real"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"m1", ",", "_Real"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"m2", ",", "_Real"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"pdg1", ",", "_Real"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"pdg2", ",", "_Real"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"charge1", ",", "_Real"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"charge2", ",", "_Real"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"stability1", ",", "_Real"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"stability2", ",", "_Real"}], "}"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "pmod", ",", "px1", ",", "px2", ",", "py1", ",", "py2", ",", "pz1", 
           ",", "pz2"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"pmod", "=", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["E1", "2"], "-", 
             SuperscriptBox["m1", "2"]}]]}], ";", "\[IndentingNewLine]", 
          RowBox[{"px1", "=", 
           RowBox[{"pmod", "*", 
            RowBox[{"Sin", "[", "\[Theta]vals", "]"}], "*", 
            RowBox[{"Cos", "[", "\[Phi]vals", "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"px2", "=", 
           RowBox[{"-", "px1"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"py1", "=", 
           RowBox[{"pmod", "*", 
            RowBox[{"Sin", "[", "\[Theta]vals", "]"}], "*", 
            RowBox[{"Sin", "[", "\[Phi]vals", "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"py2", "=", 
           RowBox[{"-", "py1"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"pz1", "=", 
           RowBox[{"pmod", "*", 
            RowBox[{"Cos", "[", "\[Theta]vals", "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"pz2", "=", 
           RowBox[{"-", "pz1"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
           "px1", ",", "py1", ",", "pz1", ",", "E1", ",", "m1", ",", "pdg1", 
            ",", "charge1", ",", "stability1", ",", "px2", ",", "py2", ",", 
            "pz2", ",", "E2", ",", "m2", ",", "pdg2", ",", "charge2", ",", 
            "stability2"}], "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
       RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
       RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
       RowBox[{"RuntimeAttributes", "\[Rule]", 
        RowBox[{"{", "Listable", "}"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"joincompiled", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"tab1", ",", "_Real", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"tab2", ",", "_Real", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"tab3", ",", "_Real", ",", "2"}], "}"}]}], "}"}], ",", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"tab1", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5"}], "}"}]}], 
          "]"}], "]"}], ",", "tab2", ",", 
        RowBox[{"tab1", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", 
            RowBox[{"6", ",", "7", ",", "8", ",", "9", ",", "10"}], "}"}]}], 
          "]"}], "]"}], ",", "tab3", ",", "2"}], "]"}], ",", 
      RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
      RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Block2BodyDistrAtRest", "[", 
     RowBox[{"m_", ",", "product1_", ",", "product2_", ",", "Nevents_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[Theta]tab", ",", "\[Phi]tab", ",", "E1v", ",", "E2v", ",", "mass1", 
        ",", "mass2", ",", "pdg1", ",", "pdg2", ",", "charge1", ",", 
        "charge2", ",", "stability1", ",", "stability2"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"pdg1", ",", "pdg2"}], "}"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ParamProductToPDGid", "[", "#", "]"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"product1", ",", "product2"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"mass1", ",", "mass2"}], "}"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ParamProductMass", "[", "#", "]"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"pdg1", ",", "pdg2"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"charge1", ",", "charge2"}], "}"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ParamProductCharge", "[", "#", "]"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"pdg1", ",", "pdg2"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"stability1", ",", "stability2"}], "}"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ParamProductStability", "[", "#", "]"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"pdg1", ",", "pdg2"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Random", " ", "values", " ", "of", " ", "\[Theta]", " ", "and", " ", 
          RowBox[{"\[Phi]", ".", " ", "For"}], " ", "\[Theta]"}], ",", " ", 
         RowBox[{
         "the", " ", "distribution", " ", "in", " ", "cos\[Theta]", " ", "is",
           " ", "uniform"}], ",", " ", 
         RowBox[{
          RowBox[{
          "hence", " ", "one", " ", "first", " ", "generates", " ", "random", 
           " ", "values", " ", "from"}], " ", "-", 
          RowBox[{
          "1", " ", "to", " ", "1", " ", "and", " ", "then", " ", "computes", 
           " ", "ArcCos"}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\[Theta]tab", "=", 
        RowBox[{"ArcCos", "[", 
         RowBox[{"RandomReal", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "Nevents"}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Phi]tab", "=", 
        RowBox[{"RandomReal", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], ",", "Nevents"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"E1v", ",", "E2v"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
          FractionBox[
           RowBox[{
            SuperscriptBox["m", "2"], "+", 
            SuperscriptBox["mass1", "2"], "-", 
            SuperscriptBox["mass2", "2"]}], 
           RowBox[{"2", "*", "m"}]], ",", 
          FractionBox[
           RowBox[{
            SuperscriptBox["m", "2"], "+", 
            SuperscriptBox["mass2", "2"], "-", 
            SuperscriptBox["mass1", "2"]}], 
           RowBox[{"2", "*", "m"}]]}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nVectorParticles", "[", 
        RowBox[{
        "\[Theta]tab", ",", "\[Phi]tab", ",", "E1v", ",", "E2v", ",", "mass1",
          ",", "mass2", ",", "pdg1", ",", "pdg2", ",", "charge1", ",", 
         "charge2", ",", "stability1", ",", "stability2"}], "]"}]}]}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Columns", " ", "for", " ", "the", " ", "decay", " ", "product", " ", 
      "phase", " ", "space", " ", "expressed", " ", "in", " ", "terms", " ", 
      "of", " ", "4"}], "-", "momenta"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"indexpx1", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"indexpy1", "=", "2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"indexpz1", "=", "3"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"indexE1", "=", "4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"indexm1", "=", "5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"indexpdg1", "=", "6"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"indexcharge1", "=", "7"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"indexstability1", "=", "8"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LengthDataProduct", "=", "indexstability1"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.826622683497863*^9, 3.8266227081733236`*^9}, {
   3.8266227527043915`*^9, 3.8266227528696837`*^9}, {3.8266227898932114`*^9, 
   3.826622805026924*^9}, {3.8266229440333824`*^9, 3.8266229954136515`*^9}, {
   3.826623181460708*^9, 3.8266232608834305`*^9}, {3.826623303941981*^9, 
   3.826623521494627*^9}, {3.8266235672869573`*^9, 3.8266235828410006`*^9}, {
   3.8266236317460375`*^9, 3.826623651629723*^9}, {3.8266237377713547`*^9, 
   3.8266237449130535`*^9}, {3.8266253063221264`*^9, 
   3.8266253064783287`*^9}, {3.826648189044012*^9, 3.826648208343219*^9}, {
   3.826648364238099*^9, 3.8266483732856383`*^9}, {3.826652506921829*^9, 
   3.826652509863677*^9}, {3.8534929377897263`*^9, 3.853492939095056*^9}, {
   3.8534931449114685`*^9, 3.8534931841446295`*^9}, {3.853493591561166*^9, 
   3.8534935944134307`*^9}, {3.8534936311175776`*^9, 3.853493632651087*^9}, {
   3.853494035404828*^9, 3.853494035737423*^9}, {3.853495771528728*^9, 
   3.8534957720549603`*^9}, {3.8534965380162783`*^9, 3.8534965380987153`*^9}, 
   3.8534973432210712`*^9, {3.853497639084596*^9, 3.8534976398972683`*^9}, {
   3.853498271382411*^9, 3.8534982726615915`*^9}, {3.853576001272518*^9, 
   3.853576018720704*^9}, {3.8535763414345055`*^9, 3.8535765276900454`*^9}, {
   3.8535765677509813`*^9, 3.8535765873033686`*^9}, {3.853577144012004*^9, 
   3.853577178613341*^9}, {3.8535783774490385`*^9, 3.853578383380701*^9}, {
   3.853578436982752*^9, 3.853578439400177*^9}, {3.853578618574566*^9, 
   3.8535786211587515`*^9}, {3.853578775771859*^9, 3.853578778036934*^9}, {
   3.8535791441453333`*^9, 3.8535791450271864`*^9}, {3.8535800409296894`*^9, 
   3.853580048428653*^9}, {3.887693939543371*^9, 3.8876939597412305`*^9}, {
   3.887694446686542*^9, 3.8876944818453393`*^9}, {3.8877008952705855`*^9, 
   3.887700939835244*^9}, {3.8877011104608293`*^9, 3.8877015042418957`*^9}, {
   3.8883057567925224`*^9, 3.888305825359809*^9}, {3.8903764291086793`*^9, 
   3.890376453502881*^9}, {3.8914468920459943`*^9, 3.891446894236092*^9}, {
   3.892306017156144*^9, 3.892306018928787*^9}, {3.892306176114251*^9, 
   3.892306247663126*^9}, {3.8923100912177525`*^9, 3.892310122512114*^9}, {
   3.8923103172399635`*^9, 3.892310377194084*^9}, {3.892313099344761*^9, 
   3.892313136017045*^9}, {3.89231486365227*^9, 3.8923148647235126`*^9}, {
   3.892535592033269*^9, 3.892535604902149*^9}, {3.8925357548854094`*^9, 
   3.8925357599099803`*^9}, {3.8927850370889244`*^9, 3.892785058698825*^9}, {
   3.8927855815100822`*^9, 3.892785581728081*^9}, {3.8927856665292726`*^9, 
   3.8927857004009523`*^9}, {3.8927859977825875`*^9, 
   3.8927860169349236`*^9}, {3.892786056387774*^9, 3.8927861414390182`*^9}, {
   3.8927861846645184`*^9, 3.8927862190916557`*^9}, {3.892786271808179*^9, 
   3.892786328817464*^9}, {3.892786376046092*^9, 3.8927864044694834`*^9}, {
   3.8927865780912514`*^9, 3.8927866650772877`*^9}, {3.8927869614539375`*^9, 
   3.8927869804201355`*^9}, {3.892788436354596*^9, 3.8927884369745307`*^9}, {
   3.893347721642605*^9, 3.8933477797164893`*^9}, {3.8936879624357395`*^9, 
   3.893687981721648*^9}, {3.9161556100842113`*^9, 3.9161556733349934`*^9}, 
   3.916155722118616*^9, {3.916156272814335*^9, 3.9161563640587535`*^9}, {
   3.9161594172449093`*^9, 3.916159427833513*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[390]:=",ExpressionUUID->"ea334552-f4d8-4460-ac10-2a74a6ed435f"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Phase space of LLP\[CloseCurlyQuote]s decays at its rest frame - 3-body decays\
\>", "Subsection",
 CellChangeTimes->{{3.8896809985063643`*^9, 3.8896810040625315`*^9}, {
   3.8896810441944137`*^9, 3.889681047221568*^9}, {3.892821936878008*^9, 
   3.8928219532696333`*^9}, {3.892822893838851*^9, 3.892822904047701*^9}, 
   3.915437187070667*^9},
 CellTags->
  "Evaluation",ExpressionUUID->"987b9a31-b010-49bd-9a41-747900bfb951"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BlockRandomEnergiesOld", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "m", ",", "m1", ",", "m2", ",", "m3", ",", "E1min", ",", "E1max"}], 
       "}"}], ",", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"E1r", "=", "0."}], ",", 
          RowBox[{"E2v", "=", "0."}], ",", 
          RowBox[{"E3r", "=", "0."}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{"E3r", "=", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{"m3", ",", 
               FractionBox[
                RowBox[{
                 SuperscriptBox["m", "2"], "+", 
                 SuperscriptBox["m3", "2"], "-", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"m1", "+", "m2"}], ")"}], "2"]}], 
                RowBox[{"2", "*", "m"}]]}], "}"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"E1r", "=", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{"E1min", ",", "E1max"}], "}"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"E2v", "=", 
            RowBox[{"m", "-", "E1r", "-", "E3r"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"E2v", "\[LessEqual]", "m2"}], "||", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["E2v", "2"], "-", 
                SuperscriptBox["m2", "2"], "-", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["E1r", "2"], "-", 
                  SuperscriptBox["m1", "2"]}], ")"}], "-", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["E3r", "2"], "-", 
                  SuperscriptBox["m3", "2"]}], ")"}]}], ")"}], "2"], 
             "\[GreaterEqual]", 
             RowBox[{"4", "*", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["E1r", "2"], "-", 
                SuperscriptBox["m1", "2"]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["E3r", "2"], "-", 
                SuperscriptBox["m3", "2"]}], ")"}]}]}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"E1r", ",", "E3r"}], "}"}]}]}], "]"}], ",", 
      RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
      RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
      RowBox[{"RuntimeAttributes", "->", 
       RowBox[{"{", "Listable", "}"}]}], ",", 
      RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"The", " ", "idea", " ", 
     RowBox[{"(", 
      RowBox[{
      "following", " ", "\"\<Particle kinematics\>\"", " ", "by", " ", 
       "Byckling", " ", "and", " ", "Kajantie"}], ")"}]}], ":"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Generate", " ", "the", " ", "random", " ", "energies", " ", 
     SubscriptBox["E", "1"]}], ",", 
    RowBox[{
     SubscriptBox["E", "3"], " ", "with", " ", "the", " ", "weight", " ", 
     "being", " ", "the", " ", "squared", " ", "matrix", " ", "element", " ", 
     "of", " ", "the", " ", "decay", " ", "process"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Restore", " ", "full", " ", "4"}], "-", "momenta"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NN", "=", 
    SuperscriptBox["10", "5"]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "routine", " ", "that", " ", "computes", " ", "the", " ", 
     "weights", " ", 
     SuperscriptBox["M", "2"], 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["E", "1"], ",", 
       SubscriptBox["E", "3"]}], ")"}], 
     SubscriptBox["\[CapitalDelta]E", "3"], 
     RowBox[{"(", 
      SubscriptBox["E", "1"], ")"}], " ", "for", " ", "the", " ", "given", 
     " ", "uniformly", " ", "distributed", " ", 
     SubscriptBox["E", "1"]}], ",", 
    SubscriptBox["E", "3"]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"weightsNonUniformComp", ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Hold", "@", 
      RowBox[{"Compile", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"tabe1e3", ",", "_Real", ",", "1"}], "}"}], ",", "MASSM", 
          ",", "MASS1", ",", "MASS2", ",", "MASS3"}], "}"}], ",", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"e1", ",", "e3"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"e1", "=", 
            RowBox[{"Compile`GetElement", "[", 
             RowBox[{"tabe1e3", ",", "1"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"e3", "=", 
            RowBox[{"Compile`GetElement", "[", 
             RowBox[{"tabe1e3", ",", "2"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"distr", "[", 
             RowBox[{"e1", ",", "e3"}], "]"}], "*", 
            RowBox[{"\[CapitalDelta]E3", "[", 
             RowBox[{
             "e1", ",", "MASSM", ",", "MASS1", ",", "MASS2", ",", "MASS3"}], 
             "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ",", 
        RowBox[{"CompilationTarget", "\[Rule]", "\"\<MVM\>\""}], ",", 
        RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
        RowBox[{"RuntimeAttributes", "->", 
         RowBox[{"{", "Listable", "}"}]}], ",", 
        RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], "/.", 
     RowBox[{"ruleDown", "[", 
      RowBox[{"{", 
       RowBox[{"distr", ",", "\[CapitalDelta]E3"}], "}"}], "]"}]}], "//", 
    "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"weightsUniformComp", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Hold", "@", 
      RowBox[{"Compile", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"tabe1e3", ",", "_Real", ",", "1"}], "}"}], ",", "MASSM", 
          ",", "MASS1", ",", "MASS2", ",", "MASS3"}], "}"}], ",", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"e1", ",", "e3"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"e1", "=", 
            RowBox[{"Compile`GetElement", "[", 
             RowBox[{"tabe1e3", ",", "1"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"\[CapitalDelta]E3", "[", 
            RowBox[{
            "e1", ",", "MASSM", ",", "MASS1", ",", "MASS2", ",", "MASS3"}], 
            "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
        RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
        RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
        RowBox[{"RuntimeAttributes", "->", 
         RowBox[{"{", "Listable", "}"}]}], ",", 
        RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], "/.", 
     RowBox[{"ruleDown", "[", 
      RowBox[{"{", "\[CapitalDelta]E3", "}"}], "]"}]}], "//", 
    "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E3valsComp", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Hold", "@", 
      RowBox[{"Compile", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"E1vals", ",", "_Real"}], "}"}], ",", "MASSM", ",", 
          "MASS1", ",", "MASS2", ",", "MASS3"}], "}"}], ",", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"e3max", ",", "e3min"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"e3min", "=", 
            RowBox[{"E3domainMin", "[", 
             RowBox[{
             "E1vals", ",", "MASSM", ",", "MASS1", ",", "MASS2", ",", 
              "MASS3"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"e3max", "=", 
            RowBox[{"E3domainMax", "[", 
             RowBox[{
             "E1vals", ",", "MASSM", ",", "MASS1", ",", "MASS2", ",", 
              "MASS3"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{"e3min", ",", "e3max"}], "}"}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], ",", 
        RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
        RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
        RowBox[{"RuntimeAttributes", "->", 
         RowBox[{"{", "Listable", "}"}]}], ",", 
        RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], "/.", 
     RowBox[{"ruleDown", "[", 
      RowBox[{"{", 
       RowBox[{"E3domainMax", ",", "E3domainMin"}], "}"}], "]"}]}], "//", 
    "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BlockRandomEnergies", "[", 
    RowBox[{
    "m_", ",", "m1_", ",", "m2_", ",", "m3_", ",", "Nevents_", ",", 
     "distr_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"E1maxval", "=", 
       RowBox[{"E1domainMax", "[", 
        RowBox[{"m", ",", "m1", ",", "m2", ",", "m3"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"E1vals", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"m1", ",", "E1maxval"}], "}"}], ",", 
         RowBox[{"Max", "[", 
          RowBox[{"NN", ",", "Nevents"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"E3vals", "=", 
       RowBox[{"E3valsComp", "[", 
        RowBox[{"E1vals", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tabE1E3unweighted", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"E1vals", ",", "E3vals"}], "}"}], "//", "Transpose"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Weights", " ", "for", " ", "the", " ", "generated", " ", "values", 
        " ", "of", " ", 
        RowBox[{"{", 
         RowBox[{"E1", ",", "E3"}], "}"}], " ", "from", " ", "matrix", " ", 
        "element", " ", "squared"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"distr", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"tabE1E3unweighted", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"tabE1E3unweighted", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "!=", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Table", " ", "with", " ", "random", " ", "energies", " ", 
          "distributed", " ", "in", " ", "the", " ", "Dalitz", " ", "range", 
          " ", "before", " ", "accounting", " ", "for", " ", "weights"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"weights1", "=", "weightsNonUniformComp"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Weights", " ", "from", " ", "matrix", " ", 
            RowBox[{"element", ".", " ", "Near"}], " ", "the", " ", 
            "boundary", " ", "values", " ", "of", " ", "E1"}], ",", " ", "E3",
            ",", " ", 
           RowBox[{"they", " ", "may", " ", "become", " ", "negative", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Mathematica", "'"}], "s", " ", "numeric", " ", 
               "inaccuracy"}], ")"}], ".", " ", "Because"}], " ", "of", " ", 
            "that"}], ",", " ", 
           RowBox[{
           "I", " ", "will", " ", "just", " ", "replace", " ", "such", " ", 
            "weights", " ", "by", " ", "zero"}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"weights", "=", 
          RowBox[{"Abs", "[", 
           RowBox[{"weights1", "[", 
            RowBox[{
            "tabE1E3unweighted", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
            "]"}], 
           RowBox[{"(*", 
            RowBox[{"/.", 
             RowBox[{
              RowBox[{"_", "?", "Negative"}], "\[Rule]", "0"}]}], "*)"}], 
           "]"}]}], ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"weights1", "=", "weightsUniformComp"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"weights", "=", 
          RowBox[{"Abs", "[", 
           RowBox[{"weights1", "[", 
            RowBox[{
            "tabE1E3unweighted", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
            "]"}], 
           RowBox[{"(*", 
            RowBox[{"/.", 
             RowBox[{
              RowBox[{"_", "?", "Negative"}], "\[Rule]", "0"}]}], "*)"}], 
           "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"True", " ", "random", " ", 
        RowBox[{"energies", ".", " ", "Computed"}], " ", "via", " ", 
        "empirical", " ", "distribution", " ", "from", " ", "the", " ", 
        "weigthed", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"RandomChoice", "[", 
       RowBox[{
        RowBox[{"weights", "->", "tabE1E3unweighted"}], ",", "Nevents"}], 
       "]"}]}]}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"(*", 
      RowBox[{"Weighted", " ", "random", " ", "points"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"weightedData", "=", 
       RowBox[{"WeightedData", "[", 
        RowBox[{"tabE1E3unweighted", ",", "weights"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"True", " ", "random", " ", 
        RowBox[{"energies", ".", " ", "Computed"}], " ", "via", " ", 
        "empirical", " ", "distribution", " ", "from", " ", "the", " ", 
        "weigthed", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"edist", "=", 
       RowBox[{"EmpiricalDistribution", "[", "weightedData", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"RandomVariate", "[", 
       RowBox[{"edist", ",", "Nevents"}], "]"}], ";"}], "*)"}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Phase", " ", "space", " ", "of", " ", "3"}], "-", 
      RowBox[{"body", " ", "decays", " ", "at", " ", 
       RowBox[{"rest", ".", " ", "Returns"}], " ", "blocks", " ", "with", " ",
        "the", " ", "following", " ", 
       RowBox[{"data", ":", " ", "productdata"}]}]}], " ", "=", " ", 
     SubscriptBox["p", "x"]}], ",", 
    SubscriptBox["p", "y"], ",", 
    SubscriptBox["p", "z"], ",", "E", ",", "m", ",", "pdg", ",", "charge", 
    ",", "stability"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tabPS3bodyCompiled", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Hold", "@", 
      RowBox[{"Compile", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"tabPSenergies", ",", "_Real", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"MASSM", ",", "_Real"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"MASS1", ",", "_Real"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"MASS2", ",", "_Real"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"MASS3", ",", "_Real"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"pdg1", ",", "_Real"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"pdg2", ",", "_Real"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"pdg3", ",", "_Real"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"charge1", ",", "_Real"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"charge2", ",", "_Real"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"charge3", ",", "_Real"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"stability1", ",", "_Real"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"stability2", ",", "_Real"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"stability3", ",", "_Real"}], "}"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "eprod1", ",", "eprod2", ",", "eprod3", ",", "pxprod1", ",", 
            "pxprod2", ",", "pxprod3", ",", "pyprod1", ",", "pyprod2", ",", 
            "pyprod3", ",", "pzprod1", ",", "pzprod2", ",", "pzprod3", ",", 
            "\[Theta]randTab", ",", "\[Phi]randTab", ",", "\[Kappa]randTab"}],
            "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"eprod1", "=", 
            RowBox[{"Compile`GetElement", "[", 
             RowBox[{"tabPSenergies", ",", "1"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"eprod3", "=", 
            RowBox[{"Compile`GetElement", "[", 
             RowBox[{"tabPSenergies", ",", "2"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "Angles", " ", "relating", " ", "generated", " ", "energies", 
              " ", "to", " ", "the", " ", "4"}], "-", "momenta"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"\[Theta]randTab", "=", 
            RowBox[{"ArcCos", "[", 
             RowBox[{"RandomReal", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"\[Phi]randTab", "=", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"\[Kappa]randTab", "=", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"eprod2", "=", 
            RowBox[{"MASSM", "-", "eprod1", "-", "eprod3"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"pxprod1", "=", 
            RowBox[{"p1rotatedX", "[", 
             RowBox[{
             "eprod1", ",", "MASS1", ",", "\[Theta]randTab", ",", 
              "\[Phi]randTab"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"pyprod1", "=", 
            RowBox[{"p1rotatedY", "[", 
             RowBox[{
             "eprod1", ",", "MASS1", ",", "\[Theta]randTab", ",", 
              "\[Phi]randTab"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"pzprod1", "=", 
            RowBox[{"p1rotatedZ", "[", 
             RowBox[{
             "eprod1", ",", "MASS1", ",", "\[Theta]randTab", ",", 
              "\[Phi]randTab"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"pxprod2", "=", 
            RowBox[{"p2rotatedX", "[", 
             RowBox[{
             "eprod1", ",", "eprod3", ",", "MASSM", ",", "MASS1", ",", 
              "MASS2", ",", "MASS3", ",", "\[Theta]randTab", ",", 
              "\[Phi]randTab", ",", "\[Kappa]randTab"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"pyprod2", "=", 
            RowBox[{"p2rotatedY", "[", 
             RowBox[{
             "eprod1", ",", "eprod3", ",", "MASSM", ",", "MASS1", ",", 
              "MASS2", ",", "MASS3", ",", "\[Theta]randTab", ",", 
              "\[Phi]randTab", ",", "\[Kappa]randTab"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"pzprod2", "=", 
            RowBox[{"p2rotatedZ", "[", 
             RowBox[{
             "eprod1", ",", "eprod3", ",", "MASSM", ",", "MASS1", ",", 
              "MASS2", ",", "MASS3", ",", "\[Theta]randTab", ",", 
              "\[Phi]randTab", ",", "\[Kappa]randTab"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"pxprod3", "=", 
            RowBox[{"p3rotatedX", "[", 
             RowBox[{
             "eprod1", ",", "eprod3", ",", "MASSM", ",", "MASS1", ",", 
              "MASS2", ",", "MASS3", ",", "\[Theta]randTab", ",", 
              "\[Phi]randTab", ",", "\[Kappa]randTab"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"pyprod3", "=", 
            RowBox[{"p3rotatedY", "[", 
             RowBox[{
             "eprod1", ",", "eprod3", ",", "MASSM", ",", "MASS1", ",", 
              "MASS2", ",", "MASS3", ",", "\[Theta]randTab", ",", 
              "\[Phi]randTab", ",", "\[Kappa]randTab"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"pzprod3", "=", 
            RowBox[{"p3rotatedZ", "[", 
             RowBox[{
             "eprod1", ",", "eprod3", ",", "MASSM", ",", "MASS1", ",", 
              "MASS2", ",", "MASS3", ",", "\[Theta]randTab", ",", 
              "\[Phi]randTab", ",", "\[Kappa]randTab"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
            "pxprod1", ",", "pyprod1", ",", "pzprod1", ",", "eprod1", ",", 
             "MASS1", ",", "pdg1", ",", "charge1", ",", "stability1", ",", 
             "pxprod2", ",", "pyprod2", ",", "pzprod2", ",", "eprod2", ",", 
             "MASS2", ",", "pdg2", ",", "charge2", ",", "stability2", ",", 
             "pxprod3", ",", "pyprod3", ",", "pzprod3", ",", "eprod3", ",", 
             "MASS3", ",", "pdg3", ",", "charge3", ",", "stability3"}], 
            "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
        RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
        RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
        RowBox[{"RuntimeAttributes", "\[Rule]", 
         RowBox[{"{", "Listable", "}"}]}]}], "]"}]}], "/.", 
     RowBox[{"ruleDown", "[", 
      RowBox[{"{", 
       RowBox[{
       "p1rotatedX", ",", "p1rotatedY", ",", "p1rotatedZ", ",", "p2rotatedX", 
        ",", "p2rotatedY", ",", "p2rotatedZ", ",", "p3rotatedX", ",", 
        "p3rotatedY", ",", "p3rotatedZ"}], "}"}], "]"}]}], "//", 
    "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "CompiledFunctionTools`"}], "\n", 
 RowBox[{
  RowBox[{"CompilePrint", "@", "tabPS3bodyCompiled"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ThreeBodyDecaysEventsAtRest", "[", 
   RowBox[{
   "particle_", ",", "SpecificDecay_", ",", "mparticle_", ",", "Nevents_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"(*", 
      RowBox[{
      "pdg1", ",", "pdg2", ",", "pdg3", ",", "MASSM", ",", "MASS1", ",", 
       "MASS2", ",", "MASS3", ",", "charge1", ",", "charge2", ",", "charge3", 
       ",", "stability1", ",", "stability2", ",", "stability3", ",", 
       "\[Theta]randTab", ",", "\[Phi]randTab", ",", "\[Kappa]randTab", ",", 
       RowBox[{"(*", 
        RowBox[{"tabRPPS", ",", "weights1", ",", "weights", ","}], "*)"}], 
       "decayproductsset", ",", "weightedData", ",", "edist", ",", 
       "tabPSenergies"}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
      "___", "__"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "Extracting", " ", "information", " ", "about", " ", "the", " ", 
      "decay"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"MASSM", " ", "=", "mparticle"}], ";", "\[IndentingNewLine]", 
     RowBox[{"decayproductsset", "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"LLPlist", ",", "particle"}], "]"}]}], ",", 
          RowBox[{"ListDecayProducts", "[", 
           RowBox[{"particle", ",", "SpecificDecay"}], "]"}], ",", 
          RowBox[{"ListDecayProducts", "[", 
           RowBox[{"particle", ",", "SpecificDecay"}], "]"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"#", "!=", "\"\<Null\>\""}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pdg1", ",", "pdg2", ",", "pdg3"}], "}"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"ParamProductToPDGid", "[", "#", "]"}], "&"}], "/@", 
       "decayproductsset"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"MASS1", ",", "MASS2", ",", "MASS3"}], "}"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"ParamProductMass", "[", "#", "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{"pdg1", ",", "pdg2", ",", "pdg3"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"charge1", ",", "charge2", ",", "charge3"}], "}"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"ParamProductCharge", "[", "#", "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{"pdg1", ",", "pdg2", ",", "pdg3"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"stability1", ",", "stability2", ",", "stability3"}], "}"}], 
      "=", 
      RowBox[{
       RowBox[{
        RowBox[{"ParamProductStability", "[", "#", "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{"pdg1", ",", "pdg2", ",", "pdg3"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "The", " ", "squared", " ", "matrix", " ", "element", " ", "for", " ", 
        "the", " ", "process"}], " ", "-", " ", 
       RowBox[{"to", " ", "compute", " ", "weights"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"distr", "[", 
       RowBox[{"E1_", ",", "E3_"}], "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"LLPlist", ",", "particle"}], "]"}]}], ",", 
        RowBox[{"Msquared3BodySMparticles", "[", 
         RowBox[{
         "particle", ",", "SpecificDecay", ",", "E1", ",", "E3", ",", 
          "MASSM"}], "]"}], ",", 
        RowBox[{"Msquared3BodyLLP", "[", 
         RowBox[{
         "particle", ",", "SpecificDecay", ",", "E1", ",", "E3", ",", 
          "MASSM"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
       "___", "__"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Generating", " ", "the", " ", "true", " ", 
        SubscriptBox["E", "1"]}], ",", 
       RowBox[{
        RowBox[{
         SubscriptBox["E", "3"], " ", "for", " ", "the", " ", "decay", " ", 
         "process", " ", "0"}], "->", 
        RowBox[{"1", "+", "2", "+", "3"}]}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
       "___", "__"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"tabE1E3true", "=", 
      RowBox[{"BlockRandomEnergies", "[", 
       RowBox[{
       "MASSM", ",", "MASS1", ",", "MASS2", ",", "MASS3", ",", "Nevents", ",",
         "distr"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tabPS3bodyCompiled", "[", 
      RowBox[{
      "tabE1E3true", ",", "MASSM", ",", "MASS1", ",", "MASS2", ",", "MASS3", 
       ",", "pdg1", ",", "pdg2", ",", "pdg3", ",", "charge1", ",", "charge2", 
       ",", "charge3", ",", "stability1", ",", "stability2", ",", 
       "stability3"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.8771482864668293`*^9, 3.877148432787933*^9}, {
   3.877148473471039*^9, 3.877148505566575*^9}, {3.87714858617888*^9, 
   3.8771486731504383`*^9}, 3.8771487524720244`*^9, {3.877405290558757*^9, 
   3.877405297125829*^9}, {3.877405395968782*^9, 3.877405396178465*^9}, {
   3.8876941356486297`*^9, 3.887694164390502*^9}, {3.8876987598004103`*^9, 
   3.887698824968381*^9}, {3.887700663818362*^9, 3.8877007022525587`*^9}, {
   3.887700745152567*^9, 3.887700750678418*^9}, {3.8882910895796537`*^9, 
   3.8882911052738256`*^9}, {3.8883057328027363`*^9, 3.888305740308618*^9}, {
   3.889679083171307*^9, 3.889679083961928*^9}, {3.889679956413116*^9, 
   3.8896799622555933`*^9}, {3.8896800105448866`*^9, 
   3.8896800722834816`*^9}, {3.889680185778962*^9, 3.8896802112901306`*^9}, {
   3.8896803052459283`*^9, 3.8896803793362646`*^9}, {3.8896805283470955`*^9, 
   3.8896805325980844`*^9}, {3.8896809101758623`*^9, 
   3.8896809114786153`*^9}, {3.8896813967457194`*^9, 
   3.8896814028814974`*^9}, {3.889685054374817*^9, 3.889685058497769*^9}, {
   3.889685113309169*^9, 3.8896851955972795`*^9}, 3.890371580134336*^9, {
   3.8903722194888573`*^9, 3.890372226587056*^9}, {3.8903722926116333`*^9, 
   3.8903723992400417`*^9}, {3.890383225160221*^9, 3.8903832297596254`*^9}, {
   3.890383447358182*^9, 3.890383462631048*^9}, {3.8914387973632*^9, 
   3.8914388023768005`*^9}, 3.8914470365387554`*^9, {3.891486442699939*^9, 
   3.891486442866702*^9}, {3.8923063809988427`*^9, 3.8923064690940876`*^9}, {
   3.8923101395628347`*^9, 3.892310305427181*^9}, {3.8923117817042713`*^9, 
   3.8923117915473785`*^9}, {3.8923131424659133`*^9, 
   3.8923131949152284`*^9}, {3.8923622634414406`*^9, 3.892362303592141*^9}, 
   3.892362384678219*^9, {3.8923624452682695`*^9, 3.892362445704463*^9}, {
   3.8927872138806143`*^9, 3.892787233990034*^9}, {3.892787280526579*^9, 
   3.892787354195187*^9}, {3.89278741924759*^9, 3.892787419306526*^9}, {
   3.8928288401969175`*^9, 3.8928288873648233`*^9}, {3.8933478546764*^9, 
   3.893347864699074*^9}, {3.8933479047264786`*^9, 3.8933480095677786`*^9}, 
   3.893348052878251*^9, {3.8936626329368196`*^9, 3.8936626332906733`*^9}, {
   3.8936626820499773`*^9, 3.8936627167094355`*^9}, {3.893663406028778*^9, 
   3.893663408968706*^9}, {3.8936634803469152`*^9, 3.893663485618676*^9}, {
   3.893663516592659*^9, 3.8936635188829603`*^9}, {3.8936881478636084`*^9, 
   3.8936881514786077`*^9}, {3.8936883488179073`*^9, 3.893688395825737*^9}, {
   3.893688974861739*^9, 3.8936889907396564`*^9}, {3.893690523567817*^9, 
   3.893690566349781*^9}, {3.893693313948744*^9, 3.8936933998431664`*^9}, {
   3.893697231431654*^9, 3.8936972332788277`*^9}, {3.8936973016230764`*^9, 
   3.89369731629556*^9}, {3.8936973980758276`*^9, 3.8936974120985622`*^9}, {
   3.893697789423275*^9, 3.8936978128243275`*^9}, {3.9037168273494062`*^9, 
   3.90371688301814*^9}, {3.9056217540682983`*^9, 3.9056217565081425`*^9}, {
   3.905622074398405*^9, 3.905622100244545*^9}, {3.905622277318096*^9, 
   3.905622277788639*^9}, {3.9077530613239727`*^9, 3.9077530641653028`*^9}, {
   3.9077556884654465`*^9, 3.9077557235132446`*^9}, {3.9077561960634804`*^9, 
   3.907756203865144*^9}, {3.912097977804348*^9, 3.9120981362832794`*^9}, {
   3.912149585156305*^9, 3.912149585218824*^9}, {3.915008080844187*^9, 
   3.915008085850789*^9}, {3.915012116427006*^9, 3.915012326111449*^9}, {
   3.915436836750819*^9, 3.9154368441169605`*^9}, {3.9154371870824537`*^9, 
   3.9154371871087236`*^9}, {3.915602942468727*^9, 3.9156029645377645`*^9}, {
   3.9156031660189667`*^9, 3.9156031661980114`*^9}, {3.915603668318953*^9, 
   3.915603691339265*^9}, {3.915603799048923*^9, 3.9156038114578557`*^9}, {
   3.9156038454978027`*^9, 3.9156039297879777`*^9}, {3.915603994352642*^9, 
   3.915604122038046*^9}, {3.9156128790322037`*^9, 3.9156128795736184`*^9}, {
   3.915612922664423*^9, 3.91561297885583*^9}, {3.9156130393412504`*^9, 
   3.915613083518366*^9}, {3.9156131373778954`*^9, 3.9156131818697615`*^9}, {
   3.9156132201417475`*^9, 3.915613298103819*^9}, {3.915613696522077*^9, 
   3.9156137355665255`*^9}, {3.916134789686427*^9, 3.9161347900573587`*^9}, {
   3.916135997259259*^9, 3.9161360001191177`*^9}, 3.9161361966517363`*^9, {
   3.9161362452161584`*^9, 3.916136251316471*^9}, {3.916136290851736*^9, 
   3.916136359238652*^9}, {3.9161364064240217`*^9, 3.916136406812236*^9}, {
   3.916136438178587*^9, 3.9161364660056906`*^9}, {3.916136576573244*^9, 
   3.916136614994029*^9}, {3.9161366802976885`*^9, 3.9161366842447186`*^9}, {
   3.9161367440370255`*^9, 3.9161367444082656`*^9}, 3.9161367744926696`*^9, 
   3.916137010705231*^9, {3.916140306931735*^9, 3.916140309149514*^9}, {
   3.916154388984687*^9, 3.9161543963504887`*^9}, 3.9161554092063565`*^9, {
   3.9161556100982065`*^9, 3.9161556733405495`*^9}, 3.9161557221245995`*^9, {
   3.916157782715858*^9, 3.916157789604141*^9}, {3.9161578464479213`*^9, 
   3.9161578536511507`*^9}, {3.9161579639239364`*^9, 3.916157968992462*^9}, {
   3.9161580415223804`*^9, 3.9161580440888157`*^9}, {3.9161593123784065`*^9, 
   3.9161593246801686`*^9}, {3.916160980637367*^9, 3.916160982197858*^9}, {
   3.9161611595562963`*^9, 3.916161165275752*^9}, {3.9161613030056105`*^9, 
   3.916161312025811*^9}, {3.91616143889782*^9, 3.916161447517877*^9}, {
   3.9161632410625525`*^9, 3.9161632497165833`*^9}, 3.9161633532335377`*^9},
 CellTags->"Evaluation",
 CellLabel->
  "In[402]:=",ExpressionUUID->"73ebc8cc-0c82-42c9-97ae-0a5372c43ef4"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Boosts of decay products to lab frame of the decaying particle (for decay \
products of unstable decay products)\
\>", "Subsection",
 CellChangeTimes->{{3.8928243746551504`*^9, 3.892824397583747*^9}, {
  3.8928250253163404`*^9, 3.8928250337728977`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"6ec09f6e-f174-4208-b470-19e7eb773eca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Consider", " ", "the", " ", "data", " ", "for", " ", "mother", " ", 
     "particle"}], ",", " ", 
    RowBox[{"and", " ", "the", " ", "data", " ", "for", " ", "daughter", " ", 
     RowBox[{"particles", ":", " ", 
      RowBox[{
      "the", " ", "block", " ", "below", " ", "evaluates", " ", "boost", " ", 
       "for", " ", "the", " ", "given", " ", "daughter"}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"TabBoostedDecayProductComp", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Hold", "@", 
        RowBox[{"Compile", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"tabmother", ",", "_Real", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"tabdaughters", ",", "_Real", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"daughter", ",", "_Integer"}], "}"}]}], "}"}], ",", 
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "pxmother", ",", "pymother", ",", "pzmother", ",", "Emother", 
              ",", "mmother", ",", "pxdaughter", ",", "pydaughter", ",", 
              "pzdaughter", ",", "Edaughter", ",", 
              RowBox[{"mdaughter", "=", "0."}], ",", 
              RowBox[{"pxboosted", "=", "0."}], ",", 
              RowBox[{"pyboosted", "=", "0."}], ",", 
              RowBox[{"pzboosted", "=", "0."}], ",", 
              RowBox[{"Eboosted", "=", "0."}], ",", "pdgdaughter", ",", 
              RowBox[{"chargedaughter", "=", "0."}], ",", 
              RowBox[{"stabilitydaughter", "=", "0."}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"pdgdaughter", "=", 
              RowBox[{"Compile`GetElement", "[", 
               RowBox[{"tabdaughters", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"daughter", "-", "1"}], ")"}], "*", 
                  "LengthDataProduct"}], "+", "indexpdg1"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"pdgdaughter", "!=", 
                RowBox[{"-", "999."}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"pxmother", "=", 
                 RowBox[{"Compile`GetElement", "[", 
                  RowBox[{"tabmother", ",", "indexpx1"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"pymother", "=", 
                 RowBox[{"Compile`GetElement", "[", 
                  RowBox[{"tabmother", ",", "indexpy1"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"pzmother", "=", 
                 RowBox[{"Compile`GetElement", "[", 
                  RowBox[{"tabmother", ",", "indexpz1"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"Emother", "=", 
                 RowBox[{"Compile`GetElement", "[", 
                  RowBox[{"tabmother", ",", "indexE1"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"mmother", "=", 
                 RowBox[{"Compile`GetElement", "[", 
                  RowBox[{"tabmother", ",", "indexm1"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"pxdaughter", "=", 
                 RowBox[{"Compile`GetElement", "[", 
                  RowBox[{"tabdaughters", ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"daughter", "-", "1"}], ")"}], "*", 
                    "LengthDataProduct"}], "+", "indexpx1"}]}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"pydaughter", "=", 
                 RowBox[{"Compile`GetElement", "[", 
                  RowBox[{"tabdaughters", ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"daughter", "-", "1"}], ")"}], "*", 
                    "LengthDataProduct"}], "+", "indexpy1"}]}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"pzdaughter", "=", 
                 RowBox[{"Compile`GetElement", "[", 
                  RowBox[{"tabdaughters", ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"daughter", "-", "1"}], ")"}], "*", 
                    "LengthDataProduct"}], "+", "indexpz1"}]}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"Edaughter", "=", 
                 RowBox[{"Compile`GetElement", "[", 
                  RowBox[{"tabdaughters", ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"daughter", "-", "1"}], ")"}], "*", 
                    "LengthDataProduct"}], "+", "indexE1"}]}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"mdaughter", "=", 
                 RowBox[{"Compile`GetElement", "[", 
                  RowBox[{"tabdaughters", ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"daughter", "-", "1"}], ")"}], "*", 
                    "LengthDataProduct"}], "+", "indexm1"}]}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"chargedaughter", "=", 
                 RowBox[{"Compile`GetElement", "[", 
                  RowBox[{"tabdaughters", ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"daughter", "-", "1"}], ")"}], "*", 
                    "LengthDataProduct"}], "+", "indexcharge1"}]}], "]"}]}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"stabilitydaughter", "=", 
                 RowBox[{"Compile`GetElement", "[", 
                  RowBox[{"tabdaughters", ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"daughter", "-", "1"}], ")"}], "*", 
                    "LengthDataProduct"}], "+", "indexstability1"}]}], 
                  "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"pxboosted", "=", 
                 RowBox[{"pproductLab1Cart", "[", 
                  RowBox[{
                  "pxmother", ",", "pymother", ",", "pzmother", ",", 
                   "Emother", ",", "mmother", ",", "pxdaughter", ",", 
                   "pydaughter", ",", "pzdaughter", ",", "Edaughter"}], 
                  "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"pyboosted", "=", 
                 RowBox[{"pproductLab2Cart", "[", 
                  RowBox[{
                  "pxmother", ",", "pymother", ",", "pzmother", ",", 
                   "Emother", ",", "mmother", ",", "pxdaughter", ",", 
                   "pydaughter", ",", "pzdaughter", ",", "Edaughter"}], 
                  "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"pzboosted", "=", 
                 RowBox[{"pproductLab3Cart", "[", 
                  RowBox[{
                  "pxmother", ",", "pymother", ",", "pzmother", ",", 
                   "Emother", ",", "mmother", ",", "pxdaughter", ",", 
                   "pydaughter", ",", "pzdaughter", ",", "Edaughter"}], 
                  "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"Eboosted", "=", 
                 RowBox[{"EproductLabCart", "[", 
                  RowBox[{
                  "pxmother", ",", "pymother", ",", "pzmother", ",", 
                   "Emother", ",", "mmother", ",", "pxdaughter", ",", 
                   "pydaughter", ",", "pzdaughter", ",", "Edaughter"}], 
                  "]"}]}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"pxboosted", "=", 
                 RowBox[{"pyboosted", "=", 
                  RowBox[{"pzboosted", "=", 
                   RowBox[{"Eboosted", "=", 
                    RowBox[{"mdaughter", "=", 
                    RowBox[{"pdgdaughter", "=", 
                    RowBox[{"chargedaughter", "=", 
                    RowBox[{"stabilitydaughter", "=", 
                    RowBox[{"-", "999."}]}]}]}]}]}]}]}]}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
              "pxboosted", ",", "pyboosted", ",", "pzboosted", ",", 
               "Eboosted", ",", "mdaughter", ",", "pdgdaughter", ",", 
               "chargedaughter", ",", "stabilitydaughter"}], "}"}]}]}], "]"}],
           ",", 
          RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
          RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
          RowBox[{"RuntimeAttributes", "\[Rule]", 
           RowBox[{"{", "Listable", "}"}]}]}], "]"}]}], "/.", 
       RowBox[{"ruleDown", "[", 
        RowBox[{"{", 
         RowBox[{
         "pproductLab1Cart", ",", "pproductLab2Cart", ",", "pproductLab3Cart",
           ",", "EproductLabCart"}], "}"}], "]"}]}], "/.", 
      RowBox[{"ruleOwn", "[", 
       RowBox[{"{", 
        RowBox[{
        "indexpx1", ",", "indexpy1", ",", "indexpz1", ",", "indexE1", ",", 
         "indexm1", ",", "indexpdg1", ",", "indexcharge1", ",", 
         "indexstability1", ",", "LengthDataProduct"}], "}"}], "]"}]}], "//", 
     "ReleaseHold"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "This", " ", "block", " ", "joins", " ", "the", " ", "boosted", " ", 
     "data", " ", "for", " ", "all", " ", "daughters"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TabBoostedDecayProducts", "[", 
     RowBox[{"tablemother_", ",", "tabledaughters_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"numberdaughters", "=", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"tabledaughters", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "/", 
         "LengthDataProduct"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"TableBoosted", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"TabBoostedDecayProductComp", "[", 
           RowBox[{"tablemother", ",", "tabledaughters", ",", "i"}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "numberdaughters", ",", "1"}], "}"}]}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{"##", ",", "2"}], "]"}], "&"}], "@@", "TableBoosted"}]}]}], 
     "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8928269993910666`*^9, 3.8928270014956923`*^9}, {
  3.8936904886330376`*^9, 3.8936905004284534`*^9}, {3.8936906173560348`*^9, 
  3.8936906841522374`*^9}, {3.9121396483142457`*^9, 3.9121397480327272`*^9}, {
  3.9121397974005594`*^9, 3.9121398007079196`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[412]:=",ExpressionUUID->"cae8fe6a-4f13-485a-8a32-1e66445fa00d"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Phase space of LLP\[CloseCurlyQuote]s decays at its rest frame - 4-body decays\
\>", "Subsection",
 CellChangeTimes->{{3.8896809985063643`*^9, 3.8896810040625315`*^9}, {
   3.8896810441944137`*^9, 3.889681047221568*^9}, {3.892821936878008*^9, 
   3.8928219532696333`*^9}, {3.892822893838851*^9, 3.8928229113675733`*^9}, 
   3.9154371871158543`*^9},
 CellTags->
  "Evaluation",ExpressionUUID->"ccd71674-982a-4dce-b477-7b3be574a83b"],

Cell[CellGroupData[{

Cell["Definitions", "Subsubsection",
 CellChangeTimes->{{3.8928220364284725`*^9, 3.892822038177458*^9}, {
  3.8928229138872695`*^9, 3.8928229153893785`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"c80d0832-b4c4-4436-8443-880f50b08cb7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"The", " ", "idea", " ", 
     RowBox[{"(", 
      RowBox[{
      "following", " ", "\"\<Particle kinematics\>\"", " ", "by", " ", 
       "Byckling", " ", "and", " ", "Kajantie"}], ")"}]}], ":"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Represent", " ", "the", " ", "process", " ", "0"}], "\[Rule]", 
     RowBox[{
      RowBox[{"1", "+", "2", "+", "3", "+", 
       RowBox[{"4", " ", "as", " ", "0"}]}], "\[Rule]", 
      RowBox[{"1", "+", "234"}]}]}], ",", " ", 
    RowBox[{"234", "\[Rule]", 
     RowBox[{"2", "+", "34"}]}], ",", 
    RowBox[{"34", "\[Rule]", 
     RowBox[{"3", "+", "4"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Generate", " ", "the", " ", "random", " ", "\"\<masses\>\"", " ", 
     SubscriptBox["m", "234"]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["m", "34"], " ", "with", " ", "the", " ", "weight", " ", 
      "being", " ", "the", " ", "jacobian", " ", "of", " ", "the", " ", 
      "phase", " ", "space", " ", "represented", " ", "via", " ", "these", 
      " ", "subsequent", " ", "2"}], "-", 
     RowBox[{"body", " ", "decays"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Generate", " ", "the", " ", "phase", " ", "space", " ", "of", " ", 
      "these", " ", "2"}], "-", 
     RowBox[{"body", " ", "decays", " ", "at", " ", "rest"}]}], ",", " ", 
    RowBox[{
    "and", " ", "then", " ", "boost", " ", "it", " ", "by", " ", "the", " ", 
     "momentum", " ", "of", " ", "the", " ", "decaying", " ", 
     "\"\<particle\>\"", " ", "in", " ", "its", " ", "lab", " ", "frame"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"nVectorParticlesIntermediateComp", "=", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Theta]vals", ",", "_Real"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Phi]vals", ",", "_Real"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"MassMatrix", ",", "_Real", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"StabilityMatrix", ",", "_Real", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"ChargeMatrix", ",", "_Real", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"PDGMatrix", ",", "_Real", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"ival", ",", "_Integer"}], "}"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "pmod", ",", "m0val", ",", "m1val", ",", "m2val", ",", "E1val", ",",
            "E2val", ",", "px1", ",", "px2", ",", "py1", ",", "py2", ",", 
           "pz1", ",", "pz2", ",", "stability1", ",", "stability2", ",", 
           "charge1", ",", "charge2", ",", "pdg1", ",", "pdg2"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"m0val", "=", 
           RowBox[{"Compile`GetElement", "[", 
            RowBox[{"MassMatrix", ",", 
             RowBox[{
              RowBox[{"2", "*", 
               RowBox[{"(", 
                RowBox[{"ival", "-", "1"}], ")"}]}], "+", "1"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"m1val", "=", 
           RowBox[{"Compile`GetElement", "[", 
            RowBox[{"MassMatrix", ",", 
             RowBox[{
              RowBox[{"2", "*", 
               RowBox[{"(", 
                RowBox[{"ival", "-", "1"}], ")"}]}], "+", "2"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"m2val", "=", 
           RowBox[{"Compile`GetElement", "[", 
            RowBox[{"MassMatrix", ",", 
             RowBox[{
              RowBox[{"2", "*", 
               RowBox[{"(", 
                RowBox[{"ival", "-", "1"}], ")"}]}], "+", "3"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"stability1", "=", 
           RowBox[{"StabilityMatrix", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"2", "*", 
               RowBox[{"(", 
                RowBox[{"ival", "-", "1"}], ")"}]}], "+", "1"}], "]"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"stability2", "=", 
           RowBox[{"StabilityMatrix", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"2", "*", 
               RowBox[{"(", 
                RowBox[{"ival", "-", "1"}], ")"}]}], "+", "2"}], "]"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"charge1", "=", 
           RowBox[{"ChargeMatrix", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"2", "*", 
               RowBox[{"(", 
                RowBox[{"ival", "-", "1"}], ")"}]}], "+", "1"}], "]"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"charge2", "=", 
           RowBox[{"ChargeMatrix", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"2", "*", 
               RowBox[{"(", 
                RowBox[{"ival", "-", "1"}], ")"}]}], "+", "2"}], "]"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"pdg1", "=", 
           RowBox[{"PDGMatrix", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"2", "*", 
               RowBox[{"(", 
                RowBox[{"ival", "-", "1"}], ")"}]}], "+", "1"}], "]"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"pdg2", "=", 
           RowBox[{"PDGMatrix", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"2", "*", 
               RowBox[{"(", 
                RowBox[{"ival", "-", "1"}], ")"}]}], "+", "2"}], "]"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"E1val", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["m0val", "2"], "+", 
              SuperscriptBox["m1val", "2"], "-", 
              SuperscriptBox["m2val", "2"]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"2", "m0val"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"E2val", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["m0val", "2"], "-", 
              SuperscriptBox["m1val", "2"], "+", 
              SuperscriptBox["m2val", "2"]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"2", "m0val"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"pmod", "=", 
           RowBox[{"\[Sqrt]", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["E1val", "2"], "-", 
              SuperscriptBox["m1val", "2"]}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"px1", "=", 
           RowBox[{"pmod", "*", 
            RowBox[{"Sin", "[", "\[Theta]vals", "]"}], "*", 
            RowBox[{"Cos", "[", "\[Phi]vals", "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"px2", "=", 
           RowBox[{"-", "px1"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"py1", "=", 
           RowBox[{"pmod", "*", 
            RowBox[{"Sin", "[", "\[Theta]vals", "]"}], "*", 
            RowBox[{"Sin", "[", "\[Phi]vals", "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"py2", "=", 
           RowBox[{"-", "py1"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"pz1", "=", 
           RowBox[{"pmod", "*", 
            RowBox[{"Cos", "[", "\[Theta]vals", "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"pz2", "=", 
           RowBox[{"-", "pz1"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
           "px1", ",", "py1", ",", "pz1", ",", "E1val", ",", "m1val", ",", 
            "pdg1", ",", "charge1", ",", "stability1", ",", "px2", ",", "py2",
             ",", "pz2", ",", "E2val", ",", "m2val", ",", "pdg2", ",", 
            "charge2", ",", "stability2"}], "}"}]}]}], "\[IndentingNewLine]", 
        "]"}], ",", 
       RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
       RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
       RowBox[{"RuntimeAttributes", "\[Rule]", 
        RowBox[{"{", "Listable", "}"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nVectorParticlesIntermediate", "[", 
     RowBox[{
     "MassMatrix_", ",", "StabilityMatrix_", ",", "ChargeMatrix_", ",", 
      "PDGMatrix_", ",", "ival_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Theta]vals", ",", "\[Phi]vals"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Theta]vals", "=", 
        RowBox[{"ArcCos", "[", 
         RowBox[{"RandomReal", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
           RowBox[{"Length", "[", "MassMatrix", "]"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Phi]vals", "=", 
        RowBox[{"RandomReal", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], ",", 
          RowBox[{"Length", "[", "MassMatrix", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nVectorParticlesIntermediateComp", "[", 
        RowBox[{
        "\[Theta]vals", ",", "\[Phi]vals", ",", "MassMatrix", ",", 
         "StabilityMatrix", ",", "ChargeMatrix", ",", "PDGMatrix", ",", 
         "ival"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Block", " ", "computing", " ", "random", " ", "masses"}], "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Lambda]f", "[", 
      RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], "=", 
     RowBox[{
      SuperscriptBox["a", "2"], "+", 
      SuperscriptBox["b", "2"], "+", 
      SuperscriptBox["c", "2"], "-", 
      RowBox[{"2", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", "*", "b"}], "+", 
         RowBox[{"b", "*", "c"}], "+", 
         RowBox[{"a", "*", "c"}]}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Jacobian4body", "[", 
      RowBox[{
      "m_", ",", "m1_", ",", "m2_", ",", "m3_", ",", "m4_", ",", "m234_", ",",
        "m34_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"(", 
       FractionBox[
        SqrtBox[
         RowBox[{"\[Lambda]f", "[", 
          RowBox[{
           SuperscriptBox["m", "2"], ",", 
           SuperscriptBox["m1", "2"], ",", 
           SuperscriptBox["m234", "2"]}], "]"}]], 
        RowBox[{"2", "m"}]], ")"}], 
      RowBox[{"(", 
       FractionBox[
        SqrtBox[
         RowBox[{"\[Lambda]f", "[", 
          RowBox[{
           SuperscriptBox["m234", "2"], ",", 
           SuperscriptBox["m2", "2"], ",", 
           SuperscriptBox["m34", "2"]}], "]"}]], 
        RowBox[{"2", "m234"}]], ")"}], 
      RowBox[{"(", 
       FractionBox[
        SqrtBox[
         RowBox[{"\[Lambda]f", "[", 
          RowBox[{
           SuperscriptBox["m34", "2"], ",", 
           SuperscriptBox["m3", "2"], ",", 
           SuperscriptBox["m4", "2"]}], "]"}]], 
        RowBox[{"2", "m34"}]], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"BlockFalseRandomMasses", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", ",", "m1", ",", "m2", ",", "m3", ",", "m4", ",", 
        RowBox[{"{", 
         RowBox[{"Nevents", ",", "_Integer"}], "}"}]}], "}"}], ",", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"m234list", ",", "m34list"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m234list", "=", 
          RowBox[{"RandomReal", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"m2", "+", "m3", "+", "m4"}], ",", 
              RowBox[{"m", "-", "m1"}]}], "}"}], ",", "Nevents"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"m34list", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"m3", "+", "m4"}], ",", 
               RowBox[{
                RowBox[{"m234list", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "-", "m2"}]}], "}"}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "m234list", "]"}], ",", "1"}], "}"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"m234list", ",", "m34list"}], "}"}], "//", 
          "Transpose"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
      RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
      RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"WeightsComp", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Hold", "@", 
       RowBox[{"Compile", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"m", ",", "m1", ",", "m2", ",", "m3", ",", "m4", ",", 
           RowBox[{"{", 
            RowBox[{"falserandmass", ",", "_Real", ",", "1"}], "}"}]}], "}"}],
          ",", "\[IndentingNewLine]", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"m234", ",", "m34"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"m234", "=", 
             RowBox[{"Compile`GetElement", "[", 
              RowBox[{"falserandmass", ",", "1"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"m34", "=", 
             RowBox[{"Compile`GetElement", "[", 
              RowBox[{"falserandmass", ",", "2"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"m234", "-", "m2", "-", "m3", "-", "m4"}], ")"}], 
             RowBox[{"Jacobian4body", "[", 
              RowBox[{
              "m", ",", "m1", ",", "m2", ",", "m3", ",", "m4", ",", "m234", 
               ",", "m34"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ",", 
         RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
         RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
         RowBox[{"Parallelization", "->", "True"}], ",", 
         RowBox[{"RuntimeAttributes", "->", 
          RowBox[{"{", "Listable", "}"}]}]}], "]"}]}], "/.", 
      RowBox[{"ruleDown", "[", 
       RowBox[{"{", "Jacobian4body", "}"}], "]"}]}], "//", "ReleaseHold"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockTrueRandomMasses", "[", 
     RowBox[{
     "m_", ",", "m1_", ",", "m2_", ",", "m3_", ",", "m4_", ",", "Nevents_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "FalseRandMasses", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NN", "=", 
        SuperscriptBox["10", "5"]}], ";", "\[IndentingNewLine]", 
       RowBox[{"FalseRandMasses", "=", 
        RowBox[{"BlockFalseRandomMasses", "[", 
         RowBox[{"m", ",", "m1", ",", "m2", ",", "m3", ",", "m4", ",", "NN"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"WeightsVals", "=", 
        RowBox[{"WeightsComp", "[", 
         RowBox[{
         "m", ",", "m1", ",", "m2", ",", "m3", ",", "m4", ",", 
          "FalseRandMasses"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Weighted", " ", "random", " ", "points"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"weightedData", "=", 
          RowBox[{"WeightedData", "[", 
           RowBox[{"FalseRandMasses", ",", "WeightsVals"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"True", " ", "random", " ", 
           RowBox[{"energies", ".", " ", "Computed"}], " ", "via", " ", 
           "empirical", " ", "distribution", " ", "from", " ", "the", " ", 
           "weigthed", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"edist", "=", 
          RowBox[{"EmpiricalDistribution", "[", "weightedData", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tabMasses", "=", 
          RowBox[{"RandomVariate", "[", 
           RowBox[{"edist", ",", "Nevents"}], "]"}]}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"tabMasses", "=", 
        RowBox[{"RandomChoice", "[", 
         RowBox[{
          RowBox[{"WeightsVals", "->", "FalseRandMasses"}], ",", "Nevents"}], 
         "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8928229459274297`*^9, 3.8928231140865407`*^9}, {
  3.8928237027715197`*^9, 3.8928237203407784`*^9}, {3.892823796301366*^9, 
  3.8928239628178263`*^9}, {3.8928240794677286`*^9, 3.8928242002796664`*^9}, {
  3.892824937352701*^9, 3.8928249391260147`*^9}, {3.892827131142872*^9, 
  3.892827142254938*^9}, {3.8928281659226713`*^9, 3.8928281678349085`*^9}, {
  3.8928283724191017`*^9, 3.892828384754986*^9}, {3.8928285964788666`*^9, 
  3.892828654894505*^9}, {3.892828710001687*^9, 3.892828787580044*^9}, {
  3.892828825391675*^9, 3.892828825525365*^9}, {3.916126649164712*^9, 
  3.916126806527561*^9}, {3.9161269771861925`*^9, 3.916126999388183*^9}, {
  3.9161273848381853`*^9, 3.9161274203984475`*^9}, {3.9161593491590605`*^9, 
  3.9161593561922445`*^9}, {3.9161610081358595`*^9, 3.9161610087174244`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[414]:=",ExpressionUUID->"d0b3ce53-04c8-4ffd-ba51-534597a958ca"]
}, Closed]],

Cell[CellGroupData[{

Cell["Final block producing phase space", "Subsubsection",
 CellChangeTimes->{{3.8928229417684107`*^9, 3.892822942070283*^9}, {
  3.892827781047364*^9, 3.8928277927015176`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"f1346d6a-8d30-4a82-b412-0b558a2cb0f5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FourBodyDecaysEventsAtRest", "[", 
   RowBox[{
   "m_", ",", "product1_", ",", "product2_", ",", "product3_", ",", 
    "product4_", ",", "Nevents_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "List", " ", "of", " ", "pdg", " ", "products", " ", "involving", " ", 
      "in", " ", "the", " ", 
      RowBox[{"decay", ".", " ", "The"}], " ", "\"\<Intermediate\>\"", " ", 
      "products", " ", "correspond", " ", "to", " ", "the", " ", "fake", " ", 
      "234", " ", "and", " ", "34", " ", "particles"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"pdglist", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ParamProductToPDGid", "[", "product1", "]"}], ",", 
        RowBox[{"ParamProductToPDGid", "[", "\"\<Intermediate\>\"", "]"}], 
        ",", 
        RowBox[{"ParamProductToPDGid", "[", "product2", "]"}], ",", 
        RowBox[{"ParamProductToPDGid", "[", "\"\<Intermediate\>\"", "]"}], 
        ",", 
        RowBox[{"ParamProductToPDGid", "[", "product3", "]"}], ",", 
        RowBox[{"ParamProductToPDGid", "[", "product4", "]"}]}], "}"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Masses", ",", " ", 
       RowBox[{"electric", " ", "charges"}], ",", " ", 
       RowBox[{
       "and", " ", "stabilities", " ", "of", " ", "true", " ", "decay", " ", 
        "products"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"finalproductmasses", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"ParamProductMass", "[", "#", "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"pdglist", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"pdglist", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{"pdglist", "[", 
          RowBox[{"[", "5", "]"}], "]"}], ",", 
         RowBox[{"pdglist", "[", 
          RowBox[{"[", "6", "]"}], "]"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"qlist", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"ParamProductCharge", "[", "#", "]"}], "&"}], "/@", 
       "pdglist"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"stabilitylist", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"ParamProductStability", "[", "#", "]"}], "&"}], "/@", 
       "pdglist"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Values", " ", "of", " ", "invariant", " ", "masses", " ", 
        SubscriptBox["m", "234"]}], ",", " ", 
       SubscriptBox["m", "34"]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"randommasses", "=", 
      RowBox[{"BlockTrueRandomMasses", "[", 
       RowBox[{"m", ",", 
        RowBox[{"finalproductmasses", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"finalproductmasses", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"finalproductmasses", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", 
        RowBox[{"finalproductmasses", "[", 
         RowBox[{"[", "4", "]"}], "]"}], ",", "Nevents"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"The", " ", "matrix", " ", "m"}], ",", " ", 
       SubscriptBox["m", "product1"], ",", 
       SubscriptBox["m", "234"], ",", 
       SubscriptBox["m", "product2"], ",", 
       SubscriptBox["m", "34"], ",", 
       SubscriptBox["m", "product3"], ",", 
       SubscriptBox["m", "product4"]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"mmatrix", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"m", ",", 
            RowBox[{"finalproductmasses", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", "Nevents"}], "]"}],
         ",", 
        RowBox[{"randommasses", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", "1", "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"finalproductmasses", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "}"}], ",", "Nevents"}], "]"}], 
        ",", 
        RowBox[{"randommasses", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"finalproductmasses", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", 
            RowBox[{"finalproductmasses", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", "Nevents"}], "]"}],
         ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{
        "Producing", " ", "the", " ", "phase", " ", "space", " ", "of", " ", 
         "fake", " ", "2"}], "-", 
        RowBox[{"body", " ", "decays", " ", "234"}]}], "->", 
       RowBox[{
        RowBox[{"2", "+", 
         RowBox[{"34", " ", "and", " ", "34"}]}], "->", 
        RowBox[{"3", "+", 
         RowBox[{
         "4", " ", "at", " ", "rest", " ", "of", " ", "234", " ", "and", " ", 
          "34"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"phasespacerest", "[", "ival", "]"}], "=", 
        RowBox[{"nVectorParticlesIntermediate", "[", 
         RowBox[{
         "mmatrix", ",", "stabilitylist", ",", "qlist", ",", "pdglist", ",", 
          "ival"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"ival", ",", "1", ",", "3", ",", "1"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Boosting", " ", "them", " ", "according", " ", "to", " ", "the", " ", 
       "lab", " ", "frames"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"phasespaceboosted2", "=", 
      RowBox[{"TabBoostedDecayProducts", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"phasespacerest", "[", "1", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"LengthDataProduct", "+", 
            RowBox[{"Range", "[", 
             RowBox[{"1", ",", "LengthDataProduct"}], "]"}]}]}], "]"}], "]"}],
         ",", 
        RowBox[{"phasespacerest", "[", "2", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"phasespaceboosted3", "=", 
      RowBox[{"TabBoostedDecayProducts", "[", 
       RowBox[{
        RowBox[{"phasespaceboosted2", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"LengthDataProduct", "+", 
            RowBox[{"Range", "[", 
             RowBox[{"1", ",", "LengthDataProduct"}], "]"}]}]}], "]"}], "]"}],
         ",", 
        RowBox[{"phasespacerest", "[", "3", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"phasespacerest", "[", "1", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", "LengthDataProduct"}], "]"}]}], "]"}], "]"}], 
       ",", 
       RowBox[{"phasespaceboosted2", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", "LengthDataProduct"}], "]"}]}], "]"}], "]"}], 
       ",", "phasespaceboosted3", ",", "2"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{
  3.892822094060907*^9, {3.8928222573471985`*^9, 3.8928222938912797`*^9}, {
   3.8928225899578075`*^9, 3.8928228273275976`*^9}, {3.8928231639640007`*^9, 
   3.8928231803232417`*^9}, {3.8928232619212523`*^9, 
   3.8928233384958878`*^9}, {3.8928233721380205`*^9, 3.892823662875577*^9}, {
   3.8928240369852176`*^9, 3.8928240638237314`*^9}, {3.8928242280402436`*^9, 
   3.892824309458559*^9}, {3.892824431393654*^9, 3.892824479247761*^9}, {
   3.8928245314917526`*^9, 3.892824578933576*^9}, {3.89282539019839*^9, 
   3.8928253997776875`*^9}, {3.8928254343070464`*^9, 3.892825501610352*^9}, {
   3.8928262303140693`*^9, 3.8928262844328785`*^9}, {3.89282665609322*^9, 
   3.8928266830803576`*^9}, {3.8928270226056356`*^9, 3.892827030913838*^9}, 
   3.8928271300835094`*^9, 3.8928277944729805`*^9, {3.892828112515127*^9, 
   3.892828115598604*^9}, {3.8928723169870086`*^9, 3.892872317137663*^9}, {
   3.916127097067466*^9, 3.91612715868806*^9}, {3.9161274638912697`*^9, 
   3.916127589208093*^9}, {3.9161556101071978`*^9, 3.9161556733478794`*^9}, 
   3.9161557221301346`*^9},
 CellTags->"Evaluation",
 CellLabel->
  "In[421]:=",ExpressionUUID->"0c3f67ee-8861-4425-8b36-f6be673a16f5"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Phase space of STABLE LLP\[CloseCurlyQuote]s decay products - overall \
definition\
\>", "Subsection",
 CellChangeTimes->{{3.8896810686474667`*^9, 3.8896810893992004`*^9}, 
   3.889681420224794*^9, 3.915437187122603*^9},
 CellTags->
  "Evaluation",ExpressionUUID->"767de7a6-fe87-42e9-aac1-27c33f88badb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"topology", "[", "2", "]"}], ",", 
     RowBox[{"topology", "[", "3", "]"}], ",", 
     RowBox[{"topology", "[", "4", "]"}]}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"\"\<2-body\>\"", ",", "\"\<3-body\>\"", ",", "\"\<4-body\>\""}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NeventsSplitted", "[", 
   RowBox[{"Nev_", ",", "\[Omega]list_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NevTemp", "=", 
      RowBox[{"IntegerPart", "[", 
       FractionBox[
        RowBox[{"Nev", "*", "\[Omega]list"}], 
        RowBox[{"\[Omega]list", "//", "Total"}]], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PosMax", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"NevTemp", ",", 
          RowBox[{"Max", "[", "NevTemp", "]"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"NevTemp", "[", 
       RowBox[{"[", "PosMax", "]"}], "]"}], "+=", 
      RowBox[{"Nev", "-", 
       RowBox[{"Total", "[", "NevTemp", "]"}]}]}], ";", "\[IndentingNewLine]",
      "NevTemp"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "PhaseSpaceStableFromUnstableBlock", "[", "DataUnstableAtLLPrestFrame_", 
   "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"pdgprod", "=", 
      RowBox[{
       RowBox[{"DataUnstableAtLLPrestFrame", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "indexpdg1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"massUnstableDecayProduct", "=", 
      RowBox[{
       RowBox[{"DataUnstableAtLLPrestFrame", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "indexm1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"UnstableDecayProduct", "=", 
      RowBox[{"ParamPDGidToProduct", "[", "pdgprod", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"DecProcList", "=", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"ListSMdecays", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "==", "UnstableDecayProduct"}], 
          "&"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DecProdList", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"ListDecayProducts", "[", 
         RowBox[{"UnstableDecayProduct", ",", "#"}], "]"}], "&"}], "/@", 
       "DecProcList"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]list", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Omega]process", "[", 
         RowBox[{"UnstableDecayProduct", ",", "#"}], "]"}], "&"}], "/@", 
       "DecProcList"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TopologyList", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"topology", "[", 
         RowBox[{"Length", "[", 
          RowBox[{"Select", "[", 
           RowBox[{"#", ",", 
            RowBox[{
             RowBox[{"#", "\[NotEqual]", "\"\<Null\>\""}], "&"}]}], "]"}], 
          "]"}], "]"}], "&"}], "/@", "DecProdList"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NevList", "=", 
      RowBox[{"NeventsSplitted", "[", 
       RowBox[{
        RowBox[{"Length", "[", "DataUnstableAtLLPrestFrame", "]"}], ",", 
        "\[Omega]list"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"UnstableDecayProductSplitted", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"UnstableDecayProduct", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "\[Omega]list", "]"}], ",", "1"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"phasespace", "=", 
      RowBox[{"{", 
       RowBox[{"{", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"NevList", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "!=", "0."}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"PhaseSpaceUnstableToStableAtUnstableRest", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"TopologyList", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<3-body\>\""}],
              ",", 
             RowBox[{"ThreeBodyDecaysEventsAtRest", "[", 
              RowBox[{"UnstableDecayProduct", ",", 
               RowBox[{"DecProcList", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               "massUnstableDecayProduct", ",", 
               RowBox[{"NevList", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"Block2BodyDistrAtRest", "[", 
              RowBox[{"massUnstableDecayProduct", ",", 
               RowBox[{
                RowBox[{"DecProdList", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"DecProdList", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"NevList", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"phasespace", "=", 
           RowBox[{"Join", "[", 
            RowBox[{
            "phasespace", ",", "PhaseSpaceUnstableToStableAtUnstableRest"}], 
            "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "\[Omega]list", "]"}], ",", "1"}], "}"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"phasespace", "=", 
      RowBox[{
       RowBox[{"Drop", "[", 
        RowBox[{
         RowBox[{"PadRight", "[", 
          RowBox[{"phasespace", ",", "Automatic", ",", 
           RowBox[{"-", "999."}]}], "]"}], ",", "1"}], "]"}], "//", 
       "Developer`ToPackedArray"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TabBoostedDecayProducts", "[", 
      RowBox[{"DataUnstableAtLLPrestFrame", ",", 
       RowBox[{"RandomSample", "[", "phasespace", "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"DecayProductsList", "=", 
      RowBox[{"ListDecayProducts", "[", 
       RowBox[{"UnstableDecayProduct", ",", "SpecificProcessUnstable"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Topology", "=", 
      RowBox[{"topology", "[", 
       RowBox[{"Length", "[", 
        RowBox[{"Select", "[", 
         RowBox[{"DecayProductsList", ",", 
          RowBox[{
           RowBox[{"#", "\[NotEqual]", "\"\<Null\>\""}], "&"}]}], "]"}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"PhaseSpaceUnstableToStableAtUnstableRest", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Topology", "\[Equal]", "\"\<3-body\>\""}], ",", 
        RowBox[{"ThreeBodyDecaysEventsAtRest", "[", 
         RowBox[{
         "UnstableDecayProduct", ",", "SpecificProcessUnstable", ",", 
          "massUnstableDecayProduct", ",", "Nevents"}], "]"}], ",", 
        RowBox[{"Block2BodyDistrAtRest", "[", 
         RowBox[{"massUnstableDecayProduct", ",", 
          RowBox[{"DecayProductsList", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"DecayProductsList", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", "Nevents"}], "]"}]}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"TabBoostedDecayProducts", "[", 
      RowBox[{
      "DataUnstableAtLLPrestFrame", ",", 
       "PhaseSpaceUnstableToStableAtUnstableRest"}], "]"}]}], "*)"}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{
  3.9120981810942307`*^9, {3.912098723234372*^9, 3.912098945323427*^9}, {
   3.912098991853141*^9, 3.9120989930042286`*^9}, {3.91209941165335*^9, 
   3.9120994198434525`*^9}, {3.912099791074767*^9, 3.9120997950565977`*^9}, {
   3.91209995670325*^9, 3.9121000725257235`*^9}, {3.912100103313548*^9, 
   3.9121001211247077`*^9}, {3.9121003475863533`*^9, 3.912100369400236*^9}, {
   3.9121004001225977`*^9, 3.912100410904463*^9}, {3.912101078414239*^9, 
   3.9121011014951773`*^9}, {3.9121390077788963`*^9, 
   3.9121390561168995`*^9}, {3.9121392538691607`*^9, 3.912139254035003*^9}, {
   3.9121393447654037`*^9, 3.9121393739746747`*^9}, {3.91213946996723*^9, 
   3.912139475696269*^9}, {3.912139531068428*^9, 3.912139561378518*^9}, 
   3.9121449884334354`*^9, {3.914092032326936*^9, 3.9140920884568233`*^9}, {
   3.9140922120812426`*^9, 3.9140922137155647`*^9}, {3.9145764117946205`*^9, 
   3.9145764313517*^9}, {3.915437187128587*^9, 3.9154371871500854`*^9}, 
   3.9161556361586957`*^9, {3.916161663506551*^9, 3.916161665393705*^9}, {
   3.9161633532426453`*^9, 3.9161633532466974`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[422]:=",ExpressionUUID->"bf53e5ee-6d16-4c02-ac99-4a87fde0b0b1"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9161616128000097`*^9, 3.9161616185079446`*^9}},
 CellLabel->
  "In[421]:=",ExpressionUUID->"550d49f1-0a99-4018-a419-0d4800eda25b"],

Cell[CellGroupData[{

Cell["Final table", "Subsubsection",
 CellChangeTimes->{{3.8896811226502504`*^9, 3.889681124051056*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"30824934-976f-4630-812a-81efbb81d158"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "code", " ", "checking", " ", "whether", " ", "the", " ", 
    "given", " ", "phase", " ", "space", " ", "contains", " ", "unstable", 
    " ", "particles"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"stabilitycheck", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Hold", "@", 
        RowBox[{"Compile", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"data", ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"len", "=", 
               RowBox[{
                RowBox[{"Length", "[", "data", "]"}], "/", 
                "LengthDataProduct"}]}], ",", 
              RowBox[{"stabval", "=", "1."}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Do", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"stabval", "=", 
                 RowBox[{"Boole", "[", 
                  RowBox[{"!", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"data", ",", 
                    RowBox[{
                    RowBox[{"LengthDataProduct", "*", 
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}]}], "+", 
                    "indexstability1"}]}], "]"}], "==", "0."}], ")"}]}], 
                  "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"stabval", "==", "0."}], ",", 
                  RowBox[{"Break", "[", "]"}]}], "]"}], ";"}], 
               "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "len", ",", "1"}], "}"}]}], "]"}],
              ";", "\[IndentingNewLine]", "stabval"}]}], 
           "\[IndentingNewLine]", "]"}], ",", 
          RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
          RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
          RowBox[{"RuntimeAttributes", "->", 
           RowBox[{"{", "Listable", "}"}]}], ",", 
          RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], "/.", 
       RowBox[{"ruleOwn", "[", 
        RowBox[{"{", 
         RowBox[{"LengthDataProduct", ",", "indexstability1"}], "}"}], 
        "]"}]}], "//", "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"<<", "CompiledFunctionTools`"}], "\n", 
   RowBox[{
    RowBox[{"CompilePrint", "@", "stabilitycheck"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Code", " ", "that", " ", "takes", " ", "the", " ", "given", " ", "set", 
     " ", "of", " ", "columns", " ", "corresponding", " ", "to", " ", "ith", 
     " ", "decay", " ", "product", " ", "and", " ", "splits", " ", "it", " ", 
     "onto", " ", "distinguish", " ", "decay", " ", "produts", " ", 
     "different", " ", "by", " ", "pdg"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PhaseSpaceSplitter", "[", "phasespace_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"grouped", ",", "lengths", ",", "positions", ",", "ranges"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pdgs", "=", 
        RowBox[{"phasespace", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "indexpdg1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Grouping", " ", "consecutive", " ", "identical", " ", "elements"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"grouped", "=", 
        RowBox[{"Split", "[", "pdgs", "]"}]}], ";", "\n", 
       RowBox[{"(*", 
        RowBox[{
        "Calculating", " ", "the", " ", "lengths", " ", "of", " ", "each", 
         " ", "group"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"lengths", "=", 
        RowBox[{"Length", "/@", "grouped"}]}], ";", "\n", 
       RowBox[{"(*", 
        RowBox[{"Generating", " ", "the", " ", "start", " ", "positions"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"positions", "=", 
        RowBox[{"Accumulate", "[", 
         RowBox[{"Prepend", "[", 
          RowBox[{"lengths", ",", "0"}], "]"}], "]"}]}], ";", "\n", 
       RowBox[{"(*", 
        RowBox[{"Forming", " ", "ranges"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"ranges", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Most", "[", "positions", "]"}], "+", "1"}], ",", 
           RowBox[{
            RowBox[{"Most", "[", "positions", "]"}], "+", "lengths"}]}], 
          "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Take", "[", 
          RowBox[{"phasespace", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], "&"}], "/@", 
        "ranges"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "The", " ", "code", " ", "that", " ", "goes", " ", "over", " ", "all", 
     " ", "rows", " ", "of", " ", "the", " ", "given", " ", "phase", " ", 
     "space", " ", "and", " ", "extracts"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Phase", " ", "space", " ", "of", " ", "the", " ", "STABLE", " ", 
      "decay", " ", "products", " ", 
      SubscriptBox["product", "1"]}], ",", " ", 
     RowBox[{
      RowBox[{
       SubscriptBox["product", "2"], " ", "from", " ", "the", " ", "process", 
       " ", "LLP"}], " ", "\[Rule]", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["product", "1"], " ", "+", " ", 
         SubscriptBox["product", "2"], " ", "+"}], " ", "..."}], " ", "at", 
       " ", "the", " ", "LLP", " ", "rest", " ", "frame"}]}]}], "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
    "The", " ", "phase", " ", "space", " ", "is", " ", "in", " ", "the", " ", 
     "form", " ", "of", " ", "the", " ", "following", " ", 
     RowBox[{"columns", ":", " ", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["\[Theta]", "product"], ",", " ", 
        SubscriptBox["\[Phi]", "product"], ",", " ", 
        SubscriptBox["E", "product"], ",", " ", 
        SubscriptBox["m", "product"], ",", " ", 
        SubscriptBox["pdg", "product"], ",", " ", 
        SubscriptBox["Q", 
         RowBox[{"EM", ",", "product"}]], ",", 
        SubscriptBox["stability", "product"]}], "}"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PhaseSpaceDecaysRest", "[", 
     RowBox[{"LLP_", ",", "mLLP_", ",", "SpecificProcess_", ",", "Nevents_"}],
      "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"List", " ", "of", " ", "the", " ", "decay", " ", "products"}],
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"productslist", "=", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"ListDecayProducts", "[", 
           RowBox[{"LLP", ",", "SpecificProcess"}], "]"}], ",", 
          RowBox[{
           RowBox[{"#", "\[NotEqual]", "\"\<Null\>\""}], "&"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Topology", " ", "of", " ", "the", " ", "decay", " ", 
          RowBox[{"process", ":", " ", 
           RowBox[{"2", "-"}]}]}], ",", " ", 
         RowBox[{"3", "-"}], ",", " ", 
         RowBox[{
          RowBox[{"or", " ", "4"}], "-", 
          RowBox[{"body", " ", "decay"}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Topology", "=", 
        RowBox[{"topology", "[", 
         RowBox[{"Length", "[", "productslist", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Phase", " ", "space", " ", "of", " ", "the", " ", "decay", " ", 
          "products", " ", "of", " ", 
          RowBox[{"LLP", ".", " ", "At"}], " ", "this", " ", "stage"}], ",", 
         " ", 
         RowBox[{
         "one", " ", "may", " ", "have", " ", "ustable", " ", "decay", " ", 
          "products"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"decayProducts1", "=", 
        RowBox[{"decayProductsTemp", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Topology", "\[Equal]", "\"\<3-body\>\""}], ",", 
           RowBox[{"ThreeBodyDecaysEventsAtRest", "[", 
            RowBox[{
            "LLP", ",", "SpecificProcess", ",", "mLLP", ",", "Nevents"}], 
            "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"Topology", "\[Equal]", "\"\<2-body\>\""}], ",", 
             RowBox[{"Block2BodyDistrAtRest", "[", 
              RowBox[{"mLLP", ",", 
               RowBox[{"productslist", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"productslist", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "Nevents"}], "]"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"Topology", "\[Equal]", "\"\<4-body\>\""}], ",", 
               RowBox[{"FourBodyDecaysEventsAtRest", "[", 
                RowBox[{"mLLP", ",", 
                 RowBox[{"productslist", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"productslist", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"productslist", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], ",", 
                 RowBox[{"productslist", "[", 
                  RowBox[{"[", "4", "]"}], "]"}], ",", "Nevents"}], "]"}]}], 
              "]"}]}], "]"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "The", " ", "iterative", " ", "routine", " ", "that", " ", "checks", 
          " ", "if", " ", "there", " ", "are", " ", "some", " ", "unstable", 
          " ", "products"}], ",", " ", 
         RowBox[{
          RowBox[{"if", " ", "yes"}], " ", "-", " ", 
          RowBox[{"decays", " ", "them"}]}], ",", " ", 
         RowBox[{
         "and", " ", "defines", " ", "the", " ", "updated", " ", "phase", " ",
           "space"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Times", "@@", 
           RowBox[{"stabilitycheck", "[", "decayProductsTemp", "]"}]}], "==", 
          "0."}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"lenprod", "=", 
           FractionBox[
            RowBox[{"Length", "[", 
             RowBox[{"decayProductsTemp", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "LengthDataProduct"]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "Extracting", " ", "the", " ", "phase", " ", "space", " ", "of", 
             " ", "ith", " ", "decay", " ", "product"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"phasespaceproduct", "=", 
              RowBox[{"decayProductsTemp", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", 
                 RowBox[{"Range", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"LengthDataProduct", "*", 
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}]}], "+", "1"}], ",", 
                   RowBox[{"LengthDataProduct", "*", "i"}]}], "]"}]}], "]"}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "Check", " ", "if", " ", "there", " ", "are", " ", "unstable", 
               " ", "particles", " ", "among", " ", "it"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"stab", "=", 
              RowBox[{"Times", "@@", 
               RowBox[{"stabilitycheck", "[", "phasespaceproduct", "]"}]}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"If", " ", "yes"}], ",", " ", 
               RowBox[{
                RowBox[{
                "then", " ", "split", " ", "it", " ", "into", " ", "sub"}], 
                "-", 
                RowBox[{
                "spaces", " ", "of", " ", "different", " ", "products"}]}], 
               ",", " ", 
               RowBox[{"decay", " ", "unstable", " ", "particles"}], ",", " ", 
               RowBox[{"then", " ", "join", " ", "it"}]}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"stab", "==", "0."}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"phasespacesplit", "=", 
                 RowBox[{
                 "PhaseSpaceSplitter", "[", "phasespaceproduct", "]"}]}], ";",
                 "\[IndentingNewLine]", 
                RowBox[{"Do", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"phasespacesplit", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "indexstability1", "]"}], "]"}], "==", 
                    "0."}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"phasespacesplit", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "=", 
                    RowBox[{"PhaseSpaceStableFromUnstableBlock", "[", 
                    RowBox[{"phasespacesplit", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ";"}]}], 
                   "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
                  RowBox[{"{", 
                   RowBox[{"j", ",", "1", ",", 
                    RowBox[{"Length", "[", "phasespacesplit", "]"}]}], 
                   "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"phasespaceproduct", "=", 
                 RowBox[{
                  RowBox[{"PadRight", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Join", "[", "##", "]"}], "&"}], "@@", 
                    "phasespacesplit"}], ",", "Automatic", ",", 
                    RowBox[{"-", "999."}]}], "]"}], "//", 
                  "Developer`ToPackedArray"}]}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"phasespacefin", "[", "i", "]"}], "=", 
              "phasespaceproduct"}], ";"}], "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "lenprod", ",", "1"}], "}"}]}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"decayProductsTemp", "=", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{"##", ",", "2"}], "]"}], "&"}], "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"phasespacefin", "[", "#", "]"}], "&"}], "/@", 
               RowBox[{"Range", "[", 
                RowBox[{"1", ",", "lenprod"}], "]"}]}], ")"}]}], "//", 
            "Developer`ToPackedArray"}]}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "decayProductsTemp"}]}], 
     "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.888303630227687*^9, 3.8883036389946194`*^9}, {
   3.88830374496181*^9, 3.8883038035288196`*^9}, {3.8883048689222994`*^9, 
   3.8883049271677876`*^9}, {3.8883049824736423`*^9, 3.888304982687086*^9}, {
   3.888305312881075*^9, 3.888305455019803*^9}, {3.888305544223571*^9, 
   3.8883055929370966`*^9}, {3.8883056531968594`*^9, 
   3.8883056871652985`*^9}, {3.888306006071501*^9, 3.8883060591569023`*^9}, 
   3.888306363751378*^9, {3.888306507495531*^9, 3.8883066218258505`*^9}, {
   3.888306670018731*^9, 3.888306722002021*^9}, {3.888306769480568*^9, 
   3.888306828861915*^9}, {3.8883382942296224`*^9, 3.8883383104059286`*^9}, {
   3.8896734691664944`*^9, 3.889673483623483*^9}, {3.889673726925458*^9, 
   3.889673726928449*^9}, {3.889673927167289*^9, 3.8896739271829104`*^9}, {
   3.8896743706540976`*^9, 3.8896743791304626`*^9}, {3.889674911547965*^9, 
   3.889675021642789*^9}, {3.8896788661099863`*^9, 3.8896789170590343`*^9}, {
   3.8896790459971447`*^9, 3.8896790467494183`*^9}, {3.8896811703159056`*^9, 
   3.889681374043635*^9}, {3.889686387101871*^9, 3.8896864782094765`*^9}, {
   3.890369481752099*^9, 3.890369482053258*^9}, {3.890370001570159*^9, 
   3.890370001863677*^9}, {3.8903704182823243`*^9, 3.8903704390055037`*^9}, 
   3.890370778321101*^9, {3.8903710312940907`*^9, 3.890371048973277*^9}, 
   3.8903722355673895`*^9, 3.890372302904091*^9, {3.890372501081995*^9, 
   3.890372509448707*^9}, {3.8903725500273743`*^9, 3.890372596214924*^9}, {
   3.8903765016532507`*^9, 3.8903765513301544`*^9}, {3.8903766119640636`*^9, 
   3.8903766327827616`*^9}, {3.890377026743435*^9, 3.890377031093351*^9}, 
   3.89037709836462*^9, {3.8903772479803333`*^9, 3.8903772604286723`*^9}, {
   3.8903798950182004`*^9, 3.8903798982675877`*^9}, {3.890379938914705*^9, 
   3.8903800019224033`*^9}, {3.890380039299224*^9, 3.8903800575416546`*^9}, {
   3.890380124802503*^9, 3.8903802442492666`*^9}, 3.8903804210126886`*^9, 
   3.8903805211775093`*^9, {3.8903805930045147`*^9, 3.8903805934019465`*^9}, {
   3.8903827829478245`*^9, 3.8903827871465206`*^9}, {3.8903836242708654`*^9, 
   3.890383644314272*^9}, {3.8903840567079134`*^9, 3.8903840730316896`*^9}, {
   3.8904740323264384`*^9, 3.8904740324402122`*^9}, {3.8914451208191557`*^9, 
   3.891445128871797*^9}, {3.89144515961036*^9, 3.8914452044475756`*^9}, {
   3.8914453425930996`*^9, 3.891445342950641*^9}, {3.891447540234254*^9, 
   3.891447611086487*^9}, {3.891447688868253*^9, 3.891447723202778*^9}, {
   3.8914497449214587`*^9, 3.891449796147089*^9}, {3.891449839748249*^9, 
   3.8914498724807973`*^9}, {3.8914503887836294`*^9, 3.891450390978138*^9}, {
   3.8914506047026167`*^9, 3.8914508111390457`*^9}, {3.8914508575652103`*^9, 
   3.8914508887321434`*^9}, {3.891450983682513*^9, 3.8914511116465216`*^9}, 
   3.8914512647092724`*^9, 3.8914514723533907`*^9, {3.89145154059704*^9, 
   3.891451593603885*^9}, {3.8914516518376074`*^9, 3.8914516526394415`*^9}, {
   3.891451727027312*^9, 3.891451814070984*^9}, {3.891451852288156*^9, 
   3.8914519810391903`*^9}, {3.8914536723113313`*^9, 3.891453672473798*^9}, {
   3.8914839786778154`*^9, 3.891483984920882*^9}, {3.8914840425264807`*^9, 
   3.8914840632661304`*^9}, {3.8914873498737583`*^9, 
   3.8914873516059074`*^9}, {3.891487563413627*^9, 3.8914875693418436`*^9}, {
   3.892306322904023*^9, 3.892306332806356*^9}, {3.892310602511617*^9, 
   3.8923106591473923`*^9}, {3.8923626897374268`*^9, 3.892362694663982*^9}, {
   3.892362725532401*^9, 3.8923630058833747`*^9}, {3.892788681014801*^9, 
   3.892788681655691*^9}, {3.892788921986883*^9, 3.8927889270676937`*^9}, {
   3.8928714978763037`*^9, 3.8928717251092663`*^9}, {3.8928718068804817`*^9, 
   3.892871820305153*^9}, {3.8928718988159637`*^9, 3.8928719017178745`*^9}, {
   3.893348339407822*^9, 3.893348352216549*^9}, {3.893348408547392*^9, 
   3.8933485230623198`*^9}, 3.8933486743374057`*^9, {3.8933489823765726`*^9, 
   3.893348987471447*^9}, {3.893349082200691*^9, 3.893349084130561*^9}, {
   3.893435186107499*^9, 3.8934351862281337`*^9}, 3.89430182010982*^9, {
   3.897021294872501*^9, 3.897021328101615*^9}, {3.8970213831056275`*^9, 
   3.8970213880810075`*^9}, {3.8970216393910203`*^9, 
   3.8970216524110856`*^9}, {3.8970228854855804`*^9, 3.897022947679715*^9}, {
   3.8970236851756744`*^9, 3.8970237264628983`*^9}, 3.8971482217978706`*^9, 
   3.9121450035126905`*^9, {3.912145529793799*^9, 3.912145589301611*^9}, {
   3.9145734651706567`*^9, 3.9145734946388445`*^9}, {3.915002272357435*^9, 
   3.9150024248468266`*^9}, {3.915435518997305*^9, 3.9154355195437765`*^9}, {
   3.915437187159133*^9, 3.9154371872186155`*^9}, {3.915604636124818*^9, 
   3.9156046361973505`*^9}, {3.9156047811499023`*^9, 3.91560479311464*^9}, 
   3.916155409215537*^9, 3.9161564545887594`*^9, {3.9161564911963415`*^9, 
   3.916156494784129*^9}, {3.916162843016532*^9, 3.91616285274424*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[425]:=",ExpressionUUID->"bcfeaf0d-fb4d-43f5-b592-deff52e89a57"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Phase space of decay products - pre-simulated in pythia (for decays into jets)\
\>", "Section",
 CellChangeTimes->{{3.8896808751910667`*^9, 3.8896808925929117`*^9}, {
  3.8896810405865717`*^9, 3.889681040711938*^9}, {3.8928219291767955`*^9, 
  3.8928219311819687`*^9}, {3.9017176077887716`*^9, 3.9017176348990297`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"814d7fb1-92f2-48b0-8a43-c1cc7700a07e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"filespathsPS", "=", 
   RowBox[{"FileNames", "[", 
    RowBox[{"\"\<*.m\>\"", ",", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<simulated phase space\>\""}], "}"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filenamesPS", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Last", "@", 
      RowBox[{"FileNameSplit", "@", 
       RowBox[{"filespathsPS", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "filespathsPS", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filenameparametersPS", "[", "i_", "]"}], ":=", 
  RowBox[{
   RowBox[{"StringCases", "[", 
    RowBox[{
     RowBox[{"filenamesPS", "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{
      "fip__", "~~", "\"\<_\>\"", "~~", "process__", "~~", "\"\<_\>\"", "~~", 
       "mass__", "~~", "\"\<.m\>\""}], ":>", 
      RowBox[{"{", 
       RowBox[{"fip", ",", "process", ",", "mass"}], "}"}]}]}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"filenamesparametersPS", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"filenameparametersPS", "[", "i", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "filenamesPS", "]"}], ",", "1"}], "}"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Phase", " ", 
     RowBox[{"space", ".", " ", "It"}], " ", "has", " ", "the", " ", "form", 
     " ", "of", " ", 
     RowBox[{"rows", ".", " ", "Each"}], " ", 
     RowBox[{"row", ":", " ", 
      RowBox[{
      "the", " ", "occurrence", " ", "rate", " ", "of", " ", "the", " ", 
       "given", " ", "final", " ", "state"}]}]}], ",", " ", 
    RowBox[{"the", " ", "final", " ", "state", " ", "phase", " ", "space"}]}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PhaseSpaceDecaysRestJets", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"filenamesparametersPS", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"filenamesparametersPS", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"filenamesparametersPS", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "//", "ToExpression"}], "//", 
        "N"}]}], "]"}], "=", 
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", 
          "\"\<simulated phase space\>\"", ",", 
          RowBox[{"filenamesPS", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "}"}], "]"}], ",", 
       "\"\<MX\>\""}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "filenamesPS", "]"}], ",", "1"}], "}"}]}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ParsBL", "=", 
    RowBox[{"Select", "[", 
     RowBox[{"filenamesparametersPS", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "==", "\"\<B-L\>\""}], "&"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"For", " ", "the", " ", "moment"}], ",", " ", 
    RowBox[{
     RowBox[{"for", " ", "B"}], " ", "-", " ", 
     RowBox[{"XX", " ", "mediators"}]}], ",", " ", 
    RowBox[{
    "the", " ", "decay", " ", "products", " ", "sets", " ", "are", " ", "the",
      " ", "same", " ", "as", " ", "for", " ", "dark", " ", "photons"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"PhaseSpaceDecaysRestJets", "[", 
       RowBox[{"fip", ",", 
        RowBox[{
         RowBox[{"ParsBL", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"ParsBL", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], "//", "ToExpression"}], "//", 
         "N"}]}], "]"}], "=", 
      RowBox[{"PhaseSpaceDecaysRestJets", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ParsBL", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"ParsBL", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"ParsBL", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], "//", "ToExpression"}], "//", 
         "N"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"fip", ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<B-3Lmu\>\"", ",", "\"\<B-3Le-Lmu+Ltau\>\"", ",", 
        "\"\<B-Le-3Lmu+Ltau\>\""}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "ParsBL", "]"}], ",", "1"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Jet", " ", "decays", " ", "of", " ", "ALPs", " ", "coupled", " ", "to", 
     " ", "fermions", " ", "and", " ", "gluons", " ", "are", " ", "the", " ", 
     "same"}], " ", "-", " ", 
    RowBox[{"into", " ", "two", " ", 
     RowBox[{"gluons", ".", " ", "So"}], " ", "the", " ", "phase", " ", 
     "space", " ", "is", " ", "the", " ", "same"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ParsALPg", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"filenamesparametersPS", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "==", "\"\<ALP-gluon\>\""}], "&"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"PhaseSpaceDecaysRestJets", "[", 
        RowBox[{"\"\<ALP-fermion\>\"", ",", 
         RowBox[{
          RowBox[{"ParsALPg", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ParsALPg", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "//", "ToExpression"}], "//", 
          "N"}]}], "]"}], "=", 
       RowBox[{"PhaseSpaceDecaysRestJets", "[", 
        RowBox[{"\"\<ALP-gluon\>\"", ",", 
         RowBox[{
          RowBox[{"ParsALPg", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ParsALPg", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "//", "ToExpression"}], "//", 
          "N"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"fip", ",", 
       RowBox[{"{", "\"\<ALP-fermion\>\"", "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "ParsALPg", "]"}], ",", "1"}], "}"}]}], "]"}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Range", " ", "of", " ", "masses", " ", "for", " ", "which", " ", "the", 
    " ", "phase", " ", "space", " ", "of", " ", "decays", " ", "into", " ", 
    "jets", " ", "has", " ", "been", " ", "simulated"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"mjetsrange", "[", "LLP", "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{"filenamesparametersPS", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "==", "LLP"}], "&"}]}], "]"}], 
         "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "3"}], "]"}], "]"}], "//", "ToExpression"}], "//",
        "N"}], "//", "Sort"}], "//", "DeleteDuplicates"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"LLP", ",", "LLPlist"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mjetsrange", "[", "\"\<HNL-mixing-mu\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"mjetsrange", "[", "\"\<HNL-mixing-tau\>\"", "]"}], "=", 
    RowBox[{"mjetsrange", "[", "\"\<HNL-mixing-e\>\"", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mjetsrange", "[", "\"\<ALP-fermion\>\"", "]"}], "=", 
   RowBox[{"mjetsrange", "[", "\"\<ALP-gluon\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mjetsrange", "[", "\"\<B-3Lmu\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"mjetsrange", "[", "\"\<B-3Le-Lmu+Ltau\>\"", "]"}], "=", 
    RowBox[{
     RowBox[{"mjetsrange", "[", "\"\<B-Le-3Lmu+Ltau\>\"", "]"}], "=", 
     RowBox[{"mjetsrange", "[", "\"\<B-L\>\"", "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ParsHNLe", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"filenamesparametersPS", ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "==", "\"\<HNL-mixing-e\>\""}], "&&", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "==", "\"\<Jets-qqv\>\""}]}], 
      "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"PhaseSpaceDecaysRestJets", "[", 
       RowBox[{"fip", ",", 
        RowBox[{
         RowBox[{"ParsHNLe", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"ParsHNLe", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], "//", "ToExpression"}], "//", 
         "N"}]}], "]"}], "=", 
      RowBox[{"PhaseSpaceDecaysRestJets", "[", 
       RowBox[{"\"\<HNL-mixing-e\>\"", ",", 
        RowBox[{
         RowBox[{"ParsHNLe", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"ParsHNLe", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], "//", "ToExpression"}], "//", 
         "N"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"fip", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<HNL-mixing-mu\>\"", ",", "\"\<HNL-mixing-tau\>\""}], 
       "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "ParsHNLe", "]"}], ",", "1"}], "}"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9017176486347523`*^9, 3.901717703758829*^9}, {
   3.9017177592455387`*^9, 3.9017178756278844`*^9}, {3.9017179156004972`*^9, 
   3.901717945662857*^9}, {3.901718848335392*^9, 3.901719048923184*^9}, {
   3.901719095805599*^9, 3.901719099117838*^9}, {3.901719164029812*^9, 
   3.9017191891106105`*^9}, {3.901719221702965*^9, 3.9017192571933155`*^9}, {
   3.9017193162248125`*^9, 3.9017193285221925`*^9}, {3.90171936612361*^9, 
   3.9017193872887883`*^9}, {3.901719870319647*^9, 3.90171991141413*^9}, {
   3.9017206146064463`*^9, 3.9017206196800056`*^9}, {3.9017229841487923`*^9, 
   3.901722985768695*^9}, {3.901723023831119*^9, 3.901723026481138*^9}, {
   3.9017256303389874`*^9, 3.901725634485656*^9}, {3.9017261005653973`*^9, 
   3.9017261054686174`*^9}, 3.9017301956217823`*^9, {3.9017302484813375`*^9, 
   3.9017302520193014`*^9}, {3.902906969666185*^9, 3.9029069775969477`*^9}, {
   3.902907009246908*^9, 3.9029070096441965`*^9}, {3.902907049765814*^9, 
   3.902907088284941*^9}, {3.903716595966509*^9, 3.9037167686510525`*^9}, {
   3.904058177570426*^9, 3.9040584120686383`*^9}, {3.9040586761071887`*^9, 
   3.904058680802782*^9}, {3.904060538230318*^9, 3.904060538416854*^9}, {
   3.9040688954630585`*^9, 3.904069021070495*^9}, {3.9048999997478495`*^9, 
   3.9049000148965316`*^9}, {3.9119857831288757`*^9, 
   3.9119857927644434`*^9}, {3.9119858555866613`*^9, 
   3.9119858602139053`*^9}, {3.912622886361326*^9, 3.9126228911222963`*^9}, {
   3.915125802493534*^9, 3.915125804991832*^9}, {3.9154355190121994`*^9, 
   3.915435519032879*^9}, {3.91543718722563*^9, 3.9154371872356205`*^9}, {
   3.916156453934334*^9, 3.916156453960458*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[430]:=",ExpressionUUID->"bcaf1bfd-2d1a-48e4-a12d-d60d4ae88bf8"]
}, Closed]],

Cell[CellGroupData[{

Cell["Tests", "Section",
 CellChangeTimes->{{3.893435181497083*^9, 3.8934352008778505`*^9}, {
  3.915602756007701*^9, 
  3.9156027586677685`*^9}},ExpressionUUID->"e8837524-4ca5-4360-824e-\
de6b194116aa"],

Cell[CellGroupData[{

Cell["\<\
1. Checking if the angle between two massless decay products obtain from \
simulation matches theoretical formula\
\>", "Subsection",
 CellChangeTimes->{{3.915602739167885*^9, 3.9156027575095024`*^9}, 
   3.915614297415024*^9},ExpressionUUID->"2af514f8-1732-4afc-8c66-\
81ce161893f8"],

Cell[BoxData[{
 RowBox[{"Print", "[", "\"\<Decay products of LLP for test:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"DecayTypeTest", "=", "\"\<e-pair\>\""}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<LLP mass for test:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"MassParticleTest", "=", "4."}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LengthTest", "=", 
   SuperscriptBox["10", "4"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ff", "=", 
   RowBox[{"PhaseSpaceDecaysRest", "[", 
    RowBox[{
    "\"\<Scalar\>\"", ",", "MassParticleTest", ",", "DecayTypeTest", ",", 
     "LengthTest"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BoostedDataTest", "[", "ELLP_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Theta]vals", "=", 
      RowBox[{"ArcCos", "[", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "LengthTest"}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Phi]vals", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], ",", "LengthTest"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"SpherePointsTemp", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]vals", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "*", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]vals", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]vals", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "*", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]vals", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]vals", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "LengthTest", ",", "1"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Sqrt]", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["ELLP", "2"], "-", 
              SuperscriptBox["MassParticleTest", "2"]}], ")"}]}], 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"\[Sqrt]", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["ELLP", "2"], "-", 
              SuperscriptBox["MassParticleTest", "2"]}], ")"}]}], 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"\[Sqrt]", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["ELLP", "2"], "-", 
              SuperscriptBox["MassParticleTest", "2"]}], ")"}]}], 
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], ",", "ELLP", ",", 
          "MassParticleTest"}], "}"}], "&"}], "/@", "SpherePointsTemp"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<LLP energy for test:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ELLPtest", "=", "18"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BoostedDataTestGivenE", "=", 
   RowBox[{"BoostedDataTest", "[", "ELLPtest", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BoostedDecayProductsTest", "=", 
    RowBox[{"TabBoostedDecayProducts", "[", 
     RowBox[{"BoostedDataTestGivenE", ",", "ff"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Block", " ", "computing", " ", "angle", " ", "between", " ", "two", " ", 
     "decay", " ", "products", " ", "for", " ", "the", " ", "given", " ", 
     "LLP", " ", "energy"}], ",", " ", 
    RowBox[{"and", " ", 
     RowBox[{"polar", "/", "azimuthal"}], " ", "angles", " ", "at", " ", 
     "lab", " ", "frame"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ttt1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ArcCos", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"BoostedDecayProductsTest", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "indexpx1", "]"}], "]"}], "*", 
          RowBox[{
           RowBox[{"BoostedDecayProductsTest", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"LengthDataProduct", "+", "indexpx1"}], "]"}], "]"}]}], 
         "+", 
         RowBox[{
          RowBox[{
           RowBox[{"BoostedDecayProductsTest", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "indexpy1", "]"}], "]"}], "*", 
          RowBox[{
           RowBox[{"BoostedDecayProductsTest", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"LengthDataProduct", "+", "indexpy1"}], "]"}], "]"}]}], 
         "+", 
         RowBox[{
          RowBox[{
           RowBox[{"BoostedDecayProductsTest", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "indexpz1", "]"}], "]"}], "*", 
          RowBox[{
           RowBox[{"BoostedDecayProductsTest", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"LengthDataProduct", "+", "indexpz1"}], "]"}], "]"}]}]}], 
        ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Sqrt]", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{
              RowBox[{"BoostedDecayProductsTest", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "indexE1", "]"}], "]"}], "2"], "-", 
            SuperscriptBox[
             RowBox[{
              RowBox[{"BoostedDecayProductsTest", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "indexm1", "]"}], "]"}], "2"]}], ")"}]}], 
         RowBox[{"\[Sqrt]", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{
              RowBox[{"BoostedDecayProductsTest", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"LengthDataProduct", "+", "indexE1"}], "]"}], "]"}], 
             "2"], "-", 
            SuperscriptBox[
             RowBox[{
              RowBox[{"BoostedDecayProductsTest", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"LengthDataProduct", "+", "indexm1"}], "]"}], "]"}], 
             "2"]}], ")"}]}]}], ")"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "BoostedDecayProductsTest", "]"}], ",", "1"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Histogram", "[", "ttt1", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<Min value of the angle \!\(\*SubscriptBox[\(\[Theta]\), \(product1, \
product2\)]\) between 2 decay products - simulation:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Min", "[", "ttt1", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<Min value of \[Theta] between 2 decay products - theory:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cos\[Theta]extr", "[", 
    RowBox[{"E1_", ",", "ELLP_"}], "]"}], "=", 
   RowBox[{"cos\[Theta]", "/.", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        SuperscriptBox["mfip", "2"], "\[Equal]", 
        RowBox[{"2", "*", "E1", "*", 
         RowBox[{"(", 
          RowBox[{"ELLP", "-", "E1"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", "cos\[Theta]"}], ")"}]}]}], ",", "cos\[Theta]"}], 
      "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"E1extr", "[", "ELLP_", "]"}], "=", 
   RowBox[{"E1", "/.", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"cos\[Theta]extr", "[", 
           RowBox[{"E1", ",", "ELLP"}], "]"}], ",", "E1"}], "]"}], "\[Equal]",
         "0"}], ",", "E1"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]min2body", "[", 
   RowBox[{"ELLP_", ",", "mfip_"}], "]"}], "=", 
  RowBox[{"ArcCos", "[", 
   RowBox[{"cos\[Theta]extr", "[", 
    RowBox[{
     RowBox[{"E1extr", "[", "ELLP", "]"}], ",", "ELLP"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"\[Theta]min2body", "[", 
  RowBox[{"ELLPtest", ",", "MassParticleTest"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", 
  RowBox[{
  "ELLPtest", ",", "MassParticleTest", ",", "ParamProductMass1", ",", 
   "ParamProductMass2", ",", "ff"}], "]"}]}], "Input",
 CellChangeTimes->{{3.91214561351001*^9, 3.9121456208088408`*^9}, 
   3.915435519057745*^9, {3.9154371872416267`*^9, 3.9154371872881436`*^9}, {
   3.9156030077492647`*^9, 3.915603011459241*^9}, {3.91615567336014*^9, 
   3.9161556733631334`*^9}, 3.9161564539644475`*^9},
 CellLabel->
  "In[444]:=",ExpressionUUID->"0ab4eec2-4623-4a8f-a973-5af265b84315"]
}, Closed]],

Cell[CellGroupData[{

Cell["2. Checking that kinematics for 3-body decays ", "Subsection",
 CellChangeTimes->{{3.9156027484195037`*^9, 3.9156027738977313`*^9}, {
   3.9156029213292646`*^9, 3.9156029227444296`*^9}, 
   3.9156047994299755`*^9},ExpressionUUID->"aa1bcfc7-a5b2-4039-9454-\
cdbe3e913053"],

Cell[CellGroupData[{

Cell["Shape of the energy distributions matches analytic formula", \
"Subsubsection",
 CellChangeTimes->{{3.9156048046648865`*^9, 3.9156048093327074`*^9}, {
  3.916156523687786*^9, 
  3.916156529374568*^9}},ExpressionUUID->"61882765-010a-481c-b0ed-\
98c76793df40"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fipt", "=", "\"\<HNL-mixing-e\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"proct", "=", "\"\<ee\[Nu]\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mass", "=", "0.02"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"decprodlist", "=", 
   RowBox[{"ListDecayProducts", "[", 
    RowBox[{"fipt", ",", "proct"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pdgsDecayProd", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ParamProductToPDGid", "[", "#", "]"}], "&"}], "/@", 
    "decprodlist"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"massesProd", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ParamProductMass", "[", "#", "]"}], "&"}], "/@", 
    "pdgsDecayProd"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phasespace", "=", 
   RowBox[{"PhaseSpaceDecaysRest", "[", 
    RowBox[{"fipt", ",", "mass", ",", "proct", ",", 
     SuperscriptBox["10", "6"]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"distr1", "[", 
    RowBox[{"mLLP_", ",", "E1_", ",", "E3_"}], "]"}], "=", 
   RowBox[{"Msquared3BodyLLP", "[", 
    RowBox[{"fipt", ",", "proct", ",", "E1", ",", "E3", ",", " ", "mLLP"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"endistr1", "[", 
    RowBox[{"mLLP_", ",", "E1_"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Integrate", "[", 
        RowBox[{
         RowBox[{"distr1", "[", 
          RowBox[{"mLLP", ",", "E1", ",", "E3"}], "]"}], ",", "E3"}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{"E3", "->", 
         RowBox[{
          RowBox[{"E3domain", "[", 
           RowBox[{"E1", ",", "mLLP", ",", 
            RowBox[{"massesProd", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"massesProd", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"massesProd", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ")"}], "-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Integrate", "[", 
        RowBox[{
         RowBox[{"distr1", "[", 
          RowBox[{"mLLP", ",", "E1", ",", "E3"}], "]"}], ",", "E3"}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{"E3", "->", 
         RowBox[{
          RowBox[{"E3domain", "[", 
           RowBox[{"E1", ",", "mLLP", ",", 
            RowBox[{"massesProd", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"massesProd", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"massesProd", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ")"}]}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"endistr3", "[", 
    RowBox[{"mLLP_", ",", "E3_"}], "]"}], "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Integrate", "[", 
         RowBox[{
          RowBox[{"distr1", "[", 
           RowBox[{"mLLP", ",", "E1", ",", "E3"}], "]"}], ",", "E1"}], "]"}], 
        "/.", 
        RowBox[{"{", 
         RowBox[{"E1", "->", 
          RowBox[{"E1domain1Max", "[", 
           RowBox[{"E3", ",", "mLLP", ",", 
            RowBox[{"massesProd", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"massesProd", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"massesProd", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "}"}]}], ")"}], "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Integrate", "[", 
         RowBox[{
          RowBox[{"distr1", "[", 
           RowBox[{"mLLP", ",", "E1", ",", "E3"}], "]"}], ",", "E1"}], "]"}], 
        "/.", 
        RowBox[{"{", 
         RowBox[{"E1", "->", 
          RowBox[{"E1domain1Min", "[", 
           RowBox[{"E3", ",", "mLLP", ",", 
            RowBox[{"massesProd", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"massesProd", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"massesProd", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "}"}]}], ")"}]}], "//",
      "Simplify"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"norm", "=", 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{"endistr1", "[", 
      RowBox[{"mass", ",", "E1"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"E1", ",", 
       RowBox[{
        RowBox[{"E1domain", "[", 
         RowBox[{"mass", ",", 
          RowBox[{"massesProd", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"massesProd", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"massesProd", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"E1domain", "[", 
         RowBox[{"mass", ",", 
          RowBox[{"massesProd", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"massesProd", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"massesProd", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pt1", "=", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"LogLogPlot", "[", 
      RowBox[{
       RowBox[{"1.2", 
        FractionBox[
         RowBox[{"endistr1", "[", 
          RowBox[{"mass", ",", "E1"}], "]"}], "norm"]}], ",", 
       RowBox[{"{", 
        RowBox[{"E1", ",", 
         RowBox[{
          RowBox[{"E1domain", "[", 
           RowBox[{"mass", ",", 
            RowBox[{"massesProd", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"massesProd", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"massesProd", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"E1domain", "[", 
           RowBox[{"mass", ",", 
            RowBox[{"massesProd", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"massesProd", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"massesProd", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"Histogram", "[", 
      RowBox[{
       RowBox[{"phasespace", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "indexE1"}], "]"}], "]"}], ",", "1000", ",", 
       "\"\<ProbabilityDensity\>\"", ",", 
       RowBox[{"ScalingFunctions", "->", 
        RowBox[{"{", 
         RowBox[{"\"\<Log\>\"", ",", "\"\<Log\>\""}], "}"}]}]}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pt2", "=", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"LogLogPlot", "[", 
      RowBox[{
       RowBox[{"1.2", 
        FractionBox[
         RowBox[{"endistr3", "[", 
          RowBox[{"mass", ",", "E3"}], "]"}], "norm"]}], ",", 
       RowBox[{"{", 
        RowBox[{"E3", ",", 
         RowBox[{
          RowBox[{"E3domain1", "[", 
           RowBox[{"mass", ",", 
            RowBox[{"massesProd", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"massesProd", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"massesProd", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"E3domain1", "[", 
           RowBox[{"mass", ",", 
            RowBox[{"massesProd", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"massesProd", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"massesProd", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"Histogram", "[", 
      RowBox[{
       RowBox[{"phasespace", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"2", "*", "LengthDataProduct"}], "+", "indexE1"}]}], "]"}],
         "]"}], ",", "1000", ",", "\"\<ProbabilityDensity\>\"", ",", 
       RowBox[{"ScalingFunctions", "->", 
        RowBox[{"{", 
         RowBox[{"\"\<Log\>\"", ",", "\"\<Log\>\""}], "}"}]}]}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Style", "[", 
  RowBox[{
   RowBox[{"Row", "[", 
    RowBox[{"{", 
     RowBox[{"pt1", ",", "pt2"}], "}"}], "]"}], ",", 
   RowBox[{"ImageSizeMultipliers", "->", 
    RowBox[{"{", 
     RowBox[{"1", ",", " ", "1"}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.9156027826480055`*^9, 3.9156028385791936`*^9}, {
   3.9156029032577705`*^9, 3.915602916507677*^9}, {3.9156138744525676`*^9, 
   3.9156138847584553`*^9}, {3.9156139208851595`*^9, 3.915613937461957*^9}, {
   3.915613973073371*^9, 3.915613994399492*^9}, {3.915614674783802*^9, 
   3.9156146932856054`*^9}, {3.9161542771299615`*^9, 
   3.9161543438421545`*^9}, {3.9161545968844137`*^9, 3.916154742484935*^9}, {
   3.916155522167564*^9, 3.9161556222898207`*^9}, {3.916155755007023*^9, 
   3.916155810004404*^9}, {3.9161558536573105`*^9, 3.9161558818764086`*^9}, 
   3.916156453970446*^9, {3.9161612116376696`*^9, 3.916161212776281*^9}},
 CellLabel->
  "In[465]:=",ExpressionUUID->"e9575ec7-8957-46f5-9392-94ae279455de"]
}, Closed]],

Cell[CellGroupData[{

Cell["4-momentum conservation", "Subsubsection",
 CellChangeTimes->{{3.915604814731948*^9, 
  3.9156048185513678`*^9}},ExpressionUUID->"53e815d1-a87d-4529-917e-\
ce06f846a8ea"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fiptest", "=", "\"\<HNL-mixing-tau\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"proctest", "=", "\"\<Jets-qql\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"masstest", "=", "2.3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pd", "=", 
    RowBox[{"PhaseSpaceDecaysRest", "[", 
     RowBox[{"fiptest", ",", "masstest", ",", "proctest", ",", "10"}], 
     "]"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fourcheck", "[", "j_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"pd", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"LengthDataProduct", "*", 
             RowBox[{"(", 
              RowBox[{"i", "-", "1"}], ")"}]}], "+", "indexpdg1"}], "]"}], 
          "]"}], "!=", 
         RowBox[{"-", "999."}]}], ",", 
        RowBox[{
         RowBox[{"pd", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"LengthDataProduct", "*", 
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}]}], "+", "#"}], "]"}], "]"}], ",", 
        "0."}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        FractionBox[
         RowBox[{"Length", "[", 
          RowBox[{"pd", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "LengthDataProduct"], ",", 
        "1"}], "}"}]}], "]"}], "&"}], "/@", 
   RowBox[{"{", 
    RowBox[{"indexpx1", ",", "indexpy1", ",", "indexpz1", ",", "indexE1"}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"fourcheck", "[", "j", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "1", ",", 
     RowBox[{"Length", "[", "pd", "]"}], ",", "1"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{3.9161564539824266`*^9},
 CellLabel->
  "In[1950]:=",ExpressionUUID->"857770ca-39c4-40ac-af30-144c75b2b570"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Checking the 4-momentum conservation for the phase space simulated in pythia\
\>", "Subsection",
 CellChangeTimes->{{3.9145164475137*^9, 3.914516458046376*^9}, {
  3.9156034277706823`*^9, 
  3.9156034315790663`*^9}},ExpressionUUID->"59e65861-a4a8-4123-af37-\
f2e3aa7b7a3a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"keysjets", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Keys", "[", 
        RowBox[{"DownValues", "@", "PhaseSpaceDecaysRestJets"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "//", "Transpose"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"pssum", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Hold", "@", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"tab", ",", "_Real", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"mass", ",", "_Real"}], "}"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"len", ",", 
           RowBox[{"px", "=", "0."}], ",", 
           RowBox[{"py", "=", "0."}], ",", 
           RowBox[{"pz", "=", "0."}], ",", 
           RowBox[{"e", "=", "0."}], ",", 
           RowBox[{"en", "=", "0."}], ",", 
           RowBox[{"jmax", "=", "0"}], ",", 
           RowBox[{"checker", "=", "0."}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"len", "=", 
           FractionBox[
            RowBox[{"Length", "[", 
             RowBox[{"tab", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "LengthDataProduct"]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"jmax", "=", "0"}], ";", "\[IndentingNewLine]", 
             RowBox[{"Do", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Compile`GetElement", "[", 
                   RowBox[{"tab", ",", "k", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "LengthDataProduct"}], 
                    "+", "indexpdg1"}]}], "]"}], "==", 
                  RowBox[{"-", "999."}]}], ",", 
                 RowBox[{"Break", "[", "]"}], ",", 
                 RowBox[{"jmax", "+=", "1"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", "len", ",", "1"}], "}"}]}], "]"}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"e", "=", 
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{"Compile`GetElement", "[", 
                 RowBox[{"tab", ",", "k", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "LengthDataProduct"}], 
                   "+", "indexE1"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "1", ",", "jmax", ",", "1"}], "}"}]}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"px", "=", 
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{"Compile`GetElement", "[", 
                 RowBox[{"tab", ",", "k", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "LengthDataProduct"}], 
                   "+", "indexpx1"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "1", ",", "jmax", ",", "1"}], "}"}]}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"py", "=", 
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{"Compile`GetElement", "[", 
                 RowBox[{"tab", ",", "k", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "LengthDataProduct"}], 
                   "+", "indexpy1"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "1", ",", "jmax", ",", "1"}], "}"}]}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"pz", "=", 
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{"Compile`GetElement", "[", 
                 RowBox[{"tab", ",", "k", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "LengthDataProduct"}], 
                   "+", "indexpz1"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "1", ",", "jmax", ",", "1"}], "}"}]}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"checker", "=", 
              RowBox[{"Max", "[", 
               RowBox[{"checker", ",", 
                RowBox[{"Max", "[", 
                 RowBox[{
                  RowBox[{"Abs", "[", 
                   RowBox[{"e", "-", "mass"}], "]"}], ",", 
                  RowBox[{"Abs", "[", "px", "]"}], ",", 
                  RowBox[{"Abs", "[", "py", "]"}], ",", 
                  RowBox[{"Abs", "[", "pz", "]"}]}], "]"}]}], "]"}]}], ";"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", 
              RowBox[{"Length", "[", "tab", "]"}], ",", "1"}], "}"}]}], "]"}],
           ";", "\[IndentingNewLine]", "checker"}]}], "\[IndentingNewLine]", 
        "]"}], ",", 
       RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
       RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
       RowBox[{"RuntimeAttributes", "->", 
        RowBox[{"{", "Listable", "}"}]}]}], "]"}]}], "/.", 
    RowBox[{"ruleOwn", "[", 
     RowBox[{"{", 
      RowBox[{
      "indexpx1", ",", "indexpy1", ",", "indexpz1", ",", "indexE1", ",", 
       "LengthDataProduct", ",", "indexpdg1"}], "}"}], "]"}]}], "//", 
   "ReleaseHold"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"momconscheck", "[", "i_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dat", ",", "len"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dat", "=", 
      RowBox[{"PhaseSpaceDecaysRestJets", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"keysjets", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"keysjets", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"keysjets", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"keysjets", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"keysjets", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"keysjets", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", 
       RowBox[{"pssum", "[", 
        RowBox[{"dat", ",", 
         RowBox[{
          RowBox[{"keysjets", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"checktab", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"momconscheck", "[", "i", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "keysjets", "]"}], ",", "1"}], "}"}]}], 
     "]"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Max", "[", 
     RowBox[{"checktab", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}], ">", 
    SuperscriptBox["10", 
     RowBox[{"-", "5."}]]}], ",", 
   RowBox[{
   "infoDialog", "[", 
    "\"\<The simulated phase space does not obey 4-momentum conservation! \
Examine in detail\>\"", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.9145153232370987`*^9, 3.914515546526287*^9}, {
  3.914515612206825*^9, 3.914515806177538*^9}, {3.914515843673394*^9, 
  3.9145159465776978`*^9}, {3.91451598418158*^9, 3.914516019394454*^9}, {
  3.9145160626725116`*^9, 3.9145162406301756`*^9}, {3.914516278382372*^9, 
  3.914516384502298*^9}, {3.914516414673543*^9, 3.9145164187733717`*^9}, {
  3.9145164663865952`*^9, 3.914516527291418*^9}, {3.9154355190446615`*^9, 
  3.9154355190476556`*^9}, {3.9161564539939556`*^9, 3.9161564539970784`*^9}},
 CellLabel->
  "In[1956]:=",ExpressionUUID->"c1ef5ae9-c29d-4c5c-8ae0-6374e0d3a742"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Geometry of different experiments and cross-sections", "Chapter",
 CellChangeTimes->{{3.8850100439445615`*^9, 3.885010048655702*^9}, {
  3.890201607489234*^9, 3.8902016116143937`*^9}, {3.8902020308891773`*^9, 
  3.890202041481434*^9}, {3.8934857025223536`*^9, 3.8934857070537953`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"04c1ab10-71a6-497f-94ce-68390b638778"],

Cell[CellGroupData[{

Cell["\<\
Parameters of implemented experiments: geometry and cross-sections\
\>", "Section",
 CellChangeTimes->{{3.893235933860486*^9, 3.893235936872877*^9}, {
   3.8933436723508244`*^9, 3.893343682407154*^9}, 3.8934861141232157`*^9},
 CellTags->
  "Evaluation",ExpressionUUID->"05e94672-f6cd-434c-82a8-365c8d09f18c"],

Cell[CellGroupData[{

Cell["Some expressions", "Subsection",
 CellChangeTimes->{{3.893236359435601*^9, 3.893236361107131*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"b27dc8ee-5ddc-403b-8779-db96163f2852"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"theta", "[", "\[Eta]_", "]"}], "=", 
   RowBox[{"2", "*", 
    RowBox[{"ArcTan", "[", 
     RowBox[{"Exp", "[", 
      RowBox[{"-", "\[Eta]"}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Sigma]ppInpbFacility", ":=", 
  RowBox[{"Association", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", " ", 
      RowBox[{"40.", "*", 
       SuperscriptBox["10", "9"]}]}], ",", " ", 
     RowBox[{"\"\<SPS\>\"", "\[Rule]", 
      RowBox[{"40.", "*", 
       SuperscriptBox["10", "9"]}]}], ",", 
     RowBox[{"\"\<LHC\>\"", "\[Rule]", " ", 
      RowBox[{"72.", "*", 
       SuperscriptBox["10", "9"]}]}], ",", 
     RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", 
      RowBox[{"104.", "*", 
       SuperscriptBox["10", "9"]}]}], ",", 
     RowBox[{"\"\<Serpukhov\>\"", "->", 
      RowBox[{"40.", "*", 
       SuperscriptBox["10", "9"]}]}], ",", 
     RowBox[{"\"\<ESS\>\"", "->", 
      RowBox[{"45.", "*", 
       SuperscriptBox["10", "9"]}]}]}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LLHChighLumi", "=", 
   RowBox[{"3000", "*", 
    SuperscriptBox["10", "3"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LFCChh", "=", 
    RowBox[{"20000", "*", 
     SuperscriptBox["10", "3"]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Cross", "-", 
     RowBox[{"sections", " ", "in", " ", "pb", " ", "of", " ", "b", 
      OverscriptBox["b", "_"], " ", 
      RowBox[{"production", ".", " ", "For"}], " ", 
      RowBox[{"Fermilab", "/", "FCC"}]}], "-", 
     RowBox[{"hh", " ", "taken", " ", "from", " ", "pythia"}]}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"for", " ", "SPS", " ", "taken", " ", "from", " ", 
       RowBox[{"http", ":"}]}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"cds", ".", "cern", ".", "ch"}], "/", "record"}], "/", 
          "2115534"}], "/", "files"}], "/", "SHiP"}], "-", "NOTE", "-", 
       "2015", "-", 
       RowBox[{"009.", 
        RowBox[{"pdf", "?", "version"}]}]}]}], "=", "1"}], ",", " ", 
    RowBox[{
    "for", " ", "LHC", " ", "taken", " ", "from", " ", "FONLL", " ", "at", 
     " ", "the", " ", "upper", " ", "bound", " ", "of", " ", 
     "uncertainty"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]ppTobbInpbFacility", ":=", 
   RowBox[{"Association", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", "3.8"}], ",", 
      RowBox[{"\"\<SPS\>\"", "\[Rule]", 
       RowBox[{"1.7", "*", 
        SuperscriptBox["10", "3"]}]}], ",", 
      RowBox[{"\"\<LHC\>\"", "\[Rule]", 
       RowBox[{"6.2", "*", 
        SuperscriptBox["10", "8"]}]}], ",", 
      RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", 
       RowBox[{"3.4", "*", 
        SuperscriptBox["10", "9"]}]}], ",", 
      RowBox[{"\"\<Serpukhov\>\"", "->", "0."}], ",", 
      RowBox[{"\"\<ESS\>\"", "->", "0."}]}], "}"}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Cross", "-", 
     RowBox[{"sections", " ", "in", " ", "pb", " ", "of", " ", "c", 
      OverscriptBox["c", "_"], " ", 
      RowBox[{"production", ".", " ", "For"}], " ", 
      RowBox[{"Fermilab", "/", "FCC"}]}], "-", 
     RowBox[{"hh", " ", "taken", " ", "from", " ", "pythia"}]}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"for", " ", "SPS", " ", "taken", " ", "from", " ", 
       RowBox[{"http", ":"}]}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"cds", ".", "cern", ".", "ch"}], "/", "record"}], "/", 
          "2115534"}], "/", "files"}], "/", "SHiP"}], "-", "NOTE", "-", 
       "2015", "-", 
       RowBox[{"009.", 
        RowBox[{"pdf", "?", "version"}]}]}]}], "=", "1"}], ",", " ", 
    RowBox[{
    "for", " ", "LHC", " ", "taken", " ", "from", " ", "FONLL", " ", "at", 
     " ", "the", " ", "upper", " ", "bound", " ", "of", " ", 
     "uncertainty"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]ppToccInpbFacility", ":=", 
   RowBox[{"Association", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", 
       RowBox[{"0.5", "*", 
        SuperscriptBox["10", "6"]}]}], ",", 
      RowBox[{"\"\<SPS\>\"", "\[Rule]", 
       RowBox[{"1.8", "*", 
        SuperscriptBox["10", "7"]}]}], ",", 
      RowBox[{"\"\<LHC\>\"", "\[Rule]", 
       RowBox[{"1.8", "*", 
        SuperscriptBox["10", "10"]}]}], ",", 
      RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", 
       RowBox[{"4", "*", 
        SuperscriptBox["10", "10"]}]}], ",", 
      RowBox[{"\"\<Serpukhov\>\"", "->", "0."}], ",", 
      RowBox[{"\"\<ESS\>\"", "->", "0."}]}], "}"}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Data", " ", "for", " ", "Higgs", " ", 
     RowBox[{"production", ".", " ", "For"}], " ", "LHC"}], ",", " ", 
    RowBox[{
     RowBox[{"used", " ", 
      RowBox[{"https", ":"}]}], "//", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"twiki", ".", "cern", ".", "ch"}], "/", "twiki"}], "/", 
           "bin"}], "/", "view"}], "/", "LHCPhysics"}], "/", 
        RowBox[{"HiggsEuropeanStrategy", ".", " ", "For"}]}], " ", "FCC"}], 
      "-", "hh"}]}], ",", " ", 
    RowBox[{"pythia8", " ", "is", " ", "used"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]ppTohInpbFacility", ":=", 
   RowBox[{"Association", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", " ", "0."}], ",", 
      RowBox[{"\"\<SPS\>\"", "\[Rule]", "0."}], ",", 
      RowBox[{"\"\<LHC\>\"", "\[Rule]", "55"}], ",", 
      RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", "552."}], ",", 
      RowBox[{"\"\<Serpukhov\>\"", "->", "0."}], ",", 
      RowBox[{"\"\<ESS\>\"", "->", "0."}]}], "}"}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Data", " ", "for", " ", "the", " ", "production", " ", "of", " ", "light",
     " ", 
    RowBox[{"mesons", ".", " ", "P"}], " ", "means", " ", "the", " ", 
    "fraction", " ", "per", " ", "collision"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"For", " ", "SPS"}], ",", " ", 
    RowBox[{
     RowBox[{
     "the", " ", "multiplicities", " ", "are", " ", "taken", " ", "from", " ", 
      RowBox[{"https", ":"}]}], "//", 
     RowBox[{"lib", "-", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"extopc", ".", "kek", ".", "jp"}], "/", "preprints"}], 
           "/", "PDF"}], "/", "1991"}], "/", "9103"}], "/", "9103008."}], 
       "pdf"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"For", " ", "Fermilab"}], ",", " ", 
    RowBox[{
     RowBox[{
     "obtained", " ", "using", " ", "the", " ", "approach", " ", "from", " ", 
      RowBox[{"https", ":"}]}], "//", 
     RowBox[{
      RowBox[{
       RowBox[{"arxiv", ".", "org"}], "/", "pdf"}], "/", 
      RowBox[{"2201.05170", ".", "pdf"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"For", " ", "Serpukhov", " ", 
     RowBox[{"(", "NuCal", ")"}]}], ",", " ", 
    RowBox[{
    "the", " ", "pythia8", " ", "simulation", " ", "is", " ", "used"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"For", " ", 
     RowBox[{"LHC", "/", "FCC"}]}], "-", 
    RowBox[{"hh", " ", "used", " ", "EPOS"}], "-", "LHC"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"PppTo\[Pi]0Facility", ":=", 
  RowBox[{"Association", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", "2.9"}], ",", 
     RowBox[{"\"\<SPS\>\"", "\[Rule]", "6.2"}], ",", 
     RowBox[{"\"\<LHC\>\"", "\[Rule]", "42.8"}], ",", 
     RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", "73.8"}], ",", 
     RowBox[{"\"\<Serpukhov\>\"", "->", "2.37"}], ",", 
     RowBox[{"\"\<ESS\>\"", "->", "1."}]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"PppTo\[Eta]Facility", ":=", 
  RowBox[{"Association", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", "0.32"}], ",", 
     RowBox[{"\"\<SPS\>\"", "\[Rule]", "0.8"}], ",", 
     RowBox[{"\"\<LHC\>\"", "\[Rule]", "4.7"}], ",", 
     RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", "8.3"}], ",", 
     RowBox[{"\"\<Serpukhov\>\"", "->", "0.211"}], ",", 
     RowBox[{"\"\<ESS\>\"", "->", "0."}]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"PppTo\[Eta]prFacility", ":=", 
  RowBox[{"Association", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", "0.033"}], ",", 
     RowBox[{"\"\<SPS\>\"", "\[Rule]", "0.079"}], ",", 
     RowBox[{"\"\<LHC\>\"", "\[Rule]", "0.5"}], ",", 
     RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", "1.1"}], ",", 
     RowBox[{"\"\<Serpukhov\>\"", "->", "0.027"}], ",", 
     RowBox[{"\"\<ESS\>\"", "->", "0."}]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"PppTo\[Rho]0Facility", ":=", 
  RowBox[{"Association", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", "0.36"}], ",", 
     RowBox[{"\"\<SPS\>\"", "\[Rule]", "0.548"}], ",", 
     RowBox[{"\"\<LHC\>\"", "\[Rule]", "5.16"}], ",", 
     RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", "8.26"}], ",", 
     RowBox[{"\"\<Serpukhov\>\"", "->", "0.294"}], ",", 
     RowBox[{"\"\<ESS\>\"", "->", "0."}]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PppTo\[Omega]Facility", ":=", 
   RowBox[{"Association", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", "0.36"}], ",", 
      RowBox[{"\"\<SPS\>\"", "\[Rule]", "0.548"}], ",", 
      RowBox[{"\"\<LHC\>\"", "\[Rule]", "4.83"}], ",", 
      RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", "7.75"}], ",", 
      RowBox[{"\"\<Serpukhov\>\"", "->", "0.2983"}], ",", 
      RowBox[{"\"\<ESS\>\"", "->", "0."}]}], "}"}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Production", " ", "probability", " ", "of", " ", "charged", " ", "\[Pi]",
      " ", "and", " ", 
     RowBox[{"\[Mu]", ".", " ", "Currently"}]}], ",", " ", 
    RowBox[{"used", " ", "only", " ", "for", " ", "ESS"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"PppTo\[Pi]chargedFacility", ":=", 
  RowBox[{"Association", "[", 
   RowBox[{"{", 
    RowBox[{"\"\<ESS\>\"", "->", "0.3"}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PppTo\[Mu]Facility", ":=", 
   RowBox[{"Association", "[", 
    RowBox[{"{", 
     RowBox[{"\"\<ESS\>\"", "->", "0.3"}], "}"}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"For", " ", 
     RowBox[{"J", "/", "\[Psi]"}], " ", "and", " ", "\[CapitalUpsilon]"}], 
    ",", " ", 
    RowBox[{
     RowBox[{"the", " ", "FCC"}], "-", 
     RowBox[{
     "hh", " ", "data", " ", "is", " ", "to", " ", "be", " ", "updated"}]}]}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"PppToJpsiFacility", ":=", 
  RowBox[{"Association", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", 
      RowBox[{"5.24", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "7"}]]}]}], ",", 
     RowBox[{"\"\<SPS\>\"", "\[Rule]", 
      RowBox[{"3.5", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "6"}]]}]}], ",", 
     RowBox[{"\"\<LHC\>\"", "\[Rule]", "0.001"}], ",", 
     RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", "0."}], ",", 
     RowBox[{"\"\<Serpukhov\>\"", "->", "0."}], ",", 
     RowBox[{"\"\<ESS\>\"", "->", "0."}]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PppToUpsilonFacility", ":=", 
   RowBox[{"Association", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", "0."}], ",", 
      RowBox[{"\"\<SPS\>\"", "\[Rule]", "0."}], ",", 
      RowBox[{"\"\<LHC\>\"", "\[Rule]", 
       RowBox[{"1.35", "*", 
        SuperscriptBox["10", 
         RowBox[{"-", "5"}]]}]}], ",", 
      RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", "0."}], ",", 
      RowBox[{"\"\<Serpukhov\>\"", "->", "0."}], ",", 
      RowBox[{"\"\<ESS\>\"", "->", "0."}]}], "}"}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[Phi]", " ", "multiplicity"}], " ", "-", " ", 
    RowBox[{"per", " ", "p"}], "-", 
    RowBox[{"p", " ", "collision", " ", 
     RowBox[{"(", "currently", ")"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PppToPhiFacility", ":=", 
   RowBox[{"Association", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", "0.0106"}], ",", 
      RowBox[{"\"\<SPS\>\"", "\[Rule]", "0.02"}], ",", 
      RowBox[{"\"\<LHC\>\"", "\[Rule]", "0.53"}], ",", 
      RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", "1.13"}], ",", 
      RowBox[{"\"\<Serpukhov\>\"", "->", 
       RowBox[{"8.4", "*", 
        SuperscriptBox["10", 
         RowBox[{"-", "3"}]]}]}], ",", 
      RowBox[{"\"\<ESS\>\"", "->", "0."}]}], "}"}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Data", " ", "for", " ", "W", " ", "production"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"For", " ", "LHC"}], ",", " ", 
    RowBox[{
     RowBox[{"https", ":"}], "//", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"arxiv", ".", "org"}], "/", "abs"}], "/", "1603.09222"}], 
       " ", "is", " ", 
       RowBox[{"used", ".", " ", "For"}], " ", "FCC"}], "-", "hh"}]}], ",", 
    " ", 
    RowBox[{"pythia8", " ", "is", " ", "used"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]ppToWInpbFacility", ":=", 
   RowBox[{"Association", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", " ", "0."}], ",", 
      RowBox[{"\"\<SPS\>\"", "\[Rule]", "0."}], ",", 
      RowBox[{"\"\<LHC\>\"", "\[Rule]", 
       RowBox[{
        SuperscriptBox["10", "3"], "*", 
        RowBox[{"20.62", "/", "0.107"}]}]}], ",", 
      RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", 
       RowBox[{"1.1", "*", 
        SuperscriptBox["10", "6"]}]}], ",", 
      RowBox[{"\"\<Serpukhov\>\"", "->", "0."}], ",", 
      RowBox[{"\"\<ESS\>\"", "->", "0."}]}], "}"}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Maximal", " ", "energy", " ", "of", " ", "LLP", " ", "available", " ", 
    "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"EmaxFacility", ":=", 
  RowBox[{"Association", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<SPS\>\"", "\[Rule]", "400."}], ",", 
     RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", "120."}], ",", 
     RowBox[{"\"\<LHC\>\"", "\[Rule]", "7000."}], ",", 
     RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", " ", "50000."}], ",", 
     RowBox[{"\"\<Serpukhov\>\"", "->", "70."}], ",", 
     RowBox[{"\"\<ESS\>\"", "->", "2.4"}]}], "}"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.893341579334396*^9, 3.893341579484507*^9}, {
   3.8933416871783133`*^9, 3.8933416875332813`*^9}, {3.8933418570408974`*^9, 
   3.893341864809713*^9}, {3.893341951351513*^9, 3.893342003530114*^9}, {
   3.893342807795866*^9, 3.8933428353573284`*^9}, {3.8935206581145706`*^9, 
   3.893520658160448*^9}, {3.8935208064621077`*^9, 3.8935208064990053`*^9}, {
   3.8941765244743814`*^9, 3.8941765284236374`*^9}, {3.8941766505127816`*^9, 
   3.8941766970839815`*^9}, 3.894176778421816*^9, {3.8941768153541927`*^9, 
   3.8941768169228354`*^9}, {3.894176850102585*^9, 3.894176852083151*^9}, {
   3.89417694975235*^9, 3.8941769776330075`*^9}, {3.8941770953928633`*^9, 
   3.8941770958238077`*^9}, 3.8949868753117933`*^9, {3.8950260748512506`*^9, 
   3.8950260780117044`*^9}, {3.895035184163389*^9, 3.895035191337409*^9}, {
   3.895596130541261*^9, 3.895596132120452*^9}, {3.899198582869968*^9, 
   3.899198583326418*^9}, 3.9038000474551954`*^9, {3.9152631196016855`*^9, 
   3.91526314875865*^9}, 3.9168899403690305`*^9},
 CellTags->"Evaluation",
 CellLabel->
  "In[445]:=",ExpressionUUID->"58e9f572-dc35-4942-bb43-9c3b49b5b857"]
}, Closed]],

Cell[CellGroupData[{

Cell["ANUBIS-ceiling", "Subsection",
 CellChangeTimes->{{3.8933162189589405`*^9, 3.893316220446392*^9}, {
  3.8964500762376533`*^9, 3.896450087948349*^9}, {3.8964501221805043`*^9, 
  3.8964501306425247`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"2809492e-2ac2-45a8-a0c5-517a501d1b21"],

Cell[CellGroupData[{

Cell["Geometry", "Subsubsection",
 CellChangeTimes->{{3.893342623432827*^9, 3.893342624458*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"25f5817b-5cf0-47ee-8730-697f19e5a5a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Decay", " ", 
      RowBox[{"volume", "/", "detector"}], " ", 
      RowBox[{"descriptions", ":", " ", 
       RowBox[{"following", " ", "http"}], ":"}]}], "//", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"cds", ".", "cern", ".", "ch"}], "/", "record"}], "/", 
         "2839063"}], "/", "files"}], "/", "CERN"}], "-", "THESIS", "-", 
      "2022", "-", 
      RowBox[{"169.", 
       RowBox[{"pdf", "?", "version"}]}]}]}], "=", "1"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Approximations", ":"}], "*)"}], " ", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "1.", " ", "The", " ", "decay", " ", "volume", " ", "is", " ", 
    "approximated", " ", "by", " ", "the", " ", "projective", " ", "volume", 
    " ", "covered", " ", "the", " ", "solid", " ", "angle", " ", "of", " ", 
    "the", " ", "detector", " ", "surface"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"explistanubceil", "=", 
     RowBox[{"{", "\"\<ANUBIS-ceiling\>\"", "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Distance", " ", "to", " ", "the", " ", "fiducial", " ", "volume", " ", 
     "along", " ", "the", " ", "beamline", " ", 
     RowBox[{"axis", ".", " ", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"list1", "[", "#", "]"}], "=", "#2"}], ")"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{"listexp", ",", "listvals"}], "}"}]}], "]"}]}], " ", 
     "equates", " ", "the", " ", "elements", " ", "list1", " ", "with", " ", 
     "keys", " ", "from", " ", "listexp", " ", "to", " ", "the", " ", 
     "corresponding", " ", "elements", " ", "of", " ", "the", " ", "list", 
     " ", "listvals"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"zToDecayVolumeExperiment", "[", "#1", "]"}], "=", "#2"}], 
        ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistanubceil", ",", 
        RowBox[{"{", 
         RowBox[{"-", 
          FractionBox["53", "2."]}], "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Detector", " ", "has", " ", "the", " ", "axis", " ", "along", " ", 
     "which", " ", "its", " ", "components", " ", "are", " ", 
     RowBox[{"placed", ".", " ", "The"}], " ", "option", " ", "below", " ", 
     "defines", " ", "the", " ", "orientation", " ", "of", " ", "the", " ", 
     "final", " ", "plane", " ", "transverse", " ", "to", " ", "this", " ", 
     "axis", " ", "relative", " ", "to", " ", "the", " ", "beamline"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Transverse", " ", "if", " ", "the", " ", "plane", " ", "is", " ", 
      "tranverse", " ", 
      RowBox[{"(", 
       RowBox[{"SHiP", ",", " ", 
        RowBox[{"FACET", " ", "etc"}]}], ")"}]}], ",", " ", 
     RowBox[{
     "and", " ", "Parallel", " ", "if", " ", "it", " ", "is", " ", "parallel",
       " ", 
      RowBox[{"(", 
       RowBox[{"MATHUSLA", ",", " ", "ANUBIS"}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"DetectorPlaneOrientationExperiment", "[", "#1", "]"}], "=", 
         "#2"}], ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistanubceil", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"\"\<Parallel\>\"", ",", 
          RowBox[{"Length", "[", "explistanubceil", "]"}]}], "]"}]}], "}"}]}],
      "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Facility", " ", "hosting", " ", "the", " ", 
      RowBox[{"experiment", ":", " ", "SPS"}]}], ",", " ", "Fermilab", ",", 
     " ", "LHC", ",", " ", 
     RowBox[{"FCC", "-", "hh"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"FacilityExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistanubceil", ",", 
        RowBox[{"{", "\"\<LHC\>\"", "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Geometry", " ", "of", " ", "the", " ", 
      RowBox[{"experiment", ":", " ", "box"}]}], ",", " ", "cylinder", ",", 
     " ", 
     RowBox[{"annular", " ", "cylinder"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"GeometryExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistanubceil", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"\"\<Annular cylinder\>\"", ",", 
          RowBox[{"Length", "[", "explistanubceil", "]"}]}], "]"}]}], "}"}]}],
      "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Transverse", " ", "dimensions", " ", "of", " ", "the", " ", "decay", 
      " ", "volume", " ", "assuming", " ", "box", " ", "geometry"}], ",", " ", 
     RowBox[{
     "or", " ", "cylindrical", " ", "geometry", " ", "if", " ", "the", " ", 
      "detector", " ", "plane", " ", "is", " ", "parallel", " ", "to", " ", 
      "the", " ", "beamline", " ", 
      RowBox[{
       RowBox[{"(", "ANUBIS", ")"}], ".", " ", "Otherwise"}], " ", "set", " ",
       "to", " ", "zero"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dxDecayVolumeExperiment", "[", 
          RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistanubceil", ",", 
        RowBox[{"{", "28.7", "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dyDecayVolumeExperiment", "[", 
          RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistanubceil", ",", 
        RowBox[{"{", "0.", "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Decay", " ", "volume", " ", "length", " ", "along", " ", "the", " ", 
     "beamline", " ", "axis"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dzDecayVolumeExperiment", "[", "#1", "]"}], "=", "#2"}], 
        ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistanubceil", ",", 
        RowBox[{"{", "53.", "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Distance", " ", "from", " ", "the", " ", "beamline", " ", "to", " ", 
      "the", " ", "decay", " ", "volume", " ", "center", " ", "and", " ", 
      "detector", " ", "along", " ", "the", " ", "x"}], ",", 
     RowBox[{"y", " ", "axes"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xToDecayVolumeCenterExperiment", "[", "#1", "]"}], "=", 
         "#2"}], ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistanubceil", ",", 
        RowBox[{"{", "0.", "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"yToDecayVolumeCenterExperiment", "[", "#1", "]"}], "=", 
         "#2"}], ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistanubceil", ",", 
        RowBox[{"{", "0.", "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Inner", " ", "and", " ", "outer", " ", "radii", " ", "of", " ", "the", 
     " ", "decay", " ", 
     RowBox[{"volume", ".", " ", "Applicable"}], " ", "if", " ", "the", " ", 
     "decay", " ", "volume", " ", "has", " ", "cylindrical", " ", 
     "geometry"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"RinnerDecayVolumeExperiment", "[", 
          RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistanubceil", ",", 
        RowBox[{"{", "11.3", "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"RouterDecayVolumeExperiment", "[", 
          RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistanubceil", ",", 
        RowBox[{"{", "19.9", "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"z", "-", 
     RowBox[{
     "coordinate", " ", "of", " ", "the", " ", "center", " ", "of", " ", 
      "the", " ", "decay", " ", "volume"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"zToDecayVolumeCenterExperiment", "[", "exp", "]"}], "=", 
       RowBox[{
        RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], "+", 
        FractionBox[
         RowBox[{"dzDecayVolumeExperiment", "[", "exp", "]"}], "2"]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Maximal", " ", 
     RowBox[{"long", ".", " ", "displacement"}], " ", "of", " ", "the", " ", 
     "decay", " ", "volume"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], "+", 
       RowBox[{"dzDecayVolumeExperiment", "[", "exp", "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Whether", " ", "the", " ", "decay", " ", "volume", " ", "serves", " ", 
     "as", " ", "detector", " ", 
     RowBox[{"(", 
      RowBox[{"True", " ", "or", " ", "False"}], ")"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"DecayVolumeAsDetectorExperiment", "[", "exp", "]"}], "=", 
      "\"\<False\>\""}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Transverse", " ", "dimensions", " ", "of", " ", "the", " ", "detector", 
     " ", "assuming", " ", "box", " ", "geometry"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dxDetectorExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}],
        "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistanubceil", ",", 
        RowBox[{"{", "0.", "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dyDetectorExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}],
        "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistanubceil", ",", 
        RowBox[{"{", "0.", "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Length", " ", "of", " ", "the", " ", "detector", " ", "in", " ", "z", 
     " ", "plane"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dzDetectorExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}],
        "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistanubceil", ",", 
        RowBox[{"{", "53.", "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Coordinates", " ", "of", " ", "the", " ", "center", " ", "of", " ", 
     "the", " ", "detector"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"xToDetectorCenterExperiment", "[", "exp", "]"}], "=", "0"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"yToDetectorCenterExperiment", "[", "exp", "]"}], "=", "0"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"zToDetectorCenterExperiment", "[", "exp", "]"}], "=", "0."}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Inner", " ", "and", " ", "outer", " ", "radii", " ", "of", " ", "the", 
     " ", 
     RowBox[{"detector", ".", " ", "Formal"}], " ", "thickness", " ", "of", 
     " ", "1", " ", "m", " ", "is", " ", "assumed", " ", 
     RowBox[{"(", 
      RowBox[{
      "intersected", " ", "with", " ", "the", " ", "decay", " ", "volume"}], 
      ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"RinnerDetectorExperiment", "[", "#1", "]"}], "=", "#2"}], 
        ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistanubceil", ",", 
        RowBox[{"{", "19.", "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"RouterDetectorExperiment", "[", "#1", "]"}], "=", "#2"}], 
        ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistanubceil", ",", 
        RowBox[{"{", "20.", "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Length", " ", "of", " ", "the", " ", "detector", " ", "along", " ", 
     "the", " ", "detector", " ", "axis"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"xLongDetectorExperiment", "[", "exp", "]"}], "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"DetectorPlaneOrientationExperiment", "[", "exp", "]"}], 
          "\[Equal]", "\"\<Transverse\>\""}], ",", 
         RowBox[{"dzDetectorExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"dyDetectorExperiment", "[", "exp", "]"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "The", " ", "maximal", " ", "coordinate", " ", "of", " ", "the", " ", 
     "end", " ", "of", " ", "the", " ", "detector", " ", "plane", " ", 
     RowBox[{"(", 
      RowBox[{"along", " ", "the", " ", "detector", " ", "axis"}], ")"}], " ",
      "used", " ", "to", " ", "calculate", " ", "the", " ", "decay", " ", 
     RowBox[{"acceptance", ".", " ", "May"}], " ", "be", " ", "either", " ", 
     "the", " ", "z", " ", "coordinate", " ", "or", " ", "the", " ", "y", " ",
      "coordinate", " ", 
     RowBox[{"(", 
      RowBox[{
      "if", " ", "the", " ", "final", " ", "detector", " ", "plane", " ", 
       "is", " ", "oriented", " ", "parallel", " ", "to", " ", "the", " ", 
       "beamline"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}], "=", 
       RowBox[{"RouterDetectorExperiment", "[", "exp", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Position", " ", "of", " ", "the", " ", "final", " ", "plane", " ", "for",
      " ", "the", " ", "decay", " ", "products", " ", "along", " ", "the", 
     " ", "detector", " ", "axis"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"xLongDecayProductFinalPlaneExperiment", "[", "exp", "]"}], "=", 
      RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Whether", " ", "the", " ", "experiment", " ", "has", " ", "dipole", " ", 
     "magnet", " ", "in", " ", "the", " ", "detector", " ", 
     RowBox[{"(", 
      RowBox[{"True", ",", " ", "False"}], ")"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"DipoleMagnetOptionExperiment", "[", "#1", "]"}], "=", 
         "#2"}], ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistanubceil", ",", 
        RowBox[{"{", "\"\<False\>\"", "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Longitudinal", " ", "positions", " ", "of", " ", "the", " ", "dipole", 
     " ", "magnet", " ", "of", " ", "the", " ", "detector"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"zMagnetMinExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}],
        "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistanubceil", ",", 
        RowBox[{"{", "0.", "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"zMagnetMaxExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}],
        "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistanubceil", ",", 
        RowBox[{"{", "0.", "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Mean", " ", "magnetic", " ", "field", " ", "of", " ", "the", " ", 
     "dipole", " ", "magnet"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"MagneticFieldExperiment", "[", "#1", "]"}], "=", "#2"}], 
        ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistanubceil", ",", 
        RowBox[{"{", "0.", "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"ECAL", " ", "option", " ", 
     RowBox[{"(", 
      RowBox[{"True", ",", "False"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ECALoptionExperiment", "[", "exp", "]"}], "=", 
       "\"\<False\>\""}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Position", " ", "of", " ", "the", " ", "beginning", " ", "of", " ", 
     "the", " ", "ECAL"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ECALpositionExperiment", "[", "#1", "]"}], "=", "#2"}], 
        ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistanubceil", ",", 
        RowBox[{"{", "0.", "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"List", " ", "of", " ", "detectable", " ", 
      RowBox[{"particles", ".", " ", "If"}], " ", "ECAL", " ", "is", " ", 
      "absent"}], ",", " ", 
     RowBox[{
     "it", " ", "is", " ", "assumed", " ", "by", " ", "default", " ", "that", 
      " ", "photons", " ", "and", " ", 
      SubscriptBox[
       SuperscriptBox["K", "0"], "L"], " ", "cannot", " ", "be", " ", 
      "detected"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"DetectablePDGsExperiment", "[", "#1", "]"}], "=", "#2"}], 
        ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistanubceil", ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"detectablepdgs", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"22.", ",", "130.", ",", "2112.", ",", 
                  RowBox[{"-", "2112."}]}], "}"}], ",", "#"}], "]"}], "==", 
              "False"}], "&"}]}], "]"}], ",", 
          RowBox[{"Length", "[", "explistanubceil", "]"}]}], "]"}]}], "}"}]}],
      "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.893318068124275*^9, 3.8933180796892796`*^9}, 
   3.8933188011575403`*^9, {3.893318843172867*^9, 3.89331887825416*^9}, {
   3.893319167292712*^9, 3.8933191885036945`*^9}, 3.893322113862881*^9, {
   3.8934862861621876`*^9, 3.8934862890661306`*^9}, {3.8935181369638343`*^9, 
   3.893518136969819*^9}, 3.893519312796653*^9, {3.8935201259852066`*^9, 
   3.8935201693018475`*^9}, 3.8935206581774025`*^9, 3.8944385904358416`*^9, {
   3.8964523470133295`*^9, 3.896452415766353*^9}, {3.896452470490753*^9, 
   3.8964525169181232`*^9}, {3.8964526152333736`*^9, 
   3.8964527030172677`*^9}, {3.896452737880039*^9, 3.89645289952456*^9}, {
   3.8964538961987677`*^9, 3.896453932739047*^9}, {3.8964595336113367`*^9, 
   3.896459542357152*^9}, {3.8964609640523195`*^9, 3.8964609920275064`*^9}, {
   3.903800088260869*^9, 3.9038001161320868`*^9}, {3.9152644956271706`*^9, 
   3.915264510641859*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[464]:=",ExpressionUUID->"aa90ff4c-871d-4f14-8c66-44f88731bc27"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cross-sections", "Subsubsection",
 CellChangeTimes->{{3.8933256308713317`*^9, 3.8933256323468237`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"3a8153bf-f8ea-4dec-b27c-1941df4d3446"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"NPOTexperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], "&"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"explistanubceil", ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"LLHChighLumi", "*", "72", "*", 
         SuperscriptBox["10", "9"]}], ",", 
        RowBox[{"Length", "[", "explistanubceil", "]"}]}], "]"}]}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"AtargetExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistanubceil", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"1.", ",", 
         RowBox[{"Length", "[", "explistanubceil", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Cascade", " ", "enhancement", " ", "of", " ", "the", " ", "production", 
    " ", "relative", " ", "to", " ", "the", " ", "production", " ", "in", " ",
     "pure", " ", "pp", " ", 
    RowBox[{"collisions", ".", " ", "Relevant"}], " ", "for", " ", "fixed", 
    " ", "target", " ", "experiments"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "For", " ", "all", " ", "experiments", " ", "located", " ", "at", " ", 
     "SPS"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "the", " ", "cascade", " ", "factors", " ", "is", " ", "taken", " ", 
       "from", " ", 
       RowBox[{"http", ":"}]}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"cds", ".", "cern", ".", "ch"}], "/", "record"}], "/", 
          "2115534"}], "/", "files"}], "/", "SHiP"}], "-", "NOTE", "-", 
       "2015", "-", 
       RowBox[{"009.", 
        RowBox[{"pdf", "?", "version"}]}]}]}], "=", "1"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CascadeFactorbb", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistanubceil", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"1.", ",", 
         RowBox[{"Length", "[", "explistanubceil", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "bb", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"PppTobbExperiment", "[", "exp", "]"}], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Sigma]ppTobbInpbFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
       RowBox[{"\[Sigma]ppInpbFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
     SuperscriptBox[
      RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"], "*", 
     RowBox[{"CascadeFactorbb", "[", "exp", "]"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CascadeFactorcc", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistanubceil", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"1.", ",", 
         RowBox[{"Length", "[", "explistanubceil", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "cc", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"PppToccExperiment", "[", "exp", "]"}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Sigma]ppToccInpbFacility", "[", 
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
        RowBox[{"\[Sigma]ppInpbFacility", "[", 
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
      SuperscriptBox[
       RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"], "*", 
      RowBox[{"CascadeFactorcc", "[", "exp", "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "h", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTohExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Sigma]ppTohInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "W", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToWExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Sigma]ppToWInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
    SuperscriptBox["\[Pi]", "0"], " ", "per", " ", "PoT", " ", "at", " ", 
    "the", " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Pi]0exp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Pi]0Facility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "\[Eta]", " ", "per", " ", 
    "PoT", " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Eta]exp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Eta]Facility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
    RowBox[{"\[Eta]", "'"}], " ", "per", " ", "PoT", " ", "at", " ", "the", 
    " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Eta]prexp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Eta]prFacility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
    SuperscriptBox["\[Rho]", "0"], " ", "per", " ", "PoT", " ", "at", " ", 
    "the", " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Rho]0exp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Rho]0Facility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "\[Omega]", " ", "per", " ", 
    "PoT", " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Omega]exp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Omega]Facility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
    RowBox[{"J", "/", "\[Psi]"}], 
    RowBox[{"(", 
     RowBox[{"1", "s"}], ")"}], " ", "per", " ", "PoT", " ", "at", " ", "the",
     " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToJpsiexp", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"PppToJpsiFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", "\[CapitalUpsilon]", 
    RowBox[{"(", 
     RowBox[{"1", "s"}], ")"}], " ", "per", " ", "PoT", " ", "at", " ", "the",
     " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToUpsilonexp", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"PppToUpsilonFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "\[Phi]", " ", "at", " ", 
    "the", " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToPhiexp", "[", "exp", "]"}], "=", 
      RowBox[{"PppToPhiFacility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Overall", " ", "table", " ", "with", " ", "cross"}], "-", 
    RowBox[{"sections", " ", "used", " ", "for", " ", "exporting"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"TableNumbersParticlesExperiment", "[", "exp", "]"}], "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<Facility\>\"", ",", "\"\<Npot\>\"", ",", "\"\<Atarget\>\"", ",", 
         "\"\<PPi0\>\"", ",", "\"\<PEta\>\"", ",", "\"\<PEtapr\>\"", ",", 
         "\"\<PRho0\>\"", ",", "\"\<POmega\>\"", ",", "\"\<Pc\>\"", ",", 
         "\"\<Pb\>\"", ",", "\"\<PW\>\"", ",", "\"\<Ph\>\"", ",", 
         "\"\<PJpsi\>\"", ",", "\"\<PUpsilon\>\"", ",", "\"\<PPhi\>\""}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"NPOTexperiment", "[", "exp", "]"}], ",", 
         RowBox[{"AtargetExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Pi]0exp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Eta]exp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Eta]prexp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Rho]0exp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Omega]exp", "[", "exp", "]"}], ",", 
         RowBox[{"2", 
          RowBox[{"PppToccExperiment", "[", "exp", "]"}]}], ",", 
         RowBox[{"2", 
          RowBox[{"PppTobbExperiment", "[", "exp", "]"}]}], ",", 
         RowBox[{"PppToWExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"PppTohExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"PppToJpsiexp", "[", "exp", "]"}], ",", 
         RowBox[{"PppToUpsilonexp", "[", "exp", "]"}], ",", 
         RowBox[{"PppToPhiexp", "[", "exp", "]"}]}], "}"}]}], "}"}], "//", 
     "N"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8941782014898515`*^9, 3.894178203806712*^9}, {
  3.894178687745212*^9, 3.894178689678146*^9}, {3.8964959817139406`*^9, 
  3.896496002147423*^9}, {3.8991985829008865`*^9, 3.89919861687469*^9}, {
  3.899198668931733*^9, 3.8991986762689695`*^9}, {3.9038001447596803`*^9, 
  3.9038002093626432`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[497]:=",ExpressionUUID->"4d6d84cc-6468-4846-bf31-c6438c6fd6ef"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Temp", "Section",
 CellChangeTimes->{{3.8965074437785625`*^9, 3.8965074443619184`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"ae5880a5-2d5f-4e45-976c-b85057eda045"],

Cell[CellGroupData[{

Cell["Decay volume of ANUBIS-ceiling", "Subsection",
 CellChangeTimes->{{3.896507475877802*^9, 3.89650748019287*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"1fb49388-bed7-4e96-8dd9-01762efe4772"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "shiftings", " ", "of", " ", "ATLAS", " ", "beamline", " ", 
    "from", " ", "the", " ", "center", " ", "of", " ", "the", " ", "cavern", 
    " ", "where", " ", "ATLAS", " ", "is", " ", "located"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"xshiftval", "=", "1.7"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yshiftval", "=", "1.8"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ATLASvolume", "=", 
     RowBox[{"Region", "@", 
      RowBox[{"Cylinder", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{
            "zToDecayVolumeExperiment", "[", "\"\<ANUBIS-ceiling\>\"", 
             "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{
            "zMaxDecayVolumeExperiment", "[", "\"\<ANUBIS-ceiling\>\"", 
             "]"}]}], "}"}]}], "}"}], ",", "11.3"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ANUBISceilingProjectiveVolume", "=", 
     RowBox[{"Region", "@", 
      RowBox[{"RegionProduct", "[", 
       RowBox[{
        RowBox[{"Annulus", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"xshiftval", ",", "yshiftval"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.001", ",", 
            RowBox[{"RouterDecayVolumeExperiment", "[", 
             RowBox[{"\"\<ANUBIS-ceiling\>\"", ",", "z"}], "]"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"ArcSin", "[", 
              RowBox[{"-", 
               FractionBox[
                RowBox[{"dxDecayVolumeExperiment", "[", 
                 RowBox[{"z", ",", "\"\<ANUBIS-ceiling\>\""}], "]"}], 
                RowBox[{"2", "*", 
                 RowBox[{"RouterDecayVolumeExperiment", "[", 
                  RowBox[{"\"\<ANUBIS-ceiling\>\"", ",", "z"}], "]"}]}]]}], 
              "]"}], "+", 
             FractionBox["Pi", "2"]}], ",", 
            RowBox[{
             RowBox[{"ArcSin", "[", 
              FractionBox[
               RowBox[{"dxDecayVolumeExperiment", "[", 
                RowBox[{"z", ",", "\"\<ANUBIS-ceiling\>\""}], "]"}], 
               RowBox[{"2", "*", 
                RowBox[{"RouterDecayVolumeExperiment", "[", 
                 RowBox[{"\"\<ANUBIS-ceiling\>\"", ",", "z"}], "]"}]}]], 
              "]"}], "+", 
             FractionBox["Pi", "2"]}]}], "}"}]}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "zToDecayVolumeCenterExperiment", "[", "\"\<ANUBIS-ceiling\>\"", 
              "]"}], "-", 
             FractionBox[
              RowBox[{
              "dzDecayVolumeExperiment", "[", "\"\<ANUBIS-ceiling\>\"", "]"}],
               "2"]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "zToDecayVolumeCenterExperiment", "[", "\"\<ANUBIS-ceiling\>\"", 
              "]"}], "+", 
             FractionBox[
              RowBox[{
              "dzDecayVolumeExperiment", "[", "\"\<ANUBIS-ceiling\>\"", "]"}],
               "2"]}], "}"}]}], "}"}], "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DecayVolumeGeometry", "[", "\"\<ANUBIS-ceiling\>\"", "]"}], "=", 
     RowBox[{"ANUBISceilingDecayVolume", "=", 
      RowBox[{"RegionDifference", "[", 
       RowBox[{
        RowBox[{"Rationalize", "@", "ANUBISceilingProjectiveVolume"}], ",", 
        RowBox[{"Rationalize", "@", "ATLASvolume"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ANUBISceilingDecayVolumeDiscretized", "=", 
     RowBox[{"BoundaryDiscretizeRegion", "@", "ANUBISceilingDecayVolume"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ATLASvolume2D", "=", 
     RowBox[{"Disk", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", "11.3"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ANUBISceilingProjectiveVolume2D", "=", 
     RowBox[{"Annulus", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xshiftval", ",", "yshiftval"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.001", ",", 
         RowBox[{"RouterDecayVolumeExperiment", "[", 
          RowBox[{"\"\<ANUBIS-ceiling\>\"", ",", "z"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"ArcSin", "[", 
           RowBox[{"-", 
            FractionBox[
             RowBox[{"dxDecayVolumeExperiment", "[", 
              RowBox[{"z", ",", "\"\<ANUBIS-ceiling\>\""}], "]"}], 
             RowBox[{"2", "*", 
              RowBox[{"RouterDecayVolumeExperiment", "[", 
               RowBox[{"\"\<ANUBIS-ceiling\>\"", ",", "z"}], "]"}]}]]}], 
           "]"}], "+", 
          FractionBox["Pi", "2"]}], ",", 
         RowBox[{
          RowBox[{"ArcSin", "[", 
           FractionBox[
            RowBox[{"dxDecayVolumeExperiment", "[", 
             RowBox[{"z", ",", "\"\<ANUBIS-ceiling\>\""}], "]"}], 
            RowBox[{"2", "*", 
             RowBox[{"RouterDecayVolumeExperiment", "[", 
              RowBox[{"\"\<ANUBIS-ceiling\>\"", ",", "z"}], "]"}]}]], "]"}], 
          "+", 
          FractionBox["Pi", "2"]}]}], "}"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.896507485659438*^9, 3.896507497874317*^9}, {
   3.896507561090762*^9, 3.896507648417035*^9}, {3.8965082227578187`*^9, 
   3.896508230066184*^9}, {3.896508831826661*^9, 3.8965088323773613`*^9}, 
   3.8965088723735027`*^9, {3.896508903622981*^9, 3.896508949252499*^9}, {
   3.896508980682222*^9, 3.89650898109844*^9}, {3.896511199453091*^9, 
   3.8965112010563645`*^9}, {3.8965209483816547`*^9, 3.896520990009026*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[514]:=",ExpressionUUID->"a79320cd-0d99-43fb-808f-7ae5821314a3"]
}, Closed]],

Cell[CellGroupData[{

Cell["Detector of ANUBIS-ceiling", "Subsection",
 CellChangeTimes->{{3.896507761964131*^9, 3.8965077656993136`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"ddf1802a-9d74-44ec-8027-ff68a7e281ad"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DetectorGeometry", "[", "\"\<ANUBIS-ceiling\>\"", "]"}], "=", 
   RowBox[{"ANUBISceilingDetector", "=", 
    RowBox[{"Region", "@", 
     RowBox[{"RegionProduct", "[", 
      RowBox[{
       RowBox[{"Annulus", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"xshiftval", ",", "yshiftval"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
           "RinnerDetectorExperiment", "[", "\"\<ANUBIS-ceiling\>\"", "]"}], 
           ",", 
           RowBox[{
           "RouterDetectorExperiment", "[", "\"\<ANUBIS-ceiling\>\"", "]"}]}],
           "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"ArcSin", "[", 
             RowBox[{"-", 
              FractionBox[
               RowBox[{"dxDecayVolumeExperiment", "[", 
                RowBox[{"z", ",", "\"\<ANUBIS-ceiling\>\""}], "]"}], 
               RowBox[{"2", "*", 
                RowBox[{
                "RinnerDetectorExperiment", "[", "\"\<ANUBIS-ceiling\>\"", 
                 "]"}]}]]}], "]"}], "+", 
            FractionBox["Pi", "2"]}], ",", 
           RowBox[{
            RowBox[{"ArcSin", "[", 
             FractionBox[
              RowBox[{"dxDecayVolumeExperiment", "[", 
               RowBox[{"z", ",", "\"\<ANUBIS-ceiling\>\""}], "]"}], 
              RowBox[{"2", "*", 
               RowBox[{
               "RinnerDetectorExperiment", "[", "\"\<ANUBIS-ceiling\>\"", 
                "]"}]}]], "]"}], "+", 
            FractionBox["Pi", "2"]}]}], "}"}]}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "zToDecayVolumeCenterExperiment", "[", "\"\<ANUBIS-ceiling\>\"", 
             "]"}], "-", 
            FractionBox[
             RowBox[{
             "dzDecayVolumeExperiment", "[", "\"\<ANUBIS-ceiling\>\"", "]"}], 
             "2"]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "zToDecayVolumeCenterExperiment", "[", "\"\<ANUBIS-ceiling\>\"", 
             "]"}], "+", 
            FractionBox[
             RowBox[{
             "dzDecayVolumeExperiment", "[", "\"\<ANUBIS-ceiling\>\"", "]"}], 
             "2"]}], "}"}]}], "}"}], "]"}]}], "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.896508269061487*^9, 3.8965082732983866`*^9}, 
   3.8965145073894267`*^9, 3.8965209434897313`*^9, {3.8965210488134747`*^9, 
   3.896521049474432*^9}, 3.9038002888292665`*^9},
 CellTags->"Evaluation",
 CellLabel->
  "In[522]:=",ExpressionUUID->"4f88dadc-62a7-4c7e-b264-2a24eba51db8"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", 
    RowBox[{"min", "/", "max"}]], TraditionalForm]],ExpressionUUID->
  "9982a610-c6ad-4631-b28c-3e1990a6bdfb"],
 " - minimal and maximal angles covered by the end of the detector. If the \
decay volume is fully off-axis, than the minimal angle is defined by the \
minimal angle covered by end of the decay volume"
}], "Subsection",
 CellChangeTimes->{{3.8850103028371077`*^9, 3.8850103684893785`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"049a2a4d-92fb-4feb-adfe-14f536d3c212"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]func", "[", 
    RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
   RowBox[{"ArcCos", "[", 
    RowBox[{"z", "/", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"x", "^", "2"}], "+", 
       RowBox[{"y", "^", "2"}], "+", 
       RowBox[{"z", "^", "2"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]minmaxBlock", "[", "experiment_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "Geometry", " ", "of", " ", "the", " ", "decay", " ", "volume"}], ",", 
      " ", "detector", ",", " ", 
      RowBox[{
       RowBox[{"and", " ", "the", " ", "cross"}], "-", 
       RowBox[{
       "section", " ", "of", " ", "the", " ", "end", " ", "of", " ", "the", 
        " ", "detector"}]}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"DecayVolume", ",", "DetectorVolume"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DecayVolumeGeometry", "[", "experiment", "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "DecayVolumeAsDetectorExperiment", "[", "experiment", "]"}], 
           "\[Equal]", "\"\<False\>\""}], ",", 
          RowBox[{"DetectorGeometry", "[", "experiment", "]"}]}], "]"}]}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Resolution", " ", "of", " ", "discretization", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"lower", " ", "value", " ", "is", " ", "better"}], ",", " ", 
         RowBox[{"but", " ", "slower"}]}], ")"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"MaxCellMeasureVal", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"experiment", "\[Equal]", "\"\<LHCb-far\>\""}], "||", 
         RowBox[{"experiment", "\[Equal]", "\"\<CHARM\>\""}]}], ",", ".2", 
        ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"experiment", "\[Equal]", "\"\<SHiP-ECN3-LoI\>\""}], ",", 
          ".05", ",", 
          RowBox[{"(*", "Automatic", "*)"}], ".2"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Whether", " ", "the", " ", "detector", " ", "lies", " ", "on"}], "-", 
       "beamline"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"WhetherLiesOnAxis", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DecayVolumeAsDetectorExperiment", "[", "experiment", "]"}], 
         "\[Equal]", "\"\<False\>\""}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "DetectorPlaneOrientationExperiment", "[", "experiment", "]"}], 
           "\[Equal]", "\"\<Transverse\>\""}], ",", 
          RowBox[{"RegionMeasure", "[", 
           RowBox[{"RegionIntersection", "[", 
            RowBox[{"DetectorVolume", ",", 
             RowBox[{"Point", "[", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", 
                RowBox[{
                "xLongMaxDetectorExperiment", "[", "experiment", "]"}]}], 
               "}"}], "]"}]}], "]"}], "]"}], ",", 
          RowBox[{"RegionMeasure", "[", 
           RowBox[{"RegionIntersection", "[", 
            RowBox[{"DetectorVolume", ",", 
             RowBox[{"Point", "[", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{
                "xLongMaxDetectorExperiment", "[", "experiment", "]"}], ",", 
                "0"}], "}"}], "]"}]}], "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"RegionMeasure", "[", 
         RowBox[{"RegionIntersection", "[", 
          RowBox[{"DecayVolume", ",", 
           RowBox[{"Point", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", 
              RowBox[{"zMaxDecayVolumeExperiment", "[", "experiment", "]"}]}],
              "}"}], "]"}]}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Discretization", " ", "of", " ", "the", " ", "decay", " ", "volume", 
       " ", "and", " ", "detector"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"DiscretizedDecayVolume", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"experiment", "\[Equal]", "\"\<SHiP-ECN3-LoI\>\""}], "||", 
         RowBox[{"experiment", "\[Equal]", "\"\<SHiP-ECN3\>\""}], "||", 
         RowBox[{"experiment", "\[Equal]", "\"\<SHiP-ECN3-alt\>\""}], "||", 
         RowBox[{"experiment", "\[Equal]", "\"\<SHiP-ECN4\>\""}]}], ",", 
        RowBox[{"DiscretizeRegion", "[", 
         RowBox[{
          RowBox[{"MeshRegion", "[", "DecayVolume", "]"}], ",", 
          RowBox[{"MaxCellMeasure", "\[Rule]", "MaxCellMeasureVal"}]}], "]"}],
         ",", 
        RowBox[{"BoundaryDiscretizeRegion", "[", 
         RowBox[{"DecayVolume", ",", 
          RowBox[{"MaxCellMeasure", "\[Rule]", "MaxCellMeasureVal"}]}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DiscretizedDetectorVolume", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DecayVolumeAsDetectorExperiment", "[", "experiment", "]"}], 
         "\[Equal]", "\"\<False\>\""}], ",", 
        RowBox[{"BoundaryDiscretizeRegion", "[", 
         RowBox[{"DetectorVolume", ",", 
          RowBox[{"MaxCellMeasure", "\[Rule]", "MaxCellMeasureVal"}]}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DetectorCoordinates", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DecayVolumeAsDetectorExperiment", "[", "experiment", "]"}], 
         "\[Equal]", "\"\<False\>\""}], ",", 
        RowBox[{"MeshCoordinates", "[", "DiscretizedDetectorVolume", "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"DecayVolumeCoordinates", ",", "DetEndCoordinates"}], "}"}], 
      "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"MeshCoordinates", "[", "DiscretizedDecayVolume", "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "DecayVolumeAsDetectorExperiment", "[", "experiment", "]"}], 
           "\[Equal]", "\"\<False\>\""}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "DetectorPlaneOrientationExperiment", "[", "experiment", "]"}], 
             "\[Equal]", "\"\<Transverse\>\""}], ",", 
            RowBox[{"Select", "[", 
             RowBox[{"DetectorCoordinates", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], ">", 
                RowBox[{"0.995", 
                 RowBox[{
                 "xLongMaxDetectorExperiment", "[", "experiment", "]"}]}]}], 
               "&"}]}], "]"}], ",", "DetectorCoordinates"}], "]"}]}], "]"}]}],
        "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Theta]minmaxDecayVolume", ",", "\[Theta]minmaxDetEnd"}], 
       "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"MinMax", "[", 
         RowBox[{"\[Theta]func", "@@@", "DecayVolumeCoordinates"}], "]"}], 
        ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "DecayVolumeAsDetectorExperiment", "[", "experiment", "]"}], 
           "\[Equal]", "\"\<False\>\""}], ",", 
          RowBox[{"MinMax", "[", 
           RowBox[{"\[Theta]func", "@@@", "DetEndCoordinates"}], "]"}]}], 
         "]"}]}], "}"}]}], ";", "\n", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[Theta]minIndexDecayVolume", ",", "\[Theta]maxIndexDecayVolume"}], 
       "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"\[Theta]func", "@@@", "DecayVolumeCoordinates"}], ",", 
            RowBox[{"Min", "[", 
             RowBox[{"\[Theta]func", "@@@", "DecayVolumeCoordinates"}], 
             "]"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"\[Theta]func", "@@@", "DecayVolumeCoordinates"}], ",", 
            RowBox[{"Max", "[", 
             RowBox[{"\[Theta]func", "@@@", "DecayVolumeCoordinates"}], 
             "]"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"\[Theta]minmaxDet1", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "DecayVolumeAsDetectorExperiment", "[", "experiment", "]"}], 
           "\[Equal]", "\"\<False\>\""}], ",", 
          RowBox[{"MinMax", "[", 
           RowBox[{"\[Theta]func", "@@@", 
            RowBox[{"MeshCoordinates", "[", "discretDetVol", "]"}]}], "]"}]}],
          "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Theta]minIndexDetEnd", ",", "\[Theta]maxIndexDetEnd"}], 
       "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "DecayVolumeAsDetectorExperiment", "[", "experiment", "]"}], 
           "\[Equal]", "\"\<False\>\""}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"\[Theta]func", "@@@", "DetEndCoordinates"}], ",", 
              RowBox[{"Min", "[", 
               RowBox[{"\[Theta]func", "@@@", "DetEndCoordinates"}], "]"}]}], 
             "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "DecayVolumeAsDetectorExperiment", "[", "experiment", "]"}], 
           "\[Equal]", "\"\<False\>\""}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"\[Theta]func", "@@@", "DetEndCoordinates"}], ",", 
              RowBox[{"Max", "[", 
               RowBox[{"\[Theta]func", "@@@", "DetEndCoordinates"}], "]"}]}], 
             "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Coordinates", " ", "belonging", " ", "to", " ", "the", " ", "minimal", 
       " ", "and", " ", "maximal", " ", "angles", " ", "covered", " ", "by", 
       " ", 
       RowBox[{"detector", "/", "decay"}], " ", "volume"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[Theta]minmaxCoordinatesExperiment", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DecayVolumeAsDetectorExperiment", "[", "experiment", "]"}], 
         "\[Equal]", "\"\<False\>\""}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"DecayVolumeCoordinates", "[", 
             RowBox[{"[", "\[Theta]minIndexDecayVolume", "]"}], "]"}], ",", 
            RowBox[{"DecayVolumeCoordinates", "[", 
             RowBox[{"[", "\[Theta]maxIndexDecayVolume", "]"}], "]"}]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"DetEndCoordinates", "[", 
             RowBox[{"[", "\[Theta]minIndexDetEnd", "]"}], "]"}], ",", 
            RowBox[{"DetEndCoordinates", "[", 
             RowBox[{"[", "\[Theta]maxIndexDetEnd", "]"}], "]"}]}], "}"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"DecayVolumeCoordinates", "[", 
            RowBox[{"[", "\[Theta]minIndexDecayVolume", "]"}], "]"}], ",", 
           RowBox[{"DecayVolumeCoordinates", "[", 
            RowBox[{"[", "\[Theta]maxIndexDecayVolume", "]"}], "]"}]}], "}"}],
          "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"The", " ", "final", " ", 
        RowBox[{"output", ":", " ", 
         RowBox[{
         "coordinates", " ", "belonging", " ", "to", " ", "the", " ", 
          "minimal", " ", "and", " ", "maximal", " ", "angles", " ", 
          "covered", " ", "by", " ", 
          RowBox[{"detector", "/", "decay"}], " ", "volume"}]}]}], ",", " ", 
       RowBox[{
        SubscriptBox["\[Theta]", 
         RowBox[{"min", "/", "max"}]], " ", "for", " ", "decay", " ", 
        "volume"}], ",", " ", 
       RowBox[{
        SubscriptBox["\[Theta]", 
         RowBox[{"min", "/", "max"}]], " ", "for", " ", "detector"}]}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\[Theta]minmaxCoordinatesExperiment", ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"WhetherLiesOnAxis", "\[Equal]", "1"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"\[Theta]minmaxDecayVolume", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
         "\[Theta]minmaxDecayVolume"}], "]"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"DecayVolumeAsDetectorExperiment", "[", "experiment", "]"}],
           "\[Equal]", "\"\<False\>\""}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"WhetherLiesOnAxis", "\[Equal]", "1"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"\[Theta]minmaxDetEnd", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           "\[Theta]minmaxDetEnd"}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"WhetherLiesOnAxis", "\[Equal]", "1"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"\[Theta]minmaxDecayVolume", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           "\[Theta]minmaxDecayVolume"}], "]"}]}], "]"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.8862158180216084`*^9, 3.8862158397426157`*^9}, {
   3.8862173903464975`*^9, 3.8862174928886595`*^9}, {3.8862176624205446`*^9, 
   3.886217686035149*^9}, {3.8862180874505916`*^9, 3.886218133636117*^9}, {
   3.886218177718444*^9, 3.8862181781025686`*^9}, {3.886219107641494*^9, 
   3.886219111004465*^9}, {3.886221915277137*^9, 3.886221954080035*^9}, {
   3.8862221058752356`*^9, 3.886222115284054*^9}, {3.8862226400728607`*^9, 
   3.8862226412968082`*^9}, {3.8862227160369515`*^9, 
   3.8862227903104854`*^9}, {3.886222830394898*^9, 3.886222840767403*^9}, {
   3.8862229052234125`*^9, 3.8862230200115304`*^9}, {3.8862233097508802`*^9, 
   3.886223310894819*^9}, {3.8862233544570103`*^9, 3.886223603094037*^9}, {
   3.886224007992465*^9, 3.8862240115572653`*^9}, {3.886226164518012*^9, 
   3.8862261645430126`*^9}, {3.886227674556193*^9, 3.886227704114601*^9}, {
   3.886227736654972*^9, 3.88622773738545*^9}, {3.886227845604789*^9, 
   3.8862278475939636`*^9}, {3.886230464076109*^9, 3.886230466510042*^9}, {
   3.886230524773344*^9, 3.886230526472779*^9}, {3.8862305737831597`*^9, 
   3.8862305792618523`*^9}, {3.8862307900527077`*^9, 
   3.8862308081219616`*^9}, {3.886231118380079*^9, 3.8862311246083555`*^9}, 
   3.886324160752802*^9, {3.8864085771220427`*^9, 3.886408579809992*^9}, 
   3.8864356067421403`*^9, {3.886477410766488*^9, 3.8864774843648477`*^9}, {
   3.8864776665836964`*^9, 3.8864776684104786`*^9}, {3.8875265696400633`*^9, 
   3.8875266030109615`*^9}, {3.8875266390103865`*^9, 3.887526735530167*^9}, {
   3.8875283804583073`*^9, 3.8875284920074224`*^9}, {3.8875287393382435`*^9, 
   3.88752874427244*^9}, {3.888050337954692*^9, 3.888050338711929*^9}, {
   3.891677900899274*^9, 3.89167790091486*^9}, {3.891678114570367*^9, 
   3.891678114586007*^9}, {3.8933148501988287`*^9, 3.8933148502367263`*^9}, {
   3.8933405824118347`*^9, 3.8933405824159765`*^9}, 3.8933414645316696`*^9, {
   3.8935197686770067`*^9, 3.893519787941795*^9}, {3.895035648570586*^9, 
   3.895035702860251*^9}, {3.8965159993290234`*^9, 3.8965160024310727`*^9}, 
   3.8965183568921795`*^9},
 CellTags->"Evaluation",
 CellLabel->
  "In[523]:=",ExpressionUUID->"0550c48c-e450-4ace-bc02-f0ffdaf95418"],

Cell[CellGroupData[{

Cell["Polar angle grid", "Subsubsection",
 CellChangeTimes->{{3.887526463267141*^9, 3.887526469273341*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"67acb5b1-0310-4ea2-9d6c-320976f9c01d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Theta]grid", "[", 
   RowBox[{
   "DecayVolumeAsDet_", ",", "\[Theta]decVolmin_", ",", "\[Theta]decVolmax_", 
    ",", "\[Theta]detmin_", ",", "\[Theta]detmax_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Theta]detMinEff", ",", "\[Theta]detMaxEff", ",", 
      "\[Theta]gridDetEnd"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Min", "/", "max"}], " ", "angles", " ", "covered", " ", "by", 
      " ", "detector", " ", "and", " ", "belonging", " ", "simultaneously", 
      " ", "to", " ", "the", " ", "decay", " ", "volume", " ", "acceptance"}],
      "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Theta]detMinEff", "=", 
      RowBox[{"Max", "[", 
       RowBox[{"\[Theta]detmin", ",", "\[Theta]decVolmin"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Theta]detMaxEff", "=", 
      RowBox[{"Min", "[", 
       RowBox[{"\[Theta]detmax", ",", "\[Theta]decVolmax"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Grid", " ", "of", " ", "polar", " ", "angles", " ", "for", " ", "the", 
       " ", "end", " ", "of", " ", "the", " ", "detector"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[Theta]gridDetEnd", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"DecayVolumeAsDet", "\[Equal]", "\"\<False\>\""}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{"x", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{
             RowBox[{"1.001", "\[Theta]detMinEff"}], "+", 
             SuperscriptBox["10", 
              RowBox[{"-", "5."}]]}], ",", 
            RowBox[{"0.99", "\[Theta]detMaxEff"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"0.99", "\[Theta]detMaxEff"}], "-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"1.001", "\[Theta]detMinEff"}], "+", 
                 SuperscriptBox["10", 
                  RowBox[{"-", "5."}]]}], ")"}]}], ")"}], "/", "16"}]}], 
           "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Theta]gridDecVolIfDet", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"DecayVolumeAsDet", "\[Equal]", "\"\<False\>\""}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{"x", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{
             RowBox[{"1.001", "\[Theta]decVolmin"}], "+", 
             SuperscriptBox["10", 
              RowBox[{"-", "5."}]]}], ",", 
            RowBox[{"0.999", "\[Theta]decVolmax"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"0.999", "\[Theta]decVolmax"}], "-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"1.001", "\[Theta]detMinEff"}], "+", 
                 SuperscriptBox["10", 
                  RowBox[{"-", "5."}]]}], ")"}]}], ")"}], "/", "13"}]}], 
           "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Theta]gridDecVolIfNoDet", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"DecayVolumeAsDet", "\[Equal]", "\"\<True\>\""}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{"x", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{
             RowBox[{"1.001", "\[Theta]decVolmin"}], "+", 
             SuperscriptBox["10", 
              RowBox[{"-", "5."}]]}], ",", 
            RowBox[{"0.999", "\[Theta]decVolmax"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"0.999", "\[Theta]decVolmax"}], "-", 
               RowBox[{"1.001", "\[Theta]detMinEff"}], "+", 
               SuperscriptBox["10", 
                RowBox[{"-", "5."}]]}], ")"}], "/", "22"}]}], "}"}]}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Total", " ", "grid", " ", "for", " ", "experiments", " ", "where", 
        " ", "decay", " ", "volume", " ", "is", " ", "not", " ", 
        RowBox[{"detector", ".", " ", "Merging"}], " ", "the", " ", "grid", 
        " ", "for", " ", "detector", " ", "and", " ", "decay", " ", 
        "volume"}], ",", " ", 
       RowBox[{
       "selecting", " ", "for", " ", "the", " ", "latter", " ", "only", " ", 
        "the", " ", "angles", " ", "outside", " ", "the", " ", "detector", 
        " ", "coverage"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[Theta]gridTotIfDet", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"DecayVolumeAsDet", "\[Equal]", "\"\<False\>\""}], ",", 
        RowBox[{"Sort", "[", 
         RowBox[{"Join", "[", 
          RowBox[{"\[Theta]gridDetEnd", ",", 
           RowBox[{"Select", "[", 
            RowBox[{"\[Theta]gridDecVolIfDet", ",", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"(", 
                RowBox[{
                "\[Theta]detMinEff", "\[LessEqual]", "#", "\[LessEqual]", 
                 "\[Theta]detMaxEff"}], ")"}]}], "&"}]}], "]"}]}], "]"}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"DecayVolumeAsDet", "\[Equal]", "\"\<False\>\""}], ",", 
       "\[Theta]gridTotIfDet", ",", "\[Theta]gridDecVolIfNoDet"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8875264783662243`*^9, 3.8875265222827024`*^9}, {
   3.887526742295684*^9, 3.887526810919674*^9}, {3.887526976587242*^9, 
   3.8875269784334836`*^9}, {3.887527049772958*^9, 3.88752708808506*^9}, {
   3.8875271515487823`*^9, 3.8875271575533714`*^9}, {3.8875272241199007`*^9, 
   3.8875272310647445`*^9}, {3.8875273449631715`*^9, 
   3.8875274918045177`*^9}, {3.887527592921301*^9, 3.8875276682467494`*^9}, {
   3.88752770475403*^9, 3.887528157694888*^9}, {3.8875289881915703`*^9, 
   3.8875289918074403`*^9}, {3.887529091868435*^9, 3.887529183045274*^9}, {
   3.8915325290406227`*^9, 3.8915325410232162`*^9}, {3.8915329153554935`*^9, 
   3.891532920070578*^9}, {3.891533471822391*^9, 3.8915334832115393`*^9}, {
   3.891533641867587*^9, 3.8915336493077135`*^9}, {3.8916150025620875`*^9, 
   3.8916151681219425`*^9}, {3.8916152887898064`*^9, 
   3.8916152913752537`*^9}, {3.8916153356626363`*^9, 3.8916154447642736`*^9}, 
   3.8916155628250327`*^9, {3.8916156150143037`*^9, 3.8916157853700113`*^9}, {
   3.8916158244791636`*^9, 3.8916158503080406`*^9}, {3.891615954782565*^9, 
   3.8916159558520017`*^9}, {3.893215695593479*^9, 3.893215711915337*^9}, {
   3.893301613100013*^9, 3.893301613176914*^9}, {3.8933017430919356`*^9, 
   3.8933017646199713`*^9}, {3.8935196961260056`*^9, 
   3.8935196963703794`*^9}, {3.896508376419938*^9, 3.896508377400525*^9}, {
   3.8965085518569565`*^9, 3.896508556196859*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[525]:=",ExpressionUUID->"43dae102-92b1-4ee4-9d18-a8aef4fd7010"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Specifications", "Subsection",
 CellChangeTimes->{{3.896508601070324*^9, 3.8965086042333326`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"057fa2fe-e48a-4f24-b9cc-3fb1e545193a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"GivenExperiment", "=", "\"\<ANUBIS-ceiling\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FacilityGivenExperiment", "=", 
   RowBox[{"FacilityExperiment", "[", "GivenExperiment", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EmaxGivenExperiment", "=", 
   RowBox[{"EmaxFacility", "[", "FacilityGivenExperiment", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ECALoptionGivenExperiment", "=", 
   RowBox[{"ECALoptionExperiment", "[", "GivenExperiment", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DipoleMagnetOptionGivenExperiment", "=", 
   RowBox[{"DipoleMagnetOptionExperiment", "[", "GivenExperiment", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DecayVolumeAsDetectorGivenExperiment", "=", 
    RowBox[{
    "DecayVolumeAsDetectorExperiment", "[", "GivenExperiment", "]"}]}], ";"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Box", ",", " ", "Cylinder", ",", " ", 
    RowBox[{"Annular", " ", "cylinder"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GeometryGivenExperiment", "=", 
    RowBox[{"GeometryExperiment", "[", "GivenExperiment", "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Beam", ",", " ", "Transverse"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DetectorPlaneOrientationGivenExperiment", "=", 
   RowBox[{
   "DetectorPlaneOrientationExperiment", "[", "GivenExperiment", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"!", 
    RowBox[{"DirectoryQ", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Acceptances\>\""}],
        "}"}], "]"}], "]"}]}], ",", 
   RowBox[{"CreateDirectory", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Acceptances\>\""}], 
      "}"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"!", 
    RowBox[{"DirectoryQ", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Acceptances\>\"", 
        ",", "GivenExperiment"}], "}"}], "]"}], "]"}]}], ",", 
   RowBox[{"CreateDirectory", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Acceptances\>\"", 
       ",", "GivenExperiment"}], "}"}], "]"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dxDecayVolumeGivenExperiment", "[", "z_", "]"}], "=", 
   RowBox[{"dxDecayVolumeExperiment", "[", 
    RowBox[{"z", ",", "GivenExperiment"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dyDecayVolumeGivenExperiment", "[", "z_", "]"}], "=", 
   RowBox[{"dyDecayVolumeExperiment", "[", 
    RowBox[{"z", ",", "GivenExperiment"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zToDecayVolumeGivenExperiment", "=", 
   RowBox[{"zToDecayVolumeExperiment", "[", "GivenExperiment", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zFidGivenExperiment", "=", 
   RowBox[{"dzDecayVolumeExperiment", "[", "GivenExperiment", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zLLPMaxGivenExperiment", "=", 
   RowBox[{"zMaxDecayVolumeExperiment", "[", "GivenExperiment", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xLongMaxDetectorGivenExperiment", "=", 
   RowBox[{"xLongMaxDetectorExperiment", "[", "GivenExperiment", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dxDecayVolumeGivenExperimentMax", "=", 
   RowBox[{
   "dxDecayVolumeGivenExperiment", "[", "zLLPMaxGivenExperiment", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dyDecayVolumeGivenExperimentMax", "=", 
   RowBox[{
   "dyDecayVolumeGivenExperiment", "[", "zLLPMaxGivenExperiment", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xToDecayVolumeCenterGivenExperiment", "=", 
   RowBox[{"xToDecayVolumeCenterExperiment", "[", "GivenExperiment", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"yToDecayVolumeCenterGivenExperiment", "=", 
    RowBox[{"yToDecayVolumeCenterExperiment", "[", "GivenExperiment", "]"}]}],
    ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Detector", " ", "parameters"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dxDetectorGivenExperimentMax", "=", 
   RowBox[{"dxDetectorGivenExperiment", "=", 
    RowBox[{"dxDetectorExperiment", "[", "GivenExperiment", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dyDetectorGivenExperimentMax", "=", 
   RowBox[{"dyDetectorGivenExperiment", "=", 
    RowBox[{"dyDetectorExperiment", "[", "GivenExperiment", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dzDetectorGivenExperimentMax", "=", 
   RowBox[{"dzDetectorGivenExperiment", "=", 
    RowBox[{"dzDetectorExperiment", "[", "GivenExperiment", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dx2PerpDetectorGivenExperiment", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
     "DetectorPlaneOrientationGivenExperiment", "\[Equal]", 
      "\"\<Transverse\>\""}], ",", "dyDetectorGivenExperiment", ",", 
     "dzDetectorGivenExperiment"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xToDetectorCenterGivenExperiment", "=", 
   RowBox[{
    RowBox[{"xToDetectorCenterExperiment", "[", "GivenExperiment", "]"}], "//",
     "N"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yToDetectorCenterGivenExperiment", "=", 
   RowBox[{
    RowBox[{"yToDetectorCenterExperiment", "[", "GivenExperiment", "]"}], "//",
     "N"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zToDetectorCenterGivenExperiment", "=", 
   RowBox[{
    RowBox[{"zToDetectorCenterExperiment", "[", "GivenExperiment", "]"}], "//",
     "N"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x2PerpToDetectorCenterGivenExperiment", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
     "DetectorPlaneOrientationGivenExperiment", "\[Equal]", 
      "\"\<Transverse\>\""}], ",", "yToDetectorCenterGivenExperiment", ",", 
     "zToDetectorCenterGivenExperiment"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RinnerDecayVolumeGivenExperiment", "[", "z_", "]"}], "=", 
   RowBox[{"RinnerDecayVolumeExperiment", "[", 
    RowBox[{"GivenExperiment", ",", "z"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RouterDecayVolumeGivenExperiment", "[", "z_", "]"}], "=", 
   RowBox[{"RouterDecayVolumeExperiment", "[", 
    RowBox[{"GivenExperiment", ",", "z"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RinnerDetectorGivenExperiment", "=", 
   RowBox[{"RinnerDetectorExperiment", "[", "GivenExperiment", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RouterDetectorGivenExperiment", "=", 
   RowBox[{"RouterDetectorExperiment", "[", "GivenExperiment", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GivenExperimentBoundaries", "=", 
   RowBox[{"\[Theta]minmaxBlock", "[", "GivenExperiment", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "ThetaDecVolGivenExperimentMin", ",", "ThetaDecVolGivenExperimentMax", 
     ",", "ThetaDetGivenExperimentMin", ",", "ThetaDetGivenExperimentMax"}], 
    "}"}], "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"GivenExperimentBoundaries", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"GivenExperimentBoundaries", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"GivenExperimentBoundaries", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"GivenExperimentBoundaries", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "//", "N"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DecayVolumeGeometryGivenExperiment", "=", 
   RowBox[{"DecayVolumeGeometry", "[", "GivenExperiment", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DetectorGeometryGivenExperiment", "=", 
    RowBox[{"DetectorGeometry", "[", "GivenExperiment", "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Parameters", " ", "of", " ", "the", " ", "dipole", " ", "magnet", " ", 
    "in", " ", "the", " ", "spectrometer", " ", 
    RowBox[{"(", 
     RowBox[{"if", " ", "present"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zMagnetMinGivenExperiment", "=", 
   RowBox[{"zMagnetMinExperiment", "[", "GivenExperiment", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zMagnetMaxGivenExperiment", "=", 
   RowBox[{"zMagnetMaxExperiment", "[", "GivenExperiment", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Bval", "=", 
    RowBox[{"MagneticFieldExperiment", "[", "GivenExperiment", "]"}]}], ";"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"ECAL", " ", "position"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ECALpositionGivenExperiment", "=", 
    RowBox[{"ECALpositionExperiment", "[", "GivenExperiment", "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"FinalPlaneGivenExperiment", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
       "finalPlaneGivenExperiment", "\[Equal]", "\"\<EndOfDetector\>\""}], 
       ",", "EndOfDetectorGivenExperiment", ",", 
       "PlaneDetectorGivenExperiment"}], "]"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TableParticlesNumbersGivenExperiment", "=", 
   RowBox[{"TableNumbersParticlesExperiment", "[", "GivenExperiment", "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"DetectablePDGsGivenExperiment", "=", 
  RowBox[{
  "DetectablePDGsExperiment", "[", "GivenExperiment", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\"\<Experiment\>\"", ",", "\"\<Facility\>\"", ",", 
      "\"\<Decay volume as detector\>\"", ",", "\"\<If ECAL is present\>\"", 
      ",", "\"\<If dipole magnet is present\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(E\), \(LLP, max\)]\)\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "GivenExperiment", ",", "FacilityGivenExperiment", ",", 
      "DecayVolumeAsDetectorGivenExperiment", ",", 
      "ECALoptionGivenExperiment", ",", "DipoleMagnetOptionGivenExperiment", 
      ",", "EmaxGivenExperiment"}], "}"}]}], "}"}], "//", 
  "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xLongMuonPlaneGivenExperiment", "=", 
   RowBox[{"xLongNonMuonPlaneGivenExperiment", "=", 
    RowBox[{"zToDetectorCenterGivenExperiment", "+", 
     FractionBox["dzDetectorGivenExperimentMax", "2"]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8965086102428207`*^9, 3.896508680842684*^9}, {
   3.8965156624809856`*^9, 3.8965156626798563`*^9}, {3.896515925606839*^9, 
   3.896515925755002*^9}, {3.896518118996149*^9, 3.8965181190857687`*^9}, {
   3.915263994812927*^9, 3.9152639951816444`*^9}, {3.915264081159647*^9, 
   3.9152641055393443`*^9}, 3.915264190213991*^9, {3.9152645433763943`*^9, 
   3.915264585863675*^9}, {3.9152646267577906`*^9, 3.915264654090233*^9}, {
   3.9152940477235184`*^9, 3.9152940774690886`*^9}, {3.9168899403690305`*^9, 
   3.916889940384654*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[526]:=",ExpressionUUID->"e7b14f0b-6354-4c9b-8550-57165daae3a4"]
}, Closed]],

Cell[CellGroupData[{

Cell["Visualization of the geometry", "Subsection",
 CellChangeTimes->{{3.8965144562942743`*^9, 3.896514459893909*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"dbf823ef-a081-4f4f-aff6-fc1892c23782"],

Cell[BoxData[{
 RowBox[{"Print", "[", "\"\<List of geometric parameters:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"GeometryGivenExperiment", "\[Equal]", "\"\<Cylinder\>\""}], "||", 
    RowBox[{
    "GeometryGivenExperiment", "\[Equal]", "\"\<Annular cylinder\>\""}]}], 
   ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\"\<Orientation of the detector cross section wrt beamline\>\"", ",", 
        "\"\<Decay volume geometry type\>\"", ",", 
        "\"\<\!\(\*FractionBox[SubscriptBox[\(l\), \(to\\\ fid\)], \(m\)]\)\>\
\"", ",", "\"\<\!\(\*FractionBox[SubscriptBox[\(l\), \(fid\)], \(m\)]\)\>\"", 
        ",", "\"\<\!\(\*FractionBox[SubscriptBox[\(l\), \(fid + det\)], \
\(m\)]\)\>\"", ",", 
        "\"\<\!\(\*FractionBox[SubscriptBox[\(R\), \(inner, dec\\\ vol\)], \
\(m\)]\)\>\"", ",", 
        "\"\<\!\(\*FractionBox[SubscriptBox[\(R\), \(outer, dec\\\ vol\)], \
\(m\)]\)\>\"", ",", 
        "\"\<\!\(\*FractionBox[SubscriptBox[\(R\), \(inner, det\)], \
\(m\)]\)\>\"", ",", 
        "\"\<\!\(\*FractionBox[SubscriptBox[\(R\), \(outer, det\)], \
\(m\)]\)\>\"", ",", 
        "\"\<\!\(\*FractionBox[SubscriptBox[\(\[Theta]\), \(min, decay\\\ \
volume\)], \(rad\)]\)\>\"", ",", 
        "\"\<\!\(\*FractionBox[SubscriptBox[\(\[Theta]\), \(max, decay\\\ \
volume\)], \(rad\)]\)\>\"", ",", 
        "\"\<\!\(\*FractionBox[SubscriptBox[\(\[Theta]\), \(min, det\)], \
\(rad\)]\)\>\"", ",", 
        "\"\<\!\(\*FractionBox[SubscriptBox[\(\[Theta]\), \(max, det\)], \
\(rad\)]\)\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "DetectorPlaneOrientationGivenExperiment", ",", 
        "GeometryGivenExperiment", ",", "zToDecayVolumeGivenExperiment", ",", 
        "zFidGivenExperiment", ",", "xLongMaxDetectorGivenExperiment", ",", 
        RowBox[{"RinnerDecayVolumeGivenExperiment", "[", "z", "]"}], ",", 
        RowBox[{"RouterDecayVolumeGivenExperiment", "[", "z", "]"}], ",", 
        "RinnerDetectorGivenExperiment", ",", "RouterDetectorGivenExperiment",
         ",", "ThetaDecVolGivenExperimentMin", ",", 
        "ThetaDecVolGivenExperimentMax", ",", "ThetaDetGivenExperimentMin", 
        ",", "ThetaDetGivenExperimentMax"}], "}"}]}], "}"}], "//", 
    "TableForm"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\"\<Orientation of the detector cross section wrt beamline\>\"", ",", 
        "\"\<Decay volume geometry type\>\"", ",", 
        "\"\<\!\(\*FractionBox[SubscriptBox[\(l\), \(to\\\ fid\)], \(m\)]\)\>\
\"", ",", "\"\<\!\(\*FractionBox[SubscriptBox[\(l\), \(fid\)], \(m\)]\)\>\"", 
        ",", "\"\<\!\(\*FractionBox[SubscriptBox[\(l\), \(fid + det\)], \
\(m\)]\)\>\"", ",", 
        "\"\<\!\(\*FractionBox[SubscriptBox[\(\[CapitalDelta]x\), \(1\\\ dec \
. vol . \)], \(m\)]\)\>\"", ",", 
        "\"\<\!\(\*FractionBox[SubscriptBox[\(\[CapitalDelta]x\), \(2\\\ dec \
. vol . \)], \(m\)]\)\>\"", ",", 
        "\"\<\!\(\*FractionBox[SubscriptBox[\(\[CapitalDelta]x\), \(1 \( \
\(det\)\(.\)\)\)], \(m\)]\)\>\"", ",", 
        "\"\<\!\(\*FractionBox[SubscriptBox[\(\[CapitalDelta]x\), \(2 \( \
\(det\)\(.\)\)\)], \(m\)]\)\>\"", ",", 
        "\"\<\!\(\*FractionBox[SubscriptBox[\(\[Theta]\), \(min, decay\\\ \
volume\)], \(rad\)]\)\>\"", ",", 
        "\"\<\!\(\*FractionBox[SubscriptBox[\(\[Theta]\), \(max, decay\\\ \
volume\)], \(rad\)]\)\>\"", ",", 
        "\"\<\!\(\*FractionBox[SubscriptBox[\(\[Theta]\), \(min, det\)], \
\(rad\)]\)\>\"", ",", 
        "\"\<\!\(\*FractionBox[SubscriptBox[\(\[Theta]\), \(max, det\)], \
\(rad\)]\)\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "DetectorPlaneOrientationGivenExperiment", ",", 
        "GeometryGivenExperiment", ",", "zToDecayVolumeGivenExperiment", ",", 
        "zFidGivenExperiment", ",", "xLongMaxDetectorGivenExperiment", ",", 
        RowBox[{"dxDecayVolumeGivenExperiment", "[", "z", "]"}], ",", 
        RowBox[{"dyDecayVolumeGivenExperiment", "[", "z", "]"}], ",", 
        "dxDetectorGivenExperimentMax", ",", "dyDetectorGivenExperimentMax", 
        ",", "ThetaDecVolGivenExperimentMin", ",", 
        "ThetaDecVolGivenExperimentMax", ",", "ThetaDetGivenExperimentMin", 
        ",", "ThetaDetGivenExperimentMax"}], "}"}]}], "}"}], "//", 
    "TableForm"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "Print", "[", 
   "\"\<Experiment geometry. Black point - collision point. The blue domain - \
decay volume. The red domain - detector. The green plane - final plane:\>\"", 
   "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Block", " ", "defining", " ", "relevant", " ", "plots"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"ExperimentPlots", ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"R\[Theta]minDecayVolume", ",", "R\[Theta]maxDecayVolume"}], 
       "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"GivenExperimentBoundaries", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"GivenExperimentBoundaries", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"R\[Theta]minEndDetector", ",", "R\[Theta]maxEndDetector"}], 
       "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
          "DecayVolumeAsDetectorGivenExperiment", "\[Equal]", 
           "\"\<False\>\""}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"GivenExperimentBoundaries", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
          "DecayVolumeAsDetectorGivenExperiment", "\[Equal]", 
           "\"\<False\>\""}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"GivenExperimentBoundaries", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"BoxRatioz", "=", "3"}], ";", "\[IndentingNewLine]", 
     RowBox[{"PlotOrigin", "=", 
      RowBox[{"(*", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
         "DecayVolumeAsDetectorGivenExperiment", "\[Equal]", 
          "\"\<False\>\""}], ","}]}], "*)"}], 
      RowBox[{"Graphics3D", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PointSize", "[", "0.05", "]"}], ",", "Black", ",", 
          RowBox[{"Point", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], "]"}]}], "}"}], ",", 
        RowBox[{"Axes", "\[Rule]", "True"}], ",", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"\"\<x\>\"", ",", "24", ",", "Bold", ",", "Black"}], 
            "]"}], ",", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<y\>\"", ",", "24", ",", "Bold", ",", "Black"}], 
            "]"}], ",", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<z\>\"", ",", "24", ",", "Bold", ",", "Black"}], 
            "]"}]}], "}"}]}], ",", 
        RowBox[{"AxesOrigin", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
        RowBox[{"ViewProjection", "\[Rule]", "\"\<Orthographic\>\""}], ",", 
        RowBox[{"ViewCenter", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
        RowBox[{"ViewPoint", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "0.7"}], ",", "0.25", ",", 
           RowBox[{"-", "2"}]}], "}"}]}], ",", 
        RowBox[{"ViewVertical", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ",", 
        RowBox[{"BoxRatios", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "BoxRatioz"}], "}"}]}], ",", 
        RowBox[{"AxesStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Thickness", "[", "0.03", "]"}], "}"}]}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", "20"}], "]"}], "}"}]}]}], "]"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{",", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"PointSize", "[", "0.05", "]"}], ",", "Black", ",", 
            RowBox[{"Point", "[", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0"}], "}"}], "]"}]}], "}"}], ",", 
          RowBox[{"Axes", "\[Rule]", "True"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<x\>\"", ",", "24", ",", "Bold", ",", "Black"}], 
              "]"}], ",", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<y\>\"", ",", "24", ",", "Bold", ",", "Black"}], 
              "]"}], ",", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<z\>\"", ",", "24", ",", "Bold", ",", "Black"}], 
              "]"}]}], "}"}]}], ",", 
          RowBox[{"AxesOrigin", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
          RowBox[{"ViewProjection", "\[Rule]", "\"\<Orthographic\>\""}], ",", 
          RowBox[{"ViewCenter", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
          RowBox[{"ViewPoint", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "0.7"}], ",", "0.25", ",", 
             RowBox[{"-", "2"}]}], "}"}]}], ",", 
          RowBox[{"ViewVertical", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ",", 
          RowBox[{"BoxRatios", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", "BoxRatioz"}], "}"}]}], ",", 
          RowBox[{"AxesStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Thickness", "[", "0.03", "]"}], "}"}]}], ",", 
          RowBox[{"LabelStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Directive", "[", 
             RowBox[{"Black", ",", "20"}], "]"}], "}"}]}]}], "]"}]}], "]"}], 
      "*)"}], ";", "\[IndentingNewLine]", 
     RowBox[{"PlotDecayVolume", "=", 
      RowBox[{"Region", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"DecayVolumeGeometryGivenExperiment", ",", "Blue", ",", 
          RowBox[{"Opacity", "[", "0.2", "]"}], ",", 
          RowBox[{"EdgeForm", "[", 
           RowBox[{"{", 
            RowBox[{"Thick", ",", "Blue"}], "}"}], "]"}]}], "]"}], ",", 
        RowBox[{"BoxRatios", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "BoxRatioz"}], "}"}]}], ",", 
        RowBox[{"Boxed", "\[Rule]", "True"}], ",", 
        RowBox[{"Axes", "\[Rule]", "True"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotDetector", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
        "DecayVolumeAsDetectorGivenExperiment", "\[Equal]", "\"\<False\>\""}],
         ",", 
        RowBox[{"Region", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"DetectorGeometryGivenExperiment", ",", "Red", ",", 
            RowBox[{"Opacity", "[", "0.3", "]"}], ",", 
            RowBox[{"EdgeForm", "[", 
             RowBox[{"{", 
              RowBox[{"Thick", ",", "Red"}], "}"}], "]"}]}], "]"}], ",", 
          RowBox[{"BoxRatios", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", "BoxRatioz"}], "}"}]}], ",", 
          RowBox[{"Boxed", "\[Rule]", "True"}], ",", 
          RowBox[{"Axes", "\[Rule]", "True"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotFullGeometry", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
        "DecayVolumeAsDetectorGivenExperiment", "\[Equal]", "\"\<False\>\""}],
         ",", 
        RowBox[{"Show", "[", 
         RowBox[{"PlotOrigin", ",", "PlotDecayVolume", ",", "PlotDetector"}], 
         "]"}], ",", 
        RowBox[{"Show", "[", 
         RowBox[{"PlotOrigin", ",", "PlotDecayVolume"}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Plot\[Theta]minmaxDecayVolume", "=", 
      RowBox[{"Show", "[", 
       RowBox[{"PlotOrigin", ",", "PlotDecayVolume", ",", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Black", ",", 
            RowBox[{"Arrowheads", "[", "Large", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], "@@@", 
                "R\[Theta]minDecayVolume"}]}], "}"}], "]"}], ",", "Thick", 
            ",", 
            RowBox[{"Darker", "@", 
             RowBox[{"Darker", "@", "Green"}]}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], "@@@", 
                "R\[Theta]maxDecayVolume"}]}], "}"}], "]"}]}], "}"}], ",", 
          RowBox[{"ViewPoint", "\[Rule]", "Right"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Plot\[Theta]minmaxDetector", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
        "DecayVolumeAsDetectorGivenExperiment", "\[Equal]", "\"\<False\>\""}],
         ",", 
        RowBox[{"Show", "[", 
         RowBox[{"PlotOrigin", ",", "PlotDetector", ",", 
          RowBox[{"Graphics3D", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Thick", ",", "Black", ",", 
              RowBox[{"Arrowheads", "[", "Large", "]"}], ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y", ",", "z"}], "}"}], "@@@", 
                  "R\[Theta]minEndDetector"}]}], "}"}], "]"}], ",", "Thick", 
              ",", 
              RowBox[{"Darker", "@", 
               RowBox[{"Darker", "@", "Green"}]}], ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y", ",", "z"}], "}"}], "@@@", 
                  "R\[Theta]maxEndDetector"}]}], "}"}], "]"}]}], "}"}], ",", 
            RowBox[{"ViewPoint", "\[Rule]", "Right"}]}], "]"}]}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
       "DecayVolumeAsDetectorGivenExperiment", "\[Equal]", "\"\<False\>\""}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
        "PlotFullGeometry", ",", "Plot\[Theta]minmaxDecayVolume", ",", 
         "Plot\[Theta]minmaxDetector"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"PlotFullGeometry", ",", "Plot\[Theta]minmaxDecayVolume"}], 
        "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expplots", "=", "ExperimentPlots"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"expplots", "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<Plots checking the correctness of evaluation of \!\(\*SubscriptBox[\(\
\[Theta]\), \(min\)]\), \!\(\*SubscriptBox[\(\[Theta]\), \(max\)]\) of \
detector and decay volume. The coordinates defining these angles are shown by \
arrows (black - \!\(\*SubscriptBox[\(\[Theta]\), \(min\)]\), green - \
\!\(\*SubscriptBox[\(\[Theta]\), \(max\)]\)):\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"expplots", "[", 
  RowBox[{"[", "2", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
   "DecayVolumeAsDetectorGivenExperiment", "\[Equal]", "\"\<False\>\""}], ",", 
   RowBox[{"expplots", "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.896518016026824*^9, 3.89651803620957*^9}, {
  3.9152641902219653`*^9, 3.9152641902289467`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[570]:=",ExpressionUUID->"ea795165-d9bf-45bf-9479-cded8e0281dd"],

Cell[BoxData[{
 RowBox[{"ExperimentPlots", ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"R\[Theta]minDecayVolume", ",", "R\[Theta]maxDecayVolume"}], 
       "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"GivenExperimentBoundaries", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"GivenExperimentBoundaries", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"R\[Theta]minEndDetector", ",", "R\[Theta]maxEndDetector"}], 
       "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
          "DecayVolumeAsDetectorGivenExperiment", "\[Equal]", 
           "\"\<False\>\""}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"GivenExperimentBoundaries", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
          "DecayVolumeAsDetectorGivenExperiment", "\[Equal]", 
           "\"\<False\>\""}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"GivenExperimentBoundaries", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"BoxRatioz", "=", "3"}], ";", "\[IndentingNewLine]", 
     RowBox[{"PlotOrigin", "=", 
      RowBox[{"(*", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
         "DecayVolumeAsDetectorGivenExperiment", "\[Equal]", 
          "\"\<False\>\""}], ","}]}], "*)"}], 
      RowBox[{"Graphics3D", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PointSize", "[", "0.05", "]"}], ",", "Black", ",", 
          RowBox[{"Point", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], "]"}]}], "}"}], ",", 
        RowBox[{"Axes", "\[Rule]", "True"}], ",", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"\"\<x\>\"", ",", "24", ",", "Bold", ",", "Black"}], 
            "]"}], ",", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<y\>\"", ",", "24", ",", "Bold", ",", "Black"}], 
            "]"}], ",", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<z\>\"", ",", "24", ",", "Bold", ",", "Black"}], 
            "]"}]}], "}"}]}], ",", 
        RowBox[{"AxesOrigin", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
        RowBox[{"ViewProjection", "\[Rule]", "\"\<Orthographic\>\""}], ",", 
        RowBox[{"ViewCenter", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
        RowBox[{"ViewPoint", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "0.7"}], ",", "0.25", ",", 
           RowBox[{"-", "2"}]}], "}"}]}], ",", 
        RowBox[{"ViewVertical", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ",", 
        RowBox[{"BoxRatios", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "BoxRatioz"}], "}"}]}], ",", 
        RowBox[{"AxesStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Thickness", "[", "0.03", "]"}], "}"}]}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", "20"}], "]"}], "}"}]}]}], "]"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{",", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"PointSize", "[", "0.05", "]"}], ",", "Black", ",", 
            RowBox[{"Point", "[", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0"}], "}"}], "]"}]}], "}"}], ",", 
          RowBox[{"Axes", "\[Rule]", "True"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<x\>\"", ",", "24", ",", "Bold", ",", "Black"}], 
              "]"}], ",", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<y\>\"", ",", "24", ",", "Bold", ",", "Black"}], 
              "]"}], ",", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<z\>\"", ",", "24", ",", "Bold", ",", "Black"}], 
              "]"}]}], "}"}]}], ",", 
          RowBox[{"AxesOrigin", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
          RowBox[{"ViewProjection", "\[Rule]", "\"\<Orthographic\>\""}], ",", 
          RowBox[{"ViewCenter", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
          RowBox[{"ViewPoint", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "0.7"}], ",", "0.25", ",", 
             RowBox[{"-", "2"}]}], "}"}]}], ",", 
          RowBox[{"ViewVertical", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ",", 
          RowBox[{"BoxRatios", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", "BoxRatioz"}], "}"}]}], ",", 
          RowBox[{"AxesStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Thickness", "[", "0.03", "]"}], "}"}]}], ",", 
          RowBox[{"LabelStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Directive", "[", 
             RowBox[{"Black", ",", "20"}], "]"}], "}"}]}]}], "]"}]}], "]"}], 
      "*)"}], ";", "\[IndentingNewLine]", 
     RowBox[{"PlotDecayVolume", "=", 
      RowBox[{"Region", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"DecayVolumeGeometryGivenExperiment", ",", "Blue", ",", 
          RowBox[{"Opacity", "[", "0.2", "]"}]}], 
         RowBox[{"(*", 
          RowBox[{",", 
           RowBox[{"EdgeForm", "[", 
            RowBox[{"{", 
             RowBox[{"Thick", ",", "Blue"}], "}"}], "]"}]}], "*)"}], "]"}], 
        ",", 
        RowBox[{"BoxRatios", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "BoxRatioz"}], "}"}]}], ",", 
        RowBox[{"Boxed", "\[Rule]", "True"}], ",", 
        RowBox[{"Axes", "\[Rule]", "True"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotDetector", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
        "DecayVolumeAsDetectorGivenExperiment", "\[Equal]", "\"\<False\>\""}],
         ",", 
        RowBox[{"Region", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"DetectorGeometryGivenExperiment", ",", "Red", ",", 
            RowBox[{"Opacity", "[", "0.3", "]"}], ",", 
            RowBox[{"EdgeForm", "[", 
             RowBox[{"{", 
              RowBox[{"Thick", ",", "Red"}], "}"}], "]"}]}], "]"}], ",", 
          RowBox[{"BoxRatios", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", "BoxRatioz"}], "}"}]}], ",", 
          RowBox[{"Boxed", "\[Rule]", "True"}], ",", 
          RowBox[{"Axes", "\[Rule]", "True"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotFullGeometry", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
        "DecayVolumeAsDetectorGivenExperiment", "\[Equal]", "\"\<False\>\""}],
         ",", 
        RowBox[{"Show", "[", 
         RowBox[{"PlotOrigin", ",", "PlotDecayVolume", ",", "PlotDetector"}], 
         "]"}], ",", 
        RowBox[{"Show", "[", 
         RowBox[{"PlotOrigin", ",", "PlotDecayVolume"}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Plot\[Theta]minmaxDecayVolume", "=", 
      RowBox[{"Show", "[", 
       RowBox[{"PlotOrigin", ",", "PlotDecayVolume", ",", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Black", ",", 
            RowBox[{"Arrowheads", "[", "Large", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], "@@@", 
                "R\[Theta]minDecayVolume"}]}], "}"}], "]"}], ",", "Thick", 
            ",", 
            RowBox[{"Darker", "@", 
             RowBox[{"Darker", "@", "Green"}]}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], "@@@", 
                "R\[Theta]maxDecayVolume"}]}], "}"}], "]"}]}], "}"}], ",", 
          RowBox[{"ViewPoint", "\[Rule]", "Right"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Plot\[Theta]minmaxDetector", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
        "DecayVolumeAsDetectorGivenExperiment", "\[Equal]", "\"\<False\>\""}],
         ",", 
        RowBox[{"Show", "[", 
         RowBox[{"PlotOrigin", ",", "PlotDetector", ",", 
          RowBox[{"Graphics3D", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Thick", ",", "Black", ",", 
              RowBox[{"Arrowheads", "[", "Large", "]"}], ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y", ",", "z"}], "}"}], "@@@", 
                  "R\[Theta]minEndDetector"}]}], "}"}], "]"}], ",", "Thick", 
              ",", 
              RowBox[{"Darker", "@", 
               RowBox[{"Darker", "@", "Green"}]}], ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y", ",", "z"}], "}"}], "@@@", 
                  "R\[Theta]maxEndDetector"}]}], "}"}], "]"}]}], "}"}], ",", 
            RowBox[{"ViewPoint", "\[Rule]", "Right"}]}], "]"}]}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
       "DecayVolumeAsDetectorGivenExperiment", "\[Equal]", "\"\<False\>\""}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
        "PlotFullGeometry", ",", "Plot\[Theta]minmaxDecayVolume", ",", 
         "Plot\[Theta]minmaxDetector"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"PlotFullGeometry", ",", "Plot\[Theta]minmaxDecayVolume"}], 
        "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expplots", "=", "ExperimentPlots"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9015173466640315`*^9, 3.901517353494697*^9}},
 CellLabel->
  "In[702]:=",ExpressionUUID->"98cabff5-a6e9-4a6b-81ce-94345c2cf410"]
}, Closed]],

Cell[CellGroupData[{

Cell["Generating the grids \[Theta],z,E", "Subsection",
 CellChangeTimes->{{3.8965087245347147`*^9, 3.8965087323776274`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"22bfd06d-d1da-435d-af12-6d2c5b7dbaf5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Grid", " ", "of", " ", "energies", " ", "for", " ", "which", " ", "the", 
    " ", "decay", " ", "products", " ", "acceptance", " ", "will", " ", "be", 
    " ", "generated"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ELLPvaluesFacility", "[", "\"\<FermilabBD\>\"", "]"}], ":=", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "0.005", ",", "0.01", ",", "0.021", ",", "0.05", ",", "0.1", ",", 
         "0.25", ",", "0.5", ",", "0.75", ",", "1.", ",", "1.5", ",", "2.", 
         ",", "2.5", ",", "3.", ",", "3.5", ",", "4.", ",", "4.5", ",", 
         "5."}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         SuperscriptBox["10", "ELLP"], ",", 
         RowBox[{"{", 
          RowBox[{"ELLP", ",", 
           RowBox[{"Log10", "[", "5.5", "]"}], ",", 
           RowBox[{"Log10", "[", 
            RowBox[{"EmaxFacility", "[", "\"\<FermilabBD\>\"", "]"}], "]"}], 
           ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Log10", "[", 
               RowBox[{"EmaxFacility", "[", "\"\<FermilabBD\>\"", "]"}], 
               "]"}], "-", 
              RowBox[{"Log10", "[", "5.5", "]"}]}], ")"}], "/", "50"}]}], 
          "}"}]}], "]"}]}], "]"}], "//", "N"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ELLPvaluesFacility", "[", "\"\<SPS\>\"", "]"}], ":=", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "0.005", ",", "0.01", ",", "0.021", ",", "0.05", ",", "0.1", ",", 
         "0.25", ",", "0.5", ",", "0.75", ",", "1.", ",", "1.5", ",", "2.", 
         ",", "2.5", ",", "3.", ",", "3.5", ",", "4.", ",", "4.5", ",", 
         "5."}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         SuperscriptBox["10", "ELLP"], ",", 
         RowBox[{"{", 
          RowBox[{"ELLP", ",", 
           RowBox[{"Log10", "[", "5.5", "]"}], ",", 
           RowBox[{"Log10", "[", 
            RowBox[{"EmaxFacility", "[", "\"\<SPS\>\"", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Log10", "[", 
               RowBox[{"EmaxFacility", "[", "\"\<SPS\>\"", "]"}], "]"}], "-", 
              RowBox[{"Log10", "[", "5.5", "]"}]}], ")"}], "/", "50"}]}], 
          "}"}]}], "]"}]}], "]"}], "//", "N"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ELLPvaluesFacility", "[", "\"\<LHC\>\"", "]"}], ":=", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "0.005", ",", "0.01", ",", "0.021", ",", "0.05", ",", "0.1", ",", 
         "0.25", ",", "0.5", ",", "0.75", ",", "1.", ",", "1.5", ",", "2.", 
         ",", "2.5", ",", "3.", ",", "3.5", ",", "4.", ",", "4.5", ",", 
         "5."}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         SuperscriptBox["10", "ELLP"], ",", 
         RowBox[{"{", 
          RowBox[{"ELLP", ",", 
           RowBox[{"Log10", "[", "5.5", "]"}], ",", 
           RowBox[{"Log10", "[", "1000", "]"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Log10", "[", "1000", "]"}], "-", 
              RowBox[{"Log10", "[", "5.5", "]"}]}], ")"}], "/", "50"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         SuperscriptBox["10", "ELLP"], ",", 
         RowBox[{"{", 
          RowBox[{"ELLP", ",", 
           RowBox[{"Log10", "[", "1100.", "]"}], ",", 
           RowBox[{"Log10", "[", 
            RowBox[{"EmaxFacility", "[", "\"\<LHC\>\"", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Log10", "[", 
               RowBox[{"EmaxFacility", "[", "\"\<LHC\>\"", "]"}], "]"}], "-", 
              RowBox[{"Log10", "[", "1100.", "]"}]}], ")"}], "/", "30"}]}], 
          "}"}]}], "]"}]}], "]"}], "//", "N"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ELLPvaluesFacility", "[", "\"\<FCC-hh\>\"", "]"}], ":=", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "0.005", ",", "0.011", ",", "0.021", ",", "0.05", ",", "0.1", ",", 
         "0.25", ",", "0.5", ",", "0.75", ",", "1.", ",", "1.5", ",", "2.", 
         ",", "2.5", ",", "3.", ",", "3.5", ",", "4.", ",", "4.5", ",", 
         "5."}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         SuperscriptBox["10", "ELLP"], ",", 
         RowBox[{"{", 
          RowBox[{"ELLP", ",", 
           RowBox[{"Log10", "[", "5.5", "]"}], ",", 
           RowBox[{"Log10", "[", "1000", "]"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Log10", "[", "1000", "]"}], "-", 
              RowBox[{"Log10", "[", "5.5", "]"}]}], ")"}], "/", "30"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         SuperscriptBox["10", "ELLP"], ",", 
         RowBox[{"{", 
          RowBox[{"ELLP", ",", 
           RowBox[{"Log10", "[", "1100.", "]"}], ",", 
           RowBox[{"Log10", "[", "10000.", "]"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Log10", "[", "10000.", "]"}], "-", 
              RowBox[{"Log10", "[", "1100.", "]"}]}], ")"}], "/", "30"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         SuperscriptBox["10", "ELLP"], ",", 
         RowBox[{"{", 
          RowBox[{"ELLP", ",", 
           RowBox[{"Log10", "[", "11000.", "]"}], ",", 
           RowBox[{"Log10", "[", 
            RowBox[{"EmaxFacility", "[", "\"\<FCC-hh\>\"", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Log10", "[", 
               RowBox[{"EmaxFacility", "[", "\"\<FCC-hh\>\"", "]"}], "]"}], 
              "-", 
              RowBox[{"Log10", "[", "11000.", "]"}]}], ")"}], "/", "30"}]}], 
          "}"}]}], "]"}]}], "]"}], "//", "N"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
     "___", "___", "___", "___", "_"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Grid", " ", "of", " ", 
      SubscriptBox["\[Theta]", "LLP"]}], ",", 
     SubscriptBox["z", "LLP"]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
     "___", "___", "___", "___", "_"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalDelta]zVal", "[", "\[CapitalDelta]z_", "]"}], "=", 
     RowBox[{"Min", "[", 
      RowBox[{
       FractionBox["\[CapitalDelta]z", "10"], ",", 
       RowBox[{"Max", "[", 
        RowBox[{"0.5", ",", 
         RowBox[{"\[CapitalDelta]z", "/", "45."}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "If", " ", "the", " ", "experiment", " ", "is", " ", "symmetric", " ", 
      "wrt", " ", "the", " ", "z", " ", "axis"}], ",", " ", 
     RowBox[{
     "then", " ", "the", " ", "grid", " ", "is", " ", "made", " ", "only", 
      " ", "over", " ", "positive", " ", "values", " ", "of", " ", "z", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
        "this", " ", "does", " ", "not", " ", "affect", " ", "the", " ", 
         "detector", " ", "configuration"}], ")"}], ".", " ", "In"}], " ", 
      "the", " ", "end"}], ",", " ", 
     RowBox[{
     "the", " ", "number", " ", "of", " ", "events", " ", "is", " ", "just", 
      " ", "multiplied", " ", "by", " ", "2"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"zLLPrange", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"zToDecayVolumeGivenExperiment", "!=", 
        RowBox[{"-", "zLLPMaxGivenExperiment"}]}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"zLLP", ",", 
         RowBox[{"{", 
          RowBox[{
          "zLLP", ",", "zToDecayVolumeGivenExperiment", ",", 
           "zLLPMaxGivenExperiment", ",", 
           RowBox[{"\[CapitalDelta]zVal", "[", 
            RowBox[{
            "zLLPMaxGivenExperiment", "-", "zToDecayVolumeGivenExperiment"}], 
            "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"zLLP", ",", 
         RowBox[{"{", 
          RowBox[{"zLLP", ",", 
           SuperscriptBox["10", 
            RowBox[{"-", "5."}]], ",", "zLLPMaxGivenExperiment", ",", 
           RowBox[{"\[CapitalDelta]zVal", "[", 
            RowBox[{"zLLPMaxGivenExperiment", "-", 
             SuperscriptBox["10", 
              RowBox[{"-", "5."}]]}], "]"}]}], "}"}]}], "]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "If", " ", "the", " ", "experiment", " ", "is", " ", "symmetric", " ", 
      "wrt", " ", "the", " ", "z", " ", "axis"}], ",", " ", 
     RowBox[{
      RowBox[{
      "then", " ", "the", " ", "grid", " ", "is", " ", "made", " ", "only", 
       " ", "over", " ", "values", " ", "\[Theta]"}], "<", 
      RowBox[{
       FractionBox["Pi", "2"], " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
         "this", " ", "does", " ", "not", " ", "affect", " ", "the", " ", 
          "detector", " ", "configuration"}], ")"}], ".", " ", "In"}], " ", 
       "the", " ", "end"}]}], ",", " ", 
     RowBox[{
     "the", " ", "number", " ", "of", " ", "events", " ", "is", " ", "just", 
      " ", "multiplied", " ", "by", " ", "2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
        "positive", " ", "values", " ", "of", " ", "z", " ", "belong", " ", 
         "to", " ", "values", " ", "\[Theta]"}], " ", "<", " ", 
        FractionBox["Pi", "2"]}], ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]LLPrange", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"zToDecayVolumeGivenExperiment", "!=", 
        RowBox[{"-", "zLLPMaxGivenExperiment"}]}], ",", 
       RowBox[{"\[Theta]grid", "[", 
        RowBox[{
        "DecayVolumeAsDetectorGivenExperiment", ",", 
         "ThetaDecVolGivenExperimentMin", ",", 
         "ThetaDecVolGivenExperimentMax", ",", "ThetaDetGivenExperimentMin", 
         ",", "ThetaDetGivenExperimentMax"}], "]"}], ",", 
       RowBox[{"\[Theta]grid", "[", 
        RowBox[{
        "DecayVolumeAsDetectorGivenExperiment", ",", 
         "ThetaDecVolGivenExperimentMin", ",", 
         RowBox[{"0.999", 
          FractionBox["Pi", "2"]}], ",", "ThetaDetGivenExperimentMin", ",", 
         RowBox[{"0.999", 
          FractionBox["Pi", "2"]}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TableLLPgrid\[Theta]z", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Theta]LLP", ",", "zLLP"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Theta]LLP", ",", "\[Theta]LLPrange"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"zLLP", ",", "zLLPrange"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"List", " ", "of", " ", 
     SubscriptBox["E", "LLP"]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ELLPvalues", "=", 
     RowBox[{"ELLPvaluesFacility", "[", "FacilityGivenExperiment", "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9168899404313955`*^9, 3.9168899405725856`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[579]:=",ExpressionUUID->"aa654507-7d74-4953-9e3d-e34911a51922"]
}, Closed]],

Cell[CellGroupData[{

Cell["Azimuthal acceptance grid", "Subsection",
 CellChangeTimes->{{3.8965075492610145`*^9, 3.8965075531295843`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"ca72417d-b6ee-4d74-9da9-0591ae8c77a0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ROffAxisArb", "[", 
    RowBox[{"\[Theta]_", ",", "ztodet_"}], "]"}], "=", 
   RowBox[{"ztodet", "*", 
    RowBox[{"Tan", "[", "\[Theta]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ParticleAsimuthalCoverage", "[", 
    RowBox[{"ztodet_", ",", "\[Theta]_"}], "]"}], ":=", 
   RowBox[{"Circle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"ROffAxisArb", "[", 
      RowBox[{"\[Theta]", ",", "ztodet"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"regionintersection1", "[", 
    RowBox[{"\[Theta]_", ",", "z_"}], "]"}], ":=", 
   RowBox[{"RegionIntersection", "[", 
    RowBox[{
     RowBox[{"Region", "@", "ANUBISceilingProjectiveVolume2D"}], ",", 
     RowBox[{"ParticleAsimuthalCoverage", "[", 
      RowBox[{"z", ",", "\[Theta]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"regionintersection2", "[", 
    RowBox[{"\[Theta]_", ",", "z_"}], "]"}], ":=", 
   RowBox[{"RegionIntersection", "[", 
    RowBox[{
     RowBox[{"Region", "@", "ATLASvolume2D"}], ",", 
     RowBox[{"ParticleAsimuthalCoverage", "[", 
      RowBox[{"z", ",", "\[Theta]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"regdiff", "=", 
   RowBox[{"RegionDifference", "[", 
    RowBox[{"ANUBISceilingProjectiveVolume2D", ",", "ATLASvolume2D"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"regionintersection", "[", 
    RowBox[{"\[Theta]_", ",", "z_"}], "]"}], ":=", 
   RowBox[{"RegionIntersection", "[", 
    RowBox[{"regdiff", ",", 
     RowBox[{"ParticleAsimuthalCoverage", "[", 
      RowBox[{"z", ",", "\[Theta]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ArcEndpoints", "[", 
    RowBox[{"Circle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_"}], "}"}], ",", "r_", ",", 
      RowBox[{"{", 
       RowBox[{"a1_", ",", "a2_"}], "}"}]}], "]"}], "]"}], ":=", 
   RowBox[{"Point", "/@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x", "+", 
         RowBox[{"r", " ", 
          RowBox[{"Cos", "@", "a1"}]}]}], ",", 
        RowBox[{"y", "+", 
         RowBox[{"r", " ", 
          RowBox[{"Sin", "@", "a1"}]}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x", "+", 
         RowBox[{"r", " ", 
          RowBox[{"Cos", "@", "a2"}]}]}], ",", 
        RowBox[{"y", "+", 
         RowBox[{"r", " ", 
          RowBox[{"Sin", "@", "a2"}]}]}]}], "}"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ArcLengthValue", "[", 
    RowBox[{"\[Theta]_", ",", "z_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"RegionMeasure", "[", 
       RowBox[{"regionintersection", "[", 
        RowBox[{"\[Theta]", ",", "z"}], "]"}], "]"}], "\[Equal]", "0"}], ",", 
     "0", ",", 
     RowBox[{"ArcLength", "[", 
      RowBox[{"regionintersection", "[", 
       RowBox[{"\[Theta]", ",", "z"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NofPhiVals", "=", "20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BlockAcceptanceGivenZ", "[", 
   RowBox[{"\[Theta]val_", ",", "zval_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"regint", "=", 
      RowBox[{"regionintersection", "[", 
       RowBox[{"\[Theta]val", ",", "zval"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"regmes", "=", 
      RowBox[{"RegionMeasure", "[", "regint", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"regmes", "==", "0"}], ",", 
       RowBox[{"AzAcc", "=", "0"}], ",", 
       RowBox[{"AzAcc", "=", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"2", "*", "Pi"}]], 
         FractionBox[
          RowBox[{"ArcLength", "[", "regint", "]"}], 
          RowBox[{"ROffAxisArb", "[", 
           RowBox[{"\[Theta]val", ",", "zval"}], "]"}]]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"regmes", "==", "0"}], ",", 
       RowBox[{
        RowBox[{"randompoints", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[Theta]val", ",", "zval", ",", "0.", ",", 
             FractionBox["Pi", "3"]}], "}"}], ",", "20"}], "]"}]}], ";"}], 
       ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"randpts", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Phi]Val", "[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], "/@", 
          RowBox[{"Take", "[", 
           RowBox[{
            RowBox[{"RandomSample", "[", 
             RowBox[{"RandomPoint", "[", 
              RowBox[{"regint", ",", "1000"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "NofPhiVals"}], "}"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"randompoints", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[Theta]val", ",", "zval", ",", "AzAcc", ",", 
             RowBox[{"randpts", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "randpts", "]"}], ",", "1"}], "}"}]}], 
          "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "randompoints"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tabletest", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"ParallelTable", "[", 
       RowBox[{
        RowBox[{"BlockAcceptanceGivenZ", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"TableLLPgrid\[Theta]z", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"TableLLPgrid\[Theta]z", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "TableLLPgrid\[Theta]z", "]"}], ",", "1"}], 
         "}"}]}], "]"}], ",", "1"}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<Distribution of the generated points inside the decay volume:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ptsInsideAcceptance", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], 
         RowBox[{"Cos", "[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]], 
        RowBox[{"Sin", "[", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], 
        RowBox[{"Cos", "[", 
         RowBox[{"#", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "]"}]}], ",", 
       RowBox[{
        FractionBox[
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], 
         RowBox[{"Cos", "[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]], 
        RowBox[{"Sin", "[", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], 
        RowBox[{"Sin", "[", 
         RowBox[{"#", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "]"}]}], ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", 
    RowBox[{"Select", "[", 
     RowBox[{"tabletest", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "!=", "0"}], "&"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPointPlot3D", "[", "ptsInsideAcceptance", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt1", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{"tabletest", ",", 
       RowBox[{"Length", "[", "ELLPvalues", "]"}]}], "]"}], ",", "1"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt2", "=", 
   RowBox[{"Partition", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"ELLPvalues", ",", 
         RowBox[{"Length", "[", "tabletest", "]"}]}], "]"}], ",", "1"}], 
      "]"}], ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gridLLPtoDet", "=", 
   RowBox[{"SortBy", "[", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"tt1", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{"{", "1", "}"}]}], "]"}], "]"}], ",", "tt2", ",", 
       RowBox[{"tt1", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "3", ",", "4"}], "}"}]}], "]"}], "]"}], ",", 
       "2"}], "]"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"#", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gridReducedLLPtoDet", "=", 
   RowBox[{
    RowBox[{"DeleteDuplicatesBy", "[", 
     RowBox[{"gridLLPtoDet", ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"#", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}]}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"index\[Theta]LLP", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"indexELLP", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"indexzLLP", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"indexLLPazAcc", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"index\[Phi]LLP", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<\[Theta] grid:\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"thgrid", "=", 
  RowBox[{"DeleteDuplicates", "[", 
   RowBox[{"gridLLPtoDet", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<E grid:\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"egrid", "=", 
  RowBox[{"DeleteDuplicates", "[", 
   RowBox[{"gridLLPtoDet", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<z grid:\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"zgrid", "=", 
  RowBox[{"DeleteDuplicates", "[", 
   RowBox[{"gridLLPtoDet", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<The volume of the decay volume (in \!\(\*SuperscriptBox[\(m\), \
\(3\)]\)) calculated by the azimuthal acceptance (compare with the true \
volume obtained using simple formulas):\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"azaccdata", "=", 
   RowBox[{"gridReducedLLPtoDet", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "3", ",", "4"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"azacc", "[", 
     RowBox[{"th_", ",", "z_"}], "]"}], "=", 
    RowBox[{
     RowBox[{"Interpolation", "[", 
      RowBox[{
       RowBox[{"DeleteDuplicatesBy", "[", 
        RowBox[{"azaccdata", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}]}], "]"}], ",", 
       RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
     RowBox[{"th", ",", "z"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Factor", " ", "of", " ", "2", " ", "since", " ", "only", " ", "positive", 
    " ", "directions", " ", "of", " ", "z", " ", "are", " ", "considered", 
    " ", "for", " ", "the", " ", "azimuthal", " ", "acceptance"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"2", "*", 
  RowBox[{"NIntegrate", "[", 
   RowBox[{
    RowBox[{"2", "*", "Pi", "*", 
     RowBox[{"azacc", "[", 
      RowBox[{"th", ",", "z"}], "]"}], "*", 
     RowBox[{"Sin", "[", "th", "]"}], 
     FractionBox[
      SuperscriptBox["z", "2"], 
      SuperscriptBox[
       RowBox[{"Cos", "[", "th", "]"}], "3"]]}], ",", 
    RowBox[{"{", 
     RowBox[{"th", ",", 
      RowBox[{"thgrid", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"thgrid", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"z", ",", 
      RowBox[{"zgrid", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"zgrid", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.896507653913918*^9, 3.8965077147023244`*^9}, 
   3.896507748362897*^9, 3.8965083588746605`*^9, 3.8965086978146887`*^9, {
   3.8965087688063326`*^9, 3.896508775759497*^9}, {3.8965100670652742`*^9, 
   3.8965102027944093`*^9}, {3.8965102582438765`*^9, 
   3.8965102658897176`*^9}, {3.8965106299038754`*^9, 
   3.8965106374730573`*^9}, {3.896510730047154*^9, 3.896510741853551*^9}, {
   3.896510831193494*^9, 3.8965108546924253`*^9}, {3.896510886734076*^9, 
   3.8965110049720306`*^9}, {3.8965110369422417`*^9, 3.896511158762143*^9}, {
   3.8965112553621445`*^9, 3.8965112570932713`*^9}, {3.89651133657226*^9, 
   3.896511395732174*^9}, {3.896511692449272*^9, 3.896511830718872*^9}, {
   3.896511972285424*^9, 3.896511986756502*^9}, {3.8965120320028286`*^9, 
   3.896512104506608*^9}, {3.8965121369143686`*^9, 3.8965121664921036`*^9}, {
   3.896512208901437*^9, 3.8965122222620935`*^9}, {3.8965122673338156`*^9, 
   3.896512342753303*^9}, {3.8965124181922913`*^9, 3.8965124271324067`*^9}, {
   3.8965125181533546`*^9, 3.896512523293109*^9}, {3.896513058339391*^9, 
   3.896513058801564*^9}, {3.896513461656308*^9, 3.8965135443776383`*^9}, {
   3.896513805066285*^9, 3.8965138055660496`*^9}, {3.8965139313664813`*^9, 
   3.8965139321662674`*^9}, 3.896514165223583*^9, {3.896515630231923*^9, 
   3.8965156304613867`*^9}, {3.896681388628828*^9, 3.8966814237040763`*^9}, {
   3.9168899405882497`*^9, 3.9168899406668153`*^9}, {3.916897383123205*^9, 
   3.9168974076923857`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[588]:=",ExpressionUUID->"09e401fa-b97a-49df-9839-a035ce54d3dc"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Specifying cuts on the decay products", "Chapter",
 CellChangeTimes->{{3.877157217895995*^9, 3.877157230401365*^9}, {
  3.8850103814195557`*^9, 3.8850103821591024`*^9}, {3.89343655755689*^9, 
  3.893436569027972*^9}, {3.9142998030668216`*^9, 3.9142998104400644`*^9}},
 CellTags->{
  "Evaluation", 
   "Re-evaluation"},ExpressionUUID->"39f5d476-0447-46a9-bd00-1cdb56a7b006"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dropdownDialog", "[", 
    RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
   RowBox[{"DialogInput", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
     RowBox[{"Column", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
        RowBox[{"PopupMenu", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
        RowBox[{"Button", "[", 
         RowBox[{"\"\<OK\>\"", ",", 
          RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
      "]"}]}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"filenameGivenExperiment", "=", 
     RowBox[{"filenameExperiment", "[", 
      RowBox[{"finalPlaneGivenExperiment", ",", "GivenExperiment"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"filenameGivenExperimentzN", "=", 
     RowBox[{"filenameExperimentzN", "[", 
      RowBox[{"finalPlaneGivenExperiment", ",", "GivenExperiment"}], 
      "]"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<Experiment\>\"", ",", "\"\<Facility\>\"", ",", 
       "\"\<Decay volume as detector\>\"", ",", "\"\<If ECAL is present\>\"", 
       ",", "\"\<If dipole magnet is present\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(E\), \(LLP, max\)]\)\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "GivenExperiment", ",", "FacilityGivenExperiment", ",", 
       "DecayVolumeAsDetectorGivenExperiment", ",", 
       "ECALoptionGivenExperiment", ",", "DipoleMagnetOptionGivenExperiment", 
       ",", "EmaxGivenExperiment"}], "}"}]}], "}"}], "//", "TableForm"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"WhetherCutsTemp", "=", 
     RowBox[{"dropdownDialog", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<Yes\>\"", ",", "\"\<No\>\""}], "}"}], ",", 
       "\"\<Would you like to impose any cuts on acceptance of decay products \
other than geometric?\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"WhetherCuts", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"WhetherCutsTemp", "\[Equal]", "\"\<Yes\>\""}], ",", "1", ",", 
       "0"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
    "___", "___", "___", "___", "___", "___", "___", "_"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Imposing", " ", "cuts", " ", "on", " ", "decay", " ", "products"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
    "___", "___", "___", "___", "___", "___", "___", "_"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pTcutLowerZero", "=", "0."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pTcutUpperZero", "=", 
   SuperscriptBox["10", "10."]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eCutLowerZero", "=", "0."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eCutUpperZero", "=", 
   SuperscriptBox["10", "10."]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IPcutZero", "=", 
   SuperscriptBox["10", "10."]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AngSepCutZero", "=", "0."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minvCutLowerZero", "=", "0."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minvCutUpperZero", "=", 
   SuperscriptBox["10", "10."]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eTotCutLowerZero", "=", "0."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eTotCutUpperZero", "=", 
   SuperscriptBox["10", "10."]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "pTelCutLower", ",", "pTelCutUpper", ",", "pT\[Mu]CutLower", ",", 
     "pT\[Mu]CutUpper", ",", "pThadrCutLower", ",", "pThadrCutUpper", ",", 
     "eElCutLower", ",", "eElCutUpper", ",", "e\[Mu]CutLower", ",", 
     "e\[Mu]CutUpper", ",", "eHadrCutLower", ",", "eHadrCutUpper", ",", 
     "EtotElCutLower", ",", "EtotElCutUpper", ",", "Etot\[Mu]CutLower", ",", 
     "Etot\[Mu]CutUpper", ",", "EtotHadrCutLower", ",", "EtotHadrCutUpper", 
     ",", "EtotMixedCutLower", ",", "EtotMixedCutUpper", ",", 
     "e\[Gamma]CutLower", ",", "e\[Gamma]CutUpper", ",", "eh0CutLower", ",", 
     "eh0CutUpper", ",", "Etot\[Gamma]\[Gamma]CutLower", ",", 
     "Etot\[Gamma]\[Gamma]CutUpper", ",", "Etoth0h0CutLower", ",", 
     "Etoth0h0CutUpper", ",", "EtotMixedNeutralCutLower", ",", 
     "EtotMixedNeutralCutUpper", ",", "IPcut", ",", "AngSepCut", ",", 
     "AngSepCutCharged", ",", "minvElCutLower", ",", "minvElCutUpper", ",", 
     "minv\[Mu]CutLower", ",", "minv\[Mu]CutUpper", ",", "minvHadrCutLower", 
     ",", "minvHadrCutUpper", ",", "minvMixedCutLower", ",", 
     "minvMixedCutUpper", ",", "minv\[Gamma]\[Gamma]CutLower", ",", 
     "minv\[Gamma]\[Gamma]CutUpper", ",", "minvh0h0CutLower", ",", 
     "minvh0h0CutUpper", ",", "minvMixedNeutralCutLower", ",", 
     "minvMixedNeutralCutUpper"}], "}"}], "//", "Clear"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"choice", "=", 
   RowBox[{"{", "\"\<All\>\"", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DynamicModule", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "inputValues", ",", "labels", ",", "symbols", ",", "inputFields", ",", 
      "submitButton"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"labels", "=", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Min/max \!\(\*SubscriptBox[\(p\), \(T\)]\) range of each charged \
decay product, in the form {\!\(\*SubscriptBox[\(p\), \(T, min\)]\), \
\!\(\*SubscriptBox[\(p\), \(T, max\)]\)}, for \!\(\*SuperscriptBox[\(e\), \(+\
\(\(/\)\(-\)\)\)]\), (1st bracket), \!\(\*SuperscriptBox[\(\[Mu]\), \
\(+\(\(/\)\(-\)\)\)]\) (2nd), hadrons \!\(\*SuperscriptBox[\(h\), \
\(+\(\(/\)\(-\)\)\)]\) (3rd)\>\"", ",", 
        "\"\<Min/max energy of each charged decay product, in the form \
{\!\(\*SubscriptBox[\(E\), \(min\)]\), \!\(\*SubscriptBox[\(E\), \(max\)]\)}, \
for \!\(\*SuperscriptBox[\(e\), \(+\(\(/\)\(-\)\)\)]\) (1st bracket), \
\!\(\*SuperscriptBox[\(\[Mu]\), \(+\(\(/\)\(-\)\)\)]\) (2nd), \
\!\(\*SuperscriptBox[\(h\), \(+\(\(/\)\(-\)\)\)]\) (3rd)\>\"", ",", 
        "\"\<Min/max total energy of two charged products, in the form \
{\!\(\*SubscriptBox[\(E\), \(min\)]\), \!\(\*SubscriptBox[\(E\), \(max\)]\)}, \
for \!\(\*SuperscriptBox[\(e\), \(+\)]\)\!\(\*SuperscriptBox[\(e\), \(-\)]\) \
(1st bracket), \!\(\*SuperscriptBox[\(\[Mu]\), \
\(+\)]\)\!\(\*SuperscriptBox[\(\[Mu]\), \(-\)]\) (2nd), \!\(\*SuperscriptBox[\
\(h\), \(+\)]\)\!\(\*SuperscriptBox[\(h\), \(-\)]\) (3rd), and mixed \
(4th)\>\"", ",", 
        "\"\<Min/max energy of each neutral product, in the form \
{\!\(\*SubscriptBox[\(E\), \(min\)]\), \!\(\*SubscriptBox[\(E\), \(max\)]\)}, \
for \[Gamma] (1st bracket) and neutral hadrons \!\(\*SuperscriptBox[\(h\), \
\(0\)]\) (2nd)\>\"", ",", 
        "\"\<Min/max total energy of a neutral pair, in the form \
{\!\(\*SubscriptBox[\(E\), \(min\)]\), \!\(\*SubscriptBox[\(E\), \(max\)]\)}, \
for \[Gamma]\[Gamma] (1st), \!\(\*SuperscriptBox[\(h\), \
\(0\)]\)\!\(\*SuperscriptBox[\(h\), \(0\)]\) (2nd), mixed (3rd)\>\"", ",", 
        "\"\<Transerse impact parameter cut from above for charged tracks (in \
m)\>\"", ",", 
        "\"\<Angular cut from below for photons/charged particles (in \
radians)\>\"", ",", 
        "\"\<Enter the lower and upper invariant mass cut for the two charged \
products, in the form {\!\(\*SubscriptBox[\(m\), \(inv, lower\)]\), \
\!\(\*SubscriptBox[\(m\), \(inv, upper\)]\)}, for \!\(\*SuperscriptBox[\(e\), \
\(+\)]\)\!\(\*SuperscriptBox[\(e\), \(-\)]\) (1st), \!\(\*SuperscriptBox[\(\
\[Mu]\), \(+\)]\)\!\(\*SuperscriptBox[\(\[Mu]\), \(-\)]\) (2nd), \
\!\(\*SuperscriptBox[\(h\), \(+\)]\)\!\(\*SuperscriptBox[\(h\), \(-\)]\) \
(3rd), mixed (4th)\>\"", ",", 
        "\"\<Enter the lower and upper invariant mass cut for the two neutral \
products, in the form {\!\(\*SubscriptBox[\(m\), \(inv, lower\)]\), \
\!\(\*SubscriptBox[\(m\), \(inv, upper\)]\)}, in the form \
{\!\(\*SubscriptBox[\(m\), \(inv, lower\)]\), \!\(\*SubscriptBox[\(m\), \
\(inv, upper\)]\)}, for \[Gamma]\[Gamma] (1st), \!\(\*SuperscriptBox[\(h\), \
\(0\)]\)\!\(\*SuperscriptBox[\(h\), \(0\)]\) (2nd), mixed (3rd)\>\""}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"inputValues", "=", 
      RowBox[{"zeros", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "999"}], ",", 
             RowBox[{"-", "999"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "999"}], ",", 
             RowBox[{"-", "999"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "999"}], ",", 
             RowBox[{"-", "999"}]}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "999"}], ",", 
             RowBox[{"-", "999"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "999"}], ",", 
             RowBox[{"-", "999"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "999"}], ",", 
             RowBox[{"-", "999"}]}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "999"}], ",", 
             RowBox[{"-", "999"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "999"}], ",", 
             RowBox[{"-", "999"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "999"}], ",", 
             RowBox[{"-", "999"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "999"}], ",", 
             RowBox[{"-", "999"}]}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "999"}], ",", 
             RowBox[{"-", "999"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "999"}], ",", 
             RowBox[{"-", "999"}]}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "999"}], ",", 
             RowBox[{"-", "999"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "999"}], ",", 
             RowBox[{"-", "999"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "999"}], ",", 
             RowBox[{"-", "999"}]}], "}"}]}], "}"}], ",", 
         RowBox[{"-", "999"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "999"}], ",", 
           RowBox[{"-", "999"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "999"}], ",", 
             RowBox[{"-", "999"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "999"}], ",", 
             RowBox[{"-", "999"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "999"}], ",", 
             RowBox[{"-", "999"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "999"}], ",", 
             RowBox[{"-", "999"}]}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "999"}], ",", 
             RowBox[{"-", "999"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "999"}], ",", 
             RowBox[{"-", "999"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "999"}], ",", 
             RowBox[{"-", "999"}]}], "}"}]}], "}"}]}], "}"}]}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"symbols", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"pTelCutLower", ",", "pTelCutUpper"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"pT\[Mu]CutLower", ",", "pT\[Mu]CutUpper"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"pThadrCutLower", ",", "pThadrCutUpper"}], "}"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"eElCutLower", ",", "eElCutUpper"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"e\[Mu]CutLower", ",", "e\[Mu]CutUpper"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"eHadrCutLower", ",", "eHadrCutUpper"}], "}"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"EtotElCutLower", ",", "EtotElCutUpper"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Etot\[Mu]CutLower", ",", "Etot\[Mu]CutUpper"}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"EtotHadrCutLower", ",", "EtotHadrCutUpper"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"EtotMixedCutLower", ",", "EtotMixedCutUpper"}], "}"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"e\[Gamma]CutLower", ",", "e\[Gamma]CutUpper"}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"eh0CutLower", ",", "eh0CutUpper"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "Etot\[Gamma]\[Gamma]CutLower", ",", 
            "Etot\[Gamma]\[Gamma]CutUpper"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Etoth0h0CutLower", ",", "Etoth0h0CutUpper"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "EtotMixedNeutralCutLower", ",", "EtotMixedNeutralCutUpper"}], 
           "}"}]}], "}"}], ",", "IPcut", ",", 
        RowBox[{"{", 
         RowBox[{"AngSepCut", ",", "AngSepCutCharged"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"minvElCutLower", ",", "minvElCutUpper"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"minv\[Mu]CutLower", ",", "minv\[Mu]CutUpper"}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"minvHadrCutLower", ",", "minvHadrCutUpper"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"minvMixedCutLower", ",", "minvMixedCutUpper"}], "}"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "minv\[Gamma]\[Gamma]CutLower", ",", 
            "minv\[Gamma]\[Gamma]CutUpper"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"minvh0h0CutLower", ",", "minvh0h0CutUpper"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "minvMixedNeutralCutLower", ",", "minvMixedNeutralCutUpper"}], 
           "}"}]}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"zerosvalues", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"pTcutLowerZero", ",", "pTcutUpperZero"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"pTcutLowerZero", ",", "pTcutUpperZero"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"pTcutLowerZero", ",", "pTcutUpperZero"}], "}"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"eCutLowerZero", ",", "eCutUpperZero"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"eCutLowerZero", ",", "eCutUpperZero"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"eCutLowerZero", ",", "eCutUpperZero"}], "}"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"eCutLowerZero", ",", "eCutUpperZero"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"eCutLowerZero", ",", "eCutUpperZero"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"eCutLowerZero", ",", "eCutUpperZero"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"eCutLowerZero", ",", "eCutUpperZero"}], "}"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"eCutLowerZero", ",", "eCutUpperZero"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"eCutLowerZero", ",", "eCutUpperZero"}], "}"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"eCutLowerZero", ",", "eCutUpperZero"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"eCutLowerZero", ",", "eCutUpperZero"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"eCutLowerZero", ",", "eCutUpperZero"}], "}"}]}], "}"}], 
        ",", "IPcutZero", ",", 
        RowBox[{"{", 
         RowBox[{"AngSepCutZero", ",", "AngSepCutZero"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"minvCutLowerZero", ",", "minvCutUpperZero"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"minvCutLowerZero", ",", "minvCutUpperZero"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"minvCutLowerZero", ",", "minvCutUpperZero"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"minvCutLowerZero", ",", "minvCutUpperZero"}], "}"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"minvCutLowerZero", ",", "minvCutUpperZero"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"minvCutLowerZero", ",", "minvCutUpperZero"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"minvCutLowerZero", ",", "minvCutUpperZero"}], "}"}]}], 
         "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "inputValues", "]"}], "!=", 
        RowBox[{"Length", "[", "labels", "]"}], "!=", 
        RowBox[{"Length", "[", "symbols", "]"}]}], ",", 
       RowBox[{
        RowBox[{
        "MessageDialog", "[", 
         "\"\<Error: The number of initial values does not match the number \
of labels.\>\"", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"productionSelector", "=", 
      RowBox[{"Column", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{
           "\"\<Select the particles that are detectable at \>\"", " ", "<>", 
            "GivenExperiment", "<>", "\"\<:\>\""}], ",", "Bold"}], "]"}], ",", 
         RowBox[{"TogglerBar", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "choice", "]"}], ",", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "\"\<All\>\"", "}"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"ParamPDGidToProduct", "[", "#", "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Abs", "[", "DetectablePDGsGivenExperiment", "]"}], "//",
                 "DeleteDuplicates"}], ")"}]}]}], "]"}], ",", 
           RowBox[{"Appearance", "->", 
            RowBox[{"\"\<Horizontal\>\"", "->", 
             RowBox[{"{", 
              RowBox[{"5", ",", "20"}], "}"}]}]}]}], "]"}]}], "}"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"inputFields", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", "=", "i"}], "}"}], ",", 
          RowBox[{"Column", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"labels", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\<:\>\""}], ",", 
             RowBox[{"InputField", "[", 
              RowBox[{
               RowBox[{"Dynamic", "[", 
                RowBox[{"inputValues", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "Expression", 
               ",", 
               RowBox[{"FieldSize", "->", 
                RowBox[{"{", 
                 RowBox[{"40", ",", "Automatic"}], "}"}]}]}], "]"}]}], "}"}], 
           "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "labels", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"introphr", "=", 
      RowBox[{"{", 
       RowBox[{"Style", "[", 
        RowBox[{
        "\"\<Impose the cuts on decay products. If the given cut should not \
be imposed enter -999 for each value (default choice). All the \
energy/\!\(\*SubscriptBox[\(p\), \(T\)]\) cuts are in GeV\>\"", ",", "Bold"}],
         "]"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"submitButton", "=", 
      RowBox[{"Button", "[", 
       RowBox[{"\"\<Submit\>\"", ",", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"Flatten", "[", 
            RowBox[{"MapThread", "[", 
             RowBox[{"Set", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Flatten", "[", "symbols", "]"}], ",", 
                RowBox[{"MapThread", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"#1", "===", "#2"}], ",", "#3", ",", "#1"}], 
                    "]"}], "&"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Flatten", "[", "inputValues", "]"}], ",", 
                    RowBox[{"Flatten", "[", "zeros", "]"}], ",", 
                    RowBox[{"Flatten", "[", "zerosvalues", "]"}]}], "}"}]}], 
                 "]"}]}], "}"}]}], "]"}], "]"}]}], "]"}], ";", " ", 
         RowBox[{"DialogReturn", "[", "Null", "]"}]}], ",", 
        RowBox[{"ImageSize", "->", "Automatic"}]}], "]"}]}], ";", "\n", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"submitButton", "=", 
        RowBox[{"Button", "[", 
         RowBox[{"\"\<Submit\>\"", ",", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"Flatten", "[", 
              RowBox[{"MapThread", "[", 
               RowBox[{"Set", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Flatten", "[", 
                   RowBox[{"symbols", ",", "1"}], "]"}], ",", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{"inputValues", ",", "1"}], "]"}]}], "}"}]}], "]"}],
               "]"}]}], "]"}], ";", " ", 
           RowBox[{"DialogReturn", "[", "Null", "]"}]}], ",", 
          RowBox[{"ImageSize", "->", "Automatic"}]}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"DialogInput", "[", 
      RowBox[{"Column", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{
         "productionSelector", ",", "introphr", ",", "\"\< \>\"", ",", 
          "inputFields", ",", "submitButton"}], "}"}], "]"}], "]"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"choice", "==", 
      RowBox[{"{", "}"}]}], "||", 
     RowBox[{"MemberQ", "[", 
      RowBox[{"choice", ",", "\"\<All\>\""}], "]"}]}], ",", 
    RowBox[{"choice", "=", 
     RowBox[{"{", "\"\<All\>\"", "}"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"choice", "!=", 
     RowBox[{"{", "\"\<All\>\"", "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DetectablePDGsGivenExperimentTemp", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ParamProductToPDGid", "[", "#", "]"}], "&"}], "/@", 
         "choice"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"ParamProductToPDGid", "[", "#", "]"}]}], "&"}], "/@", 
         "choice"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DetectablePDGsGivenExperiment", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"DetectablePDGsGivenExperimentTemp", ",", 
          RowBox[{
           RowBox[{"FreeQ", "[", 
            RowBox[{
             RowBox[{"ParamPDGidToProduct", "[", "#", "]"}], ",", "Missing"}],
             "]"}], "&"}]}], "]"}], "//", "N"}], "//", "Sort"}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<List of PDGs of detectable particles:\>\"", 
  "]"}], "\[IndentingNewLine]", "DetectablePDGsGivenExperiment"}], "Input",
 CellChangeTimes->{{3.8862395123902965`*^9, 3.886239583049287*^9}, {
   3.8862614265933056`*^9, 3.886261427405651*^9}, {3.8863205546619196`*^9, 
   3.886320555235077*^9}, {3.886321463607978*^9, 3.886321464435209*^9}, {
   3.886321819423191*^9, 3.8863218206744995`*^9}, {3.886323160464417*^9, 
   3.886323162947709*^9}, {3.8863236963452435`*^9, 3.886323697877537*^9}, {
   3.8863246001448927`*^9, 3.88632463766989*^9}, 3.8863246738954725`*^9, {
   3.886406411833415*^9, 3.8864065245112395`*^9}, {3.8864073857936664`*^9, 
   3.8864073864221144`*^9}, {3.8864075159033737`*^9, 3.886407517965285*^9}, {
   3.8864082670760336`*^9, 3.8864082679023447`*^9}, {3.8864085032398806`*^9, 
   3.8864085043449306`*^9}, {3.8864111528778505`*^9, 3.886411155496108*^9}, {
   3.8864114351630583`*^9, 3.886411435949088*^9}, {3.8864116107952433`*^9, 
   3.8864116113448763`*^9}, {3.8864339822607136`*^9, 3.886433983114958*^9}, {
   3.8864356385769234`*^9, 3.886435640512048*^9}, {3.886435938327056*^9, 
   3.886435938790553*^9}, {3.8864360178252563`*^9, 3.8864360185983143`*^9}, {
   3.886477242021925*^9, 3.8864772433998175`*^9}, {3.886523046141382*^9, 
   3.886523046717943*^9}, {3.8869230035015373`*^9, 3.8869230043363614`*^9}, {
   3.886923134570159*^9, 3.886923135113418*^9}, {3.8871279473729877`*^9, 
   3.887127949272484*^9}, {3.8871290895488167`*^9, 3.887129090029354*^9}, {
   3.8871799986764126`*^9, 3.8871800009018803`*^9}, {3.887180401806629*^9, 
   3.887180402651722*^9}, {3.887186564600072*^9, 3.8871865669390526`*^9}, {
   3.88718705509645*^9, 3.887187057831586*^9}, {3.8872058711188154`*^9, 
   3.887205871638158*^9}, {3.88720693968042*^9, 3.887206941243812*^9}, {
   3.8872099692091823`*^9, 3.887209969671775*^9}, {3.887211413766818*^9, 
   3.8872114146200285`*^9}, {3.887211932832594*^9, 3.887211933282428*^9}, {
   3.887253582955886*^9, 3.887253584332303*^9}, {3.8872721877980585`*^9, 
   3.8872721885782585`*^9}, {3.8873380092349606`*^9, 3.887338010554838*^9}, {
   3.8875292303518243`*^9, 3.887529231201189*^9}, {3.8875302300157824`*^9, 
   3.887530233979493*^9}, {3.8875314760706687`*^9, 3.8875314773136625`*^9}, {
   3.8875335849124703`*^9, 3.887533585089736*^9}, {3.8875599973319736`*^9, 
   3.887560006568223*^9}, {3.887560183083761*^9, 3.887560187244735*^9}, {
   3.8875607209798946`*^9, 3.8875607534207225`*^9}, {3.887560882751191*^9, 
   3.8875608908330793`*^9}, {3.887612556360304*^9, 3.887612559072115*^9}, {
   3.887614321592123*^9, 3.887614367138612*^9}, {3.887615893819663*^9, 
   3.887615894504799*^9}, {3.8876160982844324`*^9, 3.887616099498848*^9}, {
   3.8876181134809046`*^9, 3.887618114215395*^9}, {3.8876182032892027`*^9, 
   3.8876182038265295`*^9}, {3.887632684483673*^9, 3.887632687213397*^9}, {
   3.887688870870682*^9, 3.887688871386403*^9}, {3.8877068944260893`*^9, 
   3.8877068956729803`*^9}, {3.887713922235078*^9, 3.887713922356718*^9}, {
   3.887734706053899*^9, 3.8877347103239484`*^9}, {3.8877730517046137`*^9, 
   3.8877730853334475`*^9}, 3.8877732608622713`*^9, 3.8877760717092247`*^9, {
   3.8883779829298964`*^9, 3.8883780022609177`*^9}, 3.8902923985687885`*^9, {
   3.8905554903814497`*^9, 3.890555539297676*^9}, {3.8932333535373397`*^9, 
   3.8932333538996873`*^9}, 3.893233409047794*^9, {3.8932334667095785`*^9, 
   3.8932334723722477`*^9}, {3.893233503285507*^9, 3.8932335134986534`*^9}, {
   3.893233566335312*^9, 3.8932335879818416`*^9}, {3.8932336695523367`*^9, 
   3.893233683999921*^9}, 3.8933148502437077`*^9, 3.893318177775519*^9, {
   3.8933257138387957`*^9, 3.893325753953617*^9}, {3.8933882501339645`*^9, 
   3.893388462123291*^9}, {3.893389104378008*^9, 3.89338918200423*^9}, {
   3.893391295379231*^9, 3.8933913047467933`*^9}, {3.893391774005262*^9, 
   3.893391949450411*^9}, {3.893391998289749*^9, 3.893392050613307*^9}, {
   3.893392099995363*^9, 3.8933925172343173`*^9}, {3.8933925655517592`*^9, 
   3.893392571091895*^9}, {3.8933926241527405`*^9, 3.89339263126077*^9}, {
   3.893396482427949*^9, 3.893396557784583*^9}, {3.893396684842353*^9, 
   3.89339683185153*^9}, {3.8934008462855034`*^9, 3.8934008812412148`*^9}, {
   3.8934009451730413`*^9, 3.8934009767352686`*^9}, {3.8934010296334505`*^9, 
   3.8934010458169637`*^9}, {3.893401227810811*^9, 3.8934012673432436`*^9}, {
   3.893401368763983*^9, 3.8934014794184704`*^9}, {3.8934016306534986`*^9, 
   3.893401683574726*^9}, {3.89340175460909*^9, 3.8934017655042048`*^9}, {
   3.893401911680187*^9, 3.8934019125186853`*^9}, {3.8934024675250006`*^9, 
   3.8934024877628546`*^9}, {3.893424455207156*^9, 3.89342452822206*^9}, 
   3.893424575738535*^9, {3.8934246627256737`*^9, 3.893424698855917*^9}, {
   3.893424743023193*^9, 3.893424768084998*^9}, 3.8934257236674004`*^9, {
   3.893427505839426*^9, 3.8934275330094557`*^9}, {3.8934276336290026`*^9, 
   3.893427749296693*^9}, {3.8934341740469685`*^9, 3.893434179798005*^9}, {
   3.89343435894029*^9, 3.893434363941669*^9}, {3.8934344505407686`*^9, 
   3.893434455434524*^9}, {3.893519727739212*^9, 3.8935197385631623`*^9}, {
   3.895036844613934*^9, 3.895036855852393*^9}, {3.8950369417490597`*^9, 
   3.8950371281437893`*^9}, {3.8950372487481894`*^9, 3.8950372857215843`*^9}, 
   3.8965201047712927`*^9, {3.8967777579414663`*^9, 3.89677786409251*^9}, {
   3.8968417251071415`*^9, 3.896841765657221*^9}, {3.8984950183436623`*^9, 
   3.8984950246396728`*^9}, {3.8985295634712677`*^9, 3.898529567165951*^9}, {
   3.902557780874288*^9, 3.902557866211647*^9}, {3.902557981591077*^9, 
   3.9025579899114265`*^9}, {3.9025580651307335`*^9, 
   3.9025580655245795`*^9}, {3.9055055560432*^9, 3.905505560023321*^9}, {
   3.9055056599476786`*^9, 3.9055060301765995`*^9}, {3.9055061089044313`*^9, 
   3.905506305001817*^9}, 3.9055063905154386`*^9, {3.9055064265331435`*^9, 
   3.9055064326573524`*^9}, {3.9055066588380513`*^9, 
   3.9055071436276817`*^9}, {3.9055071941592083`*^9, 3.905507211164139*^9}, {
   3.905507315895624*^9, 3.905507316493407*^9}, {3.9055073691145926`*^9, 
   3.905507388634494*^9}, {3.9055074900590167`*^9, 3.9055077968836594`*^9}, {
   3.9055078653773737`*^9, 3.9055079063743176`*^9}, {3.9055079527647085`*^9, 
   3.9055080343991404`*^9}, {3.905508064602247*^9, 3.90550806922855*^9}, {
   3.905508159514989*^9, 3.9055081925087376`*^9}, {3.9055082729539967`*^9, 
   3.905508285789571*^9}, {3.9055083498077765`*^9, 3.905508390561697*^9}, 
   3.905508636326395*^9, {3.905508720515654*^9, 3.905508741090497*^9}, {
   3.905508776264496*^9, 3.905508799594994*^9}, 3.9055088687281065`*^9, {
   3.9055090006067486`*^9, 3.9055090299962916`*^9}, {3.9055091990506625`*^9, 
   3.905509228935583*^9}, {3.9055133059477935`*^9, 3.9055134180618887`*^9}, {
   3.9055162936281137`*^9, 3.9055163339918346`*^9}, {3.905516372466316*^9, 
   3.905516395001636*^9}, {3.9055167599691935`*^9, 3.9055170276077876`*^9}, {
   3.905517093560919*^9, 3.905517128276893*^9}, {3.905517167605284*^9, 
   3.90551720728405*^9}, {3.9055173249495835`*^9, 3.905517463610935*^9}, {
   3.9055175344684167`*^9, 3.9055175388257294`*^9}, {3.905667436157593*^9, 
   3.905667446429618*^9}, {3.9056687008834505`*^9, 3.9056687347773666`*^9}, {
   3.90566878932382*^9, 3.9056688043407125`*^9}, 3.905668977395052*^9, {
   3.905698435153984*^9, 3.905698517308263*^9}, {3.905698587449051*^9, 
   3.9056985999462366`*^9}, {3.90569889782007*^9, 3.9056989233950152`*^9}, {
   3.9056989553937263`*^9, 3.9056989556711826`*^9}, {3.905699001817792*^9, 
   3.9056990433552065`*^9}, {3.9056991381411953`*^9, 3.905699138953631*^9}, {
   3.905699238730953*^9, 3.905699247996553*^9}, {3.905699318681655*^9, 
   3.9056993973629475`*^9}, {3.905699429773856*^9, 3.9056994698267784`*^9}, {
   3.905699507213558*^9, 3.9056995605584574`*^9}, 3.905699669695407*^9, {
   3.9056997158008184`*^9, 3.905699757496434*^9}, {3.905701028882305*^9, 
   3.9057010561009207`*^9}, {3.9057011769329095`*^9, 
   3.9057011857139206`*^9}, {3.91017392414937*^9, 3.9101740114218283`*^9}, {
   3.910174742576885*^9, 3.9101749789931145`*^9}, {3.9101750306192136`*^9, 
   3.910175047189313*^9}, {3.910175157104765*^9, 3.9101752837454495`*^9}, {
   3.9102493077384977`*^9, 3.9102493180035925`*^9}, {3.9120758694476604`*^9, 
   3.9120758914673357`*^9}, {3.9121574291635084`*^9, 
   3.9121574296657777`*^9}, {3.912158976542296*^9, 3.912158976887396*^9}, {
   3.91215901002857*^9, 3.912159082210735*^9}, {3.912159206427122*^9, 
   3.9121592340564437`*^9}, {3.9124985567534065`*^9, 3.91249859624119*^9}, {
   3.9125003299152737`*^9, 3.912500366952034*^9}, {3.912500455530143*^9, 
   3.912500537282131*^9}, {3.9125005745067015`*^9, 3.91250065419954*^9}, {
   3.9125006985872145`*^9, 3.9125008413616204`*^9}, {3.9125010892650733`*^9, 
   3.912501109139593*^9}, {3.9125011843572044`*^9, 3.9125012945604444`*^9}, {
   3.9125013293154144`*^9, 3.912501379242343*^9}, {3.9125014216242576`*^9, 
   3.9125014270295687`*^9}, {3.9125016764481564`*^9, 
   3.9125016864685464`*^9}, {3.9125017275300817`*^9, 
   3.9125017388542705`*^9}, {3.912501821474018*^9, 3.9125019663309126`*^9}, {
   3.912502010772153*^9, 3.912502016781851*^9}, {3.9125020800590415`*^9, 
   3.912502149453071*^9}, {3.9125025476758313`*^9, 3.9125025636143436`*^9}, {
   3.912502604823943*^9, 3.9125027174678745`*^9}, {3.9125027760120864`*^9, 
   3.912502830352152*^9}, {3.9125029844461765`*^9, 3.9125029862258606`*^9}, {
   3.9125030713041153`*^9, 3.9125034235333757`*^9}, {3.9125035358354454`*^9, 
   3.912503701205196*^9}, {3.912503737784069*^9, 3.91250380581437*^9}, {
   3.912503841578417*^9, 3.912503856433193*^9}, {3.912504383413185*^9, 
   3.9125043839985466`*^9}, {3.9125307087149987`*^9, 
   3.9125308799003296`*^9}, {3.912531059051177*^9, 3.9125311663339844`*^9}, {
   3.9125341465349617`*^9, 3.9125341481299934`*^9}, {3.9126569993698144`*^9, 
   3.91265699955319*^9}, {3.9126572713892574`*^9, 3.912657453052541*^9}, {
   3.9139785549872684`*^9, 3.913978559452183*^9}, {3.914146835665142*^9, 
   3.914146852000824*^9}, {3.9141468916650877`*^9, 3.914146917080638*^9}, {
   3.9142997891426744`*^9, 3.914299828429942*^9}, {3.9149934246270685`*^9, 
   3.914993466074767*^9}, {3.915182967668269*^9, 3.9151830095678225`*^9}, {
   3.9151830646855774`*^9, 3.915183070151479*^9}, {3.9151832647262177`*^9, 
   3.9151832687942734`*^9}, {3.915183314681617*^9, 3.9151833708433247`*^9}, {
   3.915183431098007*^9, 3.915183446722087*^9}, {3.9152065318409424`*^9, 
   3.9152065336609187`*^9}, {3.915261834639846*^9, 3.9152618605825844`*^9}, 
   3.9168899406824102`*^9, 3.9168993526796055`*^9, 3.916899388606738*^9},
 CellTags->{"Evaluation", "Re-evaluation"},
 CellLabel->"In[5]:=",ExpressionUUID->"222b649c-d0d0-4e4e-90ac-20f5b01506c5"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\"\<Experiment\>\"", "\"\<Facility\>\"", 
     "\"\<Decay volume as detector\>\"", "\"\<If ECAL is present\>\"", 
     "\"\<If dipole magnet is present\>\"", 
     "\"\<\!\(\*SubscriptBox[\(E\), \(LLP, max\)]\)\>\""},
    {"\"\<ANUBIS-ceiling\>\"", "\"\<LHC\>\"", "\"\<False\>\"", 
     "\"\<False\>\"", "\"\<False\>\"", "7000.`"}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Input",
 CellChangeTimes->{{3.9168899406824102`*^9, 3.9168899406824102`*^9}},
 CellTags->{"Evaluation", "Re-evaluation"},
 CellLabel->"In[25]:=",ExpressionUUID->"21b5be0d-8608-4a68-9966-97f8bc3357d7"],

Cell[CellGroupData[{

Cell["Displaying cuts", "Section",
 CellChangeTimes->{{3.90570092403391*^9, 3.905700944394094*^9}, 
   3.9125342998910933`*^9},
 CellTags->{
  "Evaluation", 
   "Re-evaluation"},ExpressionUUID->"dbbace72-7cb7-41ad-91b5-df16cb2ce6bf"],

Cell[CellGroupData[{

Cell["Creating functions with cuts", "Subsection",
 CellChangeTimes->{{3.912531648668831*^9, 3.9125316541920595`*^9}},
 CellTags->{
  "Evaluation", 
   "Re-evaluation"},ExpressionUUID->"dc453ba5-d8f2-4400-a0e8-3d01db899a22"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"createCompiledFunctionpT", "[", 
    RowBox[{"zeroValue_", ",", "elcut_", ",", "\[Mu]cut_", ",", "hadrcut_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"Hold", "@", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"id", ",", "_Real"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"charge", ",", "_Real"}], "}"}]}], "}"}], ",", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"cut", ",", "absid"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"cut", "=", "zeroValue"}], ";", "\[IndentingNewLine]", 
          RowBox[{"absid", "=", 
           RowBox[{"Abs", "[", "id", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"charge", "!=", "0."}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"cut", "=", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"absid", "==", "11."}], ",", "elcut", ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"absid", "==", "13."}], ",", "\[Mu]cut", ",", 
                  "hadrcut"}], "]"}]}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "cut"}]}], "\[IndentingNewLine]", "]"}], ",", 
       RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
       RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
       RowBox[{"RuntimeAttributes", "->", 
        RowBox[{"{", "Listable", "}"}]}], ",", 
       RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], "//", 
    "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pTcutLowerID", "=", 
   RowBox[{"createCompiledFunctionpT", "[", 
    RowBox[{
    "pTcutLowerZero", ",", "pTelCutLower", ",", "pT\[Mu]CutLower", ",", 
     "pThadrCutLower"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pTcutUpperID", "=", 
   RowBox[{"createCompiledFunctionpT", "[", 
    RowBox[{
    "pTcutUpperZero", ",", "pTelCutUpper", ",", "pT\[Mu]CutUpper", ",", 
     "pThadrCutUpper"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "CompiledFunctionTools`"}], "\n", 
 RowBox[{
  RowBox[{"CompilePrint", "@", "pTcutLowerID"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"createCompiledFunctionE", "[", 
   RowBox[{
   "zeroValue_", ",", "\[Gamma]cut_", ",", "h0cut_", ",", "elcut_", ",", 
    "\[Mu]cut_", ",", "hadrcut_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Hold", "@", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"id", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"charge", ",", "_Real"}], "}"}]}], "}"}], ",", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"cut", ",", "absid"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"cut", "=", "zeroValue"}], ";", "\[IndentingNewLine]", 
         RowBox[{"absid", "=", 
          RowBox[{"Abs", "[", "id", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"charge", "==", "0."}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"cut", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"absid", "==", "22."}], ",", "\[Gamma]cut", ",", 
               "h0cut"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"charge", "!=", "0."}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"cut", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"absid", "==", "11."}], ",", "elcut", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"absid", "==", "13."}], ",", "\[Mu]cut", ",", 
                 "hadrcut"}], "]"}]}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "cut"}]}],
        "\[IndentingNewLine]", "]"}], ",", 
      RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
      RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
      RowBox[{"RuntimeAttributes", "->", 
       RowBox[{"{", "Listable", "}"}]}], ",", 
      RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], "//", 
   "ReleaseHold"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ecutLowerID", "=", 
   RowBox[{"createCompiledFunctionE", "[", 
    RowBox[{
    "eCutLowerZero", ",", "e\[Gamma]CutLower", ",", "eh0CutLower", ",", 
     "eElCutLower", ",", "e\[Mu]CutLower", ",", "eHadrCutLower"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ecutUpperID", "=", 
   RowBox[{"createCompiledFunctionE", "[", 
    RowBox[{
    "eCutUpperZero", ",", "e\[Gamma]CutUpper", ",", "eh0CutUpper", ",", 
     "eElCutUpper", ",", "e\[Mu]CutUpper", ",", "eHadrCutUpper"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "CompiledFunctionTools`"}], "\n", 
 RowBox[{
  RowBox[{"CompilePrint", "@", "ecutLowerID"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"createCompiledFunction", "[", 
    RowBox[{
    "zeroValue_", ",", "h0h0Cut_", ",", "gammaGammaCut_", ",", 
     "mixedNeutralCut_", ",", "hadrCut_", ",", "muCut_", ",", "elCut_", ",", 
     "mixedCut_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Hold", "@", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"id1", ",", "_Real"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"charge1", ",", "_Real"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"id2", ",", "_Real"}], "}"}]}], "}"}], ",", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "cut", ",", "absid1", ",", "absid2", ",", "condel1", ",", "condel2",
            ",", "condMu1", ",", "condMu2"}], "}"}], ",", 
         RowBox[{
          RowBox[{"cut", "=", "zeroValue"}], ";", "\[IndentingNewLine]", 
          RowBox[{"absid1", "=", 
           RowBox[{"Abs", "[", "id1", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"absid2", "=", 
           RowBox[{"Abs", "[", "id2", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"charge1", "==", "0."}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"cut", "=", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"id2", "!=", "id1"}], ",", "mixedNeutralCut", ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"id1", "==", "22."}], ",", "gammaGammaCut", ",", 
                  "h0h0Cut"}], "]"}]}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"charge1", "!=", "0."}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"condel1", ",", "condel2"}], "}"}], "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"absid1", "==", "11."}], ",", "1.", ",", "0."}], 
                 "]"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"absid2", "==", "11."}], ",", "1.", ",", "0."}], 
                 "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"condMu1", ",", "condMu2"}], "}"}], "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"absid1", "==", "13."}], ",", "1.", ",", "0."}], 
                 "]"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"absid2", "==", "13."}], ",", "1.", ",", "0."}], 
                 "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"cut", "=", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "condel1", "+", "condel2", "+", "condMu1", "+", "condMu2"}], 
                 "==", "0."}], ",", "hadrCut", ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"condel1", "*", "condel2"}], ",", 
                    RowBox[{"condMu1", "*", "condMu2"}]}], "]"}], "==", 
                   "0."}], ",", "mixedCut", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"condel1", "*", "condel2"}], "==", "1."}], ",", 
                    "elCut", ",", "muCut"}], "]"}]}], "]"}]}], "]"}]}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", "cut"}]}], "]"}], ",", 
       RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
       RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
       RowBox[{"RuntimeAttributes", "->", 
        RowBox[{"{", "Listable", "}"}]}], ",", 
       RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], 
    RowBox[{"(*", 
     RowBox[{"/.", " ", 
      RowBox[{"ruleOwn", "[", 
       RowBox[{"{", 
        RowBox[{
        "zeroValue", ",", "h0h0Cut", ",", "gammaGammaCut", ",", 
         "mixedNeutralCut", ",", "hadrCut", ",", "muCut", ",", "elCut", ",", 
         "mixedCut"}], "}"}], "]"}]}], "*)"}], "//", "ReleaseHold"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EtotCutLowerID", "=", 
   RowBox[{"createCompiledFunction", "[", 
    RowBox[{
    "eTotCutLowerZero", ",", "Etoth0h0CutLower", ",", 
     "Etot\[Gamma]\[Gamma]CutLower", ",", "EtotMixedNeutralCutLower", ",", 
     "EtotHadrCutLower", ",", "Etot\[Mu]CutLower", ",", "EtotElCutLower", ",",
      "EtotMixedCutLower"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"EtotCutUpperID", "=", 
   RowBox[{"createCompiledFunction", "[", 
    RowBox[{
    "eTotCutUpperZero", ",", "Etoth0h0CutUpper", ",", 
     "Etot\[Gamma]\[Gamma]CutUpper", ",", "EtotMixedNeutralCutUpper", ",", 
     "EtotHadrCutUpper", ",", "Etot\[Mu]CutUpper", ",", "EtotElCutUpper", ",",
      "EtotMixedCutUpper"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minvCutLowerID", "=", 
   RowBox[{"createCompiledFunction", "[", 
    RowBox[{
    "minvCutLowerZero", ",", "minvh0h0CutLower", ",", 
     "minv\[Gamma]\[Gamma]CutLower", ",", "minvMixedNeutralCutLower", ",", 
     "minvHadrCutLower", ",", "minv\[Mu]CutLower", ",", "minvElCutLower", ",",
      "minvMixedCutLower"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"minvCutUpperID", "=", 
   RowBox[{"createCompiledFunction", "[", 
    RowBox[{
    "minvCutUpperZero", ",", "minvh0h0CutUpper", ",", 
     "minv\[Gamma]\[Gamma]CutUpper", ",", "minvMixedNeutralCutUpper", ",", 
     "minvHadrCutUpper", ",", "minv\[Mu]CutUpper", ",", "minvElCutUpper", ",",
      "minvMixedCutUpper"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "CompiledFunctionTools`"}], "\n", 
 RowBox[{
  RowBox[{"CompilePrint", "@", "EtotCutUpperID"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AngSepCutID", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Hold", "@", 
      RowBox[{"Compile", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"id1", ",", "_Real"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"id2", ",", "_Real"}], "}"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"id1", "==", "22."}], "||", 
           RowBox[{"id1", "==", "130."}]}], ",", "AngSepCut", ",", 
          "AngSepCutCharged"}], "]"}], ",", 
        RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
        RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
        RowBox[{"RuntimeAttributes", "->", 
         RowBox[{"{", "Listable", "}"}]}], ",", 
        RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], "/.", 
     RowBox[{"ruleOwn", "[", 
      RowBox[{"{", 
       RowBox[{"AngSepCut", ",", "AngSepCutZero", ",", "AngSepCutCharged"}], 
       "}"}], "]"}]}], "//", "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"IPcutID", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Hold", "@", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"id1", ",", "_Real"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"id2", ",", "_Real"}], "}"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"id1", "!=", "22."}], "&&", 
          RowBox[{"id1", "!=", "2112."}], "&&", 
          RowBox[{"id1", "!=", "130."}]}], ",", "IPcut", ",", "IPcutZero"}], 
        "]"}], ",", 
       RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
       RowBox[{"RuntimeAttributes", "->", 
        RowBox[{"{", "Listable", "}"}]}], ",", 
       RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
       RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], "/.", 
    RowBox[{"ruleOwn", "[", 
     RowBox[{"{", 
      RowBox[{"IPcut", ",", "IPcutZero"}], "}"}], "]"}]}], "//", 
   "ReleaseHold"}]}]}], "Input",
 CellChangeTimes->{{3.912504527654226*^9, 3.9125045636240673`*^9}, {
   3.912504640662071*^9, 3.9125046466374917`*^9}, {3.9125048290717735`*^9, 
   3.9125048352209883`*^9}, {3.9125269000892096`*^9, 3.912527235817834*^9}, {
   3.912527276355158*^9, 3.9125274943632984`*^9}, {3.9125279053400207`*^9, 
   3.9125279347359495`*^9}, {3.912528029084727*^9, 3.9125280435568657`*^9}, {
   3.9125282367668805`*^9, 3.912528294828271*^9}, 3.9125283507930756`*^9, {
   3.912528415562868*^9, 3.912528474049858*^9}, {3.912528815296932*^9, 
   3.9125289192480845`*^9}, {3.9125289502857466`*^9, 
   3.9125289832351313`*^9}, {3.9125290828852105`*^9, 
   3.9125291556273265`*^9}, {3.9125293432084246`*^9, 
   3.9125294105286074`*^9}, {3.9125294719208384`*^9, 3.912529544474292*^9}, {
   3.9125295791585517`*^9, 3.9125298364773426`*^9}, {3.9125298785411386`*^9, 
   3.9125299388541527`*^9}, {3.9125299700524273`*^9, 
   3.9125300154172473`*^9}, {3.912530107115341*^9, 3.912530274561037*^9}, {
   3.912530305523058*^9, 3.9125303159086633`*^9}, {3.9125303541784306`*^9, 
   3.9125303584651537`*^9}, {3.9125303918730183`*^9, 
   3.9125304484120045`*^9}, {3.9125304894052553`*^9, 
   3.9125305277927227`*^9}, {3.912530572074617*^9, 3.9125305730671883`*^9}, {
   3.912531018658987*^9, 3.9125310197569985`*^9}, {3.9125312785610948`*^9, 
   3.9125312969667444`*^9}, 3.9125316340782185`*^9, {3.912532114886708*^9, 
   3.9125321440663376`*^9}, {3.9125331835571156`*^9, 
   3.9125333510713105`*^9}, {3.912533396288772*^9, 3.9125335047181225`*^9}, {
   3.9125335375011497`*^9, 3.9125336908487997`*^9}, {3.9125337351643004`*^9, 
   3.912533770057849*^9}, {3.912533926577623*^9, 3.912533964504117*^9}, {
   3.9149934653351126`*^9, 3.9149934653351126`*^9}, {3.9151831082871456`*^9, 
   3.9151831354145966`*^9}, {3.915189726124095*^9, 3.9151897416926823`*^9}, 
   3.91689070726515*^9},
 CellTags->{"Evaluation", "Re-evaluation"},
 CellLabel->"In[26]:=",ExpressionUUID->"1f57ba00-dab2-4e11-9e20-d271c6dfde08"]
}, Closed]],

Cell[CellGroupData[{

Cell["Visualization of the cuts", "Subsection",
 CellChangeTimes->{{3.9125342085302763`*^9, 3.9125342182148285`*^9}},
 CellTags->{
  "Evaluation", 
   "Re-evaluation"},ExpressionUUID->"086c760b-5c04-4092-95c6-5d5fa2b92a12"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tabbcuts", "=", 
   RowBox[{"SortBy", "[", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"id1", ",", "id2", ",", 
             RowBox[{"ParamPDGidToProduct", "[", "id1", "]"}], ",", 
             RowBox[{"ParamPDGidToProduct", "[", "id2", "]"}], ",", 
             RowBox[{"ParamProductCharge", "[", "id1", "]"}], ",", 
             RowBox[{"ParamProductCharge", "[", "id2", "]"}], ",", 
             RowBox[{"ecutLowerID", "[", 
              RowBox[{
               RowBox[{"id1", "//", "N"}], ",", 
               RowBox[{
                RowBox[{"ParamProductCharge", "[", "id1", "]"}], "//", 
                "N"}]}], "]"}], ",", 
             RowBox[{"ecutUpperID", "[", 
              RowBox[{
               RowBox[{"id1", "//", "N"}], ",", 
               RowBox[{
                RowBox[{"ParamProductCharge", "[", "id1", "]"}], "//", 
                "N"}]}], "]"}], ",", 
             RowBox[{"pTcutLowerID", "[", 
              RowBox[{
               RowBox[{"id1", "//", "N"}], ",", 
               RowBox[{"ParamProductCharge", "[", "id1", "]"}]}], "]"}], ",", 
             RowBox[{"pTcutUpperID", "[", 
              RowBox[{
               RowBox[{"id1", "//", "N"}], ",", 
               RowBox[{
                RowBox[{"ParamProductCharge", "[", "id1", "]"}], "//", 
                "N"}]}], "]"}], ",", 
             RowBox[{"EtotCutLowerID", "[", 
              RowBox[{
               RowBox[{"id1", "//", "N"}], ",", 
               RowBox[{
                RowBox[{"ParamProductCharge", "[", "id1", "]"}], "//", "N"}], 
               ",", 
               RowBox[{"id2", "//", "N"}]}], "]"}], ",", 
             RowBox[{"EtotCutUpperID", "[", 
              RowBox[{
               RowBox[{"id1", "//", "N"}], ",", 
               RowBox[{
                RowBox[{"ParamProductCharge", "[", "id1", "]"}], "//", "N"}], 
               ",", 
               RowBox[{"id2", "//", "N"}]}], "]"}], ",", 
             RowBox[{"IPcutID", "[", 
              RowBox[{
               RowBox[{"id1", "//", "N"}], ",", 
               RowBox[{"id2", "//", "N"}]}], "]"}], ",", 
             RowBox[{"AngSepCutID", "[", 
              RowBox[{
               RowBox[{"id1", "//", "N"}], ",", 
               RowBox[{"id2", "//", "N"}]}], "]"}], ",", 
             RowBox[{"minvCutLowerID", "[", 
              RowBox[{
               RowBox[{"id1", "//", "N"}], ",", 
               RowBox[{
                RowBox[{"ParamProductCharge", "[", "id1", "]"}], "//", "N"}], 
               ",", 
               RowBox[{"id2", "//", "N"}]}], "]"}], ",", 
             RowBox[{"minvCutUpperID", "[", 
              RowBox[{
               RowBox[{"id1", "//", "N"}], ",", 
               RowBox[{
                RowBox[{"ParamProductCharge", "[", "id1", "]"}], "//", "N"}], 
               ",", 
               RowBox[{"id2", "//", "N"}]}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"id1", ",", "detectablepdgs"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"id2", ",", "detectablepdgs"}], "}"}]}], "]"}], ",", 
         "1"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "5", "]"}], "]"}], "+", 
           RowBox[{"#", "[", 
            RowBox[{"[", "6", "]"}], "]"}]}], "\[Equal]", "0"}], "&&", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "<=", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "&"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "&"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cutsmeaning", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<\!\(\*SubscriptBox[\(pdg\), \(1\)]\)\>\"", ",", 
     "\"\<\!\(\*SubscriptBox[\(pdg\), \(2\)]\)\>\"", ",", 
     "\"\<\!\(\*SubscriptBox[\(id\), \(1\)]\)\>\"", ",", 
     "\"\<\!\(\*SubscriptBox[\(id\), \(2\)]\)\>\"", ",", 
     "\"\<\!\(\*SubscriptBox[\(Q\), \(prod, 1\)]\)\>\"", ",", 
     "\"\<\!\(\*SubscriptBox[\(Q\), \(prod, 2\)]\)\>\"", ",", 
     "\"\<\!\(\*SubscriptBox[\(E\), \(min, 1\)]\) (GeV)\>\"", ",", 
     "\"\<\!\(\*SubscriptBox[\(E\), \(max, 1\)]\) (GeV)\>\"", ",", 
     "\"\<\!\(\*SubscriptBox[\(p\), \(T, min, 1\)]\) (GeV)\>\"", ",", 
     "\"\<\!\(\*SubscriptBox[\(p\), \(T, max, 1\)]\) (GeV)\>\"", ",", 
     "\"\<\!\(\*FractionBox[SubscriptBox[\(E\), \(min, 1 + 2\)], \(GeV\)]\)\>\
\"", ",", 
     "\"\<\!\(\*FractionBox[SubscriptBox[\(E\), \(max, 1 + 2\)], \(GeV\)]\)\>\
\"", ",", "\"\<IP cut (m)\>\"", ",", "\"\<angular separation cut (rad)\>\"", 
     ",", "\"\<\!\(\*SubscriptBox[\(m\), \(inv, min\)]\) (GeV)\>\"", ",", 
     "\"\<\!\(\*SubscriptBox[\(m\), \(inv, max\)]\) (GeV)\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{"1", ",", 
        RowBox[{"Length", "[", "cutsmeaning", "]"}]}], "]"}], ",", 
      "cutsmeaning"}], "}"}], ",", "tabbcuts"}], "]"}], "//", 
  "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IfEcuts", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Select", "[", 
        RowBox[{"tabbcuts", ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "7", "]"}], "]"}], "!=", "eCutLowerZero"}], "||", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "8", "]"}], "]"}], "!=", "eCutUpperZero"}], "||", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "11", "]"}], "]"}], "!=", "eTotCutLowerZero"}], "||", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "12", "]"}], "]"}], "!=", "eTotCutUpperZero"}]}], 
          "&"}]}], "]"}], "]"}], "==", "0"}], ",", "0", ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IfEtotLowercuts", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Select", "[", 
        RowBox[{"tabbcuts", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "11", "]"}], "]"}], "!=", "eTotCutLowerZero"}], 
          "&"}]}], "]"}], "]"}], "==", "0"}], ",", "0", ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IfEtotUppercuts", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Select", "[", 
        RowBox[{"tabbcuts", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "12", "]"}], "]"}], "!=", "eTotCutUpperZero"}], 
          "&"}]}], "]"}], "]"}], "==", "0"}], ",", "0", ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IfpTcuts", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Select", "[", 
        RowBox[{"tabbcuts", ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "9", "]"}], "]"}], "!=", "pTcutLowerZero"}], "||", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "10", "]"}], "]"}], "!=", "pTcutUpperZero"}]}], 
          "&"}]}], "]"}], "]"}], "==", "0"}], ",", "0", ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IfAngSepCuts", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Select", "[", 
        RowBox[{"tabbcuts", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "14", "]"}], "]"}], "!=", "AngSepCutZero"}], "&"}]}],
         "]"}], "]"}], "==", "0"}], ",", "0", ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IfIPcuts", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Select", "[", 
        RowBox[{"tabbcuts", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "13", "]"}], "]"}], "!=", "IPcutZero"}], "&"}]}], 
        "]"}], "]"}], "==", "0"}], ",", "0", ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IfminvCuts", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Select", "[", 
        RowBox[{"tabbcuts", ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "15", "]"}], "]"}], "!=", "minvCutLowerZero"}], "||", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "16", "]"}], "]"}], "!=", "pTcutUpperZero"}]}], 
          "&"}]}], "]"}], "]"}], "==", "0"}], ",", "0", ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IfminvLowerCuts", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Select", "[", 
        RowBox[{"tabbcuts", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "15", "]"}], "]"}], "!=", "minvCutLowerZero"}], 
          "&"}]}], "]"}], "]"}], "==", "0"}], ",", "0", ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IfminvUpperCuts", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Select", "[", 
        RowBox[{"tabbcuts", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "16", "]"}], "]"}], "!=", "minvCutUpperZero"}], 
          "&"}]}], "]"}], "]"}], "==", "0"}], ",", "0", ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WhetherCuts", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Total", "[", 
       RowBox[{"{", 
        RowBox[{
        "IfEcuts", ",", "IfEtotLowercuts", ",", "IfEtotUppercuts", ",", 
         "IfpTcuts", ",", "IfAngSepCuts", ",", "IfIPcuts", ",", "IfminvCuts", 
         ",", "IfminvLowerCuts", ",", "IfminvUpperCuts"}], "}"}], "]"}], "==",
       "0"}], ",", "0.", ",", "1."}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\"\<Any E cut\>\"", ",", 
      "\"\<Tot \!\(\*SubscriptBox[\(E\), \(lower\)]\) cut\>\"", ",", 
      "\"\<Tot \!\(\*SubscriptBox[\(E\), \(upper\)]\) cut\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(p\), \(T\)]\) cut\>\"", ",", "\"\<SS cut\>\"",
       ",", "\"\<IP cuts\>\"", ",", 
      "\"\<Any \!\(\*SubscriptBox[\(m\), \(inv\\\ cut\)]\)\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(m\), \(inv, lower\)]\) cuts\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(m\), \(inv, upper\)]\) cuts\>\""}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
     "IfEcuts", ",", "IfEtotLowercuts", ",", "IfEtotUppercuts", ",", 
      "IfpTcuts", ",", "IfAngSepCuts", ",", "IfIPcuts", ",", "IfminvCuts", 
      ",", "IfminvLowerCuts", ",", "IfminvUpperCuts"}], "}"}]}], "}"}], "//", 
  "TableForm"}]}], "Input",
 CellChangeTimes->{{3.9056986399863305`*^9, 3.90569870900927*^9}, {
   3.905699077854807*^9, 3.905699134114379*^9}, {3.90569988936072*^9, 
   3.905699910175376*^9}, 3.9057009285373697`*^9, {3.905700981301016*^9, 
   3.9057010102069345`*^9}, {3.905701142125745*^9, 3.9057011468211517`*^9}, {
   3.9058410302725835`*^9, 3.9058411258962774`*^9}, {3.9058465613625803`*^9, 
   3.905846678252503*^9}, {3.910175441451767*^9, 3.9101755084456563`*^9}, {
   3.9102485430536957`*^9, 3.9102485442094946`*^9}, {3.9121594142239914`*^9, 
   3.9121594145852356`*^9}, {3.9124986071171985`*^9, 3.912498826948338*^9}, {
   3.912498882509398*^9, 3.9124989104178066`*^9}, {3.9124989430220065`*^9, 
   3.912498974419062*^9}, {3.912499044644451*^9, 3.9124990691861334`*^9}, {
   3.91249911005711*^9, 3.912499139444146*^9}, {3.9124992016744165`*^9, 
   3.912499234845409*^9}, {3.9125011060840044`*^9, 3.9125011082754574`*^9}, {
   3.9125011843855104`*^9, 3.91250119970541*^9}, {3.9125043834641995`*^9, 
   3.912504383515438*^9}, 3.912533370616337*^9, {3.9125337972131047`*^9, 
   3.912533798136937*^9}, {3.912533831572016*^9, 3.912533894903903*^9}, {
   3.912535104413927*^9, 3.912535177278549*^9}, {3.912657569217199*^9, 
   3.9126575746206074`*^9}, {3.914993465366354*^9, 3.914993465381977*^9}, {
   3.9152065726584177`*^9, 3.9152065800973606`*^9}, {3.916155636187538*^9, 
   3.9161556515685587`*^9}, {3.916155722144123*^9, 3.916155722190012*^9}, {
   3.9161620710664806`*^9, 3.9161620816266932`*^9}, {3.916162183266341*^9, 
   3.916162183276497*^9}, 3.916162270347494*^9},
 CellTags->{"Evaluation", "Re-evaluation"},
 CellLabel->
  "In[661]:=",ExpressionUUID->"215cf060-2dca-482b-8771-8e0ac5bce801"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Refining possible decay channels", "Section",
 CellChangeTimes->{{3.904791226880584*^9, 3.904791233348931*^9}},
 CellTags->{
  "Evaluation", 
   "Re-evaluation"},ExpressionUUID->"3d33661f-1bcd-4438-8890-08599e47b3f3"],

Cell[BoxData[{
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ProcessesListRefined", "[", 
      RowBox[{"LLP", ",", "ECALoptionGivenExperiment"}], "]"}], "=", 
     RowBox[{"ProcessesList", "[", 
      RowBox[{"LLP", ",", "ECALoptionGivenExperiment"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"LLP", ",", "LLPlist"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"MemberQ", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\"\<CHARM-lepton\>\"", ",", "\"\<CHARM-approx-lepton\>\"", ",", 
        "\"\<BEBC\>\""}], "}"}], ",", "GivenExperiment"}], "]"}], "==", 
    "True"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"relevantprocesses", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(e\), \(+\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(e\), \(-\)]\)\>\"", ",", "\"\<Null\>\"", 
         ",", "\"\<Null\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(-\)]\)\>\"", ",", 
         "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(e\), \(-\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Nu]\), \(_\)], \
\(e\)]\)\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(-\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(e\), \(+\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(e\)]\)\>\"", ",", 
         "\"\<Null\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(e\), \(-\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(\[Mu]\)]\)\>\"", ",", 
         "\"\<Null\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(-\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(e\), \(+\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Nu]\), \(_\)], \
\(\[Mu]\)]\)\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(-\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(e\)]\)\>\"", ",", 
         "\"\<Null\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(-\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(\[Mu]\)]\)\>\"", ",", 
         "\"\<Null\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(-\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(\[Tau]\)]\)\>\"", ",", 
         "\"\<Null\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(-\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Nu]\), \(_\)], \
\(e\)]\)\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(-\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Nu]\), \(_\)], \
\(\[Mu]\)]\)\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(-\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Nu]\), \(_\)], \(\[Tau]\)]\
\)\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(e\), \(+\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(e\), \(-\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(e\)]\)\>\"", ",", 
         "\"\<Null\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(e\), \(+\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(e\), \(-\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(\[Mu]\)]\)\>\"", ",", 
         "\"\<Null\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(e\), \(+\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(e\), \(-\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(\[Tau]\)]\)\>\"", ",", 
         "\"\<Null\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(e\), \(+\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(e\), \(-\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Nu]\), \(_\)], \
\(e\)]\)\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(e\), \(+\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(e\), \(-\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Nu]\), \(_\)], \
\(\[Mu]\)]\)\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(e\), \(+\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(e\), \(-\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Nu]\), \(_\)], \(\[Tau]\)]\
\)\>\"", ",", "\"\<Null\>\""}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"{", "\"\<BEBC\>\"", "}"}], ",", "GivenExperiment"}], "]"}], 
       "==", "True"}], ",", 
      RowBox[{"relevantprocesses", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"relevantprocesses", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", 
             "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(e\)]\)\>\"", ",", 
             "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", 
             "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(\[Mu]\)]\)\>\"", ",", 
             "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", 
             "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(\[Tau]\)]\)\>\"", ",", 
             "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", 
             "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Nu]\), \(_\)], \
\(e\)]\)\>\"", ",", "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", 
             "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Nu]\), \(_\)], \(\[Mu]\
\)]\)\>\"", ",", "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", 
              "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Nu]\), \(_\)], \(\
\[Tau]\)]\)\>\"", ",", "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}], 
            RowBox[{"{", 
             RowBox[{
             "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", 
              "\"\<\[Nu]\>\"", ",", "\"\<Null\>\"", ",", "\"\<Null\>\""}], 
             "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\[Gamma]\>\"", ",", "\"\<\[Gamma]\>\"", ",", "\"\<Null\>\"", 
             ",", "\"\<Null\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", 
             "\"\<\[Gamma]\>\"", ",", "\"\<Null\>\"", ",", "\"\<Null\>\""}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(-\)]\)\>\"", ",", 
             "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(-\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\>\"", ",", 
             "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SuperscriptBox[\(e\), \(+\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(-\)]\)\>\"", ",", 
             "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SuperscriptBox[\(e\), \(-\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\>\"", ",", 
             "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}]}], "}"}]}], 
        "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ProcessesListRefined", "[", 
         RowBox[{"LLP", ",", "ECALoptionGivenExperiment"}], "]"}], "=", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"ProcessesList", "[", 
           RowBox[{"LLP", ",", "ECALoptionGivenExperiment"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Sort", "/@", "relevantprocesses"}], ",", 
              RowBox[{"Sort", "[", 
               RowBox[{"DecayTypeDecayProductsSetLLPs", "[", 
                RowBox[{"LLP", ",", "#"}], "]"}], "]"}]}], "]"}], "==", 
            "True"}], "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"LLP", ",", "LLPlist"}], "}"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.904791254610733*^9, 3.90479129532124*^9}, {
   3.904791338028764*^9, 3.9047913586765823`*^9}, {3.904791399796554*^9, 
   3.904791408947711*^9}, {3.9047917158907313`*^9, 3.9047917233665185`*^9}, 
   3.904791762175335*^9, {3.904791885462148*^9, 3.9047920449193325`*^9}, {
   3.904792141059723*^9, 3.904792189987359*^9}, {3.9047923964055204`*^9, 
   3.9047924180623894`*^9}, {3.904793242669736*^9, 3.904793449442148*^9}, {
   3.9047938126832294`*^9, 3.904793878130267*^9}, {3.9047940877627707`*^9, 
   3.904794117173868*^9}, {3.9047941698459473`*^9, 3.904794188863519*^9}, {
   3.904794294911703*^9, 3.9047942993714557`*^9}, {3.9058450824775815`*^9, 
   3.9058450834143815`*^9}, {3.9101654009086633`*^9, 
   3.9101654045280976`*^9}, {3.910165927887673*^9, 3.910165998049596*^9}, {
   3.910166041718178*^9, 3.9101661518785233`*^9}, 3.9121591756192293`*^9, {
   3.9168899407136602`*^9, 3.9168899407770195`*^9}},
 CellTags->{"Evaluation", "Re-evaluation"},
 CellLabel->
  "In[675]:=",ExpressionUUID->"c09962ae-6e4a-4d15-bea5-a3e8cda1c0b2"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["II. Decay acceptance calculation", "Title",
 CellChangeTimes->{{3.887780141514988*^9, 3.8877801438682127`*^9}, {
  3.8877814585563145`*^9, 3.8877814592472353`*^9}, {3.8934364536342463`*^9, 
  3.8934364595743847`*^9}, {3.9038012705453463`*^9, 3.9038012710574102`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"7ef276aa-6ac2-44b6-8659-f620e946504b"],

Cell[CellGroupData[{

Cell["\<\
Defining and compiling relevant functions used to calculate the decay \
acceptance\
\>", "Chapter",
 CellChangeTimes->{{3.8913221765123215`*^9, 3.891322205486955*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"75496f98-5d16-4d12-8062-af46b66ba6fe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"LLPdecVTXatGivenZ", "[", 
    RowBox[{"zLLP_", ",", "\[Theta]LLP_", ",", "\[Phi]LLP_"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"zLLP", "/", 
        RowBox[{"Cos", "[", "\[Theta]LLP", "]"}]}], ")"}], 
      RowBox[{"Sin", "[", "\[Theta]LLP", "]"}], "*", 
      RowBox[{"Cos", "[", "\[Phi]LLP", "]"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"zLLP", "/", 
        RowBox[{"Cos", "[", "\[Theta]LLP", "]"}]}], ")"}], 
      RowBox[{"Sin", "[", "\[Theta]LLP", "]"}], "*", 
      RowBox[{"Sin", "[", "\[Phi]LLP", "]"}]}], ",", "zLLP"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LLPdecVTXatGivenZx", "[", 
    RowBox[{"zLLP_", ",", "\[Theta]LLP_", ",", "\[Phi]LLP_"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"LLPdecVTXatGivenZ", "[", 
        RowBox[{"zLLP", ",", "\[Theta]LLP", ",", "\[Phi]LLP"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "/.", " ", 
      RowBox[{
       RowBox[{"Cot", "[", "x_", "]"}], ":>", 
       RowBox[{"1", "/", 
        RowBox[{"Tan", "[", "x", "]"}]}]}]}], "/.", " ", 
     RowBox[{
      RowBox[{"Csc", "[", "x_", "]"}], ":>", 
      RowBox[{"1", "/", 
       RowBox[{"Sin", "[", "x", "]"}]}]}]}], "/.", 
    RowBox[{
     RowBox[{"Sec", "[", "x_", "]"}], "\[RuleDelayed]", 
     RowBox[{"1", "/", 
      RowBox[{"Cos", "[", "x", "]"}]}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LLPdecVTXatGivenZy", "[", 
    RowBox[{"zLLP_", ",", "\[Theta]LLP_", ",", "\[Phi]LLP_"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"LLPdecVTXatGivenZ", "[", 
        RowBox[{"zLLP", ",", "\[Theta]LLP", ",", "\[Phi]LLP"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "/.", " ", 
      RowBox[{
       RowBox[{"Cot", "[", "x_", "]"}], ":>", 
       RowBox[{"1", "/", 
        RowBox[{"Tan", "[", "x", "]"}]}]}]}], "/.", " ", 
     RowBox[{
      RowBox[{"Csc", "[", "x_", "]"}], ":>", 
      RowBox[{"1", "/", 
       RowBox[{"Sin", "[", "x", "]"}]}]}]}], "/.", 
    RowBox[{
     RowBox[{"Sec", "[", "x_", "]"}], "\[RuleDelayed]", 
     RowBox[{"1", "/", 
      RowBox[{"Cos", "[", "x", "]"}]}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DecayAcceptanceGeometry", "[", 
    RowBox[{"coord1_", ",", "coord2_", ",", "xLongLLP_"}], "]"}], "=", 
   RowBox[{"Boole", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Min", "[", 
       RowBox[{"DetEndCoordinates", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "<", "coord1", "<", 
      RowBox[{"Max", "[", 
       RowBox[{"DetEndCoordinates", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "&&", 
     RowBox[{
      RowBox[{"zToDetectorCenterGivenExperiment", "-", 
       FractionBox["dzDetectorGivenExperimentMax", "2"]}], "<", " ", "coord2",
       "<", 
      RowBox[{"zToDetectorCenterGivenExperiment", "+", 
       FractionBox["dzDetectorGivenExperimentMax", "2"]}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pointSecondCoordinate", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LarmorRadiusGivenExperiment", "[", "E1lab_", "]"}], "=", 
   "999999999"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NotebookEvaluate", "[", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<codes/decay-acceptance.nb\>\""}], "}"}], "]"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.915264127585699*^9, 3.9152641455577364`*^9}, {
  3.915264281570612*^9, 3.91526428225181*^9}, {3.91529388001492*^9, 
  3.9152938830956087`*^9}, {3.9152941594367533`*^9, 3.9152941636648684`*^9}, {
  3.9168899407770195`*^9, 3.9168899408712854`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[677]:=",ExpressionUUID->"a351b5a7-3968-47b6-9206-0b80d566fd66"],

Cell[CellGroupData[{

Cell["Mass range for the acceptance computation", "Section",
 CellChangeTimes->{{3.891323732291453*^9, 3.89132374118683*^9}, {
   3.891323823354575*^9, 3.8913238234662757`*^9}, {3.893436795887788*^9, 
   3.8934368016086535`*^9}, 3.893436831726281*^9, 3.915255993420688*^9},
 CellTags->{
  "Evaluation", 
   "Re-evaluation"},ExpressionUUID->"69890af2-32c0-41ab-b90f-aaf902234c1e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Mass", " ", "range", " ", "for", " ", 
      RowBox[{"scalars", ".", " ", "If"}], " ", "the", " ", "facility", " ", 
      "is", " ", "not", " ", "FCC"}], "-", 
     RowBox[{
      RowBox[{"hh", "/", "LHC"}], " ", 
      RowBox[{"(", 
       RowBox[{
       "where", " ", "scalars", " ", "heavier", " ", "than", " ", "B", " ", 
        "may", " ", "be", " ", "produced"}], ")"}]}]}], ",", " ", 
    RowBox[{
     RowBox[{
     "then", " ", "the", " ", "mass", " ", "range", " ", "is", " ", "bounded",
       " ", "by", " ", 
      SubscriptBox["m", "B"]}], " ", "-", " ", 
     RowBox[{
      SubscriptBox["m", "\[Pi]"], ".", " ", "Otherwise"}]}], ",", " ", 
    RowBox[{"it", " ", "is", " ", "up", " ", "to", " ", 
     RowBox[{
      SubscriptBox["m", "h"], "/", "2"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"mLLPlistTemp", "[", "\"\<Scalar\>\"", "]"}], "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "0.02", ",", "0.05", ",", "0.1", ",", "0.2", ",", "0.22", ",", "0.3", 
         ",", "0.4", ",", "0.5", ",", "0.7", ",", "0.9", ",", "1.05", ",", 
         "1.3", ",", "1.6", ",", "1.99"}], "}"}], ",", 
       RowBox[{"mjetsrange", "[", "\"\<Scalar\>\"", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"mLLPlist", "[", "\"\<Scalar\>\"", "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<LHC\>\"", ",", "\"\<FCC-hh\>\""}], "}"}], ",", 
          "FacilityGivenExperiment"}], "]"}], "==", "False"}], ",", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"mLLPlistTemp", "[", "\"\<Scalar\>\"", "]"}], ",", 
         RowBox[{
          RowBox[{"#", "<=", "5.1"}], "&"}]}], "]"}], ",", 
       RowBox[{"mLLPlistTemp", "[", "\"\<Scalar\>\"", "]"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"For", " ", "HNLs"}], " ", "-", " ", "similarly"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"mLLPlistTemp", "[", "LLP", "]"}], "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "0.02", ",", "0.05", ",", "0.1", ",", "0.17", ",", "0.35", ",", 
             "0.5", ",", "0.75", ",", "1.", ",", "1.19", ",", "1.5"}], "}"}], 
           ",", 
           RowBox[{
            RowBox[{"#", "<", 
             RowBox[{"Min", "[", 
              RowBox[{"mjetsrange", "[", "LLP", "]"}], "]"}]}], "&"}]}], 
          "]"}], ",", 
         RowBox[{"mjetsrange", "[", "LLP", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mLLPlist", "[", "LLP", "]"}], "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<LHC\>\"", ",", "\"\<FCC-hh\>\""}], "}"}], ",", 
            "FacilityGivenExperiment"}], "]"}], "==", "False"}], ",", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"mLLPlistTemp", "[", "LLP", "]"}], ",", 
           RowBox[{
            RowBox[{"#", "<=", "5.3"}], "&"}]}], "]"}], ",", 
         RowBox[{"mLLPlistTemp", "[", "LLP", "]"}]}], "]"}]}], ";"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"LLP", ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<HNL-mixing-e\>\"", ",", "\"\<HNL-mixing-mu\>\"", ",", 
         "\"\<HNL-mixing-tau\>\""}], "}"}]}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"ALPs", " ", "coupled", " ", "to", " ", "gluons"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"mLLPlistTemp", "[", "\"\<ALP-gluon\>\"", "]"}], "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "0.02", ",", "0.05", ",", "0.07", ",", "0.1", ",", "0.14", ",", 
           "0.16", ",", "0.2", ",", "0.25", ",", "0.3", ",", "0.5", ",", 
           "0.75", ",", "1.", ",", "1.25", ",", "1.5", ",", "1.8", ",", 
           "2.3"}], "}"}], ",", 
         RowBox[{
          RowBox[{"#", "<", 
           RowBox[{"Min", "[", 
            RowBox[{"mjetsrange", "[", "\"\<ALP-gluon\>\"", "]"}], "]"}]}], 
          "&"}]}], "]"}], ",", 
       RowBox[{"mjetsrange", "[", "\"\<ALP-gluon\>\"", "]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"mLLPlist", "[", "\"\<ALP-gluon\>\"", "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ECALoptionGivenExperiment", "\[Equal]", "\"\<False\>\""}], 
       ",", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"mLLPlistTemp", "[", "\"\<ALP-gluon\>\"", "]"}], ",", 
         RowBox[{
          RowBox[{"#", ">", 
           RowBox[{"0.14", "*", "2"}]}], "&"}]}], "]"}], ",", 
       RowBox[{"mLLPlistTemp", "[", "\"\<ALP-gluon\>\"", "]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"ALPs", " ", "coupled", " ", "to", " ", "fermions"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"mLLPlist", "[", "\"\<ALP-fermion\>\"", "]"}], "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "0.02", ",", "0.05", ",", "0.1", ",", "0.15", ",", "0.2", ",", 
           "0.21", ",", "0.22", ",", "0.25", ",", "0.3", ",", "0.5", ",", 
           "0.6", ",", "0.7", ",", "0.8", ",", "0.9", ",", "1.1", ",", "1.5", 
           ",", "1.8", ",", "2.3"}], "}"}], ",", 
         RowBox[{
          RowBox[{"#", "<", 
           RowBox[{"Min", "[", 
            RowBox[{"mjetsrange", "[", "\"\<ALP-fermion\>\"", "]"}], "]"}]}], 
          "&"}]}], "]"}], ",", 
       RowBox[{"mjetsrange", "[", "\"\<ALP-fermion\>\"", "]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"ALPs", " ", "coupled", " ", "to", " ", "photons"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"mLLPlist", "[", "\"\<ALP-photon\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "0.02", ",", "0.03", ",", "0.04", ",", "0.05", ",", "0.06", ",", 
         "0.07", ",", "0.08", ",", "0.09", ",", "0.1", ",", "0.25", ",", 
         "0.5", ",", "0.75", ",", "1.", ",", "1.25", ",", "1.5", ",", "1.75", 
         ",", "2.25", ",", "2.75", ",", "3.", ",", "3.5", ",", "4.", ",", 
         "4.5"}], "}"}], "//", "N"}], "//", "Sort"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"mLLPlist", "[", "\"\<DP\>\"", "]"}], "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "0.02", ",", "0.03", ",", "0.04", ",", "0.05", ",", "0.06", ",", 
           "0.07", ",", "0.08", ",", "0.09", ",", "0.1", ",", "0.13", ",", 
           "0.16", ",", "0.2", ",", "0.25", ",", "0.5", ",", "0.75", ",", 
           "1.", ",", "1.25", ",", "1.75", ",", "2.25"}], "}"}], ",", 
         RowBox[{
          RowBox[{"#", "<", 
           RowBox[{"Min", "[", 
            RowBox[{"mjetsrange", "[", "\"\<DP\>\"", "]"}], "]"}]}], "&"}]}], 
        "]"}], ",", 
       RowBox[{"mjetsrange", "[", "\"\<DP\>\"", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"mLLPlist", "[", "\"\<B-L\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"mLLPlist", "[", "\"\<B-3Le-Lmu+Ltau\>\"", "]"}], "=", 
      RowBox[{
       RowBox[{"mLLPlist", "[", "\"\<B-Le-3Lmu+Ltau\>\"", "]"}], "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "0.02", ",", "0.5", ",", "0.1", ",", "0.25", ",", "0.5", ",", 
             "0.75", ",", "1.", ",", "1.25", ",", "1.75", ",", "2.25"}], 
            "}"}], ",", 
           RowBox[{
            RowBox[{"#", "<", 
             RowBox[{"Min", "[", 
              RowBox[{"mjetsrange", "[", "\"\<B-L\>\"", "]"}], "]"}]}], 
            "&"}]}], "]"}], ",", 
         RowBox[{"mjetsrange", "[", "\"\<B-L\>\"", "]"}]}], "]"}]}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"mLLPlist", "[", "\"\<B-3Lmu\>\"", "]"}], "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", "0.215", "}"}], ",", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"mLLPlist", "[", "\"\<B-L\>\"", "]"}], ",", 
         RowBox[{
          RowBox[{"#", ">", "0.215"}], "&"}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"FacilityGivenExperiment", "==", "\"\<ESS\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"mLLPlist", "[", "LLP", "]"}], "=", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"mLLPlist", "[", "LLP", "]"}], ",", 
           RowBox[{
            RowBox[{"#", "<", "2.4"}], "&"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"LLP", ",", 
          RowBox[{"{", 
           RowBox[{
           "\"\<ALP-gluon\>\"", ",", "\"\<ALP-fermion\>\"", ",", 
            "\"\<ALP-photon\>\"", ",", "\"\<DP\>\"", ",", "\"\<B-L\>\"", ",", 
            "\"\<Scalar\>\""}], "}"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"mLLPlist", "[", "LLP", "]"}], "=", 
         RowBox[{"{", 
          RowBox[{
          "0.005", ",", "0.01", ",", "0.015", ",", "0.02", ",", "0.025", ",", 
           "0.03", ",", "0.035", ",", "0.04", ",", "0.045", ",", "0.05", ",", 
           "0.055", ",", "0.06", ",", "0.065", ",", "0.07", ",", "0.075", ",",
            "0.08", ",", "0.085", ",", "0.09", ",", "0.095", ",", "0.1", ",", 
           "0.103", ",", "0.105", ",", "0.11", ",", "0.115", ",", "0.12", ",",
            "0.125", ",", "0.13", ",", "0.135", ",", "0.14"}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"LLP", ",", 
          RowBox[{"{", 
           RowBox[{
           "\"\<HNL-mixing-e\>\"", ",", "\"\<HNL-mixing-mu\>\"", ",", 
            "\"\<HNL-mixing-tau\>\""}], "}"}]}], "}"}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.90483427822402*^9, 3.9048342786130257`*^9}, {
  3.904891095640736*^9, 3.9048911083555403`*^9}, {3.9110279635875297`*^9, 
  3.9110279811714044`*^9}, {3.9110280258346977`*^9, 3.91102805460303*^9}, {
  3.9141397726358833`*^9, 3.914139796020625*^9}, {3.9141398264274855`*^9, 
  3.914139830154768*^9}, {3.9147491772830024`*^9, 3.9147492229437723`*^9}, {
  3.914749485072877*^9, 3.9147496287871146`*^9}, {3.9149165501571755`*^9, 
  3.914916555962652*^9}, {3.9149196735110807`*^9, 3.914919765338022*^9}, {
  3.914920097319073*^9, 3.914920145615481*^9}, {3.914920246125176*^9, 
  3.9149202867523923`*^9}, {3.914929712815317*^9, 3.9149297136826305`*^9}, {
  3.9149298901991577`*^9, 3.914929891488798*^9}, {3.9149470738491197`*^9, 
  3.91494707545831*^9}, {3.9151862948475*^9, 3.9151863148671913`*^9}, {
  3.9168899408712854`*^9, 3.916889941028466*^9}, {3.9168902755549154`*^9, 
  3.9168903138869505`*^9}},
 CellTags->{"Evaluation", "Re-evaluation"},
 CellLabel->
  "In[684]:=",ExpressionUUID->"0b5b19ea-8b21-416c-951d-2092f610aec4"]
}, Closed]],

Cell[CellGroupData[{

Cell["Final block", "Section",
 CellChangeTimes->{{3.915256023204398*^9, 
  3.9152560243517537`*^9}},ExpressionUUID->"61dd62df-bf83-4744-b8b5-\
810b5c5173a5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "phr0", "=", 
   "\"\<Use old phenomenology from 1901.09966, or the new one from \
2310.03524?\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a0", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<New\>\"", ",", "\"\<Old\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"phr1", "[", "LLP_", "]"}], ":=", 
   RowBox[{"Row", "[", 
    RowBox[{"{", 
     RowBox[{"\"\<Default decay chanels: \>\"", ",", 
      RowBox[{"ProcessesListRefined", "[", 
       RowBox[{"LLP", ",", "ECALoptionGivenExperiment"}], "]"}], ",", 
      "\"\<. Keep them?\>\""}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a1", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<Yes\>\"", ",", "\"\<No\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "phr2", "=", 
   "\"\<How many decay products that in principle may be detected must pass \
all the criteria?\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a2", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<>=2\>\"", ",", "\"\<All detectable\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "phr3", "=", 
   "\"\<Heavy LLPs decay into partons. Would you like to use the phase space \
of hadronized decay products of the LLPs, or use partons instead?\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a3", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<Use hadronized decay products\>\"", ",", "\"\<Use jets\>\""}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FinalBlock", "[", 
   RowBox[{"LLP_", ",", "isim_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"masslist", "=", 
      RowBox[{"mLLPlist", "[", "LLP", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"LLP", "==", "\"\<ALP-fermion\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"alpfermionselection", "=", 
           RowBox[{"dropdownDialog", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<New\>\"", ",", "\"\<Old\>\""}], "}"}], ",", 
             RowBox[{"Row", "[", 
              RowBox[{
              "{", "\"\<Use old phenomenology from 1901.09966, or the new one \
from 2310.03524?\>\"", "}"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"LLPchoiceForComputation", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"alpfermionselection", "==", "\"\<New\>\""}], ",", 
             "\"\<ALP-fermion\>\"", ",", 
             "\"\<ALP-fermion-no-hadronic-decays\>\""}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LLPchoiceForComputation", "=", "LLP"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"LLP", "==", "\"\<ALP-fermion\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", "alpfermionselection", "}"}], "=", 
         RowBox[{"choicesDialog", "[", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"LLP", ",", "Bold"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"phr0", ",", "a0"}], "}"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"LLPchoiceForComputation", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"alpfermionselection", "==", "\"\<New\>\""}], ",", 
           "\"\<ALP-fermion\>\"", ",", 
           "\"\<ALP-fermion-no-hadronic-decays\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"GivenExperiment", "!=", "\"\<CHARM-photon\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "decaychannelschoice", ",", "acceptancetypechoice", ",", 
             "HadronizationOptionChoice"}], "}"}], "=", 
           RowBox[{"choicesDialog", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"LLP", ",", "Bold"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"phr1", "[", "LLPchoiceForComputation", "]"}], ",", 
                 "a1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"phr2", ",", "a2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"phr3", ",", "a3"}], "}"}]}], "}"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"decaychannelschoice", ",", "HadronizationOptionChoice"}],
             "}"}], "=", 
           RowBox[{"choicesDialog", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"LLP", ",", "Bold"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"phr1", "[", "LLPchoiceForComputation", "]"}], ",", 
                 "a1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"phr3", ",", "a3"}], "}"}]}], "}"}]}], "]"}]}]}], 
         "]"}], ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"LLPchoiceForComputation", "=", "LLP"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"GivenExperiment", "!=", "\"\<CHARM-photon\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "decaychannelschoice", ",", "acceptancetypechoice", ",", 
             "HadronizationOptionChoice"}], "}"}], "=", 
           RowBox[{"choicesDialog", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"LLP", ",", "Bold"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"phr1", "[", "LLPchoiceForComputation", "]"}], ",", 
                 "a1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"phr2", ",", "a2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"phr3", ",", "a3"}], "}"}]}], "}"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"decaychannelschoice", ",", "HadronizationOptionChoice"}],
             "}"}], "=", 
           RowBox[{"choicesDialog", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"LLP", ",", "Bold"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"phr1", "[", "LLPchoiceForComputation", "]"}], ",", 
                 "a1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"phr3", ",", "a3"}], "}"}]}], "}"}]}], "]"}]}]}], 
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"hadropt", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
        "HadronizationOptionChoice", "==", 
         "\"\<Use hadronized decay products\>\""}], ",", "\"\<True\>\"", ",", 
        "\"\<False\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"decaychannelschoice", "=", 
        RowBox[{"dropdownDialog", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<Yes\>\"", ",", "\"\<No\>\""}], "}"}], ",", 
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{"\"\<Default decay chanels: \>\"", ",", 
             RowBox[{"ProcessesListRefined", "[", 
              RowBox[{
              "LLPchoiceForComputation", ",", "ECALoptionGivenExperiment"}], 
              "]"}], ",", "\"\<. Keep them?\>\""}], "}"}], "]"}]}], "]"}]}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"proclist", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"decaychannelschoice", "==", "\"\<No\>\""}], ",", " ", 
        RowBox[{"selectionDialog", "[", 
         RowBox[{
          RowBox[{"ProcessesListRefined", "[", 
           RowBox[{
           "LLPchoiceForComputation", ",", "ECALoptionGivenExperiment"}], 
           "]"}], ",", "\"\<Select decay channels:\>\""}], "]"}], ",", 
        RowBox[{"ProcessesListRefined", "[", 
         RowBox[{
         "LLPchoiceForComputation", ",", "ECALoptionGivenExperiment"}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"acceptancetypechoice", "=", 
        RowBox[{"dropdownDialog", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<>=2\>\"", ",", "\"\<All detectable\>\""}], "}"}], ",", 
          RowBox[{"Row", "[", 
           RowBox[{
           "{", "\"\<Which type of the acceptance you will use?\>\"", "}"}], 
           "]"}]}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"BrVisibleExport", "[", "mLLP_", "]"}], "=", 
      RowBox[{"BrVisibleGivenSetup", "[", 
       RowBox[{
       "LLPchoiceForComputation", ",", "mLLP", ",", "proclist", ",", 
        "ECALoptionGivenExperiment"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "proclist", "]"}], "\[NotEqual]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tabcomp", "=", 
         RowBox[{"Monitor", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"FinalBlockMass", "[", 
              RowBox[{"LLPchoiceForComputation", ",", 
               RowBox[{"masslist", "[", 
                RowBox[{"[", "l", "]"}], "]"}], ",", "proclist", ",", "isim", 
               ",", "hadropt", ",", "acceptancetypechoice"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"l", ",", "1", ",", 
               RowBox[{"Length", "[", "masslist", "]"}], ",", "1"}], "}"}]}], 
            "]"}], ",", 
           RowBox[{"Row", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ProgressIndicator", "[", 
                RowBox[{"l", ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Length", "[", "masslist", "]"}]}], "}"}]}], "]"}],
                ",", "\"\<i = \>\"", ",", "l", ",", "\"\</\>\"", ",", 
               RowBox[{"Length", "[", "masslist", "]"}], ",", 
               "\"\< (\!\(\*SubscriptBox[\(m\), \(LLP\)]\) = \>\"", ",", 
               RowBox[{"masslist", "[", 
                RowBox[{"[", "l", "]"}], "]"}], ",", "\"\< GeV)\>\""}], "}"}],
              ",", "\"\< \>\""}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"filenameexport", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"hadropt", "==", "\"\<True\>\""}], ",", 
           RowBox[{"ToString", "@", 
            RowBox[{"StringForm", "[", 
             RowBox[{"\"\<Acceptance_``_for_``.m\>\"", ",", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"{", 
                RowBox[{"GivenExperimentName", ",", "LLP"}], "}"}]}]}], 
             "]"}]}], ",", 
           RowBox[{"ToString", "@", 
            RowBox[{"StringForm", "[", 
             RowBox[{"\"\<Acceptance_``-no-hadronization_for_``.m\>\"", ",", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"{", 
                RowBox[{"GivenExperimentName", ",", "LLP"}], "}"}]}]}], 
             "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Flatten", "[", 
         RowBox[{"tabcomp", ",", "1"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<No processes for the given LLP/ECAL availability!\>\"", "]"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BlockExport", "[", 
   RowBox[{"LLP_", ",", "isim_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"datatemp", "=", 
      RowBox[{"FinalBlock", "[", 
       RowBox[{"LLP", ",", "isim"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Acceptances\>\"",
           ",", "GivenExperimentName", ",", "filenameexport"}], "}"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
        "FacilityGivenExperiment", ",", "ECALoptionGivenExperiment", ",", 
         "datatemp", ",", "TableParticlesNumbersGivenExperiment", ",", 
         RowBox[{"BrVisibleExport", "[", "mLLP", "]"}]}], "}"}], ",", 
       "\"\<MX\>\""}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.893582961950735*^9, 3.8935829626824627`*^9}, {
   3.8936893968848577`*^9, 3.8936893974606404`*^9}, {3.8987005042228255`*^9, 
   3.8987005045734777`*^9}, {3.898701856337847*^9, 3.8987018623241267`*^9}, {
   3.898702456562152*^9, 3.8987024568267717`*^9}, {3.9017249679866066`*^9, 
   3.9017249724113703`*^9}, {3.904067171324582*^9, 3.9040671852963543`*^9}, {
   3.9047945111480904`*^9, 3.904794559583746*^9}, 3.904834450990146*^9, {
   3.904888618187772*^9, 3.9048886511067495`*^9}, {3.9048892180834365`*^9, 
   3.90488923991012*^9}, {3.9048904389388885`*^9, 3.904890452962327*^9}, {
   3.9049003499917736`*^9, 3.904900353883464*^9}, {3.9052302407603493`*^9, 
   3.905230377096493*^9}, {3.90523041779224*^9, 3.9052304254511085`*^9}, {
   3.9052308097081423`*^9, 3.9052309050531793`*^9}, {3.905230941820487*^9, 
   3.9052310027655926`*^9}, {3.9052311542718744`*^9, 
   3.9052311562723665`*^9}, {3.9053982154172344`*^9, 3.905398226607583*^9}, {
   3.9058418660121374`*^9, 3.905841914591055*^9}, {3.9059623107307734`*^9, 
   3.905962324614109*^9}, {3.911975955618017*^9, 3.9119760457698507`*^9}, {
   3.9120943834183598`*^9, 3.9120943881616373`*^9}, 3.912160528921958*^9, {
   3.9121608162295923`*^9, 3.9121608212176695`*^9}, {3.912160854627734*^9, 
   3.9121608741677265`*^9}, {3.9121609169415236`*^9, 3.912160984697664*^9}, {
   3.912161033729065*^9, 3.9121610627265167`*^9}, {3.9121616942577887`*^9, 
   3.912161770187453*^9}, {3.9121618050186462`*^9, 3.9121618848486147`*^9}, {
   3.912161952048806*^9, 3.912162006347658*^9}, {3.9121620789990873`*^9, 
   3.912162119327769*^9}, {3.9140930898495655`*^9, 3.9140930989757533`*^9}, {
   3.9145744286332293`*^9, 3.9145744459937925`*^9}, {3.915260318491085*^9, 
   3.9152603728655033`*^9}, {3.9152604087304316`*^9, 
   3.9152605416276956`*^9}, {3.915260943724496*^9, 3.915260967955821*^9}, {
   3.9152616104848614`*^9, 3.915261636404451*^9}, {3.9152616759874287`*^9, 
   3.9152617007513895`*^9}, {3.916889941032504*^9, 3.916889941216895*^9}},
 CellTags->{"Evaluation", "Re-evaluation"},
 CellLabel->
  "In[695]:=",ExpressionUUID->"038c1ab8-352c-4f0a-b20f-18632e7b8ff7"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Actual computation of the decay acceptance", "Chapter",
 CellChangeTimes->{{3.8850061437436857`*^9, 3.8850061450832815`*^9}, {
   3.886145449456651*^9, 3.8861454859360905`*^9}, {3.887781460454486*^9, 
   3.8877814772686296`*^9}, 3.8882541572532434`*^9, 3.8896946090029707`*^9, {
   3.8908162850087905`*^9, 3.89081628646469*^9}, 3.8933529899662642`*^9, {
   3.893436990617954*^9, 3.893436996266165*^9}},
 CellTags->{
  "Evaluation", 
   "Re-evaluation"},ExpressionUUID->"da3b7ec0-b669-408d-a6e2-09447629531d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"BlockAcceptanceComputation", "[", "LLP_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nb", "=", 
      RowBox[{"EvaluationNotebook", "[", "]"}]}], ";", "\n", 
     RowBox[{"NotebookFind", "[", 
      RowBox[{"nb", ",", "LLP", ",", "All", ",", "CellTags"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<List of LLPs:\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"LLPlistReduced", "=", 
  RowBox[{
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"LLPlist", ",", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\"\<HNL-mixing-e\>\"", ",", "\"\<HNL-mixing-mu\>\"", ",", 
             "\"\<HNL-mixing-tau\>\"", ",", 
             "\"\<ALP-fermion-no-hadronic-decays\>\""}], "}"}], ",", "#"}], 
          "]"}]}], "&"}]}], "]"}], ",", 
     RowBox[{"{", "\"\<HNL\>\"", "}"}]}], "]"}], "//", 
   "Sort"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"selectionDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", 
      RowBox[{"{", "}"}]}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{"{", "phrase", "}"}], "]"}], ",", 
       RowBox[{"TogglerBar", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list", ",", 
         RowBox[{"Appearance", "->", "\"\<Vertical\>\""}]}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<List of LLPs for which the acceptance will be computed:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"SelectedLLPlistTemp", "=", 
  RowBox[{"selectionDialog", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Join", "[", "LLPlistReduced", "]"}], "//", "Sort"}], ",", 
    "\"\<Select LLPs for which acceptances will be computed:\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SelectedLLPlist", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"SelectedLLPlistTemp", ",", 
     RowBox[{"{", "\"\<Technical\>\"", "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GivenExperimentName", "=", 
   RowBox[{"DialogInput", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cut", "=", "GivenExperiment"}], "}"}], ",", 
     RowBox[{"Column", "[", 
      RowBox[{"{", 
       RowBox[{"\"\<Enter the name of the experiment for exporting:\>\"", ",", 
        RowBox[{"InputField", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "cut", "]"}], ",", "String"}], "]"}], ",", 
        RowBox[{"Button", "[", 
         RowBox[{"\"\<Proceed\>\"", ",", 
          RowBox[{"DialogReturn", "[", "cut", "]"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Automatic"}]}], "]"}]}], "}"}], 
      "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DirectoryQ", "[", "\"\<Acceptances\>\"", "]"}], "//", 
       "ToString"}], ")"}], "\[Equal]", "\"\<False\>\""}], ",", 
    RowBox[{"CreateDirectory", "[", "\"\<Acceptances\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DirectoryQ", "[", 
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{"\"\<Acceptances\>\"", ",", "GivenExperimentName"}], "}"}],
           "]"}], "]"}], "//", "ToString"}], ")"}], "\[Equal]", 
      "\"\<False\>\""}], ",", 
     RowBox[{"CreateDirectory", "[", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<Acceptances\>\"", ",", "GivenExperimentName"}], "}"}], 
       "]"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"ChoiceDialog", "[", 
    RowBox[{
    "\"\<Choose the LLP for which acceptances will be computed:\>\"", ",", 
     RowBox[{"Join", "[", 
      RowBox[{"LLPlistReduced", ",", 
       RowBox[{"{", "\"\<All\>\"", "}"}]}], "]"}], ",", 
     RowBox[{"Appearance", "\[Rule]", 
      RowBox[{"\"\<Vertical\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Automatic", ",", "3"}], "}"}]}]}]}], "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ivaltest", "=", "1000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"BlockAcceptanceComputation", "[", 
    RowBox[{"SelectedLLPlist", "[", 
     RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "SelectedLLPlist", "]"}], ",", "1"}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{
  3.8896950595137253`*^9, {3.8904130243273077`*^9, 3.890413033547454*^9}, {
   3.890413133306282*^9, 3.890413164761125*^9}, {3.8904141629070535`*^9, 
   3.8904141638350925`*^9}, 3.892883367269068*^9, {3.893233746308257*^9, 
   3.8932337700855803`*^9}, {3.8933482345206532`*^9, 3.8933482501765194`*^9}, 
   3.8941244115567007`*^9, {3.8987018737205153`*^9, 3.8987018753553934`*^9}, {
   3.8987019122797337`*^9, 3.8987019130039053`*^9}, {3.9017337142875385`*^9, 
   3.90173376901267*^9}, {3.9025586059197598`*^9, 3.9025586311667233`*^9}, {
   3.9040631070251017`*^9, 3.9040631285708213`*^9}, {3.904066967949132*^9, 
   3.9040670647256765`*^9}, {3.9040678761475725`*^9, 3.904067898822685*^9}, {
   3.9048341779179535`*^9, 3.904834192131352*^9}, {3.9048359432939706`*^9, 
   3.904835954657815*^9}, 3.904838398370827*^9, {3.904844835522743*^9, 
   3.904844901294034*^9}, 3.9048887436571302`*^9, {3.9048894090370913`*^9, 
   3.9048894141924086`*^9}, 3.9048906466333795`*^9, 3.904890765032191*^9, 
   3.904890980838414*^9, 3.904897590267807*^9, 3.9049000802951903`*^9, 
   3.9049004991668596`*^9, {3.905230785136306*^9, 3.90523079506658*^9}, {
   3.9058418190778837`*^9, 3.905841823751466*^9}, {3.9102609081252975`*^9, 
   3.910260941495719*^9}, {3.9112333698084307`*^9, 3.911233370546249*^9}, {
   3.9121617786487746`*^9, 3.912161778887848*^9}, {3.912162163367823*^9, 
   3.912162163601643*^9}, 3.9144053197263775`*^9, {3.9145708919757957`*^9, 
   3.9145708948954563`*^9}, {3.916889941233*^9, 3.9168899412797704`*^9}},
 CellTags->{"Evaluation", "Re-evaluation"},
 CellLabel->
  "In[705]:=",ExpressionUUID->"57e9a41d-0896-4230-a4c5-a35b43efa2a2"],

Cell[CellGroupData[{

Cell[BoxData["\<\"List of LLPs for which the acceptance will be \
computed:\"\>"], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{3.9152934519456854`*^9, 3.9152945764080133`*^9, 
  3.9168899412797704`*^9, 3.916897337687912*^9},
 CellTags->{"Evaluation", "Re-evaluation"},
 CellLabel->
  "During evaluation of \
In[2047]:=",ExpressionUUID->"0b0c6f28-15f4-4816-bb8a-bc2762136e45"],

Cell[BoxData["\<\"List of LLPs:\"\>"], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{3.9152934519456854`*^9, 3.9152945764080133`*^9, 
  3.9168899412797704`*^9, 3.916897337678895*^9},
 CellTags->{"Evaluation", "Re-evaluation"},
 CellLabel->
  "During evaluation of \
In[2047]:=",ExpressionUUID->"e4216446-ae9f-4e72-b238-b37a5c34e8fd"],

Cell[BoxData[
 FormBox["\<\"List of LLPs:\"\>", TraditionalForm]], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{3.9152934519456854`*^9, 3.9152945764080133`*^9, 
  3.9168899412797704`*^9},
 CellTags->{
  "Evaluation", 
   "Re-evaluation"},ExpressionUUID->"cd617635-c0c2-4400-b730-ff5999bd38b5"]
}, Closed]],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"\<\"ALP-fermion\"\>", ",", "\<\"ALP-gluon\"\>", 
    ",", "\<\"ALP-photon\"\>", ",", "\<\"B-3Le-Lmu+Ltau\"\>", 
    ",", "\<\"B-3Lmu\"\>", ",", "\<\"B-L\"\>", ",", "\<\"B-Le-3Lmu+Ltau\"\>", 
    ",", "\<\"DP\"\>", ",", "\<\"HNL\"\>", ",", "\<\"Scalar\"\>"}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.9152934519530706`*^9, 3.9152945764136868`*^9},
 CellTags->{"Evaluation", "Re-evaluation"},
 CellLabel->
  "Out[1053]=",ExpressionUUID->"f679aa18-de6e-4bbe-a042-b14510e9ac65"],

Cell[BoxData[
 FormBox["\"\<List of LLPs for which the acceptance will be computed:\>\"", 
  TraditionalForm]], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{3.9152934519456854`*^9, 3.9152945764177074`*^9, 
  3.9168899412954254`*^9},
 CellTags->{
  "Evaluation", 
   "Re-evaluation"},ExpressionUUID->"94b39adf-67a9-4736-bff8-d15778dc8e85"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", "\<\"ALP-fermion\"\>", "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.9152934519530706`*^9, 3.915294578934246*^9},
 CellTags->{"Evaluation", "Re-evaluation"},
 CellLabel->
  "Out[1056]=",ExpressionUUID->"db4fd183-1dcc-4b68-a93a-a1a213858c96"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Chapter to be automatically launched by the previous chapter. No need to \
launch it manually\
\>", "Title",
 CellChangeTimes->{{3.8896883278364477`*^9, 
  3.889688379627076*^9}},ExpressionUUID->"b4a43d11-cb45-4248-9b58-\
fa3cbda961f9"],

Cell[CellGroupData[{

Cell["Scalar", "Chapter",
 CellChangeTimes->{{3.8896886159303627`*^9, 3.8896886165850496`*^9}, {
   3.890211278099838*^9, 3.89021127819596*^9}, {3.890211408420647*^9, 
   3.890211411055007*^9}, 3.914573595807684*^9},
 CellTags->{
  "Scalar", "All"},ExpressionUUID->"bbaa7b71-c5de-463d-bc5f-bcee80cecd62"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dataS", "=", 
    RowBox[{"BlockExport", "[", 
     RowBox[{"\"\<Scalar\>\"", ",", "ivaltest"}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8896885802459803`*^9, 3.8896885827689047`*^9}, {
   3.890286002584097*^9, 3.890286005940942*^9}, {3.890410901345583*^9, 
   3.8904109035068307`*^9}, 3.8906394066157846`*^9, {3.890816223385516*^9, 
   3.890816223619833*^9}, {3.8913265507626486`*^9, 3.891326566098019*^9}, {
   3.8913266097136097`*^9, 3.8913266114175863`*^9}, {3.8913268968571424`*^9, 
   3.891326907713011*^9}, {3.898701929394251*^9, 3.898701930138372*^9}, {
   3.9017250415954337`*^9, 3.901725043232337*^9}, {3.903978340083085*^9, 
   3.9039783412366867`*^9}, {3.9039798655576477`*^9, 3.9039798665096188`*^9}, 
   3.904066812814445*^9, {3.9040669084551287`*^9, 3.9040669089997005`*^9}, 
   3.9048341958212495`*^9, 3.9121621757178483`*^9},
 CellTags->{"Scalar", "All"},
 CellLabel->
  "In[717]:=",ExpressionUUID->"699077d2-5244-4855-8318-7861677ff4d4"]
}, Closed]],

Cell[CellGroupData[{

Cell["HNL", "Chapter",
 CellChangeTimes->{{3.8896886159303627`*^9, 3.8896886165850496`*^9}, {
   3.889688683716093*^9, 3.8896886857401342`*^9}, 3.9145735968644953`*^9},
 CellTags->{
  "All", "HNL"},ExpressionUUID->"1c9c1db2-e817-43c7-a1c1-dc058a49f093"],

Cell[CellGroupData[{

Cell["e mixing", "Section",
 CellChangeTimes->{{3.8896776028040915`*^9, 3.88967761588931*^9}, {
  3.8896886191080112`*^9, 3.889688643231896*^9}, {3.8908159984033375`*^9, 
  3.890815999325034*^9}},
 CellTags->{
  "All", "HNL"},ExpressionUUID->"1e4fb3e2-de7d-4190-989a-2ba85613b49e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dataS", "=", 
    RowBox[{"BlockExport", "[", 
     RowBox[{"\"\<HNL-mixing-e\>\"", ",", "ivaltest"}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.890816018273184*^9, 3.890816020624732*^9}, {
   3.8908160568387513`*^9, 3.890816062188861*^9}, {3.8913269142971125`*^9, 
   3.8913269178328753`*^9}, {3.8987019570852327`*^9, 3.8987019581146774`*^9}, 
   3.9017250472823524`*^9, 3.904066814812254*^9, 3.904066911590951*^9, 
   3.9048341997893047`*^9, 3.9121621778076906`*^9},
 CellTags->{"All", "HNL"},
 CellLabel->
  "In[890]:=",ExpressionUUID->"3ed8b495-ecc2-4582-9e0d-3e71f7277e93"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[Mu] mixing", "Section",
 CellChangeTimes->{{3.8896776028040915`*^9, 3.88967761588931*^9}, {
  3.8896886191080112`*^9, 3.889688643231896*^9}, {3.8908159984033375`*^9, 
  3.890816006127554*^9}},
 CellTags->{
  "All", "HNL"},ExpressionUUID->"f8b65d43-6d66-48d3-af23-ebb851dbcef2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dataS", "=", 
    RowBox[{"BlockExport", "[", 
     RowBox[{"\"\<HNL-mixing-mu\>\"", ",", "ivaltest"}], "]"}]}], ";"}], "//",
   "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.890816046930589*^9, 3.8908160685155964`*^9}, {
   3.8913269211286597`*^9, 3.8913269239969816`*^9}, {3.8987019615871563`*^9, 
   3.8987019623446865`*^9}, 3.901725049237804*^9, 3.9040631285756426`*^9, 
   3.904066816853175*^9, 3.9040669132764196`*^9, 3.904834201138288*^9, 
   3.912162179791603*^9},
 CellTags->{"All", "HNL"},
 CellLabel->
  "In[891]:=",ExpressionUUID->"bad4ddac-67cc-4922-bab4-33fcc98f4b5f"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[Tau] mixing", "Section",
 CellChangeTimes->{{3.8896776028040915`*^9, 3.88967761588931*^9}, {
  3.8896886191080112`*^9, 3.889688643231896*^9}, {3.8908159984033375`*^9, 
  3.8908160107629995`*^9}},
 CellTags->{
  "All", "HNL"},ExpressionUUID->"246606c9-e825-4a9b-86a0-2b61184a5aa1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dataS", "=", 
    RowBox[{"BlockExport", "[", 
     RowBox[{"\"\<HNL-mixing-tau\>\"", ",", "1000"}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8908160518188677`*^9, 3.8908160779349165`*^9}, {
   3.891326926176611*^9, 3.8913269324090004`*^9}, {3.8987019639933434`*^9, 
   3.898701969297323*^9}, 3.901725051096363*^9, 3.904063107035528*^9, 
   3.9040668188833933`*^9, 3.904066915002926*^9, 3.9048342033923273`*^9, {
   3.9068009449239655`*^9, 3.9068009731559124`*^9}, 3.9121621819574184`*^9},
 CellTags->{"All", "HNL"},
 CellLabel->
  "In[892]:=",ExpressionUUID->"5a3395e6-b65d-4219-ab18-8f1212a83888"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Dark photon", "Chapter",
 CellChangeTimes->{{3.8896886159303627`*^9, 3.8896886165850496`*^9}, {
  3.8896886874423647`*^9, 3.889688689953738*^9}},
 CellTags->{
  "DP", "All"},ExpressionUUID->"b006c7e4-9235-48b6-acf0-5f68ba37a4de"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dataS", "=", 
    RowBox[{"BlockExport", "[", 
     RowBox[{"\"\<DP\>\"", ",", "ivaltest"}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8896885802459803`*^9, 3.8896885827689047`*^9}, {
   3.889694214540489*^9, 3.8896942153880816`*^9}, {3.890410983681602*^9, 
   3.8904109839319196`*^9}, 3.8904133470651274`*^9, {3.890816085201006*^9, 
   3.8908160911196613`*^9}, {3.891326934409067*^9, 3.8913269372174606`*^9}, 
   3.898701970718356*^9, 3.9017250523184357`*^9, 3.9040668239528775`*^9, 
   3.9040669177932444`*^9, 3.9048342049248123`*^9, 3.9121621835377707`*^9},
 CellTags->{"DP", "All"},
 CellLabel->
  "In[873]:=",ExpressionUUID->"54fe7186-2a6f-49bd-80fa-20f726215da5"]
}, Closed]],

Cell[CellGroupData[{

Cell["ALP-fermion", "Chapter",
 CellChangeTimes->{{3.8896886159303627`*^9, 3.8896886165850496`*^9}, {
  3.889688691481767*^9, 3.8896886928026557`*^9}},
 CellTags->{
  "All", "ALP-fermion"},ExpressionUUID->"f895a2e3-dd51-4275-9ad6-\
cb8a2d25bea8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dataS", "=", 
    RowBox[{"BlockExport", "[", 
     RowBox[{"\"\<ALP-fermion\>\"", ",", "ivaltest"}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8908161001874895`*^9, 3.8908161065598884`*^9}, {
   3.8913269399930305`*^9, 3.891326945104858*^9}, 3.8933482501790314`*^9, 
   3.8987019722492504`*^9, 3.9017250538282585`*^9, 3.904066826595016*^9, 
   3.9040669198609405`*^9, {3.904834207299658*^9, 3.90483420850706*^9}, 
   3.9121621859574027`*^9},
 CellTags->{"All", "ALP-fermion"},
 CellLabel->
  "In[774]:=",ExpressionUUID->"b728d505-2207-4e5e-841c-de8a87a4bb1d"]
}, Closed]],

Cell[CellGroupData[{

Cell["ALP-gluon", "Chapter",
 CellChangeTimes->{{3.8896886159303627`*^9, 3.8896886165850496`*^9}, {
  3.8896886944223056`*^9, 3.8896886966354637`*^9}},
 CellTags->{
  "All", "ALP-gluon"},ExpressionUUID->"bf90cb15-6490-441b-8316-f0b08b88a5dd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dataS", "=", 
    RowBox[{"BlockExport", "[", 
     RowBox[{"\"\<ALP-gluon\>\"", ",", "ivaltest"}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8896885802459803`*^9, 3.8896885827689047`*^9}, {
   3.8896899373248334`*^9, 3.8896899390426464`*^9}, {3.8904109916380396`*^9, 
   3.8904109920829134`*^9}, 3.8904133374848413`*^9, {3.8908161143241005`*^9, 
   3.8908161290543623`*^9}, {3.8913269484244795`*^9, 3.891326951768643*^9}, 
   3.8933482428877687`*^9, 3.898701973231733*^9, 3.9017250559509397`*^9, 
   3.904066829718545*^9, 3.9040669227381296`*^9, {3.9048342103581743`*^9, 
   3.904834210506663*^9}, 3.9121621876083264`*^9},
 CellTags->{"All", "ALP-gluon"},
 CellLabel->
  "In[2575]:=",ExpressionUUID->"1e460815-2625-4c6f-903c-38d9c89aa22a"]
}, Closed]],

Cell[CellGroupData[{

Cell["ALP-photon", "Chapter",
 CellChangeTimes->{{3.8896886159303627`*^9, 3.8896886165850496`*^9}, {
  3.8896886980974836`*^9, 3.889688699338743*^9}},
 CellTags->{
  "All", "ALP-photon"},ExpressionUUID->"fe998291-7eb5-44c3-9a88-45a1e678e2ad"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dataS", "=", 
    RowBox[{"BlockExport", "[", 
     RowBox[{"\"\<ALP-photon\>\"", ",", "ivaltest"}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8908161401122093`*^9, 3.8908161460060034`*^9}, {
   3.8913269550648193`*^9, 3.891326958625289*^9}, 3.8933482345256605`*^9, 
   3.898701974555247*^9, 3.901725057262084*^9, 3.904834212239154*^9, 
   3.912162189787862*^9},
 CellTags->{"All", "ALP-photon"},
 CellLabel->
  "In[2576]:=",ExpressionUUID->"86f38a14-6add-444a-8c8e-934849c5f2c9"]
}, Closed]],

Cell[CellGroupData[{

Cell["B-L mediator", "Chapter",
 CellChangeTimes->{{3.8896886159303627`*^9, 3.8896886165850496`*^9}, {
  3.8896886980974836`*^9, 3.889688699338743*^9}, {3.8941245471984444`*^9, 
  3.8941245487614183`*^9}},
 CellTags->{
  "All", "B-L"},ExpressionUUID->"1c928aac-e1bd-444d-8f5d-bb01858a0b9e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dataS", "=", 
    RowBox[{"BlockExport", "[", 
     RowBox[{"\"\<B-L\>\"", ",", "ivaltest"}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8908161401122093`*^9, 3.8908161460060034`*^9}, {
   3.8913269550648193`*^9, 3.891326958625289*^9}, 3.8933482345256605`*^9, {
   3.8941245521775813`*^9, 3.894124552789379*^9}, 3.8987019761246915`*^9, 
   3.9017250586568685`*^9, 3.904066832304923*^9, 3.9040669251551285`*^9, 
   3.9048342176353683`*^9, {3.9121621917176294`*^9, 3.9121621939677258`*^9}},
 CellTags->{"All", "B-L"},
 CellLabel->
  "In[2582]:=",ExpressionUUID->"4587e325-7527-4ae4-8b5d-9c0f2f5bacae"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"B", "-", 
    RowBox[{"3", 
     SubscriptBox["L", "\[Mu]"]}]}], TraditionalForm]],ExpressionUUID->
  "27958cb8-f109-4ac3-8261-7392b3cebe4b"],
 " mediator"
}], "Chapter",
 CellChangeTimes->{{3.8896886159303627`*^9, 3.8896886165850496`*^9}, {
  3.8896886980974836`*^9, 3.889688699338743*^9}, {3.8941245471984444`*^9, 
  3.8941245487614183`*^9}, {3.8963272477784033`*^9, 3.896327248648427*^9}},
 CellTags->{
  "All", "B-3Lmu"},ExpressionUUID->"f910c5d8-2d47-4ef3-b74e-1ffcff1ac1c6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dataS", "=", 
    RowBox[{"BlockExport", "[", 
     RowBox[{"\"\<B-3Lmu\>\"", ",", "ivaltest"}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8908161401122093`*^9, 3.8908161460060034`*^9}, {
   3.8913269550648193`*^9, 3.891326958625289*^9}, 3.8933482345256605`*^9, {
   3.8941245521775813`*^9, 3.894124552789379*^9}, {3.896327250054564*^9, 
   3.896327251023274*^9}, 3.898701977787983*^9, 3.9017250604750338`*^9, 
   3.9040668348207035`*^9, 3.9040669273338366`*^9, 3.9048342189092026`*^9, 
   3.912162196467767*^9},
 CellTags->{"All", "B-3Lmu"},
 CellLabel->
  "In[1684]:=",ExpressionUUID->"026e067e-b766-4284-bb3d-1bd2aabaebc1"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"B", "-", 
    RowBox[{"3", 
     SubscriptBox["L", "e"]}], "-", 
    SubscriptBox["L", "\[Mu]"], "+", 
    SubscriptBox["L", "\[Tau]"]}], TraditionalForm]],ExpressionUUID->
  "2fc339ce-1efd-49a4-9c5a-48fa7068aba1"],
 " mediator"
}], "Chapter",
 CellChangeTimes->{{3.8896886159303627`*^9, 3.8896886165850496`*^9}, {
  3.8896886980974836`*^9, 3.889688699338743*^9}, {3.8941245471984444`*^9, 
  3.8941245487614183`*^9}, {3.8963273153961496`*^9, 3.8963273195096984`*^9}},
 CellTags->{
  "All", "B-3Le-Lmu+Ltau"},ExpressionUUID->"01563783-279f-4977-a8a4-\
cff0a0e598d5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dataS", "=", 
    RowBox[{"BlockExport", "[", 
     RowBox[{"\"\<B-3Le-Lmu+Ltau\>\"", ",", "ivaltest"}], "]"}]}], ";"}], "//",
   "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8908161401122093`*^9, 3.8908161460060034`*^9}, {
   3.8913269550648193`*^9, 3.891326958625289*^9}, 3.8933482345256605`*^9, {
   3.8941245521775813`*^9, 3.894124552789379*^9}, {3.896327307150777*^9, 
   3.8963273127352066`*^9}, 3.8987019795558057`*^9, 3.9017250617527933`*^9, 
   3.904066851661615*^9, 3.9040669306381903`*^9, 3.904834221087583*^9, 
   3.912162198698868*^9},
 CellTags->{"All", "B-3Le-Lmu+Ltau"},
 CellLabel->
  "In[1686]:=",ExpressionUUID->"cab98ae5-0681-448c-a04c-d81238c69ee5"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"B", "-", 
    SubscriptBox["L", "e"], "-", 
    RowBox[{"3", 
     SubscriptBox["L", "\[Mu]"]}], "+", 
    SubscriptBox["L", "\[Tau]"]}], TraditionalForm]],ExpressionUUID->
  "db030216-f92a-441d-828b-891da98006c2"],
 " mediator"
}], "Chapter",
 CellChangeTimes->{{3.8896886159303627`*^9, 3.8896886165850496`*^9}, {
  3.8896886980974836`*^9, 3.889688699338743*^9}, {3.8941245471984444`*^9, 
  3.8941245487614183`*^9}, {3.8963273223545914`*^9, 3.8963273265510225`*^9}},
 CellTags->{
  "All", "B-Le-3Lmu+Ltau"},ExpressionUUID->"80184ca5-803c-4432-8e71-\
e11c163bb2dc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dataS", "=", 
    RowBox[{"BlockExport", "[", 
     RowBox[{"\"\<B-Le-3Lmu+Ltau\>\"", ",", "ivaltest"}], "]"}]}], ";"}], "//",
   "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8908161401122093`*^9, 3.8908161460060034`*^9}, {
   3.8913269550648193`*^9, 3.891326958625289*^9}, 3.8933482345256605`*^9, {
   3.8941245521775813`*^9, 3.894124552789379*^9}, {3.8963273009815197`*^9, 
   3.8963273048769073`*^9}, 3.898701981125592*^9, 3.901725063275606*^9, 
   3.904066853813018*^9, 3.9040669328055983`*^9, 3.9048342225080447`*^9, 
   3.9121622006192255`*^9},
 CellTags->{"All", "B-Le-3Lmu+Ltau"},
 CellLabel->
  "In[1686]:=",ExpressionUUID->"70ae1e98-041d-4edf-a42c-9edd436a9af1"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Deleting generated cells/proceeding to an other experiment", "Title",
 CellChangeTimes->{{3.9025559465149946`*^9, 3.9025559494966087`*^9}, {
  3.9025574606272383`*^9, 3.902557472341508*^9}},
 CellTags->"Technical",ExpressionUUID->"2e1061a5-786b-43f9-8573-302890477347"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"relaunch", "=", 
  RowBox[{"dropdownDialog", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\"\<Yes\>\"", ",", "\"\<No\>\""}], "}"}], ",", 
    RowBox[{"Row", "[", 
     RowBox[{
     "{", "\"\<Would you like to re-launch the calculation for another \
experiment after the given computation?\>\"", "}"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"relaunch", "==", "\"\<Yes\>\""}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nb", "=", 
     RowBox[{"EvaluationNotebook", "[", "]"}]}], ";", "\n", 
    RowBox[{"NotebookFind", "[", 
     RowBox[{
     "nb", ",", "\"\<Re-evaluation\>\"", ",", "All", ",", "CellTags"}], "]"}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"relaunch", "==", "\"\<No\>\""}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"deletecellsopt", "=", 
     RowBox[{"dropdownDialog", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<Yes\>\"", ",", "\"\<No\>\""}], "}"}], ",", 
       RowBox[{"Row", "[", 
        RowBox[{
        "{", "\"\<Would you like to remove all the generated output cells \
after the given computation?\>\"", "}"}], "]"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"deletecellsopt", "==", "\"\<Yes\>\""}], ",", 
      RowBox[{
       RowBox[{
       "FrontEndTokenExecute", "[", "\"\<DeleteGeneratedCells\>\"", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"FrontEndTokenExecute", "[", "\"\<SelectAll\>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "FrontEndTokenExecute", "[", "\"\<SelectionCloseAllGroups\>\"", "]"}], 
       ";"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.9025559062888603`*^9, 3.9025559062888603`*^9}, {
  3.902555964086707*^9, 3.902555989355214*^9}, {3.9025575340856752`*^9, 
  3.902557572290028*^9}, {3.902558525346404*^9, 3.9025585343800073`*^9}, {
  3.9025586514301004`*^9, 3.902558660382742*^9}, {3.9028053646947365`*^9, 
  3.9028053674697666`*^9}, {3.9029372692134156`*^9, 3.9029372786579924`*^9}, {
  3.9140935651833477`*^9, 3.9140936117057467`*^9}, {3.9146710687603626`*^9, 
  3.9146710694857187`*^9}},
 CellTags->"Technical",
 CellLabel->"In[1]:=",ExpressionUUID->"4ac1ea3e-6216-4062-aa73-e95dd16ba21a"]
}, Closed]]
},
WindowSize->{1117., 580.5},
WindowMargins->{{0, Automatic}, {0, Automatic}},
TaggingRules-><|"TryRealOnly" -> False|>,
ShowCellTags->True,
Magnification:>0.7 Inherited,
FrontEndVersion->"13.2 for Microsoft Windows (64-bit) (November 18, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"0856ecdb-dcfc-42c4-a383-a9a67dbd6690"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Evaluation"->{
  Cell[1577, 46, 318, 5, 60, "Title",ExpressionUUID->"f0d20480-5665-403d-a88a-e38db6e4fff2",
   CellTags->"Evaluation"],
  Cell[1920, 55, 221, 3, 58, "Chapter",ExpressionUUID->"b35f6bf0-7567-479d-b31b-629f7c8b6923",
   CellTags->"Evaluation"],
  Cell[2144, 60, 4394, 115, 177, "Input",ExpressionUUID->"cbf2546a-f572-4ac9-8b33-b22abc10dab6",
   CellTags->"Evaluation"],
  Cell[6575, 180, 278, 5, 58, "Chapter",ExpressionUUID->"1ff2cef8-8f58-4db0-9a05-69980a5a669e",
   CellTags->"Evaluation"],
  Cell[6878, 189, 195, 3, 57, "Section",ExpressionUUID->"9999c1f5-ee8b-445f-9d6d-aeca7091d16b",
   CellTags->"Evaluation"],
  Cell[7076, 194, 17265, 352, 370, "Input",ExpressionUUID->"defb41e9-f75c-4e83-a741-84207b36cb89",
   CellTags->"Evaluation"],
  Cell[24390, 552, 227, 4, 58, "Chapter",ExpressionUUID->"2e6dc84e-7eae-4401-b746-25315d0f950b",
   CellTags->"Evaluation"],
  Cell[24642, 560, 186, 3, 57, "Section",ExpressionUUID->"248bcdfc-6a6d-4069-a173-80b1bd55024a",
   CellTags->"Evaluation"],
  Cell[24831, 565, 17230, 434, 590, "Input",ExpressionUUID->"a7475b3a-4fa2-4f13-b3e0-208df08d3e19",
   CellTags->"Evaluation"],
  Cell[42098, 1004, 196, 3, 81, "Section",ExpressionUUID->"4aafee20-0ca5-4c67-a588-9d66bbadf25c",
   CellTags->"Evaluation"],
  Cell[42319, 1011, 503, 13, 68, "Subsection",ExpressionUUID->"7bcaf136-4b89-4e60-8ac5-23f41e11375a",
   CellTags->"Evaluation"],
  Cell[42825, 1026, 21528, 588, 610, "Input",ExpressionUUID->"b16454d7-342d-4f95-b605-96d825394282",
   CellTags->"Evaluation"],
  Cell[64378, 1618, 192, 3, 59, "Subsubsection",ExpressionUUID->"3cce2902-2ab2-4e73-8344-a98668894cd3",
   CellTags->"Evaluation"],
  Cell[64573, 1623, 1978, 55, 280, "Input",ExpressionUUID->"f698d818-b761-470e-abe1-b122f33e56f3",
   CellTags->"Evaluation"],
  Cell[66588, 1683, 271, 4, 59, "Subsubsection",ExpressionUUID->"efaf8abf-53d9-4f0b-b43d-12006d8589a2",
   CellTags->"Evaluation"],
  Cell[66862, 1689, 3682, 103, 295, "Input",ExpressionUUID->"e501226f-51a1-46c8-ad34-6f00cc1b7a29",
   CellTags->"Evaluation"],
  Cell[70581, 1797, 412, 11, 59, "Subsubsection",ExpressionUUID->"016ac244-a4b2-4c0e-94e4-6b9dfe729efb",
   CellTags->"Evaluation"],
  Cell[70996, 1810, 11760, 315, 575, "Input",ExpressionUUID->"17029912-dbcc-4c64-877a-10704f81d486",
   CellTags->"Evaluation"],
  Cell[82829, 2133, 451, 8, 51, "Chapter",ExpressionUUID->"0d1bd182-eac0-447d-ba67-c82fb46e0d37",
   CellTags->"Evaluation"],
  Cell[83305, 2145, 183, 3, 57, "Section",ExpressionUUID->"dd16eefb-96fb-4f43-a3b3-11b24ee6c151",
   CellTags->"Evaluation"],
  Cell[83491, 2150, 3901, 94, 116, "Input",ExpressionUUID->"9ec27b8b-9043-4a5a-a5d2-70c74445e4e7",
   CellTags->"Evaluation"],
  Cell[87429, 2249, 280, 5, 57, "Section",ExpressionUUID->"9e23489f-deb3-4031-b732-56602a865d5c",
   CellTags->"Evaluation"],
  Cell[87734, 2258, 308, 6, 47, "Subsection",ExpressionUUID->"eed76010-8733-46c2-9b12-fd21d2af2264",
   CellTags->"Evaluation"],
  Cell[88045, 2266, 20755, 544, 771, "Input",ExpressionUUID->"43a18e11-283b-420a-92fc-aff251f5a80c",
   CellTags->"Evaluation"],
  Cell[108815, 2813, 187, 3, 47, "Subsection",ExpressionUUID->"f9f9144a-e7bf-4b4f-93b4-6ed626e83341",
   CellTags->"Evaluation"],
  Cell[109039, 2821, 220, 4, 57, "Section",ExpressionUUID->"41ddb9fd-8c27-452a-8458-7602c6b0d4bf",
   CellTags->"Evaluation"],
  Cell[109284, 2829, 284, 6, 47, "Subsection",ExpressionUUID->"997f043b-e20c-4b42-aa24-2862493e38cd",
   CellTags->"Evaluation"],
  Cell[109571, 2837, 6207, 157, 295, "Input",ExpressionUUID->"5d4b8158-0d1a-47d1-b423-3c41be7e66aa",
   CellTags->"Evaluation"],
  Cell[115815, 2999, 187, 3, 47, "Subsection",ExpressionUUID->"9932a970-60aa-47a4-b3f9-9ecfce9cb1c3",
   CellTags->"Evaluation"],
  Cell[116005, 3004, 779, 19, 33, "Input",ExpressionUUID->"1d24b829-a1f5-49ff-8e85-029379d3e58a",
   CellTags->"Evaluation"],
  Cell[116833, 3029, 198, 4, 57, "Section",ExpressionUUID->"00f3a20e-73db-4965-86fd-fcf10490284e",
   CellTags->"Evaluation"],
  Cell[117056, 3037, 311, 6, 47, "Subsection",ExpressionUUID->"5fdec02b-4b00-4b0a-877b-d957108f2457",
   CellTags->"Evaluation"],
  Cell[117370, 3045, 380, 10, 30, "Input",ExpressionUUID->"336bc10f-b3d9-40b0-b911-7b972fc0105b",
   CellTags->"Evaluation"],
  Cell[117775, 3059, 184, 3, 41, "Subsubsection",ExpressionUUID->"e9418a91-e5ac-47cf-ba8b-5430e173b126",
   CellTags->"Evaluation"],
  Cell[117962, 3064, 6794, 181, 308, "Input",ExpressionUUID->"4a18ca05-02fe-49f8-aaa2-13ec7d0cd569",
   CellTags->"Evaluation"],
  Cell[124793, 3250, 190, 3, 41, "Subsubsection",ExpressionUUID->"8651dd6c-7b20-43d5-a4df-1b14d9456834",
   CellTags->"Evaluation"],
  Cell[124986, 3255, 6607, 178, 308, "Input",ExpressionUUID->"53898b75-321e-4175-9623-05ff4405cf70",
   CellTags->"Evaluation"],
  Cell[131630, 3438, 189, 3, 41, "Subsubsection",ExpressionUUID->"eaeed452-3f96-499a-987c-f590d6d211a8",
   CellTags->"Evaluation"],
  Cell[131822, 3443, 7096, 185, 308, "Input",ExpressionUUID->"57b30cc8-7707-4b83-9049-3de463d79e9d",
   CellTags->"Evaluation"],
  Cell[138967, 3634, 186, 3, 47, "Subsection",ExpressionUUID->"e94bdfe6-c3b0-4fd4-a617-4332a0f6a405",
   CellTags->"Evaluation"],
  Cell[139178, 3641, 362, 8, 42, "Subsubsection",ExpressionUUID->"50e0c4bd-37c7-4619-83fd-fd0e87cdf809",
   CellTags->"Evaluation"],
  Cell[139543, 3651, 6644, 176, 241, "Input",ExpressionUUID->"1bf083cf-0ca6-4620-9c3d-78f01f9b0a75",
   CellTags->"Evaluation"],
  Cell[146224, 3832, 708, 16, 40, "Subsubsection",ExpressionUUID->"c3cc3e7f-a5a0-47ef-b19c-cdbeda81c260",
   CellTags->"Evaluation"],
  Cell[146935, 3850, 12017, 310, 499, "Input",ExpressionUUID->"05913f27-fde0-42bd-842c-7a0ce4b32ced",
   CellTags->"Evaluation"],
  Cell[158989, 4165, 371, 9, 40, "Subsubsection",ExpressionUUID->"d2a994bd-5350-4d79-b690-0a540322322e",
   CellTags->"Evaluation"],
  Cell[159363, 4176, 14218, 367, 575, "Input",ExpressionUUID->"3e8f5c91-875c-4cc2-9fac-799e334e4796",
   CellTags->"Evaluation"],
  Cell[173642, 4550, 241, 4, 57, "Section",ExpressionUUID->"ea766b8e-6762-49cc-a1b9-274a472815cd",
   CellTags->"Evaluation"],
  Cell[173908, 4558, 311, 6, 47, "Subsection",ExpressionUUID->"1aacebd3-7931-4ad0-988a-968a791f6675",
   CellTags->"Evaluation"],
  Cell[174222, 4566, 7373, 179, 283, "Input",ExpressionUUID->"f6e36b4a-78e2-4a93-b131-229beee2f190",
   CellTags->"Evaluation"],
  Cell[181632, 4750, 196, 3, 47, "Subsection",ExpressionUUID->"a8d77950-e6b3-40bb-8c1e-7a713b7a62fe",
   CellTags->"Evaluation"],
  Cell[181831, 4755, 2288, 52, 70, "Input",ExpressionUUID->"15d703f0-9e4f-42aa-9a82-6d76df0055b2",
   CellTags->"Evaluation"],
  Cell[184168, 4813, 192, 3, 57, "Section",ExpressionUUID->"fe9117b4-795b-46d1-b007-e1256f913147",
   CellTags->"Evaluation"],
  Cell[184385, 4820, 311, 6, 47, "Subsection",ExpressionUUID->"22b626f4-2eac-4626-a398-c1e830fc3980",
   CellTags->"Evaluation"],
  Cell[184699, 4828, 6426, 155, 270, "Input",ExpressionUUID->"459f62a8-1a49-4970-b885-3c2c821d7e75",
   CellTags->"Evaluation"],
  Cell[191150, 4987, 230, 3, 41, "Subsubsection",ExpressionUUID->"fe6e38c6-7109-4245-97d4-d07f1457aa5a",
   CellTags->"Evaluation"],
  Cell[191383, 4992, 5116, 134, 283, "Input",ExpressionUUID->"53c4c9a6-438c-4944-9fa9-cdad5017a9d0",
   CellTags->"Evaluation"],
  Cell[196548, 5132, 196, 3, 47, "Subsection",ExpressionUUID->"054e6167-fe2d-46e7-b18a-d2c0e8b4862d",
   CellTags->"Evaluation"],
  Cell[196747, 5137, 2262, 53, 70, "Input",ExpressionUUID->"45927e91-2484-4aa4-ae94-c5dc93a90cc5",
   CellTags->"Evaluation"],
  Cell[199058, 5196, 235, 4, 57, "Section",ExpressionUUID->"f5888daf-dc6d-4b79-8340-d2eb4d2eef5e",
   CellTags->"Evaluation"],
  Cell[199318, 5204, 288, 6, 47, "Subsection",ExpressionUUID->"67e077de-a854-4ed9-bb6e-0f56d558757e",
   CellTags->"Evaluation"],
  Cell[199609, 5212, 6425, 171, 321, "Input",ExpressionUUID->"b6a47b0c-812e-4eb8-9fec-6594ccfcbf4b",
   CellTags->"Evaluation"],
  Cell[206071, 5388, 198, 3, 68, "Subsection",ExpressionUUID->"d3d1a7f3-957f-45e0-b845-bf4c768d7134",
   CellTags->"Evaluation"],
  Cell[206294, 5395, 445, 10, 59, "Subsubsection",ExpressionUUID->"9166f2c9-b344-47cc-b044-43f89b5eada0",
   CellTags->"Evaluation"],
  Cell[206742, 5407, 7949, 203, 390, "Input",ExpressionUUID->"15a1cbfa-206b-4f17-9cfd-bef8df901f4d",
   CellTags->"Evaluation"],
  Cell[214752, 5617, 527, 13, 50, "Section",ExpressionUUID->"28cb1a40-2b68-4b15-9d83-e0666ac7f19c",
   CellTags->"Evaluation"],
  Cell[215304, 5634, 288, 6, 47, "Subsection",ExpressionUUID->"f9bb6349-e588-4163-9585-0d29bc8465e6",
   CellTags->"Evaluation"],
  Cell[215595, 5642, 6729, 175, 321, "Input",ExpressionUUID->"0fe4e2f4-7774-4aa1-b1b2-b44abd9e6132",
   CellTags->"Evaluation"],
  Cell[222361, 5822, 186, 3, 68, "Subsection",ExpressionUUID->"e3338e34-6461-4f4e-81a2-53e1a8470b12",
   CellTags->"Evaluation"],
  Cell[222550, 5827, 1157, 26, 64, "Input",ExpressionUUID->"55816ca9-af9a-4ccf-9f3d-d838b909efbd",
   CellTags->"Evaluation"],
  Cell[223756, 5859, 658, 16, 50, "Section",ExpressionUUID->"06eb5843-69b2-4415-a4d4-3ec60c36d233",
   CellTags->"Evaluation"],
  Cell[224439, 5879, 286, 6, 47, "Subsection",ExpressionUUID->"41d4b3d0-e7c2-4f72-9454-72959a435735",
   CellTags->"Evaluation"],
  Cell[224728, 5887, 6612, 172, 321, "Input",ExpressionUUID->"223099e3-ae64-43e7-836e-97de94303b69",
   CellTags->"Evaluation"],
  Cell[231377, 6064, 186, 3, 68, "Subsection",ExpressionUUID->"ac48ae3d-943c-4136-91ba-50511572c0ac",
   CellTags->"Evaluation"],
  Cell[231566, 6069, 1118, 27, 64, "Input",ExpressionUUID->"c575eadb-a8ad-4d4a-b2e8-619a739765b0",
   CellTags->"Evaluation"],
  Cell[232733, 6102, 704, 17, 50, "Section",ExpressionUUID->"9f6a6e02-9a25-4aa8-b6f1-d87380e40126",
   CellTags->"Evaluation"],
  Cell[233462, 6123, 288, 6, 47, "Subsection",ExpressionUUID->"b7c1f35c-21d3-4197-949b-6cad819cbb9e",
   CellTags->"Evaluation"],
  Cell[233753, 6131, 6570, 171, 321, "Input",ExpressionUUID->"1ac9d6ea-33b0-4c81-888c-d344bd52a579",
   CellTags->"Evaluation"],
  Cell[240360, 6307, 186, 3, 47, "Subsection",ExpressionUUID->"276a2c97-947c-4da9-97fb-9cae6ccef417",
   CellTags->"Evaluation"],
  Cell[240549, 6312, 1117, 27, 46, "Input",ExpressionUUID->"bcb9455b-1c67-4401-ac7a-1ef81d817f1b",
   CellTags->"Evaluation"],
  Cell[241715, 6345, 191, 3, 57, "Section",ExpressionUUID->"37cd9831-53d8-4b2c-981e-30c88bc5ef3b",
   CellTags->"Evaluation"],
  Cell[241931, 6352, 258, 5, 47, "Subsection",ExpressionUUID->"1164b49a-4ab3-444b-b6c7-e6498c0cb8e7",
   CellTags->"Evaluation"],
  Cell[242192, 6359, 2589, 65, 137, "Input",ExpressionUUID->"93637fcd-b2a5-45f3-81c4-00c0428b83fa",
   CellTags->"Evaluation"],
  Cell[244796, 6427, 185, 3, 47, "Subsection",ExpressionUUID->"6ed24e69-aa48-4f5a-91d7-fa281655f0b4",
   CellTags->"Evaluation"],
  Cell[245018, 6435, 210, 4, 57, "Section",ExpressionUUID->"9ff1bc08-ec30-4e57-94cb-930d33ed3e9c",
   CellTags->"Evaluation"],
  Cell[245231, 6441, 7812, 204, 388, "Input",ExpressionUUID->"90b579f1-0233-4b93-ae6f-5f912193c54e",
   CellTags->"Evaluation"],
  Cell[253080, 6650, 191, 3, 57, "Section",ExpressionUUID->"13911d2c-878e-4efb-99cf-9fc58317f0a7",
   CellTags->"Evaluation"],
  Cell[253296, 6657, 365, 5, 47, "Subsection",ExpressionUUID->"0e7b00e6-10b3-4b9d-972b-4dff8fb5d317",
   CellTags->"Evaluation"],
  Cell[253686, 6666, 190, 3, 41, "Subsubsection",ExpressionUUID->"7b90e0a0-a42a-4bb8-805b-8ca2c07a02d9",
   CellTags->"Evaluation"],
  Cell[253879, 6671, 5490, 136, 102, "Input",ExpressionUUID->"78f8477d-c430-40b1-839f-0ce3f2d38eef",
   CellTags->"Evaluation"],
  Cell[259406, 6812, 433, 10, 40, "Subsubsection",ExpressionUUID->"5c10c41a-5fb4-4845-a002-49c1f8f8b0c6",
   CellTags->"Evaluation"],
  Cell[259842, 6824, 4990, 135, 114, "Input",ExpressionUUID->"d99502b0-5776-4e98-bdd4-d144c1ff2a82",
   CellTags->"Evaluation"],
  Cell[264869, 6964, 534, 10, 40, "Subsubsection",ExpressionUUID->"261f66b9-4bd4-428a-8e24-61f625a4fc0f",
   CellTags->"Evaluation"],
  Cell[265406, 6976, 8474, 219, 166, "Input",ExpressionUUID->"29d6e60d-3d82-455c-b45f-10d08c5e84d5",
   CellTags->"Evaluation"],
  Cell[273917, 7200, 412, 10, 40, "Subsubsection",ExpressionUUID->"dfed6dc9-54e9-482c-91f1-56aeacd12223",
   CellTags->"Evaluation"],
  Cell[274332, 7212, 4922, 124, 98, "Input",ExpressionUUID->"a325ae9e-495b-417d-a8aa-3e0c89f50f33",
   CellTags->"Evaluation"],
  Cell[279303, 7342, 190, 3, 47, "Subsection",ExpressionUUID->"fdea899d-b657-4b1b-a48b-c05bbbaddca5",
   CellTags->"Evaluation"],
  Cell[279496, 7347, 3330, 89, 83, "Input",ExpressionUUID->"17dcbf02-6f8d-4a7c-afff-a857c096b0f9",
   CellTags->"Evaluation"],
  Cell[282887, 7443, 341, 7, 58, "Chapter",ExpressionUUID->"cd02dbae-e64d-4e38-9189-47d7c3a03e99",
   CellTags->"Evaluation"],
  Cell[283253, 7454, 375, 5, 81, "Section",ExpressionUUID->"b2d5f626-56ad-4f1d-b77b-14d03938e14e",
   CellTags->"Evaluation"],
  Cell[283653, 7463, 439, 8, 68, "Subsection",ExpressionUUID->"cc1c5e0c-1ece-4ae5-80f2-f9816b9a0646",
   CellTags->"Evaluation"],
  Cell[284095, 7473, 12966, 290, 522, "Input",ExpressionUUID->"ea334552-f4d8-4460-ac10-2a74a6ed435f",
   CellTags->"Evaluation"],
  Cell[297098, 7768, 437, 8, 68, "Subsection",ExpressionUUID->"987b9a31-b010-49bd-9a41-747900bfb951",
   CellTags->"Evaluation"],
  Cell[297538, 7778, 33206, 745, 1287, "Input",ExpressionUUID->"73ebc8cc-0c82-42c9-97ae-0a5372c43ef4",
   CellTags->"Evaluation"],
  Cell[330781, 8528, 346, 7, 47, "Subsection",ExpressionUUID->"6ec09f6e-f174-4208-b470-19e7eb773eca",
   CellTags->"Evaluation"],
  Cell[331130, 8537, 11228, 241, 470, "Input",ExpressionUUID->"cae8fe6a-4f13-485a-8a32-1e66445fa00d",
   CellTags->"Evaluation"],
  Cell[342395, 8783, 441, 8, 47, "Subsection",ExpressionUUID->"ccd71674-982a-4dce-b477-7b3be574a83b",
   CellTags->"Evaluation"],
  Cell[342861, 8795, 240, 4, 41, "Subsubsection",ExpressionUUID->"c80d0832-b4c4-4436-8443-880f50b08cb7",
   CellTags->"Evaluation"],
  Cell[343104, 8801, 17731, 432, 831, "Input",ExpressionUUID->"d0b3ce53-04c8-4ffd-ba51-534597a958ca",
   CellTags->"Evaluation"],
  Cell[360872, 9238, 260, 4, 41, "Subsubsection",ExpressionUUID->"f1346d6a-8d30-4a82-b412-0b558a2cb0f5",
   CellTags->"Evaluation"],
  Cell[361135, 9244, 8666, 208, 288, "Input",ExpressionUUID->"0c3f67ee-8861-4425-8b36-f6be673a16f5",
   CellTags->"Evaluation"],
  Cell[369850, 9458, 313, 7, 47, "Subsection",ExpressionUUID->"767de7a6-fe87-42e9-aac1-27c33f88badb",
   CellTags->"Evaluation"],
  Cell[370166, 9467, 9293, 218, 486, "Input",ExpressionUUID->"bf53e5ee-6d16-4c02-ac99-4a87fde0b0b1",
   CellTags->"Evaluation"],
  Cell[379666, 9694, 187, 3, 41, "Subsubsection",ExpressionUUID->"30824934-976f-4630-812a-81efbb81d158",
   CellTags->"Evaluation"],
  Cell[379856, 9699, 20964, 438, 847, "Input",ExpressionUUID->"bcfeaf0d-fb4d-43f5-b592-deff52e89a57",
   CellTags->"Evaluation"],
  Cell[400881, 10144, 412, 7, 57, "Section",ExpressionUUID->"814d7fb1-92f2-48b0-8a43-c1cc7700a07e",
   CellTags->"Evaluation"],
  Cell[401296, 10153, 13033, 343, 350, "Input",ExpressionUUID->"bcaf1bfd-2d1a-48e4-a12d-d60d4ae88bf8",
   CellTags->"Evaluation"],
  Cell[446267, 11353, 374, 5, 58, "Chapter",ExpressionUUID->"04c1ab10-71a6-497f-94ce-68390b638778",
   CellTags->"Evaluation"],
  Cell[446666, 11362, 318, 6, 57, "Section",ExpressionUUID->"05e94672-f6cd-434c-82a8-365c8d09f18c",
   CellTags->"Evaluation"],
  Cell[447009, 11372, 187, 3, 47, "Subsection",ExpressionUUID->"b27dc8ee-5ddc-403b-8779-db96163f2852",
   CellTags->"Evaluation"],
  Cell[447199, 11377, 16064, 412, 511, "Input",ExpressionUUID->"58e9f572-dc35-4942-bb43-9c3b49b5b857",
   CellTags->"Evaluation"],
  Cell[463300, 11794, 291, 5, 47, "Subsection",ExpressionUUID->"2809492e-2ac2-45a8-a0c5-517a501d1b21",
   CellTags->"Evaluation"],
  Cell[463616, 11803, 179, 3, 41, "Subsubsection",ExpressionUUID->"25f5817b-5cf0-47ee-8730-697f19e5a5a1",
   CellTags->"Evaluation"],
  Cell[463798, 11808, 22312, 608, 889, "Input",ExpressionUUID->"aa90ff4c-871d-4f14-8c66-44f88731bc27",
   CellTags->"Evaluation"],
  Cell[486147, 12421, 192, 3, 41, "Subsubsection",ExpressionUUID->"3a8153bf-f8ea-4dec-b27c-1941df4d3446",
   CellTags->"Evaluation"],
  Cell[486342, 12426, 13639, 362, 531, "Input",ExpressionUUID->"4d6d84cc-6468-4846-bf31-c6438c6fd6ef",
   CellTags->"Evaluation"],
  Cell[500042, 12795, 176, 3, 57, "Section",ExpressionUUID->"ae5880a5-2d5f-4e45-976c-b85057eda045",
   CellTags->"Evaluation"],
  Cell[500243, 12802, 200, 3, 47, "Subsection",ExpressionUUID->"1fb49388-bed7-4e96-8dd9-01762efe4772",
   CellTags->"Evaluation"],
  Cell[500446, 12807, 6039, 151, 284, "Input",ExpressionUUID->"a79320cd-0d99-43fb-808f-7ae5821314a3",
   CellTags->"Evaluation"],
  Cell[506522, 12963, 199, 3, 47, "Subsection",ExpressionUUID->"ddf1802a-9d74-44ec-8027-ff68a7e281ad",
   CellTags->"Evaluation"],
  Cell[506724, 12968, 2657, 69, 153, "Input",ExpressionUUID->"4f88dadc-62a7-4c7e-b264-2a24eba51db8",
   CellTags->"Evaluation"],
  Cell[509418, 13042, 555, 12, 66, "Subsection",ExpressionUUID->"049a2a4d-92fb-4feb-adfe-14f536d3c212",
   CellTags->"Evaluation"],
  Cell[509976, 13056, 16539, 391, 464, "Input",ExpressionUUID->"0550c48c-e450-4ace-bc02-f0ffdaf95418",
   CellTags->"Evaluation"],
  Cell[526540, 13451, 190, 3, 41, "Subsubsection",ExpressionUUID->"67acb5b1-0310-4ea2-9d6c-320976f9c01d",
   CellTags->"Evaluation"],
  Cell[526733, 13456, 7000, 154, 187, "Input",ExpressionUUID->"43dae102-92b1-4ee4-9d18-a8aef4fd7010",
   CellTags->"Evaluation"],
  Cell[533782, 13616, 187, 3, 47, "Subsection",ExpressionUUID->"057fa2fe-e48a-4f24-b9cc-3fb1e545193a",
   CellTags->"Evaluation"],
  Cell[533972, 13621, 11860, 303, 725, "Input",ExpressionUUID->"e7b14f0b-6354-4c9b-8550-57165daae3a4",
   CellTags->"Evaluation"],
  Cell[545869, 13929, 202, 3, 47, "Subsection",ExpressionUUID->"dbf823ef-a081-4f4f-aff6-fc1892c23782",
   CellTags->"Evaluation"],
  Cell[546074, 13934, 17230, 404, 634, "Input",ExpressionUUID->"ea795165-d9bf-45bf-9479-cded8e0281dd",
   CellTags->"Evaluation"],
  Cell[575055, 14637, 208, 3, 47, "Subsection",ExpressionUUID->"22bfd06d-d1da-435d-af12-6d2c5b7dbaf5",
   CellTags->"Evaluation"],
  Cell[575266, 14642, 11738, 294, 484, "Input",ExpressionUUID->"aa654507-7d74-4953-9e3d-e34911a51922",
   CellTags->"Evaluation"],
  Cell[587041, 14941, 200, 3, 47, "Subsection",ExpressionUUID->"ca72417d-b6ee-4d74-9da9-0591ae8c77a0",
   CellTags->"Evaluation"],
  Cell[587244, 14946, 15231, 411, 696, "Input",ExpressionUUID->"09e401fa-b97a-49df-9839-a035ce54d3dc",
   CellTags->"Evaluation"],
  Cell[602536, 15364, 379, 6, 58, "Chapter",ExpressionUUID->"39f5d476-0447-46a9-bd00-1cdb56a7b006",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[602918, 15372, 36226, 773, 952, "Input",ExpressionUUID->"222b649c-d0d0-4e4e-90ac-20f5b01506c5",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[639147, 16147, 931, 21, 43, "Input",ExpressionUUID->"21b5be0d-8608-4a68-9966-97f8bc3357d7",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[640103, 16172, 233, 5, 57, "Section",ExpressionUUID->"dbbace72-7cb7-41ad-91b5-df16cb2ce6bf",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[640361, 16181, 224, 4, 47, "Subsection",ExpressionUUID->"dc453ba5-d8f2-4400-a0e8-3d01db899a22",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[640588, 16187, 15573, 361, 723, "Input",ExpressionUUID->"1f57ba00-dab2-4e11-9e20-d271c6dfde08",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[656198, 16553, 223, 4, 47, "Subsection",ExpressionUUID->"086c760b-5c04-4092-95c6-5d5fa2b92a12",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[656424, 16559, 13093, 331, 335, "Input",ExpressionUUID->"215cf060-2dca-482b-8771-8e0ac5bce801",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[669566, 16896, 223, 4, 57, "Section",ExpressionUUID->"3d33661f-1bcd-4438-8890-08599e47b3f3",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[669792, 16902, 11414, 247, 235, "Input",ExpressionUUID->"c09962ae-6e4a-4d15-bea5-a3e8cda1c0b2",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[681267, 17156, 356, 5, 60, "Title",ExpressionUUID->"7ef276aa-6ac2-44b6-8659-f620e946504b",
   CellTags->"Evaluation"],
  Cell[681648, 17165, 260, 6, 58, "Chapter",ExpressionUUID->"75496f98-5d16-4d12-8062-af46b66ba6fe",
   CellTags->"Evaluation"],
  Cell[681911, 17173, 4017, 108, 159, "Input",ExpressionUUID->"a351b5a7-3968-47b6-9206-0b80d566fd66",
   CellTags->"Evaluation"],
  Cell[685953, 17285, 379, 6, 57, "Section",ExpressionUUID->"69890af2-32c0-41ab-b90f-aaf902234c1e",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[686335, 17293, 11670, 292, 324, "Input",ExpressionUUID->"0b5b19ea-8b21-416c-951d-2092f610aec4",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[698203, 17595, 15161, 355, 629, "Input",ExpressionUUID->"038c1ab8-352c-4f0a-b20f-18632e7b8ff7",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[713413, 17956, 514, 8, 58, "Chapter",ExpressionUUID->"da3b7ec0-b669-408d-a6e2-09447629531d",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[713952, 17968, 6747, 161, 256, "Input",ExpressionUUID->"57e9a41d-0896-4230-a4c5-a35b43efa2a2",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[720724, 18133, 409, 9, 27, "Print",ExpressionUUID->"0b0c6f28-15f4-4816-bb8a-bc2762136e45",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[721136, 18144, 365, 8, 27, "Print",ExpressionUUID->"e4216446-ae9f-4e72-b238-b37a5c34e8fd",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[721504, 18154, 326, 8, 27, "Print",ExpressionUUID->"cd617635-c0c2-4400-b730-ff5999bd38b5",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[721845, 18165, 545, 11, 33, "Output",ExpressionUUID->"f679aa18-de6e-4bbe-a042-b14510e9ac65",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[722393, 18178, 371, 9, 27, "Print",ExpressionUUID->"94b39adf-67a9-4736-bff8-d15778dc8e85",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[722767, 18189, 291, 6, 33, "Output",ExpressionUUID->"db4fd183-1dcc-4b68-a93a-a1a213858c96",
   CellTags->{"Evaluation", "Re-evaluation"}]},
 "Re-evaluation"->{
  Cell[602536, 15364, 379, 6, 58, "Chapter",ExpressionUUID->"39f5d476-0447-46a9-bd00-1cdb56a7b006",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[602918, 15372, 36226, 773, 952, "Input",ExpressionUUID->"222b649c-d0d0-4e4e-90ac-20f5b01506c5",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[639147, 16147, 931, 21, 43, "Input",ExpressionUUID->"21b5be0d-8608-4a68-9966-97f8bc3357d7",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[640103, 16172, 233, 5, 57, "Section",ExpressionUUID->"dbbace72-7cb7-41ad-91b5-df16cb2ce6bf",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[640361, 16181, 224, 4, 47, "Subsection",ExpressionUUID->"dc453ba5-d8f2-4400-a0e8-3d01db899a22",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[640588, 16187, 15573, 361, 723, "Input",ExpressionUUID->"1f57ba00-dab2-4e11-9e20-d271c6dfde08",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[656198, 16553, 223, 4, 47, "Subsection",ExpressionUUID->"086c760b-5c04-4092-95c6-5d5fa2b92a12",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[656424, 16559, 13093, 331, 335, "Input",ExpressionUUID->"215cf060-2dca-482b-8771-8e0ac5bce801",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[669566, 16896, 223, 4, 57, "Section",ExpressionUUID->"3d33661f-1bcd-4438-8890-08599e47b3f3",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[669792, 16902, 11414, 247, 235, "Input",ExpressionUUID->"c09962ae-6e4a-4d15-bea5-a3e8cda1c0b2",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[685953, 17285, 379, 6, 57, "Section",ExpressionUUID->"69890af2-32c0-41ab-b90f-aaf902234c1e",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[686335, 17293, 11670, 292, 324, "Input",ExpressionUUID->"0b5b19ea-8b21-416c-951d-2092f610aec4",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[698203, 17595, 15161, 355, 629, "Input",ExpressionUUID->"038c1ab8-352c-4f0a-b20f-18632e7b8ff7",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[713413, 17956, 514, 8, 58, "Chapter",ExpressionUUID->"da3b7ec0-b669-408d-a6e2-09447629531d",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[713952, 17968, 6747, 161, 256, "Input",ExpressionUUID->"57e9a41d-0896-4230-a4c5-a35b43efa2a2",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[720724, 18133, 409, 9, 27, "Print",ExpressionUUID->"0b0c6f28-15f4-4816-bb8a-bc2762136e45",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[721136, 18144, 365, 8, 27, "Print",ExpressionUUID->"e4216446-ae9f-4e72-b238-b37a5c34e8fd",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[721504, 18154, 326, 8, 27, "Print",ExpressionUUID->"cd617635-c0c2-4400-b730-ff5999bd38b5",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[721845, 18165, 545, 11, 33, "Output",ExpressionUUID->"f679aa18-de6e-4bbe-a042-b14510e9ac65",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[722393, 18178, 371, 9, 27, "Print",ExpressionUUID->"94b39adf-67a9-4736-bff8-d15778dc8e85",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[722767, 18189, 291, 6, 33, "Output",ExpressionUUID->"db4fd183-1dcc-4b68-a93a-a1a213858c96",
   CellTags->{"Evaluation", "Re-evaluation"}]},
 "Scalar"->{
  Cell[723390, 18212, 304, 5, 58, "Chapter",ExpressionUUID->"bbaa7b71-c5de-463d-bc5f-bcee80cecd62",
   CellTags->{"Scalar", "All"}],
  Cell[723697, 18219, 1039, 19, 30, "Input",ExpressionUUID->"699077d2-5244-4855-8318-7861677ff4d4",
   CellTags->{"Scalar", "All"}]},
 "All"->{
  Cell[723390, 18212, 304, 5, 58, "Chapter",ExpressionUUID->"bbaa7b71-c5de-463d-bc5f-bcee80cecd62",
   CellTags->{"Scalar", "All"}],
  Cell[723697, 18219, 1039, 19, 30, "Input",ExpressionUUID->"699077d2-5244-4855-8318-7861677ff4d4",
   CellTags->{"Scalar", "All"}],
  Cell[724773, 18243, 253, 4, 58, "Chapter",ExpressionUUID->"1c9c1db2-e817-43c7-a1c1-dc058a49f093",
   CellTags->{"All", "HNL"}],
  Cell[725051, 18251, 281, 5, 66, "Section",ExpressionUUID->"1e4fb3e2-de7d-4190-989a-2ba85613b49e",
   CellTags->{"All", "HNL"}],
  Cell[725335, 18258, 660, 14, 33, "Input",ExpressionUUID->"3ed8b495-ecc2-4582-9e0d-3e71f7277e93",
   CellTags->{"All", "HNL"}],
  Cell[726032, 18277, 285, 5, 66, "Section",ExpressionUUID->"f8b65d43-6d66-48d3-af23-ebb851dbcef2",
   CellTags->{"All", "HNL"}],
  Cell[726320, 18284, 635, 14, 33, "Input",ExpressionUUID->"bad4ddac-67cc-4922-bab4-33fcc98f4b5f",
   CellTags->{"All", "HNL"}],
  Cell[726992, 18303, 288, 5, 66, "Section",ExpressionUUID->"246606c9-e825-4a9b-86a0-2b61184a5aa1",
   CellTags->{"All", "HNL"}],
  Cell[727283, 18310, 682, 14, 33, "Input",ExpressionUUID->"5a3395e6-b65d-4219-ab18-8f1212a83888",
   CellTags->{"All", "HNL"}],
  Cell[728014, 18330, 235, 4, 51, "Chapter",ExpressionUUID->"b006c7e4-9235-48b6-acf0-5f68ba37a4de",
   CellTags->{"DP", "All"}],
  Cell[728252, 18336, 751, 15, 33, "Input",ExpressionUUID->"54fe7186-2a6f-49bd-80fa-20f726215da5",
   CellTags->{"DP", "All"}],
  Cell[729040, 18356, 246, 5, 51, "Chapter",ExpressionUUID->"f895a2e3-dd51-4275-9ad6-cb8a2d25bea8",
   CellTags->{"All", "ALP-fermion"}],
  Cell[729289, 18363, 642, 14, 30, "Input",ExpressionUUID->"b728d505-2207-4e5e-841c-de8a87a4bb1d",
   CellTags->{"All", "ALP-fermion"}],
  Cell[729968, 18382, 242, 4, 58, "Chapter",ExpressionUUID->"bf90cb15-6490-441b-8316-f0b08b88a5dd",
   CellTags->{"All", "ALP-gluon"}],
  Cell[730213, 18388, 822, 16, 44, "Input",ExpressionUUID->"1e460815-2625-4c6f-903c-38d9c89aa22a",
   CellTags->{"All", "ALP-gluon"}],
  Cell[731072, 18409, 242, 4, 51, "Chapter",ExpressionUUID->"fe998291-7eb5-44c3-9a88-45a1e678e2ad",
   CellTags->{"All", "ALP-photon"}],
  Cell[731317, 18415, 562, 13, 44, "Input",ExpressionUUID->"86f38a14-6add-444a-8c8e-934849c5f2c9",
   CellTags->{"All", "ALP-photon"}],
  Cell[731916, 18433, 290, 5, 51, "Chapter",ExpressionUUID->"1c928aac-e1bd-444d-8f5d-bb01858a0b9e",
   CellTags->{"All", "B-L"}],
  Cell[732209, 18440, 680, 14, 44, "Input",ExpressionUUID->"4587e325-7527-4ae4-8b5d-9c0f2f5bacae",
   CellTags->{"All", "B-L"}],
  Cell[732926, 18459, 534, 13, 52, "Chapter",ExpressionUUID->"f910c5d8-2d47-4ef3-b74e-1ffcff1ac1c6",
   CellTags->{"All", "B-3Lmu"}],
  Cell[733463, 18474, 708, 15, 33, "Input",ExpressionUUID->"026e067e-b766-4284-bb3d-1bd2aabaebc1",
   CellTags->{"All", "B-3Lmu"}],
  Cell[734208, 18494, 619, 16, 52, "Chapter",ExpressionUUID->"01563783-279f-4977-a8a4-cff0a0e598d5",
   CellTags->{"All", "B-3Le-Lmu+Ltau"}],
  Cell[734830, 18512, 724, 15, 33, "Input",ExpressionUUID->"cab98ae5-0681-448c-a04c-d81238c69ee5",
   CellTags->{"All", "B-3Le-Lmu+Ltau"}],
  Cell[735591, 18532, 619, 16, 52, "Chapter",ExpressionUUID->"80184ca5-803c-4432-8e71-e11c163bb2dc",
   CellTags->{"All", "B-Le-3Lmu+Ltau"}],
  Cell[736213, 18550, 726, 15, 30, "Input",ExpressionUUID->"70ae1e98-041d-4edf-a42c-9edd436a9af1",
   CellTags->{"All", "B-Le-3Lmu+Ltau"}]},
 "HNL"->{
  Cell[724773, 18243, 253, 4, 58, "Chapter",ExpressionUUID->"1c9c1db2-e817-43c7-a1c1-dc058a49f093",
   CellTags->{"All", "HNL"}],
  Cell[725051, 18251, 281, 5, 66, "Section",ExpressionUUID->"1e4fb3e2-de7d-4190-989a-2ba85613b49e",
   CellTags->{"All", "HNL"}],
  Cell[725335, 18258, 660, 14, 33, "Input",ExpressionUUID->"3ed8b495-ecc2-4582-9e0d-3e71f7277e93",
   CellTags->{"All", "HNL"}],
  Cell[726032, 18277, 285, 5, 66, "Section",ExpressionUUID->"f8b65d43-6d66-48d3-af23-ebb851dbcef2",
   CellTags->{"All", "HNL"}],
  Cell[726320, 18284, 635, 14, 33, "Input",ExpressionUUID->"bad4ddac-67cc-4922-bab4-33fcc98f4b5f",
   CellTags->{"All", "HNL"}],
  Cell[726992, 18303, 288, 5, 66, "Section",ExpressionUUID->"246606c9-e825-4a9b-86a0-2b61184a5aa1",
   CellTags->{"All", "HNL"}],
  Cell[727283, 18310, 682, 14, 33, "Input",ExpressionUUID->"5a3395e6-b65d-4219-ab18-8f1212a83888",
   CellTags->{"All", "HNL"}]},
 "DP"->{
  Cell[728014, 18330, 235, 4, 51, "Chapter",ExpressionUUID->"b006c7e4-9235-48b6-acf0-5f68ba37a4de",
   CellTags->{"DP", "All"}],
  Cell[728252, 18336, 751, 15, 33, "Input",ExpressionUUID->"54fe7186-2a6f-49bd-80fa-20f726215da5",
   CellTags->{"DP", "All"}]},
 "ALP-fermion"->{
  Cell[729040, 18356, 246, 5, 51, "Chapter",ExpressionUUID->"f895a2e3-dd51-4275-9ad6-cb8a2d25bea8",
   CellTags->{"All", "ALP-fermion"}],
  Cell[729289, 18363, 642, 14, 30, "Input",ExpressionUUID->"b728d505-2207-4e5e-841c-de8a87a4bb1d",
   CellTags->{"All", "ALP-fermion"}]},
 "ALP-gluon"->{
  Cell[729968, 18382, 242, 4, 58, "Chapter",ExpressionUUID->"bf90cb15-6490-441b-8316-f0b08b88a5dd",
   CellTags->{"All", "ALP-gluon"}],
  Cell[730213, 18388, 822, 16, 44, "Input",ExpressionUUID->"1e460815-2625-4c6f-903c-38d9c89aa22a",
   CellTags->{"All", "ALP-gluon"}]},
 "ALP-photon"->{
  Cell[731072, 18409, 242, 4, 51, "Chapter",ExpressionUUID->"fe998291-7eb5-44c3-9a88-45a1e678e2ad",
   CellTags->{"All", "ALP-photon"}],
  Cell[731317, 18415, 562, 13, 44, "Input",ExpressionUUID->"86f38a14-6add-444a-8c8e-934849c5f2c9",
   CellTags->{"All", "ALP-photon"}]},
 "B-L"->{
  Cell[731916, 18433, 290, 5, 51, "Chapter",ExpressionUUID->"1c928aac-e1bd-444d-8f5d-bb01858a0b9e",
   CellTags->{"All", "B-L"}],
  Cell[732209, 18440, 680, 14, 44, "Input",ExpressionUUID->"4587e325-7527-4ae4-8b5d-9c0f2f5bacae",
   CellTags->{"All", "B-L"}]},
 "B-3Lmu"->{
  Cell[732926, 18459, 534, 13, 52, "Chapter",ExpressionUUID->"f910c5d8-2d47-4ef3-b74e-1ffcff1ac1c6",
   CellTags->{"All", "B-3Lmu"}],
  Cell[733463, 18474, 708, 15, 33, "Input",ExpressionUUID->"026e067e-b766-4284-bb3d-1bd2aabaebc1",
   CellTags->{"All", "B-3Lmu"}]},
 "B-3Le-Lmu+Ltau"->{
  Cell[734208, 18494, 619, 16, 52, "Chapter",ExpressionUUID->"01563783-279f-4977-a8a4-cff0a0e598d5",
   CellTags->{"All", "B-3Le-Lmu+Ltau"}],
  Cell[734830, 18512, 724, 15, 33, "Input",ExpressionUUID->"cab98ae5-0681-448c-a04c-d81238c69ee5",
   CellTags->{"All", "B-3Le-Lmu+Ltau"}]},
 "B-Le-3Lmu+Ltau"->{
  Cell[735591, 18532, 619, 16, 52, "Chapter",ExpressionUUID->"80184ca5-803c-4432-8e71-e11c163bb2dc",
   CellTags->{"All", "B-Le-3Lmu+Ltau"}],
  Cell[736213, 18550, 726, 15, 30, "Input",ExpressionUUID->"70ae1e98-041d-4edf-a42c-9edd436a9af1",
   CellTags->{"All", "B-Le-3Lmu+Ltau"}]},
 "Technical"->{
  Cell[736988, 18571, 275, 3, 60, "Title",ExpressionUUID->"2e1061a5-786b-43f9-8573-302890477347",
   CellTags->"Technical"],
  Cell[737266, 18576, 3107, 75, 190, "Input",ExpressionUUID->"4ac1ea3e-6216-4062-aa73-e95dd16ba21a",
   CellTags->"Technical"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Evaluation", 740837, 18668},
 {"Re-evaluation", 762724, 19001},
 {"Scalar", 765841, 19044},
 {"All", 766118, 19049},
 {"HNL", 769467, 19100},
 {"DP", 770384, 19115},
 {"ALP-fermion", 770660, 19120},
 {"ALP-gluon", 770952, 19125},
 {"ALP-photon", 771241, 19130},
 {"B-L", 771525, 19135},
 {"B-3Lmu", 771798, 19140},
 {"B-3Le-Lmu+Ltau", 772086, 19145},
 {"B-Le-3Lmu+Ltau", 772390, 19150},
 {"Technical", 772689, 19155}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 207, 3, 68, "Title",ExpressionUUID->"be5b0a69-a859-4e14-9302-15ea02706e41"],
Cell[790, 27, 750, 14, 60, "Input",ExpressionUUID->"91675345-8e36-4745-9302-f9529663728a"]
}, Closed]],
Cell[CellGroupData[{
Cell[1577, 46, 318, 5, 60, "Title",ExpressionUUID->"f0d20480-5665-403d-a88a-e38db6e4fff2",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[1920, 55, 221, 3, 58, "Chapter",ExpressionUUID->"b35f6bf0-7567-479d-b31b-629f7c8b6923",
 CellTags->"Evaluation"],
Cell[2144, 60, 4394, 115, 177, "Input",ExpressionUUID->"cbf2546a-f572-4ac9-8b33-b22abc10dab6",
 CellTags->"Evaluation"]
}, Closed]],
Cell[CellGroupData[{
Cell[6575, 180, 278, 5, 58, "Chapter",ExpressionUUID->"1ff2cef8-8f58-4db0-9a05-69980a5a669e",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[6878, 189, 195, 3, 57, "Section",ExpressionUUID->"9999c1f5-ee8b-445f-9d6d-aeca7091d16b",
 CellTags->"Evaluation"],
Cell[7076, 194, 17265, 352, 370, "Input",ExpressionUUID->"defb41e9-f75c-4e83-a741-84207b36cb89",
 CellTags->"Evaluation"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[24390, 552, 227, 4, 58, "Chapter",ExpressionUUID->"2e6dc84e-7eae-4401-b746-25315d0f950b",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[24642, 560, 186, 3, 57, "Section",ExpressionUUID->"248bcdfc-6a6d-4069-a173-80b1bd55024a",
 CellTags->"Evaluation"],
Cell[24831, 565, 17230, 434, 590, "Input",ExpressionUUID->"a7475b3a-4fa2-4f13-b3e0-208df08d3e19",
 CellTags->"Evaluation"]
}, Closed]],
Cell[CellGroupData[{
Cell[42098, 1004, 196, 3, 81, "Section",ExpressionUUID->"4aafee20-0ca5-4c67-a588-9d66bbadf25c",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[42319, 1011, 503, 13, 68, "Subsection",ExpressionUUID->"7bcaf136-4b89-4e60-8ac5-23f41e11375a",
 CellTags->"Evaluation"],
Cell[42825, 1026, 21528, 588, 610, "Input",ExpressionUUID->"b16454d7-342d-4f95-b605-96d825394282",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[64378, 1618, 192, 3, 59, "Subsubsection",ExpressionUUID->"3cce2902-2ab2-4e73-8344-a98668894cd3",
 CellTags->"Evaluation"],
Cell[64573, 1623, 1978, 55, 280, "Input",ExpressionUUID->"f698d818-b761-470e-abe1-b122f33e56f3",
 CellTags->"Evaluation"]
}, Closed]],
Cell[CellGroupData[{
Cell[66588, 1683, 271, 4, 59, "Subsubsection",ExpressionUUID->"efaf8abf-53d9-4f0b-b43d-12006d8589a2",
 CellTags->"Evaluation"],
Cell[66862, 1689, 3682, 103, 295, "Input",ExpressionUUID->"e501226f-51a1-46c8-ad34-6f00cc1b7a29",
 CellTags->"Evaluation"]
}, Closed]],
Cell[CellGroupData[{
Cell[70581, 1797, 412, 11, 59, "Subsubsection",ExpressionUUID->"016ac244-a4b2-4c0e-94e4-6b9dfe729efb",
 CellTags->"Evaluation"],
Cell[70996, 1810, 11760, 315, 575, "Input",ExpressionUUID->"17029912-dbcc-4c64-877a-10704f81d486",
 CellTags->"Evaluation"]
}, Closed]]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[82829, 2133, 451, 8, 51, "Chapter",ExpressionUUID->"0d1bd182-eac0-447d-ba67-c82fb46e0d37",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[83305, 2145, 183, 3, 57, "Section",ExpressionUUID->"dd16eefb-96fb-4f43-a3b3-11b24ee6c151",
 CellTags->"Evaluation"],
Cell[83491, 2150, 3901, 94, 116, "Input",ExpressionUUID->"9ec27b8b-9043-4a5a-a5d2-70c74445e4e7",
 CellTags->"Evaluation"]
}, Closed]],
Cell[CellGroupData[{
Cell[87429, 2249, 280, 5, 57, "Section",ExpressionUUID->"9e23489f-deb3-4031-b732-56602a865d5c",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[87734, 2258, 308, 6, 47, "Subsection",ExpressionUUID->"eed76010-8733-46c2-9b12-fd21d2af2264",
 CellTags->"Evaluation"],
Cell[88045, 2266, 20755, 544, 771, "Input",ExpressionUUID->"43a18e11-283b-420a-92fc-aff251f5a80c",
 CellTags->"Evaluation"]
}, Closed]],
Cell[108815, 2813, 187, 3, 47, "Subsection",ExpressionUUID->"f9f9144a-e7bf-4b4f-93b4-6ed626e83341",
 CellTags->"Evaluation"]
}, Closed]],
Cell[CellGroupData[{
Cell[109039, 2821, 220, 4, 57, "Section",ExpressionUUID->"41ddb9fd-8c27-452a-8458-7602c6b0d4bf",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[109284, 2829, 284, 6, 47, "Subsection",ExpressionUUID->"997f043b-e20c-4b42-aa24-2862493e38cd",
 CellTags->"Evaluation"],
Cell[109571, 2837, 6207, 157, 295, "Input",ExpressionUUID->"5d4b8158-0d1a-47d1-b423-3c41be7e66aa",
 CellTags->"Evaluation"]
}, Closed]],
Cell[CellGroupData[{
Cell[115815, 2999, 187, 3, 47, "Subsection",ExpressionUUID->"9932a970-60aa-47a4-b3f9-9ecfce9cb1c3",
 CellTags->"Evaluation"],
Cell[116005, 3004, 779, 19, 33, "Input",ExpressionUUID->"1d24b829-a1f5-49ff-8e85-029379d3e58a",
 CellTags->"Evaluation"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[116833, 3029, 198, 4, 57, "Section",ExpressionUUID->"00f3a20e-73db-4965-86fd-fcf10490284e",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[117056, 3037, 311, 6, 47, "Subsection",ExpressionUUID->"5fdec02b-4b00-4b0a-877b-d957108f2457",
 CellTags->"Evaluation"],
Cell[117370, 3045, 380, 10, 30, "Input",ExpressionUUID->"336bc10f-b3d9-40b0-b911-7b972fc0105b",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[117775, 3059, 184, 3, 41, "Subsubsection",ExpressionUUID->"e9418a91-e5ac-47cf-ba8b-5430e173b126",
 CellTags->"Evaluation"],
Cell[117962, 3064, 6794, 181, 308, "Input",ExpressionUUID->"4a18ca05-02fe-49f8-aaa2-13ec7d0cd569",
 CellTags->"Evaluation"]
}, Closed]],
Cell[CellGroupData[{
Cell[124793, 3250, 190, 3, 41, "Subsubsection",ExpressionUUID->"8651dd6c-7b20-43d5-a4df-1b14d9456834",
 CellTags->"Evaluation"],
Cell[124986, 3255, 6607, 178, 308, "Input",ExpressionUUID->"53898b75-321e-4175-9623-05ff4405cf70",
 CellTags->"Evaluation"]
}, Closed]],
Cell[CellGroupData[{
Cell[131630, 3438, 189, 3, 41, "Subsubsection",ExpressionUUID->"eaeed452-3f96-499a-987c-f590d6d211a8",
 CellTags->"Evaluation"],
Cell[131822, 3443, 7096, 185, 308, "Input",ExpressionUUID->"57b30cc8-7707-4b83-9049-3de463d79e9d",
 CellTags->"Evaluation"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[138967, 3634, 186, 3, 47, "Subsection",ExpressionUUID->"e94bdfe6-c3b0-4fd4-a617-4332a0f6a405",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[139178, 3641, 362, 8, 42, "Subsubsection",ExpressionUUID->"50e0c4bd-37c7-4619-83fd-fd0e87cdf809",
 CellTags->"Evaluation"],
Cell[139543, 3651, 6644, 176, 241, "Input",ExpressionUUID->"1bf083cf-0ca6-4620-9c3d-78f01f9b0a75",
 CellTags->"Evaluation"]
}, Closed]],
Cell[CellGroupData[{
Cell[146224, 3832, 708, 16, 40, "Subsubsection",ExpressionUUID->"c3cc3e7f-a5a0-47ef-b19c-cdbeda81c260",
 CellTags->"Evaluation"],
Cell[146935, 3850, 12017, 310, 499, "Input",ExpressionUUID->"05913f27-fde0-42bd-842c-7a0ce4b32ced",
 CellTags->"Evaluation"]
}, Closed]],
Cell[CellGroupData[{
Cell[158989, 4165, 371, 9, 40, "Subsubsection",ExpressionUUID->"d2a994bd-5350-4d79-b690-0a540322322e",
 CellTags->"Evaluation"],
Cell[159363, 4176, 14218, 367, 575, "Input",ExpressionUUID->"3e8f5c91-875c-4cc2-9fac-799e334e4796",
 CellTags->"Evaluation"]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[173642, 4550, 241, 4, 57, "Section",ExpressionUUID->"ea766b8e-6762-49cc-a1b9-274a472815cd",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[173908, 4558, 311, 6, 47, "Subsection",ExpressionUUID->"1aacebd3-7931-4ad0-988a-968a791f6675",
 CellTags->"Evaluation"],
Cell[174222, 4566, 7373, 179, 283, "Input",ExpressionUUID->"f6e36b4a-78e2-4a93-b131-229beee2f190",
 CellTags->"Evaluation"]
}, Closed]],
Cell[CellGroupData[{
Cell[181632, 4750, 196, 3, 47, "Subsection",ExpressionUUID->"a8d77950-e6b3-40bb-8c1e-7a713b7a62fe",
 CellTags->"Evaluation"],
Cell[181831, 4755, 2288, 52, 70, "Input",ExpressionUUID->"15d703f0-9e4f-42aa-9a82-6d76df0055b2",
 CellTags->"Evaluation"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[184168, 4813, 192, 3, 57, "Section",ExpressionUUID->"fe9117b4-795b-46d1-b007-e1256f913147",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[184385, 4820, 311, 6, 47, "Subsection",ExpressionUUID->"22b626f4-2eac-4626-a398-c1e830fc3980",
 CellTags->"Evaluation"],
Cell[184699, 4828, 6426, 155, 270, "Input",ExpressionUUID->"459f62a8-1a49-4970-b885-3c2c821d7e75",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[191150, 4987, 230, 3, 41, "Subsubsection",ExpressionUUID->"fe6e38c6-7109-4245-97d4-d07f1457aa5a",
 CellTags->"Evaluation"],
Cell[191383, 4992, 5116, 134, 283, "Input",ExpressionUUID->"53c4c9a6-438c-4944-9fa9-cdad5017a9d0",
 CellTags->"Evaluation"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[196548, 5132, 196, 3, 47, "Subsection",ExpressionUUID->"054e6167-fe2d-46e7-b18a-d2c0e8b4862d",
 CellTags->"Evaluation"],
Cell[196747, 5137, 2262, 53, 70, "Input",ExpressionUUID->"45927e91-2484-4aa4-ae94-c5dc93a90cc5",
 CellTags->"Evaluation"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[199058, 5196, 235, 4, 57, "Section",ExpressionUUID->"f5888daf-dc6d-4b79-8340-d2eb4d2eef5e",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[199318, 5204, 288, 6, 47, "Subsection",ExpressionUUID->"67e077de-a854-4ed9-bb6e-0f56d558757e",
 CellTags->"Evaluation"],
Cell[199609, 5212, 6425, 171, 321, "Input",ExpressionUUID->"b6a47b0c-812e-4eb8-9fec-6594ccfcbf4b",
 CellTags->"Evaluation"]
}, Closed]],
Cell[CellGroupData[{
Cell[206071, 5388, 198, 3, 68, "Subsection",ExpressionUUID->"d3d1a7f3-957f-45e0-b845-bf4c768d7134",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[206294, 5395, 445, 10, 59, "Subsubsection",ExpressionUUID->"9166f2c9-b344-47cc-b044-43f89b5eada0",
 CellTags->"Evaluation"],
Cell[206742, 5407, 7949, 203, 390, "Input",ExpressionUUID->"15a1cbfa-206b-4f17-9cfd-bef8df901f4d",
 CellTags->"Evaluation"]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[214752, 5617, 527, 13, 50, "Section",ExpressionUUID->"28cb1a40-2b68-4b15-9d83-e0666ac7f19c",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[215304, 5634, 288, 6, 47, "Subsection",ExpressionUUID->"f9bb6349-e588-4163-9585-0d29bc8465e6",
 CellTags->"Evaluation"],
Cell[215595, 5642, 6729, 175, 321, "Input",ExpressionUUID->"0fe4e2f4-7774-4aa1-b1b2-b44abd9e6132",
 CellTags->"Evaluation"]
}, Closed]],
Cell[CellGroupData[{
Cell[222361, 5822, 186, 3, 68, "Subsection",ExpressionUUID->"e3338e34-6461-4f4e-81a2-53e1a8470b12",
 CellTags->"Evaluation"],
Cell[222550, 5827, 1157, 26, 64, "Input",ExpressionUUID->"55816ca9-af9a-4ccf-9f3d-d838b909efbd",
 CellTags->"Evaluation"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[223756, 5859, 658, 16, 50, "Section",ExpressionUUID->"06eb5843-69b2-4415-a4d4-3ec60c36d233",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[224439, 5879, 286, 6, 47, "Subsection",ExpressionUUID->"41d4b3d0-e7c2-4f72-9454-72959a435735",
 CellTags->"Evaluation"],
Cell[224728, 5887, 6612, 172, 321, "Input",ExpressionUUID->"223099e3-ae64-43e7-836e-97de94303b69",
 CellTags->"Evaluation"]
}, Closed]],
Cell[CellGroupData[{
Cell[231377, 6064, 186, 3, 68, "Subsection",ExpressionUUID->"ac48ae3d-943c-4136-91ba-50511572c0ac",
 CellTags->"Evaluation"],
Cell[231566, 6069, 1118, 27, 64, "Input",ExpressionUUID->"c575eadb-a8ad-4d4a-b2e8-619a739765b0",
 CellTags->"Evaluation"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[232733, 6102, 704, 17, 50, "Section",ExpressionUUID->"9f6a6e02-9a25-4aa8-b6f1-d87380e40126",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[233462, 6123, 288, 6, 47, "Subsection",ExpressionUUID->"b7c1f35c-21d3-4197-949b-6cad819cbb9e",
 CellTags->"Evaluation"],
Cell[233753, 6131, 6570, 171, 321, "Input",ExpressionUUID->"1ac9d6ea-33b0-4c81-888c-d344bd52a579",
 CellTags->"Evaluation"]
}, Closed]],
Cell[CellGroupData[{
Cell[240360, 6307, 186, 3, 47, "Subsection",ExpressionUUID->"276a2c97-947c-4da9-97fb-9cae6ccef417",
 CellTags->"Evaluation"],
Cell[240549, 6312, 1117, 27, 46, "Input",ExpressionUUID->"bcb9455b-1c67-4401-ac7a-1ef81d817f1b",
 CellTags->"Evaluation"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[241715, 6345, 191, 3, 57, "Section",ExpressionUUID->"37cd9831-53d8-4b2c-981e-30c88bc5ef3b",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[241931, 6352, 258, 5, 47, "Subsection",ExpressionUUID->"1164b49a-4ab3-444b-b6c7-e6498c0cb8e7",
 CellTags->"Evaluation"],
Cell[242192, 6359, 2589, 65, 137, "Input",ExpressionUUID->"93637fcd-b2a5-45f3-81c4-00c0428b83fa",
 CellTags->"Evaluation"]
}, Closed]],
Cell[244796, 6427, 185, 3, 47, "Subsection",ExpressionUUID->"6ed24e69-aa48-4f5a-91d7-fa281655f0b4",
 CellTags->"Evaluation"]
}, Closed]],
Cell[CellGroupData[{
Cell[245018, 6435, 210, 4, 57, "Section",ExpressionUUID->"9ff1bc08-ec30-4e57-94cb-930d33ed3e9c",
 CellTags->"Evaluation"],
Cell[245231, 6441, 7812, 204, 388, "Input",ExpressionUUID->"90b579f1-0233-4b93-ae6f-5f912193c54e",
 CellTags->"Evaluation"]
}, Closed]],
Cell[CellGroupData[{
Cell[253080, 6650, 191, 3, 57, "Section",ExpressionUUID->"13911d2c-878e-4efb-99cf-9fc58317f0a7",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[253296, 6657, 365, 5, 47, "Subsection",ExpressionUUID->"0e7b00e6-10b3-4b9d-972b-4dff8fb5d317",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[253686, 6666, 190, 3, 41, "Subsubsection",ExpressionUUID->"7b90e0a0-a42a-4bb8-805b-8ca2c07a02d9",
 CellTags->"Evaluation"],
Cell[253879, 6671, 5490, 136, 102, "Input",ExpressionUUID->"78f8477d-c430-40b1-839f-0ce3f2d38eef",
 CellTags->"Evaluation"]
}, Closed]],
Cell[CellGroupData[{
Cell[259406, 6812, 433, 10, 40, "Subsubsection",ExpressionUUID->"5c10c41a-5fb4-4845-a002-49c1f8f8b0c6",
 CellTags->"Evaluation"],
Cell[259842, 6824, 4990, 135, 114, "Input",ExpressionUUID->"d99502b0-5776-4e98-bdd4-d144c1ff2a82",
 CellTags->"Evaluation"]
}, Closed]],
Cell[CellGroupData[{
Cell[264869, 6964, 534, 10, 40, "Subsubsection",ExpressionUUID->"261f66b9-4bd4-428a-8e24-61f625a4fc0f",
 CellTags->"Evaluation"],
Cell[265406, 6976, 8474, 219, 166, "Input",ExpressionUUID->"29d6e60d-3d82-455c-b45f-10d08c5e84d5",
 CellTags->"Evaluation"]
}, Closed]],
Cell[CellGroupData[{
Cell[273917, 7200, 412, 10, 40, "Subsubsection",ExpressionUUID->"dfed6dc9-54e9-482c-91f1-56aeacd12223",
 CellTags->"Evaluation"],
Cell[274332, 7212, 4922, 124, 98, "Input",ExpressionUUID->"a325ae9e-495b-417d-a8aa-3e0c89f50f33",
 CellTags->"Evaluation"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[279303, 7342, 190, 3, 47, "Subsection",ExpressionUUID->"fdea899d-b657-4b1b-a48b-c05bbbaddca5",
 CellTags->"Evaluation"],
Cell[279496, 7347, 3330, 89, 83, "Input",ExpressionUUID->"17dcbf02-6f8d-4a7c-afff-a857c096b0f9",
 CellTags->"Evaluation"]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[282887, 7443, 341, 7, 58, "Chapter",ExpressionUUID->"cd02dbae-e64d-4e38-9189-47d7c3a03e99",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[283253, 7454, 375, 5, 81, "Section",ExpressionUUID->"b2d5f626-56ad-4f1d-b77b-14d03938e14e",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[283653, 7463, 439, 8, 68, "Subsection",ExpressionUUID->"cc1c5e0c-1ece-4ae5-80f2-f9816b9a0646",
 CellTags->"Evaluation"],
Cell[284095, 7473, 12966, 290, 522, "Input",ExpressionUUID->"ea334552-f4d8-4460-ac10-2a74a6ed435f",
 CellTags->"Evaluation"]
}, Closed]],
Cell[CellGroupData[{
Cell[297098, 7768, 437, 8, 68, "Subsection",ExpressionUUID->"987b9a31-b010-49bd-9a41-747900bfb951",
 CellTags->"Evaluation"],
Cell[297538, 7778, 33206, 745, 1287, "Input",ExpressionUUID->"73ebc8cc-0c82-42c9-97ae-0a5372c43ef4",
 CellTags->"Evaluation"]
}, Closed]],
Cell[CellGroupData[{
Cell[330781, 8528, 346, 7, 47, "Subsection",ExpressionUUID->"6ec09f6e-f174-4208-b470-19e7eb773eca",
 CellTags->"Evaluation"],
Cell[331130, 8537, 11228, 241, 470, "Input",ExpressionUUID->"cae8fe6a-4f13-485a-8a32-1e66445fa00d",
 CellTags->"Evaluation"]
}, Closed]],
Cell[CellGroupData[{
Cell[342395, 8783, 441, 8, 47, "Subsection",ExpressionUUID->"ccd71674-982a-4dce-b477-7b3be574a83b",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[342861, 8795, 240, 4, 41, "Subsubsection",ExpressionUUID->"c80d0832-b4c4-4436-8443-880f50b08cb7",
 CellTags->"Evaluation"],
Cell[343104, 8801, 17731, 432, 831, "Input",ExpressionUUID->"d0b3ce53-04c8-4ffd-ba51-534597a958ca",
 CellTags->"Evaluation"]
}, Closed]],
Cell[CellGroupData[{
Cell[360872, 9238, 260, 4, 41, "Subsubsection",ExpressionUUID->"f1346d6a-8d30-4a82-b412-0b558a2cb0f5",
 CellTags->"Evaluation"],
Cell[361135, 9244, 8666, 208, 288, "Input",ExpressionUUID->"0c3f67ee-8861-4425-8b36-f6be673a16f5",
 CellTags->"Evaluation"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[369850, 9458, 313, 7, 47, "Subsection",ExpressionUUID->"767de7a6-fe87-42e9-aac1-27c33f88badb",
 CellTags->"Evaluation"],
Cell[370166, 9467, 9293, 218, 486, "Input",ExpressionUUID->"bf53e5ee-6d16-4c02-ac99-4a87fde0b0b1",
 CellTags->"Evaluation"],
Cell[379462, 9687, 179, 3, 21, "Input",ExpressionUUID->"550d49f1-0a99-4018-a419-0d4800eda25b"],
Cell[CellGroupData[{
Cell[379666, 9694, 187, 3, 41, "Subsubsection",ExpressionUUID->"30824934-976f-4630-812a-81efbb81d158",
 CellTags->"Evaluation"],
Cell[379856, 9699, 20964, 438, 847, "Input",ExpressionUUID->"bcfeaf0d-fb4d-43f5-b592-deff52e89a57",
 CellTags->"Evaluation"]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[400881, 10144, 412, 7, 57, "Section",ExpressionUUID->"814d7fb1-92f2-48b0-8a43-c1cc7700a07e",
 CellTags->"Evaluation"],
Cell[401296, 10153, 13033, 343, 350, "Input",ExpressionUUID->"bcaf1bfd-2d1a-48e4-a12d-d60d4ae88bf8",
 CellTags->"Evaluation"]
}, Closed]],
Cell[CellGroupData[{
Cell[414366, 10501, 203, 4, 47, "Section",ExpressionUUID->"e8837524-4ca5-4360-824e-de6b194116aa"],
Cell[CellGroupData[{
Cell[414594, 10509, 294, 6, 81, "Subsection",ExpressionUUID->"2af514f8-1732-4afc-8c66-81ce161893f8"],
Cell[414891, 10517, 9627, 251, 765, "Input",ExpressionUUID->"0ab4eec2-4623-4a8f-a973-5af265b84315"]
}, Closed]],
Cell[CellGroupData[{
Cell[424555, 10773, 277, 4, 54, "Subsection",ExpressionUUID->"aa1bcfc7-a5b2-4039-9454-cdbe3e913053"],
Cell[CellGroupData[{
Cell[424857, 10781, 264, 5, 45, "Subsubsection",ExpressionUUID->"61882765-010a-481c-b0ed-98c76793df40"],
Cell[425124, 10788, 9602, 253, 620, "Input",ExpressionUUID->"e9575ec7-8957-46f5-9392-94ae279455de"]
}, Closed]],
Cell[CellGroupData[{
Cell[434763, 11046, 176, 3, 45, "Subsubsection",ExpressionUUID->"53e815d1-a87d-4529-917e-ce06f846a8ea"],
Cell[434942, 11051, 2094, 60, 193, "Input",ExpressionUUID->"857770ca-39c4-40ac-af30-144c75b2b570"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[437085, 11117, 283, 6, 54, "Subsection",ExpressionUUID->"59e65861-a4a8-4123-af37-f2e3aa7b7a3a"],
Cell[437371, 11125, 8835, 221, 480, "Input",ExpressionUUID->"c1ef5ae9-c29d-4c5c-8ae0-6374e0d3a742"]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[446267, 11353, 374, 5, 58, "Chapter",ExpressionUUID->"04c1ab10-71a6-497f-94ce-68390b638778",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[446666, 11362, 318, 6, 57, "Section",ExpressionUUID->"05e94672-f6cd-434c-82a8-365c8d09f18c",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[447009, 11372, 187, 3, 47, "Subsection",ExpressionUUID->"b27dc8ee-5ddc-403b-8779-db96163f2852",
 CellTags->"Evaluation"],
Cell[447199, 11377, 16064, 412, 511, "Input",ExpressionUUID->"58e9f572-dc35-4942-bb43-9c3b49b5b857",
 CellTags->"Evaluation"]
}, Closed]],
Cell[CellGroupData[{
Cell[463300, 11794, 291, 5, 47, "Subsection",ExpressionUUID->"2809492e-2ac2-45a8-a0c5-517a501d1b21",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[463616, 11803, 179, 3, 41, "Subsubsection",ExpressionUUID->"25f5817b-5cf0-47ee-8730-697f19e5a5a1",
 CellTags->"Evaluation"],
Cell[463798, 11808, 22312, 608, 889, "Input",ExpressionUUID->"aa90ff4c-871d-4f14-8c66-44f88731bc27",
 CellTags->"Evaluation"]
}, Closed]],
Cell[CellGroupData[{
Cell[486147, 12421, 192, 3, 41, "Subsubsection",ExpressionUUID->"3a8153bf-f8ea-4dec-b27c-1941df4d3446",
 CellTags->"Evaluation"],
Cell[486342, 12426, 13639, 362, 531, "Input",ExpressionUUID->"4d6d84cc-6468-4846-bf31-c6438c6fd6ef",
 CellTags->"Evaluation"]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[500042, 12795, 176, 3, 57, "Section",ExpressionUUID->"ae5880a5-2d5f-4e45-976c-b85057eda045",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[500243, 12802, 200, 3, 47, "Subsection",ExpressionUUID->"1fb49388-bed7-4e96-8dd9-01762efe4772",
 CellTags->"Evaluation"],
Cell[500446, 12807, 6039, 151, 284, "Input",ExpressionUUID->"a79320cd-0d99-43fb-808f-7ae5821314a3",
 CellTags->"Evaluation"]
}, Closed]],
Cell[CellGroupData[{
Cell[506522, 12963, 199, 3, 47, "Subsection",ExpressionUUID->"ddf1802a-9d74-44ec-8027-ff68a7e281ad",
 CellTags->"Evaluation"],
Cell[506724, 12968, 2657, 69, 153, "Input",ExpressionUUID->"4f88dadc-62a7-4c7e-b264-2a24eba51db8",
 CellTags->"Evaluation"]
}, Closed]],
Cell[CellGroupData[{
Cell[509418, 13042, 555, 12, 66, "Subsection",ExpressionUUID->"049a2a4d-92fb-4feb-adfe-14f536d3c212",
 CellTags->"Evaluation"],
Cell[509976, 13056, 16539, 391, 464, "Input",ExpressionUUID->"0550c48c-e450-4ace-bc02-f0ffdaf95418",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[526540, 13451, 190, 3, 41, "Subsubsection",ExpressionUUID->"67acb5b1-0310-4ea2-9d6c-320976f9c01d",
 CellTags->"Evaluation"],
Cell[526733, 13456, 7000, 154, 187, "Input",ExpressionUUID->"43dae102-92b1-4ee4-9d18-a8aef4fd7010",
 CellTags->"Evaluation"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[533782, 13616, 187, 3, 47, "Subsection",ExpressionUUID->"057fa2fe-e48a-4f24-b9cc-3fb1e545193a",
 CellTags->"Evaluation"],
Cell[533972, 13621, 11860, 303, 725, "Input",ExpressionUUID->"e7b14f0b-6354-4c9b-8550-57165daae3a4",
 CellTags->"Evaluation"]
}, Closed]],
Cell[CellGroupData[{
Cell[545869, 13929, 202, 3, 47, "Subsection",ExpressionUUID->"dbf823ef-a081-4f4f-aff6-fc1892c23782",
 CellTags->"Evaluation"],
Cell[546074, 13934, 17230, 404, 634, "Input",ExpressionUUID->"ea795165-d9bf-45bf-9479-cded8e0281dd",
 CellTags->"Evaluation"],
Cell[563307, 14340, 11711, 292, 327, "Input",ExpressionUUID->"98cabff5-a6e9-4a6b-81ce-94345c2cf410"]
}, Closed]],
Cell[CellGroupData[{
Cell[575055, 14637, 208, 3, 47, "Subsection",ExpressionUUID->"22bfd06d-d1da-435d-af12-6d2c5b7dbaf5",
 CellTags->"Evaluation"],
Cell[575266, 14642, 11738, 294, 484, "Input",ExpressionUUID->"aa654507-7d74-4953-9e3d-e34911a51922",
 CellTags->"Evaluation"]
}, Closed]],
Cell[CellGroupData[{
Cell[587041, 14941, 200, 3, 47, "Subsection",ExpressionUUID->"ca72417d-b6ee-4d74-9da9-0591ae8c77a0",
 CellTags->"Evaluation"],
Cell[587244, 14946, 15231, 411, 696, "Input",ExpressionUUID->"09e401fa-b97a-49df-9839-a035ce54d3dc",
 CellTags->"Evaluation"]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[602536, 15364, 379, 6, 58, "Chapter",ExpressionUUID->"39f5d476-0447-46a9-bd00-1cdb56a7b006",
 CellTags->{"Evaluation", "Re-evaluation"}],
Cell[602918, 15372, 36226, 773, 952, "Input",ExpressionUUID->"222b649c-d0d0-4e4e-90ac-20f5b01506c5",
 CellTags->{"Evaluation", "Re-evaluation"}],
Cell[639147, 16147, 931, 21, 43, "Input",ExpressionUUID->"21b5be0d-8608-4a68-9966-97f8bc3357d7",
 CellTags->{"Evaluation", "Re-evaluation"}],
Cell[CellGroupData[{
Cell[640103, 16172, 233, 5, 57, "Section",ExpressionUUID->"dbbace72-7cb7-41ad-91b5-df16cb2ce6bf",
 CellTags->{"Evaluation", "Re-evaluation"}],
Cell[CellGroupData[{
Cell[640361, 16181, 224, 4, 47, "Subsection",ExpressionUUID->"dc453ba5-d8f2-4400-a0e8-3d01db899a22",
 CellTags->{"Evaluation", "Re-evaluation"}],
Cell[640588, 16187, 15573, 361, 723, "Input",ExpressionUUID->"1f57ba00-dab2-4e11-9e20-d271c6dfde08",
 CellTags->{"Evaluation", "Re-evaluation"}]
}, Closed]],
Cell[CellGroupData[{
Cell[656198, 16553, 223, 4, 47, "Subsection",ExpressionUUID->"086c760b-5c04-4092-95c6-5d5fa2b92a12",
 CellTags->{"Evaluation", "Re-evaluation"}],
Cell[656424, 16559, 13093, 331, 335, "Input",ExpressionUUID->"215cf060-2dca-482b-8771-8e0ac5bce801",
 CellTags->{"Evaluation", "Re-evaluation"}]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[669566, 16896, 223, 4, 57, "Section",ExpressionUUID->"3d33661f-1bcd-4438-8890-08599e47b3f3",
 CellTags->{"Evaluation", "Re-evaluation"}],
Cell[669792, 16902, 11414, 247, 235, "Input",ExpressionUUID->"c09962ae-6e4a-4d15-bea5-a3e8cda1c0b2",
 CellTags->{"Evaluation", "Re-evaluation"}]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[681267, 17156, 356, 5, 60, "Title",ExpressionUUID->"7ef276aa-6ac2-44b6-8659-f620e946504b",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[681648, 17165, 260, 6, 58, "Chapter",ExpressionUUID->"75496f98-5d16-4d12-8062-af46b66ba6fe",
 CellTags->"Evaluation"],
Cell[681911, 17173, 4017, 108, 159, "Input",ExpressionUUID->"a351b5a7-3968-47b6-9206-0b80d566fd66",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[685953, 17285, 379, 6, 57, "Section",ExpressionUUID->"69890af2-32c0-41ab-b90f-aaf902234c1e",
 CellTags->{"Evaluation", "Re-evaluation"}],
Cell[686335, 17293, 11670, 292, 324, "Input",ExpressionUUID->"0b5b19ea-8b21-416c-951d-2092f610aec4",
 CellTags->{"Evaluation", "Re-evaluation"}]
}, Closed]],
Cell[CellGroupData[{
Cell[698042, 17590, 158, 3, 47, "Section",ExpressionUUID->"61dd62df-bf83-4744-b8b5-810b5c5173a5"],
Cell[698203, 17595, 15161, 355, 629, "Input",ExpressionUUID->"038c1ab8-352c-4f0a-b20f-18632e7b8ff7",
 CellTags->{"Evaluation", "Re-evaluation"}]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[713413, 17956, 514, 8, 58, "Chapter",ExpressionUUID->"da3b7ec0-b669-408d-a6e2-09447629531d",
 CellTags->{"Evaluation", "Re-evaluation"}],
Cell[CellGroupData[{
Cell[713952, 17968, 6747, 161, 256, "Input",ExpressionUUID->"57e9a41d-0896-4230-a4c5-a35b43efa2a2",
 CellTags->{"Evaluation", "Re-evaluation"}],
Cell[CellGroupData[{
Cell[720724, 18133, 409, 9, 27, "Print",ExpressionUUID->"0b0c6f28-15f4-4816-bb8a-bc2762136e45",
 CellTags->{"Evaluation", "Re-evaluation"}],
Cell[721136, 18144, 365, 8, 27, "Print",ExpressionUUID->"e4216446-ae9f-4e72-b238-b37a5c34e8fd",
 CellTags->{"Evaluation", "Re-evaluation"}],
Cell[721504, 18154, 326, 8, 27, "Print",ExpressionUUID->"cd617635-c0c2-4400-b730-ff5999bd38b5",
 CellTags->{"Evaluation", "Re-evaluation"}]
}, Closed]],
Cell[721845, 18165, 545, 11, 33, "Output",ExpressionUUID->"f679aa18-de6e-4bbe-a042-b14510e9ac65",
 CellTags->{"Evaluation", "Re-evaluation"}],
Cell[722393, 18178, 371, 9, 27, "Print",ExpressionUUID->"94b39adf-67a9-4736-bff8-d15778dc8e85",
 CellTags->{"Evaluation", "Re-evaluation"}],
Cell[722767, 18189, 291, 6, 33, "Output",ExpressionUUID->"db4fd183-1dcc-4b68-a93a-a1a213858c96",
 CellTags->{"Evaluation", "Re-evaluation"}]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[723119, 18202, 246, 6, 93, "Title",ExpressionUUID->"b4a43d11-cb45-4248-9b58-fa3cbda961f9"],
Cell[CellGroupData[{
Cell[723390, 18212, 304, 5, 58, "Chapter",ExpressionUUID->"bbaa7b71-c5de-463d-bc5f-bcee80cecd62",
 CellTags->{"Scalar", "All"}],
Cell[723697, 18219, 1039, 19, 30, "Input",ExpressionUUID->"699077d2-5244-4855-8318-7861677ff4d4",
 CellTags->{"Scalar", "All"}]
}, Closed]],
Cell[CellGroupData[{
Cell[724773, 18243, 253, 4, 58, "Chapter",ExpressionUUID->"1c9c1db2-e817-43c7-a1c1-dc058a49f093",
 CellTags->{"All", "HNL"}],
Cell[CellGroupData[{
Cell[725051, 18251, 281, 5, 66, "Section",ExpressionUUID->"1e4fb3e2-de7d-4190-989a-2ba85613b49e",
 CellTags->{"All", "HNL"}],
Cell[725335, 18258, 660, 14, 33, "Input",ExpressionUUID->"3ed8b495-ecc2-4582-9e0d-3e71f7277e93",
 CellTags->{"All", "HNL"}]
}, Closed]],
Cell[CellGroupData[{
Cell[726032, 18277, 285, 5, 66, "Section",ExpressionUUID->"f8b65d43-6d66-48d3-af23-ebb851dbcef2",
 CellTags->{"All", "HNL"}],
Cell[726320, 18284, 635, 14, 33, "Input",ExpressionUUID->"bad4ddac-67cc-4922-bab4-33fcc98f4b5f",
 CellTags->{"All", "HNL"}]
}, Closed]],
Cell[CellGroupData[{
Cell[726992, 18303, 288, 5, 66, "Section",ExpressionUUID->"246606c9-e825-4a9b-86a0-2b61184a5aa1",
 CellTags->{"All", "HNL"}],
Cell[727283, 18310, 682, 14, 33, "Input",ExpressionUUID->"5a3395e6-b65d-4219-ab18-8f1212a83888",
 CellTags->{"All", "HNL"}]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[728014, 18330, 235, 4, 51, "Chapter",ExpressionUUID->"b006c7e4-9235-48b6-acf0-5f68ba37a4de",
 CellTags->{"DP", "All"}],
Cell[728252, 18336, 751, 15, 33, "Input",ExpressionUUID->"54fe7186-2a6f-49bd-80fa-20f726215da5",
 CellTags->{"DP", "All"}]
}, Closed]],
Cell[CellGroupData[{
Cell[729040, 18356, 246, 5, 51, "Chapter",ExpressionUUID->"f895a2e3-dd51-4275-9ad6-cb8a2d25bea8",
 CellTags->{"All", "ALP-fermion"}],
Cell[729289, 18363, 642, 14, 30, "Input",ExpressionUUID->"b728d505-2207-4e5e-841c-de8a87a4bb1d",
 CellTags->{"All", "ALP-fermion"}]
}, Closed]],
Cell[CellGroupData[{
Cell[729968, 18382, 242, 4, 58, "Chapter",ExpressionUUID->"bf90cb15-6490-441b-8316-f0b08b88a5dd",
 CellTags->{"All", "ALP-gluon"}],
Cell[730213, 18388, 822, 16, 44, "Input",ExpressionUUID->"1e460815-2625-4c6f-903c-38d9c89aa22a",
 CellTags->{"All", "ALP-gluon"}]
}, Closed]],
Cell[CellGroupData[{
Cell[731072, 18409, 242, 4, 51, "Chapter",ExpressionUUID->"fe998291-7eb5-44c3-9a88-45a1e678e2ad",
 CellTags->{"All", "ALP-photon"}],
Cell[731317, 18415, 562, 13, 44, "Input",ExpressionUUID->"86f38a14-6add-444a-8c8e-934849c5f2c9",
 CellTags->{"All", "ALP-photon"}]
}, Closed]],
Cell[CellGroupData[{
Cell[731916, 18433, 290, 5, 51, "Chapter",ExpressionUUID->"1c928aac-e1bd-444d-8f5d-bb01858a0b9e",
 CellTags->{"All", "B-L"}],
Cell[732209, 18440, 680, 14, 44, "Input",ExpressionUUID->"4587e325-7527-4ae4-8b5d-9c0f2f5bacae",
 CellTags->{"All", "B-L"}]
}, Closed]],
Cell[CellGroupData[{
Cell[732926, 18459, 534, 13, 52, "Chapter",ExpressionUUID->"f910c5d8-2d47-4ef3-b74e-1ffcff1ac1c6",
 CellTags->{"All", "B-3Lmu"}],
Cell[733463, 18474, 708, 15, 33, "Input",ExpressionUUID->"026e067e-b766-4284-bb3d-1bd2aabaebc1",
 CellTags->{"All", "B-3Lmu"}]
}, Closed]],
Cell[CellGroupData[{
Cell[734208, 18494, 619, 16, 52, "Chapter",ExpressionUUID->"01563783-279f-4977-a8a4-cff0a0e598d5",
 CellTags->{"All", "B-3Le-Lmu+Ltau"}],
Cell[734830, 18512, 724, 15, 33, "Input",ExpressionUUID->"cab98ae5-0681-448c-a04c-d81238c69ee5",
 CellTags->{"All", "B-3Le-Lmu+Ltau"}]
}, Closed]],
Cell[CellGroupData[{
Cell[735591, 18532, 619, 16, 52, "Chapter",ExpressionUUID->"80184ca5-803c-4432-8e71-e11c163bb2dc",
 CellTags->{"All", "B-Le-3Lmu+Ltau"}],
Cell[736213, 18550, 726, 15, 30, "Input",ExpressionUUID->"70ae1e98-041d-4edf-a42c-9edd436a9af1",
 CellTags->{"All", "B-Le-3Lmu+Ltau"}]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[736988, 18571, 275, 3, 60, "Title",ExpressionUUID->"2e1061a5-786b-43f9-8573-302890477347",
 CellTags->"Technical"],
Cell[737266, 18576, 3107, 75, 190, "Input",ExpressionUUID->"4ac1ea3e-6216-4062-aa73-e95dd16ba21a",
 CellTags->"Technical"]
}, Closed]]
}
]
*)

