(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    341474,       8284]
NotebookOptionsPosition[    309818,       7713]
NotebookOutlinePosition[    328581,       8020]
CellTagsIndexPosition[    328160,       8003]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Just launch the code below to run the notebook (shift+enter)", "Title",
 CellChangeTimes->{{3.8934376452895875`*^9, 
  3.8934376644509068`*^9}},ExpressionUUID->"be5b0a69-a859-4e14-9302-\
15ea02706e41"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nb", "=", 
   RowBox[{"EvaluationNotebook", "[", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"NotebookFind", "[", 
   RowBox[{"nb", ",", "\"\<Evaluation\>\"", ",", "All", ",", "CellTags"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}], "Input",
 CellChangeTimes->{{3.893437585709897*^9, 3.8934375895369635`*^9}, {
  3.8934376329497385`*^9, 3.893437658846809*^9}, {3.8936903789422555`*^9, 
  3.8936903792002773`*^9}, {3.8938170802646403`*^9, 3.8938170903183107`*^9}, {
  3.894125105994251*^9, 3.89412510682006*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"91675345-8e36-4745-9302-f9529663728a"]
}, Closed]],

Cell[CellGroupData[{

Cell["I. Definitions (launch this section first)", "Title",
 CellChangeTimes->{{3.8850097993899145`*^9, 3.8850098013435984`*^9}, {
  3.8850119060647106`*^9, 3.8850119106997366`*^9}, {3.8877814539576287`*^9, 
  3.8877814542613525`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"f0d20480-5665-403d-a88a-e38db6e4fff2"],

Cell[CellGroupData[{

Cell["Critical definitions required to launch this notebook", "Chapter",
 CellChangeTimes->{{3.893817051441402*^9, 3.893817059390691*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"b35f6bf0-7567-479d-b31b-629f7c8b6923"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"ruleDown", ",", "HoldAll"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ruleDown", "[", "list_", "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"DownValues", "/@", 
    RowBox[{"(", 
     RowBox[{"Unevaluated", "@", "list"}], ")"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"ruleOwn", ",", "HoldAll"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ruleOwn", "[", "list_", "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"OwnValues", "/@", 
    RowBox[{"(", 
     RowBox[{"Unevaluated", "@", "list"}], ")"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"choicesDialog", "[", 
   RowBox[{"LLP_", ",", "spec_List"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", 
      RowBox[{"spec", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"Flatten", "@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "LLP", "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", "=", "i"}], "}"}], ",", 
            RowBox[{"Column", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"TextCell", "[", 
                RowBox[{"spec", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"PopupMenu", "[", 
                RowBox[{
                 RowBox[{"Dynamic", "[", 
                  RowBox[{"choice", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"spec", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}]}], "}"}], 
             "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "@", "spec"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"Button", "[", 
         RowBox[{"\"\<OK\>\"", ",", 
          RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}]}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"infoDialog", "[", "phrase_", "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<Proceed\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"SetOptions", "[", 
  RowBox[{"$FrontEnd", ",", 
   RowBox[{"\"\<DynamicEvaluationTimeout\>\"", "\[Rule]", "300"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"SetSystemOptions", "[", 
  RowBox[{"\"\<SimplificationOptions\>\"", "->", 
   RowBox[{"\"\<AutosimplifyTrigs\>\"", "->", "False"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "FeynCalc`"}]}], "Input",
 CellChangeTimes->{{3.893817065391258*^9, 3.893817082937214*^9}, {
   3.89409198990086*^9, 3.894091990576394*^9}, {3.8967773747044973`*^9, 
   3.8967773782376595`*^9}, {3.9053585308615303`*^9, 
   3.9053585311068344`*^9}, {3.9121597861087885`*^9, 3.912159786487363*^9}, 
   3.9121607306423364`*^9, {3.914093028609653*^9, 3.9140930341165714`*^9}, {
   3.914516499625929*^9, 3.914516499774582*^9}, {3.916889936968649*^9, 
   3.916889936968649*^9}},
 CellTags->"Evaluation",
 CellLabel->"In[5]:=",ExpressionUUID->"cbf2546a-f572-4ac9-8b33-b22abc10dab6"]
}, Closed]],

Cell[CellGroupData[{

Cell["Properties of SM particles", "Chapter",
 CellChangeTimes->{{3.933920094382326*^9, 3.933920097905178*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"78e76b07-b51c-744a-b3d5-a13fd14fbc54"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Properties", " ", "of", " ", "SM", " ", "particles"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Quiet", "[", 
     RowBox[{"NotebookEvaluate", "[", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], ",", 
         "\"\<codes/SensCalc/SM particles.nb\>\""}], "}"}], "]"}], "]"}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
   "Print", "[", "\"\<Full information about decay products:\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "\"\<Product\>\"", "}"}], ",", 
        RowBox[{"{", "\"\<PDG ID\>\"", "}"}], ",", 
        RowBox[{"{", "\"\<Stability\>\"", "}"}], ",", 
        RowBox[{"{", "\"\<Mass\>\"", "}"}], ",", 
        RowBox[{"{", "\"\<Electric charge\>\"", "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ListSMparticlesSymbols", ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"ParamProductToPDGid", "[", "#", "]"}], "&"}], "/@", 
          "ListSMparticlesSymbols"}], "//", "IntegerPart"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"ParamProductStability", "[", "#", "]"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"ParamProductToPDGid", "[", "#", "]"}], "&"}], "/@", 
           "ListSMparticlesSymbols"}], ")"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"ParamProductMass", "[", "#", "]"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"ParamProductToPDGid", "[", "#", "]"}], "&"}], "/@", 
           "ListSMparticlesSymbols"}], ")"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"ParamProductCharge", "[", "#", "]"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"ParamProductToPDGid", "[", "#", "]"}], "&"}], "/@", 
           "ListSMparticlesSymbols"}], ")"}]}]}], "}"}], ",", "2"}], "]"}], "//",
     "TableForm"}], "\[IndentingNewLine]", 
   RowBox[{
   "Print", "[", "\"\<List of recognizable decay products:\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Keys", "[", 
     RowBox[{"DownValues", "@", "ParamProductToPDGid"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
   "Print", "[", "\"\<List of PDG ids that may be detected:\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"detectablepdgs", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1.", ",", 
        RowBox[{"-", "1."}], ",", "2.", ",", 
        RowBox[{"-", "2."}], ",", "3.", ",", 
        RowBox[{"-", "3."}], ",", "4.", ",", 
        RowBox[{"-", "4."}], ",", "5.", ",", 
        RowBox[{"-", "5."}], ",", "21.", ",", 
        RowBox[{"-", "21."}], ",", "22.", ",", "11.", ",", 
        RowBox[{"-", "11."}], ",", "13.", ",", 
        RowBox[{"-", "13."}], ",", "211.", ",", 
        RowBox[{"-", "211."}], ",", "130.", ",", "321.", ",", 
        RowBox[{"-", "321."}], ",", "2112.", ",", 
        RowBox[{"-", "2112."}], ",", "2212.", ",", 
        RowBox[{"-", "2212."}]}], "}"}], "//", "Sort"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"detectablepdgs", "//", "IntegerPart"}]}]}]], "Input",
 CellTags->"Evaluation",
 CellLabel->"In[15]:=",ExpressionUUID->"111fd704-fc2f-f940-a5a2-27f9849c434e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Geometry of different experiments and cross-sections", "Chapter",
 CellChangeTimes->{{3.8850100439445615`*^9, 3.885010048655702*^9}, {
  3.890201607489234*^9, 3.8902016116143937`*^9}, {3.8902020308891773`*^9, 
  3.890202041481434*^9}, {3.8934857025223536`*^9, 3.8934857070537953`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"04c1ab10-71a6-497f-94ce-68390b638778"],

Cell[CellGroupData[{

Cell["\<\
Parameters of implemented experiments: geometry and cross-sections\
\>", "Section",
 CellChangeTimes->{{3.893235933860486*^9, 3.893235936872877*^9}, {
   3.8933436723508244`*^9, 3.893343682407154*^9}, 3.8934861141232157`*^9},
 CellTags->
  "Evaluation",ExpressionUUID->"05e94672-f6cd-434c-82a8-365c8d09f18c"],

Cell[CellGroupData[{

Cell["Some expressions", "Subsection",
 CellChangeTimes->{{3.893236359435601*^9, 3.893236361107131*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"b27dc8ee-5ddc-403b-8779-db96163f2852"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"theta", "[", "\[Eta]_", "]"}], "=", 
   RowBox[{"2", "*", 
    RowBox[{"ArcTan", "[", 
     RowBox[{"Exp", "[", 
      RowBox[{"-", "\[Eta]"}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Sigma]ppInpbFacility", ":=", 
  RowBox[{"Association", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", " ", 
      RowBox[{"40.", "*", 
       SuperscriptBox["10", "9"]}]}], ",", " ", 
     RowBox[{"\"\<SPS\>\"", "\[Rule]", 
      RowBox[{"40.", "*", 
       SuperscriptBox["10", "9"]}]}], ",", 
     RowBox[{"\"\<LHC\>\"", "\[Rule]", " ", 
      RowBox[{"72.", "*", 
       SuperscriptBox["10", "9"]}]}], ",", 
     RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", 
      RowBox[{"104.", "*", 
       SuperscriptBox["10", "9"]}]}], ",", 
     RowBox[{"\"\<Serpukhov\>\"", "->", 
      RowBox[{"40.", "*", 
       SuperscriptBox["10", "9"]}]}], ",", 
     RowBox[{"\"\<ESS\>\"", "->", 
      RowBox[{"45.", "*", 
       SuperscriptBox["10", "9"]}]}]}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LLHChighLumi", "=", 
   RowBox[{"3000", "*", 
    SuperscriptBox["10", "3"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LFCChh", "=", 
    RowBox[{"20000", "*", 
     SuperscriptBox["10", "3"]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Cross", "-", 
     RowBox[{"sections", " ", "in", " ", "pb", " ", "of", " ", "b", 
      OverscriptBox["b", "_"], " ", 
      RowBox[{"production", ".", " ", "For"}], " ", 
      RowBox[{"Fermilab", "/", "FCC"}]}], "-", 
     RowBox[{"hh", " ", "taken", " ", "from", " ", "pythia"}]}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"for", " ", "SPS", " ", "taken", " ", "from", " ", 
       RowBox[{"http", ":"}]}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"cds", ".", "cern", ".", "ch"}], "/", "record"}], "/", 
          "2115534"}], "/", "files"}], "/", "SHiP"}], "-", "NOTE", "-", 
       "2015", "-", 
       RowBox[{"009.", 
        RowBox[{"pdf", "?", "version"}]}]}]}], "=", "1"}], ",", " ", 
    RowBox[{
    "for", " ", "LHC", " ", "taken", " ", "from", " ", "FONLL", " ", "at", 
     " ", "the", " ", "upper", " ", "bound", " ", "of", " ", 
     "uncertainty"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]ppTobbInpbFacility", ":=", 
   RowBox[{"Association", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", "3.8"}], ",", 
      RowBox[{"\"\<SPS\>\"", "\[Rule]", 
       RowBox[{"1.7", "*", 
        SuperscriptBox["10", "3"]}]}], ",", 
      RowBox[{"\"\<LHC\>\"", "\[Rule]", 
       RowBox[{"6.2", "*", 
        SuperscriptBox["10", "8"]}]}], ",", 
      RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", 
       RowBox[{"3.4", "*", 
        SuperscriptBox["10", "9"]}]}], ",", 
      RowBox[{"\"\<Serpukhov\>\"", "->", "0."}], ",", 
      RowBox[{"\"\<ESS\>\"", "->", "0."}]}], "}"}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Cross", "-", 
     RowBox[{"sections", " ", "in", " ", "pb", " ", "of", " ", "c", 
      OverscriptBox["c", "_"], " ", 
      RowBox[{"production", ".", " ", "For"}], " ", 
      RowBox[{"Fermilab", "/", "FCC"}]}], "-", 
     RowBox[{"hh", " ", "taken", " ", "from", " ", "pythia"}]}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"for", " ", "SPS", " ", "taken", " ", "from", " ", 
       RowBox[{"http", ":"}]}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"cds", ".", "cern", ".", "ch"}], "/", "record"}], "/", 
          "2115534"}], "/", "files"}], "/", "SHiP"}], "-", "NOTE", "-", 
       "2015", "-", 
       RowBox[{"009.", 
        RowBox[{"pdf", "?", "version"}]}]}]}], "=", "1"}], ",", " ", 
    RowBox[{
    "for", " ", "LHC", " ", "taken", " ", "from", " ", "FONLL", " ", "at", 
     " ", "the", " ", "upper", " ", "bound", " ", "of", " ", 
     "uncertainty"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]ppToccInpbFacility", ":=", 
   RowBox[{"Association", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", 
       RowBox[{"0.5", "*", 
        SuperscriptBox["10", "6"]}]}], ",", 
      RowBox[{"\"\<SPS\>\"", "\[Rule]", 
       RowBox[{"1.8", "*", 
        SuperscriptBox["10", "7"]}]}], ",", 
      RowBox[{"\"\<LHC\>\"", "\[Rule]", 
       RowBox[{"1.8", "*", 
        SuperscriptBox["10", "10"]}]}], ",", 
      RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", 
       RowBox[{"4", "*", 
        SuperscriptBox["10", "10"]}]}], ",", 
      RowBox[{"\"\<Serpukhov\>\"", "->", "0."}], ",", 
      RowBox[{"\"\<ESS\>\"", "->", "0."}]}], "}"}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Data", " ", "for", " ", "Higgs", " ", 
     RowBox[{"production", ".", " ", "For"}], " ", "LHC"}], ",", " ", 
    RowBox[{
     RowBox[{"used", " ", 
      RowBox[{"https", ":"}]}], "//", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"twiki", ".", "cern", ".", "ch"}], "/", "twiki"}], "/", 
           "bin"}], "/", "view"}], "/", "LHCPhysics"}], "/", 
        RowBox[{"HiggsEuropeanStrategy", ".", " ", "For"}]}], " ", "FCC"}], 
      "-", "hh"}]}], ",", " ", 
    RowBox[{"pythia8", " ", "is", " ", "used"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]ppTohInpbFacility", ":=", 
   RowBox[{"Association", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", " ", "0."}], ",", 
      RowBox[{"\"\<SPS\>\"", "\[Rule]", "0."}], ",", 
      RowBox[{"\"\<LHC\>\"", "\[Rule]", "55"}], ",", 
      RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", "552."}], ",", 
      RowBox[{"\"\<Serpukhov\>\"", "->", "0."}], ",", 
      RowBox[{"\"\<ESS\>\"", "->", "0."}]}], "}"}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Data", " ", "for", " ", "the", " ", "production", " ", "of", " ", "light",
     " ", 
    RowBox[{"mesons", ".", " ", "P"}], " ", "means", " ", "the", " ", 
    "fraction", " ", "per", " ", "collision"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"For", " ", "SPS"}], ",", " ", 
    RowBox[{
     RowBox[{
     "the", " ", "multiplicities", " ", "are", " ", "taken", " ", "from", " ", 
      RowBox[{"https", ":"}]}], "//", 
     RowBox[{"lib", "-", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"extopc", ".", "kek", ".", "jp"}], "/", "preprints"}], 
           "/", "PDF"}], "/", "1991"}], "/", "9103"}], "/", "9103008."}], 
       "pdf"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"For", " ", "Fermilab"}], ",", " ", 
    RowBox[{
     RowBox[{
     "obtained", " ", "using", " ", "the", " ", "approach", " ", "from", " ", 
      RowBox[{"https", ":"}]}], "//", 
     RowBox[{
      RowBox[{
       RowBox[{"arxiv", ".", "org"}], "/", "pdf"}], "/", 
      RowBox[{"2201.05170", ".", "pdf"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"For", " ", "Serpukhov", " ", 
     RowBox[{"(", "NuCal", ")"}]}], ",", " ", 
    RowBox[{
    "the", " ", "pythia8", " ", "simulation", " ", "is", " ", "used"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"For", " ", 
     RowBox[{"LHC", "/", "FCC"}]}], "-", 
    RowBox[{"hh", " ", "used", " ", "EPOS"}], "-", "LHC"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"PppTo\[Pi]0Facility", ":=", 
  RowBox[{"Association", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", "2.9"}], ",", 
     RowBox[{"\"\<SPS\>\"", "\[Rule]", "6.2"}], ",", 
     RowBox[{"\"\<LHC\>\"", "\[Rule]", "42.8"}], ",", 
     RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", "73.8"}], ",", 
     RowBox[{"\"\<Serpukhov\>\"", "->", "2.37"}], ",", 
     RowBox[{"\"\<ESS\>\"", "->", "1."}]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"PppTo\[Eta]Facility", ":=", 
  RowBox[{"Association", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", "0.32"}], ",", 
     RowBox[{"\"\<SPS\>\"", "\[Rule]", "0.8"}], ",", 
     RowBox[{"\"\<LHC\>\"", "\[Rule]", "4.7"}], ",", 
     RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", "8.3"}], ",", 
     RowBox[{"\"\<Serpukhov\>\"", "->", "0.211"}], ",", 
     RowBox[{"\"\<ESS\>\"", "->", "0."}]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"PppTo\[Eta]prFacility", ":=", 
  RowBox[{"Association", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", "0.033"}], ",", 
     RowBox[{"\"\<SPS\>\"", "\[Rule]", "0.079"}], ",", 
     RowBox[{"\"\<LHC\>\"", "\[Rule]", "0.5"}], ",", 
     RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", "1.1"}], ",", 
     RowBox[{"\"\<Serpukhov\>\"", "->", "0.027"}], ",", 
     RowBox[{"\"\<ESS\>\"", "->", "0."}]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"PppTo\[Rho]0Facility", ":=", 
  RowBox[{"Association", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", "0.36"}], ",", 
     RowBox[{"\"\<SPS\>\"", "\[Rule]", "0.548"}], ",", 
     RowBox[{"\"\<LHC\>\"", "\[Rule]", "5.16"}], ",", 
     RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", "8.26"}], ",", 
     RowBox[{"\"\<Serpukhov\>\"", "->", "0.294"}], ",", 
     RowBox[{"\"\<ESS\>\"", "->", "0."}]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PppTo\[Omega]Facility", ":=", 
   RowBox[{"Association", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", "0.36"}], ",", 
      RowBox[{"\"\<SPS\>\"", "\[Rule]", "0.548"}], ",", 
      RowBox[{"\"\<LHC\>\"", "\[Rule]", "4.83"}], ",", 
      RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", "7.75"}], ",", 
      RowBox[{"\"\<Serpukhov\>\"", "->", "0.2983"}], ",", 
      RowBox[{"\"\<ESS\>\"", "->", "0."}]}], "}"}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Production", " ", "probability", " ", "of", " ", "charged", " ", "\[Pi]",
      " ", "and", " ", 
     RowBox[{"\[Mu]", ".", " ", "Currently"}]}], ",", " ", 
    RowBox[{"used", " ", "only", " ", "for", " ", "ESS"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"PppTo\[Pi]chargedFacility", ":=", 
  RowBox[{"Association", "[", 
   RowBox[{"{", 
    RowBox[{"\"\<ESS\>\"", "->", "0.3"}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PppTo\[Mu]Facility", ":=", 
   RowBox[{"Association", "[", 
    RowBox[{"{", 
     RowBox[{"\"\<ESS\>\"", "->", "0.3"}], "}"}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"For", " ", 
     RowBox[{"J", "/", "\[Psi]"}], " ", "and", " ", "\[CapitalUpsilon]"}], 
    ",", " ", 
    RowBox[{
     RowBox[{"the", " ", "FCC"}], "-", 
     RowBox[{
     "hh", " ", "data", " ", "is", " ", "to", " ", "be", " ", "updated"}]}]}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"PppToJpsiFacility", ":=", 
  RowBox[{"Association", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", 
      RowBox[{"5.24", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "7"}]]}]}], ",", 
     RowBox[{"\"\<SPS\>\"", "\[Rule]", 
      RowBox[{"3.5", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "6"}]]}]}], ",", 
     RowBox[{"\"\<LHC\>\"", "\[Rule]", "0.001"}], ",", 
     RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", "0."}], ",", 
     RowBox[{"\"\<Serpukhov\>\"", "->", "0."}], ",", 
     RowBox[{"\"\<ESS\>\"", "->", "0."}]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PppToUpsilonFacility", ":=", 
   RowBox[{"Association", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", "0."}], ",", 
      RowBox[{"\"\<SPS\>\"", "\[Rule]", "0."}], ",", 
      RowBox[{"\"\<LHC\>\"", "\[Rule]", 
       RowBox[{"1.35", "*", 
        SuperscriptBox["10", 
         RowBox[{"-", "5"}]]}]}], ",", 
      RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", "0."}], ",", 
      RowBox[{"\"\<Serpukhov\>\"", "->", "0."}], ",", 
      RowBox[{"\"\<ESS\>\"", "->", "0."}]}], "}"}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[Phi]", " ", "multiplicity"}], " ", "-", " ", 
    RowBox[{"per", " ", "p"}], "-", 
    RowBox[{"p", " ", "collision", " ", 
     RowBox[{"(", "currently", ")"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PppToPhiFacility", ":=", 
   RowBox[{"Association", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", "0.0106"}], ",", 
      RowBox[{"\"\<SPS\>\"", "\[Rule]", "0.02"}], ",", 
      RowBox[{"\"\<LHC\>\"", "\[Rule]", "0.53"}], ",", 
      RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", "1.13"}], ",", 
      RowBox[{"\"\<Serpukhov\>\"", "->", 
       RowBox[{"8.4", "*", 
        SuperscriptBox["10", 
         RowBox[{"-", "3"}]]}]}], ",", 
      RowBox[{"\"\<ESS\>\"", "->", "0."}]}], "}"}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Data", " ", "for", " ", "W", " ", "production"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"For", " ", "LHC"}], ",", " ", 
    RowBox[{
     RowBox[{"https", ":"}], "//", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"arxiv", ".", "org"}], "/", "abs"}], "/", "1603.09222"}], 
       " ", "is", " ", 
       RowBox[{"used", ".", " ", "For"}], " ", "FCC"}], "-", "hh"}]}], ",", 
    " ", 
    RowBox[{"pythia8", " ", "is", " ", "used"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]ppToWInpbFacility", ":=", 
   RowBox[{"Association", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", " ", "0."}], ",", 
      RowBox[{"\"\<SPS\>\"", "\[Rule]", "0."}], ",", 
      RowBox[{"\"\<LHC\>\"", "\[Rule]", 
       RowBox[{
        SuperscriptBox["10", "3"], "*", 
        RowBox[{"20.62", "/", "0.107"}]}]}], ",", 
      RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", 
       RowBox[{"1.1", "*", 
        SuperscriptBox["10", "6"]}]}], ",", 
      RowBox[{"\"\<Serpukhov\>\"", "->", "0."}], ",", 
      RowBox[{"\"\<ESS\>\"", "->", "0."}]}], "}"}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Maximal", " ", "energy", " ", "of", " ", "LLP", " ", "available", " ", 
    "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"EmaxFacility", ":=", 
  RowBox[{"Association", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<SPS\>\"", "\[Rule]", "400."}], ",", 
     RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", "120."}], ",", 
     RowBox[{"\"\<LHC\>\"", "\[Rule]", "7000."}], ",", 
     RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", " ", "50000."}], ",", 
     RowBox[{"\"\<Serpukhov\>\"", "->", "70."}], ",", 
     RowBox[{"\"\<ESS\>\"", "->", "2.4"}]}], "}"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.893341579334396*^9, 3.893341579484507*^9}, {
   3.8933416871783133`*^9, 3.8933416875332813`*^9}, {3.8933418570408974`*^9, 
   3.893341864809713*^9}, {3.893341951351513*^9, 3.893342003530114*^9}, {
   3.893342807795866*^9, 3.8933428353573284`*^9}, {3.8935206581145706`*^9, 
   3.893520658160448*^9}, {3.8935208064621077`*^9, 3.8935208064990053`*^9}, {
   3.8941765244743814`*^9, 3.8941765284236374`*^9}, {3.8941766505127816`*^9, 
   3.8941766970839815`*^9}, 3.894176778421816*^9, {3.8941768153541927`*^9, 
   3.8941768169228354`*^9}, {3.894176850102585*^9, 3.894176852083151*^9}, {
   3.89417694975235*^9, 3.8941769776330075`*^9}, {3.8941770953928633`*^9, 
   3.8941770958238077`*^9}, 3.8949868753117933`*^9, {3.8950260748512506`*^9, 
   3.8950260780117044`*^9}, {3.895035184163389*^9, 3.895035191337409*^9}, {
   3.895596130541261*^9, 3.895596132120452*^9}, {3.899198582869968*^9, 
   3.899198583326418*^9}, 3.9038000474551954`*^9, {3.9152631196016855`*^9, 
   3.91526314875865*^9}, 3.9168899403690305`*^9},
 CellTags->"Evaluation",
 CellLabel->"In[23]:=",ExpressionUUID->"58e9f572-dc35-4942-bb43-9c3b49b5b857"]
}, Closed]],

Cell[CellGroupData[{

Cell["ANUBIS-ceiling", "Subsection",
 CellChangeTimes->{{3.8933162189589405`*^9, 3.893316220446392*^9}, {
  3.8964500762376533`*^9, 3.896450087948349*^9}, {3.8964501221805043`*^9, 
  3.8964501306425247`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"2809492e-2ac2-45a8-a0c5-517a501d1b21"],

Cell[CellGroupData[{

Cell["Geometry", "Subsubsection",
 CellChangeTimes->{{3.893342623432827*^9, 3.893342624458*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"25f5817b-5cf0-47ee-8730-697f19e5a5a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Decay", " ", 
      RowBox[{"volume", "/", "detector"}], " ", 
      RowBox[{"descriptions", ":", " ", 
       RowBox[{"following", " ", "http"}], ":"}]}], "//", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"cds", ".", "cern", ".", "ch"}], "/", "record"}], "/", 
         "2839063"}], "/", "files"}], "/", "CERN"}], "-", "THESIS", "-", 
      "2022", "-", 
      RowBox[{"169.", 
       RowBox[{"pdf", "?", "version"}]}]}]}], "=", "1"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Approximations", ":"}], "*)"}], " ", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "1.", " ", "The", " ", "decay", " ", "volume", " ", "is", " ", 
    "approximated", " ", "by", " ", "the", " ", "projective", " ", "volume", 
    " ", "covered", " ", "the", " ", "solid", " ", "angle", " ", "of", " ", 
    "the", " ", "detector", " ", "surface"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"explistanubceil", "=", 
     RowBox[{"{", "\"\<ANUBIS-ceiling\>\"", "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Distance", " ", "to", " ", "the", " ", "fiducial", " ", "volume", " ", 
     "along", " ", "the", " ", "beamline", " ", 
     RowBox[{"axis", ".", " ", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"list1", "[", "#", "]"}], "=", "#2"}], ")"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{"listexp", ",", "listvals"}], "}"}]}], "]"}]}], " ", 
     "equates", " ", "the", " ", "elements", " ", "list1", " ", "with", " ", 
     "keys", " ", "from", " ", "listexp", " ", "to", " ", "the", " ", 
     "corresponding", " ", "elements", " ", "of", " ", "the", " ", "list", 
     " ", "listvals"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"zToDecayVolumeExperiment", "[", "#1", "]"}], "=", "#2"}], 
        ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistanubceil", ",", 
        RowBox[{"{", 
         RowBox[{"-", 
          FractionBox["53", "2."]}], "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Detector", " ", "has", " ", "the", " ", "axis", " ", "along", " ", 
     "which", " ", "its", " ", "components", " ", "are", " ", 
     RowBox[{"placed", ".", " ", "The"}], " ", "option", " ", "below", " ", 
     "defines", " ", "the", " ", "orientation", " ", "of", " ", "the", " ", 
     "final", " ", "plane", " ", "transverse", " ", "to", " ", "this", " ", 
     "axis", " ", "relative", " ", "to", " ", "the", " ", "beamline"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Transverse", " ", "if", " ", "the", " ", "plane", " ", "is", " ", 
      "tranverse", " ", 
      RowBox[{"(", 
       RowBox[{"SHiP", ",", " ", 
        RowBox[{"FACET", " ", "etc"}]}], ")"}]}], ",", " ", 
     RowBox[{
     "and", " ", "Parallel", " ", "if", " ", "it", " ", "is", " ", "parallel",
       " ", 
      RowBox[{"(", 
       RowBox[{"MATHUSLA", ",", " ", "ANUBIS"}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"DetectorPlaneOrientationExperiment", "[", "#1", "]"}], "=", 
         "#2"}], ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistanubceil", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"\"\<Parallel\>\"", ",", 
          RowBox[{"Length", "[", "explistanubceil", "]"}]}], "]"}]}], "}"}]}],
      "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Facility", " ", "hosting", " ", "the", " ", 
      RowBox[{"experiment", ":", " ", "SPS"}]}], ",", " ", "Fermilab", ",", 
     " ", "LHC", ",", " ", 
     RowBox[{"FCC", "-", "hh"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"FacilityExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistanubceil", ",", 
        RowBox[{"{", "\"\<LHC\>\"", "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Geometry", " ", "of", " ", "the", " ", 
      RowBox[{"experiment", ":", " ", "box"}]}], ",", " ", "cylinder", ",", 
     " ", 
     RowBox[{"annular", " ", "cylinder"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"GeometryExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistanubceil", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"\"\<Annular cylinder\>\"", ",", 
          RowBox[{"Length", "[", "explistanubceil", "]"}]}], "]"}]}], "}"}]}],
      "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Transverse", " ", "dimensions", " ", "of", " ", "the", " ", "decay", 
      " ", "volume", " ", "assuming", " ", "box", " ", "geometry"}], ",", " ", 
     RowBox[{
     "or", " ", "cylindrical", " ", "geometry", " ", "if", " ", "the", " ", 
      "detector", " ", "plane", " ", "is", " ", "parallel", " ", "to", " ", 
      "the", " ", "beamline", " ", 
      RowBox[{
       RowBox[{"(", "ANUBIS", ")"}], ".", " ", "Otherwise"}], " ", "set", " ",
       "to", " ", "zero"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dxDecayVolumeExperiment", "[", 
          RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistanubceil", ",", 
        RowBox[{"{", "28.7", "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dyDecayVolumeExperiment", "[", 
          RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistanubceil", ",", 
        RowBox[{"{", "0.", "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Decay", " ", "volume", " ", "length", " ", "along", " ", "the", " ", 
     "beamline", " ", "axis"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dzDecayVolumeExperiment", "[", "#1", "]"}], "=", "#2"}], 
        ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistanubceil", ",", 
        RowBox[{"{", "53.", "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Distance", " ", "from", " ", "the", " ", "beamline", " ", "to", " ", 
      "the", " ", "decay", " ", "volume", " ", "center", " ", "and", " ", 
      "detector", " ", "along", " ", "the", " ", "x"}], ",", 
     RowBox[{"y", " ", "axes"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xToDecayVolumeCenterExperiment", "[", "#1", "]"}], "=", 
         "#2"}], ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistanubceil", ",", 
        RowBox[{"{", "0.", "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"yToDecayVolumeCenterExperiment", "[", "#1", "]"}], "=", 
         "#2"}], ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistanubceil", ",", 
        RowBox[{"{", "0.", "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Inner", " ", "and", " ", "outer", " ", "radii", " ", "of", " ", "the", 
     " ", "decay", " ", 
     RowBox[{"volume", ".", " ", "Applicable"}], " ", "if", " ", "the", " ", 
     "decay", " ", "volume", " ", "has", " ", "cylindrical", " ", 
     "geometry"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"RinnerDecayVolumeExperiment", "[", 
          RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistanubceil", ",", 
        RowBox[{"{", "11.3", "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"RouterDecayVolumeExperiment", "[", 
          RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistanubceil", ",", 
        RowBox[{"{", "19.9", "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"z", "-", 
     RowBox[{
     "coordinate", " ", "of", " ", "the", " ", "center", " ", "of", " ", 
      "the", " ", "decay", " ", "volume"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"zToDecayVolumeCenterExperiment", "[", "exp", "]"}], "=", 
       RowBox[{
        RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], "+", 
        FractionBox[
         RowBox[{"dzDecayVolumeExperiment", "[", "exp", "]"}], "2"]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Maximal", " ", 
     RowBox[{"long", ".", " ", "displacement"}], " ", "of", " ", "the", " ", 
     "decay", " ", "volume"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], "+", 
       RowBox[{"dzDecayVolumeExperiment", "[", "exp", "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Whether", " ", "the", " ", "decay", " ", "volume", " ", "serves", " ", 
     "as", " ", "detector", " ", 
     RowBox[{"(", 
      RowBox[{"True", " ", "or", " ", "False"}], ")"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"DecayVolumeAsDetectorExperiment", "[", "exp", "]"}], "=", 
      "\"\<False\>\""}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Transverse", " ", "dimensions", " ", "of", " ", "the", " ", "detector", 
     " ", "assuming", " ", "box", " ", "geometry"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dxDetectorExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}],
        "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistanubceil", ",", 
        RowBox[{"{", "0.", "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dyDetectorExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}],
        "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistanubceil", ",", 
        RowBox[{"{", "0.", "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Length", " ", "of", " ", "the", " ", "detector", " ", "in", " ", "z", 
     " ", "plane"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dzDetectorExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}],
        "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistanubceil", ",", 
        RowBox[{"{", "53.", "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Coordinates", " ", "of", " ", "the", " ", "center", " ", "of", " ", 
     "the", " ", "detector"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"xToDetectorCenterExperiment", "[", "exp", "]"}], "=", "0"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"yToDetectorCenterExperiment", "[", "exp", "]"}], "=", "0"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"zToDetectorCenterExperiment", "[", "exp", "]"}], "=", "0."}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Inner", " ", "and", " ", "outer", " ", "radii", " ", "of", " ", "the", 
     " ", 
     RowBox[{"detector", ".", " ", "Formal"}], " ", "thickness", " ", "of", 
     " ", "1", " ", "m", " ", "is", " ", "assumed", " ", 
     RowBox[{"(", 
      RowBox[{
      "intersected", " ", "with", " ", "the", " ", "decay", " ", "volume"}], 
      ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"RinnerDetectorExperiment", "[", "#1", "]"}], "=", "#2"}], 
        ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistanubceil", ",", 
        RowBox[{"{", "19.", "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"RouterDetectorExperiment", "[", "#1", "]"}], "=", "#2"}], 
        ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistanubceil", ",", 
        RowBox[{"{", "20.", "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Length", " ", "of", " ", "the", " ", "detector", " ", "along", " ", 
     "the", " ", "detector", " ", "axis"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"xLongDetectorExperiment", "[", "exp", "]"}], "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"DetectorPlaneOrientationExperiment", "[", "exp", "]"}], 
          "\[Equal]", "\"\<Transverse\>\""}], ",", 
         RowBox[{"dzDetectorExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"dyDetectorExperiment", "[", "exp", "]"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "The", " ", "maximal", " ", "coordinate", " ", "of", " ", "the", " ", 
     "end", " ", "of", " ", "the", " ", "detector", " ", "plane", " ", 
     RowBox[{"(", 
      RowBox[{"along", " ", "the", " ", "detector", " ", "axis"}], ")"}], " ",
      "used", " ", "to", " ", "calculate", " ", "the", " ", "decay", " ", 
     RowBox[{"acceptance", ".", " ", "May"}], " ", "be", " ", "either", " ", 
     "the", " ", "z", " ", "coordinate", " ", "or", " ", "the", " ", "y", " ",
      "coordinate", " ", 
     RowBox[{"(", 
      RowBox[{
      "if", " ", "the", " ", "final", " ", "detector", " ", "plane", " ", 
       "is", " ", "oriented", " ", "parallel", " ", "to", " ", "the", " ", 
       "beamline"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}], "=", 
       RowBox[{"RouterDetectorExperiment", "[", "exp", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Position", " ", "of", " ", "the", " ", "final", " ", "plane", " ", "for",
      " ", "the", " ", "decay", " ", "products", " ", "along", " ", "the", 
     " ", "detector", " ", "axis"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"xLongDecayProductFinalPlaneExperiment", "[", "exp", "]"}], "=", 
      RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Whether", " ", "the", " ", "experiment", " ", "has", " ", "dipole", " ", 
     "magnet", " ", "in", " ", "the", " ", "detector", " ", 
     RowBox[{"(", 
      RowBox[{"True", ",", " ", "False"}], ")"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"DipoleMagnetOptionExperiment", "[", "#1", "]"}], "=", 
         "#2"}], ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistanubceil", ",", 
        RowBox[{"{", "\"\<False\>\"", "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Longitudinal", " ", "positions", " ", "of", " ", "the", " ", "dipole", 
     " ", "magnet", " ", "of", " ", "the", " ", "detector"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"zMagnetMinExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}],
        "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistanubceil", ",", 
        RowBox[{"{", "0.", "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"zMagnetMaxExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}],
        "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistanubceil", ",", 
        RowBox[{"{", "0.", "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Mean", " ", "magnetic", " ", "field", " ", "of", " ", "the", " ", 
     "dipole", " ", "magnet"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"MagneticFieldExperiment", "[", "#1", "]"}], "=", "#2"}], 
        ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistanubceil", ",", 
        RowBox[{"{", "0.", "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"ECAL", " ", "option", " ", 
     RowBox[{"(", 
      RowBox[{"True", ",", "False"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ECALoptionExperiment", "[", "exp", "]"}], "=", 
       "\"\<False\>\""}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Position", " ", "of", " ", "the", " ", "beginning", " ", "of", " ", 
     "the", " ", "ECAL"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ECALpositionExperiment", "[", "#1", "]"}], "=", "#2"}], 
        ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistanubceil", ",", 
        RowBox[{"{", "0.", "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"List", " ", "of", " ", "detectable", " ", 
      RowBox[{"particles", ".", " ", "If"}], " ", "ECAL", " ", "is", " ", 
      "absent"}], ",", " ", 
     RowBox[{
     "it", " ", "is", " ", "assumed", " ", "by", " ", "default", " ", "that", 
      " ", "photons", " ", "and", " ", 
      SubscriptBox[
       SuperscriptBox["K", "0"], "L"], " ", "cannot", " ", "be", " ", 
      "detected"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"DetectablePDGsExperiment", "[", "#1", "]"}], "=", "#2"}], 
        ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistanubceil", ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"detectablepdgs", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"22.", ",", "130.", ",", "2112.", ",", 
                  RowBox[{"-", "2112."}]}], "}"}], ",", "#"}], "]"}], "==", 
              "False"}], "&"}]}], "]"}], ",", 
          RowBox[{"Length", "[", "explistanubceil", "]"}]}], "]"}]}], "}"}]}],
      "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.893318068124275*^9, 3.8933180796892796`*^9}, 
   3.8933188011575403`*^9, {3.893318843172867*^9, 3.89331887825416*^9}, {
   3.893319167292712*^9, 3.8933191885036945`*^9}, 3.893322113862881*^9, {
   3.8934862861621876`*^9, 3.8934862890661306`*^9}, {3.8935181369638343`*^9, 
   3.893518136969819*^9}, 3.893519312796653*^9, {3.8935201259852066`*^9, 
   3.8935201693018475`*^9}, 3.8935206581774025`*^9, 3.8944385904358416`*^9, {
   3.8964523470133295`*^9, 3.896452415766353*^9}, {3.896452470490753*^9, 
   3.8964525169181232`*^9}, {3.8964526152333736`*^9, 
   3.8964527030172677`*^9}, {3.896452737880039*^9, 3.89645289952456*^9}, {
   3.8964538961987677`*^9, 3.896453932739047*^9}, {3.8964595336113367`*^9, 
   3.896459542357152*^9}, {3.8964609640523195`*^9, 3.8964609920275064`*^9}, {
   3.903800088260869*^9, 3.9038001161320868`*^9}, {3.9152644956271706`*^9, 
   3.915264510641859*^9}},
 CellTags->"Evaluation",
 CellLabel->"In[42]:=",ExpressionUUID->"aa90ff4c-871d-4f14-8c66-44f88731bc27"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cross-sections", "Subsubsection",
 CellChangeTimes->{{3.8933256308713317`*^9, 3.8933256323468237`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"3a8153bf-f8ea-4dec-b27c-1941df4d3446"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"NPOTexperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], "&"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"explistanubceil", ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"LLHChighLumi", "*", "72", "*", 
         SuperscriptBox["10", "9"]}], ",", 
        RowBox[{"Length", "[", "explistanubceil", "]"}]}], "]"}]}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"AtargetExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistanubceil", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"1.", ",", 
         RowBox[{"Length", "[", "explistanubceil", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Cascade", " ", "enhancement", " ", "of", " ", "the", " ", "production", 
    " ", "relative", " ", "to", " ", "the", " ", "production", " ", "in", " ",
     "pure", " ", "pp", " ", 
    RowBox[{"collisions", ".", " ", "Relevant"}], " ", "for", " ", "fixed", 
    " ", "target", " ", "experiments"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "For", " ", "all", " ", "experiments", " ", "located", " ", "at", " ", 
     "SPS"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "the", " ", "cascade", " ", "factors", " ", "is", " ", "taken", " ", 
       "from", " ", 
       RowBox[{"http", ":"}]}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"cds", ".", "cern", ".", "ch"}], "/", "record"}], "/", 
          "2115534"}], "/", "files"}], "/", "SHiP"}], "-", "NOTE", "-", 
       "2015", "-", 
       RowBox[{"009.", 
        RowBox[{"pdf", "?", "version"}]}]}]}], "=", "1"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CascadeFactorbb", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistanubceil", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"1.", ",", 
         RowBox[{"Length", "[", "explistanubceil", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "bb", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"PppTobbExperiment", "[", "exp", "]"}], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Sigma]ppTobbInpbFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
       RowBox[{"\[Sigma]ppInpbFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
     SuperscriptBox[
      RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"], "*", 
     RowBox[{"CascadeFactorbb", "[", "exp", "]"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CascadeFactorcc", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistanubceil", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"1.", ",", 
         RowBox[{"Length", "[", "explistanubceil", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "cc", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"PppToccExperiment", "[", "exp", "]"}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Sigma]ppToccInpbFacility", "[", 
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
        RowBox[{"\[Sigma]ppInpbFacility", "[", 
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
      SuperscriptBox[
       RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"], "*", 
      RowBox[{"CascadeFactorcc", "[", "exp", "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "h", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTohExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Sigma]ppTohInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "W", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToWExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Sigma]ppToWInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
    SuperscriptBox["\[Pi]", "0"], " ", "per", " ", "PoT", " ", "at", " ", 
    "the", " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Pi]0exp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Pi]0Facility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "\[Eta]", " ", "per", " ", 
    "PoT", " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Eta]exp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Eta]Facility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
    RowBox[{"\[Eta]", "'"}], " ", "per", " ", "PoT", " ", "at", " ", "the", 
    " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Eta]prexp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Eta]prFacility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
    SuperscriptBox["\[Rho]", "0"], " ", "per", " ", "PoT", " ", "at", " ", 
    "the", " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Rho]0exp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Rho]0Facility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "\[Omega]", " ", "per", " ", 
    "PoT", " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Omega]exp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Omega]Facility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
    RowBox[{"J", "/", "\[Psi]"}], 
    RowBox[{"(", 
     RowBox[{"1", "s"}], ")"}], " ", "per", " ", "PoT", " ", "at", " ", "the",
     " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToJpsiexp", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"PppToJpsiFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", "\[CapitalUpsilon]", 
    RowBox[{"(", 
     RowBox[{"1", "s"}], ")"}], " ", "per", " ", "PoT", " ", "at", " ", "the",
     " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToUpsilonexp", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"PppToUpsilonFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "\[Phi]", " ", "at", " ", 
    "the", " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToPhiexp", "[", "exp", "]"}], "=", 
      RowBox[{"PppToPhiFacility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Overall", " ", "table", " ", "with", " ", "cross"}], "-", 
    RowBox[{"sections", " ", "used", " ", "for", " ", "exporting"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"TableNumbersParticlesExperiment", "[", "exp", "]"}], "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<Facility\>\"", ",", "\"\<Npot\>\"", ",", "\"\<Atarget\>\"", ",", 
         "\"\<PPi0\>\"", ",", "\"\<PEta\>\"", ",", "\"\<PEtapr\>\"", ",", 
         "\"\<PRho0\>\"", ",", "\"\<POmega\>\"", ",", "\"\<Pc\>\"", ",", 
         "\"\<Pb\>\"", ",", "\"\<PW\>\"", ",", "\"\<Ph\>\"", ",", 
         "\"\<PJpsi\>\"", ",", "\"\<PUpsilon\>\"", ",", "\"\<PPhi\>\""}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"NPOTexperiment", "[", "exp", "]"}], ",", 
         RowBox[{"AtargetExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Pi]0exp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Eta]exp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Eta]prexp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Rho]0exp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Omega]exp", "[", "exp", "]"}], ",", 
         RowBox[{"2", 
          RowBox[{"PppToccExperiment", "[", "exp", "]"}]}], ",", 
         RowBox[{"2", 
          RowBox[{"PppTobbExperiment", "[", "exp", "]"}]}], ",", 
         RowBox[{"PppToWExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"PppTohExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"PppToJpsiexp", "[", "exp", "]"}], ",", 
         RowBox[{"PppToUpsilonexp", "[", "exp", "]"}], ",", 
         RowBox[{"PppToPhiexp", "[", "exp", "]"}]}], "}"}]}], "}"}], "//", 
     "N"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "explistanubceil"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8941782014898515`*^9, 3.894178203806712*^9}, {
  3.894178687745212*^9, 3.894178689678146*^9}, {3.8964959817139406`*^9, 
  3.896496002147423*^9}, {3.8991985829008865`*^9, 3.89919861687469*^9}, {
  3.899198668931733*^9, 3.8991986762689695`*^9}, {3.9038001447596803`*^9, 
  3.9038002093626432`*^9}},
 CellTags->"Evaluation",
 CellLabel->"In[75]:=",ExpressionUUID->"4d6d84cc-6468-4846-bf31-c6438c6fd6ef"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Temp", "Section",
 CellChangeTimes->{{3.8965074437785625`*^9, 3.8965074443619184`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"ae5880a5-2d5f-4e45-976c-b85057eda045"],

Cell[CellGroupData[{

Cell["Decay volume of ANUBIS-ceiling", "Subsection",
 CellChangeTimes->{{3.896507475877802*^9, 3.89650748019287*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"1fb49388-bed7-4e96-8dd9-01762efe4772"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "shiftings", " ", "of", " ", "ATLAS", " ", "beamline", " ", 
    "from", " ", "the", " ", "center", " ", "of", " ", "the", " ", "cavern", 
    " ", "where", " ", "ATLAS", " ", "is", " ", "located"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"xshiftval", "=", "1.7"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yshiftval", "=", "1.8"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ATLASvolume", "=", 
     RowBox[{"Region", "@", 
      RowBox[{"Cylinder", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{
            "zToDecayVolumeExperiment", "[", "\"\<ANUBIS-ceiling\>\"", 
             "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{
            "zMaxDecayVolumeExperiment", "[", "\"\<ANUBIS-ceiling\>\"", 
             "]"}]}], "}"}]}], "}"}], ",", "11.3"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ANUBISceilingProjectiveVolume", "=", 
     RowBox[{"Region", "@", 
      RowBox[{"RegionProduct", "[", 
       RowBox[{
        RowBox[{"Annulus", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"xshiftval", ",", "yshiftval"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.001", ",", 
            RowBox[{"RouterDecayVolumeExperiment", "[", 
             RowBox[{"\"\<ANUBIS-ceiling\>\"", ",", "z"}], "]"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"ArcSin", "[", 
              RowBox[{"-", 
               FractionBox[
                RowBox[{"dxDecayVolumeExperiment", "[", 
                 RowBox[{"z", ",", "\"\<ANUBIS-ceiling\>\""}], "]"}], 
                RowBox[{"2", "*", 
                 RowBox[{"RouterDecayVolumeExperiment", "[", 
                  RowBox[{"\"\<ANUBIS-ceiling\>\"", ",", "z"}], "]"}]}]]}], 
              "]"}], "+", 
             FractionBox["Pi", "2"]}], ",", 
            RowBox[{
             RowBox[{"ArcSin", "[", 
              FractionBox[
               RowBox[{"dxDecayVolumeExperiment", "[", 
                RowBox[{"z", ",", "\"\<ANUBIS-ceiling\>\""}], "]"}], 
               RowBox[{"2", "*", 
                RowBox[{"RouterDecayVolumeExperiment", "[", 
                 RowBox[{"\"\<ANUBIS-ceiling\>\"", ",", "z"}], "]"}]}]], 
              "]"}], "+", 
             FractionBox["Pi", "2"]}]}], "}"}]}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "zToDecayVolumeCenterExperiment", "[", "\"\<ANUBIS-ceiling\>\"", 
              "]"}], "-", 
             FractionBox[
              RowBox[{
              "dzDecayVolumeExperiment", "[", "\"\<ANUBIS-ceiling\>\"", "]"}],
               "2"]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "zToDecayVolumeCenterExperiment", "[", "\"\<ANUBIS-ceiling\>\"", 
              "]"}], "+", 
             FractionBox[
              RowBox[{
              "dzDecayVolumeExperiment", "[", "\"\<ANUBIS-ceiling\>\"", "]"}],
               "2"]}], "}"}]}], "}"}], "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DecayVolumeGeometry", "[", "\"\<ANUBIS-ceiling\>\"", "]"}], "=", 
     RowBox[{"ANUBISceilingDecayVolume", "=", 
      RowBox[{"RegionDifference", "[", 
       RowBox[{
        RowBox[{"Rationalize", "@", "ANUBISceilingProjectiveVolume"}], ",", 
        RowBox[{"Rationalize", "@", "ATLASvolume"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ANUBISceilingDecayVolumeDiscretized", "=", 
     RowBox[{"BoundaryDiscretizeRegion", "@", "ANUBISceilingDecayVolume"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ATLASvolume2D", "=", 
     RowBox[{"Disk", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", "11.3"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ANUBISceilingProjectiveVolume2D", "=", 
     RowBox[{"Annulus", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xshiftval", ",", "yshiftval"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.001", ",", 
         RowBox[{"RouterDecayVolumeExperiment", "[", 
          RowBox[{"\"\<ANUBIS-ceiling\>\"", ",", "z"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"ArcSin", "[", 
           RowBox[{"-", 
            FractionBox[
             RowBox[{"dxDecayVolumeExperiment", "[", 
              RowBox[{"z", ",", "\"\<ANUBIS-ceiling\>\""}], "]"}], 
             RowBox[{"2", "*", 
              RowBox[{"RouterDecayVolumeExperiment", "[", 
               RowBox[{"\"\<ANUBIS-ceiling\>\"", ",", "z"}], "]"}]}]]}], 
           "]"}], "+", 
          FractionBox["Pi", "2"]}], ",", 
         RowBox[{
          RowBox[{"ArcSin", "[", 
           FractionBox[
            RowBox[{"dxDecayVolumeExperiment", "[", 
             RowBox[{"z", ",", "\"\<ANUBIS-ceiling\>\""}], "]"}], 
            RowBox[{"2", "*", 
             RowBox[{"RouterDecayVolumeExperiment", "[", 
              RowBox[{"\"\<ANUBIS-ceiling\>\"", ",", "z"}], "]"}]}]], "]"}], 
          "+", 
          FractionBox["Pi", "2"]}]}], "}"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.896507485659438*^9, 3.896507497874317*^9}, {
   3.896507561090762*^9, 3.896507648417035*^9}, {3.8965082227578187`*^9, 
   3.896508230066184*^9}, {3.896508831826661*^9, 3.8965088323773613`*^9}, 
   3.8965088723735027`*^9, {3.896508903622981*^9, 3.896508949252499*^9}, {
   3.896508980682222*^9, 3.89650898109844*^9}, {3.896511199453091*^9, 
   3.8965112010563645`*^9}, {3.8965209483816547`*^9, 3.896520990009026*^9}},
 CellTags->"Evaluation",
 CellLabel->"In[92]:=",ExpressionUUID->"a79320cd-0d99-43fb-808f-7ae5821314a3"]
}, Closed]],

Cell[CellGroupData[{

Cell["Detector of ANUBIS-ceiling", "Subsection",
 CellChangeTimes->{{3.896507761964131*^9, 3.8965077656993136`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"ddf1802a-9d74-44ec-8027-ff68a7e281ad"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DetectorGeometry", "[", "\"\<ANUBIS-ceiling\>\"", "]"}], "=", 
   RowBox[{"ANUBISceilingDetector", "=", 
    RowBox[{"Region", "@", 
     RowBox[{"RegionProduct", "[", 
      RowBox[{
       RowBox[{"Annulus", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"xshiftval", ",", "yshiftval"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
           "RinnerDetectorExperiment", "[", "\"\<ANUBIS-ceiling\>\"", "]"}], 
           ",", 
           RowBox[{
           "RouterDetectorExperiment", "[", "\"\<ANUBIS-ceiling\>\"", "]"}]}],
           "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"ArcSin", "[", 
             RowBox[{"-", 
              FractionBox[
               RowBox[{"dxDecayVolumeExperiment", "[", 
                RowBox[{"z", ",", "\"\<ANUBIS-ceiling\>\""}], "]"}], 
               RowBox[{"2", "*", 
                RowBox[{
                "RinnerDetectorExperiment", "[", "\"\<ANUBIS-ceiling\>\"", 
                 "]"}]}]]}], "]"}], "+", 
            FractionBox["Pi", "2"]}], ",", 
           RowBox[{
            RowBox[{"ArcSin", "[", 
             FractionBox[
              RowBox[{"dxDecayVolumeExperiment", "[", 
               RowBox[{"z", ",", "\"\<ANUBIS-ceiling\>\""}], "]"}], 
              RowBox[{"2", "*", 
               RowBox[{
               "RinnerDetectorExperiment", "[", "\"\<ANUBIS-ceiling\>\"", 
                "]"}]}]], "]"}], "+", 
            FractionBox["Pi", "2"]}]}], "}"}]}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "zToDecayVolumeCenterExperiment", "[", "\"\<ANUBIS-ceiling\>\"", 
             "]"}], "-", 
            FractionBox[
             RowBox[{
             "dzDecayVolumeExperiment", "[", "\"\<ANUBIS-ceiling\>\"", "]"}], 
             "2"]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "zToDecayVolumeCenterExperiment", "[", "\"\<ANUBIS-ceiling\>\"", 
             "]"}], "+", 
            FractionBox[
             RowBox[{
             "dzDecayVolumeExperiment", "[", "\"\<ANUBIS-ceiling\>\"", "]"}], 
             "2"]}], "}"}]}], "}"}], "]"}]}], "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.896508269061487*^9, 3.8965082732983866`*^9}, 
   3.8965145073894267`*^9, 3.8965209434897313`*^9, {3.8965210488134747`*^9, 
   3.896521049474432*^9}, 3.9038002888292665`*^9},
 CellTags->"Evaluation",
 CellLabel->
  "In[100]:=",ExpressionUUID->"4f88dadc-62a7-4c7e-b264-2a24eba51db8"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", 
    RowBox[{"min", "/", "max"}]], TraditionalForm]],ExpressionUUID->
  "9982a610-c6ad-4631-b28c-3e1990a6bdfb"],
 " - minimal and maximal angles covered by the end of the detector. If the \
decay volume is fully off-axis, than the minimal angle is defined by the \
minimal angle covered by end of the decay volume"
}], "Subsection",
 CellChangeTimes->{{3.8850103028371077`*^9, 3.8850103684893785`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"049a2a4d-92fb-4feb-adfe-14f536d3c212"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]func", "[", 
    RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
   RowBox[{"ArcCos", "[", 
    RowBox[{"z", "/", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"x", "^", "2"}], "+", 
       RowBox[{"y", "^", "2"}], "+", 
       RowBox[{"z", "^", "2"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]minmaxBlock", "[", "experiment_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "Geometry", " ", "of", " ", "the", " ", "decay", " ", "volume"}], ",", 
      " ", "detector", ",", " ", 
      RowBox[{
       RowBox[{"and", " ", "the", " ", "cross"}], "-", 
       RowBox[{
       "section", " ", "of", " ", "the", " ", "end", " ", "of", " ", "the", 
        " ", "detector"}]}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"DecayVolume", ",", "DetectorVolume"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DecayVolumeGeometry", "[", "experiment", "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "DecayVolumeAsDetectorExperiment", "[", "experiment", "]"}], 
           "\[Equal]", "\"\<False\>\""}], ",", 
          RowBox[{"DetectorGeometry", "[", "experiment", "]"}]}], "]"}]}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Resolution", " ", "of", " ", "discretization", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"lower", " ", "value", " ", "is", " ", "better"}], ",", " ", 
         RowBox[{"but", " ", "slower"}]}], ")"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"MaxCellMeasureVal", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"experiment", "\[Equal]", "\"\<LHCb-far\>\""}], "||", 
         RowBox[{"experiment", "\[Equal]", "\"\<CHARM\>\""}]}], ",", ".2", 
        ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"experiment", "\[Equal]", "\"\<SHiP-ECN3-LoI\>\""}], ",", 
          ".05", ",", 
          RowBox[{"(*", "Automatic", "*)"}], ".2"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Whether", " ", "the", " ", "detector", " ", "lies", " ", "on"}], "-", 
       "beamline"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"WhetherLiesOnAxis", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DecayVolumeAsDetectorExperiment", "[", "experiment", "]"}], 
         "\[Equal]", "\"\<False\>\""}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "DetectorPlaneOrientationExperiment", "[", "experiment", "]"}], 
           "\[Equal]", "\"\<Transverse\>\""}], ",", 
          RowBox[{"RegionMeasure", "[", 
           RowBox[{"RegionIntersection", "[", 
            RowBox[{"DetectorVolume", ",", 
             RowBox[{"Point", "[", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", 
                RowBox[{
                "xLongMaxDetectorExperiment", "[", "experiment", "]"}]}], 
               "}"}], "]"}]}], "]"}], "]"}], ",", 
          RowBox[{"RegionMeasure", "[", 
           RowBox[{"RegionIntersection", "[", 
            RowBox[{"DetectorVolume", ",", 
             RowBox[{"Point", "[", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{
                "xLongMaxDetectorExperiment", "[", "experiment", "]"}], ",", 
                "0"}], "}"}], "]"}]}], "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"RegionMeasure", "[", 
         RowBox[{"RegionIntersection", "[", 
          RowBox[{"DecayVolume", ",", 
           RowBox[{"Point", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", 
              RowBox[{"zMaxDecayVolumeExperiment", "[", "experiment", "]"}]}],
              "}"}], "]"}]}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Discretization", " ", "of", " ", "the", " ", "decay", " ", "volume", 
       " ", "and", " ", "detector"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"DiscretizedDecayVolume", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"experiment", "\[Equal]", "\"\<SHiP-ECN3-LoI\>\""}], "||", 
         RowBox[{"experiment", "\[Equal]", "\"\<SHiP-ECN3\>\""}], "||", 
         RowBox[{"experiment", "\[Equal]", "\"\<SHiP-ECN3-alt\>\""}], "||", 
         RowBox[{"experiment", "\[Equal]", "\"\<SHiP-ECN4\>\""}]}], ",", 
        RowBox[{"DiscretizeRegion", "[", 
         RowBox[{
          RowBox[{"MeshRegion", "[", "DecayVolume", "]"}], ",", 
          RowBox[{"MaxCellMeasure", "\[Rule]", "MaxCellMeasureVal"}]}], "]"}],
         ",", 
        RowBox[{"BoundaryDiscretizeRegion", "[", 
         RowBox[{"DecayVolume", ",", 
          RowBox[{"MaxCellMeasure", "\[Rule]", "MaxCellMeasureVal"}]}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DiscretizedDetectorVolume", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DecayVolumeAsDetectorExperiment", "[", "experiment", "]"}], 
         "\[Equal]", "\"\<False\>\""}], ",", 
        RowBox[{"BoundaryDiscretizeRegion", "[", 
         RowBox[{"DetectorVolume", ",", 
          RowBox[{"MaxCellMeasure", "\[Rule]", "MaxCellMeasureVal"}]}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DetectorCoordinates", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DecayVolumeAsDetectorExperiment", "[", "experiment", "]"}], 
         "\[Equal]", "\"\<False\>\""}], ",", 
        RowBox[{"MeshCoordinates", "[", "DiscretizedDetectorVolume", "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"DecayVolumeCoordinates", ",", "DetEndCoordinates"}], "}"}], 
      "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"MeshCoordinates", "[", "DiscretizedDecayVolume", "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "DecayVolumeAsDetectorExperiment", "[", "experiment", "]"}], 
           "\[Equal]", "\"\<False\>\""}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "DetectorPlaneOrientationExperiment", "[", "experiment", "]"}], 
             "\[Equal]", "\"\<Transverse\>\""}], ",", 
            RowBox[{"Select", "[", 
             RowBox[{"DetectorCoordinates", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], ">", 
                RowBox[{"0.995", 
                 RowBox[{
                 "xLongMaxDetectorExperiment", "[", "experiment", "]"}]}]}], 
               "&"}]}], "]"}], ",", "DetectorCoordinates"}], "]"}]}], "]"}]}],
        "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Theta]minmaxDecayVolume", ",", "\[Theta]minmaxDetEnd"}], 
       "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"MinMax", "[", 
         RowBox[{"\[Theta]func", "@@@", "DecayVolumeCoordinates"}], "]"}], 
        ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "DecayVolumeAsDetectorExperiment", "[", "experiment", "]"}], 
           "\[Equal]", "\"\<False\>\""}], ",", 
          RowBox[{"MinMax", "[", 
           RowBox[{"\[Theta]func", "@@@", "DetEndCoordinates"}], "]"}]}], 
         "]"}]}], "}"}]}], ";", "\n", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[Theta]minIndexDecayVolume", ",", "\[Theta]maxIndexDecayVolume"}], 
       "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"\[Theta]func", "@@@", "DecayVolumeCoordinates"}], ",", 
            RowBox[{"Min", "[", 
             RowBox[{"\[Theta]func", "@@@", "DecayVolumeCoordinates"}], 
             "]"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"\[Theta]func", "@@@", "DecayVolumeCoordinates"}], ",", 
            RowBox[{"Max", "[", 
             RowBox[{"\[Theta]func", "@@@", "DecayVolumeCoordinates"}], 
             "]"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"\[Theta]minmaxDet1", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "DecayVolumeAsDetectorExperiment", "[", "experiment", "]"}], 
           "\[Equal]", "\"\<False\>\""}], ",", 
          RowBox[{"MinMax", "[", 
           RowBox[{"\[Theta]func", "@@@", 
            RowBox[{"MeshCoordinates", "[", "discretDetVol", "]"}]}], "]"}]}],
          "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Theta]minIndexDetEnd", ",", "\[Theta]maxIndexDetEnd"}], 
       "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "DecayVolumeAsDetectorExperiment", "[", "experiment", "]"}], 
           "\[Equal]", "\"\<False\>\""}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"\[Theta]func", "@@@", "DetEndCoordinates"}], ",", 
              RowBox[{"Min", "[", 
               RowBox[{"\[Theta]func", "@@@", "DetEndCoordinates"}], "]"}]}], 
             "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "DecayVolumeAsDetectorExperiment", "[", "experiment", "]"}], 
           "\[Equal]", "\"\<False\>\""}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"\[Theta]func", "@@@", "DetEndCoordinates"}], ",", 
              RowBox[{"Max", "[", 
               RowBox[{"\[Theta]func", "@@@", "DetEndCoordinates"}], "]"}]}], 
             "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Coordinates", " ", "belonging", " ", "to", " ", "the", " ", "minimal", 
       " ", "and", " ", "maximal", " ", "angles", " ", "covered", " ", "by", 
       " ", 
       RowBox[{"detector", "/", "decay"}], " ", "volume"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[Theta]minmaxCoordinatesExperiment", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DecayVolumeAsDetectorExperiment", "[", "experiment", "]"}], 
         "\[Equal]", "\"\<False\>\""}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"DecayVolumeCoordinates", "[", 
             RowBox[{"[", "\[Theta]minIndexDecayVolume", "]"}], "]"}], ",", 
            RowBox[{"DecayVolumeCoordinates", "[", 
             RowBox[{"[", "\[Theta]maxIndexDecayVolume", "]"}], "]"}]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"DetEndCoordinates", "[", 
             RowBox[{"[", "\[Theta]minIndexDetEnd", "]"}], "]"}], ",", 
            RowBox[{"DetEndCoordinates", "[", 
             RowBox[{"[", "\[Theta]maxIndexDetEnd", "]"}], "]"}]}], "}"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"DecayVolumeCoordinates", "[", 
            RowBox[{"[", "\[Theta]minIndexDecayVolume", "]"}], "]"}], ",", 
           RowBox[{"DecayVolumeCoordinates", "[", 
            RowBox[{"[", "\[Theta]maxIndexDecayVolume", "]"}], "]"}]}], "}"}],
          "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"The", " ", "final", " ", 
        RowBox[{"output", ":", " ", 
         RowBox[{
         "coordinates", " ", "belonging", " ", "to", " ", "the", " ", 
          "minimal", " ", "and", " ", "maximal", " ", "angles", " ", 
          "covered", " ", "by", " ", 
          RowBox[{"detector", "/", "decay"}], " ", "volume"}]}]}], ",", " ", 
       RowBox[{
        SubscriptBox["\[Theta]", 
         RowBox[{"min", "/", "max"}]], " ", "for", " ", "decay", " ", 
        "volume"}], ",", " ", 
       RowBox[{
        SubscriptBox["\[Theta]", 
         RowBox[{"min", "/", "max"}]], " ", "for", " ", "detector"}]}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\[Theta]minmaxCoordinatesExperiment", ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"WhetherLiesOnAxis", "\[Equal]", "1"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"\[Theta]minmaxDecayVolume", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
         "\[Theta]minmaxDecayVolume"}], "]"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"DecayVolumeAsDetectorExperiment", "[", "experiment", "]"}],
           "\[Equal]", "\"\<False\>\""}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"WhetherLiesOnAxis", "\[Equal]", "1"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"\[Theta]minmaxDetEnd", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           "\[Theta]minmaxDetEnd"}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"WhetherLiesOnAxis", "\[Equal]", "1"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"\[Theta]minmaxDecayVolume", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           "\[Theta]minmaxDecayVolume"}], "]"}]}], "]"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.8862158180216084`*^9, 3.8862158397426157`*^9}, {
   3.8862173903464975`*^9, 3.8862174928886595`*^9}, {3.8862176624205446`*^9, 
   3.886217686035149*^9}, {3.8862180874505916`*^9, 3.886218133636117*^9}, {
   3.886218177718444*^9, 3.8862181781025686`*^9}, {3.886219107641494*^9, 
   3.886219111004465*^9}, {3.886221915277137*^9, 3.886221954080035*^9}, {
   3.8862221058752356`*^9, 3.886222115284054*^9}, {3.8862226400728607`*^9, 
   3.8862226412968082`*^9}, {3.8862227160369515`*^9, 
   3.8862227903104854`*^9}, {3.886222830394898*^9, 3.886222840767403*^9}, {
   3.8862229052234125`*^9, 3.8862230200115304`*^9}, {3.8862233097508802`*^9, 
   3.886223310894819*^9}, {3.8862233544570103`*^9, 3.886223603094037*^9}, {
   3.886224007992465*^9, 3.8862240115572653`*^9}, {3.886226164518012*^9, 
   3.8862261645430126`*^9}, {3.886227674556193*^9, 3.886227704114601*^9}, {
   3.886227736654972*^9, 3.88622773738545*^9}, {3.886227845604789*^9, 
   3.8862278475939636`*^9}, {3.886230464076109*^9, 3.886230466510042*^9}, {
   3.886230524773344*^9, 3.886230526472779*^9}, {3.8862305737831597`*^9, 
   3.8862305792618523`*^9}, {3.8862307900527077`*^9, 
   3.8862308081219616`*^9}, {3.886231118380079*^9, 3.8862311246083555`*^9}, 
   3.886324160752802*^9, {3.8864085771220427`*^9, 3.886408579809992*^9}, 
   3.8864356067421403`*^9, {3.886477410766488*^9, 3.8864774843648477`*^9}, {
   3.8864776665836964`*^9, 3.8864776684104786`*^9}, {3.8875265696400633`*^9, 
   3.8875266030109615`*^9}, {3.8875266390103865`*^9, 3.887526735530167*^9}, {
   3.8875283804583073`*^9, 3.8875284920074224`*^9}, {3.8875287393382435`*^9, 
   3.88752874427244*^9}, {3.888050337954692*^9, 3.888050338711929*^9}, {
   3.891677900899274*^9, 3.89167790091486*^9}, {3.891678114570367*^9, 
   3.891678114586007*^9}, {3.8933148501988287`*^9, 3.8933148502367263`*^9}, {
   3.8933405824118347`*^9, 3.8933405824159765`*^9}, 3.8933414645316696`*^9, {
   3.8935197686770067`*^9, 3.893519787941795*^9}, {3.895035648570586*^9, 
   3.895035702860251*^9}, {3.8965159993290234`*^9, 3.8965160024310727`*^9}, 
   3.8965183568921795`*^9},
 CellTags->"Evaluation",
 CellLabel->
  "In[101]:=",ExpressionUUID->"0550c48c-e450-4ace-bc02-f0ffdaf95418"],

Cell[CellGroupData[{

Cell["Polar angle grid", "Subsubsection",
 CellChangeTimes->{{3.887526463267141*^9, 3.887526469273341*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"67acb5b1-0310-4ea2-9d6c-320976f9c01d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Theta]grid", "[", 
   RowBox[{
   "DecayVolumeAsDet_", ",", "\[Theta]decVolmin_", ",", "\[Theta]decVolmax_", 
    ",", "\[Theta]detmin_", ",", "\[Theta]detmax_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Theta]detMinEff", ",", "\[Theta]detMaxEff", ",", 
      "\[Theta]gridDetEnd"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Min", "/", "max"}], " ", "angles", " ", "covered", " ", "by", 
      " ", "detector", " ", "and", " ", "belonging", " ", "simultaneously", 
      " ", "to", " ", "the", " ", "decay", " ", "volume", " ", "acceptance"}],
      "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Theta]detMinEff", "=", 
      RowBox[{"Max", "[", 
       RowBox[{"\[Theta]detmin", ",", "\[Theta]decVolmin"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Theta]detMaxEff", "=", 
      RowBox[{"Min", "[", 
       RowBox[{"\[Theta]detmax", ",", "\[Theta]decVolmax"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Grid", " ", "of", " ", "polar", " ", "angles", " ", "for", " ", "the", 
       " ", "end", " ", "of", " ", "the", " ", "detector"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[Theta]gridDetEnd", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"DecayVolumeAsDet", "\[Equal]", "\"\<False\>\""}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{"x", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{
             RowBox[{"1.001", "\[Theta]detMinEff"}], "+", 
             SuperscriptBox["10", 
              RowBox[{"-", "5."}]]}], ",", 
            RowBox[{"0.99", "\[Theta]detMaxEff"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"0.99", "\[Theta]detMaxEff"}], "-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"1.001", "\[Theta]detMinEff"}], "+", 
                 SuperscriptBox["10", 
                  RowBox[{"-", "5."}]]}], ")"}]}], ")"}], "/", "16"}]}], 
           "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Theta]gridDecVolIfDet", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"DecayVolumeAsDet", "\[Equal]", "\"\<False\>\""}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{"x", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{
             RowBox[{"1.001", "\[Theta]decVolmin"}], "+", 
             SuperscriptBox["10", 
              RowBox[{"-", "5."}]]}], ",", 
            RowBox[{"0.999", "\[Theta]decVolmax"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"0.999", "\[Theta]decVolmax"}], "-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"1.001", "\[Theta]detMinEff"}], "+", 
                 SuperscriptBox["10", 
                  RowBox[{"-", "5."}]]}], ")"}]}], ")"}], "/", "13"}]}], 
           "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Theta]gridDecVolIfNoDet", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"DecayVolumeAsDet", "\[Equal]", "\"\<True\>\""}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{"x", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{
             RowBox[{"1.001", "\[Theta]decVolmin"}], "+", 
             SuperscriptBox["10", 
              RowBox[{"-", "5."}]]}], ",", 
            RowBox[{"0.999", "\[Theta]decVolmax"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"0.999", "\[Theta]decVolmax"}], "-", 
               RowBox[{"1.001", "\[Theta]detMinEff"}], "+", 
               SuperscriptBox["10", 
                RowBox[{"-", "5."}]]}], ")"}], "/", "22"}]}], "}"}]}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Total", " ", "grid", " ", "for", " ", "experiments", " ", "where", 
        " ", "decay", " ", "volume", " ", "is", " ", "not", " ", 
        RowBox[{"detector", ".", " ", "Merging"}], " ", "the", " ", "grid", 
        " ", "for", " ", "detector", " ", "and", " ", "decay", " ", 
        "volume"}], ",", " ", 
       RowBox[{
       "selecting", " ", "for", " ", "the", " ", "latter", " ", "only", " ", 
        "the", " ", "angles", " ", "outside", " ", "the", " ", "detector", 
        " ", "coverage"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[Theta]gridTotIfDet", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"DecayVolumeAsDet", "\[Equal]", "\"\<False\>\""}], ",", 
        RowBox[{"Sort", "[", 
         RowBox[{"Join", "[", 
          RowBox[{"\[Theta]gridDetEnd", ",", 
           RowBox[{"Select", "[", 
            RowBox[{"\[Theta]gridDecVolIfDet", ",", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"(", 
                RowBox[{
                "\[Theta]detMinEff", "\[LessEqual]", "#", "\[LessEqual]", 
                 "\[Theta]detMaxEff"}], ")"}]}], "&"}]}], "]"}]}], "]"}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"DecayVolumeAsDet", "\[Equal]", "\"\<False\>\""}], ",", 
       "\[Theta]gridTotIfDet", ",", "\[Theta]gridDecVolIfNoDet"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8875264783662243`*^9, 3.8875265222827024`*^9}, {
   3.887526742295684*^9, 3.887526810919674*^9}, {3.887526976587242*^9, 
   3.8875269784334836`*^9}, {3.887527049772958*^9, 3.88752708808506*^9}, {
   3.8875271515487823`*^9, 3.8875271575533714`*^9}, {3.8875272241199007`*^9, 
   3.8875272310647445`*^9}, {3.8875273449631715`*^9, 
   3.8875274918045177`*^9}, {3.887527592921301*^9, 3.8875276682467494`*^9}, {
   3.88752770475403*^9, 3.887528157694888*^9}, {3.8875289881915703`*^9, 
   3.8875289918074403`*^9}, {3.887529091868435*^9, 3.887529183045274*^9}, {
   3.8915325290406227`*^9, 3.8915325410232162`*^9}, {3.8915329153554935`*^9, 
   3.891532920070578*^9}, {3.891533471822391*^9, 3.8915334832115393`*^9}, {
   3.891533641867587*^9, 3.8915336493077135`*^9}, {3.8916150025620875`*^9, 
   3.8916151681219425`*^9}, {3.8916152887898064`*^9, 
   3.8916152913752537`*^9}, {3.8916153356626363`*^9, 3.8916154447642736`*^9}, 
   3.8916155628250327`*^9, {3.8916156150143037`*^9, 3.8916157853700113`*^9}, {
   3.8916158244791636`*^9, 3.8916158503080406`*^9}, {3.891615954782565*^9, 
   3.8916159558520017`*^9}, {3.893215695593479*^9, 3.893215711915337*^9}, {
   3.893301613100013*^9, 3.893301613176914*^9}, {3.8933017430919356`*^9, 
   3.8933017646199713`*^9}, {3.8935196961260056`*^9, 
   3.8935196963703794`*^9}, {3.896508376419938*^9, 3.896508377400525*^9}, {
   3.8965085518569565`*^9, 3.896508556196859*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[103]:=",ExpressionUUID->"43dae102-92b1-4ee4-9d18-a8aef4fd7010"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Specifications", "Subsection",
 CellChangeTimes->{{3.896508601070324*^9, 3.8965086042333326`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"057fa2fe-e48a-4f24-b9cc-3fb1e545193a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"GivenExperiment", "=", "\"\<ANUBIS-ceiling\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FacilityGivenExperiment", "=", 
   RowBox[{"FacilityExperiment", "[", "GivenExperiment", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EmaxGivenExperiment", "=", 
   RowBox[{"EmaxFacility", "[", "FacilityGivenExperiment", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ECALoptionGivenExperiment", "=", 
   RowBox[{"ECALoptionExperiment", "[", "GivenExperiment", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DipoleMagnetOptionGivenExperiment", "=", 
   RowBox[{"DipoleMagnetOptionExperiment", "[", "GivenExperiment", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DecayVolumeAsDetectorGivenExperiment", "=", 
    RowBox[{
    "DecayVolumeAsDetectorExperiment", "[", "GivenExperiment", "]"}]}], ";"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Box", ",", " ", "Cylinder", ",", " ", 
    RowBox[{"Annular", " ", "cylinder"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GeometryGivenExperiment", "=", 
    RowBox[{"GeometryExperiment", "[", "GivenExperiment", "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Beam", ",", " ", "Transverse"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DetectorPlaneOrientationGivenExperiment", "=", 
   RowBox[{
   "DetectorPlaneOrientationExperiment", "[", "GivenExperiment", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"!", 
    RowBox[{"DirectoryQ", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Acceptances\>\""}],
        "}"}], "]"}], "]"}]}], ",", 
   RowBox[{"CreateDirectory", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Acceptances\>\""}], 
      "}"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"!", 
    RowBox[{"DirectoryQ", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Acceptances\>\"", 
        ",", "GivenExperiment"}], "}"}], "]"}], "]"}]}], ",", 
   RowBox[{"CreateDirectory", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Acceptances\>\"", 
       ",", "GivenExperiment"}], "}"}], "]"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dxDecayVolumeGivenExperiment", "[", "z_", "]"}], "=", 
   RowBox[{"dxDecayVolumeExperiment", "[", 
    RowBox[{"z", ",", "GivenExperiment"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dyDecayVolumeGivenExperiment", "[", "z_", "]"}], "=", 
   RowBox[{"dyDecayVolumeExperiment", "[", 
    RowBox[{"z", ",", "GivenExperiment"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zToDecayVolumeGivenExperiment", "=", 
   RowBox[{"zToDecayVolumeExperiment", "[", "GivenExperiment", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zFidGivenExperiment", "=", 
   RowBox[{"dzDecayVolumeExperiment", "[", "GivenExperiment", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zLLPMaxGivenExperiment", "=", 
   RowBox[{"zMaxDecayVolumeExperiment", "[", "GivenExperiment", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xLongMaxDetectorGivenExperiment", "=", 
   RowBox[{"xLongMaxDetectorExperiment", "[", "GivenExperiment", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dxDecayVolumeGivenExperimentMax", "=", 
   RowBox[{
   "dxDecayVolumeGivenExperiment", "[", "zLLPMaxGivenExperiment", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dyDecayVolumeGivenExperimentMax", "=", 
   RowBox[{
   "dyDecayVolumeGivenExperiment", "[", "zLLPMaxGivenExperiment", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xToDecayVolumeCenterGivenExperiment", "=", 
   RowBox[{"xToDecayVolumeCenterExperiment", "[", "GivenExperiment", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"yToDecayVolumeCenterGivenExperiment", "=", 
    RowBox[{"yToDecayVolumeCenterExperiment", "[", "GivenExperiment", "]"}]}],
    ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Detector", " ", "parameters"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dxDetectorGivenExperimentMax", "=", 
   RowBox[{"dxDetectorGivenExperiment", "=", 
    RowBox[{"dxDetectorExperiment", "[", "GivenExperiment", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dyDetectorGivenExperimentMax", "=", 
   RowBox[{"dyDetectorGivenExperiment", "=", 
    RowBox[{"dyDetectorExperiment", "[", "GivenExperiment", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dzDetectorGivenExperimentMax", "=", 
   RowBox[{"dzDetectorGivenExperiment", "=", 
    RowBox[{"dzDetectorExperiment", "[", "GivenExperiment", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dx2PerpDetectorGivenExperiment", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
     "DetectorPlaneOrientationGivenExperiment", "\[Equal]", 
      "\"\<Transverse\>\""}], ",", "dyDetectorGivenExperiment", ",", 
     "dzDetectorGivenExperiment"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xToDetectorCenterGivenExperiment", "=", 
   RowBox[{
    RowBox[{"xToDetectorCenterExperiment", "[", "GivenExperiment", "]"}], "//",
     "N"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yToDetectorCenterGivenExperiment", "=", 
   RowBox[{
    RowBox[{"yToDetectorCenterExperiment", "[", "GivenExperiment", "]"}], "//",
     "N"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zToDetectorCenterGivenExperiment", "=", 
   RowBox[{
    RowBox[{"zToDetectorCenterExperiment", "[", "GivenExperiment", "]"}], "//",
     "N"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x2PerpToDetectorCenterGivenExperiment", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
     "DetectorPlaneOrientationGivenExperiment", "\[Equal]", 
      "\"\<Transverse\>\""}], ",", "yToDetectorCenterGivenExperiment", ",", 
     "zToDetectorCenterGivenExperiment"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RinnerDecayVolumeGivenExperiment", "[", "z_", "]"}], "=", 
   RowBox[{"RinnerDecayVolumeExperiment", "[", 
    RowBox[{"GivenExperiment", ",", "z"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RouterDecayVolumeGivenExperiment", "[", "z_", "]"}], "=", 
   RowBox[{"RouterDecayVolumeExperiment", "[", 
    RowBox[{"GivenExperiment", ",", "z"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RinnerDetectorGivenExperiment", "=", 
   RowBox[{"RinnerDetectorExperiment", "[", "GivenExperiment", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RouterDetectorGivenExperiment", "=", 
   RowBox[{"RouterDetectorExperiment", "[", "GivenExperiment", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GivenExperimentBoundaries", "=", 
   RowBox[{"\[Theta]minmaxBlock", "[", "GivenExperiment", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "ThetaDecVolGivenExperimentMin", ",", "ThetaDecVolGivenExperimentMax", 
     ",", "ThetaDetGivenExperimentMin", ",", "ThetaDetGivenExperimentMax"}], 
    "}"}], "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"GivenExperimentBoundaries", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"GivenExperimentBoundaries", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"GivenExperimentBoundaries", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"GivenExperimentBoundaries", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "//", "N"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DecayVolumeGeometryGivenExperiment", "=", 
   RowBox[{"DecayVolumeGeometry", "[", "GivenExperiment", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DetectorGeometryGivenExperiment", "=", 
    RowBox[{"DetectorGeometry", "[", "GivenExperiment", "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Parameters", " ", "of", " ", "the", " ", "dipole", " ", "magnet", " ", 
    "in", " ", "the", " ", "spectrometer", " ", 
    RowBox[{"(", 
     RowBox[{"if", " ", "present"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zMagnetMinGivenExperiment", "=", 
   RowBox[{"zMagnetMinExperiment", "[", "GivenExperiment", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zMagnetMaxGivenExperiment", "=", 
   RowBox[{"zMagnetMaxExperiment", "[", "GivenExperiment", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Bval", "=", 
    RowBox[{"MagneticFieldExperiment", "[", "GivenExperiment", "]"}]}], ";"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"ECAL", " ", "position"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ECALpositionGivenExperiment", "=", 
    RowBox[{"ECALpositionExperiment", "[", "GivenExperiment", "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"FinalPlaneGivenExperiment", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
       "finalPlaneGivenExperiment", "\[Equal]", "\"\<EndOfDetector\>\""}], 
       ",", "EndOfDetectorGivenExperiment", ",", 
       "PlaneDetectorGivenExperiment"}], "]"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TableParticlesNumbersGivenExperiment", "=", 
   RowBox[{"TableNumbersParticlesExperiment", "[", "GivenExperiment", "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"DetectablePDGsGivenExperiment", "=", 
  RowBox[{
  "DetectablePDGsExperiment", "[", "GivenExperiment", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\"\<Experiment\>\"", ",", "\"\<Facility\>\"", ",", 
      "\"\<Decay volume as detector\>\"", ",", "\"\<If ECAL is present\>\"", 
      ",", "\"\<If dipole magnet is present\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(E\), \(LLP, max\)]\)\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "GivenExperiment", ",", "FacilityGivenExperiment", ",", 
      "DecayVolumeAsDetectorGivenExperiment", ",", 
      "ECALoptionGivenExperiment", ",", "DipoleMagnetOptionGivenExperiment", 
      ",", "EmaxGivenExperiment"}], "}"}]}], "}"}], "//", 
  "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xLongMuonPlaneGivenExperiment", "=", 
   RowBox[{"xLongNonMuonPlaneGivenExperiment", "=", 
    RowBox[{"zToDetectorCenterGivenExperiment", "+", 
     FractionBox["dzDetectorGivenExperimentMax", "2"]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8965086102428207`*^9, 3.896508680842684*^9}, {
   3.8965156624809856`*^9, 3.8965156626798563`*^9}, {3.896515925606839*^9, 
   3.896515925755002*^9}, {3.896518118996149*^9, 3.8965181190857687`*^9}, {
   3.915263994812927*^9, 3.9152639951816444`*^9}, {3.915264081159647*^9, 
   3.9152641055393443`*^9}, 3.915264190213991*^9, {3.9152645433763943`*^9, 
   3.915264585863675*^9}, {3.9152646267577906`*^9, 3.915264654090233*^9}, {
   3.9152940477235184`*^9, 3.9152940774690886`*^9}, {3.9168899403690305`*^9, 
   3.916889940384654*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[104]:=",ExpressionUUID->"e7b14f0b-6354-4c9b-8550-57165daae3a4"]
}, Closed]],

Cell[CellGroupData[{

Cell["Visualization of the geometry", "Subsection",
 CellChangeTimes->{{3.8965144562942743`*^9, 3.896514459893909*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"dbf823ef-a081-4f4f-aff6-fc1892c23782"],

Cell[BoxData[{
 RowBox[{"Print", "[", "\"\<List of geometric parameters:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"GeometryGivenExperiment", "\[Equal]", "\"\<Cylinder\>\""}], "||", 
    RowBox[{
    "GeometryGivenExperiment", "\[Equal]", "\"\<Annular cylinder\>\""}]}], 
   ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\"\<Orientation of the detector cross section wrt beamline\>\"", ",", 
        "\"\<Decay volume geometry type\>\"", ",", 
        "\"\<\!\(\*FractionBox[SubscriptBox[\(l\), \(to\\\ fid\)], \(m\)]\)\>\
\"", ",", "\"\<\!\(\*FractionBox[SubscriptBox[\(l\), \(fid\)], \(m\)]\)\>\"", 
        ",", "\"\<\!\(\*FractionBox[SubscriptBox[\(l\), \(fid + det\)], \
\(m\)]\)\>\"", ",", 
        "\"\<\!\(\*FractionBox[SubscriptBox[\(R\), \(inner, dec\\\ vol\)], \
\(m\)]\)\>\"", ",", 
        "\"\<\!\(\*FractionBox[SubscriptBox[\(R\), \(outer, dec\\\ vol\)], \
\(m\)]\)\>\"", ",", 
        "\"\<\!\(\*FractionBox[SubscriptBox[\(R\), \(inner, det\)], \
\(m\)]\)\>\"", ",", 
        "\"\<\!\(\*FractionBox[SubscriptBox[\(R\), \(outer, det\)], \
\(m\)]\)\>\"", ",", 
        "\"\<\!\(\*FractionBox[SubscriptBox[\(\[Theta]\), \(min, decay\\\ \
volume\)], \(rad\)]\)\>\"", ",", 
        "\"\<\!\(\*FractionBox[SubscriptBox[\(\[Theta]\), \(max, decay\\\ \
volume\)], \(rad\)]\)\>\"", ",", 
        "\"\<\!\(\*FractionBox[SubscriptBox[\(\[Theta]\), \(min, det\)], \
\(rad\)]\)\>\"", ",", 
        "\"\<\!\(\*FractionBox[SubscriptBox[\(\[Theta]\), \(max, det\)], \
\(rad\)]\)\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "DetectorPlaneOrientationGivenExperiment", ",", 
        "GeometryGivenExperiment", ",", "zToDecayVolumeGivenExperiment", ",", 
        "zFidGivenExperiment", ",", "xLongMaxDetectorGivenExperiment", ",", 
        RowBox[{"RinnerDecayVolumeGivenExperiment", "[", "z", "]"}], ",", 
        RowBox[{"RouterDecayVolumeGivenExperiment", "[", "z", "]"}], ",", 
        "RinnerDetectorGivenExperiment", ",", "RouterDetectorGivenExperiment",
         ",", "ThetaDecVolGivenExperimentMin", ",", 
        "ThetaDecVolGivenExperimentMax", ",", "ThetaDetGivenExperimentMin", 
        ",", "ThetaDetGivenExperimentMax"}], "}"}]}], "}"}], "//", 
    "TableForm"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\"\<Orientation of the detector cross section wrt beamline\>\"", ",", 
        "\"\<Decay volume geometry type\>\"", ",", 
        "\"\<\!\(\*FractionBox[SubscriptBox[\(l\), \(to\\\ fid\)], \(m\)]\)\>\
\"", ",", "\"\<\!\(\*FractionBox[SubscriptBox[\(l\), \(fid\)], \(m\)]\)\>\"", 
        ",", "\"\<\!\(\*FractionBox[SubscriptBox[\(l\), \(fid + det\)], \
\(m\)]\)\>\"", ",", 
        "\"\<\!\(\*FractionBox[SubscriptBox[\(\[CapitalDelta]x\), \(1\\\ dec \
. vol . \)], \(m\)]\)\>\"", ",", 
        "\"\<\!\(\*FractionBox[SubscriptBox[\(\[CapitalDelta]x\), \(2\\\ dec \
. vol . \)], \(m\)]\)\>\"", ",", 
        "\"\<\!\(\*FractionBox[SubscriptBox[\(\[CapitalDelta]x\), \(1 \( \
det\(.\)\)\)], \(m\)]\)\>\"", ",", 
        "\"\<\!\(\*FractionBox[SubscriptBox[\(\[CapitalDelta]x\), \(2 \( \
det\(.\)\)\)], \(m\)]\)\>\"", ",", 
        "\"\<\!\(\*FractionBox[SubscriptBox[\(\[Theta]\), \(min, decay\\\ \
volume\)], \(rad\)]\)\>\"", ",", 
        "\"\<\!\(\*FractionBox[SubscriptBox[\(\[Theta]\), \(max, decay\\\ \
volume\)], \(rad\)]\)\>\"", ",", 
        "\"\<\!\(\*FractionBox[SubscriptBox[\(\[Theta]\), \(min, det\)], \
\(rad\)]\)\>\"", ",", 
        "\"\<\!\(\*FractionBox[SubscriptBox[\(\[Theta]\), \(max, det\)], \
\(rad\)]\)\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "DetectorPlaneOrientationGivenExperiment", ",", 
        "GeometryGivenExperiment", ",", "zToDecayVolumeGivenExperiment", ",", 
        "zFidGivenExperiment", ",", "xLongMaxDetectorGivenExperiment", ",", 
        RowBox[{"dxDecayVolumeGivenExperiment", "[", "z", "]"}], ",", 
        RowBox[{"dyDecayVolumeGivenExperiment", "[", "z", "]"}], ",", 
        "dxDetectorGivenExperimentMax", ",", "dyDetectorGivenExperimentMax", 
        ",", "ThetaDecVolGivenExperimentMin", ",", 
        "ThetaDecVolGivenExperimentMax", ",", "ThetaDetGivenExperimentMin", 
        ",", "ThetaDetGivenExperimentMax"}], "}"}]}], "}"}], "//", 
    "TableForm"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "Print", "[", 
   "\"\<Experiment geometry. Black point - collision point. The blue domain - \
decay volume. The red domain - detector. The green plane - final plane:\>\"", 
   "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Block", " ", "defining", " ", "relevant", " ", "plots"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"ExperimentPlots", ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"R\[Theta]minDecayVolume", ",", "R\[Theta]maxDecayVolume"}], 
       "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"GivenExperimentBoundaries", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"GivenExperimentBoundaries", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"R\[Theta]minEndDetector", ",", "R\[Theta]maxEndDetector"}], 
       "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
          "DecayVolumeAsDetectorGivenExperiment", "\[Equal]", 
           "\"\<False\>\""}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"GivenExperimentBoundaries", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
          "DecayVolumeAsDetectorGivenExperiment", "\[Equal]", 
           "\"\<False\>\""}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"GivenExperimentBoundaries", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"BoxRatioz", "=", "3"}], ";", "\[IndentingNewLine]", 
     RowBox[{"PlotOrigin", "=", 
      RowBox[{"(*", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
         "DecayVolumeAsDetectorGivenExperiment", "\[Equal]", 
          "\"\<False\>\""}], ","}]}], "*)"}], 
      RowBox[{"Graphics3D", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PointSize", "[", "0.05", "]"}], ",", "Black", ",", 
          RowBox[{"Point", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], "]"}]}], "}"}], ",", 
        RowBox[{"Axes", "\[Rule]", "True"}], ",", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"\"\<x\>\"", ",", "24", ",", "Bold", ",", "Black"}], 
            "]"}], ",", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<y\>\"", ",", "24", ",", "Bold", ",", "Black"}], 
            "]"}], ",", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<z\>\"", ",", "24", ",", "Bold", ",", "Black"}], 
            "]"}]}], "}"}]}], ",", 
        RowBox[{"AxesOrigin", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
        RowBox[{"ViewProjection", "\[Rule]", "\"\<Orthographic\>\""}], ",", 
        RowBox[{"ViewCenter", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
        RowBox[{"ViewPoint", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "0.7"}], ",", "0.25", ",", 
           RowBox[{"-", "2"}]}], "}"}]}], ",", 
        RowBox[{"ViewVertical", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ",", 
        RowBox[{"BoxRatios", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "BoxRatioz"}], "}"}]}], ",", 
        RowBox[{"AxesStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Thickness", "[", "0.03", "]"}], "}"}]}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", "20"}], "]"}], "}"}]}]}], "]"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{",", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"PointSize", "[", "0.05", "]"}], ",", "Black", ",", 
            RowBox[{"Point", "[", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0"}], "}"}], "]"}]}], "}"}], ",", 
          RowBox[{"Axes", "\[Rule]", "True"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<x\>\"", ",", "24", ",", "Bold", ",", "Black"}], 
              "]"}], ",", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<y\>\"", ",", "24", ",", "Bold", ",", "Black"}], 
              "]"}], ",", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<z\>\"", ",", "24", ",", "Bold", ",", "Black"}], 
              "]"}]}], "}"}]}], ",", 
          RowBox[{"AxesOrigin", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
          RowBox[{"ViewProjection", "\[Rule]", "\"\<Orthographic\>\""}], ",", 
          RowBox[{"ViewCenter", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
          RowBox[{"ViewPoint", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "0.7"}], ",", "0.25", ",", 
             RowBox[{"-", "2"}]}], "}"}]}], ",", 
          RowBox[{"ViewVertical", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ",", 
          RowBox[{"BoxRatios", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", "BoxRatioz"}], "}"}]}], ",", 
          RowBox[{"AxesStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Thickness", "[", "0.03", "]"}], "}"}]}], ",", 
          RowBox[{"LabelStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Directive", "[", 
             RowBox[{"Black", ",", "20"}], "]"}], "}"}]}]}], "]"}]}], "]"}], 
      "*)"}], ";", "\[IndentingNewLine]", 
     RowBox[{"PlotDecayVolume", "=", 
      RowBox[{"Region", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"DecayVolumeGeometryGivenExperiment", ",", "Blue", ",", 
          RowBox[{"Opacity", "[", "0.2", "]"}], ",", 
          RowBox[{"EdgeForm", "[", 
           RowBox[{"{", 
            RowBox[{"Thick", ",", "Blue"}], "}"}], "]"}]}], "]"}], ",", 
        RowBox[{"BoxRatios", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "BoxRatioz"}], "}"}]}], ",", 
        RowBox[{"Boxed", "\[Rule]", "True"}], ",", 
        RowBox[{"Axes", "\[Rule]", "True"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotDetector", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
        "DecayVolumeAsDetectorGivenExperiment", "\[Equal]", "\"\<False\>\""}],
         ",", 
        RowBox[{"Region", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"DetectorGeometryGivenExperiment", ",", "Red", ",", 
            RowBox[{"Opacity", "[", "0.3", "]"}], ",", 
            RowBox[{"EdgeForm", "[", 
             RowBox[{"{", 
              RowBox[{"Thick", ",", "Red"}], "}"}], "]"}]}], "]"}], ",", 
          RowBox[{"BoxRatios", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", "BoxRatioz"}], "}"}]}], ",", 
          RowBox[{"Boxed", "\[Rule]", "True"}], ",", 
          RowBox[{"Axes", "\[Rule]", "True"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotFullGeometry", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
        "DecayVolumeAsDetectorGivenExperiment", "\[Equal]", "\"\<False\>\""}],
         ",", 
        RowBox[{"Show", "[", 
         RowBox[{"PlotOrigin", ",", "PlotDecayVolume", ",", "PlotDetector"}], 
         "]"}], ",", 
        RowBox[{"Show", "[", 
         RowBox[{"PlotOrigin", ",", "PlotDecayVolume"}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Plot\[Theta]minmaxDecayVolume", "=", 
      RowBox[{"Show", "[", 
       RowBox[{"PlotOrigin", ",", "PlotDecayVolume", ",", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Black", ",", 
            RowBox[{"Arrowheads", "[", "Large", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], "@@@", 
                "R\[Theta]minDecayVolume"}]}], "}"}], "]"}], ",", "Thick", 
            ",", 
            RowBox[{"Darker", "@", 
             RowBox[{"Darker", "@", "Green"}]}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], "@@@", 
                "R\[Theta]maxDecayVolume"}]}], "}"}], "]"}]}], "}"}], ",", 
          RowBox[{"ViewPoint", "\[Rule]", "Right"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Plot\[Theta]minmaxDetector", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
        "DecayVolumeAsDetectorGivenExperiment", "\[Equal]", "\"\<False\>\""}],
         ",", 
        RowBox[{"Show", "[", 
         RowBox[{"PlotOrigin", ",", "PlotDetector", ",", 
          RowBox[{"Graphics3D", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Thick", ",", "Black", ",", 
              RowBox[{"Arrowheads", "[", "Large", "]"}], ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y", ",", "z"}], "}"}], "@@@", 
                  "R\[Theta]minEndDetector"}]}], "}"}], "]"}], ",", "Thick", 
              ",", 
              RowBox[{"Darker", "@", 
               RowBox[{"Darker", "@", "Green"}]}], ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y", ",", "z"}], "}"}], "@@@", 
                  "R\[Theta]maxEndDetector"}]}], "}"}], "]"}]}], "}"}], ",", 
            RowBox[{"ViewPoint", "\[Rule]", "Right"}]}], "]"}]}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
       "DecayVolumeAsDetectorGivenExperiment", "\[Equal]", "\"\<False\>\""}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
        "PlotFullGeometry", ",", "Plot\[Theta]minmaxDecayVolume", ",", 
         "Plot\[Theta]minmaxDetector"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"PlotFullGeometry", ",", "Plot\[Theta]minmaxDecayVolume"}], 
        "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expplots", "=", "ExperimentPlots"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"expplots", "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<Plots checking the correctness of evaluation of \!\(\*SubscriptBox[\(\
\[Theta]\), \(min\)]\), \!\(\*SubscriptBox[\(\[Theta]\), \(max\)]\) of \
detector and decay volume. The coordinates defining these angles are shown by \
arrows (black - \!\(\*SubscriptBox[\(\[Theta]\), \(min\)]\), green - \
\!\(\*SubscriptBox[\(\[Theta]\), \(max\)]\)):\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"expplots", "[", 
  RowBox[{"[", "2", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
   "DecayVolumeAsDetectorGivenExperiment", "\[Equal]", "\"\<False\>\""}], ",", 
   RowBox[{"expplots", "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.896518016026824*^9, 3.89651803620957*^9}, {
  3.9152641902219653`*^9, 3.9152641902289467`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[148]:=",ExpressionUUID->"ea795165-d9bf-45bf-9479-cded8e0281dd"],

Cell[BoxData[{
 RowBox[{"ExperimentPlots", ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"R\[Theta]minDecayVolume", ",", "R\[Theta]maxDecayVolume"}], 
       "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"GivenExperimentBoundaries", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"GivenExperimentBoundaries", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"R\[Theta]minEndDetector", ",", "R\[Theta]maxEndDetector"}], 
       "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
          "DecayVolumeAsDetectorGivenExperiment", "\[Equal]", 
           "\"\<False\>\""}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"GivenExperimentBoundaries", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
          "DecayVolumeAsDetectorGivenExperiment", "\[Equal]", 
           "\"\<False\>\""}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"GivenExperimentBoundaries", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"BoxRatioz", "=", "3"}], ";", "\[IndentingNewLine]", 
     RowBox[{"PlotOrigin", "=", 
      RowBox[{"(*", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
         "DecayVolumeAsDetectorGivenExperiment", "\[Equal]", 
          "\"\<False\>\""}], ","}]}], "*)"}], 
      RowBox[{"Graphics3D", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PointSize", "[", "0.05", "]"}], ",", "Black", ",", 
          RowBox[{"Point", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], "]"}]}], "}"}], ",", 
        RowBox[{"Axes", "\[Rule]", "True"}], ",", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"\"\<x\>\"", ",", "24", ",", "Bold", ",", "Black"}], 
            "]"}], ",", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<y\>\"", ",", "24", ",", "Bold", ",", "Black"}], 
            "]"}], ",", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<z\>\"", ",", "24", ",", "Bold", ",", "Black"}], 
            "]"}]}], "}"}]}], ",", 
        RowBox[{"AxesOrigin", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
        RowBox[{"ViewProjection", "\[Rule]", "\"\<Orthographic\>\""}], ",", 
        RowBox[{"ViewCenter", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
        RowBox[{"ViewPoint", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "0.7"}], ",", "0.25", ",", 
           RowBox[{"-", "2"}]}], "}"}]}], ",", 
        RowBox[{"ViewVertical", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ",", 
        RowBox[{"BoxRatios", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "BoxRatioz"}], "}"}]}], ",", 
        RowBox[{"AxesStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Thickness", "[", "0.03", "]"}], "}"}]}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", "20"}], "]"}], "}"}]}]}], "]"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{",", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"PointSize", "[", "0.05", "]"}], ",", "Black", ",", 
            RowBox[{"Point", "[", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0"}], "}"}], "]"}]}], "}"}], ",", 
          RowBox[{"Axes", "\[Rule]", "True"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<x\>\"", ",", "24", ",", "Bold", ",", "Black"}], 
              "]"}], ",", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<y\>\"", ",", "24", ",", "Bold", ",", "Black"}], 
              "]"}], ",", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<z\>\"", ",", "24", ",", "Bold", ",", "Black"}], 
              "]"}]}], "}"}]}], ",", 
          RowBox[{"AxesOrigin", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
          RowBox[{"ViewProjection", "\[Rule]", "\"\<Orthographic\>\""}], ",", 
          RowBox[{"ViewCenter", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
          RowBox[{"ViewPoint", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "0.7"}], ",", "0.25", ",", 
             RowBox[{"-", "2"}]}], "}"}]}], ",", 
          RowBox[{"ViewVertical", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ",", 
          RowBox[{"BoxRatios", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", "BoxRatioz"}], "}"}]}], ",", 
          RowBox[{"AxesStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Thickness", "[", "0.03", "]"}], "}"}]}], ",", 
          RowBox[{"LabelStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Directive", "[", 
             RowBox[{"Black", ",", "20"}], "]"}], "}"}]}]}], "]"}]}], "]"}], 
      "*)"}], ";", "\[IndentingNewLine]", 
     RowBox[{"PlotDecayVolume", "=", 
      RowBox[{"Region", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"DecayVolumeGeometryGivenExperiment", ",", "Blue", ",", 
          RowBox[{"Opacity", "[", "0.2", "]"}]}], 
         RowBox[{"(*", 
          RowBox[{",", 
           RowBox[{"EdgeForm", "[", 
            RowBox[{"{", 
             RowBox[{"Thick", ",", "Blue"}], "}"}], "]"}]}], "*)"}], "]"}], 
        ",", 
        RowBox[{"BoxRatios", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "BoxRatioz"}], "}"}]}], ",", 
        RowBox[{"Boxed", "\[Rule]", "True"}], ",", 
        RowBox[{"Axes", "\[Rule]", "True"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotDetector", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
        "DecayVolumeAsDetectorGivenExperiment", "\[Equal]", "\"\<False\>\""}],
         ",", 
        RowBox[{"Region", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"DetectorGeometryGivenExperiment", ",", "Red", ",", 
            RowBox[{"Opacity", "[", "0.3", "]"}], ",", 
            RowBox[{"EdgeForm", "[", 
             RowBox[{"{", 
              RowBox[{"Thick", ",", "Red"}], "}"}], "]"}]}], "]"}], ",", 
          RowBox[{"BoxRatios", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", "BoxRatioz"}], "}"}]}], ",", 
          RowBox[{"Boxed", "\[Rule]", "True"}], ",", 
          RowBox[{"Axes", "\[Rule]", "True"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotFullGeometry", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
        "DecayVolumeAsDetectorGivenExperiment", "\[Equal]", "\"\<False\>\""}],
         ",", 
        RowBox[{"Show", "[", 
         RowBox[{"PlotOrigin", ",", "PlotDecayVolume", ",", "PlotDetector"}], 
         "]"}], ",", 
        RowBox[{"Show", "[", 
         RowBox[{"PlotOrigin", ",", "PlotDecayVolume"}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Plot\[Theta]minmaxDecayVolume", "=", 
      RowBox[{"Show", "[", 
       RowBox[{"PlotOrigin", ",", "PlotDecayVolume", ",", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Black", ",", 
            RowBox[{"Arrowheads", "[", "Large", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], "@@@", 
                "R\[Theta]minDecayVolume"}]}], "}"}], "]"}], ",", "Thick", 
            ",", 
            RowBox[{"Darker", "@", 
             RowBox[{"Darker", "@", "Green"}]}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], "@@@", 
                "R\[Theta]maxDecayVolume"}]}], "}"}], "]"}]}], "}"}], ",", 
          RowBox[{"ViewPoint", "\[Rule]", "Right"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Plot\[Theta]minmaxDetector", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
        "DecayVolumeAsDetectorGivenExperiment", "\[Equal]", "\"\<False\>\""}],
         ",", 
        RowBox[{"Show", "[", 
         RowBox[{"PlotOrigin", ",", "PlotDetector", ",", 
          RowBox[{"Graphics3D", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Thick", ",", "Black", ",", 
              RowBox[{"Arrowheads", "[", "Large", "]"}], ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y", ",", "z"}], "}"}], "@@@", 
                  "R\[Theta]minEndDetector"}]}], "}"}], "]"}], ",", "Thick", 
              ",", 
              RowBox[{"Darker", "@", 
               RowBox[{"Darker", "@", "Green"}]}], ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y", ",", "z"}], "}"}], "@@@", 
                  "R\[Theta]maxEndDetector"}]}], "}"}], "]"}]}], "}"}], ",", 
            RowBox[{"ViewPoint", "\[Rule]", "Right"}]}], "]"}]}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
       "DecayVolumeAsDetectorGivenExperiment", "\[Equal]", "\"\<False\>\""}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
        "PlotFullGeometry", ",", "Plot\[Theta]minmaxDecayVolume", ",", 
         "Plot\[Theta]minmaxDetector"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"PlotFullGeometry", ",", "Plot\[Theta]minmaxDecayVolume"}], 
        "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expplots", "=", "ExperimentPlots"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9015173466640315`*^9, 3.901517353494697*^9}},
 CellLabel->
  "In[153]:=",ExpressionUUID->"98cabff5-a6e9-4a6b-81ce-94345c2cf410"]
}, Closed]],

Cell[CellGroupData[{

Cell["Generating the grids \[Theta],z,E", "Subsection",
 CellChangeTimes->{{3.8965087245347147`*^9, 3.8965087323776274`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"22bfd06d-d1da-435d-af12-6d2c5b7dbaf5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Grid", " ", "of", " ", "energies", " ", "for", " ", "which", " ", "the", 
    " ", "decay", " ", "products", " ", "acceptance", " ", "will", " ", "be", 
    " ", "generated"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ELLPvaluesFacility", "[", "\"\<FermilabBD\>\"", "]"}], ":=", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "0.005", ",", "0.01", ",", "0.021", ",", "0.05", ",", "0.1", ",", 
         "0.25", ",", "0.5", ",", "0.75", ",", "1.", ",", "1.5", ",", "2.", 
         ",", "2.5", ",", "3.", ",", "3.5", ",", "4.", ",", "4.5", ",", 
         "5."}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         SuperscriptBox["10", "ELLP"], ",", 
         RowBox[{"{", 
          RowBox[{"ELLP", ",", 
           RowBox[{"Log10", "[", "5.5", "]"}], ",", 
           RowBox[{"Log10", "[", 
            RowBox[{"EmaxFacility", "[", "\"\<FermilabBD\>\"", "]"}], "]"}], 
           ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Log10", "[", 
               RowBox[{"EmaxFacility", "[", "\"\<FermilabBD\>\"", "]"}], 
               "]"}], "-", 
              RowBox[{"Log10", "[", "5.5", "]"}]}], ")"}], "/", "50"}]}], 
          "}"}]}], "]"}]}], "]"}], "//", "N"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ELLPvaluesFacility", "[", "\"\<SPS\>\"", "]"}], ":=", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "0.005", ",", "0.01", ",", "0.021", ",", "0.05", ",", "0.1", ",", 
         "0.25", ",", "0.5", ",", "0.75", ",", "1.", ",", "1.5", ",", "2.", 
         ",", "2.5", ",", "3.", ",", "3.5", ",", "4.", ",", "4.5", ",", 
         "5."}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         SuperscriptBox["10", "ELLP"], ",", 
         RowBox[{"{", 
          RowBox[{"ELLP", ",", 
           RowBox[{"Log10", "[", "5.5", "]"}], ",", 
           RowBox[{"Log10", "[", 
            RowBox[{"EmaxFacility", "[", "\"\<SPS\>\"", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Log10", "[", 
               RowBox[{"EmaxFacility", "[", "\"\<SPS\>\"", "]"}], "]"}], "-", 
              RowBox[{"Log10", "[", "5.5", "]"}]}], ")"}], "/", "50"}]}], 
          "}"}]}], "]"}]}], "]"}], "//", "N"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ELLPvaluesFacility", "[", "\"\<LHC\>\"", "]"}], ":=", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "0.005", ",", "0.01", ",", "0.021", ",", "0.05", ",", "0.1", ",", 
         "0.25", ",", "0.5", ",", "0.75", ",", "1.", ",", "1.5", ",", "2.", 
         ",", "2.5", ",", "3.", ",", "3.5", ",", "4.", ",", "4.5", ",", 
         "5."}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         SuperscriptBox["10", "ELLP"], ",", 
         RowBox[{"{", 
          RowBox[{"ELLP", ",", 
           RowBox[{"Log10", "[", "5.5", "]"}], ",", 
           RowBox[{"Log10", "[", "1000", "]"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Log10", "[", "1000", "]"}], "-", 
              RowBox[{"Log10", "[", "5.5", "]"}]}], ")"}], "/", "50"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         SuperscriptBox["10", "ELLP"], ",", 
         RowBox[{"{", 
          RowBox[{"ELLP", ",", 
           RowBox[{"Log10", "[", "1100.", "]"}], ",", 
           RowBox[{"Log10", "[", 
            RowBox[{"EmaxFacility", "[", "\"\<LHC\>\"", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Log10", "[", 
               RowBox[{"EmaxFacility", "[", "\"\<LHC\>\"", "]"}], "]"}], "-", 
              RowBox[{"Log10", "[", "1100.", "]"}]}], ")"}], "/", "30"}]}], 
          "}"}]}], "]"}]}], "]"}], "//", "N"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ELLPvaluesFacility", "[", "\"\<FCC-hh\>\"", "]"}], ":=", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "0.005", ",", "0.011", ",", "0.021", ",", "0.05", ",", "0.1", ",", 
         "0.25", ",", "0.5", ",", "0.75", ",", "1.", ",", "1.5", ",", "2.", 
         ",", "2.5", ",", "3.", ",", "3.5", ",", "4.", ",", "4.5", ",", 
         "5."}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         SuperscriptBox["10", "ELLP"], ",", 
         RowBox[{"{", 
          RowBox[{"ELLP", ",", 
           RowBox[{"Log10", "[", "5.5", "]"}], ",", 
           RowBox[{"Log10", "[", "1000", "]"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Log10", "[", "1000", "]"}], "-", 
              RowBox[{"Log10", "[", "5.5", "]"}]}], ")"}], "/", "30"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         SuperscriptBox["10", "ELLP"], ",", 
         RowBox[{"{", 
          RowBox[{"ELLP", ",", 
           RowBox[{"Log10", "[", "1100.", "]"}], ",", 
           RowBox[{"Log10", "[", "10000.", "]"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Log10", "[", "10000.", "]"}], "-", 
              RowBox[{"Log10", "[", "1100.", "]"}]}], ")"}], "/", "30"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         SuperscriptBox["10", "ELLP"], ",", 
         RowBox[{"{", 
          RowBox[{"ELLP", ",", 
           RowBox[{"Log10", "[", "11000.", "]"}], ",", 
           RowBox[{"Log10", "[", 
            RowBox[{"EmaxFacility", "[", "\"\<FCC-hh\>\"", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Log10", "[", 
               RowBox[{"EmaxFacility", "[", "\"\<FCC-hh\>\"", "]"}], "]"}], 
              "-", 
              RowBox[{"Log10", "[", "11000.", "]"}]}], ")"}], "/", "30"}]}], 
          "}"}]}], "]"}]}], "]"}], "//", "N"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
     "___", "___", "___", "___", "_"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Grid", " ", "of", " ", 
      SubscriptBox["\[Theta]", "LLP"]}], ",", 
     SubscriptBox["z", "LLP"]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
     "___", "___", "___", "___", "_"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalDelta]zVal", "[", "\[CapitalDelta]z_", "]"}], "=", 
     RowBox[{"Min", "[", 
      RowBox[{
       FractionBox["\[CapitalDelta]z", "10"], ",", 
       RowBox[{"Max", "[", 
        RowBox[{"0.5", ",", 
         RowBox[{"\[CapitalDelta]z", "/", "45."}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "If", " ", "the", " ", "experiment", " ", "is", " ", "symmetric", " ", 
      "wrt", " ", "the", " ", "z", " ", "axis"}], ",", " ", 
     RowBox[{
     "then", " ", "the", " ", "grid", " ", "is", " ", "made", " ", "only", 
      " ", "over", " ", "positive", " ", "values", " ", "of", " ", "z", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
        "this", " ", "does", " ", "not", " ", "affect", " ", "the", " ", 
         "detector", " ", "configuration"}], ")"}], ".", " ", "In"}], " ", 
      "the", " ", "end"}], ",", " ", 
     RowBox[{
     "the", " ", "number", " ", "of", " ", "events", " ", "is", " ", "just", 
      " ", "multiplied", " ", "by", " ", "2"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"zLLPrange", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"zToDecayVolumeGivenExperiment", "!=", 
        RowBox[{"-", "zLLPMaxGivenExperiment"}]}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"zLLP", ",", 
         RowBox[{"{", 
          RowBox[{
          "zLLP", ",", "zToDecayVolumeGivenExperiment", ",", 
           "zLLPMaxGivenExperiment", ",", 
           RowBox[{"\[CapitalDelta]zVal", "[", 
            RowBox[{
            "zLLPMaxGivenExperiment", "-", "zToDecayVolumeGivenExperiment"}], 
            "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"zLLP", ",", 
         RowBox[{"{", 
          RowBox[{"zLLP", ",", 
           SuperscriptBox["10", 
            RowBox[{"-", "5."}]], ",", "zLLPMaxGivenExperiment", ",", 
           RowBox[{"\[CapitalDelta]zVal", "[", 
            RowBox[{"zLLPMaxGivenExperiment", "-", 
             SuperscriptBox["10", 
              RowBox[{"-", "5."}]]}], "]"}]}], "}"}]}], "]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "If", " ", "the", " ", "experiment", " ", "is", " ", "symmetric", " ", 
      "wrt", " ", "the", " ", "z", " ", "axis"}], ",", " ", 
     RowBox[{
      RowBox[{
      "then", " ", "the", " ", "grid", " ", "is", " ", "made", " ", "only", 
       " ", "over", " ", "values", " ", "\[Theta]"}], "<", 
      RowBox[{
       FractionBox["Pi", "2"], " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
         "this", " ", "does", " ", "not", " ", "affect", " ", "the", " ", 
          "detector", " ", "configuration"}], ")"}], ".", " ", "In"}], " ", 
       "the", " ", "end"}]}], ",", " ", 
     RowBox[{
     "the", " ", "number", " ", "of", " ", "events", " ", "is", " ", "just", 
      " ", "multiplied", " ", "by", " ", "2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
        "positive", " ", "values", " ", "of", " ", "z", " ", "belong", " ", 
         "to", " ", "values", " ", "\[Theta]"}], " ", "<", " ", 
        FractionBox["Pi", "2"]}], ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]LLPrange", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"zToDecayVolumeGivenExperiment", "!=", 
        RowBox[{"-", "zLLPMaxGivenExperiment"}]}], ",", 
       RowBox[{"\[Theta]grid", "[", 
        RowBox[{
        "DecayVolumeAsDetectorGivenExperiment", ",", 
         "ThetaDecVolGivenExperimentMin", ",", 
         "ThetaDecVolGivenExperimentMax", ",", "ThetaDetGivenExperimentMin", 
         ",", "ThetaDetGivenExperimentMax"}], "]"}], ",", 
       RowBox[{"\[Theta]grid", "[", 
        RowBox[{
        "DecayVolumeAsDetectorGivenExperiment", ",", 
         "ThetaDecVolGivenExperimentMin", ",", 
         RowBox[{"0.999", 
          FractionBox["Pi", "2"]}], ",", "ThetaDetGivenExperimentMin", ",", 
         RowBox[{"0.999", 
          FractionBox["Pi", "2"]}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TableLLPgrid\[Theta]z", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Theta]LLP", ",", "zLLP"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Theta]LLP", ",", "\[Theta]LLPrange"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"zLLP", ",", "zLLPrange"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"List", " ", "of", " ", 
     SubscriptBox["E", "LLP"]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ELLPvalues", "=", 
     RowBox[{"ELLPvaluesFacility", "[", "FacilityGivenExperiment", "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9168899404313955`*^9, 3.9168899405725856`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[157]:=",ExpressionUUID->"aa654507-7d74-4953-9e3d-e34911a51922"]
}, Closed]],

Cell[CellGroupData[{

Cell["Azimuthal acceptance grid", "Subsection",
 CellChangeTimes->{{3.8965075492610145`*^9, 3.8965075531295843`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"ca72417d-b6ee-4d74-9da9-0591ae8c77a0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ROffAxisArb", "[", 
    RowBox[{"\[Theta]_", ",", "ztodet_"}], "]"}], "=", 
   RowBox[{"ztodet", "*", 
    RowBox[{"Tan", "[", "\[Theta]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ParticleAsimuthalCoverage", "[", 
    RowBox[{"ztodet_", ",", "\[Theta]_"}], "]"}], ":=", 
   RowBox[{"Circle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"ROffAxisArb", "[", 
      RowBox[{"\[Theta]", ",", "ztodet"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"regionintersection1", "[", 
    RowBox[{"\[Theta]_", ",", "z_"}], "]"}], ":=", 
   RowBox[{"RegionIntersection", "[", 
    RowBox[{
     RowBox[{"Region", "@", "ANUBISceilingProjectiveVolume2D"}], ",", 
     RowBox[{"ParticleAsimuthalCoverage", "[", 
      RowBox[{"z", ",", "\[Theta]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"regionintersection2", "[", 
    RowBox[{"\[Theta]_", ",", "z_"}], "]"}], ":=", 
   RowBox[{"RegionIntersection", "[", 
    RowBox[{
     RowBox[{"Region", "@", "ATLASvolume2D"}], ",", 
     RowBox[{"ParticleAsimuthalCoverage", "[", 
      RowBox[{"z", ",", "\[Theta]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"regdiff", "=", 
   RowBox[{"RegionDifference", "[", 
    RowBox[{"ANUBISceilingProjectiveVolume2D", ",", "ATLASvolume2D"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"regionintersection", "[", 
    RowBox[{"\[Theta]_", ",", "z_"}], "]"}], ":=", 
   RowBox[{"RegionIntersection", "[", 
    RowBox[{"regdiff", ",", 
     RowBox[{"ParticleAsimuthalCoverage", "[", 
      RowBox[{"z", ",", "\[Theta]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ArcEndpoints", "[", 
    RowBox[{"Circle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_"}], "}"}], ",", "r_", ",", 
      RowBox[{"{", 
       RowBox[{"a1_", ",", "a2_"}], "}"}]}], "]"}], "]"}], ":=", 
   RowBox[{"Point", "/@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x", "+", 
         RowBox[{"r", " ", 
          RowBox[{"Cos", "@", "a1"}]}]}], ",", 
        RowBox[{"y", "+", 
         RowBox[{"r", " ", 
          RowBox[{"Sin", "@", "a1"}]}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x", "+", 
         RowBox[{"r", " ", 
          RowBox[{"Cos", "@", "a2"}]}]}], ",", 
        RowBox[{"y", "+", 
         RowBox[{"r", " ", 
          RowBox[{"Sin", "@", "a2"}]}]}]}], "}"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ArcLengthValue", "[", 
    RowBox[{"\[Theta]_", ",", "z_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"RegionMeasure", "[", 
       RowBox[{"regionintersection", "[", 
        RowBox[{"\[Theta]", ",", "z"}], "]"}], "]"}], "\[Equal]", "0"}], ",", 
     "0", ",", 
     RowBox[{"ArcLength", "[", 
      RowBox[{"regionintersection", "[", 
       RowBox[{"\[Theta]", ",", "z"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NofPhiVals", "=", "20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BlockAcceptanceGivenZ", "[", 
   RowBox[{"\[Theta]val_", ",", "zval_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"regint", "=", 
      RowBox[{"regionintersection", "[", 
       RowBox[{"\[Theta]val", ",", "zval"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"regmes", "=", 
      RowBox[{"RegionMeasure", "[", "regint", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"regmes", "==", "0"}], ",", 
       RowBox[{"AzAcc", "=", "0"}], ",", 
       RowBox[{"AzAcc", "=", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"2", "*", "Pi"}]], 
         FractionBox[
          RowBox[{"ArcLength", "[", "regint", "]"}], 
          RowBox[{"ROffAxisArb", "[", 
           RowBox[{"\[Theta]val", ",", "zval"}], "]"}]]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"regmes", "==", "0"}], ",", 
       RowBox[{
        RowBox[{"randompoints", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[Theta]val", ",", "zval", ",", "0.", ",", 
             FractionBox["Pi", "3"]}], "}"}], ",", "20"}], "]"}]}], ";"}], 
       ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"randpts", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Phi]Val", "[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], "/@", 
          RowBox[{"Take", "[", 
           RowBox[{
            RowBox[{"RandomSample", "[", 
             RowBox[{"RandomPoint", "[", 
              RowBox[{"regint", ",", "1000"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "NofPhiVals"}], "}"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"randompoints", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[Theta]val", ",", "zval", ",", "AzAcc", ",", 
             RowBox[{"randpts", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "randpts", "]"}], ",", "1"}], "}"}]}], 
          "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "randompoints"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tabletest", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"ParallelTable", "[", 
       RowBox[{
        RowBox[{"BlockAcceptanceGivenZ", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"TableLLPgrid\[Theta]z", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"TableLLPgrid\[Theta]z", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "TableLLPgrid\[Theta]z", "]"}], ",", "1"}], 
         "}"}]}], "]"}], ",", "1"}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<Distribution of the generated points inside the decay volume:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ptsInsideAcceptance", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], 
         RowBox[{"Cos", "[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]], 
        RowBox[{"Sin", "[", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], 
        RowBox[{"Cos", "[", 
         RowBox[{"#", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "]"}]}], ",", 
       RowBox[{
        FractionBox[
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], 
         RowBox[{"Cos", "[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]], 
        RowBox[{"Sin", "[", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], 
        RowBox[{"Sin", "[", 
         RowBox[{"#", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "]"}]}], ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", 
    RowBox[{"Select", "[", 
     RowBox[{"tabletest", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "!=", "0"}], "&"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPointPlot3D", "[", "ptsInsideAcceptance", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt1", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{"tabletest", ",", 
       RowBox[{"Length", "[", "ELLPvalues", "]"}]}], "]"}], ",", "1"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt2", "=", 
   RowBox[{"Partition", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"ELLPvalues", ",", 
         RowBox[{"Length", "[", "tabletest", "]"}]}], "]"}], ",", "1"}], 
      "]"}], ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gridLLPtoDet", "=", 
   RowBox[{"SortBy", "[", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"tt1", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{"{", "1", "}"}]}], "]"}], "]"}], ",", "tt2", ",", 
       RowBox[{"tt1", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "3", ",", "4"}], "}"}]}], "]"}], "]"}], ",", 
       "2"}], "]"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"#", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gridReducedLLPtoDet", "=", 
   RowBox[{
    RowBox[{"DeleteDuplicatesBy", "[", 
     RowBox[{"gridLLPtoDet", ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"#", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}]}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"index\[Theta]LLP", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"indexELLP", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"indexzLLP", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"indexLLPazAcc", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"index\[Phi]LLP", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<\[Theta] grid:\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"thgrid", "=", 
  RowBox[{"DeleteDuplicates", "[", 
   RowBox[{"gridLLPtoDet", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<E grid:\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"egrid", "=", 
  RowBox[{"DeleteDuplicates", "[", 
   RowBox[{"gridLLPtoDet", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<z grid:\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"zgrid", "=", 
  RowBox[{"DeleteDuplicates", "[", 
   RowBox[{"gridLLPtoDet", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<The volume of the decay volume (in \!\(\*SuperscriptBox[\(m\), \
\(3\)]\)) calculated by the azimuthal acceptance (compare with the true \
volume obtained using simple formulas):\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"azaccdata", "=", 
   RowBox[{"gridReducedLLPtoDet", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "3", ",", "4"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"azacc", "[", 
     RowBox[{"th_", ",", "z_"}], "]"}], "=", 
    RowBox[{
     RowBox[{"Interpolation", "[", 
      RowBox[{
       RowBox[{"DeleteDuplicatesBy", "[", 
        RowBox[{"azaccdata", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}]}], "]"}], ",", 
       RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
     RowBox[{"th", ",", "z"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Factor", " ", "of", " ", "2", " ", "since", " ", "only", " ", "positive", 
    " ", "directions", " ", "of", " ", "z", " ", "are", " ", "considered", 
    " ", "for", " ", "the", " ", "azimuthal", " ", "acceptance"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"2", "*", 
  RowBox[{"NIntegrate", "[", 
   RowBox[{
    RowBox[{"2", "*", "Pi", "*", 
     RowBox[{"azacc", "[", 
      RowBox[{"th", ",", "z"}], "]"}], "*", 
     RowBox[{"Sin", "[", "th", "]"}], 
     FractionBox[
      SuperscriptBox["z", "2"], 
      SuperscriptBox[
       RowBox[{"Cos", "[", "th", "]"}], "3"]]}], ",", 
    RowBox[{"{", 
     RowBox[{"th", ",", 
      RowBox[{"thgrid", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"thgrid", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"z", ",", 
      RowBox[{"zgrid", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"zgrid", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.896507653913918*^9, 3.8965077147023244`*^9}, 
   3.896507748362897*^9, 3.8965083588746605`*^9, 3.8965086978146887`*^9, {
   3.8965087688063326`*^9, 3.896508775759497*^9}, {3.8965100670652742`*^9, 
   3.8965102027944093`*^9}, {3.8965102582438765`*^9, 
   3.8965102658897176`*^9}, {3.8965106299038754`*^9, 
   3.8965106374730573`*^9}, {3.896510730047154*^9, 3.896510741853551*^9}, {
   3.896510831193494*^9, 3.8965108546924253`*^9}, {3.896510886734076*^9, 
   3.8965110049720306`*^9}, {3.8965110369422417`*^9, 3.896511158762143*^9}, {
   3.8965112553621445`*^9, 3.8965112570932713`*^9}, {3.89651133657226*^9, 
   3.896511395732174*^9}, {3.896511692449272*^9, 3.896511830718872*^9}, {
   3.896511972285424*^9, 3.896511986756502*^9}, {3.8965120320028286`*^9, 
   3.896512104506608*^9}, {3.8965121369143686`*^9, 3.8965121664921036`*^9}, {
   3.896512208901437*^9, 3.8965122222620935`*^9}, {3.8965122673338156`*^9, 
   3.896512342753303*^9}, {3.8965124181922913`*^9, 3.8965124271324067`*^9}, {
   3.8965125181533546`*^9, 3.896512523293109*^9}, {3.896513058339391*^9, 
   3.896513058801564*^9}, {3.896513461656308*^9, 3.8965135443776383`*^9}, {
   3.896513805066285*^9, 3.8965138055660496`*^9}, {3.8965139313664813`*^9, 
   3.8965139321662674`*^9}, 3.896514165223583*^9, {3.896515630231923*^9, 
   3.8965156304613867`*^9}, {3.896681388628828*^9, 3.8966814237040763`*^9}, {
   3.9168899405882497`*^9, 3.9168899406668153`*^9}, {3.916897383123205*^9, 
   3.9168974076923857`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[166]:=",ExpressionUUID->"09e401fa-b97a-49df-9839-a035ce54d3dc"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Specifying cuts on the decay products", "Chapter",
 CellChangeTimes->{{3.877157217895995*^9, 3.877157230401365*^9}, {
  3.8850103814195557`*^9, 3.8850103821591024`*^9}, {3.89343655755689*^9, 
  3.893436569027972*^9}, {3.9142998030668216`*^9, 3.9142998104400644`*^9}},
 CellTags->{
  "Evaluation", 
   "Re-evaluation"},ExpressionUUID->"cb6c0023-7125-4cbc-bc54-76f66a6797fe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dropdownDialog", "[", 
    RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
   RowBox[{"DialogInput", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
     RowBox[{"Column", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
        RowBox[{"PopupMenu", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
        RowBox[{"Button", "[", 
         RowBox[{"\"\<OK\>\"", ",", 
          RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
      "]"}]}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"filenameGivenExperiment", "=", 
     RowBox[{"filenameExperiment", "[", 
      RowBox[{"finalPlaneGivenExperiment", ",", "GivenExperiment"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"filenameGivenExperimentzN", "=", 
     RowBox[{"filenameExperimentzN", "[", 
      RowBox[{"finalPlaneGivenExperiment", ",", "GivenExperiment"}], 
      "]"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<Experiment\>\"", ",", "\"\<Facility\>\"", ",", 
       "\"\<Decay volume as detector\>\"", ",", "\"\<If ECAL is present\>\"", 
       ",", "\"\<If dipole magnet is present\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(E\), \(LLP, max\)]\)\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "GivenExperiment", ",", "FacilityGivenExperiment", ",", 
       "DecayVolumeAsDetectorGivenExperiment", ",", 
       "ECALoptionGivenExperiment", ",", "DipoleMagnetOptionGivenExperiment", 
       ",", "EmaxGivenExperiment"}], "}"}]}], "}"}], "//", "TableForm"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"WhetherCutsTemp", "=", 
     RowBox[{"dropdownDialog", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<Yes\>\"", ",", "\"\<No\>\""}], "}"}], ",", 
       "\"\<Would you like to impose any cuts on acceptance of decay products \
other than geometric?\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"WhetherCuts", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"WhetherCutsTemp", "\[Equal]", "\"\<Yes\>\""}], ",", "1", ",", 
       "0"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
    "___", "___", "___", "___", "___", "___", "___", "_"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Imposing", " ", "cuts", " ", "on", " ", "decay", " ", "products"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
    "___", "___", "___", "___", "___", "___", "___", "_"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pTcutLowerZero", "=", "0."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pTcutUpperZero", "=", 
   SuperscriptBox["10", "10."]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eCutLowerZero", "=", "0."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eCutUpperZero", "=", 
   SuperscriptBox["10", "10."]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IPcutZero", "=", 
   SuperscriptBox["10", "10."]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AngSepCutZero", "=", "0."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SScutZero", "=", "0."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minvCutLowerZero", "=", "0."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minvCutUpperZero", "=", 
   SuperscriptBox["10", "10."]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eTotCutLowerZero", "=", "0."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eTotCutUpperZero", "=", 
   SuperscriptBox["10", "10."]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "pTelCutLower", ",", "pTelCutUpper", ",", "pT\[Mu]CutLower", ",", 
     "pT\[Mu]CutUpper", ",", "pThadrCutLower", ",", "pThadrCutUpper", ",", 
     "eElCutLower", ",", "eElCutUpper", ",", "e\[Mu]CutLower", ",", 
     "e\[Mu]CutUpper", ",", "eHadrCutLower", ",", "eHadrCutUpper", ",", 
     "EtotElCutLower", ",", "EtotElCutUpper", ",", "Etot\[Mu]CutLower", ",", 
     "Etot\[Mu]CutUpper", ",", "EtotHadrCutLower", ",", "EtotHadrCutUpper", 
     ",", "EtotMixedCutLower", ",", "EtotMixedCutUpper", ",", 
     "e\[Gamma]CutLower", ",", "e\[Gamma]CutUpper", ",", "eh0CutLower", ",", 
     "eh0CutUpper", ",", "Etot\[Gamma]\[Gamma]CutLower", ",", 
     "Etot\[Gamma]\[Gamma]CutUpper", ",", "Etoth0h0CutLower", ",", 
     "Etoth0h0CutUpper", ",", "EtotMixedNeutralCutLower", ",", 
     "EtotMixedNeutralCutUpper", ",", "IPcut", ",", "AngSepCut", ",", 
     "AngSepCutCharged", ",", "SScutCharged", ",", "SScutNeutral", ",", 
     "minvElCutLower", ",", "minvElCutUpper", ",", "minv\[Mu]CutLower", ",", 
     "minv\[Mu]CutUpper", ",", "minvHadrCutLower", ",", "minvHadrCutUpper", 
     ",", "minvMixedCutLower", ",", "minvMixedCutUpper", ",", 
     "minv\[Gamma]\[Gamma]CutLower", ",", "minv\[Gamma]\[Gamma]CutUpper", ",",
      "minvh0h0CutLower", ",", "minvh0h0CutUpper", ",", 
     "minvMixedNeutralCutLower", ",", "minvMixedNeutralCutUpper"}], "}"}], "//",
    "Clear"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"choice", "=", 
   RowBox[{"{", "\"\<All\>\"", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DynamicModule", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "inputValues", ",", "labels", ",", "symbols", ",", "inputFields", ",", 
      "submitButton"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"labels", "=", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Min/max \!\(\*SubscriptBox[\(p\), \(T\)]\) range of each charged \
decay product, in the form {\!\(\*SubscriptBox[\(p\), \(T, min\)]\), \
\!\(\*SubscriptBox[\(p\), \(T, max\)]\)}, for \!\(\*SuperscriptBox[\(e\), \(+\
\(/\(-\)\)\)]\), (1st bracket), \!\(\*SuperscriptBox[\(\[Mu]\), \(+\(/\(-\)\)\
\)]\) (2nd), hadrons \!\(\*SuperscriptBox[\(h\), \(+\(/\(-\)\)\)]\) \
(3rd)\>\"", ",", 
        "\"\<Min/max energy of each charged decay product, in the form \
{\!\(\*SubscriptBox[\(E\), \(min\)]\), \!\(\*SubscriptBox[\(E\), \(max\)]\)}, \
for \!\(\*SuperscriptBox[\(e\), \(+\(/\(-\)\)\)]\) (1st bracket), \
\!\(\*SuperscriptBox[\(\[Mu]\), \(+\(/\(-\)\)\)]\) (2nd), \
\!\(\*SuperscriptBox[\(h\), \(+\(/\(-\)\)\)]\) (3rd)\>\"", ",", 
        "\"\<Min/max total energy of two charged products, in the form \
{\!\(\*SubscriptBox[\(E\), \(min\)]\), \!\(\*SubscriptBox[\(E\), \(max\)]\)}, \
for \!\(\*SuperscriptBox[\(e\), \(+\)]\)\!\(\*SuperscriptBox[\(e\), \(-\)]\) \
(1st bracket), \!\(\*SuperscriptBox[\(\[Mu]\), \
\(+\)]\)\!\(\*SuperscriptBox[\(\[Mu]\), \(-\)]\) (2nd), \!\(\*SuperscriptBox[\
\(h\), \(+\)]\)\!\(\*SuperscriptBox[\(h\), \(-\)]\) (3rd), and mixed \
(4th)\>\"", ",", 
        "\"\<Min/max energy of each neutral product, in the form \
{\!\(\*SubscriptBox[\(E\), \(min\)]\), \!\(\*SubscriptBox[\(E\), \(max\)]\)}, \
for \[Gamma] (1st bracket) and neutral hadrons \!\(\*SuperscriptBox[\(h\), \
\(0\)]\) (2nd)\>\"", ",", 
        "\"\<Min/max total energy of a neutral pair, in the form \
{\!\(\*SubscriptBox[\(E\), \(min\)]\), \!\(\*SubscriptBox[\(E\), \(max\)]\)}, \
for \[Gamma]\[Gamma] (1st), \!\(\*SuperscriptBox[\(h\), \
\(0\)]\)\!\(\*SuperscriptBox[\(h\), \(0\)]\) (2nd), mixed (3rd)\>\"", ",", 
        "\"\<Transerse impact parameter cut from above for charged tracks (in \
m)\>\"", ",", 
        "\"\<Angular cut from below for photons/charged particles (in \
radians)\>\"", ",", "\[IndentingNewLine]", 
        "\"\<Transverse spatial separation cut from below for photons/charged \
particles (in m)\>\"", ",", 
        "\"\<Enter the lower and upper invariant mass cut for the two charged \
products, in the form {\!\(\*SubscriptBox[\(m\), \(inv, lower\)]\), \
\!\(\*SubscriptBox[\(m\), \(inv, upper\)]\)}, for \!\(\*SuperscriptBox[\(e\), \
\(+\)]\)\!\(\*SuperscriptBox[\(e\), \(-\)]\) (1st), \!\(\*SuperscriptBox[\(\
\[Mu]\), \(+\)]\)\!\(\*SuperscriptBox[\(\[Mu]\), \(-\)]\) (2nd), \
\!\(\*SuperscriptBox[\(h\), \(+\)]\)\!\(\*SuperscriptBox[\(h\), \(-\)]\) \
(3rd), mixed (4th)\>\"", ",", 
        "\"\<Enter the lower and upper invariant mass cut for the two neutral \
products, in the form {\!\(\*SubscriptBox[\(m\), \(inv, lower\)]\), \
\!\(\*SubscriptBox[\(m\), \(inv, upper\)]\)}, in the form \
{\!\(\*SubscriptBox[\(m\), \(inv, lower\)]\), \!\(\*SubscriptBox[\(m\), \
\(inv, upper\)]\)}, for \[Gamma]\[Gamma] (1st), \!\(\*SuperscriptBox[\(h\), \
\(0\)]\)\!\(\*SuperscriptBox[\(h\), \(0\)]\) (2nd), mixed (3rd)\>\""}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"inputValues", "=", 
      RowBox[{"zeros", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "999"}], ",", 
             RowBox[{"-", "999"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "999"}], ",", 
             RowBox[{"-", "999"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "999"}], ",", 
             RowBox[{"-", "999"}]}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "999"}], ",", 
             RowBox[{"-", "999"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "999"}], ",", 
             RowBox[{"-", "999"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "999"}], ",", 
             RowBox[{"-", "999"}]}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "999"}], ",", 
             RowBox[{"-", "999"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "999"}], ",", 
             RowBox[{"-", "999"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "999"}], ",", 
             RowBox[{"-", "999"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "999"}], ",", 
             RowBox[{"-", "999"}]}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "999"}], ",", 
             RowBox[{"-", "999"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "999"}], ",", 
             RowBox[{"-", "999"}]}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "999"}], ",", 
             RowBox[{"-", "999"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "999"}], ",", 
             RowBox[{"-", "999"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "999"}], ",", 
             RowBox[{"-", "999"}]}], "}"}]}], "}"}], ",", 
         RowBox[{"-", "999"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "999"}], ",", 
           RowBox[{"-", "999"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "999"}], ",", 
           RowBox[{"-", "999"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "999"}], ",", 
             RowBox[{"-", "999"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "999"}], ",", 
             RowBox[{"-", "999"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "999"}], ",", 
             RowBox[{"-", "999"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "999"}], ",", 
             RowBox[{"-", "999"}]}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "999"}], ",", 
             RowBox[{"-", "999"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "999"}], ",", 
             RowBox[{"-", "999"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "999"}], ",", 
             RowBox[{"-", "999"}]}], "}"}]}], "}"}]}], "}"}]}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"symbols", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"pTelCutLower", ",", "pTelCutUpper"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"pT\[Mu]CutLower", ",", "pT\[Mu]CutUpper"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"pThadrCutLower", ",", "pThadrCutUpper"}], "}"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"eElCutLower", ",", "eElCutUpper"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"e\[Mu]CutLower", ",", "e\[Mu]CutUpper"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"eHadrCutLower", ",", "eHadrCutUpper"}], "}"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"EtotElCutLower", ",", "EtotElCutUpper"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Etot\[Mu]CutLower", ",", "Etot\[Mu]CutUpper"}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"EtotHadrCutLower", ",", "EtotHadrCutUpper"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"EtotMixedCutLower", ",", "EtotMixedCutUpper"}], "}"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"e\[Gamma]CutLower", ",", "e\[Gamma]CutUpper"}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"eh0CutLower", ",", "eh0CutUpper"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "Etot\[Gamma]\[Gamma]CutLower", ",", 
            "Etot\[Gamma]\[Gamma]CutUpper"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Etoth0h0CutLower", ",", "Etoth0h0CutUpper"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "EtotMixedNeutralCutLower", ",", "EtotMixedNeutralCutUpper"}], 
           "}"}]}], "}"}], ",", "IPcut", ",", 
        RowBox[{"{", 
         RowBox[{"AngSepCut", ",", "AngSepCutCharged"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"SScutCharged", ",", "SScutNeutral"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"minvElCutLower", ",", "minvElCutUpper"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"minv\[Mu]CutLower", ",", "minv\[Mu]CutUpper"}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"minvHadrCutLower", ",", "minvHadrCutUpper"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"minvMixedCutLower", ",", "minvMixedCutUpper"}], "}"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "minv\[Gamma]\[Gamma]CutLower", ",", 
            "minv\[Gamma]\[Gamma]CutUpper"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"minvh0h0CutLower", ",", "minvh0h0CutUpper"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "minvMixedNeutralCutLower", ",", "minvMixedNeutralCutUpper"}], 
           "}"}]}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"zerosvalues", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"pTcutLowerZero", ",", "pTcutUpperZero"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"pTcutLowerZero", ",", "pTcutUpperZero"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"pTcutLowerZero", ",", "pTcutUpperZero"}], "}"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"eCutLowerZero", ",", "eCutUpperZero"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"eCutLowerZero", ",", "eCutUpperZero"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"eCutLowerZero", ",", "eCutUpperZero"}], "}"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"eCutLowerZero", ",", "eCutUpperZero"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"eCutLowerZero", ",", "eCutUpperZero"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"eCutLowerZero", ",", "eCutUpperZero"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"eCutLowerZero", ",", "eCutUpperZero"}], "}"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"eCutLowerZero", ",", "eCutUpperZero"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"eCutLowerZero", ",", "eCutUpperZero"}], "}"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"eCutLowerZero", ",", "eCutUpperZero"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"eCutLowerZero", ",", "eCutUpperZero"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"eCutLowerZero", ",", "eCutUpperZero"}], "}"}]}], "}"}], 
        ",", "IPcutZero", ",", 
        RowBox[{"{", 
         RowBox[{"AngSepCutZero", ",", "AngSepCutZero"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"SScutZero", ",", "SScutZero"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"minvCutLowerZero", ",", "minvCutUpperZero"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"minvCutLowerZero", ",", "minvCutUpperZero"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"minvCutLowerZero", ",", "minvCutUpperZero"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"minvCutLowerZero", ",", "minvCutUpperZero"}], "}"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"minvCutLowerZero", ",", "minvCutUpperZero"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"minvCutLowerZero", ",", "minvCutUpperZero"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"minvCutLowerZero", ",", "minvCutUpperZero"}], "}"}]}], 
         "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "inputValues", "]"}], "!=", 
        RowBox[{"Length", "[", "labels", "]"}], "!=", 
        RowBox[{"Length", "[", "symbols", "]"}]}], ",", 
       RowBox[{
        RowBox[{
        "MessageDialog", "[", 
         "\"\<Error: The number of initial values does not match the number \
of labels.\>\"", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"productionSelector", "=", 
      RowBox[{"Column", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{
           "\"\<Select the particles that are detectable at \>\"", " ", "<>", 
            "GivenExperiment", "<>", "\"\<:\>\""}], ",", "Bold"}], "]"}], ",", 
         RowBox[{"TogglerBar", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "choice", "]"}], ",", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "\"\<All\>\"", "}"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"ParamPDGidToProduct", "[", "#", "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Abs", "[", "DetectablePDGsGivenExperiment", "]"}], "//",
                 "DeleteDuplicates"}], ")"}]}]}], "]"}], ",", 
           RowBox[{"Appearance", "->", 
            RowBox[{"\"\<Horizontal\>\"", "->", 
             RowBox[{"{", 
              RowBox[{"5", ",", "20"}], "}"}]}]}]}], "]"}]}], "}"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"inputFields", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", "=", "i"}], "}"}], ",", 
          RowBox[{"Column", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"labels", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\<:\>\""}], ",", 
             RowBox[{"InputField", "[", 
              RowBox[{
               RowBox[{"Dynamic", "[", 
                RowBox[{"inputValues", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "Expression", 
               ",", 
               RowBox[{"FieldSize", "->", 
                RowBox[{"{", 
                 RowBox[{"40", ",", "Automatic"}], "}"}]}]}], "]"}]}], "}"}], 
           "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "labels", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"introphr", "=", 
      RowBox[{"{", 
       RowBox[{"Style", "[", 
        RowBox[{
        "\"\<Impose the cuts on decay products. If the given cut should not \
be imposed enter -999 for each value (default choice). All the \
energy/\!\(\*SubscriptBox[\(p\), \(T\)]\) cuts are in GeV\>\"", ",", "Bold"}],
         "]"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"submitButton", "=", 
      RowBox[{"Button", "[", 
       RowBox[{"\"\<Submit\>\"", ",", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"Flatten", "[", 
            RowBox[{"MapThread", "[", 
             RowBox[{"Set", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Flatten", "[", "symbols", "]"}], ",", 
                RowBox[{"MapThread", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"#1", "===", "#2"}], ",", "#3", ",", "#1"}], 
                    "]"}], "&"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Flatten", "[", "inputValues", "]"}], ",", 
                    RowBox[{"Flatten", "[", "zeros", "]"}], ",", 
                    RowBox[{"Flatten", "[", "zerosvalues", "]"}]}], "}"}]}], 
                 "]"}]}], "}"}]}], "]"}], "]"}]}], "]"}], ";", " ", 
         RowBox[{"DialogReturn", "[", "Null", "]"}]}], ",", 
        RowBox[{"ImageSize", "->", "Automatic"}]}], "]"}]}], ";", "\n", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"submitButton", "=", 
        RowBox[{"Button", "[", 
         RowBox[{"\"\<Submit\>\"", ",", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"Flatten", "[", 
              RowBox[{"MapThread", "[", 
               RowBox[{"Set", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Flatten", "[", 
                   RowBox[{"symbols", ",", "1"}], "]"}], ",", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{"inputValues", ",", "1"}], "]"}]}], "}"}]}], "]"}],
               "]"}]}], "]"}], ";", " ", 
           RowBox[{"DialogReturn", "[", "Null", "]"}]}], ",", 
          RowBox[{"ImageSize", "->", "Automatic"}]}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"DialogInput", "[", 
      RowBox[{"Column", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{
         "productionSelector", ",", "introphr", ",", "\"\< \>\"", ",", 
          "inputFields", ",", "submitButton"}], "}"}], "]"}], "]"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"choice", "==", 
      RowBox[{"{", "}"}]}], "||", 
     RowBox[{"MemberQ", "[", 
      RowBox[{"choice", ",", "\"\<All\>\""}], "]"}]}], ",", 
    RowBox[{"choice", "=", 
     RowBox[{"{", "\"\<All\>\"", "}"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"choice", "!=", 
     RowBox[{"{", "\"\<All\>\"", "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DetectablePDGsGivenExperimentTemp", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ParamProductToPDGid", "[", "#", "]"}], "&"}], "/@", 
         "choice"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"ParamProductToPDGid", "[", "#", "]"}]}], "&"}], "/@", 
         "choice"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DetectablePDGsGivenExperiment", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"DetectablePDGsGivenExperimentTemp", ",", 
          RowBox[{
           RowBox[{"FreeQ", "[", 
            RowBox[{
             RowBox[{"ParamPDGidToProduct", "[", "#", "]"}], ",", "Missing"}],
             "]"}], "&"}]}], "]"}], "//", "N"}], "//", "Sort"}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<List of PDGs of detectable particles:\>\"", 
  "]"}], "\[IndentingNewLine]", "DetectablePDGsGivenExperiment"}], "Input",
 CellChangeTimes->{{3.8862395123902965`*^9, 3.886239583049287*^9}, {
   3.8862614265933056`*^9, 3.886261427405651*^9}, {3.8863205546619196`*^9, 
   3.886320555235077*^9}, {3.886321463607978*^9, 3.886321464435209*^9}, {
   3.886321819423191*^9, 3.8863218206744995`*^9}, {3.886323160464417*^9, 
   3.886323162947709*^9}, {3.8863236963452435`*^9, 3.886323697877537*^9}, {
   3.8863246001448927`*^9, 3.88632463766989*^9}, 3.8863246738954725`*^9, {
   3.886406411833415*^9, 3.8864065245112395`*^9}, {3.8864073857936664`*^9, 
   3.8864073864221144`*^9}, {3.8864075159033737`*^9, 3.886407517965285*^9}, {
   3.8864082670760336`*^9, 3.8864082679023447`*^9}, {3.8864085032398806`*^9, 
   3.8864085043449306`*^9}, {3.8864111528778505`*^9, 3.886411155496108*^9}, {
   3.8864114351630583`*^9, 3.886411435949088*^9}, {3.8864116107952433`*^9, 
   3.8864116113448763`*^9}, {3.8864339822607136`*^9, 3.886433983114958*^9}, {
   3.8864356385769234`*^9, 3.886435640512048*^9}, {3.886435938327056*^9, 
   3.886435938790553*^9}, {3.8864360178252563`*^9, 3.8864360185983143`*^9}, {
   3.886477242021925*^9, 3.8864772433998175`*^9}, {3.886523046141382*^9, 
   3.886523046717943*^9}, {3.8869230035015373`*^9, 3.8869230043363614`*^9}, {
   3.886923134570159*^9, 3.886923135113418*^9}, {3.8871279473729877`*^9, 
   3.887127949272484*^9}, {3.8871290895488167`*^9, 3.887129090029354*^9}, {
   3.8871799986764126`*^9, 3.8871800009018803`*^9}, {3.887180401806629*^9, 
   3.887180402651722*^9}, {3.887186564600072*^9, 3.8871865669390526`*^9}, {
   3.88718705509645*^9, 3.887187057831586*^9}, {3.8872058711188154`*^9, 
   3.887205871638158*^9}, {3.88720693968042*^9, 3.887206941243812*^9}, {
   3.8872099692091823`*^9, 3.887209969671775*^9}, {3.887211413766818*^9, 
   3.8872114146200285`*^9}, {3.887211932832594*^9, 3.887211933282428*^9}, {
   3.887253582955886*^9, 3.887253584332303*^9}, {3.8872721877980585`*^9, 
   3.8872721885782585`*^9}, {3.8873380092349606`*^9, 3.887338010554838*^9}, {
   3.8875292303518243`*^9, 3.887529231201189*^9}, {3.8875302300157824`*^9, 
   3.887530233979493*^9}, {3.8875314760706687`*^9, 3.8875314773136625`*^9}, {
   3.8875335849124703`*^9, 3.887533585089736*^9}, {3.8875599973319736`*^9, 
   3.887560006568223*^9}, {3.887560183083761*^9, 3.887560187244735*^9}, {
   3.8875607209798946`*^9, 3.8875607534207225`*^9}, {3.887560882751191*^9, 
   3.8875608908330793`*^9}, {3.887612556360304*^9, 3.887612559072115*^9}, {
   3.887614321592123*^9, 3.887614367138612*^9}, {3.887615893819663*^9, 
   3.887615894504799*^9}, {3.8876160982844324`*^9, 3.887616099498848*^9}, {
   3.8876181134809046`*^9, 3.887618114215395*^9}, {3.8876182032892027`*^9, 
   3.8876182038265295`*^9}, {3.887632684483673*^9, 3.887632687213397*^9}, {
   3.887688870870682*^9, 3.887688871386403*^9}, {3.8877068944260893`*^9, 
   3.8877068956729803`*^9}, {3.887713922235078*^9, 3.887713922356718*^9}, {
   3.887734706053899*^9, 3.8877347103239484`*^9}, {3.8877730517046137`*^9, 
   3.8877730853334475`*^9}, 3.8877732608622713`*^9, 3.8877760717092247`*^9, {
   3.8883779829298964`*^9, 3.8883780022609177`*^9}, 3.8902923985687885`*^9, {
   3.8905554903814497`*^9, 3.890555539297676*^9}, {3.8932333535373397`*^9, 
   3.8932333538996873`*^9}, 3.893233409047794*^9, {3.8932334667095785`*^9, 
   3.8932334723722477`*^9}, {3.893233503285507*^9, 3.8932335134986534`*^9}, {
   3.893233566335312*^9, 3.8932335879818416`*^9}, {3.8932336695523367`*^9, 
   3.893233683999921*^9}, 3.8933148502437077`*^9, 3.893318177775519*^9, {
   3.8933257138387957`*^9, 3.893325753953617*^9}, {3.8933882501339645`*^9, 
   3.893388462123291*^9}, {3.893389104378008*^9, 3.89338918200423*^9}, {
   3.893391295379231*^9, 3.8933913047467933`*^9}, {3.893391774005262*^9, 
   3.893391949450411*^9}, {3.893391998289749*^9, 3.893392050613307*^9}, {
   3.893392099995363*^9, 3.8933925172343173`*^9}, {3.8933925655517592`*^9, 
   3.893392571091895*^9}, {3.8933926241527405`*^9, 3.89339263126077*^9}, {
   3.893396482427949*^9, 3.893396557784583*^9}, {3.893396684842353*^9, 
   3.89339683185153*^9}, {3.8934008462855034`*^9, 3.8934008812412148`*^9}, {
   3.8934009451730413`*^9, 3.8934009767352686`*^9}, {3.8934010296334505`*^9, 
   3.8934010458169637`*^9}, {3.893401227810811*^9, 3.8934012673432436`*^9}, {
   3.893401368763983*^9, 3.8934014794184704`*^9}, {3.8934016306534986`*^9, 
   3.893401683574726*^9}, {3.89340175460909*^9, 3.8934017655042048`*^9}, {
   3.893401911680187*^9, 3.8934019125186853`*^9}, {3.8934024675250006`*^9, 
   3.8934024877628546`*^9}, {3.893424455207156*^9, 3.89342452822206*^9}, 
   3.893424575738535*^9, {3.8934246627256737`*^9, 3.893424698855917*^9}, {
   3.893424743023193*^9, 3.893424768084998*^9}, 3.8934257236674004`*^9, {
   3.893427505839426*^9, 3.8934275330094557`*^9}, {3.8934276336290026`*^9, 
   3.893427749296693*^9}, {3.8934341740469685`*^9, 3.893434179798005*^9}, {
   3.89343435894029*^9, 3.893434363941669*^9}, {3.8934344505407686`*^9, 
   3.893434455434524*^9}, {3.893519727739212*^9, 3.8935197385631623`*^9}, {
   3.895036844613934*^9, 3.895036855852393*^9}, {3.8950369417490597`*^9, 
   3.8950371281437893`*^9}, {3.8950372487481894`*^9, 3.8950372857215843`*^9}, 
   3.8965201047712927`*^9, {3.8967777579414663`*^9, 3.89677786409251*^9}, {
   3.8968417251071415`*^9, 3.896841765657221*^9}, {3.8984950183436623`*^9, 
   3.8984950246396728`*^9}, {3.8985295634712677`*^9, 3.898529567165951*^9}, {
   3.902557780874288*^9, 3.902557866211647*^9}, {3.902557981591077*^9, 
   3.9025579899114265`*^9}, {3.9025580651307335`*^9, 
   3.9025580655245795`*^9}, {3.9055055560432*^9, 3.905505560023321*^9}, {
   3.9055056599476786`*^9, 3.9055060301765995`*^9}, {3.9055061089044313`*^9, 
   3.905506305001817*^9}, 3.9055063905154386`*^9, {3.9055064265331435`*^9, 
   3.9055064326573524`*^9}, {3.9055066588380513`*^9, 
   3.9055071436276817`*^9}, {3.9055071941592083`*^9, 3.905507211164139*^9}, {
   3.905507315895624*^9, 3.905507316493407*^9}, {3.9055073691145926`*^9, 
   3.905507388634494*^9}, {3.9055074900590167`*^9, 3.9055077968836594`*^9}, {
   3.9055078653773737`*^9, 3.9055079063743176`*^9}, {3.9055079527647085`*^9, 
   3.9055080343991404`*^9}, {3.905508064602247*^9, 3.90550806922855*^9}, {
   3.905508159514989*^9, 3.9055081925087376`*^9}, {3.9055082729539967`*^9, 
   3.905508285789571*^9}, {3.9055083498077765`*^9, 3.905508390561697*^9}, 
   3.905508636326395*^9, {3.905508720515654*^9, 3.905508741090497*^9}, {
   3.905508776264496*^9, 3.905508799594994*^9}, 3.9055088687281065`*^9, {
   3.9055090006067486`*^9, 3.9055090299962916`*^9}, {3.9055091990506625`*^9, 
   3.905509228935583*^9}, {3.9055133059477935`*^9, 3.9055134180618887`*^9}, {
   3.9055162936281137`*^9, 3.9055163339918346`*^9}, {3.905516372466316*^9, 
   3.905516395001636*^9}, {3.9055167599691935`*^9, 3.9055170276077876`*^9}, {
   3.905517093560919*^9, 3.905517128276893*^9}, {3.905517167605284*^9, 
   3.90551720728405*^9}, {3.9055173249495835`*^9, 3.905517463610935*^9}, {
   3.9055175344684167`*^9, 3.9055175388257294`*^9}, {3.905667436157593*^9, 
   3.905667446429618*^9}, {3.9056687008834505`*^9, 3.9056687347773666`*^9}, {
   3.90566878932382*^9, 3.9056688043407125`*^9}, 3.905668977395052*^9, {
   3.905698435153984*^9, 3.905698517308263*^9}, {3.905698587449051*^9, 
   3.9056985999462366`*^9}, {3.90569889782007*^9, 3.9056989233950152`*^9}, {
   3.9056989553937263`*^9, 3.9056989556711826`*^9}, {3.905699001817792*^9, 
   3.9056990433552065`*^9}, {3.9056991381411953`*^9, 3.905699138953631*^9}, {
   3.905699238730953*^9, 3.905699247996553*^9}, {3.905699318681655*^9, 
   3.9056993973629475`*^9}, {3.905699429773856*^9, 3.9056994698267784`*^9}, {
   3.905699507213558*^9, 3.9056995605584574`*^9}, 3.905699669695407*^9, {
   3.9056997158008184`*^9, 3.905699757496434*^9}, {3.905701028882305*^9, 
   3.9057010561009207`*^9}, {3.9057011769329095`*^9, 
   3.9057011857139206`*^9}, {3.91017392414937*^9, 3.9101740114218283`*^9}, {
   3.910174742576885*^9, 3.9101749789931145`*^9}, {3.9101750306192136`*^9, 
   3.910175047189313*^9}, {3.910175157104765*^9, 3.9101752837454495`*^9}, {
   3.9102493077384977`*^9, 3.9102493180035925`*^9}, {3.9120758694476604`*^9, 
   3.9120758914673357`*^9}, {3.9121574291635084`*^9, 
   3.9121574296657777`*^9}, {3.912158976542296*^9, 3.912158976887396*^9}, {
   3.91215901002857*^9, 3.912159082210735*^9}, {3.912159206427122*^9, 
   3.9121592340564437`*^9}, {3.9124985567534065`*^9, 3.91249859624119*^9}, {
   3.9125003299152737`*^9, 3.912500366952034*^9}, {3.912500455530143*^9, 
   3.912500537282131*^9}, {3.9125005745067015`*^9, 3.91250065419954*^9}, {
   3.9125006985872145`*^9, 3.9125008413616204`*^9}, {3.9125010892650733`*^9, 
   3.912501109139593*^9}, {3.9125011843572044`*^9, 3.9125012945604444`*^9}, {
   3.9125013293154144`*^9, 3.912501379242343*^9}, {3.9125014216242576`*^9, 
   3.9125014270295687`*^9}, {3.9125016764481564`*^9, 
   3.9125016864685464`*^9}, {3.9125017275300817`*^9, 
   3.9125017388542705`*^9}, {3.912501821474018*^9, 3.9125019663309126`*^9}, {
   3.912502010772153*^9, 3.912502016781851*^9}, {3.9125020800590415`*^9, 
   3.912502149453071*^9}, {3.9125025476758313`*^9, 3.9125025636143436`*^9}, {
   3.912502604823943*^9, 3.9125027174678745`*^9}, {3.9125027760120864`*^9, 
   3.912502830352152*^9}, {3.9125029844461765`*^9, 3.9125029862258606`*^9}, {
   3.9125030713041153`*^9, 3.9125034235333757`*^9}, {3.9125035358354454`*^9, 
   3.912503701205196*^9}, {3.912503737784069*^9, 3.91250380581437*^9}, {
   3.912503841578417*^9, 3.912503856433193*^9}, {3.912504383413185*^9, 
   3.9125043839985466`*^9}, {3.9125307087149987`*^9, 
   3.9125308799003296`*^9}, {3.912531059051177*^9, 3.9125311663339844`*^9}, {
   3.9125341465349617`*^9, 3.9125341481299934`*^9}, {3.9126569993698144`*^9, 
   3.91265699955319*^9}, {3.9126572713892574`*^9, 3.912657453052541*^9}, {
   3.9139785549872684`*^9, 3.913978559452183*^9}, {3.914146835665142*^9, 
   3.914146852000824*^9}, {3.9141468916650877`*^9, 3.914146917080638*^9}, {
   3.9142997891426744`*^9, 3.914299828429942*^9}, {3.9149934246270685`*^9, 
   3.914993466074767*^9}, {3.915182967668269*^9, 3.9151830095678225`*^9}, {
   3.9151830646855774`*^9, 3.915183070151479*^9}, {3.9151832647262177`*^9, 
   3.9151832687942734`*^9}, {3.915183314681617*^9, 3.9151833708433247`*^9}, {
   3.915183431098007*^9, 3.915183446722087*^9}, {3.9152065318409424`*^9, 
   3.9152065336609187`*^9}, {3.915261834639846*^9, 3.9152618605825844`*^9}, 
   3.9154371874717135`*^9, {3.9161556101531286`*^9, 3.9161556361774035`*^9}, {
   3.9161617156977525`*^9, 3.9161617168572645`*^9}, {3.9186624038893523`*^9, 
   3.9186624968833027`*^9}, 3.9186625470069003`*^9, {3.918662722108676*^9, 
   3.918662722738198*^9}, 3.918662988435116*^9, 3.9186645910167947`*^9},
 CellTags->{"Evaluation", "Re-evaluation"},
 CellLabel->
  "In[199]:=",ExpressionUUID->"d8e48d91-7007-4232-a4aa-b432682df483"],

Cell[CellGroupData[{

Cell["Displaying cuts", "Section",
 CellChangeTimes->{{3.90570092403391*^9, 3.905700944394094*^9}, 
   3.9125342998910933`*^9},
 CellTags->{
  "Evaluation", 
   "Re-evaluation"},ExpressionUUID->"d7ec269a-92f8-46cb-bae2-3746feac9caf"],

Cell[CellGroupData[{

Cell["Creating functions with cuts", "Subsection",
 CellChangeTimes->{{3.912531648668831*^9, 3.9125316541920595`*^9}},
 CellTags->{
  "Evaluation", 
   "Re-evaluation"},ExpressionUUID->"4ce9097c-196c-43c3-9806-0febdc29baad"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"createCompiledFunctionpT", "[", 
   RowBox[{"zeroValue_", ",", "elcut_", ",", "\[Mu]cut_", ",", "hadrcut_"}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"Hold", "@", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"id", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"charge", ",", "_Real"}], "}"}]}], "}"}], ",", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"cut", ",", "absid"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"cut", "=", "zeroValue"}], ";", "\[IndentingNewLine]", 
         RowBox[{"absid", "=", 
          RowBox[{"Abs", "[", "id", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"charge", "!=", "0."}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"cut", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"absid", "==", "11."}], ",", "elcut", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"absid", "==", "13."}], ",", "\[Mu]cut", ",", 
                 "hadrcut"}], "]"}]}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "cut"}]}],
        "\[IndentingNewLine]", "]"}], ",", 
      RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
      RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
      RowBox[{"RuntimeAttributes", "->", 
       RowBox[{"{", "Listable", "}"}]}], ",", 
      RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], "//", 
   "ReleaseHold"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pTcutLowerID", "=", 
   RowBox[{"createCompiledFunctionpT", "[", 
    RowBox[{
    "pTcutLowerZero", ",", "pTelCutLower", ",", "pT\[Mu]CutLower", ",", 
     "pThadrCutLower"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pTcutUpperID", "=", 
   RowBox[{"createCompiledFunctionpT", "[", 
    RowBox[{
    "pTcutUpperZero", ",", "pTelCutUpper", ",", "pT\[Mu]CutUpper", ",", 
     "pThadrCutUpper"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "CompiledFunctionTools`"}], "\n", 
 RowBox[{
  RowBox[{"CompilePrint", "@", "pTcutLowerID"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"createCompiledFunctionE", "[", 
   RowBox[{
   "zeroValue_", ",", "\[Gamma]cut_", ",", "h0cut_", ",", "elcut_", ",", 
    "\[Mu]cut_", ",", "hadrcut_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Hold", "@", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"id", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"charge", ",", "_Real"}], "}"}]}], "}"}], ",", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"cut", ",", "absid"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"cut", "=", "zeroValue"}], ";", "\[IndentingNewLine]", 
         RowBox[{"absid", "=", 
          RowBox[{"Abs", "[", "id", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"charge", "==", "0."}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"cut", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"absid", "==", "22."}], ",", "\[Gamma]cut", ",", 
               "h0cut"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"charge", "!=", "0."}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"cut", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"absid", "==", "11."}], ",", "elcut", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"absid", "==", "13."}], ",", "\[Mu]cut", ",", 
                 "hadrcut"}], "]"}]}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "cut"}]}],
        "\[IndentingNewLine]", "]"}], ",", 
      RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
      RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
      RowBox[{"RuntimeAttributes", "->", 
       RowBox[{"{", "Listable", "}"}]}], ",", 
      RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], "//", 
   "ReleaseHold"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ecutLowerID", "=", 
   RowBox[{"createCompiledFunctionE", "[", 
    RowBox[{
    "eCutLowerZero", ",", "e\[Gamma]CutLower", ",", "eh0CutLower", ",", 
     "eElCutLower", ",", "e\[Mu]CutLower", ",", "eHadrCutLower"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ecutUpperID", "=", 
   RowBox[{"createCompiledFunctionE", "[", 
    RowBox[{
    "eCutUpperZero", ",", "e\[Gamma]CutUpper", ",", "eh0CutUpper", ",", 
     "eElCutUpper", ",", "e\[Mu]CutUpper", ",", "eHadrCutUpper"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "CompiledFunctionTools`"}], "\n", 
 RowBox[{
  RowBox[{"CompilePrint", "@", "ecutLowerID"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"createCompiledFunction", "[", 
    RowBox[{
    "zeroValue_", ",", "h0h0Cut_", ",", "gammaGammaCut_", ",", 
     "mixedNeutralCut_", ",", "hadrCut_", ",", "muCut_", ",", "elCut_", ",", 
     "mixedCut_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Hold", "@", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"id1", ",", "_Real"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"charge1", ",", "_Real"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"id2", ",", "_Real"}], "}"}]}], "}"}], ",", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "cut", ",", "absid1", ",", "absid2", ",", "condel1", ",", "condel2",
            ",", "condMu1", ",", "condMu2"}], "}"}], ",", 
         RowBox[{
          RowBox[{"cut", "=", "zeroValue"}], ";", "\[IndentingNewLine]", 
          RowBox[{"absid1", "=", 
           RowBox[{"Abs", "[", "id1", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"absid2", "=", 
           RowBox[{"Abs", "[", "id2", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"charge1", "==", "0."}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"cut", "=", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"id2", "!=", "id1"}], ",", "mixedNeutralCut", ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"id1", "==", "22."}], ",", "gammaGammaCut", ",", 
                  "h0h0Cut"}], "]"}]}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"charge1", "!=", "0."}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"condel1", ",", "condel2"}], "}"}], "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"absid1", "==", "11."}], ",", "1.", ",", "0."}], 
                 "]"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"absid2", "==", "11."}], ",", "1.", ",", "0."}], 
                 "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"condMu1", ",", "condMu2"}], "}"}], "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"absid1", "==", "13."}], ",", "1.", ",", "0."}], 
                 "]"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"absid2", "==", "13."}], ",", "1.", ",", "0."}], 
                 "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"cut", "=", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "condel1", "+", "condel2", "+", "condMu1", "+", "condMu2"}], 
                 "==", "0."}], ",", "hadrCut", ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"condel1", "*", "condel2"}], ",", 
                    RowBox[{"condMu1", "*", "condMu2"}]}], "]"}], "==", 
                   "0."}], ",", "mixedCut", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"condel1", "*", "condel2"}], "==", "1."}], ",", 
                    "elCut", ",", "muCut"}], "]"}]}], "]"}]}], "]"}]}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", "cut"}]}], "]"}], ",", 
       RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
       RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
       RowBox[{"RuntimeAttributes", "->", 
        RowBox[{"{", "Listable", "}"}]}], ",", 
       RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], 
    RowBox[{"(*", 
     RowBox[{"/.", " ", 
      RowBox[{"ruleOwn", "[", 
       RowBox[{"{", 
        RowBox[{
        "zeroValue", ",", "h0h0Cut", ",", "gammaGammaCut", ",", 
         "mixedNeutralCut", ",", "hadrCut", ",", "muCut", ",", "elCut", ",", 
         "mixedCut"}], "}"}], "]"}]}], "*)"}], "//", "ReleaseHold"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EtotCutLowerID", "=", 
   RowBox[{"createCompiledFunction", "[", 
    RowBox[{
    "eTotCutLowerZero", ",", "Etoth0h0CutLower", ",", 
     "Etot\[Gamma]\[Gamma]CutLower", ",", "EtotMixedNeutralCutLower", ",", 
     "EtotHadrCutLower", ",", "Etot\[Mu]CutLower", ",", "EtotElCutLower", ",",
      "EtotMixedCutLower"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"EtotCutUpperID", "=", 
   RowBox[{"createCompiledFunction", "[", 
    RowBox[{
    "eTotCutUpperZero", ",", "Etoth0h0CutUpper", ",", 
     "Etot\[Gamma]\[Gamma]CutUpper", ",", "EtotMixedNeutralCutUpper", ",", 
     "EtotHadrCutUpper", ",", "Etot\[Mu]CutUpper", ",", "EtotElCutUpper", ",",
      "EtotMixedCutUpper"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minvCutLowerID", "=", 
   RowBox[{"createCompiledFunction", "[", 
    RowBox[{
    "minvCutLowerZero", ",", "minvh0h0CutLower", ",", 
     "minv\[Gamma]\[Gamma]CutLower", ",", "minvMixedNeutralCutLower", ",", 
     "minvHadrCutLower", ",", "minv\[Mu]CutLower", ",", "minvElCutLower", ",",
      "minvMixedCutLower"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"minvCutUpperID", "=", 
   RowBox[{"createCompiledFunction", "[", 
    RowBox[{
    "minvCutUpperZero", ",", "minvh0h0CutUpper", ",", 
     "minv\[Gamma]\[Gamma]CutUpper", ",", "minvMixedNeutralCutUpper", ",", 
     "minvHadrCutUpper", ",", "minv\[Mu]CutUpper", ",", "minvElCutUpper", ",",
      "minvMixedCutUpper"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "CompiledFunctionTools`"}], "\n", 
 RowBox[{
  RowBox[{"CompilePrint", "@", "EtotCutUpperID"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AngSepCutID", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Hold", "@", 
      RowBox[{"Compile", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"id1", ",", "_Real"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"id2", ",", "_Real"}], "}"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"id1", "==", "22."}], "||", 
           RowBox[{"id1", "==", "130."}]}], ",", "AngSepCut", ",", 
          "AngSepCutCharged"}], "]"}], ",", 
        RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
        RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
        RowBox[{"RuntimeAttributes", "->", 
         RowBox[{"{", "Listable", "}"}]}], ",", 
        RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], "/.", 
     RowBox[{"ruleOwn", "[", 
      RowBox[{"{", 
       RowBox[{"AngSepCut", ",", "AngSepCutZero", ",", "AngSepCutCharged"}], 
       "}"}], "]"}]}], "//", "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SScutID", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Hold", "@", 
      RowBox[{"Compile", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"id1", ",", "_Real"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"id2", ",", "_Real"}], "}"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"id1", "==", "22."}], "||", 
           RowBox[{"id1", "==", "130."}]}], ",", "SScutNeutral", ",", 
          "SScutCharged"}], "]"}], ",", 
        RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
        RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
        RowBox[{"RuntimeAttributes", "->", 
         RowBox[{"{", "Listable", "}"}]}], ",", 
        RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], "/.", 
     RowBox[{"ruleOwn", "[", 
      RowBox[{"{", 
       RowBox[{"SScutNeutral", ",", "SScutZero", ",", "SScutCharged"}], "}"}],
       "]"}]}], "//", "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"IPcutID", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Hold", "@", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"id1", ",", "_Real"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"id2", ",", "_Real"}], "}"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"id1", "!=", "22."}], "&&", 
          RowBox[{"id1", "!=", "2112."}], "&&", 
          RowBox[{"id1", "!=", "130."}]}], ",", "IPcut", ",", "IPcutZero"}], 
        "]"}], ",", 
       RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
       RowBox[{"RuntimeAttributes", "->", 
        RowBox[{"{", "Listable", "}"}]}], ",", 
       RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
       RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], "/.", 
    RowBox[{"ruleOwn", "[", 
     RowBox[{"{", 
      RowBox[{"IPcut", ",", "IPcutZero"}], "}"}], "]"}]}], "//", 
   "ReleaseHold"}]}]}], "Input",
 CellChangeTimes->{{3.912504527654226*^9, 3.9125045636240673`*^9}, {
   3.912504640662071*^9, 3.9125046466374917`*^9}, {3.9125048290717735`*^9, 
   3.9125048352209883`*^9}, {3.9125269000892096`*^9, 3.912527235817834*^9}, {
   3.912527276355158*^9, 3.9125274943632984`*^9}, {3.9125279053400207`*^9, 
   3.9125279347359495`*^9}, {3.912528029084727*^9, 3.9125280435568657`*^9}, {
   3.9125282367668805`*^9, 3.912528294828271*^9}, 3.9125283507930756`*^9, {
   3.912528415562868*^9, 3.912528474049858*^9}, {3.912528815296932*^9, 
   3.9125289192480845`*^9}, {3.9125289502857466`*^9, 
   3.9125289832351313`*^9}, {3.9125290828852105`*^9, 
   3.9125291556273265`*^9}, {3.9125293432084246`*^9, 
   3.9125294105286074`*^9}, {3.9125294719208384`*^9, 3.912529544474292*^9}, {
   3.9125295791585517`*^9, 3.9125298364773426`*^9}, {3.9125298785411386`*^9, 
   3.9125299388541527`*^9}, {3.9125299700524273`*^9, 
   3.9125300154172473`*^9}, {3.912530107115341*^9, 3.912530274561037*^9}, {
   3.912530305523058*^9, 3.9125303159086633`*^9}, {3.9125303541784306`*^9, 
   3.9125303584651537`*^9}, {3.9125303918730183`*^9, 
   3.9125304484120045`*^9}, {3.9125304894052553`*^9, 
   3.9125305277927227`*^9}, {3.912530572074617*^9, 3.9125305730671883`*^9}, {
   3.912531018658987*^9, 3.9125310197569985`*^9}, {3.9125312785610948`*^9, 
   3.9125312969667444`*^9}, 3.9125316340782185`*^9, {3.912532114886708*^9, 
   3.9125321440663376`*^9}, {3.9125331835571156`*^9, 
   3.9125333510713105`*^9}, {3.912533396288772*^9, 3.9125335047181225`*^9}, {
   3.9125335375011497`*^9, 3.9125336908487997`*^9}, {3.9125337351643004`*^9, 
   3.912533770057849*^9}, {3.912533926577623*^9, 3.912533964504117*^9}, {
   3.9149934653351126`*^9, 3.9149934653351126`*^9}, {3.9151831082871456`*^9, 
   3.9151831354145966`*^9}, {3.915189726124095*^9, 3.9151897416926823`*^9}, {
   3.9186625785697174`*^9, 3.918662608838994*^9}, {3.918662722146917*^9, 
   3.9186627221589055`*^9}},
 CellTags->{"Evaluation", "Re-evaluation"},
 CellLabel->
  "In[219]:=",ExpressionUUID->"acd1ad6d-2643-47be-a83c-28980f0eb75a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Visualization of the cuts", "Subsection",
 CellChangeTimes->{{3.9125342085302763`*^9, 3.9125342182148285`*^9}},
 CellTags->{
  "Evaluation", 
   "Re-evaluation"},ExpressionUUID->"77842bae-2d04-4d46-a04c-bf9a1e33c631"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tabbcuts", "=", 
   RowBox[{"SortBy", "[", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"id1", ",", "id2", ",", 
             RowBox[{"ParamPDGidToProduct", "[", "id1", "]"}], ",", 
             RowBox[{"ParamPDGidToProduct", "[", "id2", "]"}], ",", 
             RowBox[{"ParamProductCharge", "[", "id1", "]"}], ",", 
             RowBox[{"ParamProductCharge", "[", "id2", "]"}], ",", 
             RowBox[{"ecutLowerID", "[", 
              RowBox[{
               RowBox[{"id1", "//", "N"}], ",", 
               RowBox[{
                RowBox[{"ParamProductCharge", "[", "id1", "]"}], "//", 
                "N"}]}], "]"}], ",", 
             RowBox[{"ecutUpperID", "[", 
              RowBox[{
               RowBox[{"id1", "//", "N"}], ",", 
               RowBox[{
                RowBox[{"ParamProductCharge", "[", "id1", "]"}], "//", 
                "N"}]}], "]"}], ",", 
             RowBox[{"pTcutLowerID", "[", 
              RowBox[{
               RowBox[{"id1", "//", "N"}], ",", 
               RowBox[{"ParamProductCharge", "[", "id1", "]"}]}], "]"}], ",", 
             RowBox[{"pTcutUpperID", "[", 
              RowBox[{
               RowBox[{"id1", "//", "N"}], ",", 
               RowBox[{
                RowBox[{"ParamProductCharge", "[", "id1", "]"}], "//", 
                "N"}]}], "]"}], ",", 
             RowBox[{"EtotCutLowerID", "[", 
              RowBox[{
               RowBox[{"id1", "//", "N"}], ",", 
               RowBox[{
                RowBox[{"ParamProductCharge", "[", "id1", "]"}], "//", "N"}], 
               ",", 
               RowBox[{"id2", "//", "N"}]}], "]"}], ",", 
             RowBox[{"EtotCutUpperID", "[", 
              RowBox[{
               RowBox[{"id1", "//", "N"}], ",", 
               RowBox[{
                RowBox[{"ParamProductCharge", "[", "id1", "]"}], "//", "N"}], 
               ",", 
               RowBox[{"id2", "//", "N"}]}], "]"}], ",", 
             RowBox[{"IPcutID", "[", 
              RowBox[{
               RowBox[{"id1", "//", "N"}], ",", 
               RowBox[{"id2", "//", "N"}]}], "]"}], ",", 
             RowBox[{"AngSepCutID", "[", 
              RowBox[{
               RowBox[{"id1", "//", "N"}], ",", 
               RowBox[{"id2", "//", "N"}]}], "]"}], ",", 
             RowBox[{"SScutID", "[", 
              RowBox[{
               RowBox[{"id1", "//", "N"}], ",", 
               RowBox[{"id2", "//", "N"}]}], "]"}], ",", 
             RowBox[{"minvCutLowerID", "[", 
              RowBox[{
               RowBox[{"id1", "//", "N"}], ",", 
               RowBox[{
                RowBox[{"ParamProductCharge", "[", "id1", "]"}], "//", "N"}], 
               ",", 
               RowBox[{"id2", "//", "N"}]}], "]"}], ",", 
             RowBox[{"minvCutUpperID", "[", 
              RowBox[{
               RowBox[{"id1", "//", "N"}], ",", 
               RowBox[{
                RowBox[{"ParamProductCharge", "[", "id1", "]"}], "//", "N"}], 
               ",", 
               RowBox[{"id2", "//", "N"}]}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"id1", ",", "detectablepdgs"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"id2", ",", "detectablepdgs"}], "}"}]}], "]"}], ",", 
         "1"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "5", "]"}], "]"}], "+", 
           RowBox[{"#", "[", 
            RowBox[{"[", "6", "]"}], "]"}]}], "\[Equal]", "0"}], "&&", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "<=", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "&"}]}], "]"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cutsmeaning", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<\!\(\*SubscriptBox[\(pdg\), \(1\)]\)\>\"", ",", 
     "\"\<\!\(\*SubscriptBox[\(pdg\), \(2\)]\)\>\"", ",", 
     "\"\<\!\(\*SubscriptBox[\(id\), \(1\)]\)\>\"", ",", 
     "\"\<\!\(\*SubscriptBox[\(id\), \(2\)]\)\>\"", ",", 
     "\"\<\!\(\*SubscriptBox[\(Q\), \(prod, 1\)]\)\>\"", ",", 
     "\"\<\!\(\*SubscriptBox[\(Q\), \(prod, 2\)]\)\>\"", ",", 
     "\"\<\!\(\*SubscriptBox[\(E\), \(min, 1\)]\) (GeV)\>\"", ",", 
     "\"\<\!\(\*SubscriptBox[\(E\), \(max, 1\)]\) (GeV)\>\"", ",", 
     "\"\<\!\(\*SubscriptBox[\(p\), \(T, min, 1\)]\) (GeV)\>\"", ",", 
     "\"\<\!\(\*SubscriptBox[\(p\), \(T, max, 1\)]\) (GeV)\>\"", ",", 
     "\"\<\!\(\*FractionBox[SubscriptBox[\(E\), \(min, 1 + 2\)], \(GeV\)]\)\>\
\"", ",", 
     "\"\<\!\(\*FractionBox[SubscriptBox[\(E\), \(max, 1 + 2\)], \(GeV\)]\)\>\
\"", ",", "\"\<IP cut (m)\>\"", ",", "\"\<angular separation cut (rad)\>\"", 
     ",", "\"\<Transverse spatial separation cut (m)\>\"", ",", 
     "\"\<\!\(\*SubscriptBox[\(m\), \(inv, min\)]\) (GeV)\>\"", ",", 
     "\"\<\!\(\*SubscriptBox[\(m\), \(inv, max\)]\) (GeV)\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{"1", ",", 
        RowBox[{"Length", "[", "cutsmeaning", "]"}]}], "]"}], ",", 
      "cutsmeaning"}], "}"}], ",", "tabbcuts"}], "]"}], "//", 
  "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IfEcuts", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Select", "[", 
        RowBox[{"tabbcuts", ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "7", "]"}], "]"}], "!=", "eCutLowerZero"}], "||", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "8", "]"}], "]"}], "!=", "eCutUpperZero"}], "||", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "11", "]"}], "]"}], "!=", "eTotCutLowerZero"}], "||", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "12", "]"}], "]"}], "!=", "eTotCutUpperZero"}]}], 
          "&"}]}], "]"}], "]"}], "==", "0"}], ",", "0", ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IfEtotLowercuts", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Select", "[", 
        RowBox[{"tabbcuts", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "11", "]"}], "]"}], "!=", "eTotCutLowerZero"}], 
          "&"}]}], "]"}], "]"}], "==", "0"}], ",", "0", ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IfEtotUppercuts", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Select", "[", 
        RowBox[{"tabbcuts", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "12", "]"}], "]"}], "!=", "eTotCutUpperZero"}], 
          "&"}]}], "]"}], "]"}], "==", "0"}], ",", "0", ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IfpTcuts", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Select", "[", 
        RowBox[{"tabbcuts", ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "9", "]"}], "]"}], "!=", "pTcutLowerZero"}], "||", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "10", "]"}], "]"}], "!=", "pTcutUpperZero"}]}], 
          "&"}]}], "]"}], "]"}], "==", "0"}], ",", "0", ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IfAngSepCuts", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Select", "[", 
        RowBox[{"tabbcuts", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "14", "]"}], "]"}], "!=", "AngSepCutZero"}], "&"}]}],
         "]"}], "]"}], "==", "0"}], ",", "0", ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IfSScuts", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Select", "[", 
        RowBox[{"tabbcuts", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "15", "]"}], "]"}], "!=", "AngSepCutZero"}], "&"}]}],
         "]"}], "]"}], "==", "0"}], ",", "0", ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IfIPcuts", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Select", "[", 
        RowBox[{"tabbcuts", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "13", "]"}], "]"}], "!=", "IPcutZero"}], "&"}]}], 
        "]"}], "]"}], "==", "0"}], ",", "0", ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IfminvCuts", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Select", "[", 
        RowBox[{"tabbcuts", ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "16", "]"}], "]"}], "!=", "minvCutLowerZero"}], "||", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "17", "]"}], "]"}], "!=", "minvCutUpperZero"}]}], 
          "&"}]}], "]"}], "]"}], "==", "0"}], ",", "0", ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IfminvLowerCuts", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Select", "[", 
        RowBox[{"tabbcuts", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "16", "]"}], "]"}], "!=", "minvCutLowerZero"}], 
          "&"}]}], "]"}], "]"}], "==", "0"}], ",", "0", ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IfminvUpperCuts", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Select", "[", 
        RowBox[{"tabbcuts", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "17", "]"}], "]"}], "!=", "minvCutUpperZero"}], 
          "&"}]}], "]"}], "]"}], "==", "0"}], ",", "0", ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WhetherCuts", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Total", "[", 
       RowBox[{"{", 
        RowBox[{
        "IfEcuts", ",", "IfEtotLowercuts", ",", "IfEtotUppercuts", ",", 
         "IfpTcuts", ",", "IfAngSepCuts", ",", "IfIPcuts", ",", "IfminvCuts", 
         ",", "IfminvLowerCuts", ",", "IfminvUpperCuts"}], "}"}], "]"}], "==",
       "0"}], ",", "0.", ",", "1."}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\"\<Any E cut\>\"", ",", 
      "\"\<Tot \!\(\*SubscriptBox[\(E\), \(lower\)]\) cut\>\"", ",", 
      "\"\<Tot \!\(\*SubscriptBox[\(E\), \(upper\)]\) cut\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(p\), \(T\)]\) cut\>\"", ",", 
      "\"\<Angular cut\>\"", ",", "\"\<SS cut\>\"", ",", "\"\<IP cuts\>\"", 
      ",", "\"\<Any \!\(\*SubscriptBox[\(m\), \(inv\\\ cut\)]\)\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(m\), \(inv, lower\)]\) cuts\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(m\), \(inv, upper\)]\) cuts\>\""}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
     "IfEcuts", ",", "IfEtotLowercuts", ",", "IfEtotUppercuts", ",", 
      "IfpTcuts", ",", "IfAngSepCuts", ",", "IfSScuts", ",", "IfIPcuts", ",", 
      "IfminvCuts", ",", "IfminvLowerCuts", ",", "IfminvUpperCuts"}], "}"}]}],
    "}"}], "//", "TableForm"}]}], "Input",
 CellChangeTimes->{{3.9056986399863305`*^9, 3.90569870900927*^9}, {
   3.905699077854807*^9, 3.905699134114379*^9}, {3.90569988936072*^9, 
   3.905699910175376*^9}, 3.9057009285373697`*^9, {3.905700981301016*^9, 
   3.9057010102069345`*^9}, {3.905701142125745*^9, 3.9057011468211517`*^9}, {
   3.9058410302725835`*^9, 3.9058411258962774`*^9}, {3.9058465613625803`*^9, 
   3.905846678252503*^9}, {3.910175441451767*^9, 3.9101755084456563`*^9}, {
   3.9102485430536957`*^9, 3.9102485442094946`*^9}, {3.9121594142239914`*^9, 
   3.9121594145852356`*^9}, {3.9124986071171985`*^9, 3.912498826948338*^9}, {
   3.912498882509398*^9, 3.9124989104178066`*^9}, {3.9124989430220065`*^9, 
   3.912498974419062*^9}, {3.912499044644451*^9, 3.9124990691861334`*^9}, {
   3.91249911005711*^9, 3.912499139444146*^9}, {3.9124992016744165`*^9, 
   3.912499234845409*^9}, {3.9125011060840044`*^9, 3.9125011082754574`*^9}, {
   3.9125011843855104`*^9, 3.91250119970541*^9}, {3.9125043834641995`*^9, 
   3.912504383515438*^9}, 3.912533370616337*^9, {3.9125337972131047`*^9, 
   3.912533798136937*^9}, {3.912533831572016*^9, 3.912533894903903*^9}, {
   3.912535104413927*^9, 3.912535177278549*^9}, {3.912657569217199*^9, 
   3.9126575746206074`*^9}, {3.914993465366354*^9, 3.914993465381977*^9}, {
   3.9152065726584177`*^9, 3.9152065800973606`*^9}, {3.916155636187538*^9, 
   3.9161556515685587`*^9}, {3.916155722144123*^9, 3.916155722190012*^9}, {
   3.9161620710664806`*^9, 3.9161620816266932`*^9}, {3.916162183266341*^9, 
   3.916162183276497*^9}, 3.916162270347494*^9, {3.9186626338251057`*^9, 
   3.9186626484781156`*^9}, {3.918662697360613*^9, 3.918662807089285*^9}, {
   3.9186628592427177`*^9, 3.9186628598962355`*^9}, {3.918662905900796*^9, 
   3.91866290824734*^9}, {3.9199603592320156`*^9, 3.919960360122123*^9}, {
   3.9356307956888676`*^9, 3.93563079628088*^9}},
 CellTags->{"Evaluation", "Re-evaluation"},
 CellLabel->
  "In[239]:=",ExpressionUUID->"2a5f65dc-d89d-4d49-aaa6-0f16c5e07109"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Importing LLP decay data", "Chapter",
 CellChangeTimes->{{3.9355081395983562`*^9, 3.935508142662566*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"3c24dcbc-6ae2-8845-92be-bcf28a8077c9"],

Cell[BoxData[{
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Print", "=", "Identity"}], "}"}], ",", 
   RowBox[{"Quiet", "[", 
    RowBox[{"NotebookEvaluate", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<codes/llp-decays.nb\>\""}], "}"}], "]"}], "]"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<List of implemented LLPs:\>\"", 
  "]"}], "\[IndentingNewLine]", "LLPlist"}], "Input",
 CellChangeTimes->{{3.915255767580451*^9, 3.9152557854309206`*^9}, 
   3.916156596892898*^9, {3.9161574475985355`*^9, 3.916157450970195*^9}, {
   3.9339201669363422`*^9, 3.933920171943617*^9}, {3.9339205458445187`*^9, 
   3.933920547573763*^9}, {3.935631513262186*^9, 3.9356315196114635`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[254]:=",ExpressionUUID->"06938cfe-a232-1840-99db-f4abbeb8fc9f"],

Cell[CellGroupData[{

Cell["Refining possible decay channels", "Section",
 CellChangeTimes->{{3.904791226880584*^9, 3.904791233348931*^9}},
 CellTags->{
  "Evaluation", 
   "Re-evaluation"},ExpressionUUID->"a9f03259-d8f2-486b-a34b-e7585d74a72a"],

Cell[BoxData[{
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ProcessesListRefined", "[", 
      RowBox[{"LLP", ",", "ECALoptionGivenExperiment"}], "]"}], "=", 
     RowBox[{"ProcessesList", "[", 
      RowBox[{"LLP", ",", "ECALoptionGivenExperiment"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"LLP", ",", "LLPlist"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"MemberQ", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\"\<CHARM-lepton\>\"", ",", "\"\<CHARM-approx-lepton\>\"", ",", 
        "\"\<BEBC\>\""}], "}"}], ",", "GivenExperiment"}], "]"}], "==", 
    "True"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"relevantprocesses", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(e\), \(+\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(e\), \(-\)]\)\>\"", ",", "\"\<Null\>\"", 
         ",", "\"\<Null\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(-\)]\)\>\"", ",", 
         "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(e\), \(-\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Nu]\), \(_\)], \
\(e\)]\)\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(-\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(e\), \(+\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(e\)]\)\>\"", ",", 
         "\"\<Null\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(e\), \(-\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(\[Mu]\)]\)\>\"", ",", 
         "\"\<Null\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(-\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(e\), \(+\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Nu]\), \(_\)], \
\(\[Mu]\)]\)\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(-\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(e\)]\)\>\"", ",", 
         "\"\<Null\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(-\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(\[Mu]\)]\)\>\"", ",", 
         "\"\<Null\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(-\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(\[Tau]\)]\)\>\"", ",", 
         "\"\<Null\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(-\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Nu]\), \(_\)], \
\(e\)]\)\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(-\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Nu]\), \(_\)], \
\(\[Mu]\)]\)\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(-\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Nu]\), \(_\)], \(\[Tau]\)]\
\)\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(e\), \(+\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(e\), \(-\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(e\)]\)\>\"", ",", 
         "\"\<Null\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(e\), \(+\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(e\), \(-\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(\[Mu]\)]\)\>\"", ",", 
         "\"\<Null\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(e\), \(+\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(e\), \(-\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(\[Tau]\)]\)\>\"", ",", 
         "\"\<Null\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(e\), \(+\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(e\), \(-\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Nu]\), \(_\)], \
\(e\)]\)\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(e\), \(+\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(e\), \(-\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Nu]\), \(_\)], \
\(\[Mu]\)]\)\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(e\), \(+\)]\)\>\"", ",", 
         "\"\<\!\(\*SuperscriptBox[\(e\), \(-\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Nu]\), \(_\)], \(\[Tau]\)]\
\)\>\"", ",", "\"\<Null\>\""}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"{", "\"\<BEBC\>\"", "}"}], ",", "GivenExperiment"}], "]"}], 
       "==", "True"}], ",", 
      RowBox[{"relevantprocesses", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"relevantprocesses", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", 
             "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(e\)]\)\>\"", ",", 
             "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", 
             "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(\[Mu]\)]\)\>\"", ",", 
             "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", 
             "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(\[Tau]\)]\)\>\"", ",", 
             "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", 
             "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Nu]\), \(_\)], \
\(e\)]\)\>\"", ",", "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", 
             "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Nu]\), \(_\)], \(\[Mu]\
\)]\)\>\"", ",", "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", 
              "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Nu]\), \(_\)], \(\
\[Tau]\)]\)\>\"", ",", "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}], 
            RowBox[{"{", 
             RowBox[{
             "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", 
              "\"\<\[Nu]\>\"", ",", "\"\<Null\>\"", ",", "\"\<Null\>\""}], 
             "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\[Gamma]\>\"", ",", "\"\<\[Gamma]\>\"", ",", "\"\<Null\>\"", 
             ",", "\"\<Null\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", 
             "\"\<\[Gamma]\>\"", ",", "\"\<Null\>\"", ",", "\"\<Null\>\""}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(-\)]\)\>\"", ",", 
             "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(-\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\>\"", ",", 
             "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SuperscriptBox[\(e\), \(+\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(-\)]\)\>\"", ",", 
             "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SuperscriptBox[\(e\), \(-\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\>\"", ",", 
             "\"\<Null\>\"", ",", "\"\<Null\>\""}], "}"}]}], "}"}]}], 
        "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ProcessesListRefined", "[", 
         RowBox[{"LLP", ",", "ECALoptionGivenExperiment"}], "]"}], "=", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"ProcessesList", "[", 
           RowBox[{"LLP", ",", "ECALoptionGivenExperiment"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Sort", "/@", "relevantprocesses"}], ",", 
              RowBox[{"Sort", "[", 
               RowBox[{"ListDecayProducts", "[", 
                RowBox[{"LLP", ",", "#"}], "]"}], "]"}]}], "]"}], "==", 
            "True"}], "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"LLP", ",", "LLPlist"}], "}"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.904791254610733*^9, 3.90479129532124*^9}, {
   3.904791338028764*^9, 3.9047913586765823`*^9}, {3.904791399796554*^9, 
   3.904791408947711*^9}, {3.9047917158907313`*^9, 3.9047917233665185`*^9}, 
   3.904791762175335*^9, {3.904791885462148*^9, 3.9047920449193325`*^9}, {
   3.904792141059723*^9, 3.904792189987359*^9}, {3.9047923964055204`*^9, 
   3.9047924180623894`*^9}, {3.904793242669736*^9, 3.904793449442148*^9}, {
   3.9047938126832294`*^9, 3.904793878130267*^9}, {3.9047940877627707`*^9, 
   3.904794117173868*^9}, {3.9047941698459473`*^9, 3.904794188863519*^9}, {
   3.904794294911703*^9, 3.9047942993714557`*^9}, {3.9058450824775815`*^9, 
   3.9058450834143815`*^9}, {3.9101654009086633`*^9, 
   3.9101654045280976`*^9}, {3.910165927887673*^9, 3.910165998049596*^9}, {
   3.910166041718178*^9, 3.9101661518785233`*^9}, 3.9121591756192293`*^9, {
   3.9154371874984293`*^9, 3.9154371875499315`*^9}, 3.9161554092623415`*^9, {
   3.935630904109316*^9, 3.9356309108613224`*^9}},
 CellTags->{"Evaluation", "Re-evaluation"},
 CellLabel->
  "In[257]:=",ExpressionUUID->"511d5941-952c-4239-855b-3777a47bc610"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["II. Decay acceptance calculation", "Title",
 CellChangeTimes->{{3.887780141514988*^9, 3.8877801438682127`*^9}, {
  3.8877814585563145`*^9, 3.8877814592472353`*^9}, {3.8934364536342463`*^9, 
  3.8934364595743847`*^9}, {3.9038012705453463`*^9, 3.9038012710574102`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"7ef276aa-6ac2-44b6-8659-f620e946504b"],

Cell[CellGroupData[{

Cell["\<\
Defining and compiling relevant functions used to calculate the decay \
acceptance\
\>", "Chapter",
 CellChangeTimes->{{3.8913221765123215`*^9, 3.891322205486955*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"75496f98-5d16-4d12-8062-af46b66ba6fe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"LLPdecVTXatGivenZ", "[", 
    RowBox[{"zLLP_", ",", "\[Theta]LLP_", ",", "\[Phi]LLP_"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"zLLP", "/", 
        RowBox[{"Cos", "[", "\[Theta]LLP", "]"}]}], ")"}], 
      RowBox[{"Sin", "[", "\[Theta]LLP", "]"}], "*", 
      RowBox[{"Cos", "[", "\[Phi]LLP", "]"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"zLLP", "/", 
        RowBox[{"Cos", "[", "\[Theta]LLP", "]"}]}], ")"}], 
      RowBox[{"Sin", "[", "\[Theta]LLP", "]"}], "*", 
      RowBox[{"Sin", "[", "\[Phi]LLP", "]"}]}], ",", "zLLP"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LLPdecVTXatGivenZx", "[", 
    RowBox[{"zLLP_", ",", "\[Theta]LLP_", ",", "\[Phi]LLP_"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"LLPdecVTXatGivenZ", "[", 
        RowBox[{"zLLP", ",", "\[Theta]LLP", ",", "\[Phi]LLP"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "/.", " ", 
      RowBox[{
       RowBox[{"Cot", "[", "x_", "]"}], ":>", 
       RowBox[{"1", "/", 
        RowBox[{"Tan", "[", "x", "]"}]}]}]}], "/.", " ", 
     RowBox[{
      RowBox[{"Csc", "[", "x_", "]"}], ":>", 
      RowBox[{"1", "/", 
       RowBox[{"Sin", "[", "x", "]"}]}]}]}], "/.", 
    RowBox[{
     RowBox[{"Sec", "[", "x_", "]"}], "\[RuleDelayed]", 
     RowBox[{"1", "/", 
      RowBox[{"Cos", "[", "x", "]"}]}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LLPdecVTXatGivenZy", "[", 
    RowBox[{"zLLP_", ",", "\[Theta]LLP_", ",", "\[Phi]LLP_"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"LLPdecVTXatGivenZ", "[", 
        RowBox[{"zLLP", ",", "\[Theta]LLP", ",", "\[Phi]LLP"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "/.", " ", 
      RowBox[{
       RowBox[{"Cot", "[", "x_", "]"}], ":>", 
       RowBox[{"1", "/", 
        RowBox[{"Tan", "[", "x", "]"}]}]}]}], "/.", " ", 
     RowBox[{
      RowBox[{"Csc", "[", "x_", "]"}], ":>", 
      RowBox[{"1", "/", 
       RowBox[{"Sin", "[", "x", "]"}]}]}]}], "/.", 
    RowBox[{
     RowBox[{"Sec", "[", "x_", "]"}], "\[RuleDelayed]", 
     RowBox[{"1", "/", 
      RowBox[{"Cos", "[", "x", "]"}]}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DecayAcceptanceGeometry", "[", 
    RowBox[{"coord1_", ",", "coord2_", ",", "xLongLLP_"}], "]"}], "=", 
   RowBox[{"Boole", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Min", "[", 
       RowBox[{"DetEndCoordinates", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "<", "coord1", "<", 
      RowBox[{"Max", "[", 
       RowBox[{"DetEndCoordinates", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "&&", 
     RowBox[{
      RowBox[{"zToDetectorCenterGivenExperiment", "-", 
       FractionBox["dzDetectorGivenExperimentMax", "2"]}], "<", " ", "coord2",
       "<", 
      RowBox[{"zToDetectorCenterGivenExperiment", "+", 
       FractionBox["dzDetectorGivenExperimentMax", "2"]}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pointSecondCoordinate", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LarmorRadiusGivenExperiment", "[", "E1lab_", "]"}], "=", 
   "999999999"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NotebookEvaluate", "[", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<codes/decay-acceptance.nb\>\""}], "}"}], "]"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.915264127585699*^9, 3.9152641455577364`*^9}, {
  3.915264281570612*^9, 3.91526428225181*^9}, {3.91529388001492*^9, 
  3.9152938830956087`*^9}, {3.9152941594367533`*^9, 3.9152941636648684`*^9}, {
  3.9168899407770195`*^9, 3.9168899408712854`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[259]:=",ExpressionUUID->"a351b5a7-3968-47b6-9206-0b80d566fd66"],

Cell[CellGroupData[{

Cell["Mass range for the acceptance computation", "Section",
 CellChangeTimes->{{3.891323732291453*^9, 3.89132374118683*^9}, {
   3.891323823354575*^9, 3.8913238234662757`*^9}, {3.893436795887788*^9, 
   3.8934368016086535`*^9}, 3.893436831726281*^9, 3.915255993420688*^9},
 CellTags->{
  "Evaluation", 
   "Re-evaluation"},ExpressionUUID->"69890af2-32c0-41ab-b90f-aaf902234c1e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Mass", " ", "range", " ", "for", " ", 
      RowBox[{"scalars", ".", " ", "If"}], " ", "the", " ", "facility", " ", 
      "is", " ", "not", " ", "FCC"}], "-", 
     RowBox[{
      RowBox[{"hh", "/", "LHC"}], " ", 
      RowBox[{"(", 
       RowBox[{
       "where", " ", "scalars", " ", "heavier", " ", "than", " ", "B", " ", 
        "may", " ", "be", " ", "produced"}], ")"}]}]}], ",", " ", 
    RowBox[{
     RowBox[{
     "then", " ", "the", " ", "mass", " ", "range", " ", "is", " ", "bounded",
       " ", "by", " ", 
      SubscriptBox["m", "B"]}], " ", "-", " ", 
     RowBox[{
      SubscriptBox["m", "\[Pi]"], ".", " ", "Otherwise"}]}], ",", " ", 
    RowBox[{"it", " ", "is", " ", "up", " ", "to", " ", 
     RowBox[{
      SubscriptBox["m", "h"], "/", "2"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"mLLPlistTemp", "[", "\"\<Scalar\>\"", "]"}], "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "0.02", ",", "0.05", ",", "0.1", ",", "0.2", ",", "0.22", ",", "0.3", 
         ",", "0.4", ",", "0.5", ",", "0.7", ",", "0.9", ",", "1.05", ",", 
         "1.3", ",", "1.6", ",", "1.99"}], "}"}], ",", 
       RowBox[{"mjetsrange", "[", "\"\<Scalar\>\"", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"mLLPlist", "[", "\"\<Scalar\>\"", "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<LHC\>\"", ",", "\"\<FCC-hh\>\""}], "}"}], ",", 
          "FacilityGivenExperiment"}], "]"}], "==", "False"}], ",", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"mLLPlistTemp", "[", "\"\<Scalar\>\"", "]"}], ",", 
         RowBox[{
          RowBox[{"#", "<=", "5.1"}], "&"}]}], "]"}], ",", 
       RowBox[{"mLLPlistTemp", "[", "\"\<Scalar\>\"", "]"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"For", " ", "HNLs"}], " ", "-", " ", "similarly"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"mLLPlistTemp", "[", "LLP", "]"}], "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "0.02", ",", "0.05", ",", "0.1", ",", "0.17", ",", "0.35", ",", 
             "0.5", ",", "0.75", ",", "1.", ",", "1.19", ",", "1.5"}], "}"}], 
           ",", 
           RowBox[{
            RowBox[{"#", "<", 
             RowBox[{"Min", "[", 
              RowBox[{"mjetsrange", "[", "LLP", "]"}], "]"}]}], "&"}]}], 
          "]"}], ",", 
         RowBox[{"mjetsrange", "[", "LLP", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mLLPlist", "[", "LLP", "]"}], "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<LHC\>\"", ",", "\"\<FCC-hh\>\""}], "}"}], ",", 
            "FacilityGivenExperiment"}], "]"}], "==", "False"}], ",", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"mLLPlistTemp", "[", "LLP", "]"}], ",", 
           RowBox[{
            RowBox[{"#", "<=", "5.3"}], "&"}]}], "]"}], ",", 
         RowBox[{"mLLPlistTemp", "[", "LLP", "]"}]}], "]"}]}], ";"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"LLP", ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<HNL-mixing-e\>\"", ",", "\"\<HNL-mixing-mu\>\"", ",", 
         "\"\<HNL-mixing-tau\>\""}], "}"}]}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"ALPs", " ", "coupled", " ", "to", " ", "gluons"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"mLLPlistTemp", "[", "\"\<ALP-gluon\>\"", "]"}], "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "0.02", ",", "0.05", ",", "0.07", ",", "0.1", ",", "0.14", ",", 
           "0.16", ",", "0.2", ",", "0.25", ",", "0.3", ",", "0.5", ",", 
           "0.75", ",", "1.", ",", "1.25", ",", "1.5", ",", "1.8", ",", 
           "2.3"}], "}"}], ",", 
         RowBox[{
          RowBox[{"#", "<", 
           RowBox[{"Min", "[", 
            RowBox[{"mjetsrange", "[", "\"\<ALP-gluon\>\"", "]"}], "]"}]}], 
          "&"}]}], "]"}], ",", 
       RowBox[{"mjetsrange", "[", "\"\<ALP-gluon\>\"", "]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"mLLPlist", "[", "\"\<ALP-gluon\>\"", "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ECALoptionGivenExperiment", "\[Equal]", "\"\<False\>\""}], 
       ",", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"mLLPlistTemp", "[", "\"\<ALP-gluon\>\"", "]"}], ",", 
         RowBox[{
          RowBox[{"#", ">", 
           RowBox[{"0.14", "*", "2"}]}], "&"}]}], "]"}], ",", 
       RowBox[{"mLLPlistTemp", "[", "\"\<ALP-gluon\>\"", "]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"ALPs", " ", "coupled", " ", "to", " ", "fermions"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"mLLPlist", "[", "\"\<ALP-fermion\>\"", "]"}], "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "0.02", ",", "0.05", ",", "0.1", ",", "0.15", ",", "0.2", ",", 
           "0.21", ",", "0.22", ",", "0.25", ",", "0.3", ",", "0.5", ",", 
           "0.6", ",", "0.7", ",", "0.8", ",", "0.9", ",", "1.1", ",", "1.5", 
           ",", "1.8", ",", "2.3"}], "}"}], ",", 
         RowBox[{
          RowBox[{"#", "<", 
           RowBox[{"Min", "[", 
            RowBox[{"mjetsrange", "[", "\"\<ALP-fermion\>\"", "]"}], "]"}]}], 
          "&"}]}], "]"}], ",", 
       RowBox[{"mjetsrange", "[", "\"\<ALP-fermion\>\"", "]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"ALPs", " ", "coupled", " ", "to", " ", "photons"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"mLLPlist", "[", "\"\<ALP-photon\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "0.02", ",", "0.03", ",", "0.04", ",", "0.05", ",", "0.06", ",", 
         "0.07", ",", "0.08", ",", "0.09", ",", "0.1", ",", "0.25", ",", 
         "0.5", ",", "0.75", ",", "1.", ",", "1.25", ",", "1.5", ",", "1.75", 
         ",", "2.25", ",", "2.75", ",", "3.", ",", "3.5", ",", "4.", ",", 
         "4.5"}], "}"}], "//", "N"}], "//", "Sort"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"mLLPlist", "[", "\"\<DP\>\"", "]"}], "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "0.02", ",", "0.03", ",", "0.04", ",", "0.05", ",", "0.06", ",", 
           "0.07", ",", "0.08", ",", "0.09", ",", "0.1", ",", "0.13", ",", 
           "0.16", ",", "0.2", ",", "0.25", ",", "0.5", ",", "0.75", ",", 
           "1.", ",", "1.25", ",", "1.75", ",", "2.25"}], "}"}], ",", 
         RowBox[{
          RowBox[{"#", "<", 
           RowBox[{"Min", "[", 
            RowBox[{"mjetsrange", "[", "\"\<DP\>\"", "]"}], "]"}]}], "&"}]}], 
        "]"}], ",", 
       RowBox[{"mjetsrange", "[", "\"\<DP\>\"", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"mLLPlist", "[", "\"\<B-L\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"mLLPlist", "[", "\"\<B-3Le-Lmu+Ltau\>\"", "]"}], "=", 
      RowBox[{
       RowBox[{"mLLPlist", "[", "\"\<B-Le-3Lmu+Ltau\>\"", "]"}], "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "0.02", ",", "0.5", ",", "0.1", ",", "0.25", ",", "0.5", ",", 
             "0.75", ",", "1.", ",", "1.25", ",", "1.75", ",", "2.25"}], 
            "}"}], ",", 
           RowBox[{
            RowBox[{"#", "<", 
             RowBox[{"Min", "[", 
              RowBox[{"mjetsrange", "[", "\"\<B-L\>\"", "]"}], "]"}]}], 
            "&"}]}], "]"}], ",", 
         RowBox[{"mjetsrange", "[", "\"\<B-L\>\"", "]"}]}], "]"}]}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"mLLPlist", "[", "\"\<B-3Lmu\>\"", "]"}], "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", "0.215", "}"}], ",", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"mLLPlist", "[", "\"\<B-L\>\"", "]"}], ",", 
         RowBox[{
          RowBox[{"#", ">", "0.215"}], "&"}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"FacilityGivenExperiment", "==", "\"\<ESS\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"mLLPlist", "[", "LLP", "]"}], "=", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"mLLPlist", "[", "LLP", "]"}], ",", 
           RowBox[{
            RowBox[{"#", "<", "2.4"}], "&"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"LLP", ",", 
          RowBox[{"{", 
           RowBox[{
           "\"\<ALP-gluon\>\"", ",", "\"\<ALP-fermion\>\"", ",", 
            "\"\<ALP-photon\>\"", ",", "\"\<DP\>\"", ",", "\"\<B-L\>\"", ",", 
            "\"\<Scalar\>\""}], "}"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"mLLPlist", "[", "LLP", "]"}], "=", 
         RowBox[{"{", 
          RowBox[{
          "0.005", ",", "0.01", ",", "0.015", ",", "0.02", ",", "0.025", ",", 
           "0.03", ",", "0.035", ",", "0.04", ",", "0.045", ",", "0.05", ",", 
           "0.055", ",", "0.06", ",", "0.065", ",", "0.07", ",", "0.075", ",",
            "0.08", ",", "0.085", ",", "0.09", ",", "0.095", ",", "0.1", ",", 
           "0.103", ",", "0.105", ",", "0.11", ",", "0.115", ",", "0.12", ",",
            "0.125", ",", "0.13", ",", "0.135", ",", "0.14"}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"LLP", ",", 
          RowBox[{"{", 
           RowBox[{
           "\"\<HNL-mixing-e\>\"", ",", "\"\<HNL-mixing-mu\>\"", ",", 
            "\"\<HNL-mixing-tau\>\""}], "}"}]}], "}"}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.90483427822402*^9, 3.9048342786130257`*^9}, {
  3.904891095640736*^9, 3.9048911083555403`*^9}, {3.9110279635875297`*^9, 
  3.9110279811714044`*^9}, {3.9110280258346977`*^9, 3.91102805460303*^9}, {
  3.9141397726358833`*^9, 3.914139796020625*^9}, {3.9141398264274855`*^9, 
  3.914139830154768*^9}, {3.9147491772830024`*^9, 3.9147492229437723`*^9}, {
  3.914749485072877*^9, 3.9147496287871146`*^9}, {3.9149165501571755`*^9, 
  3.914916555962652*^9}, {3.9149196735110807`*^9, 3.914919765338022*^9}, {
  3.914920097319073*^9, 3.914920145615481*^9}, {3.914920246125176*^9, 
  3.9149202867523923`*^9}, {3.914929712815317*^9, 3.9149297136826305`*^9}, {
  3.9149298901991577`*^9, 3.914929891488798*^9}, {3.9149470738491197`*^9, 
  3.91494707545831*^9}, {3.9151862948475*^9, 3.9151863148671913`*^9}, {
  3.9168899408712854`*^9, 3.916889941028466*^9}, {3.9168902755549154`*^9, 
  3.9168903138869505`*^9}},
 CellTags->{"Evaluation", "Re-evaluation"},
 CellLabel->
  "In[266]:=",ExpressionUUID->"0b5b19ea-8b21-416c-951d-2092f610aec4"]
}, Closed]],

Cell[CellGroupData[{

Cell["Final block", "Section",
 CellChangeTimes->{{3.915256023204398*^9, 
  3.9152560243517537`*^9}},ExpressionUUID->"61dd62df-bf83-4744-b8b5-\
810b5c5173a5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "phr0", "=", 
   "\"\<Use old phenomenology from 1901.09966, or the new one from \
2310.03524?\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a0", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<New\>\"", ",", "\"\<Old\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"phr1", "[", "LLP_", "]"}], ":=", 
   RowBox[{"Row", "[", 
    RowBox[{"{", 
     RowBox[{"\"\<Default decay chanels: \>\"", ",", 
      RowBox[{"ProcessesListRefined", "[", 
       RowBox[{"LLP", ",", "ECALoptionGivenExperiment"}], "]"}], ",", 
      "\"\<. Keep them?\>\""}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a1", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<Yes\>\"", ",", "\"\<No\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "phr2", "=", 
   "\"\<How many decay products that in principle may be detected must pass \
all the criteria?\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a2", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<>=2\>\"", ",", "\"\<>=n\>\"", ",", "\"\<All detectable\>\""}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "phr3", "=", 
   "\"\<Heavy LLPs decay into partons. Would you like to use the phase space \
of hadronized decay products of the LLPs, or use partons instead?\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a3", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<Hadronized products\>\"", ",", "\"\<Partons\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FinalBlock", "[", 
   RowBox[{"LLP_", ",", "isim_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"masslist", "=", 
      RowBox[{"mLLPlist", "[", "LLP", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"LLP", "==", "\"\<ALP-fermion\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"alpfermionselection", "=", 
           RowBox[{"dropdownDialog", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<New\>\"", ",", "\"\<Old\>\""}], "}"}], ",", 
             RowBox[{"Row", "[", 
              RowBox[{
              "{", "\"\<Use old phenomenology from 1901.09966, or the new one \
from 2310.03524?\>\"", "}"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"LLPchoiceForComputation", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"alpfermionselection", "==", "\"\<New\>\""}], ",", 
             "\"\<ALP-fermion\>\"", ",", 
             "\"\<ALP-fermion-no-hadronic-decays\>\""}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LLPchoiceForComputation", "=", "LLP"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"LLP", "==", "\"\<ALP-fermion\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", "alpfermionselection", "}"}], "=", 
         RowBox[{"choicesDialog", "[", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"LLP", ",", "Bold"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"phr0", ",", "a0"}], "}"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"LLPchoiceForComputation", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"alpfermionselection", "==", "\"\<New\>\""}], ",", 
           "\"\<ALP-fermion\>\"", ",", 
           "\"\<ALP-fermion-no-hadronic-decays\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"GivenExperiment", "!=", "\"\<CHARM-photon\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "decaychannelschoice", ",", "acceptancetypechoice", ",", 
             "HadronizationOptionChoice"}], "}"}], "=", 
           RowBox[{"choicesDialog", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"LLP", ",", "Bold"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"phr1", "[", "LLPchoiceForComputation", "]"}], ",", 
                 "a1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"phr2", ",", "a2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"phr3", ",", "a3"}], "}"}]}], "}"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"decaychannelschoice", ",", "HadronizationOptionChoice"}],
             "}"}], "=", 
           RowBox[{"choicesDialog", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"LLP", ",", "Bold"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"phr1", "[", "LLPchoiceForComputation", "]"}], ",", 
                 "a1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"phr3", ",", "a3"}], "}"}]}], "}"}]}], "]"}]}]}], 
         "]"}], ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"LLPchoiceForComputation", "=", "LLP"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"GivenExperiment", "!=", "\"\<CHARM-photon\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "decaychannelschoice", ",", "acceptancetypechoice", ",", 
             "HadronizationOptionChoice"}], "}"}], "=", 
           RowBox[{"choicesDialog", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"LLP", ",", "Bold"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"phr1", "[", "LLPchoiceForComputation", "]"}], ",", 
                 "a1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"phr2", ",", "a2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"phr3", ",", "a3"}], "}"}]}], "}"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"decaychannelschoice", ",", "HadronizationOptionChoice"}],
             "}"}], "=", 
           RowBox[{"choicesDialog", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"LLP", ",", "Bold"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"phr1", "[", "LLPchoiceForComputation", "]"}], ",", 
                 "a1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"phr3", ",", "a3"}], "}"}]}], "}"}]}], "]"}]}]}], 
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"hadropt", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
        "HadronizationOptionChoice", "==", "\"\<Hadronized products\>\""}], 
        ",", "\"\<True\>\"", ",", "\"\<False\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"acceptancetypechoice", "==", "\"\<>=n\>\""}], ",", 
       RowBox[{
        RowBox[{"DynamicModule", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"input1", "=", "2"}], ",", "list", ",", "phrase"}], "}"}],
           ",", "\[IndentingNewLine]", 
          RowBox[{"DialogInput", "[", 
           RowBox[{"Column", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
              "TextCell", "[", 
               "\"\<Enter the minimal number of detectable tracks:\>\"", 
               "]"}], ",", 
              RowBox[{"InputField", "[", 
               RowBox[{
                RowBox[{"Dynamic", "[", "input1", "]"}], ",", "Expression"}], 
               "]"}], ",", 
              RowBox[{"Button", "[", 
               RowBox[{"\"\<Submit\>\"", ",", 
                RowBox[{"DialogReturn", "[", 
                 RowBox[{
                  RowBox[{"{", "ntracksmin", "}"}], "=", 
                  RowBox[{"{", "input1", "}"}]}], "]"}], ",", 
                RowBox[{"ImageSize", "->", "Automatic"}]}], "]"}]}], "}"}], 
            "]"}], "]"}]}], "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"decaychannelschoice", "=", 
        RowBox[{"dropdownDialog", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<Yes\>\"", ",", "\"\<No\>\""}], "}"}], ",", 
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{"\"\<Default decay chanels: \>\"", ",", 
             RowBox[{"ProcessesListRefined", "[", 
              RowBox[{
              "LLPchoiceForComputation", ",", "ECALoptionGivenExperiment"}], 
              "]"}], ",", "\"\<. Keep them?\>\""}], "}"}], "]"}]}], "]"}]}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "List", " ", "of", " ", "decay", " ", "processes", " ", "considered", 
       " ", "as", " ", "visible", " ", "for", " ", "the", " ", "given", " ", 
       "calculation"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"proclist", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"decaychannelschoice", "==", "\"\<No\>\""}], ",", " ", 
        RowBox[{"selectionDialog", "[", 
         RowBox[{
          RowBox[{"ProcessesListRefined", "[", 
           RowBox[{
           "LLPchoiceForComputation", ",", "ECALoptionGivenExperiment"}], 
           "]"}], ",", "\"\<Select decay channels:\>\""}], "]"}], ",", 
        RowBox[{"ProcessesListRefined", "[", 
         RowBox[{
         "LLPchoiceForComputation", ",", "ECALoptionGivenExperiment"}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "The", " ", "total", " ", "branching", " ", "ratio", " ", "of", " ", 
       "the", " ", "selected", " ", "visible", " ", "channels"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"BrVisibleExport", "[", "mLLP_", "]"}], "=", 
      RowBox[{"BrVisibleGivenSetup", "[", 
       RowBox[{
       "LLPchoiceForComputation", ",", "mLLP", ",", "proclist", ",", 
        "ECALoptionGivenExperiment"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Redefining", " ", "the", " ", "mass", " ", "list", " ", "such", " ", 
        "that", " ", "it", " ", "matches", " ", "the", " ", "domain", " ", 
        "where", " ", "the", " ", "br", " ", "ratio", " ", "of", " ", 
        "selected", " ", "channels", " ", "is", " ", "non"}], "-", "zero"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"tabbrvis", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"mLLP", ",", 
          RowBox[{"BrVisibleExport", "[", "mLLP", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"mLLP", ",", 
          RowBox[{"masslist", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"masslist", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], ",", 
          FractionBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"masslist", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}], "-", 
             RowBox[{"masslist", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "100"]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"mminnonzero", ",", "mmaxnonzero"}], "}"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"tabbrvis", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ">", 
            SuperscriptBox["10", 
             RowBox[{"-", "15."}]]}], "&"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "MinMax"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"masslist", "=", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", "mminnonzero", "}"}], ",", 
         RowBox[{"Select", "[", 
          RowBox[{"masslist", ",", 
           RowBox[{
            RowBox[{"mminnonzero", "<", "#", "<", "mmaxnonzero"}], "&"}]}], 
          "]"}], ",", 
         RowBox[{"{", "mmaxnonzero", "}"}]}], "]"}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Calculation", " ", "of", " ", "the", " ", "decay", " ", "products", 
       " ", "acceptance", " ", "for", " ", "the", " ", "selected", " ", 
       "visible", " ", "channels"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "proclist", "]"}], "*", 
         RowBox[{"Length", "[", "masslist", "]"}]}], "\[NotEqual]", "0"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"tabcomp", "=", 
          RowBox[{"Monitor", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"FinalBlockMass", "[", 
               RowBox[{"LLPchoiceForComputation", ",", 
                RowBox[{"masslist", "[", 
                 RowBox[{"[", "l", "]"}], "]"}], ",", "proclist", ",", "isim",
                 ",", "hadropt", ",", "acceptancetypechoice"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"l", ",", "1", ",", 
                RowBox[{"Length", "[", "masslist", "]"}], ",", "1"}], "}"}]}],
              "]"}], ",", 
            RowBox[{"Row", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"ProgressIndicator", "[", 
                 RowBox[{"l", ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Length", "[", "masslist", "]"}]}], "}"}]}], 
                 "]"}], ",", "\"\<i = \>\"", ",", "l", ",", "\"\</\>\"", ",", 
                RowBox[{"Length", "[", "masslist", "]"}], ",", 
                "\"\< (\!\(\*SubscriptBox[\(m\), \(LLP\)]\) = \>\"", ",", 
                RowBox[{"masslist", "[", 
                 RowBox[{"[", "l", "]"}], "]"}], ",", "\"\< GeV)\>\""}], 
               "}"}], ",", "\"\< \>\""}], "]"}]}], "]"}]}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tabcomp", "=", 
         RowBox[{
          RowBox[{"ResourceFunction", "[", "\"\<MonitorProgress\>\"", "]"}], 
          "@", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"FinalBlockMass", "[", 
             RowBox[{"LLPchoiceForComputation", ",", 
              RowBox[{"masslist", "[", 
               RowBox[{"[", "l", "]"}], "]"}], ",", "proclist", ",", "isim", 
              ",", "hadropt", ",", "acceptancetypechoice", ",", 
              "ntracksmin"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"l", ",", "1", ",", 
              RowBox[{"Length", "[", "masslist", "]"}], ",", "1"}], "}"}]}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"GivenExperimentNameFin", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"hadropt", "==", "\"\<True\>\""}], ",", 
           "GivenExperimentName", ",", 
           RowBox[{
           "GivenExperimentName", "<>", "\"\<-no-hadronization\>\""}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"filenameexport", "=", 
         RowBox[{"ToString", "@", 
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<Acceptance_``_for_``.m\>\"", ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"{", 
              RowBox[{"GivenExperimentNameFin", ",", "LLP"}], "}"}]}]}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Flatten", "[", 
         RowBox[{"tabcomp", ",", "1"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<No processes for the given LLP/ECAL availability!\>\"", "]"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BlockExport", "[", 
   RowBox[{"LLP_", ",", "isim_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"datatemp", "=", 
      RowBox[{"FinalBlock", "[", 
       RowBox[{"LLP", ",", "isim"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Acceptances\>\"", 
         ",", "GivenExperimentNameFin", ",", "filenameexport"}], "}"}], "]"}],
       ",", 
      RowBox[{"{", 
       RowBox[{
       "FacilityGivenExperiment", ",", "ECALoptionGivenExperiment", ",", 
        "datatemp", ",", "TableParticlesNumbersGivenExperiment", ",", 
        RowBox[{"BrVisibleExport", "[", "mLLP", "]"}]}], "}"}], ",", 
      "\"\<MX\>\""}], "]"}], "*)"}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.893582961950735*^9, 3.8935829626824627`*^9}, {
   3.8936893968848577`*^9, 3.8936893974606404`*^9}, {3.8987005042228255`*^9, 
   3.8987005045734777`*^9}, {3.898701856337847*^9, 3.8987018623241267`*^9}, {
   3.898702456562152*^9, 3.8987024568267717`*^9}, {3.9017249679866066`*^9, 
   3.9017249724113703`*^9}, {3.904067171324582*^9, 3.9040671852963543`*^9}, {
   3.9047945111480904`*^9, 3.904794559583746*^9}, 3.904834450990146*^9, {
   3.904888618187772*^9, 3.9048886511067495`*^9}, {3.9048892180834365`*^9, 
   3.90488923991012*^9}, {3.9048904389388885`*^9, 3.904890452962327*^9}, {
   3.9049003499917736`*^9, 3.904900353883464*^9}, {3.9052302407603493`*^9, 
   3.905230377096493*^9}, {3.90523041779224*^9, 3.9052304254511085`*^9}, {
   3.9052308097081423`*^9, 3.9052309050531793`*^9}, {3.905230941820487*^9, 
   3.9052310027655926`*^9}, {3.9052311542718744`*^9, 
   3.9052311562723665`*^9}, {3.9053982154172344`*^9, 3.905398226607583*^9}, {
   3.9058418660121374`*^9, 3.905841914591055*^9}, {3.9059623107307734`*^9, 
   3.905962324614109*^9}, {3.911975955618017*^9, 3.9119760457698507`*^9}, {
   3.9120943834183598`*^9, 3.9120943881616373`*^9}, 3.912160528921958*^9, {
   3.9121608162295923`*^9, 3.9121608212176695`*^9}, {3.912160854627734*^9, 
   3.9121608741677265`*^9}, {3.9121609169415236`*^9, 3.912160984697664*^9}, {
   3.912161033729065*^9, 3.9121610627265167`*^9}, {3.9121616942577887`*^9, 
   3.912161770187453*^9}, {3.9121618050186462`*^9, 3.9121618848486147`*^9}, {
   3.912161952048806*^9, 3.912162006347658*^9}, {3.9121620789990873`*^9, 
   3.912162119327769*^9}, {3.9140930898495655`*^9, 3.9140930989757533`*^9}, {
   3.9145744286332293`*^9, 3.9145744459937925`*^9}, {3.915260318491085*^9, 
   3.9152603728655033`*^9}, {3.9152604087304316`*^9, 
   3.9152605416276956`*^9}, {3.915260943724496*^9, 3.915260967955821*^9}, {
   3.9152616104848614`*^9, 3.915261636404451*^9}, {3.9152616759874287`*^9, 
   3.9152617007513895`*^9}, {3.916889941032504*^9, 3.916889941216895*^9}, {
   3.9199597120951076`*^9, 3.919959723339954*^9}, {3.919960371967874*^9, 
   3.91996037683177*^9}, {3.9199639985255456`*^9, 3.9199640161202364`*^9}, 
   3.9200135155421076`*^9, 3.935631021330042*^9, {3.935631849978203*^9, 
   3.935631877438553*^9}, {3.935636266111429*^9, 3.935636270077362*^9}},
 CellTags->{"Evaluation", "Re-evaluation"},
 CellLabel->
  "In[277]:=",ExpressionUUID->"038c1ab8-352c-4f0a-b20f-18632e7b8ff7"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Actual computation of the decay acceptance", "Chapter",
 CellChangeTimes->{{3.8850061437436857`*^9, 3.8850061450832815`*^9}, {
   3.886145449456651*^9, 3.8861454859360905`*^9}, {3.887781460454486*^9, 
   3.8877814772686296`*^9}, 3.8882541572532434`*^9, 3.8896946090029707`*^9, {
   3.8908162850087905`*^9, 3.89081628646469*^9}, 3.8933529899662642`*^9, {
   3.893436990617954*^9, 3.893436996266165*^9}},
 CellTags->{
  "Evaluation", 
   "Re-evaluation"},ExpressionUUID->"da3b7ec0-b669-408d-a6e2-09447629531d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"BlockAcceptanceComputation", "[", "LLP_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nb", "=", 
      RowBox[{"EvaluationNotebook", "[", "]"}]}], ";", "\n", 
     RowBox[{"NotebookFind", "[", 
      RowBox[{"nb", ",", "LLP", ",", "All", ",", "CellTags"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<List of LLPs:\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"LLPlistReduced", "=", 
  RowBox[{
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"LLPlist", ",", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\"\<HNL-mixing-e\>\"", ",", "\"\<HNL-mixing-mu\>\"", ",", 
             "\"\<HNL-mixing-tau\>\"", ",", 
             "\"\<ALP-fermion-no-hadronic-decays\>\""}], "}"}], ",", "#"}], 
          "]"}]}], "&"}]}], "]"}], ",", 
     RowBox[{"{", "\"\<HNL\>\"", "}"}]}], "]"}], "//", 
   "Sort"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"selectionDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", 
      RowBox[{"{", "}"}]}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{"{", "phrase", "}"}], "]"}], ",", 
       RowBox[{"TogglerBar", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list", ",", 
         RowBox[{"Appearance", "->", "\"\<Vertical\>\""}]}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<List of LLPs for which the acceptance will be computed:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"SelectedLLPlistTemp", "=", 
  RowBox[{"selectionDialog", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Join", "[", "LLPlistReduced", "]"}], "//", "Sort"}], ",", 
    "\"\<Select LLPs for which acceptances will be computed:\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SelectedLLPlist", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"SelectedLLPlistTemp", ",", 
     RowBox[{"{", "\"\<Technical\>\"", "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GivenExperimentName", "=", 
   RowBox[{"DialogInput", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cut", "=", "GivenExperiment"}], "}"}], ",", 
     RowBox[{"Column", "[", 
      RowBox[{"{", 
       RowBox[{"\"\<Enter the name of the experiment for exporting:\>\"", ",", 
        RowBox[{"InputField", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "cut", "]"}], ",", "String"}], "]"}], ",", 
        RowBox[{"Button", "[", 
         RowBox[{"\"\<Proceed\>\"", ",", 
          RowBox[{"DialogReturn", "[", "cut", "]"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Automatic"}]}], "]"}]}], "}"}], 
      "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DirectoryQ", "[", "\"\<Acceptances\>\"", "]"}], "//", 
       "ToString"}], ")"}], "\[Equal]", "\"\<False\>\""}], ",", 
    RowBox[{"CreateDirectory", "[", "\"\<Acceptances\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DirectoryQ", "[", 
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{"\"\<Acceptances\>\"", ",", "GivenExperimentName"}], "}"}],
           "]"}], "]"}], "//", "ToString"}], ")"}], "\[Equal]", 
      "\"\<False\>\""}], ",", 
     RowBox[{"CreateDirectory", "[", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<Acceptances\>\"", ",", "GivenExperimentName"}], "}"}], 
       "]"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"ChoiceDialog", "[", 
    RowBox[{
    "\"\<Choose the LLP for which acceptances will be computed:\>\"", ",", 
     RowBox[{"Join", "[", 
      RowBox[{"LLPlistReduced", ",", 
       RowBox[{"{", "\"\<All\>\"", "}"}]}], "]"}], ",", 
     RowBox[{"Appearance", "\[Rule]", 
      RowBox[{"\"\<Vertical\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Automatic", ",", "3"}], "}"}]}]}]}], "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ivaltest", "=", "1000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"BlockAcceptanceComputation", "[", 
    RowBox[{"SelectedLLPlist", "[", 
     RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "SelectedLLPlist", "]"}], ",", "1"}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{
  3.8896950595137253`*^9, {3.8904130243273077`*^9, 3.890413033547454*^9}, {
   3.890413133306282*^9, 3.890413164761125*^9}, {3.8904141629070535`*^9, 
   3.8904141638350925`*^9}, 3.892883367269068*^9, {3.893233746308257*^9, 
   3.8932337700855803`*^9}, {3.8933482345206532`*^9, 3.8933482501765194`*^9}, 
   3.8941244115567007`*^9, {3.8987018737205153`*^9, 3.8987018753553934`*^9}, {
   3.8987019122797337`*^9, 3.8987019130039053`*^9}, {3.9017337142875385`*^9, 
   3.90173376901267*^9}, {3.9025586059197598`*^9, 3.9025586311667233`*^9}, {
   3.9040631070251017`*^9, 3.9040631285708213`*^9}, {3.904066967949132*^9, 
   3.9040670647256765`*^9}, {3.9040678761475725`*^9, 3.904067898822685*^9}, {
   3.9048341779179535`*^9, 3.904834192131352*^9}, {3.9048359432939706`*^9, 
   3.904835954657815*^9}, 3.904838398370827*^9, {3.904844835522743*^9, 
   3.904844901294034*^9}, 3.9048887436571302`*^9, {3.9048894090370913`*^9, 
   3.9048894141924086`*^9}, 3.9048906466333795`*^9, 3.904890765032191*^9, 
   3.904890980838414*^9, 3.904897590267807*^9, 3.9049000802951903`*^9, 
   3.9049004991668596`*^9, {3.905230785136306*^9, 3.90523079506658*^9}, {
   3.9058418190778837`*^9, 3.905841823751466*^9}, {3.9102609081252975`*^9, 
   3.910260941495719*^9}, {3.9112333698084307`*^9, 3.911233370546249*^9}, {
   3.9121617786487746`*^9, 3.912161778887848*^9}, {3.912162163367823*^9, 
   3.912162163601643*^9}, 3.9144053197263775`*^9, {3.9145708919757957`*^9, 
   3.9145708948954563`*^9}, {3.916889941233*^9, 3.9168899412797704`*^9}},
 CellTags->{"Evaluation", "Re-evaluation"},
 CellLabel->
  "In[287]:=",ExpressionUUID->"57e9a41d-0896-4230-a4c5-a35b43efa2a2"],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox["\<\"List of LLPs for which the acceptance will be computed:\"\>", 
  TraditionalForm]], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{3.9152934519456854`*^9, 3.9152945764080133`*^9, 
  3.9168899412797704`*^9, 3.916897337687912*^9, 3.935630887420328*^9},
 CellTags->{"Evaluation", "Re-evaluation"},
 CellLabel->
  "During evaluation of \
In[778]:=",ExpressionUUID->"ef756479-c3c9-cb45-a723-4ba3cbd8c868"],

Cell[BoxData[
 FormBox["\<\"List of LLPs:\"\>", TraditionalForm]], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{3.9152934519456854`*^9, 3.9152945764080133`*^9, 
  3.9168899412797704`*^9, 3.916897337687912*^9, 3.9356308874058094`*^9},
 CellTags->{"Evaluation", "Re-evaluation"},
 CellLabel->
  "During evaluation of \
In[778]:=",ExpressionUUID->"1724ce5e-ef20-3840-9734-b4a0680b92bb"],

Cell[BoxData["\<\"List of LLPs for which the acceptance will be \
computed:\"\>"], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{3.9152934519456854`*^9, 3.9152945764080133`*^9, 
  3.9168899412797704`*^9, 3.916897337687912*^9},
 CellTags->{"Evaluation", "Re-evaluation"},
 CellLabel->
  "During evaluation of \
In[2047]:=",ExpressionUUID->"0b0c6f28-15f4-4816-bb8a-bc2762136e45"],

Cell[BoxData["\<\"List of LLPs:\"\>"], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{3.9152934519456854`*^9, 3.9152945764080133`*^9, 
  3.9168899412797704`*^9, 3.916897337678895*^9},
 CellTags->{"Evaluation", "Re-evaluation"},
 CellLabel->
  "During evaluation of \
In[2047]:=",ExpressionUUID->"e4216446-ae9f-4e72-b238-b37a5c34e8fd"],

Cell[BoxData[
 FormBox["\<\"List of LLPs:\"\>", TraditionalForm]], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{3.9152934519456854`*^9, 3.9152945764080133`*^9, 
  3.9168899412797704`*^9},
 CellTags->{
  "Evaluation", 
   "Re-evaluation"},ExpressionUUID->"cd617635-c0c2-4400-b730-ff5999bd38b5"]
}, Closed]],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"\<\"ALP-fermion\"\>", ",", "\<\"ALP-gluon\"\>", 
    ",", "\<\"ALP-photon\"\>", ",", "\<\"B-3Le-Lmu+Ltau\"\>", 
    ",", "\<\"B-3Lmu\"\>", ",", "\<\"B-L\"\>", ",", "\<\"B-Le-3Lmu+Ltau\"\>", 
    ",", "\<\"DP\"\>", ",", "\<\"HNL\"\>", ",", "\<\"Scalar\"\>"}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.9152934519530706`*^9, 3.9152945764136868`*^9},
 CellTags->{"Evaluation", "Re-evaluation"},
 CellLabel->
  "Out[1053]=",ExpressionUUID->"f679aa18-de6e-4bbe-a042-b14510e9ac65"],

Cell[BoxData[
 FormBox["\<\"List of LLPs for which the acceptance will be computed:\"\>", 
  TraditionalForm]], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{3.9152934519456854`*^9, 3.9152945764177074`*^9, 
  3.9168899412954254`*^9},
 CellTags->{
  "Evaluation", 
   "Re-evaluation"},ExpressionUUID->"94b39adf-67a9-4736-bff8-d15778dc8e85"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", "\<\"ALP-fermion\"\>", "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.9152934519530706`*^9, 3.915294578934246*^9},
 CellTags->{"Evaluation", "Re-evaluation"},
 CellLabel->
  "Out[1056]=",ExpressionUUID->"db4fd183-1dcc-4b68-a93a-a1a213858c96"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Chapter to be automatically launched by the previous chapter. No need to \
launch it manually\
\>", "Title",
 CellChangeTimes->{{3.8896883278364477`*^9, 
  3.889688379627076*^9}},ExpressionUUID->"b4a43d11-cb45-4248-9b58-\
fa3cbda961f9"],

Cell[CellGroupData[{

Cell["Scalar", "Chapter",
 CellChangeTimes->{{3.8896886159303627`*^9, 3.8896886165850496`*^9}, {
   3.890211278099838*^9, 3.89021127819596*^9}, {3.890211408420647*^9, 
   3.890211411055007*^9}, 3.914573595807684*^9},
 CellTags->{
  "Scalar", "All"},ExpressionUUID->"bbaa7b71-c5de-463d-bc5f-bcee80cecd62"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dataS", "=", 
    RowBox[{"BlockExport", "[", 
     RowBox[{"\"\<Scalar\>\"", ",", "ivaltest"}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8896885802459803`*^9, 3.8896885827689047`*^9}, {
   3.890286002584097*^9, 3.890286005940942*^9}, {3.890410901345583*^9, 
   3.8904109035068307`*^9}, 3.8906394066157846`*^9, {3.890816223385516*^9, 
   3.890816223619833*^9}, {3.8913265507626486`*^9, 3.891326566098019*^9}, {
   3.8913266097136097`*^9, 3.8913266114175863`*^9}, {3.8913268968571424`*^9, 
   3.891326907713011*^9}, {3.898701929394251*^9, 3.898701930138372*^9}, {
   3.9017250415954337`*^9, 3.901725043232337*^9}, {3.903978340083085*^9, 
   3.9039783412366867`*^9}, {3.9039798655576477`*^9, 3.9039798665096188`*^9}, 
   3.904066812814445*^9, {3.9040669084551287`*^9, 3.9040669089997005`*^9}, 
   3.9048341958212495`*^9, 3.9121621757178483`*^9},
 CellTags->{"Scalar", "All"},
 CellLabel->
  "In[717]:=",ExpressionUUID->"699077d2-5244-4855-8318-7861677ff4d4"]
}, Closed]],

Cell[CellGroupData[{

Cell["HNL", "Chapter",
 CellChangeTimes->{{3.8896886159303627`*^9, 3.8896886165850496`*^9}, {
   3.889688683716093*^9, 3.8896886857401342`*^9}, 3.9145735968644953`*^9},
 CellTags->{
  "All", "HNL"},ExpressionUUID->"1c9c1db2-e817-43c7-a1c1-dc058a49f093"],

Cell[CellGroupData[{

Cell["e mixing", "Section",
 CellChangeTimes->{{3.8896776028040915`*^9, 3.88967761588931*^9}, {
  3.8896886191080112`*^9, 3.889688643231896*^9}, {3.8908159984033375`*^9, 
  3.890815999325034*^9}},
 CellTags->{
  "All", "HNL"},ExpressionUUID->"1e4fb3e2-de7d-4190-989a-2ba85613b49e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dataS", "=", 
    RowBox[{"BlockExport", "[", 
     RowBox[{"\"\<HNL-mixing-e\>\"", ",", "ivaltest"}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.890816018273184*^9, 3.890816020624732*^9}, {
   3.8908160568387513`*^9, 3.890816062188861*^9}, {3.8913269142971125`*^9, 
   3.8913269178328753`*^9}, {3.8987019570852327`*^9, 3.8987019581146774`*^9}, 
   3.9017250472823524`*^9, 3.904066814812254*^9, 3.904066911590951*^9, 
   3.9048341997893047`*^9, 3.9121621778076906`*^9},
 CellTags->{"All", "HNL"},
 CellLabel->
  "In[890]:=",ExpressionUUID->"3ed8b495-ecc2-4582-9e0d-3e71f7277e93"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[Mu] mixing", "Section",
 CellChangeTimes->{{3.8896776028040915`*^9, 3.88967761588931*^9}, {
  3.8896886191080112`*^9, 3.889688643231896*^9}, {3.8908159984033375`*^9, 
  3.890816006127554*^9}},
 CellTags->{
  "All", "HNL"},ExpressionUUID->"f8b65d43-6d66-48d3-af23-ebb851dbcef2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dataS", "=", 
    RowBox[{"BlockExport", "[", 
     RowBox[{"\"\<HNL-mixing-mu\>\"", ",", "ivaltest"}], "]"}]}], ";"}], "//",
   "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.890816046930589*^9, 3.8908160685155964`*^9}, {
   3.8913269211286597`*^9, 3.8913269239969816`*^9}, {3.8987019615871563`*^9, 
   3.8987019623446865`*^9}, 3.901725049237804*^9, 3.9040631285756426`*^9, 
   3.904066816853175*^9, 3.9040669132764196`*^9, 3.904834201138288*^9, 
   3.912162179791603*^9},
 CellTags->{"All", "HNL"},
 CellLabel->
  "In[891]:=",ExpressionUUID->"bad4ddac-67cc-4922-bab4-33fcc98f4b5f"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[Tau] mixing", "Section",
 CellChangeTimes->{{3.8896776028040915`*^9, 3.88967761588931*^9}, {
  3.8896886191080112`*^9, 3.889688643231896*^9}, {3.8908159984033375`*^9, 
  3.8908160107629995`*^9}},
 CellTags->{
  "All", "HNL"},ExpressionUUID->"246606c9-e825-4a9b-86a0-2b61184a5aa1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dataS", "=", 
    RowBox[{"BlockExport", "[", 
     RowBox[{"\"\<HNL-mixing-tau\>\"", ",", "1000"}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8908160518188677`*^9, 3.8908160779349165`*^9}, {
   3.891326926176611*^9, 3.8913269324090004`*^9}, {3.8987019639933434`*^9, 
   3.898701969297323*^9}, 3.901725051096363*^9, 3.904063107035528*^9, 
   3.9040668188833933`*^9, 3.904066915002926*^9, 3.9048342033923273`*^9, {
   3.9068009449239655`*^9, 3.9068009731559124`*^9}, 3.9121621819574184`*^9},
 CellTags->{"All", "HNL"},
 CellLabel->
  "In[892]:=",ExpressionUUID->"5a3395e6-b65d-4219-ab18-8f1212a83888"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Dark photon", "Chapter",
 CellChangeTimes->{{3.8896886159303627`*^9, 3.8896886165850496`*^9}, {
  3.8896886874423647`*^9, 3.889688689953738*^9}},
 CellTags->{
  "DP", "All"},ExpressionUUID->"b006c7e4-9235-48b6-acf0-5f68ba37a4de"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dataS", "=", 
    RowBox[{"BlockExport", "[", 
     RowBox[{"\"\<DP\>\"", ",", "ivaltest"}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8896885802459803`*^9, 3.8896885827689047`*^9}, {
   3.889694214540489*^9, 3.8896942153880816`*^9}, {3.890410983681602*^9, 
   3.8904109839319196`*^9}, 3.8904133470651274`*^9, {3.890816085201006*^9, 
   3.8908160911196613`*^9}, {3.891326934409067*^9, 3.8913269372174606`*^9}, 
   3.898701970718356*^9, 3.9017250523184357`*^9, 3.9040668239528775`*^9, 
   3.9040669177932444`*^9, 3.9048342049248123`*^9, 3.9121621835377707`*^9},
 CellTags->{"DP", "All"},
 CellLabel->
  "In[299]:=",ExpressionUUID->"54fe7186-2a6f-49bd-80fa-20f726215da5"]
}, Closed]],

Cell[CellGroupData[{

Cell["ALP-fermion", "Chapter",
 CellChangeTimes->{{3.8896886159303627`*^9, 3.8896886165850496`*^9}, {
  3.889688691481767*^9, 3.8896886928026557`*^9}},
 CellTags->{
  "All", "ALP-fermion"},ExpressionUUID->"f895a2e3-dd51-4275-9ad6-\
cb8a2d25bea8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dataS", "=", 
    RowBox[{"BlockExport", "[", 
     RowBox[{"\"\<ALP-fermion\>\"", ",", "ivaltest"}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8908161001874895`*^9, 3.8908161065598884`*^9}, {
   3.8913269399930305`*^9, 3.891326945104858*^9}, 3.8933482501790314`*^9, 
   3.8987019722492504`*^9, 3.9017250538282585`*^9, 3.904066826595016*^9, 
   3.9040669198609405`*^9, {3.904834207299658*^9, 3.90483420850706*^9}, 
   3.9121621859574027`*^9},
 CellTags->{"All", "ALP-fermion"},
 CellLabel->
  "In[774]:=",ExpressionUUID->"b728d505-2207-4e5e-841c-de8a87a4bb1d"]
}, Closed]],

Cell[CellGroupData[{

Cell["ALP-gluon", "Chapter",
 CellChangeTimes->{{3.8896886159303627`*^9, 3.8896886165850496`*^9}, {
  3.8896886944223056`*^9, 3.8896886966354637`*^9}},
 CellTags->{
  "All", "ALP-gluon"},ExpressionUUID->"bf90cb15-6490-441b-8316-f0b08b88a5dd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dataS", "=", 
    RowBox[{"BlockExport", "[", 
     RowBox[{"\"\<ALP-gluon\>\"", ",", "ivaltest"}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8896885802459803`*^9, 3.8896885827689047`*^9}, {
   3.8896899373248334`*^9, 3.8896899390426464`*^9}, {3.8904109916380396`*^9, 
   3.8904109920829134`*^9}, 3.8904133374848413`*^9, {3.8908161143241005`*^9, 
   3.8908161290543623`*^9}, {3.8913269484244795`*^9, 3.891326951768643*^9}, 
   3.8933482428877687`*^9, 3.898701973231733*^9, 3.9017250559509397`*^9, 
   3.904066829718545*^9, 3.9040669227381296`*^9, {3.9048342103581743`*^9, 
   3.904834210506663*^9}, 3.9121621876083264`*^9},
 CellTags->{"All", "ALP-gluon"},
 CellLabel->
  "In[2575]:=",ExpressionUUID->"1e460815-2625-4c6f-903c-38d9c89aa22a"]
}, Closed]],

Cell[CellGroupData[{

Cell["ALP-photon", "Chapter",
 CellChangeTimes->{{3.8896886159303627`*^9, 3.8896886165850496`*^9}, {
  3.8896886980974836`*^9, 3.889688699338743*^9}},
 CellTags->{
  "All", "ALP-photon"},ExpressionUUID->"fe998291-7eb5-44c3-9a88-45a1e678e2ad"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dataS", "=", 
    RowBox[{"BlockExport", "[", 
     RowBox[{"\"\<ALP-photon\>\"", ",", "ivaltest"}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8908161401122093`*^9, 3.8908161460060034`*^9}, {
   3.8913269550648193`*^9, 3.891326958625289*^9}, 3.8933482345256605`*^9, 
   3.898701974555247*^9, 3.901725057262084*^9, 3.904834212239154*^9, 
   3.912162189787862*^9},
 CellTags->{"All", "ALP-photon"},
 CellLabel->
  "In[2576]:=",ExpressionUUID->"86f38a14-6add-444a-8c8e-934849c5f2c9"]
}, Closed]],

Cell[CellGroupData[{

Cell["B-L mediator", "Chapter",
 CellChangeTimes->{{3.8896886159303627`*^9, 3.8896886165850496`*^9}, {
  3.8896886980974836`*^9, 3.889688699338743*^9}, {3.8941245471984444`*^9, 
  3.8941245487614183`*^9}},
 CellTags->{
  "All", "B-L"},ExpressionUUID->"1c928aac-e1bd-444d-8f5d-bb01858a0b9e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dataS", "=", 
    RowBox[{"BlockExport", "[", 
     RowBox[{"\"\<B-L\>\"", ",", "ivaltest"}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8908161401122093`*^9, 3.8908161460060034`*^9}, {
   3.8913269550648193`*^9, 3.891326958625289*^9}, 3.8933482345256605`*^9, {
   3.8941245521775813`*^9, 3.894124552789379*^9}, 3.8987019761246915`*^9, 
   3.9017250586568685`*^9, 3.904066832304923*^9, 3.9040669251551285`*^9, 
   3.9048342176353683`*^9, {3.9121621917176294`*^9, 3.9121621939677258`*^9}},
 CellTags->{"All", "B-L"},
 CellLabel->
  "In[2582]:=",ExpressionUUID->"4587e325-7527-4ae4-8b5d-9c0f2f5bacae"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"B", "-", 
    RowBox[{"3", 
     SubscriptBox["L", "\[Mu]"]}]}], TraditionalForm]],ExpressionUUID->
  "27958cb8-f109-4ac3-8261-7392b3cebe4b"],
 " mediator"
}], "Chapter",
 CellChangeTimes->{{3.8896886159303627`*^9, 3.8896886165850496`*^9}, {
  3.8896886980974836`*^9, 3.889688699338743*^9}, {3.8941245471984444`*^9, 
  3.8941245487614183`*^9}, {3.8963272477784033`*^9, 3.896327248648427*^9}},
 CellTags->{
  "All", "B-3Lmu"},ExpressionUUID->"f910c5d8-2d47-4ef3-b74e-1ffcff1ac1c6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dataS", "=", 
    RowBox[{"BlockExport", "[", 
     RowBox[{"\"\<B-3Lmu\>\"", ",", "ivaltest"}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8908161401122093`*^9, 3.8908161460060034`*^9}, {
   3.8913269550648193`*^9, 3.891326958625289*^9}, 3.8933482345256605`*^9, {
   3.8941245521775813`*^9, 3.894124552789379*^9}, {3.896327250054564*^9, 
   3.896327251023274*^9}, 3.898701977787983*^9, 3.9017250604750338`*^9, 
   3.9040668348207035`*^9, 3.9040669273338366`*^9, 3.9048342189092026`*^9, 
   3.912162196467767*^9},
 CellTags->{"All", "B-3Lmu"},
 CellLabel->
  "In[1684]:=",ExpressionUUID->"026e067e-b766-4284-bb3d-1bd2aabaebc1"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"B", "-", 
    RowBox[{"3", 
     SubscriptBox["L", "e"]}], "-", 
    SubscriptBox["L", "\[Mu]"], "+", 
    SubscriptBox["L", "\[Tau]"]}], TraditionalForm]],ExpressionUUID->
  "2fc339ce-1efd-49a4-9c5a-48fa7068aba1"],
 " mediator"
}], "Chapter",
 CellChangeTimes->{{3.8896886159303627`*^9, 3.8896886165850496`*^9}, {
  3.8896886980974836`*^9, 3.889688699338743*^9}, {3.8941245471984444`*^9, 
  3.8941245487614183`*^9}, {3.8963273153961496`*^9, 3.8963273195096984`*^9}},
 CellTags->{
  "All", "B-3Le-Lmu+Ltau"},ExpressionUUID->"01563783-279f-4977-a8a4-\
cff0a0e598d5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dataS", "=", 
    RowBox[{"BlockExport", "[", 
     RowBox[{"\"\<B-3Le-Lmu+Ltau\>\"", ",", "ivaltest"}], "]"}]}], ";"}], "//",
   "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8908161401122093`*^9, 3.8908161460060034`*^9}, {
   3.8913269550648193`*^9, 3.891326958625289*^9}, 3.8933482345256605`*^9, {
   3.8941245521775813`*^9, 3.894124552789379*^9}, {3.896327307150777*^9, 
   3.8963273127352066`*^9}, 3.8987019795558057`*^9, 3.9017250617527933`*^9, 
   3.904066851661615*^9, 3.9040669306381903`*^9, 3.904834221087583*^9, 
   3.912162198698868*^9},
 CellTags->{"All", "B-3Le-Lmu+Ltau"},
 CellLabel->
  "In[1686]:=",ExpressionUUID->"cab98ae5-0681-448c-a04c-d81238c69ee5"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"B", "-", 
    SubscriptBox["L", "e"], "-", 
    RowBox[{"3", 
     SubscriptBox["L", "\[Mu]"]}], "+", 
    SubscriptBox["L", "\[Tau]"]}], TraditionalForm]],ExpressionUUID->
  "db030216-f92a-441d-828b-891da98006c2"],
 " mediator"
}], "Chapter",
 CellChangeTimes->{{3.8896886159303627`*^9, 3.8896886165850496`*^9}, {
  3.8896886980974836`*^9, 3.889688699338743*^9}, {3.8941245471984444`*^9, 
  3.8941245487614183`*^9}, {3.8963273223545914`*^9, 3.8963273265510225`*^9}},
 CellTags->{
  "All", "B-Le-3Lmu+Ltau"},ExpressionUUID->"80184ca5-803c-4432-8e71-\
e11c163bb2dc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dataS", "=", 
    RowBox[{"BlockExport", "[", 
     RowBox[{"\"\<B-Le-3Lmu+Ltau\>\"", ",", "ivaltest"}], "]"}]}], ";"}], "//",
   "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8908161401122093`*^9, 3.8908161460060034`*^9}, {
   3.8913269550648193`*^9, 3.891326958625289*^9}, 3.8933482345256605`*^9, {
   3.8941245521775813`*^9, 3.894124552789379*^9}, {3.8963273009815197`*^9, 
   3.8963273048769073`*^9}, 3.898701981125592*^9, 3.901725063275606*^9, 
   3.904066853813018*^9, 3.9040669328055983`*^9, 3.9048342225080447`*^9, 
   3.9121622006192255`*^9},
 CellTags->{"All", "B-Le-3Lmu+Ltau"},
 CellLabel->
  "In[1686]:=",ExpressionUUID->"70ae1e98-041d-4edf-a42c-9edd436a9af1"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Delete generated cells", "Title",
 CellChangeTimes->{{3.920047974251646*^9, 
  3.9200479780877523`*^9}},ExpressionUUID->"1cf35ccb-ac3a-484a-a861-\
545f2caeee7a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FrontEndTokenExecute", "[", "\"\<DeleteGeneratedCells\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FrontEndTokenExecute", "[", "\"\<SelectAll\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "FrontEndTokenExecute", "[", "\"\<SelectionCloseAllGroups\>\"", "]"}], 
  ";"}]}], "Input",
 CellLabel->
  "In[300]:=",ExpressionUUID->"c4efea97-2e10-472c-953b-5e7df7dd7aac"]
}, Closed]]
},
WindowSize->{1142.1, 652.5},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
ShowCellTags->True,
Magnification:>0.8 Inherited,
FrontEndVersion->"14.1 for Microsoft Windows (64-bit) (July 16, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"0856ecdb-dcfc-42c4-a383-a9a67dbd6690"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Evaluation"->{
  Cell[1577, 46, 318, 5, 68, "Title",ExpressionUUID->"f0d20480-5665-403d-a88a-e38db6e4fff2",
   CellTags->"Evaluation"],
  Cell[1920, 55, 221, 3, 65, "Chapter",ExpressionUUID->"b35f6bf0-7567-479d-b31b-629f7c8b6923",
   CellTags->"Evaluation"],
  Cell[2144, 60, 4394, 115, 201, "Input",ExpressionUUID->"cbf2546a-f572-4ac9-8b33-b22abc10dab6",
   CellTags->"Evaluation"],
  Cell[6575, 180, 194, 3, 65, "Chapter",ExpressionUUID->"78e76b07-b51c-744a-b3d5-a13fd14fbc54",
   CellTags->"Evaluation"],
  Cell[6772, 185, 3541, 91, 185, "Input",ExpressionUUID->"111fd704-fc2f-f940-a5a2-27f9849c434e",
   CellTags->"Evaluation"],
  Cell[10350, 281, 374, 5, 65, "Chapter",ExpressionUUID->"04c1ab10-71a6-497f-94ce-68390b638778",
   CellTags->"Evaluation"],
  Cell[10749, 290, 318, 6, 64, "Section",ExpressionUUID->"05e94672-f6cd-434c-82a8-365c8d09f18c",
   CellTags->"Evaluation"],
  Cell[11092, 300, 187, 3, 53, "Subsection",ExpressionUUID->"b27dc8ee-5ddc-403b-8779-db96163f2852",
   CellTags->"Evaluation"],
  Cell[11282, 305, 16060, 411, 566, "Input",ExpressionUUID->"58e9f572-dc35-4942-bb43-9c3b49b5b857",
   CellTags->"Evaluation"],
  Cell[27379, 721, 291, 5, 53, "Subsection",ExpressionUUID->"2809492e-2ac2-45a8-a0c5-517a501d1b21",
   CellTags->"Evaluation"],
  Cell[27695, 730, 179, 3, 46, "Subsubsection",ExpressionUUID->"25f5817b-5cf0-47ee-8730-697f19e5a5a1",
   CellTags->"Evaluation"],
  Cell[27877, 735, 22308, 607, 1010, "Input",ExpressionUUID->"aa90ff4c-871d-4f14-8c66-44f88731bc27",
   CellTags->"Evaluation"],
  Cell[50222, 1347, 192, 3, 46, "Subsubsection",ExpressionUUID->"3a8153bf-f8ea-4dec-b27c-1941df4d3446",
   CellTags->"Evaluation"],
  Cell[50417, 1352, 13635, 361, 616, "Input",ExpressionUUID->"4d6d84cc-6468-4846-bf31-c6438c6fd6ef",
   CellTags->"Evaluation"],
  Cell[64113, 1720, 176, 3, 64, "Section",ExpressionUUID->"ae5880a5-2d5f-4e45-976c-b85057eda045",
   CellTags->"Evaluation"],
  Cell[64314, 1727, 200, 3, 53, "Subsection",ExpressionUUID->"1fb49388-bed7-4e96-8dd9-01762efe4772",
   CellTags->"Evaluation"],
  Cell[64517, 1732, 6035, 150, 315, "Input",ExpressionUUID->"a79320cd-0d99-43fb-808f-7ae5821314a3",
   CellTags->"Evaluation"],
  Cell[70589, 1887, 199, 3, 53, "Subsection",ExpressionUUID->"ddf1802a-9d74-44ec-8027-ff68a7e281ad",
   CellTags->"Evaluation"],
  Cell[70791, 1892, 2657, 69, 167, "Input",ExpressionUUID->"4f88dadc-62a7-4c7e-b264-2a24eba51db8",
   CellTags->"Evaluation"],
  Cell[73485, 1966, 555, 12, 74, "Subsection",ExpressionUUID->"049a2a4d-92fb-4feb-adfe-14f536d3c212",
   CellTags->"Evaluation"],
  Cell[74043, 1980, 16539, 391, 536, "Input",ExpressionUUID->"0550c48c-e450-4ace-bc02-f0ffdaf95418",
   CellTags->"Evaluation"],
  Cell[90607, 2375, 190, 3, 46, "Subsubsection",ExpressionUUID->"67acb5b1-0310-4ea2-9d6c-320976f9c01d",
   CellTags->"Evaluation"],
  Cell[90800, 2380, 7000, 154, 226, "Input",ExpressionUUID->"43dae102-92b1-4ee4-9d18-a8aef4fd7010",
   CellTags->"Evaluation"],
  Cell[97849, 2540, 187, 3, 53, "Subsection",ExpressionUUID->"057fa2fe-e48a-4f24-b9cc-3fb1e545193a",
   CellTags->"Evaluation"],
  Cell[98039, 2545, 11860, 303, 825, "Input",ExpressionUUID->"e7b14f0b-6354-4c9b-8550-57165daae3a4",
   CellTags->"Evaluation"],
  Cell[109936, 2853, 202, 3, 53, "Subsection",ExpressionUUID->"dbf823ef-a081-4f4f-aff6-fc1892c23782",
   CellTags->"Evaluation"],
  Cell[110141, 2858, 17222, 404, 804, "Input",ExpressionUUID->"ea795165-d9bf-45bf-9479-cded8e0281dd",
   CellTags->"Evaluation"],
  Cell[139114, 3561, 208, 3, 53, "Subsection",ExpressionUUID->"22bfd06d-d1da-435d-af12-6d2c5b7dbaf5",
   CellTags->"Evaluation"],
  Cell[139325, 3566, 11738, 294, 564, "Input",ExpressionUUID->"aa654507-7d74-4953-9e3d-e34911a51922",
   CellTags->"Evaluation"],
  Cell[151100, 3865, 200, 3, 53, "Subsection",ExpressionUUID->"ca72417d-b6ee-4d74-9da9-0591ae8c77a0",
   CellTags->"Evaluation"],
  Cell[151303, 3870, 15231, 411, 784, "Input",ExpressionUUID->"09e401fa-b97a-49df-9839-a035ce54d3dc",
   CellTags->"Evaluation"],
  Cell[166595, 4288, 379, 6, 65, "Chapter",ExpressionUUID->"cb6c0023-7125-4cbc-bc54-76f66a6797fe",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[166977, 4296, 36327, 771, 1201, "Input",ExpressionUUID->"d8e48d91-7007-4232-a4aa-b432682df483",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[203329, 5071, 233, 5, 64, "Section",ExpressionUUID->"d7ec269a-92f8-46cb-bae2-3746feac9caf",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[203587, 5080, 224, 4, 53, "Subsection",ExpressionUUID->"4ce9097c-196c-43c3-9806-0febdc29baad",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[203814, 5086, 16687, 391, 931, "Input",ExpressionUUID->"acd1ad6d-2643-47be-a83c-28980f0eb75a",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[220538, 5482, 223, 4, 53, "Subsection",ExpressionUUID->"77842bae-2d04-4d46-a04c-bf9a1e33c631",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[220764, 5488, 14103, 354, 407, "Input",ExpressionUUID->"2a5f65dc-d89d-4d49-aaa6-0f16c5e07109",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[234928, 5849, 194, 3, 65, "Chapter",ExpressionUUID->"3c24dcbc-6ae2-8845-92be-bcf28a8077c9",
   CellTags->"Evaluation"],
  Cell[235125, 5854, 931, 21, 64, "Input",ExpressionUUID->"06938cfe-a232-1840-99db-f4abbeb8fc9f",
   CellTags->"Evaluation"],
  Cell[236081, 5879, 223, 4, 64, "Section",ExpressionUUID->"a9f03259-d8f2-486b-a34b-e7585d74a72a",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[236307, 5885, 11478, 248, 291, "Input",ExpressionUUID->"511d5941-952c-4239-855b-3777a47bc610",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[247846, 6140, 356, 5, 68, "Title",ExpressionUUID->"7ef276aa-6ac2-44b6-8659-f620e946504b",
   CellTags->"Evaluation"],
  Cell[248227, 6149, 260, 6, 65, "Chapter",ExpressionUUID->"75496f98-5d16-4d12-8062-af46b66ba6fe",
   CellTags->"Evaluation"],
  Cell[248490, 6157, 4017, 108, 179, "Input",ExpressionUUID->"a351b5a7-3968-47b6-9206-0b80d566fd66",
   CellTags->"Evaluation"],
  Cell[252532, 6269, 379, 6, 64, "Section",ExpressionUUID->"69890af2-32c0-41ab-b90f-aaf902234c1e",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[252914, 6277, 11670, 292, 429, "Input",ExpressionUUID->"0b5b19ea-8b21-416c-951d-2092f610aec4",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[264782, 6579, 19900, 470, 918, "Input",ExpressionUUID->"038c1ab8-352c-4f0a-b20f-18632e7b8ff7",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[284731, 7055, 514, 8, 65, "Chapter",ExpressionUUID->"da3b7ec0-b669-408d-a6e2-09447629531d",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[285270, 7067, 6747, 161, 307, "Input",ExpressionUUID->"57e9a41d-0896-4230-a4c5-a35b43efa2a2",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[292042, 7232, 459, 10, 29, "Print",ExpressionUUID->"ef756479-c3c9-cb45-a723-4ba3cbd8c868",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[292504, 7244, 416, 9, 29, "Print",ExpressionUUID->"1724ce5e-ef20-3840-9734-b4a0680b92bb",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[292923, 7255, 409, 9, 29, "Print",ExpressionUUID->"0b0c6f28-15f4-4816-bb8a-bc2762136e45",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[293335, 7266, 365, 8, 29, "Print",ExpressionUUID->"e4216446-ae9f-4e72-b238-b37a5c34e8fd",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[293703, 7276, 326, 8, 29, "Print",ExpressionUUID->"cd617635-c0c2-4400-b730-ff5999bd38b5",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[294044, 7287, 545, 11, 36, "Output",ExpressionUUID->"f679aa18-de6e-4bbe-a042-b14510e9ac65",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[294592, 7300, 371, 9, 29, "Print",ExpressionUUID->"94b39adf-67a9-4736-bff8-d15778dc8e85",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[294966, 7311, 291, 6, 36, "Output",ExpressionUUID->"db4fd183-1dcc-4b68-a93a-a1a213858c96",
   CellTags->{"Evaluation", "Re-evaluation"}]},
 "Re-evaluation"->{
  Cell[166595, 4288, 379, 6, 65, "Chapter",ExpressionUUID->"cb6c0023-7125-4cbc-bc54-76f66a6797fe",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[166977, 4296, 36327, 771, 1201, "Input",ExpressionUUID->"d8e48d91-7007-4232-a4aa-b432682df483",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[203329, 5071, 233, 5, 64, "Section",ExpressionUUID->"d7ec269a-92f8-46cb-bae2-3746feac9caf",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[203587, 5080, 224, 4, 53, "Subsection",ExpressionUUID->"4ce9097c-196c-43c3-9806-0febdc29baad",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[203814, 5086, 16687, 391, 931, "Input",ExpressionUUID->"acd1ad6d-2643-47be-a83c-28980f0eb75a",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[220538, 5482, 223, 4, 53, "Subsection",ExpressionUUID->"77842bae-2d04-4d46-a04c-bf9a1e33c631",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[220764, 5488, 14103, 354, 407, "Input",ExpressionUUID->"2a5f65dc-d89d-4d49-aaa6-0f16c5e07109",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[236081, 5879, 223, 4, 64, "Section",ExpressionUUID->"a9f03259-d8f2-486b-a34b-e7585d74a72a",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[236307, 5885, 11478, 248, 291, "Input",ExpressionUUID->"511d5941-952c-4239-855b-3777a47bc610",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[252532, 6269, 379, 6, 64, "Section",ExpressionUUID->"69890af2-32c0-41ab-b90f-aaf902234c1e",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[252914, 6277, 11670, 292, 429, "Input",ExpressionUUID->"0b5b19ea-8b21-416c-951d-2092f610aec4",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[264782, 6579, 19900, 470, 918, "Input",ExpressionUUID->"038c1ab8-352c-4f0a-b20f-18632e7b8ff7",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[284731, 7055, 514, 8, 65, "Chapter",ExpressionUUID->"da3b7ec0-b669-408d-a6e2-09447629531d",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[285270, 7067, 6747, 161, 307, "Input",ExpressionUUID->"57e9a41d-0896-4230-a4c5-a35b43efa2a2",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[292042, 7232, 459, 10, 29, "Print",ExpressionUUID->"ef756479-c3c9-cb45-a723-4ba3cbd8c868",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[292504, 7244, 416, 9, 29, "Print",ExpressionUUID->"1724ce5e-ef20-3840-9734-b4a0680b92bb",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[292923, 7255, 409, 9, 29, "Print",ExpressionUUID->"0b0c6f28-15f4-4816-bb8a-bc2762136e45",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[293335, 7266, 365, 8, 29, "Print",ExpressionUUID->"e4216446-ae9f-4e72-b238-b37a5c34e8fd",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[293703, 7276, 326, 8, 29, "Print",ExpressionUUID->"cd617635-c0c2-4400-b730-ff5999bd38b5",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[294044, 7287, 545, 11, 36, "Output",ExpressionUUID->"f679aa18-de6e-4bbe-a042-b14510e9ac65",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[294592, 7300, 371, 9, 29, "Print",ExpressionUUID->"94b39adf-67a9-4736-bff8-d15778dc8e85",
   CellTags->{"Evaluation", "Re-evaluation"}],
  Cell[294966, 7311, 291, 6, 36, "Output",ExpressionUUID->"db4fd183-1dcc-4b68-a93a-a1a213858c96",
   CellTags->{"Evaluation", "Re-evaluation"}]},
 "Scalar"->{
  Cell[295589, 7334, 304, 5, 65, "Chapter",ExpressionUUID->"bbaa7b71-c5de-463d-bc5f-bcee80cecd62",
   CellTags->{"Scalar", "All"}],
  Cell[295896, 7341, 1039, 19, 33, "Input",ExpressionUUID->"699077d2-5244-4855-8318-7861677ff4d4",
   CellTags->{"Scalar", "All"}]},
 "All"->{
  Cell[295589, 7334, 304, 5, 65, "Chapter",ExpressionUUID->"bbaa7b71-c5de-463d-bc5f-bcee80cecd62",
   CellTags->{"Scalar", "All"}],
  Cell[295896, 7341, 1039, 19, 33, "Input",ExpressionUUID->"699077d2-5244-4855-8318-7861677ff4d4",
   CellTags->{"Scalar", "All"}],
  Cell[296972, 7365, 253, 4, 57, "Chapter",ExpressionUUID->"1c9c1db2-e817-43c7-a1c1-dc058a49f093",
   CellTags->{"All", "HNL"}],
  Cell[297250, 7373, 281, 5, 75, "Section",ExpressionUUID->"1e4fb3e2-de7d-4190-989a-2ba85613b49e",
   CellTags->{"All", "HNL"}],
  Cell[297534, 7380, 660, 14, 37, "Input",ExpressionUUID->"3ed8b495-ecc2-4582-9e0d-3e71f7277e93",
   CellTags->{"All", "HNL"}],
  Cell[298231, 7399, 285, 5, 75, "Section",ExpressionUUID->"f8b65d43-6d66-48d3-af23-ebb851dbcef2",
   CellTags->{"All", "HNL"}],
  Cell[298519, 7406, 635, 14, 37, "Input",ExpressionUUID->"bad4ddac-67cc-4922-bab4-33fcc98f4b5f",
   CellTags->{"All", "HNL"}],
  Cell[299191, 7425, 288, 5, 75, "Section",ExpressionUUID->"246606c9-e825-4a9b-86a0-2b61184a5aa1",
   CellTags->{"All", "HNL"}],
  Cell[299482, 7432, 682, 14, 37, "Input",ExpressionUUID->"5a3395e6-b65d-4219-ab18-8f1212a83888",
   CellTags->{"All", "HNL"}],
  Cell[300213, 7452, 235, 4, 57, "Chapter",ExpressionUUID->"b006c7e4-9235-48b6-acf0-5f68ba37a4de",
   CellTags->{"DP", "All"}],
  Cell[300451, 7458, 751, 15, 33, "Input",ExpressionUUID->"54fe7186-2a6f-49bd-80fa-20f726215da5",
   CellTags->{"DP", "All"}],
  Cell[301239, 7478, 246, 5, 65, "Chapter",ExpressionUUID->"f895a2e3-dd51-4275-9ad6-cb8a2d25bea8",
   CellTags->{"All", "ALP-fermion"}],
  Cell[301488, 7485, 642, 14, 33, "Input",ExpressionUUID->"b728d505-2207-4e5e-841c-de8a87a4bb1d",
   CellTags->{"All", "ALP-fermion"}],
  Cell[302167, 7504, 242, 4, 57, "Chapter",ExpressionUUID->"bf90cb15-6490-441b-8316-f0b08b88a5dd",
   CellTags->{"All", "ALP-gluon"}],
  Cell[302412, 7510, 822, 16, 50, "Input",ExpressionUUID->"1e460815-2625-4c6f-903c-38d9c89aa22a",
   CellTags->{"All", "ALP-gluon"}],
  Cell[303271, 7531, 242, 4, 57, "Chapter",ExpressionUUID->"fe998291-7eb5-44c3-9a88-45a1e678e2ad",
   CellTags->{"All", "ALP-photon"}],
  Cell[303516, 7537, 562, 13, 50, "Input",ExpressionUUID->"86f38a14-6add-444a-8c8e-934849c5f2c9",
   CellTags->{"All", "ALP-photon"}],
  Cell[304115, 7555, 290, 5, 57, "Chapter",ExpressionUUID->"1c928aac-e1bd-444d-8f5d-bb01858a0b9e",
   CellTags->{"All", "B-L"}],
  Cell[304408, 7562, 680, 14, 50, "Input",ExpressionUUID->"4587e325-7527-4ae4-8b5d-9c0f2f5bacae",
   CellTags->{"All", "B-L"}],
  Cell[305125, 7581, 534, 13, 58, "Chapter",ExpressionUUID->"f910c5d8-2d47-4ef3-b74e-1ffcff1ac1c6",
   CellTags->{"All", "B-3Lmu"}],
  Cell[305662, 7596, 708, 15, 37, "Input",ExpressionUUID->"026e067e-b766-4284-bb3d-1bd2aabaebc1",
   CellTags->{"All", "B-3Lmu"}],
  Cell[306407, 7616, 619, 16, 58, "Chapter",ExpressionUUID->"01563783-279f-4977-a8a4-cff0a0e598d5",
   CellTags->{"All", "B-3Le-Lmu+Ltau"}],
  Cell[307029, 7634, 724, 15, 37, "Input",ExpressionUUID->"cab98ae5-0681-448c-a04c-d81238c69ee5",
   CellTags->{"All", "B-3Le-Lmu+Ltau"}],
  Cell[307790, 7654, 619, 16, 58, "Chapter",ExpressionUUID->"80184ca5-803c-4432-8e71-e11c163bb2dc",
   CellTags->{"All", "B-Le-3Lmu+Ltau"}],
  Cell[308412, 7672, 726, 15, 33, "Input",ExpressionUUID->"70ae1e98-041d-4edf-a42c-9edd436a9af1",
   CellTags->{"All", "B-Le-3Lmu+Ltau"}]},
 "HNL"->{
  Cell[296972, 7365, 253, 4, 57, "Chapter",ExpressionUUID->"1c9c1db2-e817-43c7-a1c1-dc058a49f093",
   CellTags->{"All", "HNL"}],
  Cell[297250, 7373, 281, 5, 75, "Section",ExpressionUUID->"1e4fb3e2-de7d-4190-989a-2ba85613b49e",
   CellTags->{"All", "HNL"}],
  Cell[297534, 7380, 660, 14, 37, "Input",ExpressionUUID->"3ed8b495-ecc2-4582-9e0d-3e71f7277e93",
   CellTags->{"All", "HNL"}],
  Cell[298231, 7399, 285, 5, 75, "Section",ExpressionUUID->"f8b65d43-6d66-48d3-af23-ebb851dbcef2",
   CellTags->{"All", "HNL"}],
  Cell[298519, 7406, 635, 14, 37, "Input",ExpressionUUID->"bad4ddac-67cc-4922-bab4-33fcc98f4b5f",
   CellTags->{"All", "HNL"}],
  Cell[299191, 7425, 288, 5, 75, "Section",ExpressionUUID->"246606c9-e825-4a9b-86a0-2b61184a5aa1",
   CellTags->{"All", "HNL"}],
  Cell[299482, 7432, 682, 14, 37, "Input",ExpressionUUID->"5a3395e6-b65d-4219-ab18-8f1212a83888",
   CellTags->{"All", "HNL"}]},
 "DP"->{
  Cell[300213, 7452, 235, 4, 57, "Chapter",ExpressionUUID->"b006c7e4-9235-48b6-acf0-5f68ba37a4de",
   CellTags->{"DP", "All"}],
  Cell[300451, 7458, 751, 15, 33, "Input",ExpressionUUID->"54fe7186-2a6f-49bd-80fa-20f726215da5",
   CellTags->{"DP", "All"}]},
 "ALP-fermion"->{
  Cell[301239, 7478, 246, 5, 65, "Chapter",ExpressionUUID->"f895a2e3-dd51-4275-9ad6-cb8a2d25bea8",
   CellTags->{"All", "ALP-fermion"}],
  Cell[301488, 7485, 642, 14, 33, "Input",ExpressionUUID->"b728d505-2207-4e5e-841c-de8a87a4bb1d",
   CellTags->{"All", "ALP-fermion"}]},
 "ALP-gluon"->{
  Cell[302167, 7504, 242, 4, 57, "Chapter",ExpressionUUID->"bf90cb15-6490-441b-8316-f0b08b88a5dd",
   CellTags->{"All", "ALP-gluon"}],
  Cell[302412, 7510, 822, 16, 50, "Input",ExpressionUUID->"1e460815-2625-4c6f-903c-38d9c89aa22a",
   CellTags->{"All", "ALP-gluon"}]},
 "ALP-photon"->{
  Cell[303271, 7531, 242, 4, 57, "Chapter",ExpressionUUID->"fe998291-7eb5-44c3-9a88-45a1e678e2ad",
   CellTags->{"All", "ALP-photon"}],
  Cell[303516, 7537, 562, 13, 50, "Input",ExpressionUUID->"86f38a14-6add-444a-8c8e-934849c5f2c9",
   CellTags->{"All", "ALP-photon"}]},
 "B-L"->{
  Cell[304115, 7555, 290, 5, 57, "Chapter",ExpressionUUID->"1c928aac-e1bd-444d-8f5d-bb01858a0b9e",
   CellTags->{"All", "B-L"}],
  Cell[304408, 7562, 680, 14, 50, "Input",ExpressionUUID->"4587e325-7527-4ae4-8b5d-9c0f2f5bacae",
   CellTags->{"All", "B-L"}]},
 "B-3Lmu"->{
  Cell[305125, 7581, 534, 13, 58, "Chapter",ExpressionUUID->"f910c5d8-2d47-4ef3-b74e-1ffcff1ac1c6",
   CellTags->{"All", "B-3Lmu"}],
  Cell[305662, 7596, 708, 15, 37, "Input",ExpressionUUID->"026e067e-b766-4284-bb3d-1bd2aabaebc1",
   CellTags->{"All", "B-3Lmu"}]},
 "B-3Le-Lmu+Ltau"->{
  Cell[306407, 7616, 619, 16, 58, "Chapter",ExpressionUUID->"01563783-279f-4977-a8a4-cff0a0e598d5",
   CellTags->{"All", "B-3Le-Lmu+Ltau"}],
  Cell[307029, 7634, 724, 15, 37, "Input",ExpressionUUID->"cab98ae5-0681-448c-a04c-d81238c69ee5",
   CellTags->{"All", "B-3Le-Lmu+Ltau"}]},
 "B-Le-3Lmu+Ltau"->{
  Cell[307790, 7654, 619, 16, 58, "Chapter",ExpressionUUID->"80184ca5-803c-4432-8e71-e11c163bb2dc",
   CellTags->{"All", "B-Le-3Lmu+Ltau"}],
  Cell[308412, 7672, 726, 15, 33, "Input",ExpressionUUID->"70ae1e98-041d-4edf-a42c-9edd436a9af1",
   CellTags->{"All", "B-Le-3Lmu+Ltau"}]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Evaluation", 310263, 7727},
 {"Re-evaluation", 318114, 7844},
 {"Scalar", 321355, 7889},
 {"All", 321630, 7894},
 {"HNL", 324954, 7945},
 {"DP", 325864, 7960},
 {"ALP-fermion", 326138, 7965},
 {"ALP-gluon", 326428, 7970},
 {"ALP-photon", 326715, 7975},
 {"B-L", 326997, 7980},
 {"B-3Lmu", 327268, 7985},
 {"B-3Le-Lmu+Ltau", 327554, 7990},
 {"B-Le-3Lmu+Ltau", 327856, 7995}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 207, 3, 77, "Title",ExpressionUUID->"be5b0a69-a859-4e14-9302-15ea02706e41"],
Cell[790, 27, 750, 14, 69, "Input",ExpressionUUID->"91675345-8e36-4745-9302-f9529663728a"]
}, Closed]],
Cell[CellGroupData[{
Cell[1577, 46, 318, 5, 68, "Title",ExpressionUUID->"f0d20480-5665-403d-a88a-e38db6e4fff2",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[1920, 55, 221, 3, 65, "Chapter",ExpressionUUID->"b35f6bf0-7567-479d-b31b-629f7c8b6923",
 CellTags->"Evaluation"],
Cell[2144, 60, 4394, 115, 201, "Input",ExpressionUUID->"cbf2546a-f572-4ac9-8b33-b22abc10dab6",
 CellTags->"Evaluation"]
}, Closed]],
Cell[CellGroupData[{
Cell[6575, 180, 194, 3, 65, "Chapter",ExpressionUUID->"78e76b07-b51c-744a-b3d5-a13fd14fbc54",
 CellTags->"Evaluation"],
Cell[6772, 185, 3541, 91, 185, "Input",ExpressionUUID->"111fd704-fc2f-f940-a5a2-27f9849c434e",
 CellTags->"Evaluation"]
}, Closed]],
Cell[CellGroupData[{
Cell[10350, 281, 374, 5, 65, "Chapter",ExpressionUUID->"04c1ab10-71a6-497f-94ce-68390b638778",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[10749, 290, 318, 6, 64, "Section",ExpressionUUID->"05e94672-f6cd-434c-82a8-365c8d09f18c",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[11092, 300, 187, 3, 53, "Subsection",ExpressionUUID->"b27dc8ee-5ddc-403b-8779-db96163f2852",
 CellTags->"Evaluation"],
Cell[11282, 305, 16060, 411, 566, "Input",ExpressionUUID->"58e9f572-dc35-4942-bb43-9c3b49b5b857",
 CellTags->"Evaluation"]
}, Closed]],
Cell[CellGroupData[{
Cell[27379, 721, 291, 5, 53, "Subsection",ExpressionUUID->"2809492e-2ac2-45a8-a0c5-517a501d1b21",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[27695, 730, 179, 3, 46, "Subsubsection",ExpressionUUID->"25f5817b-5cf0-47ee-8730-697f19e5a5a1",
 CellTags->"Evaluation"],
Cell[27877, 735, 22308, 607, 1010, "Input",ExpressionUUID->"aa90ff4c-871d-4f14-8c66-44f88731bc27",
 CellTags->"Evaluation"]
}, Closed]],
Cell[CellGroupData[{
Cell[50222, 1347, 192, 3, 46, "Subsubsection",ExpressionUUID->"3a8153bf-f8ea-4dec-b27c-1941df4d3446",
 CellTags->"Evaluation"],
Cell[50417, 1352, 13635, 361, 616, "Input",ExpressionUUID->"4d6d84cc-6468-4846-bf31-c6438c6fd6ef",
 CellTags->"Evaluation"]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[64113, 1720, 176, 3, 64, "Section",ExpressionUUID->"ae5880a5-2d5f-4e45-976c-b85057eda045",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[64314, 1727, 200, 3, 53, "Subsection",ExpressionUUID->"1fb49388-bed7-4e96-8dd9-01762efe4772",
 CellTags->"Evaluation"],
Cell[64517, 1732, 6035, 150, 315, "Input",ExpressionUUID->"a79320cd-0d99-43fb-808f-7ae5821314a3",
 CellTags->"Evaluation"]
}, Closed]],
Cell[CellGroupData[{
Cell[70589, 1887, 199, 3, 53, "Subsection",ExpressionUUID->"ddf1802a-9d74-44ec-8027-ff68a7e281ad",
 CellTags->"Evaluation"],
Cell[70791, 1892, 2657, 69, 167, "Input",ExpressionUUID->"4f88dadc-62a7-4c7e-b264-2a24eba51db8",
 CellTags->"Evaluation"]
}, Closed]],
Cell[CellGroupData[{
Cell[73485, 1966, 555, 12, 74, "Subsection",ExpressionUUID->"049a2a4d-92fb-4feb-adfe-14f536d3c212",
 CellTags->"Evaluation"],
Cell[74043, 1980, 16539, 391, 536, "Input",ExpressionUUID->"0550c48c-e450-4ace-bc02-f0ffdaf95418",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[90607, 2375, 190, 3, 46, "Subsubsection",ExpressionUUID->"67acb5b1-0310-4ea2-9d6c-320976f9c01d",
 CellTags->"Evaluation"],
Cell[90800, 2380, 7000, 154, 226, "Input",ExpressionUUID->"43dae102-92b1-4ee4-9d18-a8aef4fd7010",
 CellTags->"Evaluation"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[97849, 2540, 187, 3, 53, "Subsection",ExpressionUUID->"057fa2fe-e48a-4f24-b9cc-3fb1e545193a",
 CellTags->"Evaluation"],
Cell[98039, 2545, 11860, 303, 825, "Input",ExpressionUUID->"e7b14f0b-6354-4c9b-8550-57165daae3a4",
 CellTags->"Evaluation"]
}, Closed]],
Cell[CellGroupData[{
Cell[109936, 2853, 202, 3, 53, "Subsection",ExpressionUUID->"dbf823ef-a081-4f4f-aff6-fc1892c23782",
 CellTags->"Evaluation"],
Cell[110141, 2858, 17222, 404, 804, "Input",ExpressionUUID->"ea795165-d9bf-45bf-9479-cded8e0281dd",
 CellTags->"Evaluation"],
Cell[127366, 3264, 11711, 292, 403, "Input",ExpressionUUID->"98cabff5-a6e9-4a6b-81ce-94345c2cf410"]
}, Closed]],
Cell[CellGroupData[{
Cell[139114, 3561, 208, 3, 53, "Subsection",ExpressionUUID->"22bfd06d-d1da-435d-af12-6d2c5b7dbaf5",
 CellTags->"Evaluation"],
Cell[139325, 3566, 11738, 294, 564, "Input",ExpressionUUID->"aa654507-7d74-4953-9e3d-e34911a51922",
 CellTags->"Evaluation"]
}, Closed]],
Cell[CellGroupData[{
Cell[151100, 3865, 200, 3, 53, "Subsection",ExpressionUUID->"ca72417d-b6ee-4d74-9da9-0591ae8c77a0",
 CellTags->"Evaluation"],
Cell[151303, 3870, 15231, 411, 784, "Input",ExpressionUUID->"09e401fa-b97a-49df-9839-a035ce54d3dc",
 CellTags->"Evaluation"]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[166595, 4288, 379, 6, 65, "Chapter",ExpressionUUID->"cb6c0023-7125-4cbc-bc54-76f66a6797fe",
 CellTags->{"Evaluation", "Re-evaluation"}],
Cell[166977, 4296, 36327, 771, 1201, "Input",ExpressionUUID->"d8e48d91-7007-4232-a4aa-b432682df483",
 CellTags->{"Evaluation", "Re-evaluation"}],
Cell[CellGroupData[{
Cell[203329, 5071, 233, 5, 64, "Section",ExpressionUUID->"d7ec269a-92f8-46cb-bae2-3746feac9caf",
 CellTags->{"Evaluation", "Re-evaluation"}],
Cell[CellGroupData[{
Cell[203587, 5080, 224, 4, 53, "Subsection",ExpressionUUID->"4ce9097c-196c-43c3-9806-0febdc29baad",
 CellTags->{"Evaluation", "Re-evaluation"}],
Cell[203814, 5086, 16687, 391, 931, "Input",ExpressionUUID->"acd1ad6d-2643-47be-a83c-28980f0eb75a",
 CellTags->{"Evaluation", "Re-evaluation"}]
}, Closed]],
Cell[CellGroupData[{
Cell[220538, 5482, 223, 4, 53, "Subsection",ExpressionUUID->"77842bae-2d04-4d46-a04c-bf9a1e33c631",
 CellTags->{"Evaluation", "Re-evaluation"}],
Cell[220764, 5488, 14103, 354, 407, "Input",ExpressionUUID->"2a5f65dc-d89d-4d49-aaa6-0f16c5e07109",
 CellTags->{"Evaluation", "Re-evaluation"}]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[234928, 5849, 194, 3, 65, "Chapter",ExpressionUUID->"3c24dcbc-6ae2-8845-92be-bcf28a8077c9",
 CellTags->"Evaluation"],
Cell[235125, 5854, 931, 21, 64, "Input",ExpressionUUID->"06938cfe-a232-1840-99db-f4abbeb8fc9f",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[236081, 5879, 223, 4, 64, "Section",ExpressionUUID->"a9f03259-d8f2-486b-a34b-e7585d74a72a",
 CellTags->{"Evaluation", "Re-evaluation"}],
Cell[236307, 5885, 11478, 248, 291, "Input",ExpressionUUID->"511d5941-952c-4239-855b-3777a47bc610",
 CellTags->{"Evaluation", "Re-evaluation"}]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[247846, 6140, 356, 5, 68, "Title",ExpressionUUID->"7ef276aa-6ac2-44b6-8659-f620e946504b",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[248227, 6149, 260, 6, 65, "Chapter",ExpressionUUID->"75496f98-5d16-4d12-8062-af46b66ba6fe",
 CellTags->"Evaluation"],
Cell[248490, 6157, 4017, 108, 179, "Input",ExpressionUUID->"a351b5a7-3968-47b6-9206-0b80d566fd66",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[252532, 6269, 379, 6, 64, "Section",ExpressionUUID->"69890af2-32c0-41ab-b90f-aaf902234c1e",
 CellTags->{"Evaluation", "Re-evaluation"}],
Cell[252914, 6277, 11670, 292, 429, "Input",ExpressionUUID->"0b5b19ea-8b21-416c-951d-2092f610aec4",
 CellTags->{"Evaluation", "Re-evaluation"}]
}, Closed]],
Cell[CellGroupData[{
Cell[264621, 6574, 158, 3, 52, "Section",ExpressionUUID->"61dd62df-bf83-4744-b8b5-810b5c5173a5"],
Cell[264782, 6579, 19900, 470, 918, "Input",ExpressionUUID->"038c1ab8-352c-4f0a-b20f-18632e7b8ff7",
 CellTags->{"Evaluation", "Re-evaluation"}]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[284731, 7055, 514, 8, 65, "Chapter",ExpressionUUID->"da3b7ec0-b669-408d-a6e2-09447629531d",
 CellTags->{"Evaluation", "Re-evaluation"}],
Cell[CellGroupData[{
Cell[285270, 7067, 6747, 161, 307, "Input",ExpressionUUID->"57e9a41d-0896-4230-a4c5-a35b43efa2a2",
 CellTags->{"Evaluation", "Re-evaluation"}],
Cell[CellGroupData[{
Cell[292042, 7232, 459, 10, 29, "Print",ExpressionUUID->"ef756479-c3c9-cb45-a723-4ba3cbd8c868",
 CellTags->{"Evaluation", "Re-evaluation"}],
Cell[292504, 7244, 416, 9, 29, "Print",ExpressionUUID->"1724ce5e-ef20-3840-9734-b4a0680b92bb",
 CellTags->{"Evaluation", "Re-evaluation"}],
Cell[292923, 7255, 409, 9, 29, "Print",ExpressionUUID->"0b0c6f28-15f4-4816-bb8a-bc2762136e45",
 CellTags->{"Evaluation", "Re-evaluation"}],
Cell[293335, 7266, 365, 8, 29, "Print",ExpressionUUID->"e4216446-ae9f-4e72-b238-b37a5c34e8fd",
 CellTags->{"Evaluation", "Re-evaluation"}],
Cell[293703, 7276, 326, 8, 29, "Print",ExpressionUUID->"cd617635-c0c2-4400-b730-ff5999bd38b5",
 CellTags->{"Evaluation", "Re-evaluation"}]
}, Closed]],
Cell[294044, 7287, 545, 11, 36, "Output",ExpressionUUID->"f679aa18-de6e-4bbe-a042-b14510e9ac65",
 CellTags->{"Evaluation", "Re-evaluation"}],
Cell[294592, 7300, 371, 9, 29, "Print",ExpressionUUID->"94b39adf-67a9-4736-bff8-d15778dc8e85",
 CellTags->{"Evaluation", "Re-evaluation"}],
Cell[294966, 7311, 291, 6, 36, "Output",ExpressionUUID->"db4fd183-1dcc-4b68-a93a-a1a213858c96",
 CellTags->{"Evaluation", "Re-evaluation"}]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[295318, 7324, 246, 6, 105, "Title",ExpressionUUID->"b4a43d11-cb45-4248-9b58-fa3cbda961f9"],
Cell[CellGroupData[{
Cell[295589, 7334, 304, 5, 65, "Chapter",ExpressionUUID->"bbaa7b71-c5de-463d-bc5f-bcee80cecd62",
 CellTags->{"Scalar", "All"}],
Cell[295896, 7341, 1039, 19, 33, "Input",ExpressionUUID->"699077d2-5244-4855-8318-7861677ff4d4",
 CellTags->{"Scalar", "All"}]
}, Closed]],
Cell[CellGroupData[{
Cell[296972, 7365, 253, 4, 57, "Chapter",ExpressionUUID->"1c9c1db2-e817-43c7-a1c1-dc058a49f093",
 CellTags->{"All", "HNL"}],
Cell[CellGroupData[{
Cell[297250, 7373, 281, 5, 75, "Section",ExpressionUUID->"1e4fb3e2-de7d-4190-989a-2ba85613b49e",
 CellTags->{"All", "HNL"}],
Cell[297534, 7380, 660, 14, 37, "Input",ExpressionUUID->"3ed8b495-ecc2-4582-9e0d-3e71f7277e93",
 CellTags->{"All", "HNL"}]
}, Closed]],
Cell[CellGroupData[{
Cell[298231, 7399, 285, 5, 75, "Section",ExpressionUUID->"f8b65d43-6d66-48d3-af23-ebb851dbcef2",
 CellTags->{"All", "HNL"}],
Cell[298519, 7406, 635, 14, 37, "Input",ExpressionUUID->"bad4ddac-67cc-4922-bab4-33fcc98f4b5f",
 CellTags->{"All", "HNL"}]
}, Closed]],
Cell[CellGroupData[{
Cell[299191, 7425, 288, 5, 75, "Section",ExpressionUUID->"246606c9-e825-4a9b-86a0-2b61184a5aa1",
 CellTags->{"All", "HNL"}],
Cell[299482, 7432, 682, 14, 37, "Input",ExpressionUUID->"5a3395e6-b65d-4219-ab18-8f1212a83888",
 CellTags->{"All", "HNL"}]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[300213, 7452, 235, 4, 57, "Chapter",ExpressionUUID->"b006c7e4-9235-48b6-acf0-5f68ba37a4de",
 CellTags->{"DP", "All"}],
Cell[300451, 7458, 751, 15, 33, "Input",ExpressionUUID->"54fe7186-2a6f-49bd-80fa-20f726215da5",
 CellTags->{"DP", "All"}]
}, Closed]],
Cell[CellGroupData[{
Cell[301239, 7478, 246, 5, 65, "Chapter",ExpressionUUID->"f895a2e3-dd51-4275-9ad6-cb8a2d25bea8",
 CellTags->{"All", "ALP-fermion"}],
Cell[301488, 7485, 642, 14, 33, "Input",ExpressionUUID->"b728d505-2207-4e5e-841c-de8a87a4bb1d",
 CellTags->{"All", "ALP-fermion"}]
}, Closed]],
Cell[CellGroupData[{
Cell[302167, 7504, 242, 4, 57, "Chapter",ExpressionUUID->"bf90cb15-6490-441b-8316-f0b08b88a5dd",
 CellTags->{"All", "ALP-gluon"}],
Cell[302412, 7510, 822, 16, 50, "Input",ExpressionUUID->"1e460815-2625-4c6f-903c-38d9c89aa22a",
 CellTags->{"All", "ALP-gluon"}]
}, Closed]],
Cell[CellGroupData[{
Cell[303271, 7531, 242, 4, 57, "Chapter",ExpressionUUID->"fe998291-7eb5-44c3-9a88-45a1e678e2ad",
 CellTags->{"All", "ALP-photon"}],
Cell[303516, 7537, 562, 13, 50, "Input",ExpressionUUID->"86f38a14-6add-444a-8c8e-934849c5f2c9",
 CellTags->{"All", "ALP-photon"}]
}, Closed]],
Cell[CellGroupData[{
Cell[304115, 7555, 290, 5, 57, "Chapter",ExpressionUUID->"1c928aac-e1bd-444d-8f5d-bb01858a0b9e",
 CellTags->{"All", "B-L"}],
Cell[304408, 7562, 680, 14, 50, "Input",ExpressionUUID->"4587e325-7527-4ae4-8b5d-9c0f2f5bacae",
 CellTags->{"All", "B-L"}]
}, Closed]],
Cell[CellGroupData[{
Cell[305125, 7581, 534, 13, 58, "Chapter",ExpressionUUID->"f910c5d8-2d47-4ef3-b74e-1ffcff1ac1c6",
 CellTags->{"All", "B-3Lmu"}],
Cell[305662, 7596, 708, 15, 37, "Input",ExpressionUUID->"026e067e-b766-4284-bb3d-1bd2aabaebc1",
 CellTags->{"All", "B-3Lmu"}]
}, Closed]],
Cell[CellGroupData[{
Cell[306407, 7616, 619, 16, 58, "Chapter",ExpressionUUID->"01563783-279f-4977-a8a4-cff0a0e598d5",
 CellTags->{"All", "B-3Le-Lmu+Ltau"}],
Cell[307029, 7634, 724, 15, 37, "Input",ExpressionUUID->"cab98ae5-0681-448c-a04c-d81238c69ee5",
 CellTags->{"All", "B-3Le-Lmu+Ltau"}]
}, Closed]],
Cell[CellGroupData[{
Cell[307790, 7654, 619, 16, 58, "Chapter",ExpressionUUID->"80184ca5-803c-4432-8e71-e11c163bb2dc",
 CellTags->{"All", "B-Le-3Lmu+Ltau"}],
Cell[308412, 7672, 726, 15, 33, "Input",ExpressionUUID->"70ae1e98-041d-4edf-a42c-9edd436a9af1",
 CellTags->{"All", "B-Le-3Lmu+Ltau"}]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[309187, 7693, 167, 3, 57, "Title",ExpressionUUID->"1cf35ccb-ac3a-484a-a861-545f2caeee7a"],
Cell[309357, 7698, 445, 12, 54, "Input",ExpressionUUID->"c4efea97-2e10-472c-953b-5e7df7dd7aac"]
}, Closed]]
}
]
*)

