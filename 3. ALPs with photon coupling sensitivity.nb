(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    350358,       8407]
NotebookOptionsPosition[    304913,       7725]
NotebookOutlinePosition[    333249,       8104]
CellTagsIndexPosition[    332979,       8094]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Just launch the code below to run the notebook (shift+enter)", "Title",
 CellChangeTimes->{{3.8934376452895875`*^9, 
  3.8934376644509068`*^9}},ExpressionUUID->"ec489a88-8a17-4268-83b3-\
d4cc980d9075"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BlockEvaluation", "[", "tag_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nb", "=", 
      RowBox[{"EvaluationNotebook", "[", "]"}]}], ";", "\n", 
     RowBox[{"NotebookFind", "[", 
      RowBox[{"nb", ",", "tag", ",", "All", ",", "CellTags"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"infoDialog", "[", "phrase_", "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<Proceed\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DirectoryQ", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<Auxiliary data\>\""}], "}"}], "]"}], "]"}], "//", 
       "ToString"}], ")"}], "\[Equal]", "\"\<False\>\""}], ",", 
    RowBox[{"CreateDirectory", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<Auxiliary data\>\""}], "}"}], "]"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DirectoryQ", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<Auxiliary data/ALPs with photon coupling\>\""}], "}"}], "]"}],
         "]"}], "//", "ToString"}], ")"}], "\[Equal]", "\"\<False\>\""}], ",", 
    RowBox[{"CreateDirectory", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<Auxiliary data/ALPs with photon coupling\>\""}], "}"}], "]"}], 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"choiceslist", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<Acceptance\>\"", ",", "\"\<Tabulated number of events\>\"", ",", 
     "\"\<Sensitivity\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"taglist", "[", "\"\<Acceptance\>\"", "]"}], "=", 
   "\"\<Acceptance\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"taglist", "[", "\"\<Tabulated number of events\>\"", "]"}], "=", 
   "\"\<Number-of-events\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"taglist", "[", "\"\<Sensitivity\>\"", "]"}], "=", 
   "\"\<Sensitivity\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"computationchoice", "=", 
   RowBox[{"dropdownDialog", "[", 
    RowBox[{
    "choiceslist", ",", 
     "\"\<Do you want to compute acceptance, tabulated number of events, or \
sensitivity (if the tabulated number of events has been already \
produced)?\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"tagselected", "=", 
  RowBox[{"taglist", "[", "computationchoice", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"BlockEvaluation", "[", "tagselected", "]"}]}], "Input",
 CellChangeTimes->{{3.893437585709897*^9, 3.8934375895369635`*^9}, {
   3.8934376329497385`*^9, 3.893437658846809*^9}, 3.8935730809859295`*^9, {
   3.893665349653804*^9, 3.8936653502873545`*^9}, {3.895053036918769*^9, 
   3.8950530371382556`*^9}, {3.895127015867475*^9, 3.8951270372355633`*^9}, 
   3.9025622087158365`*^9, 3.9027295043110003`*^9, 3.9029750439217606`*^9, {
   3.9029751084331856`*^9, 3.9029751137586985`*^9}},
 CellLabel->
  "In[2124]:=",ExpressionUUID->"4fee1dbc-f123-4728-9e60-81aad253082b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Preliminary definitions (launch first)", "Title",
 CellChangeTimes->{{3.7552434949579296`*^9, 3.755243495237189*^9}, {
  3.88501652694691*^9, 3.885016532955313*^9}, {3.8850204805201235`*^9, 
  3.885020485584347*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"c7fbc496-1765-4913-bda1-eb19f9d14ec4"],

Cell[CellGroupData[{

Cell["ALP phenomenology", "Chapter",
 CellChangeTimes->{{3.8851378652235947`*^9, 3.885137868355297*^9}, {
  3.88574437267345*^9, 3.8857443729501305`*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"8348c717-8fb9-4ff9-be33-c78045c51d6d"],

Cell[CellGroupData[{

Cell["ALP lifetime and production branching ratios", "Section",
 CellChangeTimes->{{3.7725113836218624`*^9, 3.7725113869263587`*^9}, {
  3.826651830998455*^9, 3.826651834218698*^9}, {3.8267130444352474`*^9, 
  3.8267130466742153`*^9}, {3.885139954002949*^9, 3.8851399560519075`*^9}, {
  3.8857451257235746`*^9, 3.885745126019622*^9}, {3.89226755713624*^9, 
  3.892267558367409*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"990662f6-15c3-4f39-ae61-2c8fc1bd4b2e"],

Cell[CellGroupData[{

Cell["Production branching ratios", "Subsection",
 CellChangeTimes->{{3.892267566950859*^9, 3.892267571949791*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"fe07c9af-c0ec-4b3b-bc4f-1be41c5cf7b2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Br\[Pi]0ToALP", "[", "ma_", "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"ma", "<", "0.135"}], ",", 
     RowBox[{"Evaluate", "[", 
      RowBox[{
       RowBox[{"Interpolation", "[", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"NotebookDirectory", "[", "]"}], ",", 
              "\"\<phenomenology/ALPs with photon coupling/branching \
ratios/BrPi0ToALP.txt\>\""}], "}"}], "]"}], ",", "\"\<Table\>\""}], "]"}], 
         ",", 
         RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", "ma", "]"}],
       "]"}], ",", "0"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Br\[Eta]ToALP", "[", "ma_", "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"ma", "<", "0.547"}], ",", 
     RowBox[{"Evaluate", "[", 
      RowBox[{
       RowBox[{"Interpolation", "[", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"NotebookDirectory", "[", "]"}], ",", 
              "\"\<phenomenology/ALPs with photon coupling/branching \
ratios/BrEtaToALP.txt\>\""}], "}"}], "]"}], ",", "\"\<Table\>\""}], "]"}], 
         ",", 
         RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", "ma", "]"}],
       "]"}], ",", "0"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8922698714941463`*^9, 3.8922699327376633`*^9}, {
  3.8937513913507843`*^9, 3.893751414852765*^9}},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->"In[1]:=",ExpressionUUID->"eb8c0f16-2688-4f53-8f87-c697473ee20c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["ALP lifetime", "Subsection",
 CellChangeTimes->{{3.826651853928807*^9, 3.8266518561959257`*^9}, {
   3.877248260034466*^9, 3.8772482610102777`*^9}, 3.8851399575347958`*^9, {
   3.885745157032287*^9, 3.8857451590196285`*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"3dd7b844-8e27-44cd-bb8b-37dac39065de"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"<<", "FeynCalc`"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      FractionBox["1", "4"], 
      FractionBox["1", "2"], " ", "from", " ", "the", " ", "definition", " ", 
      "of", " ", "the", " ", "Lagrangian"}], ",", " ", 
     RowBox[{"2", " ", "from", " ", "combinatorics"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MALPdecay", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        FractionBox["ga", "4"], 
        FractionBox["1", "2"], "*", "2", "*", 
        RowBox[{"LeviCivita", "[", 
         RowBox[{"\[Mu]", ",", "\[Nu]", ",", "\[Alpha]", ",", "\[Beta]"}], 
         "]"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"FV", "[", 
            RowBox[{"p\[Gamma]1", ",", "\[Mu]"}], "]"}], "*", 
           RowBox[{"PolarizationVector", "[", 
            RowBox[{"p\[Gamma]1", ",", "\[Nu]"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"FV", "[", 
            RowBox[{"p\[Gamma]1", ",", "\[Nu]"}], "]"}], "*", 
           RowBox[{"PolarizationVector", "[", 
            RowBox[{"p\[Gamma]1", ",", "\[Mu]"}], "]"}]}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"FV", "[", 
            RowBox[{"p\[Gamma]2", ",", "\[Alpha]"}], "]"}], "*", 
           RowBox[{"PolarizationVector", "[", 
            RowBox[{"p\[Gamma]2", ",", "\[Beta]"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"FV", "[", 
            RowBox[{"p\[Gamma]2", ",", "\[Beta]"}], "]"}], "*", 
           RowBox[{"PolarizationVector", "[", 
            RowBox[{"p\[Gamma]2", ",", "\[Alpha]"}], "]"}]}]}], ")"}]}], "//",
        "Contract"}], "//", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MALPdecayStar", " ", "=", " ", 
     RowBox[{"ComplexConjugate", "[", "MALPdecay", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MALPdecaySquared", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"DoPolarizationSums", "[", 
           RowBox[{
            RowBox[{"DoPolarizationSums", "[", 
             RowBox[{
              RowBox[{"MALPdecay", " ", "MALPdecayStar"}], ",", 
              "p\[Gamma]1"}], "]"}], ",", "p\[Gamma]2"}], "]"}], "//", 
          "Contract"}], "//", "Simplify"}], ")"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"ScalarProduct", "[", 
           RowBox[{"p\[Gamma]1", ",", "p\[Gamma]2"}], "]"}], "\[Rule]", 
          FractionBox[
           SuperscriptBox["ma", "2"], "2"]}], ",", 
         RowBox[{
          RowBox[{"ScalarProduct", "[", 
           RowBox[{"p\[Gamma]1", ",", "p\[Gamma]1"}], "]"}], "\[Rule]", "0"}],
          ",", 
         RowBox[{
          RowBox[{"ScalarProduct", "[", 
           RowBox[{"p\[Gamma]2", ",", "p\[Gamma]2"}], "]"}], "\[Rule]", " ", 
          "0"}]}], "}"}]}], "//", "Simplify"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", "\"\<ALP decay width:\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "chbar", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"chbar", "=", " ", 
     RowBox[{"6.6", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "25"}]], "*", "3", "*", 
      SuperscriptBox["10", "8"]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"1", "/", "2"}], " ", "from", " ", "indistinguishability", " ", 
     "of", " ", "two", " ", "photons"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalGamma]ALPdecay", "[", 
      RowBox[{"ma_", ",", "ga_"}], "]"}], "=", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"8", "Pi"}]], "*", 
      FractionBox["1", "2"], "MALPdecaySquared", "*", 
      FractionBox["1", 
       RowBox[{"2", "ma"}]]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c\[Tau]ALPphoton", "[", 
     RowBox[{"ma_", ",", "ga_"}], "]"}], "=", 
    FractionBox["chbar", 
     RowBox[{"\[CapitalGamma]ALPdecay", "[", 
      RowBox[{"ma", ",", "ga"}], "]"}]]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ldecayALPphoton", "[", 
      RowBox[{"ma_", ",", "ga_", ",", "Ea_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"c\[Tau]ALPphoton", "[", 
       RowBox[{"ma", ",", "ga"}], "]"}], "*", 
      FractionBox[
       SqrtBox[
        RowBox[{
         SuperscriptBox["Ea", "2"], "-", 
         SuperscriptBox["ma", "2"]}]], "ma"]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8857451960661077`*^9, 3.885745398658164*^9}, {
  3.8857454295813036`*^9, 3.8857455090390244`*^9}, {3.885745547238306*^9, 
  3.8857456458907394`*^9}, {3.892267311103952*^9, 3.892267311706234*^9}, {
  3.892276710138377*^9, 3.8922767267485237`*^9}, {3.903976133712036*^9, 
  3.90397620401244*^9}},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->"In[3]:=",ExpressionUUID->"6d5dcc26-d814-4435-9237-3d68cd75ad0c"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"FeynCalc \"\>", "Text",
    StripOnInput->False,
    FontWeight->Bold], "\[InvisibleSpace]", 
   StyleBox["\<\"9.3.1 (stable version). For help, use the \"\>", "Text",
    StripOnInput->False], "\[InvisibleSpace]", 
   StyleBox[
    TagBox[
     ButtonBox[
      RowBox[{"documentation", " ", "center"}],
      BaseStyle->"Link",
      ButtonData:>"paclet:FeynCalc/",
      ButtonNote->"paclet:FeynCalc/"],
     DisplayForm], "Text",
    StripOnInput->False], "\[InvisibleSpace]", 
   StyleBox["\<\", check out the \"\>", "Text",
    StripOnInput->False], "\[InvisibleSpace]", 
   StyleBox[
    TagBox[
     ButtonBox["wiki",
      BaseStyle->"Hyperlink",
      ButtonData:>{
        URL["https://github.com/FeynCalc/feyncalc/wiki"], None},
      ButtonNote->"https://github.com/FeynCalc/feyncalc/wiki"],
     DisplayForm], "Text",
    StripOnInput->False], "\[InvisibleSpace]", 
   StyleBox["\<\" or visit the \"\>", "Text",
    StripOnInput->False], "\[InvisibleSpace]", 
   StyleBox[
    TagBox[
     ButtonBox[
      RowBox[{"forum", "."}],
      BaseStyle->"Hyperlink",
      ButtonData:>{
        URL["https://github.com/FeynCalc/feyncalc/discussions"], None},
      ButtonNote->"http://www.feyncalc.org/forum/"],
     DisplayForm], "Text",
    StripOnInput->False]}],
  SequenceForm[
   Style["FeynCalc ", "Text", Bold], 
   Style["9.3.1 (stable version). For help, use the ", "Text"], 
   Style[
    DisplayForm[
     ButtonBox[
     "documentation center", BaseStyle -> "Link", ButtonData :> 
      "paclet:FeynCalc/", ButtonNote -> "paclet:FeynCalc/"]], "Text"], 
   Style[", check out the ", "Text"], 
   Style[
    DisplayForm[
     ButtonBox["wiki", ButtonData :> {
        URL["https://github.com/FeynCalc/feyncalc/wiki"], None}, BaseStyle -> 
      "Hyperlink", ButtonNote -> 
      "https://github.com/FeynCalc/feyncalc/wiki"]], "Text"], 
   Style[" or visit the ", "Text"], 
   Style[
    DisplayForm[
     ButtonBox["forum.", ButtonData :> {
        URL["https://github.com/FeynCalc/feyncalc/discussions"], None}, 
      BaseStyle -> "Hyperlink", ButtonNote -> 
      "http://www.feyncalc.org/forum/"]], "Text"]],
  Editable->False]], "Print",
 CellChangeTimes->{3.904901715248007*^9},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->
  "During evaluation of \
In[3]:=",ExpressionUUID->"ab462dae-c2ce-4275-b896-7854a5100ace"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"To save your and our time, please check our \"\>", "Text",
    StripOnInput->False], "\[InvisibleSpace]", 
   StyleBox[
    TagBox[
     ButtonBox["FAQ",
      BaseStyle->"Hyperlink",
      ButtonData:>{
        URL["https://github.com/FeynCalc/feyncalc/wiki/FAQ"], None},
      ButtonNote->"https://github.com/FeynCalc/feyncalc/wiki"],
     DisplayForm], "Text",
    StripOnInput->False], "\[InvisibleSpace]", 
   StyleBox["\<\" for answers to some common FeynCalc questions.\"\>", "Text",
    StripOnInput->False]}],
  SequenceForm[
   Style["To save your and our time, please check our ", "Text"], 
   Style[
    DisplayForm[
     ButtonBox["FAQ", ButtonData :> {
        URL["https://github.com/FeynCalc/feyncalc/wiki/FAQ"], None}, 
      BaseStyle -> "Hyperlink", ButtonNote -> 
      "https://github.com/FeynCalc/feyncalc/wiki"]], "Text"], 
   Style[" for answers to some common FeynCalc questions.", "Text"]],
  Editable->False]], "Print",
 CellChangeTimes->{3.904901715263628*^9},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->
  "During evaluation of \
In[3]:=",ExpressionUUID->"a864dc8e-66b6-45a5-9c74-46f9adf345cd"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"See also the supplied \"\>", "Text",
    StripOnInput->False], "\[InvisibleSpace]", 
   StyleBox[
    TagBox[
     ButtonBox[
      RowBox[{"examples", "."}],
      BaseStyle->"Hyperlink",
      ButtonFunction:>SystemOpen[
        FileNameJoin[{FeynCalc`$FeynCalcDirectory, "Examples"}]],
      Evaluator->Automatic,
      Method->"Preemptive"],
     DisplayForm], "Text",
    StripOnInput->False], "\[InvisibleSpace]", 
   StyleBox["\<\" If you use FeynCalc in your research, please cite\"\>", 
    "Text",
    StripOnInput->False]}],
  SequenceForm[
   Style["See also the supplied ", "Text"], 
   Style[
    DisplayForm[
     ButtonBox[
     "examples.", BaseStyle -> "Hyperlink", ButtonFunction :> SystemOpen[
        FileNameJoin[{FeynCalc`$FeynCalcDirectory, "Examples"}]], Evaluator -> 
      Automatic, Method -> "Preemptive"]], "Text"], 
   Style[" If you use FeynCalc in your research, please cite", "Text"]],
  Editable->False]], "Print",
 CellChangeTimes->{3.904901715279249*^9},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->
  "During evaluation of \
In[3]:=",ExpressionUUID->"f48fb368-d1f8-4e53-9490-07ca85066604"],

Cell[BoxData[
 StyleBox["\<\" \[Bullet] V. Shtabovenko, R. Mertig and F. Orellana, \
Comput.Phys.Commun. 256 (2020) 107478, arXiv:2001.04407.\"\>", "Text",
  StripOnInput->False]], "Print",
 CellChangeTimes->{3.904901715279249*^9},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->
  "During evaluation of \
In[3]:=",ExpressionUUID->"cebb1ed7-6813-4bf9-8897-6321f529e20b"],

Cell[BoxData[
 StyleBox["\<\" \[Bullet] V. Shtabovenko, R. Mertig and F. Orellana, \
Comput.Phys.Commun. 207 (2016) 432-444, arXiv:1601.01167.\"\>", "Text",
  StripOnInput->False]], "Print",
 CellChangeTimes->{3.904901715279249*^9},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->
  "During evaluation of \
In[3]:=",ExpressionUUID->"87a09b43-9bc1-4078-bc81-8b1a9f8870e6"],

Cell[BoxData[
 StyleBox["\<\" \[Bullet] R. Mertig, M. B\[ODoubleDot]hm, and A. Denner, \
Comput. Phys. Commun. 64 (1991) 345-359.\"\>", "Text",
  StripOnInput->False]], "Print",
 CellChangeTimes->{3.904901715279249*^9},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->
  "During evaluation of \
In[3]:=",ExpressionUUID->"8b60106e-86d5-4cd1-89f5-be7d9eb896c2"],

Cell[BoxData["\<\"ALP decay width:\"\>"], "Print",
 CellChangeTimes->{3.9049017153265886`*^9},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->
  "During evaluation of \
In[3]:=",ExpressionUUID->"012c9c9b-36dd-4dc5-81c7-8711a1e1702b"]
}, Open  ]],

Cell[BoxData[
 FractionBox["3.981026210628985`*^-14", 
  RowBox[{
   SuperscriptBox["ga", "2"], " ", 
   SuperscriptBox["ma", "3"]}]]], "Output",
 CellChangeTimes->{3.9049017153422527`*^9},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->"Out[10]=",ExpressionUUID->"4b3491e6-1fa9-4160-b356-da6577b023d7"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Compilable interpolation function mapping one grid into another\
\>", "Chapter",
 CellChangeTimes->{3.8927117344949155`*^9},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"9930ec21-c32c-4ff4-b23e-d5a85d028d42"],

Cell[CellGroupData[{

Cell["3D to 3D", "Section",
 CellChangeTimes->{{3.890732625178977*^9, 3.890732634660539*^9}, 
   3.8927117366160936`*^9},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"1a702223-c453-446a-8188-00f344c9fa89"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nd", "=", "3"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"cf3", "=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"xgvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<xg\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"igvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<ig\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"tgvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<tg\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"ivars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<i\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"svars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<s\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"tvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<t\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"jvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<j\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}]}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Inactivate", "[", 
         RowBox[{
          RowBox[{"Compile", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"seq", "@", 
               RowBox[{"{", 
                RowBox[{"xgvars", ",", "_Real", ",", "1"}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", "_Real", ",", "nd"}], "}"}]}], "}"}], ",", 
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"seq", "@", "igvars"}], ",", 
                RowBox[{"seq", "@", "tgvars"}], ",", 
                RowBox[{"seq", "@", "ivars"}], ",", 
                RowBox[{"seq", "@", "svars"}], ",", 
                RowBox[{"seq", "@", "tvars"}]}], "}"}], ",", 
              RowBox[{
               RowBox[{"seq", "[", 
                RowBox[{"igvars", "=", 
                 RowBox[{
                  RowBox[{"Floor", "[", "xgvars", "]"}], "-", 
                  RowBox[{"UnitStep", "[", 
                   RowBox[{"xgvars", "-", 
                    RowBox[{"indexed", "@", 
                    RowBox[{"Dimensions", "@", "y"}]}]}], "]"}]}]}], "]"}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"seq", "[", 
                RowBox[{"tgvars", "=", 
                 RowBox[{"xgvars", "-", "igvars"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"seq", "[", 
                   RowBox[{"tvars", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"tgvars", ",", "jvars"}], "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"seq", "[", 
                   RowBox[{"ivars", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"igvars", ",", "jvars"}], "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"seq", "[", 
                   RowBox[{"svars", "=", 
                    RowBox[{"1.", "-", "tvars"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"eval", "@", 
                   RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Times", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], " ", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], "]"}]}], 
                    "&"}], "/@", 
                    RowBox[{"Tuples", "@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"svars", ",", "ivars"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"tvars", ",", 
                    RowBox[{"ivars", "+", "1"}]}], "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}]}]}], 
                    "]"}]}]}], ",", 
                 RowBox[{"seq", "@", 
                  RowBox[{"{", 
                   RowBox[{"jvars", ",", 
                    RowBox[{"Length", "@", "igvars"}]}], "}"}]}]}], "]"}]}]}],
              "]"}], ",", 
            RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
            RowBox[{"RuntimeAttributes", "\[Rule]", 
             RowBox[{"{", "Listable", "}"}]}], ",", 
            RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
            RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}], 
          ",", 
          RowBox[{"Except", "[", 
           RowBox[{"seq", "|", "eval", "|", "indexed"}], "]"}]}], "]"}], "/.", 
        RowBox[{
         RowBox[{"seq", "[", "expr_", "]"}], "\[RuleDelayed]", 
         RowBox[{"RuleCondition", "@", 
          RowBox[{"(", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Inactivate", "[", 
                RowBox[{"expr", ",", 
                 RowBox[{"Except", "[", 
                  RowBox[{"slist", "|", "indexed"}], "]"}]}], "]"}], "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"l_slist", "\[RuleDelayed]", 
                  RowBox[{"l", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"indexed", "[", "l_", "]"}], "\[RuleDelayed]", 
                  RowBox[{
                   RowBox[{"Inactive", "[", "Compile`GetElement", "]"}], "[", 
                   RowBox[{"l", ",", "i"}], "]"}]}]}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "nd"}], "}"}]}], "]"}]}], ")"}]}]}]}], "/.", 
       RowBox[{
        RowBox[{"eval", "@", "expr_"}], "\[RuleDelayed]", 
        RowBox[{"RuleCondition", "[", 
         RowBox[{"Activate", "[", 
          RowBox[{"expr", "/.", 
           RowBox[{"slist", "\[Rule]", "List"}]}], "]"}], "]"}]}]}]}], "]"}], 
    "//", "Activate"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.890711783488103*^9, 3.89071178348964*^9}, {
  3.8907121412539587`*^9, 3.8907121413711557`*^9}, {3.890712694841427*^9, 
  3.8907126950000925`*^9}, {3.890712790376151*^9, 3.8907128219919777`*^9}, {
  3.891018553068019*^9, 3.8910185548862777`*^9}, {3.892712744759107*^9, 
  3.892712746296662*^9}},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->"In[12]:=",ExpressionUUID->"f207a765-7cde-4e75-8a61-076a1dd78c3a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["4D to 4D", "Section",
 CellChangeTimes->{{3.890732625178977*^9, 3.890732634660539*^9}, {
  3.8927117366160936`*^9, 3.8927117442965827`*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"53079a8e-45a4-48ec-9cb4-0078005932ef"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nd", "=", "4"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"cf4", "=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"xgvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<xg\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"igvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<ig\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"tgvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<tg\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"ivars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<i\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"svars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<s\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"tvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<t\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"jvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<j\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}]}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Inactivate", "[", 
         RowBox[{
          RowBox[{"Compile", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"seq", "@", 
               RowBox[{"{", 
                RowBox[{"xgvars", ",", "_Real", ",", "1"}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", "_Real", ",", "nd"}], "}"}]}], "}"}], ",", 
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"seq", "@", "igvars"}], ",", 
                RowBox[{"seq", "@", "tgvars"}], ",", 
                RowBox[{"seq", "@", "ivars"}], ",", 
                RowBox[{"seq", "@", "svars"}], ",", 
                RowBox[{"seq", "@", "tvars"}]}], "}"}], ",", 
              RowBox[{
               RowBox[{"seq", "[", 
                RowBox[{"igvars", "=", 
                 RowBox[{
                  RowBox[{"Floor", "[", "xgvars", "]"}], "-", 
                  RowBox[{"UnitStep", "[", 
                   RowBox[{"xgvars", "-", 
                    RowBox[{"indexed", "@", 
                    RowBox[{"Dimensions", "@", "y"}]}]}], "]"}]}]}], "]"}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"seq", "[", 
                RowBox[{"tgvars", "=", 
                 RowBox[{"xgvars", "-", "igvars"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"seq", "[", 
                   RowBox[{"tvars", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"tgvars", ",", "jvars"}], "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"seq", "[", 
                   RowBox[{"ivars", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"igvars", ",", "jvars"}], "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"seq", "[", 
                   RowBox[{"svars", "=", 
                    RowBox[{"1.", "-", "tvars"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"eval", "@", 
                   RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Times", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], " ", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], "]"}]}], 
                    "&"}], "/@", 
                    RowBox[{"Tuples", "@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"svars", ",", "ivars"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"tvars", ",", 
                    RowBox[{"ivars", "+", "1"}]}], "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}]}]}], 
                    "]"}]}]}], ",", 
                 RowBox[{"seq", "@", 
                  RowBox[{"{", 
                   RowBox[{"jvars", ",", 
                    RowBox[{"Length", "@", "igvars"}]}], "}"}]}]}], "]"}]}]}],
              "]"}], ",", 
            RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
            RowBox[{"RuntimeAttributes", "\[Rule]", 
             RowBox[{"{", "Listable", "}"}]}], ",", 
            RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
            RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}], 
          ",", 
          RowBox[{"Except", "[", 
           RowBox[{"seq", "|", "eval", "|", "indexed"}], "]"}]}], "]"}], "/.", 
        RowBox[{
         RowBox[{"seq", "[", "expr_", "]"}], "\[RuleDelayed]", 
         RowBox[{"RuleCondition", "@", 
          RowBox[{"(", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Inactivate", "[", 
                RowBox[{"expr", ",", 
                 RowBox[{"Except", "[", 
                  RowBox[{"slist", "|", "indexed"}], "]"}]}], "]"}], "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"l_slist", "\[RuleDelayed]", 
                  RowBox[{"l", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"indexed", "[", "l_", "]"}], "\[RuleDelayed]", 
                  RowBox[{
                   RowBox[{"Inactive", "[", "Compile`GetElement", "]"}], "[", 
                   RowBox[{"l", ",", "i"}], "]"}]}]}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "nd"}], "}"}]}], "]"}]}], ")"}]}]}]}], "/.", 
       RowBox[{
        RowBox[{"eval", "@", "expr_"}], "\[RuleDelayed]", 
        RowBox[{"RuleCondition", "[", 
         RowBox[{"Activate", "[", 
          RowBox[{"expr", "/.", 
           RowBox[{"slist", "\[Rule]", "List"}]}], "]"}], "]"}]}]}]}], "]"}], 
    "//", "Activate"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8907148978688216`*^9, 3.890714898931299*^9}, {
  3.8910185630697727`*^9, 3.8910185650759544`*^9}, {3.8927127498244977`*^9, 
  3.8927127515301657`*^9}},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->"In[14]:=",ExpressionUUID->"1da2f8fa-b047-4f2d-b683-584cace5a4a8"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Specifying the experiment", "Title",
 CellChangeTimes->{{3.8876176539003353`*^9, 3.8876176564507346`*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"918dc508-7b59-4717-9363-a48741db503f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Parent", " ", "directory"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NotebookDirectory", "[", "]"}], "//", "ParentDirectory"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AcceptanceDirectory", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Acceptances\>\""}], 
     "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExperimentDirectoriesList", "=", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"FileNames", "[", 
       RowBox[{"\"\<*\>\"", ",", "AcceptanceDirectory", ",", "1"}], "]"}], 
      ",", "DirectoryQ"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"List", " ", "of", " ", "available", " ", "experiments", " ", 
    RowBox[{"(", 
     RowBox[{
     "for", " ", "which", " ", "the", " ", "geometry", " ", "has", " ", 
      "been", " ", "implemented"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentsListTemp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"FileNameTake", "[", 
      RowBox[{
       RowBox[{"ExperimentDirectoriesList", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"-", "1"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "ExperimentDirectoriesList", "]"}], ",", "1"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentsListTemp2", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Partition", "[", 
      RowBox[{"ExperimentsListTemp", ",", "1"}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"TrueQ", "@", 
         RowBox[{"FileExistsQ", "@", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"NotebookDirectory", "[", "]"}], ",", 
             "\"\<Acceptances\>\"", ",", 
             RowBox[{"ExperimentsListTemp", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"ToString", "@", 
              RowBox[{"StringForm", "[", 
               RowBox[{"\"\<Acceptance_``_for_ALP-photon.m\>\"", ",", 
                RowBox[{"ExperimentsListTemp", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], "}"}], 
           "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "ExperimentsListTemp", "]"}]}], "}"}]}], 
      "]"}], ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ExperimentsList", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{"ExperimentsListTemp2", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "True"}], "&"}]}], "]"}],
     "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", 
   "Sort"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", "ExperimentsList", "]"}], "\[Equal]", "0"}], ",", 
   RowBox[{
   "Print", "[", 
    "\"\<No experiment is available, generate first the acceptance for the \
given experiment using module 1\>\"", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Selected experiments:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"selectionDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", 
      RowBox[{"{", "}"}]}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{
        "{", "\"\<Select the experiments for which the number of events will \
be computed:\>\"", "}"}], "]"}], ",", 
       RowBox[{"Pane", "[", 
        RowBox[{
         RowBox[{"TogglerBar", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list", ",", 
           RowBox[{"Appearance", "->", 
            RowBox[{"\"\<Vertical\>\"", "->", 
             RowBox[{"{", 
              RowBox[{"Automatic", ",", "5"}], "}"}]}]}]}], "]"}], ",", 
         RowBox[{"ImageSize", "->", 
          RowBox[{"{", 
           RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], ",", 
         RowBox[{"Scrollbars", "->", 
          RowBox[{"{", 
           RowBox[{"False", ",", "True"}], "}"}]}]}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"SelectedExperimentList", "=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "ExperimentsList", "]"}], "\[NotEqual]", "0"}], 
    ",", 
    RowBox[{"selectionDialog", "[", 
     RowBox[{"ExperimentsList", ",", "\"\<Select the experiments:\>\""}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"icounter", "=", "1"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8851403254718485`*^9, 3.8851403429411273`*^9}, {
   3.8854395484478483`*^9, 3.885439559226637*^9}, {3.8854397351242537`*^9, 
   3.885439739219259*^9}, {3.8857456612163286`*^9, 3.88574566480231*^9}, {
   3.8861411634855022`*^9, 3.886141166650899*^9}, {3.887617161679597*^9, 
   3.887617176688754*^9}, 3.8894972924584713`*^9, {3.892273507154902*^9, 
   3.892273514635621*^9}, 3.892275198624486*^9, {3.8932344295084324`*^9, 
   3.893234442522108*^9}, {3.893348184596305*^9, 3.8933481854375906`*^9}, {
   3.89921502896612*^9, 3.899215032012908*^9}, 3.9027627272514553`*^9, 
   3.902762760721679*^9, 3.9027629809684596`*^9, {3.9028938898522644`*^9, 
   3.9028938900527954`*^9}},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->"In[16]:=",ExpressionUUID->"a9dc099a-58c7-4b4a-87b0-fae273cf5733"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"\<\"HIKE-dump\"\>", ",", "\<\"SHiP-ECN3\"\>", 
    ",", "\<\"SHiP-ECN3-LoI\"\>"}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.9049017181783257`*^9},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->"Out[22]=",ExpressionUUID->"fc074c24-928f-4033-bf16-8876b6c97ae8"],

Cell[BoxData[
 FormBox["\<\"Selected experiments:\"\>", TraditionalForm]], "Print",
 CellChangeTimes->{3.9049017181783257`*^9},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->
  "During evaluation of \
In[16]:=",ExpressionUUID->"d9540334-e4a4-4525-ac00-81141f0c3b7e"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", "\<\"HIKE-dump\"\>", "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.9049017237338753`*^9},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->"Out[27]=",ExpressionUUID->"50d94629-a31c-47bb-b6ba-3f573c796b2f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Running block for next sections", "Chapter",
 CellChangeTimes->{{3.902729140157612*^9, 3.90272914444062*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"389ee8eb-49d3-4272-aea6-a6f7b184662e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"BlockEvaluation", "[", "tag_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nb", "=", 
      RowBox[{"EvaluationNotebook", "[", "]"}]}], ";", "\n", 
     RowBox[{"NotebookFind", "[", 
      RowBox[{"nb", ",", "tag", ",", "All", ",", "CellTags"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"tagselected", "==", "\"\<Number-of-events\>\""}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
      "BlockEvaluation", "[", "\"\<Number-of-events-computation\>\"", "]"}], 
      ";"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"icounter", ",", "1", ",", 
       RowBox[{"Length", "[", "SelectedExperimentList", "]"}], ",", "1"}], 
      "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"tagselected", "==", "\"\<Acceptance\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
        "BlockEvaluation", "[", "\"\<Acceptance-computation\>\"", "]"}], 
        ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"icounter", ",", "1", ",", 
         RowBox[{"Length", "[", "SelectedExperimentList", "]"}], ",", "1"}], 
        "}"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.9027291581950865`*^9, 3.902729215695462*^9}, {
  3.902761777481885*^9, 3.902761802513644*^9}, {3.902893887260816*^9, 
  3.902893887694474*^9}, {3.902975258830757*^9, 3.902975279747931*^9}, {
  3.9029753215848904`*^9, 3.9029753368839917`*^9}},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->"In[29]:=",ExpressionUUID->"bc53587b-88a1-4f20-8274-cad588e7d06d"],

Cell[BoxData[
 FormBox[
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"tagselected", "\[LongEqual]", "\<\"Number-of-events\"\>"}], ",", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
       "BlockEvaluation", "(", "\<\"Number-of-events-computation\"\>", ")"}], 
       ";"}], ",", 
      RowBox[{"{", 
       RowBox[{"icounter", ",", "1", ",", 
        RowBox[{"Length", "[", "SelectedExperimentList", "]"}], ",", "1"}], 
       "}"}]}], "]"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"tagselected", "\[LongEqual]", "\<\"Acceptance\"\>"}], ",", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
         "BlockEvaluation", "(", "\<\"Acceptance-computation\"\>", ")"}], 
         ";"}], ",", 
        RowBox[{"{", 
         RowBox[{"icounter", ",", "1", ",", 
          RowBox[{"Length", "[", "SelectedExperimentList", "]"}], ",", "1"}], 
         "}"}]}], "]"}]}], "]"}]}], "]"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.904901723828039*^9},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->"Out[30]=",ExpressionUUID->"c12d5fa5-616d-46b2-a1f0-27544ecf494b"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Number of events", "Title",
 CellChangeTimes->{{3.885140281753849*^9, 3.8851402836781845`*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"128d78c3-8bd2-4cc0-aade-\
f5ea999c5498"],

Cell[CellGroupData[{

Cell["Cross-sections, acceptances", "Chapter",
 CellChangeTimes->{
  3.887617684981284*^9, {3.8946372284965158`*^9, 3.894637232121416*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"024306d0-6fd7-404c-b503-\
13b97cb70d6e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SelectedExperiment", "=", 
   RowBox[{"SelectedExperimentList", "[", 
    RowBox[{"[", 
     RowBox[{"icounter", "++"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dataAcceptances", "=", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<Acceptances\>\"", ",", "SelectedExperiment", ",", 
           RowBox[{"ToString", "@", 
            RowBox[{"StringForm", "[", 
             RowBox[{
             "\"\<Acceptance_``_for_ALP-photon.m\>\"", ",", 
              "SelectedExperiment"}], "]"}]}]}], "}"}], "]"}], "}"}], "]"}], 
      ",", "\"\<MX\>\""}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FacilityGivenExperiment", "=", 
   RowBox[{"dataAcceptances", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ECALoption", "=", 
   RowBox[{"dataAcceptances", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullAcceptanceData0", "=", 
   RowBox[{"dataAcceptances", "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BrVisTemp", "[", "mFIP_", "]"}], "=", 
   RowBox[{"dataAcceptances", "[", 
    RowBox[{"[", "5", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlistBr", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"Table", "[", 
     RowBox[{"m", ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0.02", ",", "5.1", ",", "0.005"}], "}"}]}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BrVis", "[", "mFIP_", "]"}], "=", 
    RowBox[{
     RowBox[{"Interpolation", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"mFIP", ",", 
           RowBox[{"BrVisTemp", "[", "mFIP", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"mFIP", ",", "mlistBr"}], "}"}]}], "]"}], ",", 
       RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", "mFIP", 
     "]"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{"LogLogPlot", "[", 
  RowBox[{
   RowBox[{"BrVis", "[", "mFIP", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"mFIP", ",", "0.02", ",", "10"}], "}"}], ",", 
   RowBox[{"Frame", "->", "True"}], ",", 
   RowBox[{"ImageSize", "->", "Large"}], ",", 
   RowBox[{"FrameStyle", "\[Rule]", 
    RowBox[{"Directive", "[", 
     RowBox[{"Black", ",", " ", "22"}], "]"}]}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Blue"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
        RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
        RowBox[{"Darker", "@", 
         RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Black"}], "}"}]}], 
     "}"}]}], ",", 
   RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"MinMax", "[", "mlistBr", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.01", ",", "1.2"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<m [GeV]\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(Br\), \(vis\)]\)\>\""}], "}"}]}], ",", 
   RowBox[{"PlotLabel", "\[Rule]", " ", 
    RowBox[{"Style", "[", 
     RowBox[{
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<For \>\"", ",", "SelectedExperiment"}], "}"}], "]"}], 
      ",", " ", "20", ",", " ", "Black"}], "]"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Theta]minExpAll", ",", "\[Theta]maxExpAll"}], "}"}], "=", 
   RowBox[{"MinMax", "[", 
    RowBox[{"FullAcceptanceData0", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Theta]minExp", ",", "\[Theta]maxExp"}], "}"}], "=", 
   RowBox[{"MinMax", "[", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"FullAcceptanceData0", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "6", "]"}], "]"}], "\[NotEqual]", "0"}], "&"}]}], 
      "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"zminExp", ",", "zmaxExp"}], "}"}], "=", 
   RowBox[{"MinMax", "[", 
    RowBox[{"FullAcceptanceData0", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AzimuthalAcceptanceData", "=", 
    RowBox[{
     RowBox[{"DeleteDuplicatesBy", "[", 
      RowBox[{"FullAcceptanceData0", ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "&"}]}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "4", ",", "5"}], "}"}]}], "]"}], "]"}]}], ";"}], "//",
   "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]Grid", "=", 
   RowBox[{"DeleteDuplicates", "[", 
    RowBox[{"AzimuthalAcceptanceData", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zminmax\[Theta]data", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"MinMax", "[", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"AzimuthalAcceptanceData", ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "==", 
            RowBox[{"\[Theta]Grid", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "&&", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "\[NotEqual]", "0"}]}], "&"}]}], 
        "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "\[Theta]Grid", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zmin\[Theta]", "[", "\[Theta]a_", "]"}], "=", 
   RowBox[{
    RowBox[{"Interpolation", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{"\[Theta]Grid", ",", "1"}], "]"}], ",", 
        RowBox[{"zminmax\[Theta]data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", "1", "}"}]}], "]"}], "]"}], ",", "2"}], "]"}], ",", 
      RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
    "\[Theta]a", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zmax\[Theta]", "[", "\[Theta]a_", "]"}], "=", 
   RowBox[{
    RowBox[{"Interpolation", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{"\[Theta]Grid", ",", "1"}], "]"}], ",", 
        RowBox[{"zminmax\[Theta]data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}], "]"}], ",", "2"}], "]"}], ",", 
      RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
    "\[Theta]a", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AzimuthalAcceptanceALPphoton", "[", 
   RowBox[{"\[Theta]a_", ",", "za_"}], "]"}], "=", 
  RowBox[{
   RowBox[{"Interpolation", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"#", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}], "/@", 
      "AzimuthalAcceptanceData"}], ",", 
     RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
   RowBox[{"\[Theta]a", ",", "za"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DecAccDataLogarithmizedComp", "=", 
   RowBox[{
    RowBox[{"Hold", "@", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"FullAcceptanceData", ",", "_Real", ",", "2"}], "}"}], "}"}],
        ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Log10", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
           RowBox[{"Log10", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
           RowBox[{"Log10", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
           RowBox[{"Log10", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "]"}], ",", 
           RowBox[{"Log10", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "6", "]"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
        "FullAcceptanceData"}]}], "]"}]}], "//", "ReleaseHold"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"DecayAcceptanceALPphoton", "[", 
      RowBox[{"ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "za_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"BrVis", "[", "ma", "]"}], "*", 
      RowBox[{"10", "^", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{
           RowBox[{
           "DecAccDataLogarithmizedComp", "[", "FullAcceptanceData0", "]"}], 
           ",", 
           RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
         RowBox[{
          RowBox[{"Log10", "[", "ma", "]"}], ",", 
          RowBox[{"Log10", "[", "\[Theta]a", "]"}], ",", 
          RowBox[{"Log10", "[", "Ea", "]"}], ",", 
          RowBox[{"Log10", "[", "za", "]"}]}], "]"}], ")"}]}]}]}], ";"}], "//",
    "AbsoluteTiming"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Interpolation", " ", "for", " ", "the", " ", "full", " ", "acceptance"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"acccomp", "=", 
    RowBox[{
     RowBox[{"Hold", "@", 
      RowBox[{"Compile", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"data", ",", "_Real", ",", "2"}], "}"}], "}"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Log10", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
            RowBox[{"Log10", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
            RowBox[{"Log10", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
            RowBox[{"Log10", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "4", "]"}], "]"}], "]"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "5", "]"}], "]"}], "*", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "6", "]"}], "]"}]}], "\[Equal]", "0"}], ",", 
              RowBox[{"-", "90"}], ",", 
              RowBox[{"Log10", "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "5", "]"}], "]"}], "*", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "6", "]"}], "]"}]}], "]"}]}], "]"}]}], "}"}], 
          "&"}], "/@", 
         RowBox[{"SortBy", "[", 
          RowBox[{"data", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "&"}]}], "]"}]}]}], 
       "]"}]}], "//", "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Interpolation", " ", "for", " ", "the", " ", "full", " ", "acceptance"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FullAcceptanceData", "=", 
    RowBox[{"acccomp", "[", "FullAcceptanceData0", "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FullAcceptanceALPphoton", "[", 
     RowBox[{"ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "za_"}], "]"}], "=", 
    RowBox[{"10", "^", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Interpolation", "[", 
        RowBox[{"FullAcceptanceData", ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
       RowBox[{
        RowBox[{"Log10", "[", "ma", "]"}], ",", 
        RowBox[{"Log10", "[", "\[Theta]a", "]"}], ",", 
        RowBox[{"Log10", "[", "Ea", "]"}], ",", 
        RowBox[{"Log10", "[", "za", "]"}]}], "]"}], ")"}]}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CrossSectionData", "=", 
   RowBox[{
    RowBox[{"dataAcceptances", "[", 
     RowBox[{"[", "4", "]"}], "]"}], "//", "Transpose"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NpotGivenExperiment", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"CrossSectionData", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<Npot\>\""}], 
         "&"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "//", "N"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "\[Chi]prod", "[", "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", 
    "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"CrossSectionData", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<PPi0\>\""}], 
        "&"}]}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Chi]prod", "[", "\"\<\[Eta]\>\"", "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"CrossSectionData", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<PEta\>\""}], 
         "&"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"infoDialog", "[", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{
      "\"\<The number of proton collisions is \>\"", ",", " ", 
       "NpotGivenExperiment", ",", 
       "\"\<. You may change it at the stage of computing the sensitivities\>\
\""}], "}"}], "]"}], "]"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{
   "\"\<Search for ALPs coupled to photons at \>\"", ",", " ", 
    "SelectedExperiment", ",", " ", "\"\< located at \>\"", ",", 
    "FacilityGivenExperiment", ",", 
    "\"\<. \!\(\*SubscriptBox[\(N\), \(collisions\)]\) = \>\"", ",", 
    "NpotGivenExperiment"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\"\<Quantity\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(min\)]\), rad\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(max\)]\), rad\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(min\)]\)(\!\(\*SubscriptBox[\(\
\[Epsilon]\), \(dec\)]\)), rad\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(max\)]\)(\!\(\*SubscriptBox[\(\
\[Epsilon]\), \(dec\)]\)), rad\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(z\), \(min\)]\), m\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(z\), \(max\)]\), m\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Description\>\"", ",", "\"\<Min angle covered by experiment\>\"", 
      ",", "\"\<Max angle covered by experiment\>\"", ",", 
      "\"\<Min angle where \!\(\*SubscriptBox[\(\[Epsilon]\), \(decay\)]\)\
\[NotEqual]0\>\"", ",", 
      "\"\<Max angle where \!\(\*SubscriptBox[\(\[Epsilon]\), \(decay\)]\)\
\[NotEqual]0\>\"", ",", "\"\<Min long. displacement of the decay volume\>\"", 
      ",", "\"\<Max long. displacement of the decay volume\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Value\>\"", ",", "\[Theta]minExpAll", ",", "\[Theta]maxExpAll", ",",
       "\[Theta]minExp", ",", "\[Theta]maxExp", ",", "zminExp", ",", 
      "zmaxExp"}], "}"}]}], "}"}], "//", "TableForm"}]}], "Input",
 CellChangeTimes->{{3.892273555027376*^9, 3.8922735858455534`*^9}, 
   3.8922736264418793`*^9, 3.89334818729985*^9, {3.8946372359045815`*^9, 
   3.8946372361851187`*^9}, {3.8950530462678795`*^9, 3.895053046621991*^9}, {
   3.895053166341967*^9, 3.895053168018862*^9}, {3.8991984349124603`*^9, 
   3.8991984456906548`*^9}, {3.899214782238123*^9, 3.899214783052837*^9}, {
   3.902762733791559*^9, 3.9027627359917836`*^9}, {3.9027627744784746`*^9, 
   3.902762775030295*^9}, {3.9048896011309633`*^9, 3.9048896029641848`*^9}, 
   3.9049016991836987`*^9},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->"In[31]:=",ExpressionUUID->"5f950072-065f-4973-a235-bace6753e9f0"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"0.3431055`", ",", "Null"}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.9049017241872005`*^9},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->"Out[32]=",ExpressionUUID->"1648ae56-3733-4148-906c-65e6bde61d65"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"0.0021701`", ",", "Null"}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.9049017242028227`*^9},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->"Out[38]=",ExpressionUUID->"0b44e2ec-0eb7-4e41-8472-6129b61b66b0"],

Cell[BoxData[
 FormBox[
  GraphicsBox[{{{}, {}, 
     TagBox[
      {RGBColor[0, 0, 1], Thickness[0.003], Opacity[1.], 
       LineBox[CompressedData["
1:eJxNzQ0s1HEYB/D/ncN5L0MipDRzR+kS1a7ocJdzrHMmnMjLscIq1tUNbWXt
znTVTjtHWmqo2EWJ6Ao7i1XYGOvIvJR1d51NXjN3XLXl+Xm2Z88+e/Y8X8+0
izE8PIZhUX/732RH19UNRdp1Yf/LUojn6hjIys5kO0IYMuXgjmuHqcj2DqII
mS/y8Oj52bM2yPE8P4p2wBZ8rvD1eyMbmWxygukTagOOK9goDqdbg+uT3sjP
RFuB30p1rMyTlmCSMq4ii26B7unHubxAIrjh0C6bBLI5yren5ARTzMCDEd0h
e7xMwY/zSpW/vQngBwRWQLe/CZg9J3Qt9cKDMz+vNYaTcOAgTNtucMHAGdRH
WRzPjc5N7+SOtUj8DWAG2Xruk+MaOGCi4abGfRVcQaPhjOvL4NOCjyk49SK4
V9LhrF2cB2crYgVl8jlwjxOR76HQbfFDSvG4Gtwq8Pigev4dzAzTOy8UTYKJ
XAnHCfsC9uCPug5z+sExsrVellgBTrnHnDa2yII3TR+bEumHleAVNdFq1nMQ
/LOqp5Z/YxR8KT1T1/JsClzgaJB3zMyAzfGtCoNKA56LuGOR3j4Lzi9/16Xj
/wIf8A57EpK7gPamI7Iq8RKYt/1Ko3XNCrj82NPscukqmP3qG9WneQ3MYjQ1
jzQYwEsWYqa0cgNcJj6qf5GAhWy6r2Z57+5YHDj+9rYL1+ORZ/LJTeNJyHpa
KrWCh0ya7ou1v4osdKu5RahEpklj1JpJ5IGiXD/GDHIiT5Rfq0G+HNBhTJ1H
rh7ycf6Kx4PXbXER/fuQRSuud8kkZIeJwJGS/ci+8pxUehByYqRK0HkK+Qdl
sdMtCjnPxdaskI1cog2VHEnc8n8wWSVNRq5uE7gvp23Jq76fwclCbhM21r/M
Rv4DEXofqQ==
        "]]},
      Annotation[#, "Charting`Private`Tag$23394#1"]& ]}, {}},
   AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
   Axes->{True, True},
   AxesLabel->{None, None},
   AxesOrigin->{-3.912023005428137, -4.60517018598808},
   CoordinatesToolOptions:>{"DisplayFunction" -> ({
       Exp[
        Part[#, 1]], 
       Exp[
        Part[#, 2]]}& ), "CopiedValueFunction" -> ({
       Exp[
        Part[#, 1]], 
       Exp[
        Part[#, 2]]}& )},
   DisplayFunction->Identity,
   Frame->{{True, True}, {True, True}},
   FrameLabel->{{
      FormBox[
       TagBox["\"\\!\\(\\*SubscriptBox[\\(Br\\), \\(vis\\)]\\)\"", HoldForm], 
       TraditionalForm], None}, {
      FormBox[
       TagBox["\"m [GeV]\"", HoldForm], TraditionalForm], None}},
   FrameStyle->Directive[
     GrayLevel[0], 22],
   FrameTicks->FrontEndValueCache[{{
       Charting`ScaledTicks[{Log, Exp}, {Log, Exp}, "Nice", WorkingPrecision -> 
        MachinePrecision, RotateLabel -> 0], 
       Charting`ScaledFrameTicks[{Log, Exp}]}, {
       Charting`ScaledTicks[{Log, Exp}, {Log, Exp}, "Nice", WorkingPrecision -> 
        MachinePrecision, RotateLabel -> 0], 
       Charting`ScaledFrameTicks[{Log, Exp}]}}, {{{{-4.605170185988091, 
         FormBox[
          TagBox[
           InterpretationBox[
            StyleBox["\"0.01\"", ShowStringCharacters -> False], 0.01, 
            AutoDelete -> True], NumberForm[#, {
             DirectedInfinity[1], 2}]& ], TraditionalForm], {0.01, 
         0.}}, {-2.995732273553991, 
         FormBox[
          TagBox[
           InterpretationBox[
            StyleBox["\"0.05\"", ShowStringCharacters -> False], 0.05, 
            AutoDelete -> True], NumberForm[#, {
             DirectedInfinity[1], 2}]& ], TraditionalForm], {0.01, 
         0.}}, {-2.3025850929940455`, 
         FormBox[
          TagBox[
           InterpretationBox[
            StyleBox["\"0.10\"", ShowStringCharacters -> False], 0.1, 
            AutoDelete -> True], NumberForm[#, {
             DirectedInfinity[1], 2}]& ], TraditionalForm], {0.01, 
         0.}}, {-0.6931471805599453, 
         FormBox[
          TagBox[
           InterpretationBox[
            StyleBox["\"0.50\"", ShowStringCharacters -> False], 0.5, 
            AutoDelete -> True], NumberForm[#, {
             DirectedInfinity[1], 2}]& ], TraditionalForm], {0.01, 0.}}, {0., 
         FormBox["1", TraditionalForm], {0.01, 0.}}, {-5.298317366548036, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-5.115995809754082, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-4.961845129926823, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-4.8283137373023015`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-4.710530701645918, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-3.912023005428146, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-3.506557897319982, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-3.2188758248682006`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-2.8134107167600364`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-2.659260036932778, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-2.5257286443082556`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-2.4079456086518722`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-1.6094379124341003`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-1.2039728043259361`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-0.916290731874155, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-0.5108256237659907, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-0.35667494393873245`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-0.2231435513142097, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-0.10536051565782628`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
        0.6931471805599453, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
        1.0986122886681098`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
        1.3862943611198906`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
        1.6094379124341003`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
        1.791759469228055, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
        1.9459101490553132`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
        2.0794415416798357`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
        2.1972245773362196`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
        2.302585092994046, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}}, {{-4.605170185988091, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.01, 
         0.}}, {-2.995732273553991, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.01, 
         0.}}, {-2.3025850929940455`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.01, 
         0.}}, {-0.6931471805599453, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.01, 0.}}, {0., 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.01, 
         0.}}, {-5.298317366548036, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-5.115995809754082, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-4.961845129926823, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-4.8283137373023015`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-4.710530701645918, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-3.912023005428146, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-3.506557897319982, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-3.2188758248682006`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-2.8134107167600364`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-2.659260036932778, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-2.5257286443082556`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-2.4079456086518722`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-1.6094379124341003`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-1.2039728043259361`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-0.916290731874155, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-0.5108256237659907, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-0.35667494393873245`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-0.2231435513142097, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-0.10536051565782628`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
        0.6931471805599453, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
        1.0986122886681098`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
        1.3862943611198906`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
        1.6094379124341003`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
        1.791759469228055, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
        1.9459101490553132`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
        2.0794415416798357`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
        2.1972245773362196`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
        2.302585092994046, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}}}, {{{-2.995732273553991, 
         FormBox[
          TagBox[
           InterpretationBox[
            StyleBox["\"0.05\"", ShowStringCharacters -> False], 0.05, 
            AutoDelete -> True], NumberForm[#, {
             DirectedInfinity[1], 2}]& ], TraditionalForm], {0.01, 
         0.}}, {-2.3025850929940455`, 
         FormBox[
          TagBox[
           InterpretationBox[
            StyleBox["\"0.10\"", ShowStringCharacters -> False], 0.1, 
            AutoDelete -> True], NumberForm[#, {
             DirectedInfinity[1], 2}]& ], TraditionalForm], {0.01, 
         0.}}, {-0.6931471805599453, 
         FormBox[
          TagBox[
           InterpretationBox[
            StyleBox["\"0.50\"", ShowStringCharacters -> False], 0.5, 
            AutoDelete -> True], NumberForm[#, {
             DirectedInfinity[1], 2}]& ], TraditionalForm], {0.01, 0.}}, {0., 
         FormBox["1", TraditionalForm], {0.01, 0.}}, {1.6094379124341003`, 
         FormBox["5", TraditionalForm], {0.01, 0.}}, {-4.605170185988091, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-3.912023005428146, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-3.506557897319982, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-3.2188758248682006`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-2.8134107167600364`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-2.659260036932778, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-2.5257286443082556`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-2.4079456086518722`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-1.6094379124341003`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-1.2039728043259361`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-0.916290731874155, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-0.5108256237659907, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-0.35667494393873245`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-0.2231435513142097, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-0.10536051565782628`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
        0.6931471805599453, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
        1.0986122886681098`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
        1.3862943611198906`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
        1.791759469228055, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
        1.9459101490553132`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
        2.0794415416798357`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
        2.1972245773362196`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
        2.302585092994046, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}}, {{-2.995732273553991, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.01, 
         0.}}, {-2.3025850929940455`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.01, 
         0.}}, {-0.6931471805599453, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.01, 0.}}, {0., 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.01, 0.}}, {
        1.6094379124341003`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.01, 
         0.}}, {-4.605170185988091, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-3.912023005428146, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-3.506557897319982, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-3.2188758248682006`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-2.8134107167600364`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-2.659260036932778, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-2.5257286443082556`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-2.4079456086518722`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-1.6094379124341003`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-1.2039728043259361`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-0.916290731874155, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-0.5108256237659907, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-0.35667494393873245`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-0.2231435513142097, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 
         0.}}, {-0.10536051565782628`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
        0.6931471805599453, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
        1.0986122886681098`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
        1.3862943611198906`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
        1.791759469228055, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
        1.9459101490553132`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
        2.0794415416798357`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
        2.1972245773362196`, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
        2.302585092994046, 
         FormBox[
          TemplateBox[{0, 0}, "Spacer2"], TraditionalForm], {0.005, 0.}}}}}],
   GridLines->FrontEndValueCache[{
      Charting`ScaledTickValues[{Log, Exp}], 
      Charting`ScaledTickValues[{Log, Exp}]}, {{{-2.995732273553991, 
        Directive[]}, {-2.3025850929940455`, 
        Directive[]}, {-0.6931471805599453, 
        Directive[]}, {0., 
        Directive[]}, {1.6094379124341003`, 
        Directive[]}}, {{-4.605170185988091, 
        Directive[]}, {-2.995732273553991, 
        Directive[]}, {-2.3025850929940455`, 
        Directive[]}, {-0.6931471805599453, 
        Directive[]}, {0., 
        Directive[]}}}],
   GridLinesStyle->Directive[
     GrayLevel[0.5, 0.4]],
   ImagePadding->All,
   ImageSize->Large,
   Method->{
    "DefaultBoundaryStyle" -> Automatic, 
     "DefaultGraphicsInteraction" -> {
      "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
       "Effects" -> {
        "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
         "Droplines" -> {
          "freeformCursorMode" -> True, 
           "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
     "DefaultMeshStyle" -> AbsolutePointSize[6], "ScalingFunctions" -> None},
   PlotLabel->FormBox[
     StyleBox[
      TemplateBox[{"\"For \"", "\"HIKE-dump\""}, "RowDefault"], 20, 
      GrayLevel[0], StripOnInput -> False], TraditionalForm],
   PlotRange->{{-3.912023005428146, 1.62924053973028}, {-4.605170185988091, 
    0.1823215567939546}},
   PlotRangeClipping->True,
   PlotRangePadding->{{0, 0}, {0, 0}},
   Ticks->{
     Charting`ScaledTicks[{Log, Exp}, {Log, Exp}, "Nice", WorkingPrecision -> 
      MachinePrecision, RotateLabel -> 0], 
     Charting`ScaledTicks[{Log, Exp}, {Log, Exp}, "Nice", WorkingPrecision -> 
      MachinePrecision, RotateLabel -> 0]}], TraditionalForm]], "Output",
 CellChangeTimes->{3.9049017243911295`*^9},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->"Out[39]=",ExpressionUUID->"4318911e-50a0-4bf6-a329-867e47960d17"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"1.7552116`", ",", "Null"}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.9049017281069665`*^9},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->"Out[43]=",ExpressionUUID->"39b63992-3c2f-4e7c-beec-1edee674fc4b"],

Cell[BoxData[
 FormBox[
  RowBox[{
   InterpretationBox[
    RowBox[{
     TagBox["InterpolatingFunction",
      "SummaryHead"], "[", 
     DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
      "Ready"}, 
      TemplateBox[{
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]],
                 ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GraphicsBox[{{
                 GrayLevel[0.6], 
                 AbsolutePointSize[5], 
                 PointBox[{1, 1}], 
                 PointBox[{2, 4}], 
                 PointBox[{3, 2}], 
                 PointBox[{4, 3}]}, {{}, {}, {
                  AbsoluteThickness[1], 
                  Opacity[1.], 
                  LineBox[CompressedData["
1:eJwBMQPO/CFib1JlAgAAADIAAAACAAAA4ScLwZmZ6T/ACPskWpOYv4AjHgZ5
3Os/cnpQh5xu1j/qWn1XCVDuP5K7ih5ptuc/r+pongFN8D/CUK87BHLxP46d
cUQ/bPE/ujUa8/qu9j9TbqBw1aPyP/TWyyAhFfw/neDJZqDG8z+QAqdF9GsA
QM1wGePDAfU/VsVD/9nXAkCidscSKDf2P6Bp73exDQVA/B1wDMFX9z+TpM3k
wfUGQDzjPoyykPg/7M3Z+O7ZCEABSgjW2LT5P3pl9LwNcgpAbCYw0z/T+j86
ypori9cLQL0gflb/Cfw/lpOs9xIqDUCTvMaj8yv9Pw4alcoYNg5AT3Y1d0Bm
/j+pB2LLtyIPQLClAv7Nmv8/NnA5bbjSD0BLO2UnSF0AQFrcILXmpw9AsTLc
klX5AED+sDHBQukOQNp6UGP9igFAbZ+lR/sLDkD10dd20SgCQNHi3Mj38wxA
42MO5MXDAkAZdr6AZb8LQJRGQrZUVANArv7zEMKHCkA4OInLD/EDQLBlMO3M
IglAnnrNRWWDBEA3d8OX6skHQNf3wBnbEgVAD3D3ndNyBkADhMcwfa4FQHOK
7Wak/wRA8WDLrLk/BkC/MhCgYawDQNJM4msi3QZAwss/TmVLAkCGc6iEq3cH
QIsIg92+BgFA/OprAs8HCECrPCvgePD/P2VxQsMepAhAKXVLE0Xg/j+RSBbp
CDYJQPRz0a7WJ/4/kFqZaBPFCUDN4sX5uLj9P4J7LytKYApAvh1MbRmT/T82
7cJSG/EKQHzT1YZwwv0/3W1pvRiOC0B2LZ/10lT+P0c/DY2wIAxAVrX8MJA7
/z+DS2C2aLAMQElWzbMzPQBAsmbGIk1MDUCi9bAadCABQKTSKfTL3Q1AYexd
q+EpAkCJTaAId3sOQFyS/ndEhgNAQAPGdkIWD0BHWcLdahwFQLoJ6Umopg9A
vd1CiejSBkCTjw8wnSEQQPiVkXD08QhAq0KpbbNqEEBsk2Azxi4LQCyTGthZ
shBAYCBYjj+gDUAnaxVkFgARQMwfdA9ySBBAg+uOIqBIEUBj/5rHgMsRQNFn
q5SZmRFAL++xNeOlE0Dwt3AR
                   "]]}}}, AspectRatio -> 1, Axes -> False, Background -> 
               GrayLevel[0.93], Frame -> True, FrameStyle -> Directive[
                 GrayLevel[0.7], 
                 Thickness[Tiny]], FrameTicks -> None, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}], PlotRange -> {{0, 5}, {0, 5}}], 
              GridBox[{{
                 RowBox[{
                   TagBox["\"Domain: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"(", "\[NoBreak]", 
                    
                    GridBox[{{"0.00001`", "0.012656107356285137`"}, {
                    "78.93`", "183.93`"}}, RowSpacings -> 1, ColumnSpacings -> 
                    1, RowAlignments -> Baseline, ColumnAlignments -> Center],
                     "\[NoBreak]", ")"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Output: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["\"scalar\"", "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]],
                 ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GraphicsBox[{{
                 GrayLevel[0.6], 
                 AbsolutePointSize[5], 
                 PointBox[{1, 1}], 
                 PointBox[{2, 4}], 
                 PointBox[{3, 2}], 
                 PointBox[{4, 3}]}, {{}, {}, {
                  AbsoluteThickness[1], 
                  Opacity[1.], 
                  LineBox[CompressedData["
1:eJwBMQPO/CFib1JlAgAAADIAAAACAAAA4ScLwZmZ6T/ACPskWpOYv4AjHgZ5
3Os/cnpQh5xu1j/qWn1XCVDuP5K7ih5ptuc/r+pongFN8D/CUK87BHLxP46d
cUQ/bPE/ujUa8/qu9j9TbqBw1aPyP/TWyyAhFfw/neDJZqDG8z+QAqdF9GsA
QM1wGePDAfU/VsVD/9nXAkCidscSKDf2P6Bp73exDQVA/B1wDMFX9z+TpM3k
wfUGQDzjPoyykPg/7M3Z+O7ZCEABSgjW2LT5P3pl9LwNcgpAbCYw0z/T+j86
ypori9cLQL0gflb/Cfw/lpOs9xIqDUCTvMaj8yv9Pw4alcoYNg5AT3Y1d0Bm
/j+pB2LLtyIPQLClAv7Nmv8/NnA5bbjSD0BLO2UnSF0AQFrcILXmpw9AsTLc
klX5AED+sDHBQukOQNp6UGP9igFAbZ+lR/sLDkD10dd20SgCQNHi3Mj38wxA
42MO5MXDAkAZdr6AZb8LQJRGQrZUVANArv7zEMKHCkA4OInLD/EDQLBlMO3M
IglAnnrNRWWDBEA3d8OX6skHQNf3wBnbEgVAD3D3ndNyBkADhMcwfa4FQHOK
7Wak/wRA8WDLrLk/BkC/MhCgYawDQNJM4msi3QZAwss/TmVLAkCGc6iEq3cH
QIsIg92+BgFA/OprAs8HCECrPCvgePD/P2VxQsMepAhAKXVLE0Xg/j+RSBbp
CDYJQPRz0a7WJ/4/kFqZaBPFCUDN4sX5uLj9P4J7LytKYApAvh1MbRmT/T82
7cJSG/EKQHzT1YZwwv0/3W1pvRiOC0B2LZ/10lT+P0c/DY2wIAxAVrX8MJA7
/z+DS2C2aLAMQElWzbMzPQBAsmbGIk1MDUCi9bAadCABQKTSKfTL3Q1AYexd
q+EpAkCJTaAId3sOQFyS/ndEhgNAQAPGdkIWD0BHWcLdahwFQLoJ6Umopg9A
vd1CiejSBkCTjw8wnSEQQPiVkXD08QhAq0KpbbNqEEBsk2Azxi4LQCyTGthZ
shBAYCBYjj+gDUAnaxVkFgARQMwfdA9ySBBAg+uOIqBIEUBj/5rHgMsRQNFn
q5SZmRFAL++xNeOlE0Dwt3AR
                   "]]}}}, AspectRatio -> 1, Axes -> False, Background -> 
               GrayLevel[0.93], Frame -> True, FrameStyle -> Directive[
                 GrayLevel[0.7], 
                 Thickness[Tiny]], FrameTicks -> None, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}], PlotRange -> {{0, 5}, {0, 5}}], 
              GridBox[{{
                 RowBox[{
                   TagBox["\"Domain: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"(", "\[NoBreak]", 
                    
                    GridBox[{{"0.00001`", "0.012656107356285137`"}, {
                    "78.93`", "183.93`"}}, RowSpacings -> 1, ColumnSpacings -> 
                    1, RowAlignments -> Baseline, ColumnAlignments -> Center],
                     "\[NoBreak]", ")"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Output: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["\"scalar\"", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Order: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Method: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["\"Hermite\"", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Periodic: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["False", "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic]},
       "SummaryPanel"],
      DynamicModuleValues:>{}], "]"}],
    InterpolatingFunction[{{0.00001, 0.012656107356285137`}, {78.93, 
     183.93}}, {
     5, 7, 0, {26, 46}, {2, 2}, 0, 0, 0, 0, Automatic, {}, {}, False}, {{
      0.00001, 0.00029894825990820173`, 0.0005878965198164034, 
      0.0008768447797246051, 0.0011657930396328068`, 0.0014547412995410086`, 
      0.0017436895594492101`, 0.002032637819357412, 0.0023215860792656137`, 
      0.002610534339173815, 0.002899482599082017, 0.0031884308589902187`, 
      0.0034773791188984202`, 0.0037663273788066222`, 0.004055275638714824, 
      0.004344223898623025, 0.004633172158531227, 0.004873887444725052, 
      0.005846664933670063, 0.006819442422615073, 0.007792219911560084, 
      0.008764997400505094, 0.009737774889450105, 0.010710552378395116`, 
      0.011683329867340126`, 0.012656107356285137`}, CompressedData["
1:eJxTTMoPSmVkYGDQA+I3gTvkWncHOzgu5y25FRDiMP1P0kn9ZyEOYPHqUIi4
QBhEfFkYRNw63MEJJH4hHCKeFgER/x0BEZ8QCRFXi4KI746CiAdEQ82Phpof
AxEXiIWaHws1Pw5qfhzU/Hio+fEOCy+zWeV6JDj41G18Ij45weGbRkz/obsJ
EHGNRIh4cSJEfG8iRJwjCSIenAQRn5sEEX8BFTdOhojXJkPETyRDxIVTIOKx
KRDxFSkQ8c9QcdtUiHhHKkT8cipEXDYNIp6RBhHfnAYR/5vmAADuhqqI
      "]}, {Developer`PackedArrayForm, CompressedData["
1:eJwd11MMGIgSAMDatm3btm3btm3btm3btm3e1by+6dtkks3+rxI2al+pXcAA
AQKsDRLg//E3D0Rg/paCEozghCAkoQhNGMISjvBEICKRiEwUohKN6MQgJrGI
TRziEo/4JCAhiUhMEpKSjOSkICWpSE0a0pKO9GQgI5nITBayko3s5CAnuchN
HvKSj/wUoCCFKEwRilKM4pSgJKUoTRnKUo7yVKAilahMFapSjerUoCa1qE0d
6lKP+jSgIY1oTBOa0ozmtKAlrWhNG9rSjvZ0oCOd6EwXutKN7vSgJ73oTR/6
0o/+DGAggxjMEIYyjOGMYCSjGM0YxjKO8UxgIpOYzBSmMo3pzGAms5jNHOYy
j/ksYCGLWMwSlrKM5axgJatYzRrWso71bGAjm9jMFrayje3sYCe72M0e9rKP
/RzgIIc4zBGOcozjnOAkpzjNGc5yjvNc4CKXuMwVrnKN69zgJre4zR3uco/7
POAhj3jME57yjOe84CWveM0b3vKO9/zDv3zgI5/4zBe+8o3v/OAnv/jNf/zh
b/MHJBCBCUJQghGcEIQkFKEJQ1jCEZ4IRCQSkYlCVKIRnRjEJBaxiUNc4hGf
BCQkEYlJQlKSkZwUpCQVqUlDWtKRngxkJBOZyUJWspGdHOQkF7nJQ17ykZ8C
FKQQhSlCUYpRnBKUpBSlKUNZylGeClSkEpWpQlWqUZ0a1KQWtalDXepRnwY0
pBGNaUJTmtGcFrSkFa1pQ1v+DvD2dKAjnehMF7rSje70oCe96E0f+tKP/gxg
IIMYzBCGMozhjGAkoxjNGMYyjvFMYCKTmMwUpjKN6cxgJrOYzRzmMo/5LGAh
i1jMEpayjOWsYCWrWM0a1rKO9WxgI5vYzBa2so3t7GAnu9jNHvayj/0c4CCH
OMwRjnKM45zgJKc4zRnOco7zXOAil7jMFa5yjevc4Ca3uM0d7nKP+zzgIY94
zBOe8oznvOAlr3jNG97yjvf8w7984COf+MwXvvKN7/zgJ7/4zX/84e/iD0gg
AhOEoAQjOCEISShCE4awhCM8EYhIJCIThahEIzoxiEksYhOHuMQjPglISCIS
k4SkJCM5KUhJKlKThrSkIz0ZyEgmMpOFrGQjOznISS5yk4e85CM/BShIIQpT
hKIUozglKEkpSlOGspSjPBWoSCUqU4WqVKM6NahJLWpTh7rUoz4NaEgjGtOE
pjSjOS1oSSta04a2tKM9HehIJzrTha50ozs96EkvetOHvvSjPwMYyCAGM4Sh
DGM4IxjJKEYzhrGMYzwTmMgkJjOFqUxjOjOYySxmM4e5zGM+C1jIIhazhKUs
YzkrWMkqVrOGtaxjPRvYyCY2s4WtbGM7O9jJLnazh73sYz8HOMghDnOEoxzj
OCc4ySlOc4aznOM8F7jIJS5zhatc4zo3uMktbnOHu9zjPg94yCMe84SnPOM5
L3jJK17zhre84z3/8C8f+MgnPvOFr3zjOz/4yS9+8x9/+Hv0ByQQgQlCUIIR
nBCEJBShCUNYwhGeCEQkEpGJQlSiEZ0YxCQWsYlDXOIRnwQkJBGJSUJSkpGc
FKQkFalJQ1rSkZ4MZCQTmclCVrKRnRzkJBe5yUNe8pGfAhSkEIUpQlGKUZwS
lKQUpSlDWcpRngpUpBKVqUJVqlGdGtSkFrWpQ13qUZ8GNKQRjWlCU5rRnBa0
pBWtaUNb2tGeDnSkE53pQle60Z0e9KQXvelDX/rRnwEMZBCDGcJQhjGcEYxk
FKMZw1jGMZ4JTGQSk5nCVKYxnRnMZBazmcNc5jGfBSxkEYtZwlKWsZwVrGQV
q1nDWtaxng1sZBOb2cJWtrGdHexkF7vZw172sZ8DHOQQhznCUY5xnBOc5BSn
OcNZznGeC1zkEpe5wlWucZ0b3OQWt7nDXe5xnwc85BGPecJTnvGcF7zkFa95
w1ve8Z5/+JcPfOQTn/nCV77xnR/85Be/+Y8//H34AxKIwAQhKMEITghCEorQ
hCEs4QhPBCISichEISrRiE4MYhKL2MQhLvGITwISkojEJCEpyUhOClKSitSk
IS3pSE8GMpKJzGQhK9nITg5ykovc5CEv+chPAQpSiMIUoSjFKE4JSlKK0pSh
LOUoTwUqUonKVKEq1ahODWpSi9rUoS71qE8DGtKIxjShKc1oTgta0orWtKEt
7WhPBzrSic50oSvd6E4PetKL3vShL/3ozwAGMojBDGEowxjOCEYyitGMYSzj
GM8EJjKJyUxhKtOYzgxmMovZzGEu85jPAhayiMUsYSnLWM4KVrKK1azhf+W+
Q1U=
      "], CompressedData["
1:eJzt0MENQFAQRdGRaEQlelCCxFpjilOCjQaEvE+cuznbmTfM67R0VbX1dbaP
JEmSJEmSJEmS5H+8Wut7377P07X+/2t73c1+2eyYzZ7Z7JnNvqkO+dxweQ==

      "]}, {Automatic, Automatic}],
    Editable->False,
    SelectWithContents->True,
    Selectable->False], "\[InvisibleApplication]", 
   RowBox[{"(", 
    RowBox[{"\[Theta]a", ",", "za"}], ")"}]}], TraditionalForm]], "Output",
 CellChangeTimes->{3.904901728201129*^9},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->"Out[48]=",ExpressionUUID->"1786d190-a1d3-4ba0-90c7-665490e37a84"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"1.7989018`", ",", "Null"}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.9049017300051136`*^9},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->"Out[50]=",ExpressionUUID->"1b233804-860d-49a6-b610-1dbe851d3e47"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"1.2140063`", ",", "Null"}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.904901731212778*^9},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->"Out[52]=",ExpressionUUID->"da4c0e1c-6574-4e8e-81ca-a961626607af"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"1.2386418`", ",", "Null"}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.904901732460664*^9},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->"Out[53]=",ExpressionUUID->"19e10533-4d53-4736-a81b-7ee37b92d37b"],

Cell[BoxData[
 FormBox[
  TemplateBox[{
   "\"Search for ALPs coupled to photons at \"", "\"HIKE-dump\"", 
    "\" located at \"", "\"SPS\"", 
    "\". \\!\\(\\*SubscriptBox[\\(N\\), \\(collisions\\)]\\) = \"", "5.`*^19"},
   "RowDefault"], TraditionalForm]], "Output",
 CellChangeTimes->{3.9049017324676695`*^9},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->"Out[58]=",ExpressionUUID->"86c9bc1b-0816-4070-84fd-0e716749fec3"],

Cell[BoxData[
 FormBox[
  TagBox[GridBox[{
     {"\<\"Quantity\"\>", "\<\"\\!\\(\\*SubscriptBox[\\(\[Theta]\\), \
\\(min\\)]\\), rad\"\>", "\<\"\\!\\(\\*SubscriptBox[\\(\[Theta]\\), \
\\(max\\)]\\), rad\"\>", "\<\"\\!\\(\\*SubscriptBox[\\(\[Theta]\\), \
\\(min\\)]\\)(\\!\\(\\*SubscriptBox[\\(\[Epsilon]\\), \\(dec\\)]\\)), \
rad\"\>", "\<\"\\!\\(\\*SubscriptBox[\\(\[Theta]\\), \
\\(max\\)]\\)(\\!\\(\\*SubscriptBox[\\(\[Epsilon]\\), \\(dec\\)]\\)), \
rad\"\>", "\<\"\\!\\(\\*SubscriptBox[\\(z\\), \\(min\\)]\\), m\"\>", "\<\"\\!\
\\(\\*SubscriptBox[\\(z\\), \\(max\\)]\\), m\"\>"},
     {"\<\"Description\"\>", "\<\"Min angle covered by experiment\"\>", \
"\<\"Max angle covered by experiment\"\>", "\<\"Min angle where \
\\!\\(\\*SubscriptBox[\\(\[Epsilon]\\), \\(decay\\)]\\)\[NotEqual]0\"\>", "\<\
\"Max angle where \\!\\(\\*SubscriptBox[\\(\[Epsilon]\\), \\(decay\\)]\\)\
\[NotEqual]0\"\>", "\<\"Min long. displacement of the decay volume\"\>", \
"\<\"Max long. displacement of the decay volume\"\>"},
     {"\<\"Value\"\>", "0.00001`", "0.012656107356285137`", "0.00001`", 
      "0.012656107356285137`", "78.93`", "183.93`"}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[2.0999999999999996`]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Function[BoxForm`e$, 
    TableForm[BoxForm`e$]]], TraditionalForm]], "Output",
 CellChangeTimes->{3.9049017324676695`*^9},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "Out[59]//TableForm=",ExpressionUUID->"4644ba57-0615-4b04-9881-\
abb1d20ad659"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Angle-energy distributions for the given experiment", "Chapter",
 CellChangeTimes->{{3.885020702966837*^9, 3.885020711525731*^9}, {
  3.8850216924759345`*^9, 3.8850216984444695`*^9}, {3.8851404110391607`*^9, 
  3.8851404117847*^9}, {3.8876176661660123`*^9, 3.887617675014727*^9}, {
  3.8963348182882037`*^9, 3.896334822097164*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"775c9f90-cfc2-4104-a914-\
805ee6203cb5"],

Cell[CellGroupData[{

Cell["ALP distributions", "Section",
 CellChangeTimes->{{3.8850207275443482`*^9, 3.885020730624566*^9}, 
   3.8850217020674453`*^9, {3.8851404135605536`*^9, 3.8851404142703238`*^9}, 
   3.8857495158161235`*^9},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"156da2f8-c95e-4643-9f69-\
1214d81706da"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Fixing", " ", "the", " ", "target", " ", "for", " ", "Primakov", " ", 
     "and", " ", "p"}], "-", 
    RowBox[{"target", " ", "production", " ", "channels"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"DistrDirectory", "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<spectra/New physics particles spectra/ALPs with photon \
coupling\>\""}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AvailableDistrPrimakovList", "=", 
     RowBox[{"FileNames", "[", 
      RowBox[{
       RowBox[{"ToString", "@", 
        RowBox[{"StringForm", "[", 
         RowBox[{"\"\<DoubleDistr-ALPs-from-Primakov-``-*\>\"", ",", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"{", "FacilityGivenExperiment", "}"}]}]}], "]"}]}], ",", 
       "DistrDirectory"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AvailableDistrpCoherentList", "=", 
     RowBox[{"FileNames", "[", 
      RowBox[{
       RowBox[{"ToString", "@", 
        RowBox[{"StringForm", "[", 
         RowBox[{"\"\<DoubleDistr-ALPs-from-pCoherent-``-*\>\"", ",", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"{", "FacilityGivenExperiment", "}"}]}]}], "]"}]}], ",", 
       "DistrDirectory"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TargetPrimakovDistr", "[", "i_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"StringCases", "[", 
       RowBox[{
        RowBox[{"Last", "@", 
         RowBox[{"FileNameSplit", "@", 
          RowBox[{"AvailableDistrPrimakovList", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"ToString", "@", 
           RowBox[{"StringForm", "[", 
            RowBox[{"\"\<DoubleDistr-ALPs-from-Primakov-``-target-\>\"", ",", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"{", "FacilityGivenExperiment", "}"}]}]}], "]"}]}], "~~",
           "target__", "~~", "\"\<.dat\>\""}], ":>", 
         RowBox[{"{", "target", "}"}]}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AvailableTargetsPrimakov", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"FacilityGivenExperiment", "==", "\"\<SPS\>\""}], "||", 
        RowBox[{"FacilityGivenExperiment", "==", "\"\<FermilabBD\>\""}], "||", 
        RowBox[{"SelectedExperiment", "==", "\"\<FASER\>\""}], "||", 
        RowBox[{"SelectedExperiment", "==", "\"\<FASER2\>\""}]}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"TargetPrimakovDistr", "[", "i", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "AvailableDistrPrimakovList", "]"}], ",", 
           "1"}], "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TargetpCoherentDistr", "[", "i_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"StringCases", "[", 
       RowBox[{
        RowBox[{"Last", "@", 
         RowBox[{"FileNameSplit", "@", 
          RowBox[{"AvailableDistrpCoherentList", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"ToString", "@", 
           RowBox[{"StringForm", "[", 
            RowBox[{"\"\<DoubleDistr-ALPs-from-pCoherent-``-target-\>\"", ",", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"{", "FacilityGivenExperiment", "}"}]}]}], "]"}]}], "~~",
           "target__", "~~", "\"\<.dat\>\""}], ":>", 
         RowBox[{"{", "target", "}"}]}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AvailableTargetspCoherent", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"TargetpCoherentDistr", "[", "i", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "AvailableDistrpCoherentList", "]"}], ",", 
         "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
   "Print", "[", 
    "\"\<Selected target for the coherent Primakov production (works for \
experiments @ SPS, FermilabBD, and for FASER/FASER2:\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"TargetSelectedPrimakov", "=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"FacilityGivenExperiment", "==", "\"\<SPS\>\""}], "||", 
        RowBox[{"FacilityGivenExperiment", "==", "\"\<FermilabBD\>\""}]}], 
       ")"}], ",", 
      RowBox[{"ChoiceDialog", "[", 
       RowBox[{
       "\"\<Choose the target corresponding to the experiment (Primakov \
production):\>\"", ",", "AvailableTargetsPrimakov", ",", 
        RowBox[{"Appearance", "\[Rule]", 
         RowBox[{"\"\<Vertical\>\"", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Automatic", ",", "3"}], "}"}]}]}]}], "]"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"SelectedExperiment", "==", "\"\<FASER\>\""}], "||", 
         RowBox[{"SelectedExperiment", "==", "\"\<FASER2\>\""}]}], ",", 
        RowBox[{"AvailableTargetsPrimakov", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "Print", "[", 
    "\"\<Selected target for the coherent p-target production:\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"TargetSelectedpCoherent", "=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"FacilityGivenExperiment", "==", "\"\<SPS\>\""}], "||", 
       RowBox[{"FacilityGivenExperiment", "==", "\"\<FermilabBD\>\""}]}], ",",
       "TargetSelectedPrimakov", ",", "\"\<p\>\""}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ALPDistributionFileNamesGivenExp", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ToString", "@", 
          RowBox[{"StringForm", "[", 
           RowBox[{
           "\"\<DoubleDistr-ALPs-from-pCoherent-``-target-``.dat\>\"", ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"{", 
              RowBox[{
              "FacilityGivenExperiment", ",", "TargetSelectedpCoherent"}], 
              "}"}]}]}], "]"}]}], ",", 
         RowBox[{"ToString", "@", 
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<DoubleDistr-ALPs-From-pi0-``.dat\>\"", ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"{", "FacilityGivenExperiment", "}"}]}]}], "]"}]}], ",", 
         RowBox[{"ToString", "@", 
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<DoubleDistr-ALPs-From-Eta-``.dat\>\"", ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"{", "FacilityGivenExperiment", "}"}]}]}], "]"}]}]}], 
        "}"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"FacilityGivenExperiment", "==", "\"\<SPS\>\""}], "||", 
          RowBox[{"FacilityGivenExperiment", "==", "\"\<FermilabBD\>\""}], "||", 
          RowBox[{"SelectedExperiment", "==", "\"\<FASER\>\""}], "||", 
          RowBox[{"SelectedExperiment", "==", "\"\<FASER2\>\""}]}], ",", 
         RowBox[{"{", 
          RowBox[{"ToString", "@", 
           RowBox[{"StringForm", "[", 
            RowBox[{
            "\"\<DoubleDistr-ALPs-from-Primakov-``-target-``.dat\>\"", ",", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"{", 
               RowBox[{
               "FacilityGivenExperiment", ",", "TargetSelectedPrimakov"}], 
               "}"}]}]}], "]"}]}], "}"}], ",", 
         RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"TrueQ", "@", 
         RowBox[{"FileExistsQ", "@", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"NotebookDirectory", "[", "]"}], ",", 
             "\"\<spectra/New physics particles spectra/ALPs with photon \
coupling/\>\"", ",", 
             RowBox[{"ALPDistributionFileNamesGivenExp", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], "}"}], "]"}]}]}]}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
         RowBox[{"ALPDistributionFileNamesGivenExp", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ",", 
         "\"\< does not exist. Generate it using module 2!\>\""}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", "ALPDistributionFileNamesGivenExp", "]"}], ",", 
       "1"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", "\"\<Production channels list:\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"ProductionList", "=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\"\<pCoherent\>\"", ",", 
        "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", 
        "\"\<\[Eta]\>\""}], "}"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"FacilityGivenExperiment", "==", "\"\<SPS\>\""}], "||", 
         RowBox[{"FacilityGivenExperiment", "==", "\"\<FermilabBD\>\""}], "||", 
         RowBox[{"SelectedExperiment", "==", "\"\<FASER\>\""}], "||", 
         RowBox[{"SelectedExperiment", "==", "\"\<FASER2\>\""}]}], ",", 
        RowBox[{"{", "\"\<Primakov\>\"", "}"}], ",", 
        RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"ListExport", ":=", 
    RowBox[{"Association", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<pCoherent\>\"", "->", " ", "\"\<pCoherent\>\""}], ",", 
       RowBox[{
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", "->", 
        "\"\<Pi0\>\""}], ",", 
       RowBox[{"\"\<\[Eta]\>\"", "->", "\"\<Eta\>\""}], ",", 
       RowBox[{"\"\<Primakov\>\"", "->", "\"\<Primakov\>\""}]}], "}"}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"Clear", "[", "j", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8922705934675827`*^9, 3.8922706283202367`*^9}, {
  3.8922707046475224`*^9, 3.892270936702023*^9}, {3.892270992027457*^9, 
  3.8922711139516745`*^9}, {3.892272173380522*^9, 3.8922722645852523`*^9}, {
  3.8922722953125954`*^9, 3.892272345156851*^9}, {3.892272408866657*^9, 
  3.8922724289032984`*^9}, {3.892272472218454*^9, 3.8922726639525523`*^9}, {
  3.89227285161895*^9, 3.8922729266318493`*^9}, {3.892273177602598*^9, 
  3.8922731927907076`*^9}, {3.8922736638013353`*^9, 3.892273687503907*^9}, {
  3.8922738160738883`*^9, 3.8922740321682177`*^9}, {3.8922745359706707`*^9, 
  3.8922745361548357`*^9}, {3.8922745873462715`*^9, 3.8922746458581915`*^9}, {
  3.8922754659041924`*^9, 3.892275562803099*^9}, {3.892283907770499*^9, 
  3.8922839080141106`*^9}, {3.893520950957961*^9, 3.893520950969908*^9}, {
  3.8951279299045463`*^9, 3.8951279727877235`*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[1940]:=",ExpressionUUID->"efe9c5f7-ba18-4bd7-a49c-55163fccb032"],

Cell[CellGroupData[{

Cell["Importing distributions and production probabilities", "Subsection",
 CellChangeTimes->{{3.885021707174692*^9, 3.8850217096287813`*^9}, {
  3.8922674149847784`*^9, 3.892267420808915*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"e5eaebc3-b32f-410a-bd0f-\
d31d7689e52c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dataDistr", "[", "filename_", "]"}], ":=", 
  RowBox[{"Import", "[", 
   RowBox[{
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", 
       "\"\<spectra/New physics particles spectra/ALPs with photon \
coupling/\>\"", ",", "filename"}], "}"}], "]"}], ",", "\"\<Table\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"DataDistrALPphoton", "[", 
      RowBox[{"ProductionList", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"dataDistr", "[", 
       RowBox[{"ALPDistributionFileNamesGivenExp", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}], "//", "N"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DoubleDistrALPphoton", "[", 
      RowBox[{"ma_", ",", "\[Theta]a_", ",", "Ea_", ",", 
       RowBox[{"ProductionList", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "=", 
     RowBox[{"10", "^", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Log10", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
              RowBox[{"Log10", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
              RowBox[{"Log10", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
              RowBox[{"Log10", "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "4", "]"}], "]"}], "+", 
                SuperscriptBox["10", 
                 RowBox[{"-", "90"}]]}], "]"}]}], "}"}], "&"}], "/@", 
           RowBox[{"DataDistrALPphoton", "[", 
            RowBox[{"ProductionList", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
          RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
        RowBox[{
         RowBox[{"Log10", "[", "ma", "]"}], ",", 
         RowBox[{"Log10", "[", "\[Theta]a", "]"}], ",", 
         RowBox[{"Log10", "[", "Ea", "]"}]}], "]"}], ")"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mlistALPphoton", "[", 
      RowBox[{"ProductionList", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], "=", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{
       RowBox[{"DataDistrALPphoton", "[", 
        RowBox[{"ProductionList", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"mamin", "[", 
        RowBox[{"ProductionList", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
       RowBox[{"mamax", "[", 
        RowBox[{"ProductionList", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}], "=", 
     RowBox[{"MinMax", "[", 
      RowBox[{"mlistALPphoton", "[", 
       RowBox[{"ProductionList", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "ProductionList", "]"}], ",", "1"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Chi]Xtimes\[Chi]XtoALPphoton", "[", 
    RowBox[{"ma_", ",", "ga_", ",", "\"\<Primakov\>\""}], "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"FacilityGivenExperiment", "==", "\"\<SPS\>\""}], "||", 
      RowBox[{"FacilityGivenExperiment", "==", "\"\<FermilabBD\>\""}], "||", 
      RowBox[{"SelectedExperiment", "==", "\"\<FASER\>\""}], "||", 
      RowBox[{"SelectedExperiment", "==", "\"\<FASER2\>\""}]}], ",", 
     RowBox[{
      SuperscriptBox["ga", "2"], "*", 
      RowBox[{"10", "^", 
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Log10", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
              RowBox[{"Log10", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
           RowBox[{"Import", "[", 
            RowBox[{
             RowBox[{"FileNameJoin", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"NotebookDirectory", "[", "]"}], ",", 
                "\"\<phenomenology/ALPs with photon coupling/branching \
ratios/\>\"", ",", 
                RowBox[{"ToString", "@", 
                 RowBox[{"StringForm", "[", 
                  RowBox[{
                  "\"\<Pprod-ALPs-from-Primakov-``-target-``.dat\>\"", ",", 
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"{", 
                    RowBox[{
                    "FacilityGivenExperiment", ",", 
                    "TargetSelectedPrimakov"}], "}"}]}]}], "]"}]}]}], "}"}], 
              "]"}], ",", "\"\<Table\>\""}], "]"}]}], ",", 
          RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
        RowBox[{"Log10", "[", "ma", "]"}], "]"}]}]}], ",", "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Chi]Xtimes\[Chi]XtoALPphoton", "[", 
    RowBox[{"ma_", ",", "ga_", ",", "\"\<pCoherent\>\""}], "]"}], "=", 
   RowBox[{
    SuperscriptBox["ga", "2"], "*", 
    RowBox[{"10", "^", 
     RowBox[{
      RowBox[{"Interpolation", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Log10", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
            RowBox[{"Log10", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
         RowBox[{"Import", "[", 
          RowBox[{
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"NotebookDirectory", "[", "]"}], ",", 
              "\"\<phenomenology/ALPs with photon coupling/branching \
ratios/\>\"", ",", 
              RowBox[{"ToString", "@", 
               RowBox[{"StringForm", "[", 
                RowBox[{
                "\"\<Pprod-ALPs-from-pCoherent-``-target-``.dat\>\"", ",", 
                 RowBox[{"Sequence", "@@", 
                  RowBox[{"{", 
                   RowBox[{
                   "FacilityGivenExperiment", ",", 
                    "TargetSelectedpCoherent"}], "}"}]}]}], "]"}]}]}], "}"}], 
            "]"}], ",", "\"\<Table\>\""}], "]"}]}], ",", 
        RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
      RowBox[{"Log10", "[", "ma", "]"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Chi]Xtimes\[Chi]XtoALPphoton", "[", 
    RowBox[{
    "ma_", ",", "ga_", ",", 
     "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\""}], "]"}], "=", 
   RowBox[{
    SuperscriptBox["ga", "2"], "*", 
    RowBox[{
    "\[Chi]prod", "[", "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", 
     "]"}], "*", 
    RowBox[{"Br\[Pi]0ToALP", "[", "ma", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Chi]Xtimes\[Chi]XtoALPphoton", "[", 
    RowBox[{"ma_", ",", "ga_", ",", "\"\<\[Eta]\>\""}], "]"}], "=", 
   RowBox[{
    SuperscriptBox["ga", "2"], "*", 
    RowBox[{"\[Chi]prod", "[", "\"\<\[Eta]\>\"", "]"}], "*", 
    RowBox[{"Br\[Eta]ToALP", "[", "ma", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogLogPlot", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ma", "<", 
         RowBox[{"Max", "[", 
          RowBox[{"mlistALPphoton", "[", 
           RowBox[{"ProductionList", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], ",", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"\[Chi]Xtimes\[Chi]XtoALPphoton", "[", 
          RowBox[{"ma", ",", "1", ",", 
           RowBox[{"ProductionList", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}], ",", "0"}], "]"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "ProductionList", "]"}], ",", "1"}], "}"}]}], 
     "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"ma", ",", "0.02", ",", "1.5"}], "}"}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"All", ",", 
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["10", 
         RowBox[{"-", "6"}]], ",", "10"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"Placed", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"#", ",", "15"}], "]"}], "&"}], "/@", "ProductionList"}], 
      ",", "Right"}], "]"}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<Auxiliary data/ALPs with photon coupling\>\"", ",", 
      "SelectedExperiment", ",", 
      "\"\<Double-Distr-Averaged-ALP-photon.m\>\""}], "}"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"mamin", "[", "prod", "]"}], "<", "ma", "<", 
          RowBox[{"mamax", "[", "prod", "]"}]}], ",", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"\[Chi]Xtimes\[Chi]XtoALPphoton", "[", 
           RowBox[{"ma", ",", "1", ",", "prod"}], "]"}], "]"}], ",", "0"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ",", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"mamin", "[", "prod", "]"}], "<", "ma", "<", 
            RowBox[{"mamax", "[", "prod", "]"}]}], ",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"\[Chi]Xtimes\[Chi]XtoALPphoton", "[", 
             RowBox[{"ma", ",", "1", ",", "prod"}], "]"}], "]"}], ",", "0"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}]], 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"mamin", "[", "prod", "]"}], "<", "ma", "<", 
           RowBox[{"mamax", "[", "prod", "]"}]}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"\[Chi]Xtimes\[Chi]XtoALPphoton", "[", 
             RowBox[{"ma", ",", "1", ",", "prod"}], "]"}], "*", 
            RowBox[{"DoubleDistrALPphoton", "[", 
             RowBox[{"ma", ",", "\[Theta]a", ",", "Ea", ",", "prod"}], 
             "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}]}]}], "}"}], 
   ",", "\"\<MX\>\""}], "]"}]}], "Input",
 CellChangeTimes->{
  3.892275265020056*^9, {3.8922752959868155`*^9, 3.8922754301949515`*^9}, {
   3.8922755875171227`*^9, 3.8922757847350535`*^9}, {3.892275816098334*^9, 
   3.8922758699303064`*^9}, {3.8922759009991145`*^9, 3.892275982791625*^9}, {
   3.8922760394923*^9, 3.8922761209101367`*^9}, {3.8922762246009073`*^9, 
   3.892276280738991*^9}, {3.8922763597837152`*^9, 3.892276370383789*^9}, {
   3.8922765419265485`*^9, 3.892276542365629*^9}, {3.8922768369454055`*^9, 
   3.89227686583101*^9}, {3.892277089020526*^9, 3.8922770893935795`*^9}, {
   3.8927107041262445`*^9, 3.8927107094426193`*^9}, {3.8927112807221966`*^9, 
   3.892711285464734*^9}, 3.893520950990365*^9, {3.893754463956788*^9, 
   3.89375446445901*^9}, {3.897232835116475*^9, 3.897232841811715*^9}, {
   3.902238644224341*^9, 3.9022386447878866`*^9}, {3.9027274827435503`*^9, 
   3.9027274977109137`*^9}, {3.9027278331441545`*^9, 3.902727842836087*^9}, {
   3.902887715072954*^9, 3.902887718718549*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[1957]:=",ExpressionUUID->"ccbd42fa-b9d1-4412-9487-e96de9feeedd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Determining min/max energies of scalars for the given polar angle. Needed for \
stability of Monte-Carlo integration\
\>", "Subsection",
 CellChangeTimes->{{3.8850217140541673`*^9, 3.8850217339343953`*^9}, {
  3.885449618401306*^9, 3.8854496389805627`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"e4c3cc8c-3bd7-4b50-8c99-\
3abaa32f3378"],

Cell[CellGroupData[{

Cell["Common definition", "Subsubsection",
 CellChangeTimes->{{3.8851480658530207`*^9, 3.885148069648714*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"7f24cf1e-7678-4346-8ebd-\
675da6011508"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"EfromXmax", "[", 
   RowBox[{"mass_", ",", "data_", ",", "LogMin_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "distr", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"datt", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"data", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "mass"}], "&"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"EmaxVal", "=", 
      RowBox[{
       RowBox[{"datt", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "3"}], "]"}], "]"}], "//", "Max"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Theta]list", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"x", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "\[Theta]minExp", ",", "\[Theta]maxExp", ",", 
          FractionBox[
           RowBox[{"(", 
            RowBox[{"\[Theta]maxExp", "-", "\[Theta]minExp"}], ")"}], "5"]}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"distr", "[", 
       RowBox[{"\[Theta]fip_", ",", "Efip_"}], "]"}], "=", 
      RowBox[{"Abs", "[", 
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", "3", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "4", "]"}], "]"}], "+", 
                SuperscriptBox["10", 
                 RowBox[{"-", "90"}]]}]}], "}"}], "&"}], "/@", "datt"}], ",", 
           RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
         RowBox[{"\[Theta]fip", ",", "Efip"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DoubleDistrIntList", "[", "i_", "]"}], ":=", 
      RowBox[{
       RowBox[{"Interpolation", "[", 
        RowBox[{
         RowBox[{"ParallelTable", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Efip", ",", 
             RowBox[{"Quiet", "[", 
              RowBox[{"NIntegrate", "[", 
               RowBox[{
                RowBox[{"distr", "[", 
                 RowBox[{"\[Theta]fip", ",", "Efip"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"\[Theta]fip", ",", 
                  RowBox[{"\[Theta]list", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", 
                  RowBox[{"\[Theta]list", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"Method", "\[Rule]", "\"\<AdaptiveMonteCarlo\>\""}]}],
                "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Efip", ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               SuperscriptBox["10", "x"], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{"Log10", "[", 
                  RowBox[{"1.1", "*", "mass"}], "]"}], ",", 
                 RowBox[{"Log10", "[", "EmaxVal", "]"}], ",", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"Log10", "[", "EmaxVal", "]"}], "-", 
                   RowBox[{"Log10", "[", 
                    RowBox[{"1.1", "*", "mass"}], "]"}]}], "50."]}], "}"}]}], 
              "]"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "Efip",
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]fipdistrlist", "[", "Efip_", "]"}], "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"\[Theta]list", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "+", 
            RowBox[{"\[Theta]list", "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "2"], ",", 
          RowBox[{"DoubleDistrIntList", "[", "i", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{
           RowBox[{"Length", "[", "\[Theta]list", "]"}], "-", "1"}], ",", 
          "1"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Theta]EmaxList", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"\[Theta]fipdistrlist", "[", "Efip", "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"SortBy", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Efip", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Theta]fipdistrlist", "[", "Efip", "]"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Efip", ",", "mass", ",", "EmaxVal", ",", "1"}], 
                 "}"}]}], "]"}], ",", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"\[Theta]fipdistrlist", "[", "Efip", "]"}], "]"}], ",", 
          "1"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]EmaxListInt", "[", "\[Theta]fip_", "]"}], "=", 
      RowBox[{
       RowBox[{"Interpolation", "[", 
        RowBox[{"\[Theta]EmaxList", ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
       "\[Theta]fip", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"NormVals", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"\[Theta]fipdistrlist", "[", "Efip", "]"}], "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", 
           SuperscriptBox["10", 
            RowBox[{"-", "90."}]]}], ",", 
          RowBox[{"{", 
           RowBox[{"Efip", ",", "mass", ",", "EmaxVal"}], "}"}], ",", 
          RowBox[{
          "Method", "\[Rule]", "\"\<InterpolationPointsSubdivision\>\""}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"\[Theta]fipdistrlist", "[", "Efip", "]"}], "]"}], ",", 
          "1"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cdf", "[", 
       RowBox[{"es_", ",", "i_"}], "]"}], ":=", 
      RowBox[{"1", "-", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"NormVals", "[", 
          RowBox[{"[", "i", "]"}], "]"}]], 
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"\[Theta]fipdistrlist", "[", "Efip", "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"Efip", ",", "mass", ",", "es"}], "}"}], ",", 
          RowBox[{
          "Method", "\[Rule]", "\"\<InterpolationPointsSubdivision\>\""}]}], 
         "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cdftab", "[", "Efip_", "]"}], "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"\[Theta]fipdistrlist", "[", "Efip", "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"Interpolation", "[", 
            RowBox[{
             RowBox[{"ParallelTable", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"10", "^", "es"}], ",", 
                 RowBox[{"Quiet", "[", 
                  RowBox[{"cdf", "[", 
                   RowBox[{
                    RowBox[{"10", "^", "es"}], ",", "i"}], "]"}], "]"}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"es", ",", 
                 RowBox[{"Log10", "[", "mass", "]"}], ",", 
                 RowBox[{"Log10", "[", "EmaxVal", "]"}], ",", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"Log10", "[", "EmaxVal", "]"}], "-", 
                   RowBox[{"Log10", "[", "mass", "]"}]}], "50"]}], "}"}]}], 
              "]"}], ",", 
             RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
           "Efip", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"\[Theta]fipdistrlist", "[", "Efip", "]"}], "]"}], ",", 
          "1"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"logmin", "[", "\[Theta]fip_", "]"}], "=", "LogMin"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Estart", "[", "\[Theta]fip_", "]"}], "=", 
      RowBox[{"Min", "[", 
       RowBox[{
        RowBox[{"2", "*", 
         RowBox[{"\[Theta]EmaxListInt", "[", "\[Theta]fip", "]"}]}], ",", 
        RowBox[{"0.9", "*", "EmaxVal"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Emaxv", "[", "i_", "]"}], ":=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"NormVals", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "<", 
         SuperscriptBox["10", 
          RowBox[{"-", "15"}]]}], ",", "mass", ",", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"Efip", "/.", 
           RowBox[{"FindRoot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Log10", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"cdftab", "[", 
                  SuperscriptBox["10", "Efip"], "]"}], "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], "\[Equal]", 
              RowBox[{"logmin", "[", 
               RowBox[{
                RowBox[{"\[Theta]EmaxList", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"Efip", ",", 
               RowBox[{"Log10", "[", 
                RowBox[{"Estart", "[", 
                 RowBox[{
                  RowBox[{"\[Theta]EmaxList", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"Log10", "[", 
                RowBox[{
                 RowBox[{"\[Theta]EmaxList", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
               RowBox[{"Log10", "[", "EmaxVal", "]"}]}], "}"}]}], "]"}]}], 
          ")"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tabtemp", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Theta]EmaxList", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"Emaxv", "[", "i", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "\[Theta]EmaxList", "]"}], ",", "1"}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tab", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"\[Theta]minExp", ",", 
           RowBox[{
            RowBox[{"tabtemp", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "}"}], ",", 
        RowBox[{"Drop", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{"tabtemp", ",", "1"}], "]"}], ",", 
          RowBox[{"-", "1"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"\[Theta]maxExp", ",", 
           RowBox[{
            RowBox[{"tabtemp", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"10", "^", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Log10", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
              RowBox[{"Log10", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
           "tab"}], ",", 
          RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
        RowBox[{"Log10", "[", "\[Theta]fip", "]"}], "]"}], ")"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EmaxBlock", "[", 
   RowBox[{"data_", ",", "logmin_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "mlist", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mlist", "=", 
      RowBox[{"Drop", "[", 
       RowBox[{
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"EmaxTemp", "[", 
       RowBox[{"m_", ",", "\[Theta]_"}], "]"}], "=", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"m", ",", 
         RowBox[{"EfromXmax", "[", 
          RowBox[{
           RowBox[{"mlist", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "data", ",", "logmin"}], 
          "]"}], ",", 
         RowBox[{"EfromXmax", "[", 
          RowBox[{
           RowBox[{"mlist", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}], ",", "data", ",", "logmin"}], 
          "]"}]}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{"\[Theta]fip", "\[Rule]", "\[Theta]"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Theta]list", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"x", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "\[Theta]minExp", ",", "\[Theta]maxExp", ",", 
          FractionBox[
           RowBox[{"(", 
            RowBox[{"\[Theta]maxExp", "-", "\[Theta]minExp"}], ")"}], "10"]}],
          "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"10", "^", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"Log10", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
              RowBox[{"Log10", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"mfip", ",", "\[Theta]fip", ",", 
                 RowBox[{"EmaxTemp", "[", 
                  RowBox[{"mfip", ",", "\[Theta]fip"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"mfip", ",", 
                 RowBox[{"mlist", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"mlist", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"mlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"mlist", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", "10"}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"\[Theta]fip", ",", "\[Theta]list"}], "}"}]}], "]"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ",", 
          RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
        RowBox[{"mfip", ",", 
         RowBox[{"Log10", "[", "\[Theta]fip", "]"}]}], "]"}], ")"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Eamax", "[", 
      RowBox[{"mfip_", ",", "\[Theta]fip_", ",", "prod"}], "]"}], "=", 
     RowBox[{"EmaxBlock", "[", 
      RowBox[{
       RowBox[{"DataDistrALPphoton", "[", "prod", "]"}], ",", 
       RowBox[{"-", "5"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"EminALPphotonForPlot", ",", "EamaxForPlot"}], "}"}], "=", 
   RowBox[{"MinMax", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Eamax", "[", 
       RowBox[{"ma", ",", "\[Theta]a", ",", "prod"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]a", ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]minExp", ",", "\[Theta]maxExp"}], "}"}]}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"ma", ",", 
        RowBox[{"MinMax", "[", 
         RowBox[{"mlistALPphoton", "[", "prod", "]"}], "]"}]}], "}"}]}], 
     "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogLogPlot", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Eamax", "[", 
       RowBox[{"0.05", ",", "\[Theta]a", ",", "prod"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Theta]a", ",", "\[Theta]minExp", ",", "\[Theta]maxExp"}], 
    "}"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"All", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0.8", "*", "EminALPphotonForPlot"}], ",", 
        RowBox[{"1.2", "*", "EamaxForPlot"}]}], "}"}]}], "}"}]}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"Placed", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"#", ",", "15"}], "]"}], "&"}], "/@", "ProductionList"}], 
      ",", "Right"}], "]"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.885148084467116*^9, 3.885148248479889*^9}, {
   3.8851482989957933`*^9, 3.8851483493083973`*^9}, {3.8851484063554387`*^9, 
   3.8851484068571916`*^9}, {3.8852228484402695`*^9, 
   3.8852228841962533`*^9}, {3.885224401910403*^9, 3.8852244120061765`*^9}, {
   3.885224885137532*^9, 3.885224944143616*^9}, {3.8852249849251437`*^9, 
   3.88522503277181*^9}, {3.8852250820240493`*^9, 3.8852250833651195`*^9}, {
   3.8852255247123723`*^9, 3.8852255362799845`*^9}, {3.8852261807199936`*^9, 
   3.885226182942499*^9}, {3.8852271814880905`*^9, 3.885227195878027*^9}, {
   3.8853542861804843`*^9, 3.885354416029894*^9}, {3.8853544784296722`*^9, 
   3.885354483251371*^9}, {3.885354517144206*^9, 3.885354538902566*^9}, {
   3.885354903942062*^9, 3.8853549049320507`*^9}, {3.8853790449621615`*^9, 
   3.885379047122514*^9}, {3.88537908973895*^9, 3.88537909078761*^9}, {
   3.8853791272449913`*^9, 3.8853791320747995`*^9}, {3.885379220617199*^9, 
   3.8853792208975644`*^9}, {3.885379600558668*^9, 3.885379606494396*^9}, {
   3.8853798728114595`*^9, 3.885379890399393*^9}, {3.8853803814172516`*^9, 
   3.885380383398796*^9}, {3.8853805048204*^9, 3.8853805131399064`*^9}, {
   3.88544831672608*^9, 3.8854484887165213`*^9}, {3.885448535946783*^9, 
   3.8854485812517896`*^9}, {3.885448619241871*^9, 3.885448637306032*^9}, {
   3.885448697726526*^9, 3.885448709541115*^9}, {3.8854487438125606`*^9, 
   3.885448765875434*^9}, {3.885448925652766*^9, 3.8854489264414215`*^9}, {
   3.885449048506912*^9, 3.885449074318219*^9}, {3.885449213197753*^9, 
   3.8854492178649426`*^9}, {3.885449253485854*^9, 3.885449280106469*^9}, {
   3.8854494883928027`*^9, 3.8854494889095163`*^9}, {3.8854497564476986`*^9, 
   3.88544975668421*^9}, {3.88574559725268*^9, 3.8857455973645034`*^9}, {
   3.8857458088268394`*^9, 3.8857458358713536`*^9}, {3.885746076352998*^9, 
   3.885746167875806*^9}, {3.8922728619401484`*^9, 3.892272925360547*^9}, 
   3.8922763127120056`*^9, {3.8922825088910446`*^9, 3.892282515319512*^9}, 
   3.892282711682006*^9, {3.892283180036781*^9, 3.892283216506448*^9}, {
   3.8922833829065104`*^9, 3.89228340344199*^9}, {3.892710726355029*^9, 
   3.8927107265549655`*^9}, {3.8972328559033346`*^9, 3.8972328563590765`*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[1965]:=",ExpressionUUID->"0500f499-02b1-452e-baee-ce09bd9cdbae"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Number of events", "Chapter",
 CellChangeTimes->{{3.8935731783578434`*^9, 3.893573180246764*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"18333902-760f-4a49-b2f7-\
a7db0718c1c0"],

Cell[CellGroupData[{

Cell["Definitions", "Section",
 CellChangeTimes->{{3.897198873663946*^9, 3.8971988750678434`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"50c91ae6-9248-4d28-b800-\
341ade2a0457"],

Cell[CellGroupData[{

Cell["\<\
Grids for the initial data with acceptances and distributions\
\>", "Subsection",
 CellChangeTimes->{{3.897198934328184*^9, 3.89719895293719*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"8bf9ba77-e751-430d-9143-\
2774faf1e610"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Grid", " ", 
     SubscriptBox["m", "S"]}], ",", " ", 
    SubscriptBox["\[Theta]", "S"], ",", " ", 
    SubscriptBox["E", "S"], ",", " ", 
    RowBox[{
     SubscriptBox["z", "S"], " ", "for", " ", "the", " ", "initial", " ", 
     "acceptance", " ", "data"}], ",", " ", "logarithmized"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"InGridm\[Epsilon]", "=", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"FullAcceptanceData", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InGrid\[Theta]\[Epsilon]", "=", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"FullAcceptanceData", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InGridE\[Epsilon]", "=", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"FullAcceptanceData", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InGridz\[Epsilon]", "=", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"FullAcceptanceData", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Array", " ", "of", " ", "values", " ", "of", " ", "the", " ", "initial",
       " ", "acceptance", " ", "data"}], ",", " ", "reshaped"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Epsilon]vals", "=", 
     RowBox[{"ArrayReshape", "[", 
      RowBox[{
       RowBox[{"FullAcceptanceData", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "5"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Length", "[", "InGridm\[Epsilon]", "]"}], ",", 
         RowBox[{"Length", "[", "InGrid\[Theta]\[Epsilon]", "]"}], ",", 
         RowBox[{"Length", "[", "InGridE\[Epsilon]", "]"}], ",", 
         RowBox[{"Length", "[", "InGridz\[Epsilon]", "]"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Epsilon]azValscomp", "=", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"data", ",", "_Real", ",", "2"}], "}"}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"data", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "5", "]"}], "]"}], "==", "0"}], ",", 
           RowBox[{"-", "90."}], ",", 
           RowBox[{"Log10", "[", 
            RowBox[{
             RowBox[{"data", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "5", "]"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "data", "]"}], ",", "1"}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
       RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Epsilon]azvals", "=", 
     RowBox[{"ArrayReshape", "[", 
      RowBox[{
       RowBox[{"\[Epsilon]azValscomp", "[", "FullAcceptanceData0", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Length", "[", "InGridm\[Epsilon]", "]"}], ",", 
         RowBox[{"Length", "[", "InGrid\[Theta]\[Epsilon]", "]"}], ",", 
         RowBox[{"Length", "[", "InGridE\[Epsilon]", "]"}], ",", 
         RowBox[{"Length", "[", "InGridz\[Epsilon]", "]"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
     "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
     "___", "__"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Grid", " ", 
      SubscriptBox["m", "S"]}], ",", " ", 
     SubscriptBox["\[Theta]", "S"], ",", " ", 
     RowBox[{
      SubscriptBox["E", "S"], " ", "for", " ", "the", " ", "initial", " ", 
      "FIP", " ", "distribution", " ", "data"}], ",", " ", "logarithmized"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"DataLogarithmiedComp", "=", 
    RowBox[{
     RowBox[{"Hold", "@", 
      RowBox[{"Compile", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"data", ",", "_Real", ",", "2"}], "}"}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"data", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "4", "]"}], "]"}], "\[Equal]", "0"}], ",", 
            RowBox[{"-", "90."}], ",", 
            RowBox[{"Log10", "[", 
             RowBox[{
              RowBox[{"data", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "4", "]"}], "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "data", "]"}], ",", "1"}], "}"}]}], "]"}], 
        ",", 
        RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
        RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}]}], "//",
      "ReleaseHold"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockGridsValsDistr", "[", "ProdChannel_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"GridIn", ",", "vals"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"GridIn", "=", 
        RowBox[{"Log10", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{
             RowBox[{"DataDistrALPphoton", "[", "ProdChannel", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "#"}], "]"}], "]"}], "]"}], "&"}], "/@", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"vals", "=", 
        RowBox[{"ArrayReshape", "[", 
         RowBox[{
          RowBox[{"DataLogarithmiedComp", "[", 
           RowBox[{"DataDistrALPphoton", "[", "ProdChannel", "]"}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"GridIn", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
            RowBox[{"Length", "[", 
             RowBox[{"GridIn", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
            RowBox[{"Length", "[", 
             RowBox[{"GridIn", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"GridIn", ",", "vals"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"GridInFinal", "[", "prod", "]"}], ",", 
          RowBox[{"DistrVals", "[", "prod", "]"}]}], "}"}], "=", 
        RowBox[{"BlockGridsValsDistr", "[", "prod", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";"}], "//", 
    "AbsoluteTiming"}]}]}]], "Input",
 CellChangeTimes->{{3.897199659637949*^9, 3.8971996790804834`*^9}, {
   3.897208285005845*^9, 3.8972083314493256`*^9}, 3.89720836608294*^9, {
   3.8972322751312885`*^9, 3.897232278854822*^9}, {3.8972329306560636`*^9, 
   3.897232936165907*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[1970]:=",ExpressionUUID->"fade474d-c258-4c23-9009-9e4dbc52d234"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Grid to be used to calculate the number of events", "Subsection",
 CellChangeTimes->{{3.8971989779703307`*^9, 3.8971989844379535`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"5c5ffe48-8ff6-40c5-8f78-\
8439598eb712"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Grid", " ", 
     SubscriptBox["\[Theta]", "S"]}], ",", " ", 
    RowBox[{
     SubscriptBox["z", "S"], " ", "for", " ", "the", " ", "final", " ", 
     "acceptance", " ", "data"}], ",", " ", "logarithmized"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"OutGrid\[Theta]final", "=", 
     RowBox[{"(*", "InGrid\[Theta]\[Epsilon]", "*)"}], 
     RowBox[{"Log10", "[", 
      RowBox[{"Table", "[", 
       RowBox[{"x", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"10", "^", 
           RowBox[{"Min", "[", "InGrid\[Theta]\[Epsilon]", "]"}]}], ",", 
          RowBox[{"10", "^", 
           RowBox[{"Max", "[", "InGrid\[Theta]\[Epsilon]", "]"}]}], ",", 
          FractionBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"10", "^", 
              RowBox[{"Max", "[", "InGrid\[Theta]\[Epsilon]", "]"}]}], "-", 
             RowBox[{"10", "^", 
              RowBox[{"Min", "[", "InGrid\[Theta]\[Epsilon]", "]"}]}]}], 
            ")"}], "30"]}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"OutGridzfinal", "=", 
     RowBox[{"Log10", "[", 
      RowBox[{"Table", "[", 
       RowBox[{"x", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          SuperscriptBox["10", 
           RowBox[{"InGridz\[Epsilon]", "[", 
            RowBox[{"[", "1", "]"}], "]"}]], ",", 
          SuperscriptBox["10", 
           RowBox[{"InGridz\[Epsilon]", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]], ",", 
          RowBox[{"Min", "[", 
           RowBox[{
            FractionBox[
             RowBox[{
              SuperscriptBox["10", 
               RowBox[{"InGridz\[Epsilon]", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}]], "-", 
              SuperscriptBox["10", 
               RowBox[{"InGridz\[Epsilon]", "[", 
                RowBox[{"[", "1", "]"}], "]"}]]}], "5"], ",", 
            RowBox[{"Max", "[", 
             RowBox[{"0.5", ",", 
              FractionBox[
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["10", 
                  RowBox[{"InGridz\[Epsilon]", "[", 
                   RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]], "-", 
                 SuperscriptBox["10", 
                  RowBox[{"InGridz\[Epsilon]", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]]}], ")"}], "30"]}], "]"}]}],
            "]"}]}], "}"}]}], "]"}], "]"}]}], 
    RowBox[{"(*", "InGridz\[Epsilon]", "*)"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalDelta]xVals", "[", "list_", "]"}], ":=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        FractionBox[
         RowBox[{
          RowBox[{"list", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"list", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "2"], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"list", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "-", 
          RowBox[{"list", "[", 
           RowBox[{"[", 
            RowBox[{"i", "-", "1"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"Length", "[", "list", "]"}], ",", "1"}], "}"}]}], "]"}]}],
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalDelta]\[Theta]vals", "=", 
     RowBox[{"\[CapitalDelta]xVals", "[", 
      SuperscriptBox["10", "OutGrid\[Theta]final"], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalDelta]zvals", "=", 
     RowBox[{"\[CapitalDelta]xVals", "[", 
      SuperscriptBox["10", "OutGridzfinal"], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Final", " ", "energy", " ", 
      RowBox[{"grid", ".", " ", "Mass"}]}], "-", " ", 
     RowBox[{"and", " ", "production", " ", "channel"}], "-", "dependent"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"StepEtemp", "[", "Efip_", "]"}], "=", 
     RowBox[{"Piecewise", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.3", ",", 
          RowBox[{"Efip", "\[LessEqual]", "2.5"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.5", ",", 
          RowBox[{"2.5", "<", "Efip", "<", "35"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", 
          RowBox[{"35", "\[LessEqual]", "Efip", "\[LessEqual]", "50"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", 
          RowBox[{"50", "<", "Efip", "<", "160"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5", ",", 
          RowBox[{"160", "\[LessEqual]", "Efip", "<", "300"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"40", ",", 
          RowBox[{"300", "\[LessEqual]", "Efip", "<", "700"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"50", ",", 
          RowBox[{"700", "\[LessEqual]", "Efip", "<", "2000"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"200", ",", 
          RowBox[{"2000", "\[LessEqual]", "Efip", "<", "4000"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"400", ",", 
          RowBox[{"4000", "\[LessEqual]", "Efip", "<", "7000"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"500", ",", 
          RowBox[{"7000", "\[LessEqual]", "Efip", "\[LessEqual]", "50000"}]}],
          "}"}]}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"OutGridEnergy", "[", 
     RowBox[{"m_", ",", "ProdChannel_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"start", "=", 
            RowBox[{"1.01", "m"}]}], ",", 
           RowBox[{"end", "=", 
            RowBox[{"Eamax", "[", 
             RowBox[{"m", ",", "\[Theta]minExp", ",", "ProdChannel"}], 
             "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Log10", "[", 
          RowBox[{"NestWhileList", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "+", 
              RowBox[{"StepEtemp", "[", "#", "]"}]}], "&"}], ",", "start", 
            ",", 
            RowBox[{
             RowBox[{"#", "\[LessEqual]", "end"}], "&"}], ",", "1", ",", 
            "\[Infinity]", ",", 
            RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}], "//", "N"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalDelta]xValsTotComp", "=", 
     RowBox[{
      RowBox[{"Hold", "@", 
       RowBox[{"Compile", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[CapitalDelta]\[Theta]vals", ",", "_Real", ",", "1"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[CapitalDelta]Evals", ",", "_Real", ",", "1"}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"\[CapitalDelta]zvals", ",", "_Real", ",", "1"}], "}"}]}],
           "}"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[CapitalDelta]\[Theta]vals", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "*", 
             RowBox[{"\[CapitalDelta]Evals", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "*", 
             RowBox[{"\[CapitalDelta]zvals", "[", 
              RowBox[{"[", "k", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "\[CapitalDelta]\[Theta]vals", "]"}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "\[CapitalDelta]Evals", "]"}]}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", 
             RowBox[{"Length", "[", "\[CapitalDelta]zvals", "]"}]}], "}"}]}], 
          "]"}], ",", 
         RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
         RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}]}], "//",
       "ReleaseHold"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8972023930977507`*^9, 3.8972024003159914`*^9}, {
  3.8972037912719955`*^9, 3.897203794873706*^9}, {3.8972042319753127`*^9, 
  3.8972042376735725`*^9}, {3.8972043473390894`*^9, 3.897204353429783*^9}, {
  3.8972047978657155`*^9, 3.89720480634333*^9}, {3.897208409815923*^9, 
  3.89720841003522*^9}, {3.897232284543871*^9, 3.8972322845774384`*^9}, {
  3.9029758631367598`*^9, 3.902975863216053*^9}, {3.902975913215145*^9, 
  3.9029759132915173`*^9}, {3.90297596309776*^9, 3.9029759667520623`*^9}, {
  3.902976020647378*^9, 3.9029760208918114`*^9}, {3.902976094950827*^9, 
  3.9029761009302263`*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[1980]:=",ExpressionUUID->"b78c9e0d-b198-443c-bb9b-82530589576a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Code that computes the number of events - using the mapping method \
\>", "Subsection",
 CellChangeTimes->{{3.897199076623907*^9, 3.8971990900052223`*^9}, {
  3.8972009084104066`*^9, 3.897200920680235*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"b54ffa03-0d63-4f8e-a1c9-\
f7fb2138ef4d"],

Cell[CellGroupData[{

Cell["Grid for distribution times acceptance", "Subsubsection",
 CellChangeTimes->{{3.8972000893750353`*^9, 3.897200100182712*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"d77ae272-2ba2-46b0-a466-\
458092d1666f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Block", " ", "that", " ", "computes", " ", "the", " ", "grid", " ", 
     SubscriptBox["\[Theta]", "S"]}], ",", 
    SubscriptBox["E", "S"], ",", 
    SubscriptBox["z", "S"], ",", " ", 
    RowBox[{
     SubscriptBox["\[Epsilon]", "Full"], "\[Times]", 
     SubscriptBox["f", 
      RowBox[{
       SubscriptBox["\[Theta]", "S"], ",", 
       SubscriptBox["E", "S"]}]]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"TableIntegrandDiscret", "[", 
    RowBox[{"m_", ",", "ProdChannel_", ",", "\[Epsilon]DecOp_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"OutGridEfinal", "=", 
       RowBox[{"OutGridEnergy", "[", 
        RowBox[{
         RowBox[{"N", "[", "m", "]"}], ",", "ProdChannel"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalDelta]Evals", "=", 
       RowBox[{"\[CapitalDelta]xVals", "[", 
        SuperscriptBox["10", "OutGridEfinal"], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalDelta]xValsTot", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"\[CapitalDelta]xValsTotComp", "[", 
          RowBox[{
          "\[CapitalDelta]\[Theta]vals", ",", "\[CapitalDelta]Evals", ",", 
           "\[CapitalDelta]zvals"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"OutGridFinal", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Log10", "[", 
            RowBox[{"N", "[", "m", "]"}], "]"}], "}"}], ",", 
          "OutGrid\[Theta]final", ",", "OutGridEfinal", ",", 
          "OutGridzfinal"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"OutGridFinal1", "=", 
       RowBox[{"10", "^", 
        RowBox[{"OutGridFinal", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "3", ",", "4"}], "}"}]}], "]"}], "]"}]}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"g\[Epsilon]", "=", 
       RowBox[{"{", 
        RowBox[{
        "InGridm\[Epsilon]", ",", "InGrid\[Theta]\[Epsilon]", ",", 
         "InGridE\[Epsilon]", ",", "InGridz\[Epsilon]"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xg\[Epsilon]", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Log10", "[", 
           RowBox[{"N", "[", "m", "]"}], "]"}], "}"}], ",", 
         "OutGrid\[Theta]final", ",", "OutGridEfinal", ",", "OutGridzfinal"}],
         "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xig\[Epsilon]", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Interpolation", "[", 
            RowBox[{
             RowBox[{"Transpose", "@", 
              RowBox[{"{", 
               RowBox[{"#", ",", 
                RowBox[{"Range", "@", 
                 RowBox[{"Length", "@", "#"}]}]}], "}"}]}], ",", 
             RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
           "#2", "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"g\[Epsilon]", ",", "xg\[Epsilon]"}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"\[Epsilon]Result", "=", 
       RowBox[{"10", "^", 
        RowBox[{"Flatten", "@", 
         RowBox[{"cf4", "[", 
          RowBox[{
           RowBox[{"Sequence", "@@", "xig\[Epsilon]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"\[Epsilon]DecOp", "==", "\"\<True\>\""}], ",", 
             "\[Epsilon]vals", ",", "\[Epsilon]azvals"}], "]"}]}], 
          "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gDistr", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"GridInFinal", "[", "ProdChannel", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"GridInFinal", "[", "ProdChannel", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"GridInFinal", "[", "ProdChannel", "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xgDistr", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Log10", "[", 
           RowBox[{"N", "[", "m", "]"}], "]"}], "}"}], ",", 
         "OutGrid\[Theta]final", ",", "OutGridEfinal"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xigDistr", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Interpolation", "[", 
            RowBox[{
             RowBox[{"Transpose", "@", 
              RowBox[{"{", 
               RowBox[{"#", ",", 
                RowBox[{"Range", "@", 
                 RowBox[{"Length", "@", "#"}]}]}], "}"}]}], ",", 
             RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
           "#2", "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"gDistr", ",", "xgDistr"}], "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"DistrResult", "=", 
       RowBox[{"10", "^", 
        RowBox[{"Flatten", "@", 
         RowBox[{"cf3", "[", 
          RowBox[{
           RowBox[{"Sequence", "@@", "xigDistr"}], ",", 
           RowBox[{"DistrVals", "[", "ProdChannel", "]"}]}], "]"}]}]}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"TabTemp0", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"OutGridFinal1", ",", 
         RowBox[{"List", "/@", 
          RowBox[{"Flatten", "[", 
           RowBox[{"DistrResult", " ", 
            RowBox[{"Partition", "[", 
             RowBox[{"\[Epsilon]Result", ",", 
              RowBox[{"Length", "[", "OutGridzfinal", "]"}]}], "]"}]}], 
           "]"}]}], ",", "\[CapitalDelta]xValsTot", ",", "2"}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8971994275280633`*^9, 3.897199455815837*^9}, {
  3.897199582357897*^9, 3.897199655914138*^9}, {3.897199710190297*^9, 
  3.8971997629515643`*^9}, {3.8971998392552953`*^9, 3.897199857485531*^9}, {
  3.8971999081472673`*^9, 3.897199913176509*^9}, {3.897200806217702*^9, 
  3.897200808930355*^9}, {3.8972008448098516`*^9, 3.897200868455401*^9}, {
  3.8972021893667536`*^9, 3.897202196806899*^9}, {3.89720660886187*^9, 
  3.8972066089868507`*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[1988]:=",ExpressionUUID->"ac01137b-ad2a-4e37-9bde-5305ad407266"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Convoluting acceptances with pre-factor", "Subsubsection",
 CellChangeTimes->{{3.8972001073570213`*^9, 3.8972001113381767`*^9}, {
  3.897200680751539*^9, 3.8972006887621703`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"477abc3f-2c58-4168-ac31-\
f2592812ecf2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Values", " ", 
     SubscriptBox["f", "FIP"], "\[Times]", 
     SubscriptBox["\[Epsilon]", "FIP"], "\[Times]", 
     FractionBox[
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", 
         SubscriptBox["z", "FIP"]}], "/", 
        RowBox[{"(", 
         RowBox[{"cos", 
          RowBox[{"(", 
           SubscriptBox["\[Theta]", "FIP"], ")"}], 
          SubscriptBox["c\[Tau]", "FIP"], 
          RowBox[{
           SubscriptBox["p", "FIP"], "/", 
           SubscriptBox["m", "FIP"]}]}], ")"}]}], "]"}], 
      RowBox[{"cos", 
       RowBox[{"(", 
        SubscriptBox["\[Theta]", "FIP"], ")"}], 
       SubscriptBox["c\[Tau]", "FIP"], 
       RowBox[{
        SubscriptBox["p", "FIP"], "/", 
        SubscriptBox["m", "FIP"]}]}]], "\[Times]", 
     SubscriptBox["\[Epsilon]", "decay"], 
     SubscriptBox["\[CapitalDelta]z", "FIP"], 
     SubscriptBox["\[CapitalDelta]E", "FIP"], 
     SubscriptBox["\[CapitalDelta]\[Theta]", "FIP"], " ", "for", " ", "the", 
     " ", "grid", " ", "of", " ", "values", " ", 
     SubscriptBox["\[Theta]", "FIP"]}], ",", " ", 
    SubscriptBox["E", "FIP"], ",", " ", 
    RowBox[{
     SubscriptBox["z", "FIP"], " ", "fixed", " ", "values", " ", "of", " ", 
     SubscriptBox["c\[Tau]", "FIP"], " ", "and", " ", 
     SubscriptBox["m", "FIP"]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tableprefac", "=", 
     RowBox[{
      RowBox[{"Hold", "@", 
       RowBox[{"Compile", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"tabb", ",", "_Real", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", "_Real"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c\[Tau]", ",", "_Real"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"decProb", ",", "_Integer"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"zshift", ",", "_Real"}], "}"}]}], "}"}], ",", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "angles", ",", "energies", ",", "zv", ",", "values", ",", 
             "\[CapitalDelta]s", ",", "prefactor"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"values", "=", 
             RowBox[{"Compile`GetElement", "[", 
              RowBox[{"tabb", ",", "4"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"\[CapitalDelta]s", "=", 
             RowBox[{"Compile`GetElement", "[", 
              RowBox[{"tabb", ",", "5"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"decProb", "==", "1"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"angles", "=", 
                RowBox[{"Compile`GetElement", "[", 
                 RowBox[{"tabb", ",", "1"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"energies", "=", 
                RowBox[{"Compile`GetElement", "[", 
                 RowBox[{"tabb", ",", "2"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"zv", "=", 
                RowBox[{"Compile`GetElement", "[", 
                 RowBox[{"tabb", ",", "3"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"prefactor", "=", 
                FractionBox[
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"zv", "-", "zshift"}], ")"}]}], "/", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Cos", "[", "angles", "]"}], "*", "c\[Tau]", "*", 
                    FractionBox[
                    SqrtBox[
                    RowBox[{
                    SuperscriptBox["energies", "2"], "-", 
                    SuperscriptBox["m", "2"]}]], "m"]}], ")"}]}], "]"}], 
                 RowBox[{
                  RowBox[{"Cos", "[", "angles", "]"}], "*", "c\[Tau]", "*", 
                  FractionBox[
                   SqrtBox[
                    RowBox[{
                    SuperscriptBox["energies", "2"], "-", 
                    SuperscriptBox["m", "2"]}]], "m"]}]]}]}], ",", 
              RowBox[{"prefactor", "=", "1."}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"prefactor", "*", "\[CapitalDelta]s", "*", "values"}]}]}],
           "]"}], ",", 
         RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
         RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
         RowBox[{"Parallelization", "\[Rule]", "\"\<True\>\""}], ",", 
         RowBox[{"RuntimeAttributes", "\[Rule]", 
          RowBox[{"{", "Listable", "}"}]}]}], "]"}]}], "//", 
      "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Summation", " ", "of", " ", "the", " ", "values", " ", "above"}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sumcompile", "=", 
     RowBox[{
      RowBox[{"Hold", "@", 
       RowBox[{"Compile", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"tabc\[Tau]m", ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
         RowBox[{"Total", "[", "tabc\[Tau]m", "]"}], ",", 
         RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
         RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
         RowBox[{"Parallelization", "\[Rule]", "\"\<True\>\""}]}], "]"}]}], "//",
       "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mmin\[Epsilon]", ",", "mmax\[Epsilon]"}], "}"}], "=", 
    RowBox[{"10", "^", 
     RowBox[{"MinMax", "[", "InGridm\[Epsilon]", "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{
  3.897200675960476*^9, {3.8972040486175427`*^9, 3.897204049008037*^9}, {
   3.897204079641328*^9, 3.8972040859999785`*^9}, {3.8972057591435843`*^9, 
   3.8972057626279507`*^9}, {3.89720886889474*^9, 3.897208869001661*^9}, {
   3.897233157406136*^9, 3.8972331674582524`*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[1989]:=",ExpressionUUID->"4b1b7fca-9fd0-401b-a5a5-05789e71edec"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Acceptances", "Subsubsection",
 CellChangeTimes->{{3.8972009286929445`*^9, 3.8972009324601674`*^9}, 
   3.897201517674982*^9},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"fb97e9a0-5fb1-4406-ab99-\
38a7edc8e450"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FactorANUBISceiling", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"SelectedExperiment", "==", "\"\<ANUBIS-ceiling\>\""}], ",", "2",
      ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AcceptanceDiscret", "[", 
   RowBox[{
   "m_", ",", "ProdChannel_", ",", "\[Epsilon]decOp_", ",", "decProb_", ",", 
    "zshift_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"NevDiscret", ",", "NpotTimes\[Chi]val"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"mamin", "[", "ProdChannel", "]"}], ",", "mmin\[Epsilon]"}],
          "]"}], "<", "m", "<", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"mamax", "[", "ProdChannel", "]"}], ",", "mmax\[Epsilon]"}],
          "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"integrandtab", "=", 
         RowBox[{"TableIntegrandDiscret", "[", 
          RowBox[{"m", ",", "ProdChannel", ",", "\[Epsilon]decOp"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"brvis", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"\[Epsilon]decOp", "==", "1"}], ",", 
           RowBox[{"BrVis", "[", "m", "]"}], ",", "1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Test", " ", "lifetime", " ", "for", " ", "the", " ", "acceptance"}],
          "*)"}], "\[IndentingNewLine]", 
        RowBox[{"c\[Tau]acc", "=", 
         SuperscriptBox["10", "9"]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Prefactor", " ", "for", " ", "the", " ", 
          RowBox[{"acceptance", ".", " ", "If"}], " ", "only", " ", 
          "azimuthal", " ", "and"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"prefacacc", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"decProb", "==", "1"}], ",", "c\[Tau]acc", ",", 
           FractionBox["1", 
            RowBox[{"zmaxExp", "-", "zminExp"}]]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"accdiscret", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"brvis", "!=", "0"}], ",", 
           RowBox[{"FactorANUBISceiling", "*", "brvis", "*", "prefacacc", "*", 
            RowBox[{"sumcompile", "[", 
             RowBox[{"tableprefac", "[", 
              RowBox[{
              "integrandtab", ",", "m", ",", "c\[Tau]acc", ",", "decProb", 
               ",", "zshift"}], "]"}], "]"}]}], ",", "0"}], "]"}]}]}], ",", 
       RowBox[{"accdiscret", "=", "0"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "accdiscret"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.8972011084712963`*^9, 3.897201128340288*^9}, {
   3.8972011891481795`*^9, 3.89720124049387*^9}, {3.8972012897384634`*^9, 
   3.897201325360157*^9}, {3.897201589075931*^9, 3.8972016624203763`*^9}, {
   3.8972018160050974`*^9, 3.8972018498780518`*^9}, {3.89720191795713*^9, 
   3.8972019346903367`*^9}, {3.8972020225483*^9, 3.8972020975166674`*^9}, {
   3.8972023111284375`*^9, 3.897202311275799*^9}, 3.8972023780567894`*^9, {
   3.897205334073205*^9, 3.8972053351996293`*^9}, {3.897206603491517*^9, 
   3.8972066036108027`*^9}, {3.8972084496286616`*^9, 
   3.8972084523229027`*^9}, {3.8972085258638744`*^9, 
   3.8972085259988823`*^9}, {3.8972088775622473`*^9, 
   3.8972088779176054`*^9}, {3.8972323011460724`*^9, 
   3.8972323031331143`*^9}, {3.8972331398975024`*^9, 3.897233154318738*^9}, {
   3.8972332655240684`*^9, 3.897233267351106*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[1992]:=",ExpressionUUID->"4dab4e9d-2936-4ec5-a43c-d9ca9f7dc266"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Acceptances and approximate lower/upper bounds computation", "Section",
 CellChangeTimes->{{3.8972012648879433`*^9, 3.897201267668914*^9}, {
  3.8972059482630224`*^9, 3.8972059524445267`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"4bb3f66c-fe01-4d66-8051-\
df3dd67609f6"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"zMinShift", "[", "prod_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"prod", "\[Equal]", "\"\<Primakov\>\""}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"SelectedExperiment", "\[Equal]", "\"\<FASER\>\""}], "||", 
         RowBox[{"SelectedExperiment", "\[Equal]", "\"\<FASER2\>\""}]}], 
        ")"}]}], ",", "130.", ",", "0."}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"zshiftval", "[", "prod", "]"}], "=", 
       RowBox[{"zMinShift", "[", "prod", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"mlistAcceptance", "[", "prod", "]"}], "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"m", ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", 
             RowBox[{"1.01", 
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{"mamin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}], 
               "]"}]}], ",", 
             RowBox[{"0.95", 
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{"mamax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}], 
               "]"}]}], ",", 
             RowBox[{"Min", "[", 
              RowBox[{
               FractionBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"0.95", 
                   RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"mamax", "[", "prod", "]"}], ",", 
                    "mmax\[Epsilon]"}], "]"}]}], "-", 
                  RowBox[{"1.01", 
                   RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"mamin", "[", "prod", "]"}], ",", 
                    "mmin\[Epsilon]"}], "]"}]}]}], ")"}], "20"], ",", "2"}], 
              "]"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.99", 
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"mamax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}], 
            "]"}]}], "}"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"m", ",", 
            RowBox[{"AcceptanceDiscret", "[", 
             RowBox[{"m", ",", "prod", ",", "\"\<False\>\"", ",", "0", ",", 
              RowBox[{"zshiftval", "[", "prod", "]"}]}], "]"}], ",", 
            RowBox[{"AcceptanceDiscret", "[", 
             RowBox[{"m", ",", "prod", ",", "\"\<True\>\"", ",", "0", ",", 
              RowBox[{"zshiftval", "[", "prod", "]"}]}], "]"}], ",", 
            RowBox[{"AcceptanceDiscret", "[", 
             RowBox[{"m", ",", "prod", ",", "\"\<False\>\"", ",", "1", ",", 
              RowBox[{"zshiftval", "[", "prod", "]"}]}], "]"}], ",", 
            RowBox[{"AcceptanceDiscret", "[", 
             RowBox[{"m", ",", "prod", ",", "\"\<True\>\"", ",", "1", ",", 
              RowBox[{"zshiftval", "[", "prod", "]"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"m", ",", 
            RowBox[{"mlistAcceptance", "[", "prod", "]"}]}], "}"}]}], "]"}]}],
        ",", 
       RowBox[{"{", 
        RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";"}], "//", 
    "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PlotAcc", "[", "ProdChannel_", "]"}], ":=", 
    RowBox[{"ListLogPlot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "4"}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "5"}], "}"}]}], "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"FrameStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", " ", "22"}], "]"}]}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Blue"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
           RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
           RowBox[{"Darker", "@", 
            RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Black"}], "}"}]}], 
        "}"}]}], ",", 
      RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"MinMax", "[", 
          RowBox[{
           RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"0.9", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}], "]"}]}], 
           ",", 
           RowBox[{"1.1", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}]}], "]"}]}]}], 
          "}"}]}], "}"}]}], ",", 
      RowBox[{"Joined", "\[Rule]", "True"}], ",", 
      RowBox[{"Frame", "\[Rule]", "True"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<m [GeV]\>\"", ",", "\"\<Acceptance\>\""}], "}"}]}], ",", 
      RowBox[{"PlotLabel", "\[Rule]", " ", 
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"Row", "[", 
          RowBox[{"{", 
           RowBox[{"\"\<From \>\"", ",", "ProdChannel"}], "}"}], "]"}], ",", 
         " ", "20", ",", " ", "Black"}], "]"}]}], ",", 
      RowBox[{"PlotLegends", "\[Rule]", 
       RowBox[{"Placed", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"#", ",", " ", "18"}], "]"}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{
            "\"\<<\!\(\*SubscriptBox[\(\[Epsilon]\), \(FIP\)]\)>\>\"", ",", 
             "\"\<<\!\(\*SubscriptBox[\(\[Epsilon]\), \
\(FIP\)]\)\!\(\*SubscriptBox[\(\[Epsilon]\), \(decay\)]\)>\>\"", ",", 
             "\"\<c\[Tau]<\!\(\*SubscriptBox[\(\[Epsilon]\), \
\(FIP\)]\)\!\(\*SubscriptBox[\(P\), \(decay\)]\)>\>\"", ",", 
             "\"\<c\[Tau]<\!\(\*SubscriptBox[\(\[Epsilon]\), \
\(FIP\)]\)\!\(\*SubscriptBox[\(P\), \(decay\)]\)\!\(\*SubscriptBox[\(\
\[Epsilon]\), \(decay\)]\)>\>\""}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.75", ",", "0.2"}], "}"}]}], "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"Style", "[", 
    RowBox[{
     RowBox[{"Row", "[", 
      RowBox[{"Evaluate", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"PlotAcc", "[", "prod", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "]"}], 
      "]"}], ",", 
     RowBox[{"ImageSizeMultipliers", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"FilenameAcceptance", "[", "prod", "]"}], "=", 
        RowBox[{"ToString", "@", 
         RowBox[{"StringForm", "[", 
          RowBox[{"\"\<Acceptance_ALP-photon_at_``_From_``.dat\>\"", ",", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"{", 
             RowBox[{"SelectedExperiment", ",", 
              RowBox[{"ListExport", "[", "prod", "]"}]}], "}"}]}]}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], ",", 
            "\"\<Auxiliary data/ALPs with photon coupling\>\"", ",", 
            "SelectedExperiment", ",", 
            RowBox[{"FilenameAcceptance", "[", "prod", "]"}]}], "}"}], "]"}], 
         ",", 
         RowBox[{
          RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", "4", ",", "5"}], "}"}]}], "]"}], 
          "]"}], ",", "\"\<Table\>\""}], "]"}]}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AccAveraged", "[", "ma_", "]"}], "=", 
     RowBox[{"NpotGivenExperiment", "*", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"mamin", "[", "prod", "]"}], "<", "ma", "<", 
             RowBox[{"mamax", "[", "prod", "]"}]}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"\[Chi]Xtimes\[Chi]XtoALPphoton", "[", 
              RowBox[{"ma", ",", "1", ",", "prod"}], "]"}], "]"}], ",", "0"}],
            "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ",", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"mamin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}], 
              "]"}], "<", "ma", "<", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"mamax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}], 
              "]"}]}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{
              RowBox[{"\[Chi]Xtimes\[Chi]XtoALPphoton", "[", 
               RowBox[{"ma", ",", "1", ",", "prod"}], "]"}], "*", 
              RowBox[{
               RowBox[{"Interpolation", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
                 RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[",
                "ma", "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ",", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"mamin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}], 
              "]"}], "<", "ma", "<", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"mamax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}], 
              "]"}]}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{
              FractionBox[
               RowBox[{"\[Chi]Xtimes\[Chi]XtoALPphoton", "[", 
                RowBox[{"ma", ",", "1", ",", "prod"}], "]"}], "c\[Tau]acc"], 
              "*", 
              RowBox[{
               RowBox[{"Interpolation", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "4"}], "}"}]}], "]"}], "]"}], ",", 
                 RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[",
                "ma", "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ",", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"mamin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}], 
              "]"}], "<", "ma", "<", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"mamax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}], 
              "]"}]}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{
              FractionBox[
               RowBox[{"\[Chi]Xtimes\[Chi]XtoALPphoton", "[", 
                RowBox[{"ma", ",", "1", ",", "prod"}], "]"}], "c\[Tau]acc"], 
              "*", 
              RowBox[{
               RowBox[{"Interpolation", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "5"}], "}"}]}], "]"}], "]"}], ",", 
                 RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[",
                "ma", "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}]}], 
       "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<Auxiliary data/ALPs with photon coupling\>\"", ",", 
        "SelectedExperiment", ",", "\"\<AcceptanceAveragedALPphoton.m\>\""}], 
       "}"}], "]"}], ",", 
     RowBox[{"AccAveraged", "[", "ma", "]"}], ",", "\"\<MX\>\""}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.897205194596387*^9, 3.8972052417988367`*^9}, {
   3.897205309605931*^9, 3.89720539403836*^9}, {3.8972055297271395`*^9, 
   3.89720562453496*^9}, {3.8972056761558304`*^9, 3.897205703295968*^9}, {
   3.897205781529233*^9, 3.8972057841962852`*^9}, {3.897205893477086*^9, 
   3.897205918862975*^9}, {3.897206478456417*^9, 3.8972065044154882`*^9}, {
   3.8972085444868965`*^9, 3.897208578779801*^9}, {3.8972323557288723`*^9, 
   3.897232384030597*^9}, {3.8972329066377125`*^9, 3.8972329106422553`*^9}, {
   3.8972331787918997`*^9, 3.8972332447413106`*^9}, 3.897233307738046*^9, {
   3.8975321655778713`*^9, 3.8975321717738714`*^9}, {3.9026509548968177`*^9, 
   3.902650958961503*^9}, 3.9028940449720345`*^9, {3.9038921063403826`*^9, 
   3.9038921080736647`*^9}, {3.903941797492713*^9, 3.903941798039575*^9}, {
   3.905840412482271*^9, 3.9058404205340576`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"b0e3067b-8ee7-4de7-a7d2-\
94f772fa76ea"],

Cell[CellGroupData[{

Cell["Rough estimates of the upper and lower bounds", "Subsection",
 CellChangeTimes->{{3.8850328066928463`*^9, 3.8850328135228024`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"f27ee69d-2096-4f9d-9d2c-\
57657e82aabb"],

Cell[CellGroupData[{

Cell["Definitions", "Subsubsection",
 CellChangeTimes->{{3.877676708463168*^9, 3.877676711193803*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"7f4bf841-2328-4018-b498-\
8d94ed4a2b09"],

Cell[BoxData[{
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"gaminEstimate", "[", 
      RowBox[{"ma_", ",", "prod"}], "]"}], "=", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox[
        RowBox[{"NpotGivenExperiment", "*", 
         RowBox[{"\[Chi]Xtimes\[Chi]XtoALPphoton", "[", 
          RowBox[{"ma", ",", "1", ",", "prod"}], "]"}], "*", 
         RowBox[{
          RowBox[{"Interpolation", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "5"}], "}"}]}], "]"}], "]"}], ",", 
            RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
          "ma", "]"}]}], 
        RowBox[{"2.3", 
         RowBox[{"ldecayALPphoton", "[", 
          RowBox[{"ma", ",", "1", ",", "Ea"}], "]"}], "*", 
         FractionBox["ma", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["Ea", "2"], "-", 
            SuperscriptBox["ma", "2"]}]]]}]], ")"}], 
      RowBox[{
       RowBox[{"-", "1"}], "/", "4."}]]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gamaxEstimate", "[", 
      RowBox[{"ma_", ",", "prod"}], "]"}], "=", 
     RowBox[{"Re", "[", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"Re", "[", 
         RowBox[{"Evaluate", "[", 
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             RowBox[{"ProductLog", "[", 
              RowBox[{
               RowBox[{"-", "1"}], ",", 
               RowBox[{
                RowBox[{"-", "2.3"}], "*", 
                FractionBox["b", "a"]}]}], "]"}], "b"]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a", "\[Rule]", " ", 
              RowBox[{"NpotGivenExperiment", "*", 
               RowBox[{"\[Chi]Xtimes\[Chi]XtoALPphoton", "[", 
                RowBox[{"ma", ",", "1", ",", "prod"}], "]"}], "*", 
               RowBox[{
                RowBox[{"Interpolation", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
                  RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], 
                "[", "ma", "]"}]}]}], ",", 
             RowBox[{"b", "\[Rule]", 
              FractionBox[
               RowBox[{"(", 
                RowBox[{"zminExp", "-", 
                 RowBox[{"zshiftval", "[", "prod", "]"}]}], ")"}], 
               RowBox[{"ldecayALPphoton", "[", 
                RowBox[{"ma", ",", "1", ",", 
                 RowBox[{"Eamax", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"mlistALPphoton", "[", "prod", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\[Theta]minExp", 
                   ",", "prod"}], "]"}]}], "]"}]]}]}], "}"}]}], "]"}], "]"}], 
        ")"}], 
       RowBox[{"1", "/", "2."}]], "]"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"prod", ",", "ProductionList"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Epsilon]estplot", "=", "\"\<\[Eta]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogLogPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"gaminEstimate", "[", 
      RowBox[{"ma", ",", "\[Epsilon]estplot"}], "]"}], ",", 
     RowBox[{"gamaxEstimate", "[", 
      RowBox[{"ma", ",", "\[Epsilon]estplot"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"ma", ",", 
     RowBox[{"Min", "[", 
      RowBox[{"mlistALPphoton", "[", "\[Epsilon]estplot", "]"}], "]"}], ",", 
     RowBox[{"Max", "[", 
      RowBox[{"mlistALPphoton", "[", "\[Epsilon]estplot", "]"}], "]"}]}], 
    "}"}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"ImageSize", "->", "Large"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8927045521296835`*^9, 3.892704618398532*^9}, {
   3.892704651576499*^9, 3.892704652867281*^9}, 3.8951292466391563`*^9, {
   3.8972064547512426`*^9, 3.8972064548441195`*^9}, {3.8972065272743893`*^9, 
   3.8972065273639555`*^9}, {3.897208556347765*^9, 3.8972085563922853`*^9}, {
   3.8972086426345124`*^9, 3.897208654173244*^9}, {3.897232414966792*^9, 
   3.8972324175870733`*^9}, {3.8972329876997476`*^9, 3.897233009729268*^9}, {
   3.8972333224369483`*^9, 3.8972333287617497`*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[2003]:=",ExpressionUUID->"a9a0a547-39cb-466a-a362-1c82a7caa54e"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Number of events", "Section",
 CellChangeTimes->{{3.8972012736109533`*^9, 3.897201275449023*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"1e5741a6-b05d-4bed-a216-\
c0a143aa62e3"],

Cell[CellGroupData[{

Cell["Number of events - fast", "Subsection",
 CellChangeTimes->{{3.897206442190997*^9, 3.8972064427846107`*^9}, {
  3.905840424391*^9, 3.9058404275512257`*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"3abc9014-e55b-423d-acac-\
37fad942b452"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FactorLowerBound", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\"\<ANUBIS-shaft-volume-1\>\"", ",", 
          "\"\<ANUBIS-shaft-volume-2\>\"", ",", 
          "\"\<ANUBIS-shaft-volume-3\>\""}], "}"}], ",", 
        "SelectedExperiment"}], "]"}], "==", "True"}], ",", "0.1", ",", 
     "0.3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NeventsDiscret", "[", 
   RowBox[{"m_", ",", "ProdChannel_", ",", "galist_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"NevDiscret", ",", "NpotTimes\[Chi]val", ",", "zshift"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"mamin", "[", "ProdChannel", "]"}], ",", "mmin\[Epsilon]"}], 
        "]"}], "<", "m", "<", 
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"mamax", "[", "ProdChannel", "]"}], ",", "mmax\[Epsilon]"}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"integrandtab", "=", 
        RowBox[{"TableIntegrandDiscret", "[", 
         RowBox[{"m", ",", "ProdChannel", ",", "\"\<True\>\""}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NpotTimes\[Chi]val", "[", "ga_", "]"}], "=", 
        RowBox[{"NpotGivenExperiment", "*", 
         RowBox[{"\[Chi]Xtimes\[Chi]XtoALPphoton", "[", 
          RowBox[{"m", ",", "ga", ",", "ProdChannel"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"lowerbound", ",", "upperbound"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"gaminEstimate", "[", 
           RowBox[{"m", ",", "ProdChannel"}], "]"}], ",", 
          RowBox[{"gamaxEstimate", "[", 
           RowBox[{"m", ",", "ProdChannel"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"brvis", "=", 
        RowBox[{"BrVis", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"zshift", "=", 
        RowBox[{"zMinShift", "[", "ProdChannel", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NevDiscret", "[", "ga_", "]"}], ":=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"0.1", "lowerbound"}], "<", "ga", "<", 
           RowBox[{"(*", "1.5", "*)"}], 
           RowBox[{"2", "upperbound"}]}], ",", 
          RowBox[{
           RowBox[{"NpotTimes\[Chi]val", "[", "ga", "]"}], "*", "brvis", "*", 
           RowBox[{"sumcompile", "[", 
            RowBox[{"tableprefac", "[", 
             RowBox[{"integrandtab", ",", "m", ",", 
              RowBox[{"c\[Tau]ALPphoton", "[", 
               RowBox[{"m", ",", "ga"}], "]"}], ",", "1", ",", "zshift"}], 
             "]"}], "]"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"m", ",", 
           RowBox[{"galist", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"NevDiscret", "[", 
            RowBox[{"galist", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "galist", "]"}], ",", "1"}], "}"}]}], 
        "]"}]}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"m", ",", 
          RowBox[{"galist", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "galist", "]"}], ",", "1"}], "}"}]}], 
       "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.897200964730176*^9, 3.897200965970766*^9}, {
   3.89720118259857*^9, 3.8972011870868115`*^9}, {3.8972012433916793`*^9, 
   3.8972012434804716`*^9}, {3.8972021109080114`*^9, 3.897202111357911*^9}, {
   3.897205130000824*^9, 3.8972051305748835`*^9}, 3.897206599004672*^9, {
   3.8972085445054307`*^9, 3.8972085493226857`*^9}, {3.897208729717713*^9, 
   3.897208782995672*^9}, {3.8972323557542253`*^9, 3.897232355758215*^9}, {
   3.8972325208882675`*^9, 3.897232579312927*^9}, {3.8972330183637056`*^9, 
   3.8972330186824365`*^9}, {3.8972330557477093`*^9, 
   3.8972330786629725`*^9}, {3.8972331885872264`*^9, 
   3.8972331892740192`*^9}, {3.897233372953797*^9, 3.8972334102237387`*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[2006]:=",ExpressionUUID->"740967fd-5392-4235-a2e3-37c275cfd2c9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Number of events - slow (using built-in Mathematica functions Interpolation, \
NIntegrate)\
\>", "Subsection",
 CellChangeTimes->{{3.8972050850842867`*^9, 3.897205097581136*^9}, {
  3.9058404301869864`*^9, 3.905840436234073*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"9db42e09-8f64-41d5-aa46-\
834cbdebf1fe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Differential", " ", "decay", " ", "probability", " ", 
     FractionBox["1", "ldecay"], 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "l"}], "/", "ldecay"}], "]"}]}], ",", " ", 
    RowBox[{
    "where", " ", "l", " ", "is", " ", "expressed", " ", "in", " ", "terms", 
     " ", "of", " ", "the", " ", "longitudinal", " ", "displacement", " ", 
     "z", " ", "and", " ", "polar", " ", "angle", " ", "\[Theta]", " ", "as", 
     " ", 
     RowBox[{"z", "/", "cos\[Theta]"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"PdecayDensity", "[", 
      RowBox[{"ma_", ",", "ga_", ",", "\[Theta]a_", ",", "Ea_", ",", "za_"}], 
      "]"}], "=", 
     FractionBox[
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "za"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]a", "]"}], "*", 
          RowBox[{"ldecayALPphoton", "[", 
           RowBox[{"ma", ",", "ga", ",", "Ea"}], "]"}]}], ")"}]}], "]"}], 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]a", "]"}], "*", 
       RowBox[{"ldecayALPphoton", "[", 
        RowBox[{"ma", ",", "ga", ",", "Ea"}], "]"}]}]]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "The", " ", "integrand", " ", "determining", " ", "the", " ", 
     "differential", " ", "rate", " ", "for", " ", "events"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"IntegrandALPphoton", "[", 
        RowBox[{
        "ma_", ",", "ga_", ",", "\[Theta]a_", ",", "Ea_", ",", "za_", ",", 
         "prod"}], "]"}], "=", 
       RowBox[{
        RowBox[{"DoubleDistrALPphoton", "[", 
         RowBox[{"ma", ",", "\[Theta]a", ",", "Ea", ",", "prod"}], "]"}], "*", 
        RowBox[{"PdecayDensity", "[", 
         RowBox[{"ma", ",", "ga", ",", "\[Theta]a", ",", "Ea", ",", 
          RowBox[{"za", "-", 
           RowBox[{"zMinShift", "[", "prod", "]"}]}]}], "]"}], "*", 
        RowBox[{"AzimuthalAcceptanceALPphoton", "[", 
         RowBox[{"\[Theta]a", ",", "za"}], "]"}], "*", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"DecayAcceptanceALPphoton", "[", 
           RowBox[{"ma", ",", "\[Theta]a", ",", "Ea", ",", "za"}], "]"}], ",",
           "1"}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IntegralALPphoton", "[", 
     RowBox[{"ma_", ",", "ga_", ",", "ProdChannel_"}], "]"}], ":=", 
    RowBox[{"NIntegrate", "[", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"IntegrandALPphoton", "[", 
        RowBox[{
        "ma", ",", "ga", ",", "\[Theta]a", ",", "Ea", ",", "z", ",", 
         "ProdChannel"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]a", ",", "\[Theta]minExp", ",", "\[Theta]maxExp"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Ea", ",", "ma", ",", 
        RowBox[{"Eamax", "[", 
         RowBox[{"ma", ",", "\[Theta]a", ",", "ProdChannel"}], "]"}]}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", 
        RowBox[{"zmin\[Theta]", "[", "\[Theta]a", "]"}], ",", 
        RowBox[{"zmax\[Theta]", "[", "\[Theta]a", "]"}]}], "}"}], ",", 
      RowBox[{"Method", "\[Rule]", "\"\<AdaptiveMonteCarlo\>\""}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Nevents", "[", 
     RowBox[{"ma_", ",", "ga_", ",", "ProdChannel_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"mamin", "[", "ProdChannel", "]"}], "\[LessEqual]", "ma", 
       "\[LessEqual]", 
       RowBox[{"mamax", "[", "ProdChannel", "]"}]}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"0.3", "*", 
          RowBox[{"gaminEstimate", "[", 
           RowBox[{"ma", ",", "ProdChannel"}], "]"}]}], "<", "ga", "<", 
         RowBox[{"1.8", 
          RowBox[{"gamaxEstimate", "[", 
           RowBox[{"ma", ",", "ProdChannel"}], "]"}]}]}], ",", 
        RowBox[{"NpotGivenExperiment", "*", 
         RowBox[{"\[Chi]Xtimes\[Chi]XtoALPphoton", "[", 
          RowBox[{"ma", ",", "ga", ",", "ProdChannel"}], "]"}], "*", 
         RowBox[{"IntegralALPphoton", "[", 
          RowBox[{"ma", ",", "ga", ",", "ProdChannel"}], "]"}]}], ",", "0"}], 
       "]"}], ",", "0"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.897206676519309*^9, 3.8972066766919394`*^9}, {
   3.8972085445134306`*^9, 3.897208556457489*^9}, 3.897208709167758*^9, {
   3.8972087938407507`*^9, 3.897208802487779*^9}, {3.897232355764817*^9, 
   3.897232355767809*^9}, {3.8972324564736366`*^9, 3.8972324601648207`*^9}, {
   3.897233045098506*^9, 3.897233051556747*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[2008]:=",ExpressionUUID->"c94b816b-37a9-4f5b-887b-7a92099fce6f"],

Cell[CellGroupData[{

Cell["Test", "Subsubsection",
 CellChangeTimes->{{3.8921113169894333`*^9, 3.8921113174761143`*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"c74a406a-59b3-4eff-8776-\
0deaf8e47cef"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "This", " ", "is", " ", "a", " ", "comparison", " ", "between", " ", 
     "the", " ", "slow", " ", "and", " ", "fast", " ", "integration", " ", 
     RowBox[{"methods", ".", " ", "For"}], " ", "the", " ", "selected", " ", 
     "mass", " ", "and", " ", "production", " ", "channel"}], ",", " ", 
    RowBox[{
    "the", " ", "numbers", " ", "of", " ", "events", " ", "obtained", " ", 
     "using", " ", "the", " ", "methods", " ", "should", " ", "agree", " ", 
     "within", " ", "10", "%"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"If", " ", "the", " ", "agreement", " ", "is", " ", "worse"}], 
    ",", " ", 
    RowBox[{
    "there", " ", "may", " ", "be", " ", "a", " ", "few", " ", "reasons"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"1", ")"}], " ", "The", " ", "grid", " ", "for", " ", "the", " ",
      "fast", " ", "method", " ", "is", " ", "not", " ", "dense", " ", 
     RowBox[{"enough", ".", " ", "Try"}], " ", "to", " ", "increase", " ", 
     "the", " ", "grid", " ", "density", " ", 
     RowBox[{"(", 
      RowBox[{
      "OutGrid\[Theta]final", ",", " ", "OutGridEfinal", ",", " ", 
       "OutGridzfinal"}], ")"}], " ", "to", " ", "see", " ", "whether", " ", 
     "the", " ", "agreement", " ", 
     RowBox[{"improves", ".", " ", "Sometimes"}]}], ",", " ", 
    RowBox[{
    "even", " ", "a", " ", "slightly", " ", "denser", " ", "grid", " ", "for",
      " ", 
     RowBox[{"e", ".", "g", ".", " ", "z"}], " ", "may", " ", "lead", " ", 
     "to", " ", "a", " ", "significant", " ", "improvement", " ", "in", " ", 
     "the", " ", "agrement"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"2", ")"}], " ", "The", " ", "Monte"}], "-", 
      RowBox[{
      "Carlo", " ", "integrator", " ", "for", " ", "the", " ", "slow", " ", 
       "method", " ", "fails", " ", "to", " ", "evaluate", " ", 
       "properly"}]}], ";", " ", 
     RowBox[{
     "this", " ", "may", " ", "happen", " ", "if", " ", "the", " ", "range", 
      " ", "of", " ", "the", " ", "integration", " ", "over", " ", "energies",
       " ", "is", " ", "too", " ", "large", " ", "compared", " ", "to", " ", 
      "the", " ", "domain", " ", "where", " ", "most", " ", "of", " ", "the", 
      " ", "events", " ", "actually", " ", "are", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"off", "-", 
         RowBox[{
         "axis", " ", "experiments", " ", "such", " ", "as", " ", "MATHUSLA", 
          " ", "and", " ", "ANUBIS"}]}], ")"}], ".", " ", "Another"}], " ", 
      "symptom", " ", "is", " ", "that", " ", "for", " ", "the", " ", "given",
       " ", "mass", " ", "and", " ", "coupling", " ", "the", " ", "integral", 
      " ", "\"\<jumps\>\""}]}], ",", " ", 
    RowBox[{"i", ".", "e", "."}], ",", " ", 
    RowBox[{
    "returns", " ", "values", " ", "with", " ", "large", " ", "error"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"mtest", "=", "2.7"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ProdTest", "=", "\"\<Primakov\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"galist", "=", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["10", 
          RowBox[{"-", "12"}]], ",", 
         RowBox[{"3", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "12"}]]}], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "12"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "11"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "11"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "10"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "10"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "9"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "9"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "8"}]], ",", 
         RowBox[{"2", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "8"}]]}], ",", 
         RowBox[{"4", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "8"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "7"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"6", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"7", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"8", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"9", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "6"}]], ",", 
         RowBox[{"2", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "6"}]]}]}], "}"}], "//", "N"}], "*)"}], 
     RowBox[{"Table", "[", 
      RowBox[{
       SuperscriptBox["10", "x"], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"-", "12."}], ",", 
         RowBox[{"-", "2."}], ",", "0.1"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dat1", "=", 
      RowBox[{"NeventsDiscret", "[", 
       RowBox[{"mtest", ",", "ProdTest", ",", "galist"}], "]"}]}], ";"}], "//",
     "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dat2", "=", 
      RowBox[{"ParallelTable", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"galist", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"c\[Tau]ALPphoton", "[", 
           RowBox[{"mtest", ",", 
            RowBox[{"galist", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"Nevents", "[", 
           RowBox[{"mtest", ",", 
            RowBox[{"galist", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "ProdTest"}], "]"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "galist", "]"}], ",", "1"}], "}"}]}], 
       "]"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{"dat1", ",", 
      RowBox[{"dat2", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "2"}], "}"}]}], "]"}], "]"}], ",", "2"}], "]"}], "//",
     "TableForm"}]}]}]], "Input",
 CellChangeTimes->{{3.892111330393669*^9, 3.8921113703258653`*^9}, {
   3.8921114855521097`*^9, 3.8921114891326914`*^9}, {3.8921115909252915`*^9, 
   3.89211160107533*^9}, {3.892112023350475*^9, 3.8921120715940514`*^9}, {
   3.8921121043874707`*^9, 3.892112190091645*^9}, {3.892112748834139*^9, 
   3.892112748933666*^9}, {3.8921130465455704`*^9, 3.8921130470314426`*^9}, {
   3.8921131989548674`*^9, 3.8921131992395306`*^9}, {3.892113256325259*^9, 
   3.892113256434625*^9}, {3.892113458241603*^9, 3.8921135323303742`*^9}, {
   3.892116361437076*^9, 3.8921163614848557`*^9}, {3.893257780692194*^9, 
   3.893257792940939*^9}, {3.893260545232792*^9, 3.893260566765787*^9}, {
   3.896953530728937*^9, 3.896953531233162*^9}, {3.896953744363188*^9, 
   3.8969537469343243`*^9}, {3.896953883310589*^9, 3.896953884008139*^9}, {
   3.896971240286153*^9, 3.896971246695673*^9}, {3.8969733757056828`*^9, 
   3.896973378633896*^9}, {3.8969760731711082`*^9, 3.896976348233163*^9}, {
   3.8969763786206193`*^9, 3.896976403680397*^9}, {3.8969764343671703`*^9, 
   3.8969764672032614`*^9}, 3.8972088334478965`*^9, 3.8972326136604834`*^9, 
   3.897233424756247*^9},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[2012]:=",ExpressionUUID->"355f1d40-5091-4a15-b861-9b41936c6fca"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.9029761053083076`*^9},ExpressionUUID->"27dc2e30-3449-4e35-910b-\
42f962577a5c"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.9029758227065983`*^9},
 CellLabel->
  "In[718]:=",ExpressionUUID->"bc333891-2081-4b8d-87d3-275e5ab39f76"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Differential number of events", "Subsection",
 CellChangeTimes->{{3.892111289211891*^9, 3.892111293865343*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"39584463-72ba-412f-9e9d-\
1b324a6d9ae6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "same", " ", "as", " ", "tableprefac", " ", "but", " ", "also",
     " ", "including", " ", "the", " ", "grid"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tableGridPrefac", "=", 
     RowBox[{
      RowBox[{"Hold", "@", 
       RowBox[{"Compile", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"tabb", ",", "_Real", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"mS", ",", "_Real"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c\[Tau]", ",", "_Real"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"zshift", ",", "_Real"}], "}"}]}], "}"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", "zshift"}], ")"}]}], 
                 "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Cos", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "*", "c\[Tau]", 
                   "*", 
                   FractionBox[
                    SqrtBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "2"], "-", 
                    SuperscriptBox["mS", "2"]}]], "mS"]}], ")"}]}], "]"}], 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "*", "c\[Tau]", "*", 
                FractionBox[
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "2"], "-", 
                   SuperscriptBox["mS", "2"]}]], "mS"]}]], 
              RowBox[{"#", "[", 
               RowBox[{"[", "4", "]"}], "]"}], "*", 
              RowBox[{"#", "[", 
               RowBox[{"[", "5", "]"}], "]"}]}]}], "}"}], "&"}], "/@", 
          "tabb"}], ",", 
         RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
         RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
         RowBox[{"Parallelization", "\[Rule]", "\"\<True\>\""}], ",", 
         RowBox[{"RuntimeAttributes", "\[Rule]", 
          RowBox[{"{", "Listable", "}"}]}]}], "]"}]}], "//", 
      "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Summation", " ", "returning", " ", "the", " ", "differential", " ", 
      "number", " ", "of", " ", "events", " ", "X"}], ",", " ", 
     RowBox[{"df", "/", "dX"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"NdiffCompiled", "=", 
    RowBox[{
     RowBox[{"Hold", "@", 
      RowBox[{"Compile", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"tabNdiff", ",", "_Real", ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"GridQuantity", ",", "_Real", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"LengthPerVariable", ",", "_Integer"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"NPoTtimesPprod", ",", "_Real"}], "}"}]}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"tabNdiff", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"LengthPerVariable", "*", 
                 RowBox[{"(", 
                  RowBox[{"i", "-", "1"}], ")"}]}], "+", "1"}], "]"}], "]"}], 
             "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"NPoTtimesPprod", "*", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"tabNdiff", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"LengthPerVariable", "*", 
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}]}], "+", "j"}], "]"}], 
                 "]"}], "[", 
                RowBox[{"[", "4", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", "LengthPerVariable", ",", "1"}], 
                "}"}]}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "GridQuantity", "]"}], ",", "1"}], "}"}]}],
          "]"}], ",", 
        RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
        RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
        RowBox[{"Parallelization", "\[Rule]", "\"\<True\>\""}]}], "]"}]}], "//",
      "ReleaseHold"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Variable", " ", "=", " ", 
      "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\""}], ",", 
     "\"\<\!\(\*SubscriptBox[\(x\), \(x\)]\)\>\"", ",", 
     RowBox[{
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", ".", " ", "The"}], 
      " ", "number", " ", "belongs", " ", "to", " ", "the", " ", "column", 
      " ", "in", " ", "the", " ", "tabulated", " ", "data"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"iVal", ":=", 
    RowBox[{"Association", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\"", " ", "\[Rule]", "2"}], 
       ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", "\[Rule]", "1"}], 
       ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(x\), \(x\)]\)\>\"", "\[Rule]", "3"}]}], 
      "}"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Differential", " ", "number", " ", "of", " ", "events"}], "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NeventsDifferentialDiscret", "[", 
     RowBox[{"m_", ",", "ProdChannel_", ",", "ga_", ",", "Variable_"}], "]"}],
     ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "NpotTimes\[Chi]val", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ival", "=", 
        RowBox[{"iVal", "[", "Variable", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"NpotTimes\[Chi]val", "=", 
        RowBox[{"NpotGivenExperiment", "*", 
         RowBox[{"\[Chi]Xtimes\[Chi]XtoALPphoton", "[", 
          RowBox[{"m", ",", "ga", ",", "ProdChannel"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tablegrid0", "=", 
        RowBox[{"TableIntegrandDiscret", "[", 
         RowBox[{"m", ",", "ProdChannel", ",", "\"\<True\>\""}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"\[CapitalDelta]xvals", ":=", 
        RowBox[{"Association", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\"", "\[Rule]", 
            "\[CapitalDelta]Evals"}], ",", 
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", "\[Rule]", 
            " ", "\[CapitalDelta]\[Theta]vals"}], ",", 
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(x\), \(X\)]\)\>\"", "\[Rule]", " ", 
            "\[CapitalDelta]zvals"}]}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[CapitalDelta]xval", "=", 
        RowBox[{"\[CapitalDelta]xvals", "[", "Variable", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"c\[Tau]Val", "=", 
        RowBox[{"c\[Tau]ALPphoton", "[", 
         RowBox[{"m", ",", "ga"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"brvis", "=", 
        RowBox[{"BrVis", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ilist", "=", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"{", 
          RowBox[{"ival", ",", "1", ",", "2", ",", "3"}], "}"}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"zshift", "=", 
        RowBox[{"zMinShift", "[", "ProdChannel", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tablegrid1", "=", 
        RowBox[{"SortBy", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"ilist", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"ilist", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"ilist", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "&"}], "/@", 
           RowBox[{"tableGridPrefac", "[", 
            RowBox[{
            "tablegrid0", ",", "m", ",", "c\[Tau]Val", ",", "zshift"}], 
            "]"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"GridQuantity", "=", 
        RowBox[{
         RowBox[{"tablegrid1", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", 
         "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"LengthPerVariable", "=", 
        RowBox[{
         RowBox[{"Length", "[", "tablegrid1", "]"}], "/", 
         RowBox[{"Length", "[", "GridQuantity", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tab1", "=", 
        RowBox[{"NdiffCompiled", "[", 
         RowBox[{
         "tablegrid1", ",", "GridQuantity", ",", "LengthPerVariable", ",", 
          RowBox[{"NpotTimes\[Chi]val", "*", "brvis"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"tab1", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", "1", "}"}]}], "]"}], "]"}], ",", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"tab1", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}], "*", 
            SuperscriptBox["\[CapitalDelta]xval", 
             RowBox[{"-", "1"}]]}], ",", "1"}], "]"}], ",", "2"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mvaltest", "=", "0.3"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gatest", "=", 
     SuperscriptBox["10", 
      RowBox[{"-", "6"}]]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"quantity", "=", "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"LegendX", ":=", 
    RowBox[{"Association", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\"", "\[Rule]", 
        "\"\<\!\(\*SubscriptBox[\(E\), \(a\)]\) [GeV]\>\""}], ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", "\[Rule]", 
        "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(a\)]\) [rad]\>\""}], ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(x\), \(X\)]\)\>\"", "\[Rule]", " ", 
        "\"\<\!\(\*SubscriptBox[\(z\), \(a\)]\) [m]\>\""}]}], "}"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"LegendY", ":=", 
    RowBox[{"Association", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\"", "\[Rule]", 
        "\"\<\!\(\*SubscriptBox[\(dN\), \(ev\)]\)/\!\(\*SubscriptBox[\(dE\), \
\(a\)]\) [\!\(\*SuperscriptBox[\(GeV\), \(-1\)]\)]\>\""}], ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", "\[Rule]", 
        "\"\<\!\(\*SubscriptBox[\(dN\), \(ev\)]\)/\!\(\*SubscriptBox[\(d\
\[Theta]\), \(a\)]\) [\!\(\*SuperscriptBox[\(rad\), \(-1\)]\)]\>\""}], ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(x\), \(X\)]\)\>\"", "\[Rule]", " ", 
        "\"\<\!\(\*SubscriptBox[\(dN\), \(ev\)]\)/\!\(\*SubscriptBox[\(dz\), \
\(a\)]\) [\!\(\*SuperscriptBox[\(m\), \(-1\)]\)]\>\""}]}], "}"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"prodlisttemp", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{"mamin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}], 
          "]"}], "<", "mvaltest", "<", 
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"mamax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"prodlisttemp", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"prodlisttemp", ",", 
            RowBox[{"{", "prod", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"NdiffData", "[", "prod", "]"}], "=", 
          RowBox[{"NeventsDifferentialDiscret", "[", 
           RowBox[{"mvaltest", ",", "prod", ",", "gatest", ",", "quantity"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"XvalminmaxNdiff", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"NdiffData", "[", "prod", "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ">", 
                SuperscriptBox["10", 
                 RowBox[{"-", "40"}]]}], "&"}]}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "MinMax"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"NdiffInt", "[", 
           RowBox[{"X_", ",", "prod"}], "]"}], "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"XvalminmaxNdiff", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "<", "X", "<", 
             RowBox[{"XvalminmaxNdiff", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"10", "^", 
              RowBox[{
               RowBox[{"Interpolation", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log10", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Log10", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "90"}]]}], "]"}]}], "}"}], "&"}], "/@", 
                  RowBox[{"NdiffData", "[", "prod", "]"}]}], ",", 
                 RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
               RowBox[{"Log10", "[", "X", "]"}], "]"}]}], "]"}], ",", "0"}], 
           "]"}]}]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NdiffInt", "[", 
      RowBox[{"X_", ",", "\"\<Total\>\""}], "]"}], "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"NdiffInt", "[", 
        RowBox[{"X", ",", "prod"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"prod", ",", "prodlisttemp"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LegendList", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", "\"\<Total\>\"", "}"}], ",", "prodlisttemp"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"QuantityMinMax", "=", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"MinMax", "[", 
          RowBox[{
           RowBox[{"NdiffData", "[", "prod", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"prod", ",", "prodlisttemp"}], "}"}]}], "]"}], ",", "1"}], 
      "]"}], "//", "MinMax"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ValueMinMax", "=", 
     RowBox[{"Max", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"NdiffData", "[", "#", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "&"}], "/@", 
       "prodlisttemp"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"LogLogPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NdiffInt", "[", 
         RowBox[{"X", ",", "prod"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "LegendList"}], "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"X", ",", 
       RowBox[{"QuantityMinMax", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"QuantityMinMax", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox["10", 
           RowBox[{"-", "5"}]], ",", 
          RowBox[{"2", "ValueMinMax"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Black"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Darker", "@", 
           RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Darker", "@", "Cyan"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Magenta"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Blue", ",", 
          RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Darker", "@", "Red"}], ",", 
          RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Darker", "@", 
           RowBox[{"Darker", "@", "Green"}]}], ",", 
          RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"Placed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"#", ",", "20"}], "]"}], "&"}], "/@", "LegendList"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.85", ",", "0.7"}], "}"}]}], "]"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"LegendX", "[", "quantity", "]"}], " ", ",", 
        RowBox[{"LegendY", "[", "quantity", "]"}]}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", " ", "23"}], "]"}]}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{
          "SelectedExperiment", ",", 
           "\"\<. \!\(\*SubscriptBox[\(m\), \(a\)]\) = \>\"", ",", " ", 
           "mvaltest", ",", 
           "\"\< GeV, \!\(\*SubscriptBox[\(g\), \(a\)]\) = \>\"", ",", " ", 
           RowBox[{"gatest", "//", "N"}], ",", 
           "\"\< \!\(\*SuperscriptBox[\(GeV\), \(-1\)]\)\>\""}], "}"}], "]"}],
         ",", "20", ",", "Black"}], "]"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8921163996135225`*^9, 3.8921164016036096`*^9}, {
   3.8921164560955544`*^9, 3.892116475031265*^9}, {3.892116516434699*^9, 
   3.8921165782759094`*^9}, {3.8921166461579666`*^9, 
   3.8921166470109124`*^9}, {3.8921167042134895`*^9, 3.892116729930051*^9}, {
   3.8927049818255663`*^9, 3.8927049991222277`*^9}, {3.8929115471019087`*^9, 
   3.892911593659387*^9}, {3.8929721720425777`*^9, 3.892972173350433*^9}, {
   3.8929722208773427`*^9, 3.8929722211847763`*^9}, {3.8932578131000147`*^9, 
   3.893257813645747*^9}, {3.8934746693595037`*^9, 3.893474675301323*^9}, {
   3.8935154039618015`*^9, 3.893515450284458*^9}, {3.893515943430369*^9, 
   3.893515962817915*^9}, 3.893516005738713*^9, {3.893516036174548*^9, 
   3.893516050479193*^9}, {3.893516088577403*^9, 3.893516089018369*^9}, {
   3.893516189974946*^9, 3.8935161902213464`*^9}, {3.8935162352543807`*^9, 
   3.8935162734266047`*^9}, {3.893516595793399*^9, 3.893516611219179*^9}, {
   3.893606026577932*^9, 3.8936060575609436`*^9}, 3.8955578364377675`*^9, {
   3.8969794021337876`*^9, 3.89697940417612*^9}, {3.897206579842867*^9, 
   3.897206594529684*^9}, {3.8972085445254173`*^9, 3.8972085493347607`*^9}, {
   3.897208919899889*^9, 3.897208931547951*^9}, {3.897232355781791*^9, 
   3.8972323557889285`*^9}, {3.897232650441552*^9, 3.8972326556138897`*^9}, {
   3.8972334458167295`*^9, 3.8972334518776407`*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[2018]:=",ExpressionUUID->"08eb9edb-e3c6-4de3-9811-d9dc1d320190"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Exporting tabulated number of events", "Title",
 CellChangeTimes->{{3.8850207904521627`*^9, 3.885020796464762*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"f5136f97-573d-41ec-bafe-\
cbcb903e581e"],

Cell[CellGroupData[{

Cell["Definitions", "Chapter",
 CellChangeTimes->{{3.8850542017641125`*^9, 3.885054203349573*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"75cf786b-3cae-4471-be7d-\
a8f2b6c6b657"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DirectoryQ", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<Tabulated Nevents\>\""}], "}"}], "]"}], "]"}], "//", 
       "ToString"}], ")"}], "\[Equal]", "\"\<False\>\""}], ",", 
    RowBox[{"CreateDirectory", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<Tabulated Nevents\>\""}], "}"}], "]"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DirectoryQ", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<Tabulated Nevents/ALPs with photon coupling\>\""}], "}"}], 
         "]"}], "]"}], "//", "ToString"}], ")"}], "\[Equal]", 
     "\"\<False\>\""}], ",", 
    RowBox[{"CreateDirectory", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<Tabulated Nevents/ALPs with photon coupling\>\""}], "}"}], "]"}],
      "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DirectoryQ", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<Tabulated Nevents/ALPs with photon coupling\>\"", ",", 
           "SelectedExperiment"}], "}"}], "]"}], "]"}], "//", "ToString"}], 
      ")"}], "\[Equal]", "\"\<False\>\""}], ",", 
    RowBox[{"CreateDirectory", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<Tabulated Nevents/ALPs with photon coupling\>\"", ",", 
        "SelectedExperiment"}], "}"}], "]"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<Filenames with tabulated \!\(\*SubscriptBox[\(N\), \(events\)]\):\>\"",
   "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"FilenameNevents", "[", "prod", "]"}], "=", 
    RowBox[{"ToString", "@", 
     RowBox[{"StringForm", "[", 
      RowBox[{"\"\<Nevents_ALP-photon_at_``_Npot=``_From_``.dat\>\"", ",", 
       RowBox[{"Sequence", "@@", 
        RowBox[{"{", 
         RowBox[{"SelectedExperiment", ",", 
          RowBox[{
           RowBox[{"NpotGivenExperiment", "//", "CForm"}], "//", "ToString"}],
           ",", 
          RowBox[{"ListExport", "[", "prod", "]"}]}], "}"}]}]}], "]"}]}]}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"prod", ",", "ProductionList"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"FilenameNevents", "[", "prod", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "//", 
  "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MassListALPphotonExport", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "0.021", ",", "0.03", ",", "0.04", ",", "0.05", ",", "0.06", ",", "0.07",
       ",", "0.08", ",", "0.09", ",", "0.1", ",", "0.11", ",", "0.12", ",", 
      "0.13", ",", "0.15", ",", "0.2", ",", "0.22", ",", "0.25", ",", "0.3", 
      ",", "0.35", ",", "0.4", ",", "0.5", ",", "0.55", ",", "0.6", ",", 
      "0.7", ",", "0.8", ",", "0.9", ",", "1", ",", "1.1", ",", "1.2", ",", 
      "1.3", ",", "1.4", ",", "1.5", ",", "1.6", ",", "1.7", ",", "1.8", ",", 
      "1.9", ",", "2.", ",", "2.1", ",", "2.2", ",", "2.3", ",", "2.4", ",", 
      "2.5", ",", "2.6", ",", "2.7", ",", "2.8", ",", "2.9", ",", "3.", ",", 
      "3.1", ",", "3.2", ",", "3.3", ",", "3.4", ",", "3.5"}], "}"}], "//", 
    "N"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"garange", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SuperscriptBox["10", "x"], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "12"}], ",", 
       RowBox[{"-", "2"}], ",", "0.02"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8850528402073092`*^9, 3.885052964529935*^9}, {
   3.8850529967024455`*^9, 3.88505313318991*^9}, {3.885053172661522*^9, 
   3.885053247354876*^9}, {3.885053717249408*^9, 3.8850537696983976`*^9}, {
   3.885054057416253*^9, 3.88505420740788*^9}, {3.8850542428480587`*^9, 
   3.885054257815028*^9}, {3.885054905514982*^9, 3.885054927992525*^9}, {
   3.88523276755499*^9, 3.885232776819412*^9}, {3.8854556204578223`*^9, 
   3.8854556494874506`*^9}, {3.8854560165278835`*^9, 
   3.8854561921232824`*^9}, {3.8854563516684437`*^9, 
   3.8854563631681647`*^9}, {3.885456439233843*^9, 3.885456605782855*^9}, {
   3.8854567400235205`*^9, 3.885456743964001*^9}, {3.885542660052145*^9, 
   3.8855427304549437`*^9}, {3.8855427881537523`*^9, 3.885542788237467*^9}, {
   3.8855430067620525`*^9, 3.885543013668437*^9}, {3.8857456752104797`*^9, 
   3.885745675220516*^9}, 3.8857460313253775`*^9, {3.8857468048699565`*^9, 
   3.8857468161665335`*^9}, {3.8857474466697216`*^9, 
   3.8857476005522413`*^9}, {3.8857504900473185`*^9, 3.885750492099847*^9}, {
   3.8858392383072577`*^9, 3.885839268137461*^9}, {3.892272862562935*^9, 
   3.892272925699341*^9}, {3.8922787139487624`*^9, 3.8922787801349196`*^9}, 
   3.892912334270548*^9, {3.89357085256485*^9, 3.893570861922758*^9}, {
   3.8937513515804434`*^9, 3.893751363168453*^9}, {3.895053205775363*^9, 
   3.895053229421281*^9}, {3.8950733209828496`*^9, 3.8950733232675557`*^9}, {
   3.8950740100492163`*^9, 3.895074016358959*^9}, {3.8950743743876824`*^9, 
   3.895074379025027*^9}, {3.8950745100163155`*^9, 3.8950745111007185`*^9}, {
   3.8950753328296204`*^9, 3.8950753333236*^9}, {3.8951282997797675`*^9, 
   3.8951283720189056`*^9}, {3.902764082511567*^9, 3.9027640831394043`*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[2034]:=",ExpressionUUID->"7723a626-82c5-4cfa-9029-8486e71b92ea"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Exporting", "Chapter",
 CellChangeTimes->{{3.885054212114191*^9, 3.885054213032151*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"e9258198-581c-4466-81fa-\
c2dce211dd65"],

Cell[CellGroupData[{

Cell["Common definition", "Section",
 CellChangeTimes->{{3.8921886043857117`*^9, 3.8921886076155424`*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"d18313fd-891f-4b57-be4b-\
ec06a2c36a1a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BlockExport", "[", "ProdChannel_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"ProductionList", ",", 
         RowBox[{
          RowBox[{"#", "\[Equal]", "ProdChannel"}], "&"}]}], "]"}], 
       "\[Equal]", 
       RowBox[{"{", "}"}]}], ",", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"masslist", "=", "MassListALPphotonExport"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"TabFrom", "=", 
        RowBox[{"Monitor", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"NeventsDiscret", "[", 
             RowBox[{
              RowBox[{"masslist", "[", 
               RowBox[{"[", "k", "]"}], "]"}], ",", "ProdChannel", ",", 
              "garange"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", 
              RowBox[{"Length", "[", "masslist", "]"}], ",", "1"}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"Row", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ProgressIndicator", "[", 
               RowBox[{"k", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"Length", "[", "masslist", "]"}]}], "}"}]}], "]"}], 
              ",", "\"\<i = \>\"", ",", "k", ",", "\"\</\>\"", ",", 
              RowBox[{"Length", "[", "masslist", "]"}], ",", "\"\<, m = \>\"",
               ",", 
              RowBox[{"masslist", "[", 
               RowBox[{"[", "k", "]"}], "]"}], ",", "\"\< GeV\>\""}], "}"}], 
            ",", "\"\< \>\""}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], ",", 
            "\"\<Tabulated Nevents/ALPs with photon coupling\>\"", ",", 
            "SelectedExperiment", ",", 
            RowBox[{"FilenameNevents", "[", "ProdChannel", "]"}]}], "}"}], 
          "]"}], ",", 
         RowBox[{"Flatten", "[", 
          RowBox[{"TabFrom", ",", "1"}], "]"}], ",", "\"\<Table\>\""}], 
        "]"}]}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8921886102299604`*^9, 3.892188661864987*^9}, {
  3.892188696661598*^9, 3.892188782889353*^9}, {3.8921888713769283`*^9, 
  3.8921888914281387`*^9}, {3.892190937661848*^9, 3.8921909466626697`*^9}, {
  3.8922765048644934`*^9, 3.8922765048725324`*^9}, {3.8922788078192115`*^9, 
  3.8922788297061825`*^9}, {3.892710885735086*^9, 3.892710895023276*^9}, {
  3.892711067756073*^9, 3.892711092685342*^9}, {3.892711422994956*^9, 
  3.8927114274762526`*^9}, {3.89507415228489*^9, 3.8950741590502415`*^9}, {
  3.902764085197337*^9, 3.902764085868745*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[2042]:=",ExpressionUUID->"86f71900-800f-4fb4-824d-efacfeb51a5b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["From pCoherent", "Section",
 CellChangeTimes->{{3.8850542186134644`*^9, 3.8850542291940546`*^9}, {
   3.8850543968830786`*^9, 3.8850543972568283`*^9}, {3.8854566349217353`*^9, 
   3.885456635821289*^9}, {3.8857505273324842`*^9, 3.8857505292399006`*^9}, 
   3.8922728626079893`*^9},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"ea35df86-1f74-459c-b50f-\
d9e15ebea561"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BlockExport", "[", "\"\<pCoherent\>\"", "]"}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.885054438676489*^9, 3.8850544565771933`*^9}, {
   3.885232743746546*^9, 3.8852327455696564`*^9}, {3.8854560165334034`*^9, 
   3.885456016535404*^9}, {3.8854561722106504`*^9, 3.8854561810253243`*^9}, {
   3.885456572039451*^9, 3.885456572042471*^9}, 3.8854567168132315`*^9, 
   3.885745675325362*^9, {3.8857460313269234`*^9, 3.885746031329915*^9}, {
   3.8857465522236977`*^9, 3.8857465522251997`*^9}, {3.885746804871951*^9, 
   3.885746804872999*^9}, 3.8857474599302654`*^9, 3.8857475137690907`*^9, {
   3.892272880978654*^9, 3.8922728809836407`*^9}, {3.89227884311539*^9, 
   3.892278862597023*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[2043]:=",ExpressionUUID->"8a8a9ffb-2c26-4fa7-ab09-097069ace5ee"]
}, Open  ]],

Cell[CellGroupData[{

Cell["From Primakov", "Section",
 CellChangeTimes->{{3.8850542186134644`*^9, 3.8850542193674097`*^9}, {
   3.8854566234521356`*^9, 3.8854566261318445`*^9}, {3.8857505339322834`*^9, 
   3.88575053652638*^9}, 3.8922729257248755`*^9},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"8c40accd-0a6a-412a-b047-\
73e5a007e9c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BlockExport", "[", "\"\<Primakov\>\"", "]"}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8922788579198313`*^9, 3.8922788608440104`*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[2044]:=",ExpressionUUID->"a37052cf-00dd-4d71-b2cb-241e04531080"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "From ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Pi]", "0"], TraditionalForm]],ExpressionUUID->
  "c3d0d928-cadf-40e5-a51e-1118c499a2f9"]
}], "Section",
 CellChangeTimes->{{3.892278871354845*^9, 3.892278874014264*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"cb4f246e-720d-4a3f-a151-\
92aa70c48153"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
   "BlockExport", "[", "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", 
    "]"}], ";"}], "//", "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8922788841127615`*^9, 3.8922788848875685`*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[2045]:=",ExpressionUUID->"fa4d7454-a05d-48dc-8a3d-82d48a38f059"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "From ",
 Cell[BoxData[
  FormBox["\[Eta]", TraditionalForm]],ExpressionUUID->
  "3e3db128-a9ee-4973-b300-cc2bfc3bcab2"]
}], "Section",
 CellChangeTimes->{{3.892278871354845*^9, 3.8922788802421875`*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"91025b27-36af-4600-9d14-\
75d9b86ab53c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BlockExport", "[", "\"\<\[Eta]\>\"", "]"}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.892278888727987*^9, 3.892278890465864*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[2046]:=",ExpressionUUID->"414e91a8-bb6d-402e-983f-1ba20aaae80d"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Computing sensitivities", "Title",
 CellChangeTimes->{{3.885020809493571*^9, 3.88502081261261*^9}},
 CellTags->{
  "Sensitivity", 
   "Re-evaluation"},ExpressionUUID->"2ce189e8-ece2-4e74-afba-65f86fa4e6b1"],

Cell[CellGroupData[{

Cell["\<\
Specifying the experiment and interpolating the tabulated number of events\
\>", "Chapter",
 CellChangeTimes->{{3.8865657605515084`*^9, 3.886565789800824*^9}, {
  3.889154717919751*^9, 3.88915472812621*^9}},
 CellTags->{
  "Sensitivity", 
   "Re-evaluation"},ExpressionUUID->"43aaf14b-3679-4a8d-8cd6-8b3aed1902b0"],

Cell[BoxData[{
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"DirectoryQ", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", 
          "\"\<Sensitivity domains\>\""}], "}"}], "]"}], "]"}], "//", 
      "ToString"}], ")"}], "\[Equal]", "\"\<False\>\""}], ",", 
   RowBox[{"CreateDirectory", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", 
       "\"\<Sensitivity domains\>\""}], "}"}], "]"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"DirectoryQ", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", 
          "\"\<Sensitivity domains\>\"", ",", 
          "\"\<ALPs with photon coupling\>\""}], "}"}], "]"}], "]"}], "//", 
      "ToString"}], ")"}], "\[Equal]", "\"\<False\>\""}], ",", 
   RowBox[{"CreateDirectory", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", 
       "\"\<Sensitivity domains\>\"", ",", 
       "\"\<ALPs with photon coupling\>\""}], "}"}], "]"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NeventsDirectory", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<Tabulated Nevents\>\"", ",", "\"\<ALPs with photon coupling\>\""}],
      "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentDirectoriesListNevents", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"FileNames", "[", 
      RowBox[{"\"\<*\>\"", ",", "NeventsDirectory", ",", "1"}], "]"}], ",", 
     "DirectoryQ"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<List of available experiments with tabulated \!\(\*SubscriptBox[\(N\), \
\(events\)]\) for ALPs with the coupling to photons:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentsListNevents", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"FileNameTake", "[", 
       RowBox[{
        RowBox[{"ExperimentDirectoriesListNevents", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "ExperimentDirectoriesListNevents", "]"}], ",",
         "1"}], "}"}]}], "]"}], "//", "Sort"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ExperimentsListNevents", "//", "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", "ExperimentsListNevents", "]"}], "\[Equal]", "0"}],
    ",", 
   RowBox[{
   "Print", "[", 
    "\"\<No experiment is available, generate first the acceptance for the \
given experiment using module 1\>\"", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Selected experiment:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", "ExperimentsListNevents", "]"}], "\[NotEqual]", 
    "0"}], ",", 
   RowBox[{"GivenExperimentForSensitivityComputation", "=", 
    RowBox[{"dropdownDialog", "[", 
     RowBox[{
     "ExperimentsListNevents", ",", "\"\<Select the experiment:\>\""}], 
     "]"}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CondANUBIS", "=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<ANUBIS-shaft-volume-1\>\"", ",", "\"\<ANUBIS-shaft-volume-2\>\"", 
       ",", "\"\<ANUBIS-shaft-volume-3\>\""}], "}"}], ",", 
     "GivenExperimentForSensitivityComputation"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"CondANUBIS", "\[Equal]", "True"}], ",", 
   RowBox[{"infoDialog", "[", 
    RowBox[{"Row", "[", 
     RowBox[{
     "{", "\"\<One of the modules of ANUBIS-shaft is chosen. The full \
sensitivity includes three modules. The importing will be over all modules, \
so for all ot the the sensitivity has to be computed\>\"", "}"}], "]"}], 
    "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"CondANUBIS", "\[Equal]", "False"}], ",", 
    RowBox[{"GivenExperimentForSensitivityComputationList", "=", 
     RowBox[{"{", "GivenExperimentForSensitivityComputation", "}"}]}], ",", 
    RowBox[{"GivenExperimentForSensitivityComputationList", "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\<ANUBIS-shaft-volume-1\>\"", ",", "\"\<ANUBIS-shaft-volume-2\>\"", 
       ",", "\"\<ANUBIS-shaft-volume-3\>\""}], "}"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filesNevents", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"filesNevents", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"filesNevents", ",", 
       RowBox[{"FileNames", "[", 
        RowBox[{"\"\<*.dat\>\"", ",", 
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], ",", 
            "\"\<Tabulated Nevents/ALPs with photon coupling\>\"", ",", 
            "exp"}], "}"}], "]"}]}], "]"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "GivenExperimentForSensitivityComputationList"}], 
     "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Production channels:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FilenamesNevents", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Last", "@", 
      RowBox[{"FileNameSplit", "@", 
       RowBox[{"filesNevents", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "filesNevents", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FilenameParameters", "[", "i_", "]"}], ":=", 
  RowBox[{
   RowBox[{"StringCases", "[", 
    RowBox[{
     RowBox[{"FilenamesNevents", "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{
      "\"\<Nevents_ALP-photon_at_\>\"", "~~", "experiment__", "~~", 
       "\"\<_Npot=\>\"", "~~", "Npot__", "~~", "\"\<_From_\>\"", "~~", 
       "mother__", "~~", "\"\<.dat\>\""}], ":>", 
      RowBox[{"{", 
       RowBox[{"experiment", ",", "Npot", ",", "mother"}], "}"}]}]}], "]"}], 
   "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductionChannelsList", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"FilenameParameters", "[", "i", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "FilenamesNevents", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Experiment\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(N\), \(PoT\)]\)\>\"", ",", 
       "\"\<Mother particle\>\""}], "}"}], "}"}], ",", 
    "ProductionChannelsList"}], "]"}], "//", 
  "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NpotDefault", "=", 
   RowBox[{
    RowBox[{"Interpreter", "[", "\"\<Number\>\"", "]"}], "[", 
    RowBox[{
     RowBox[{"ProductionChannelsList", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NeventsTabulatedList", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{"filesNevents", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<Table\>\""}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "filesNevents", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IfzeroList", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"NeventsTabulatedList", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ">", 
              SuperscriptBox["10", 
               RowBox[{"-", "5"}]]}], "&"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}], "==", "0"}], ",", 
       "0", ",", "1"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "NeventsTabulatedList", "]"}], ",", "1"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NeventsTabulatedList", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"IfzeroList", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "==", "1"}], ",", 
         RowBox[{"NeventsTabulatedList", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "IfzeroList", "]"}], ",", "1"}], "}"}]}], 
      "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"{", "Null", "}"}], ",", "#"}], "]"}], "==", "False"}], 
      "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mminmaxTabulated", "[", "i_", "]"}], ":=", 
  RowBox[{"MinMax", "[", 
   RowBox[{
    RowBox[{"NeventsTabulatedList", "[", 
     RowBox[{"[", "i", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gaminmaxtabulated", "[", "i_", "]"}], ":=", 
  RowBox[{"MinMax", "[", 
   RowBox[{
    RowBox[{"NeventsTabulatedList", "[", 
     RowBox[{"[", "i", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mminmaxOverall", "=", 
   RowBox[{"MinMax", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"mminmaxTabulated", "[", "i", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "NeventsTabulatedList", "]"}], ",", "1"}], 
        "}"}]}], "]"}], "//", "Flatten"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gaminmaxoverall", "=", 
   RowBox[{"MinMax", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"gaminmaxtabulated", "[", "i", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "NeventsTabulatedList", "]"}], ",", "1"}], 
        "}"}]}], "]"}], "//", "Flatten"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nevint", "[", "i_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"mminmaxTabulated", "[", "i", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", " ", "ma", 
      "\[LessEqual]", 
      RowBox[{
       RowBox[{"mminmaxTabulated", "[", "i", "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "&&", 
     RowBox[{
      RowBox[{
       RowBox[{"gaminmaxtabulated", "[", "i", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", "ga", "\[LessEqual]", 
      " ", 
      RowBox[{
       RowBox[{"gaminmaxtabulated", "[", "i", "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
    RowBox[{"Evaluate", "[", 
     RowBox[{"10", "^", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Log10", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
              RowBox[{"Log10", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
              RowBox[{"Log10", "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "+", 
                SuperscriptBox["10", 
                 RowBox[{"-", "90"}]]}], "]"}]}], "}"}], "&"}], "/@", 
           RowBox[{"NeventsTabulatedList", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
        RowBox[{
         RowBox[{"Log10", "[", "ma", "]"}], ",", 
         RowBox[{"Log10", "[", "ga", "]"}]}], "]"}], ")"}]}], "]"}], ",", 
    "0"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NevIntList", "[", 
    RowBox[{"ma_", ",", "ga_"}], "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Nevint", "[", "i", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "NeventsTabulatedList", "]"}], ",", "1"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NevTot", "[", 
    RowBox[{"ma_", ",", "ga_"}], "]"}], "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NevIntList", "[", 
       RowBox[{"ma", ",", "ga"}], "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"NevIntList", "[", 
         RowBox[{"ma", ",", "ga"}], "]"}], "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentFolder", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"CondANUBIS", "\[Equal]", "True"}], ",", "\"\<ANUBIS-shaft\>\"", 
     ",", "GivenExperimentForSensitivityComputation"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"DirectoryQ", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", 
          "\"\<Sensitivity domains\>\"", ",", 
          "\"\<ALPs with photon coupling\>\"", ",", "ExperimentFolder"}], 
         "}"}], "]"}], "]"}], "//", "ToString"}], ")"}], "\[Equal]", 
    "\"\<False\>\""}], ",", 
   RowBox[{"CreateDirectory", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", 
       "\"\<Sensitivity domains\>\"", ",", 
       "\"\<ALPs with photon coupling\>\"", ",", "ExperimentFolder"}], "}"}], 
     "]"}], "]"}]}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8889934219191484`*^9, 3.8889934572936487`*^9}, {
   3.888993488436164*^9, 3.8889935196298246`*^9}, {3.888993631131192*^9, 
   3.8889936317673717`*^9}, {3.8889941168931828`*^9, 3.888994131488901*^9}, {
   3.8891549520226474`*^9, 3.8891549556386333`*^9}, {3.88915555629116*^9, 
   3.889155565695465*^9}, {3.8895084441592464`*^9, 3.88950848292002*^9}, {
   3.889509352181006*^9, 3.8895093563242207`*^9}, {3.8922769699715986`*^9, 
   3.8922769699785786`*^9}, {3.8932344848304768`*^9, 
   3.8932344926744194`*^9}, {3.893524041312335*^9, 3.8935241093153987`*^9}, {
   3.8935243601202497`*^9, 3.8935246116292768`*^9}, {3.8935246446973963`*^9, 
   3.893524645238715*^9}, {3.8935250440102005`*^9, 3.893525092373968*^9}, {
   3.8935251324636583`*^9, 3.8935252476255293`*^9}, {3.8935264147517986`*^9, 
   3.8935264378013945`*^9}, 3.8935708730165973`*^9, {3.8935713170108175`*^9, 
   3.8935713399020805`*^9}, 3.893572137314477*^9, {3.8935723871079187`*^9, 
   3.893572429893603*^9}, {3.8935725697442427`*^9, 3.89357257025113*^9}, 
   3.8937510697923756`*^9, {3.8950532372268724`*^9, 3.8950532712242327`*^9}, {
   3.895075270198239*^9, 3.8950752861635647`*^9}, {3.8968466164692364`*^9, 
   3.8968466260365763`*^9}, 3.8991933875499215`*^9, {3.905403902014756*^9, 
   3.905403902264286*^9}},
 CellTags->{
  "Sensitivity", 
   "Re-evaluation"},ExpressionUUID->"5b921f97-5946-4ee1-8075-ebfec4e411f1"],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["N", "events"], " ", "density", " ", "plot"}], 
  TraditionalForm]],ExpressionUUID->"108c81bc-402b-40a9-a4ea-cf954928678b"]], \
"Section",
 CellChangeTimes->{{3.892912347639474*^9, 3.892912350688761*^9}},
 CellTags->{
  "Sensitivity", 
   "Re-evaluation"},ExpressionUUID->"ed466a31-2eaa-42f8-854b-b87cbbc1a9b0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Nevmax", "=", 
   RowBox[{"Max", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Max", "[", 
       RowBox[{"NeventsTabulatedList", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "NeventsTabulatedList", "]"}], ",", "1"}], 
       "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"plot", "=", 
  RowBox[{"DensityPlot", "[", 
   RowBox[{
    RowBox[{"Evaluate", "[", 
     RowBox[{"Log10", "[", 
      RowBox[{"NevTot", "[", 
       RowBox[{"ma", ",", "ga"}], "]"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"ma", ",", 
      RowBox[{"mminmaxOverall", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"mminmaxOverall", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"ga", ",", 
      RowBox[{"gaminmaxoverall", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"gaminmaxoverall", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"ScalingFunctions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Log\>\"", ",", "\"\<Log\>\""}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "0.78"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"All", ",", "All", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log10", "[", "2.3", "]"}], ",", 
         RowBox[{"Log10", "[", "Nevmax", "]"}]}], "}"}]}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(m\), \(a\)]\) [GeV]\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(g\), \(a\)]\) [\!\(\*SuperscriptBox[\(GeV\), \
\(-1\)]\)]\>\""}], "}"}]}], ",", " ", 
    RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", " ", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", " ", "25"}], "]"}]}], ",", 
    RowBox[{"PlotPoints", "\[Rule]", "100"}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"Placed", "[", 
      RowBox[{
       RowBox[{"BarLegend", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Automatic", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Log10", "[", "2.3", "]"}], ",", 
             RowBox[{"Log10", "[", "Nevmax", "]"}]}], "}"}]}], "}"}], ",", 
         RowBox[{"LegendMarkerSize", "\[Rule]", "340"}], ",", 
         RowBox[{"LegendLabel", "\[Rule]", 
          RowBox[{"Placed", "[", 
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(Log\), \
\(10\)]\)[\!\(\*SubscriptBox[\(N\), \(ev\)]\)]\>\"", ",", "Bottom"}], "]"}]}],
          ",", 
         RowBox[{"LabelStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"FontSize", "\[Rule]", "22"}], "}"}]}], ",", 
         RowBox[{"Method", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
            RowBox[{"AxesStyle", "\[Rule]", "None"}], ",", 
            RowBox[{"TicksStyle", "\[Rule]", "Black"}]}], "}"}]}]}], "]"}], 
       ",", "Right"}], "]"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{"{", "ExperimentFolder", "}"}], "]"}], ",", "20", ",", 
       "Black"}], "]"}]}]}], 
   RowBox[{"(*", 
    RowBox[{",", 
     RowBox[{"FrameTicks", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Automatic", ",", "Automatic"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"TicksPlotx", ",", "None"}], "}"}]}], "}"}]}]}], "*)"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<NeventsDensityPlotExample.pdf\>\""}], "}"}], "]"}], ",", 
     "plot"}], "]"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.892912379570565*^9, 3.892912408121956*^9}, 
   3.893526239024089*^9, {3.893526449821302*^9, 3.8935264520546904`*^9}, {
   3.893571339685706*^9, 3.893571339688264*^9}, {3.8937510796411624`*^9, 
   3.8937510828916693`*^9}, {3.895074857353557*^9, 3.8950748846507916`*^9}},
 CellTags->{"Sensitivity", "Re-evaluation"},
 CellLabel->
  "In[2169]:=",ExpressionUUID->"255e1417-788a-4b69-a56b-a50d09ff97ba"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Sensitivity computation", "Chapter",
 CellChangeTimes->{{3.8889936571476183`*^9, 3.8889936597112193`*^9}},
 CellTags->{
  "Sensitivity", 
   "Re-evaluation"},ExpressionUUID->"742f7a10-6bda-4531-8fc5-a3f03e574d3b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SensitivityBlock", "[", 
   RowBox[{"Nev_", ",", "Npot_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RegSens", "=", 
      RowBox[{"RegionPlot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          FractionBox["Npot", "NpotDefault"], "*", 
          RowBox[{"NevTot", "[", 
           RowBox[{
            SuperscriptBox["10", "ma"], ",", 
            SuperscriptBox["10", "ga"]}], "]"}]}], "\[GreaterEqual]", "Nev"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"ma", ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"mminmaxOverall", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"mminmaxOverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"ga", ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"gaminmaxoverall", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"gaminmaxoverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotPoints", "\[Rule]", "30"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SensTemp", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"Normal", "@", "RegSens"}], ",", 
        RowBox[{
         RowBox[{"Line", "[", "x_", "]"}], "\[RuleDelayed]", "x"}], ",", 
        "Infinity"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Sens", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"10", "^", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"10", "^", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], "&"}], "/@", 
         RowBox[{"SensTemp", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "SensTemp", "]"}], ",", "1"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", 
          "\"\<Sensitivity domains\>\"", ",", 
          "\"\<ALPs with photon coupling\>\"", ",", "ExperimentFolder", ",", 
          RowBox[{"ToString", "@", 
           RowBox[{"StringForm", "[", 
            RowBox[{
            "\"\<Sensitivity_ALP-photon_at_``_Nev=``_Npot=``.xls\>\"", ",", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"{", 
               RowBox[{"ExperimentFolder", ",", 
                RowBox[{"Nev", "//", "ToString"}], ",", 
                RowBox[{
                 RowBox[{"Npot", "//", "CForm"}], "//", "ToString"}]}], 
               "}"}]}]}], "]"}]}]}], "}"}], "]"}], ",", "Sens"}], "]"}], ";", 
     "\[IndentingNewLine]", "Sens"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BC9exc", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<contours/BC9/BC9-excluded.txt\>\""}], "}"}], "]"}], ",", 
     "\"\<Table\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<The number of proton collisions:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"NpotVal", "=", 
  RowBox[{
   RowBox[{"DialogInput", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"br", "=", "NpotDefault"}], "}"}], ",", 
     RowBox[{"Column", "[", 
      RowBox[{"{", 
       RowBox[{"\"\<Enter the number of proton collisions\>\"", ",", 
        RowBox[{"InputField", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "br", "]"}], ",", "Expression"}], "]"}], 
        ",", 
        RowBox[{"Button", "[", 
         RowBox[{"\"\<Proceed\>\"", ",", 
          RowBox[{"DialogReturn", "[", "br", "]"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Automatic"}]}], "]"}]}], "}"}], 
      "]"}]}], "]"}], "//", "N"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<The minimal number of events \!\(\*SubscriptBox[\(N\), \(events, \
min\)]\) for which the sensitivity will be computed:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"NevMinVal", "=", 
  RowBox[{
   RowBox[{"DialogInput", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nev", "=", "2.3"}], "}"}], ",", 
     RowBox[{"Column", "[", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Enter the value of \!\(\*SubscriptBox[\(N\), \(events, min\)]\) \
for which the sensitivity will be computed:\>\"", ",", 
        RowBox[{"InputField", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "nev", "]"}], ",", "Expression"}], "]"}], 
        ",", 
        RowBox[{"Button", "[", 
         RowBox[{"\"\<Proceed\>\"", ",", 
          RowBox[{"DialogReturn", "[", "nev", "]"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Automatic"}]}], "]"}]}], "}"}], 
      "]"}]}], "]"}], "//", "N"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sens", "=", 
   RowBox[{"SensitivityBlock", "[", 
    RowBox[{"NevMinVal", ",", "NpotVal"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListLogLogPlot", "[", 
    RowBox[{
     RowBox[{"Cases", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"sens", ",", "BC9exc"}], "}"}], ",", 
       RowBox[{"_", "?", "MatrixQ"}], ",", "All"}], "]"}], ",", 
     RowBox[{"Joined", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"True", ",", "True", ",", "True", ",", "True"}], "}"}]}], ",", 
     " ", 
     RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(m\), \(a\)]\) [GeV]\>\"", " ", ",", " ", 
        "\"\<\!\(\*SubscriptBox[\(g\), \(a\)]\) \
[\!\(\*SuperscriptBox[\(GeV\), \(-1\)]\)]\>\""}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", " ", "23"}], "]"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ConstantArray", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MatrixQ", "[", "sens", "]"}], ",", "1", ",", 
              RowBox[{"Length", "@", "sens"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Thick", ",", "Gray"}], "}"}], ",", "1"}], "]"}]}], 
         "}"}], ",", "1"}], "]"}]}], ",", 
     RowBox[{"Filling", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "sens", "]"}], "+", "1"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Top", ",", 
          RowBox[{"Directive", "[", 
           RowBox[{"Gray", ",", 
            RowBox[{"Opacity", "[", "0.3", "]"}]}], "]"}]}], "}"}]}], "}"}]}],
      ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1.01", 
           RowBox[{"mminmaxOverall", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"1.1", 
           RowBox[{"mminmaxOverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"gaminmaxoverall", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            SuperscriptBox["10", 
             RowBox[{"-", "8"}]]}], "]"}], ",", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"0.99", 
             RowBox[{"gaminmaxoverall", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            SuperscriptBox["10", 
             RowBox[{"-", "2"}]]}], "]"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{
          "\"\<\!\(\*SubscriptBox[\(N\), \(events\)]\) \[GreaterEqual] \>\"", 
           ",", "NevMinVal"}], "}"}], "]"}], ",", "18", ",", "Black"}], 
       "]"}]}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"Placed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"#", ",", "15"}], "]"}], "&"}], "/@", 
         RowBox[{"{", "ExperimentFolder", "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"0.2", ",", "0.15"}], "}"}]}], "]"}]}]}], "]"}], 
   RowBox[{"(*", 
    RowBox[{",", 
     RowBox[{"LogLogPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", 
         SuperscriptBox["x", "2"], ",", 
         SuperscriptBox["x", "3"], ",", 
         SuperscriptBox["x", "4"], ",", 
         SuperscriptBox["x", "5"], ",", 
         SuperscriptBox["x", "6"]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0.05", ",", "62.49"}], "}"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.006", "]"}], ",", "Blue"}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.006", "]"}], ",", 
            RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.006", "]"}], ",", 
            RowBox[{"Darker", "@", "Red"}], ",", 
            RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.006", "]"}], ",", "Black"}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.01", "]"}], ",", 
            RowBox[{"Darker", "@", "Cyan"}], ",", 
            RowBox[{"Dashing", "[", "0.007", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", 
             RowBox[{"Darker", "@", "Green"}]}], ",", 
            RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", "Red"}]}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"#", ",", "15"}], "]"}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{
            "\"\<SHiP\>\"", ",", 
             "\"\<\!\(\*SubscriptBox[\(SHADOWS\), \(specified\\\ in\\\ LoI\)]\
\)\>\"", ",", 
             "\"\<\!\(\*SubscriptBox[\(SHADOWS\), \(specified\\\ by\\\ \
Gaia\)]\)\>\"", ",", " ", 
             "\"\<\!\(\*SubscriptBox[\(SHADOWS\), \(collab\\\ estimate\)]\)\>\
\""}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"0.26", ",", "0.15"}], "}"}]}], "]"}]}]}], "]"}]}], "*)"}],
    ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{"Text", "[", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"\"\<Excluded\>\"", ",", "24", ",", "Black"}], "]"}], ",", 
       RowBox[{"Scaled", "[", 
        RowBox[{"{", 
         RowBox[{"0.7", ",", "0.95"}], "}"}], "]"}]}], "]"}], "}"}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8889936997762337`*^9, 3.8889937382921906`*^9}, {
   3.88899385262287*^9, 3.888993853042823*^9}, {3.8889939031947403`*^9, 
   3.8889939052817664`*^9}, {3.8889939588761787`*^9, 3.888994072394391*^9}, {
   3.8889941392721796`*^9, 3.8889941490041194`*^9}, {3.8889941930377913`*^9, 
   3.888994195131672*^9}, {3.8889942375929303`*^9, 3.888994293018688*^9}, 
   3.889155194091461*^9, {3.8891555444676304`*^9, 3.889155549549215*^9}, {
   3.8895085261021676`*^9, 3.8895085304810085`*^9}, {3.889508590213485*^9, 
   3.889508672502302*^9}, {3.889509235833849*^9, 3.889509245020251*^9}, 
   3.88950942091127*^9, {3.892276969991042*^9, 3.892276969998666*^9}, {
   3.8935262462252254`*^9, 3.8935262529369063`*^9}, {3.8935265499464674`*^9, 
   3.8935265503488092`*^9}, {3.893571339691801*^9, 3.8935713396999893`*^9}, 
   3.8937547419566717`*^9, {3.895053055776411*^9, 3.8950530989740524`*^9}, {
   3.895075030833277*^9, 3.8950750315874023`*^9}, {3.8951246431380773`*^9, 
   3.8951246449600024`*^9}, {3.8956550073948264`*^9, 3.895655106569532*^9}, 
   3.895655141064495*^9, {3.896155184831273*^9, 3.8961552168930655`*^9}, 
   3.906194615223667*^9, {3.9072587825379424`*^9, 3.9072587857841225`*^9}},
 CellTags->{
  "Sensitivity", 
   "Re-evaluation"},ExpressionUUID->"e42c711e-a973-46f4-88a9-717948c379ae"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Deleting generated cells", "Title",
 CellChangeTimes->{{3.9025559465149946`*^9, 3.9025559494966087`*^9}},
 CellTags->{
  "Sensitivity", 
   "Re-evaluation"},ExpressionUUID->"268b5966-c044-471d-8d66-d25b1ca611fc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"relaunch", "=", 
  RowBox[{"dropdownDialog", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\"\<Yes\>\"", ",", "\"\<No\>\""}], "}"}], ",", 
    RowBox[{"Row", "[", 
     RowBox[{
     "{", "\"\<Would you like to re-launch the sensitivity calculation for \
another experiment after the given computation?\>\"", "}"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"relaunch", "==", "\"\<Yes\>\""}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nb", "=", 
     RowBox[{"EvaluationNotebook", "[", "]"}]}], ";", "\n", 
    RowBox[{"NotebookFind", "[", 
     RowBox[{
     "nb", ",", "\"\<Re-evaluation\>\"", ",", "All", ",", "CellTags"}], "]"}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"relaunch", "==", "\"\<No\>\""}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"deletecellsopt", "=", 
     RowBox[{"dropdownDialog", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<Yes\>\"", ",", "\"\<No\>\""}], "}"}], ",", 
       RowBox[{"Row", "[", 
        RowBox[{
        "{", "\"\<Would you like to remove all the generated output \
cells?\>\"", "}"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"deletecellsopt", "==", "\"\<Yes\>\""}], ",", 
      RowBox[{
      "FrontEndTokenExecute", "[", "\"\<DeleteGeneratedCells\>\"", "]"}]}], 
     "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.9025559062888603`*^9, 3.9025559062888603`*^9}, {
  3.902555964086707*^9, 3.902555989355214*^9}, {3.9027629060419035`*^9, 
  3.9027629063187804`*^9}, {3.902766994175357*^9, 3.9027669973698597`*^9}, {
  3.9028940792862453`*^9, 3.902894096713217*^9}, {3.9039717672337112`*^9, 
  3.903971767738082*^9}},
 CellTags->{"Sensitivity", "Re-evaluation"},
 CellLabel->
  "In[2179]:=",ExpressionUUID->"00a97c9c-fda1-4a59-a10c-e35c97e449fb"]
}, Open  ]]
},
WindowSize->{1142.1, 570.6},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
ShowCellTags->True,
Magnification:>0.7 Inherited,
FrontEndVersion->"13.2 for Microsoft Windows (64-bit) (November 18, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"0f92d964-5ec2-4e41-a9a5-cb2a98b673f0"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Number-of-events"->{
  Cell[5612, 155, 331, 6, 77, "Title",ExpressionUUID->"c7fbc496-1765-4913-bda1-eb19f9d14ec4",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[5968, 165, 263, 5, 58, "Chapter",ExpressionUUID->"8348c717-8fb9-4ff9-be33-c78045c51d6d",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[6256, 174, 491, 8, 57, "Section",ExpressionUUID->"990662f6-15c3-4f39-ae61-2c8fc1bd4b2e",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[6772, 186, 224, 4, 47, "Subsection",ExpressionUUID->"fe07c9af-c0ec-4b3b-bc4f-1be41c5cf7b2",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[6999, 192, 1769, 46, 70, "Input",ExpressionUUID->"eb8c0f16-2688-4f53-8f87-c697473ee20c",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[8805, 243, 339, 6, 47, "Subsection",ExpressionUUID->"3dd7b844-8e27-44cd-bb8b-37dac39065de",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[9169, 253, 4978, 128, 323, "Input",ExpressionUUID->"6d5dcc26-d814-4435-9237-3d68cd75ad0c",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[14172, 385, 2416, 67, 31, "Print",ExpressionUUID->"ab462dae-c2ce-4275-b896-7854a5100ace",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[16591, 454, 1201, 30, 31, "Print",ExpressionUUID->"a864dc8e-66b6-45a5-9c74-46f9adf345cd",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[17795, 486, 1204, 33, 31, "Print",ExpressionUUID->"f48fb368-d1f8-4e53-9490-07ca85066604",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[19002, 521, 382, 8, 29, "Print",ExpressionUUID->"cebb1ed7-6813-4bf9-8897-6321f529e20b",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[19387, 531, 383, 8, 29, "Print",ExpressionUUID->"87a09b43-9bc1-4078-bc81-8b1a9f8870e6",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[19773, 541, 370, 8, 29, "Print",ExpressionUUID->"8b60106e-86d5-4cd1-89f5-be7d9eb896c2",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[20146, 551, 245, 5, 27, "Print",ExpressionUUID->"012c9c9b-36dd-4dc5-81c7-8711a1e1702b",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[20406, 559, 315, 7, 51, "Output",ExpressionUUID->"4b3491e6-1fa9-4160-b356-da6577b023d7",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[20794, 574, 243, 6, 58, "Chapter",ExpressionUUID->"9930ec21-c32c-4ff4-b23e-d5a85d028d42",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[21062, 584, 230, 5, 57, "Section",ExpressionUUID->"1a702223-c453-446a-8188-00f344c9fa89",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[21295, 591, 7720, 184, 191, "Input",ExpressionUUID->"f207a765-7cde-4e75-8a61-076a1dd78c3a",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[29052, 780, 255, 5, 57, "Section",ExpressionUUID->"53079a8e-45a4-48ec-9cb4-0078005932ef",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[29310, 787, 7577, 182, 191, "Input",ExpressionUUID->"1da2f8fa-b047-4f2d-b683-584cace5a4a8",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[36948, 976, 221, 4, 60, "Title",ExpressionUUID->"918dc508-7b59-4717-9363-a48741db503f",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[37194, 984, 6657, 171, 296, "Input",ExpressionUUID->"a9dc099a-58c7-4b4a-87b0-fae273cf5733",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[43854, 1157, 340, 7, 70, "Output",ExpressionUUID->"fc074c24-928f-4033-bf16-8876b6c97ae8",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[44197, 1166, 279, 6, 70, "Print",ExpressionUUID->"d9540334-e4a4-4525-ac00-81141f0c3b7e",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[44479, 1174, 265, 5, 70, "Output",ExpressionUUID->"50d94629-a31c-47bb-b6ba-3f573c796b2f",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[44781, 1184, 224, 4, 58, "Chapter",ExpressionUUID->"389ee8eb-49d3-4272-aea6-a6f7b184662e",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[45030, 1192, 2028, 48, 217, "Input",ExpressionUUID->"bc53587b-88a1-4f20-8274-cad588e7d06d",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[47061, 1242, 1146, 30, 70, "Output",ExpressionUUID->"c12d5fa5-616d-46b2-a1f0-27544ecf494b",
   CellTags->{"Number-of-events", "Acceptance"}]},
 "Acceptance"->{
  Cell[5612, 155, 331, 6, 77, "Title",ExpressionUUID->"c7fbc496-1765-4913-bda1-eb19f9d14ec4",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[5968, 165, 263, 5, 58, "Chapter",ExpressionUUID->"8348c717-8fb9-4ff9-be33-c78045c51d6d",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[6256, 174, 491, 8, 57, "Section",ExpressionUUID->"990662f6-15c3-4f39-ae61-2c8fc1bd4b2e",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[6772, 186, 224, 4, 47, "Subsection",ExpressionUUID->"fe07c9af-c0ec-4b3b-bc4f-1be41c5cf7b2",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[6999, 192, 1769, 46, 70, "Input",ExpressionUUID->"eb8c0f16-2688-4f53-8f87-c697473ee20c",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[8805, 243, 339, 6, 47, "Subsection",ExpressionUUID->"3dd7b844-8e27-44cd-bb8b-37dac39065de",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[9169, 253, 4978, 128, 323, "Input",ExpressionUUID->"6d5dcc26-d814-4435-9237-3d68cd75ad0c",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[14172, 385, 2416, 67, 31, "Print",ExpressionUUID->"ab462dae-c2ce-4275-b896-7854a5100ace",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[16591, 454, 1201, 30, 31, "Print",ExpressionUUID->"a864dc8e-66b6-45a5-9c74-46f9adf345cd",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[17795, 486, 1204, 33, 31, "Print",ExpressionUUID->"f48fb368-d1f8-4e53-9490-07ca85066604",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[19002, 521, 382, 8, 29, "Print",ExpressionUUID->"cebb1ed7-6813-4bf9-8897-6321f529e20b",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[19387, 531, 383, 8, 29, "Print",ExpressionUUID->"87a09b43-9bc1-4078-bc81-8b1a9f8870e6",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[19773, 541, 370, 8, 29, "Print",ExpressionUUID->"8b60106e-86d5-4cd1-89f5-be7d9eb896c2",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[20146, 551, 245, 5, 27, "Print",ExpressionUUID->"012c9c9b-36dd-4dc5-81c7-8711a1e1702b",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[20406, 559, 315, 7, 51, "Output",ExpressionUUID->"4b3491e6-1fa9-4160-b356-da6577b023d7",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[20794, 574, 243, 6, 58, "Chapter",ExpressionUUID->"9930ec21-c32c-4ff4-b23e-d5a85d028d42",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[21062, 584, 230, 5, 57, "Section",ExpressionUUID->"1a702223-c453-446a-8188-00f344c9fa89",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[21295, 591, 7720, 184, 191, "Input",ExpressionUUID->"f207a765-7cde-4e75-8a61-076a1dd78c3a",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[29052, 780, 255, 5, 57, "Section",ExpressionUUID->"53079a8e-45a4-48ec-9cb4-0078005932ef",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[29310, 787, 7577, 182, 191, "Input",ExpressionUUID->"1da2f8fa-b047-4f2d-b683-584cace5a4a8",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[36948, 976, 221, 4, 60, "Title",ExpressionUUID->"918dc508-7b59-4717-9363-a48741db503f",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[37194, 984, 6657, 171, 296, "Input",ExpressionUUID->"a9dc099a-58c7-4b4a-87b0-fae273cf5733",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[43854, 1157, 340, 7, 70, "Output",ExpressionUUID->"fc074c24-928f-4033-bf16-8876b6c97ae8",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[44197, 1166, 279, 6, 70, "Print",ExpressionUUID->"d9540334-e4a4-4525-ac00-81141f0c3b7e",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[44479, 1174, 265, 5, 70, "Output",ExpressionUUID->"50d94629-a31c-47bb-b6ba-3f573c796b2f",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[44781, 1184, 224, 4, 58, "Chapter",ExpressionUUID->"389ee8eb-49d3-4272-aea6-a6f7b184662e",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[45030, 1192, 2028, 48, 217, "Input",ExpressionUUID->"bc53587b-88a1-4f20-8274-cad588e7d06d",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[47061, 1242, 1146, 30, 70, "Output",ExpressionUUID->"c12d5fa5-616d-46b2-a1f0-27544ecf494b",
   CellTags->{"Number-of-events", "Acceptance"}]},
 "Number-of-events-computation"->{
  Cell[48268, 1279, 204, 4, 60, "Title",ExpressionUUID->"128d78c3-8bd2-4cc0-aade-f5ea999c5498",
   CellTags->"Number-of-events-computation"],
  Cell[48497, 1287, 274, 6, 58, "Chapter",ExpressionUUID->"024306d0-6fd7-404c-b503-13b97cb70d6e",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[48796, 1297, 18217, 498, 531, "Input",ExpressionUUID->"5f950072-065f-4973-a235-bace6753e9f0",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[67016, 1797, 309, 6, 33, "Output",ExpressionUUID->"1648ae56-3733-4148-906c-65e6bde61d65",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[67328, 1805, 309, 6, 33, "Output",ExpressionUUID->"0b44e2ec-0eb7-4e41-8472-6129b61b66b0",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[67640, 1813, 20337, 479, 295, "Output",ExpressionUUID->"4318911e-50a0-4bf6-a329-867e47960d17",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[87980, 2294, 309, 6, 33, "Output",ExpressionUUID->"39b63992-3c2f-4e7c-beec-1edee674fc4b",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[88292, 2302, 13171, 251, 67, "Output",ExpressionUUID->"1786d190-a1d3-4ba0-90c7-665490e37a84",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[101466, 2555, 309, 6, 33, "Output",ExpressionUUID->"1b233804-860d-49a6-b610-1dbe851d3e47",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[101778, 2563, 307, 6, 33, "Output",ExpressionUUID->"da4c0e1c-6574-4e8e-81ca-a961626607af",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[102088, 2571, 307, 6, 33, "Output",ExpressionUUID->"19e10533-4d53-4736-a81b-7ee37b92d37b",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[102398, 2579, 463, 9, 34, "Output",ExpressionUUID->"86c9bc1b-0816-4070-84fd-0e716749fec3",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[102864, 2590, 1742, 34, 69, "Output",ExpressionUUID->"4644ba57-0615-4b04-9881-abb1d20ad659",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[104655, 2630, 472, 8, 58, "Chapter",ExpressionUUID->"775c9f90-cfc2-4104-a914-805ee6203cb5",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[105152, 2642, 345, 7, 57, "Section",ExpressionUUID->"156da2f8-c95e-4643-9f69-1214d81706da",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[105500, 2651, 11215, 260, 422, "Input",ExpressionUUID->"efe9c5f7-ba18-4bd7-a49c-55163fccb032",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[116740, 2915, 328, 6, 47, "Subsection",ExpressionUUID->"e5eaebc3-b32f-410a-bd0f-d31d7689e52c",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[117071, 2923, 12466, 315, 431, "Input",ExpressionUUID->"ccbd42fa-b9d1-4412-9487-e96de9feeedd",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[129574, 3243, 402, 9, 47, "Subsection",ExpressionUUID->"e4c3cc8c-3bd7-4b50-8c99-3abaa32f3378",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[130001, 3256, 245, 5, 41, "Subsubsection",ExpressionUUID->"7f24cf1e-7678-4346-8ebd-675da6011508",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[130249, 3263, 21780, 540, 627, "Input",ExpressionUUID->"0500f499-02b1-452e-baee-ce09bd9cdbae",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[152102, 3811, 206, 4, 58, "Chapter",ExpressionUUID->"18333902-760f-4a49-b2f7-a7db0718c1c0",
   CellTags->"Number-of-events-computation"],
  Cell[152333, 3819, 233, 5, 57, "Section",ExpressionUUID->"50c91ae6-9248-4d28-b800-341ade2a0457",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[152591, 3828, 291, 7, 47, "Subsection",ExpressionUUID->"8bf9ba77-e751-430d-9143-2774faf1e610",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[152885, 3837, 7957, 205, 256, "Input",ExpressionUUID->"fade474d-c258-4c23-9009-9e4dbc52d234",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[160879, 4047, 276, 5, 47, "Subsection",ExpressionUUID->"5c5ffe48-8ff6-40c5-8f78-8439598eb712",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[161158, 4054, 9147, 231, 288, "Input",ExpressionUUID->"b78c9e0d-b198-443c-bb9b-82530589576a",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[170342, 4290, 351, 8, 47, "Subsection",ExpressionUUID->"b54ffa03-0d63-4f8e-a1c9-f7fb2138ef4d",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[170718, 4302, 266, 5, 41, "Subsubsection",ExpressionUUID->"d77ae272-2ba2-46b0-a466-458092d1666f",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[170987, 4309, 6615, 164, 250, "Input",ExpressionUUID->"ac01137b-ad2a-4e37-9bde-5305ad407266",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[177639, 4478, 320, 6, 41, "Subsubsection",ExpressionUUID->"477abc3f-2c58-4168-ac31-f2592812ecf2",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[177962, 4486, 6291, 148, 269, "Input",ExpressionUUID->"4b1b7fca-9fd0-401b-a5a5-05789e71edec",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[184290, 4639, 267, 6, 41, "Subsubsection",ExpressionUUID->"fb97e9a0-5fb1-4406-ab99-38a7edc8e450",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[184560, 4647, 3822, 84, 218, "Input",ExpressionUUID->"4dab4e9d-2936-4ec5-a43c-d9ca9f7dc266",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[188443, 4738, 333, 6, 57, "Section",ExpressionUUID->"4bb3f66c-fe01-4d66-8051-df3dd67609f6",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[188779, 4746, 16767, 412, 427, "Input",ExpressionUUID->"b0e3067b-8ee7-4de7-a7d2-94f772fa76ea",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[205571, 5162, 272, 5, 47, "Subsection",ExpressionUUID->"f27ee69d-2096-4f9d-9d2c-57657e82aabb",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[205868, 5171, 237, 5, 41, "Subsubsection",ExpressionUUID->"7f4bf841-2328-4018-b498-8d94ed4a2b09",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[206108, 5178, 4719, 116, 233, "Input",ExpressionUUID->"a9a0a547-39cb-466a-a362-1c82a7caa54e",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[210888, 5301, 206, 4, 57, "Section",ExpressionUUID->"1e5741a6-b05d-4bed-a216-c0a143aa62e3",
   CellTags->"Number-of-events-computation"],
  Cell[211119, 5309, 264, 5, 47, "Subsection",ExpressionUUID->"3abc9014-e55b-423d-acac-37fad942b452",
   CellTags->"Number-of-events-computation"],
  Cell[211386, 5316, 4709, 112, 177, "Input",ExpressionUUID->"740967fd-5392-4235-a2e3-37c275cfd2c9",
   CellTags->"Number-of-events-computation"],
  Cell[216132, 5433, 342, 8, 47, "Subsection",ExpressionUUID->"9db42e09-8f64-41d5-aa46-834cbdebf1fe",
   CellTags->"Number-of-events-computation"],
  Cell[216477, 5443, 4916, 120, 177, "Input",ExpressionUUID->"c94b816b-37a9-4f5b-887b-7a92099fce6f",
   CellTags->"Number-of-events-computation"],
  Cell[221418, 5567, 202, 4, 41, "Subsubsection",ExpressionUUID->"c74a406a-59b3-4eff-8776-0deaf8e47cef",
   CellTags->"Number-of-events-computation"],
  Cell[221623, 5573, 8041, 196, 192, "Input",ExpressionUUID->"355f1d40-5091-4a15-b861-9b41936c6fca",
   CellTags->"Number-of-events-computation"],
  Cell[230040, 5785, 220, 4, 47, "Subsection",ExpressionUUID->"39584463-72ba-412f-9e9d-1b324a6d9ae6",
   CellTags->"Number-of-events-computation"],
  Cell[230263, 5791, 22228, 546, 730, "Input",ExpressionUUID->"08eb9edb-e3c6-4de3-9811-d9dc1d320190",
   CellTags->"Number-of-events-computation"],
  Cell[252564, 6345, 224, 4, 60, "Title",ExpressionUUID->"f5136f97-573d-41ec-bafe-cbcb903e581e",
   CellTags->"Number-of-events-computation"],
  Cell[252813, 6353, 201, 4, 58, "Chapter",ExpressionUUID->"75cf786b-3cae-4471-be7d-a8f2b6c6b657",
   CellTags->"Number-of-events-computation"],
  Cell[253017, 6359, 6187, 142, 178, "Input",ExpressionUUID->"7723a626-82c5-4cfa-9029-8486e71b92ea",
   CellTags->"Number-of-events-computation"],
  Cell[259241, 6506, 197, 4, 58, "Chapter",ExpressionUUID->"e9258198-581c-4466-81fa-c2dce211dd65",
   CellTags->"Number-of-events-computation"],
  Cell[259463, 6514, 209, 4, 57, "Section",ExpressionUUID->"d18313fd-891f-4b57-be4b-ec06a2c36a1a",
   CellTags->"Number-of-events-computation"],
  Cell[259675, 6520, 3070, 70, 110, "Input",ExpressionUUID->"86f71900-800f-4fb4-824d-efacfeb51a5b",
   CellTags->"Number-of-events-computation"],
  Cell[262782, 6595, 390, 7, 57, "Section",ExpressionUUID->"ea35df86-1f74-459c-b50f-d9e15ebea561",
   CellTags->"Number-of-events-computation"],
  Cell[263175, 6604, 889, 16, 40, "Input",ExpressionUUID->"8a8a9ffb-2c26-4fa7-ab09-097069ace5ee",
   CellTags->"Number-of-events-computation"],
  Cell[264101, 6625, 334, 6, 57, "Section",ExpressionUUID->"8c40accd-0a6a-412a-b047-73e5a007e9c0",
   CellTags->"Number-of-events-computation"],
  Cell[264438, 6633, 335, 8, 40, "Input",ExpressionUUID->"a37052cf-00dd-4d71-b2cb-241e04531080",
   CellTags->"Number-of-events-computation"],
  Cell[264810, 6646, 345, 10, 57, "Section",ExpressionUUID->"cb4f246e-720d-4a3f-a151-92aa70c48153",
   CellTags->"Number-of-events-computation"],
  Cell[265158, 6658, 373, 9, 42, "Input",ExpressionUUID->"fa4d7454-a05d-48dc-8a3d-82d48a38f059",
   CellTags->"Number-of-events-computation"],
  Cell[265568, 6672, 323, 9, 57, "Section",ExpressionUUID->"91025b27-36af-4600-9d14-75d9b86ab53c",
   CellTags->"Number-of-events-computation"],
  Cell[265894, 6683, 329, 8, 40, "Input",ExpressionUUID->"414e91a8-bb6d-402e-983f-1ba20aaae80d",
   CellTags->"Number-of-events-computation"]},
 "Acceptance-computation"->{
  Cell[48497, 1287, 274, 6, 58, "Chapter",ExpressionUUID->"024306d0-6fd7-404c-b503-13b97cb70d6e",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[48796, 1297, 18217, 498, 531, "Input",ExpressionUUID->"5f950072-065f-4973-a235-bace6753e9f0",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[67016, 1797, 309, 6, 33, "Output",ExpressionUUID->"1648ae56-3733-4148-906c-65e6bde61d65",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[67328, 1805, 309, 6, 33, "Output",ExpressionUUID->"0b44e2ec-0eb7-4e41-8472-6129b61b66b0",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[67640, 1813, 20337, 479, 295, "Output",ExpressionUUID->"4318911e-50a0-4bf6-a329-867e47960d17",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[87980, 2294, 309, 6, 33, "Output",ExpressionUUID->"39b63992-3c2f-4e7c-beec-1edee674fc4b",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[88292, 2302, 13171, 251, 67, "Output",ExpressionUUID->"1786d190-a1d3-4ba0-90c7-665490e37a84",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[101466, 2555, 309, 6, 33, "Output",ExpressionUUID->"1b233804-860d-49a6-b610-1dbe851d3e47",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[101778, 2563, 307, 6, 33, "Output",ExpressionUUID->"da4c0e1c-6574-4e8e-81ca-a961626607af",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[102088, 2571, 307, 6, 33, "Output",ExpressionUUID->"19e10533-4d53-4736-a81b-7ee37b92d37b",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[102398, 2579, 463, 9, 34, "Output",ExpressionUUID->"86c9bc1b-0816-4070-84fd-0e716749fec3",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[102864, 2590, 1742, 34, 69, "Output",ExpressionUUID->"4644ba57-0615-4b04-9881-abb1d20ad659",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[104655, 2630, 472, 8, 58, "Chapter",ExpressionUUID->"775c9f90-cfc2-4104-a914-805ee6203cb5",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[105152, 2642, 345, 7, 57, "Section",ExpressionUUID->"156da2f8-c95e-4643-9f69-1214d81706da",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[105500, 2651, 11215, 260, 422, "Input",ExpressionUUID->"efe9c5f7-ba18-4bd7-a49c-55163fccb032",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[116740, 2915, 328, 6, 47, "Subsection",ExpressionUUID->"e5eaebc3-b32f-410a-bd0f-d31d7689e52c",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[117071, 2923, 12466, 315, 431, "Input",ExpressionUUID->"ccbd42fa-b9d1-4412-9487-e96de9feeedd",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[129574, 3243, 402, 9, 47, "Subsection",ExpressionUUID->"e4c3cc8c-3bd7-4b50-8c99-3abaa32f3378",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[130001, 3256, 245, 5, 41, "Subsubsection",ExpressionUUID->"7f24cf1e-7678-4346-8ebd-675da6011508",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[130249, 3263, 21780, 540, 627, "Input",ExpressionUUID->"0500f499-02b1-452e-baee-ce09bd9cdbae",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[152333, 3819, 233, 5, 57, "Section",ExpressionUUID->"50c91ae6-9248-4d28-b800-341ade2a0457",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[152591, 3828, 291, 7, 47, "Subsection",ExpressionUUID->"8bf9ba77-e751-430d-9143-2774faf1e610",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[152885, 3837, 7957, 205, 256, "Input",ExpressionUUID->"fade474d-c258-4c23-9009-9e4dbc52d234",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[160879, 4047, 276, 5, 47, "Subsection",ExpressionUUID->"5c5ffe48-8ff6-40c5-8f78-8439598eb712",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[161158, 4054, 9147, 231, 288, "Input",ExpressionUUID->"b78c9e0d-b198-443c-bb9b-82530589576a",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[170342, 4290, 351, 8, 47, "Subsection",ExpressionUUID->"b54ffa03-0d63-4f8e-a1c9-f7fb2138ef4d",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[170718, 4302, 266, 5, 41, "Subsubsection",ExpressionUUID->"d77ae272-2ba2-46b0-a466-458092d1666f",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[170987, 4309, 6615, 164, 250, "Input",ExpressionUUID->"ac01137b-ad2a-4e37-9bde-5305ad407266",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[177639, 4478, 320, 6, 41, "Subsubsection",ExpressionUUID->"477abc3f-2c58-4168-ac31-f2592812ecf2",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[177962, 4486, 6291, 148, 269, "Input",ExpressionUUID->"4b1b7fca-9fd0-401b-a5a5-05789e71edec",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[184290, 4639, 267, 6, 41, "Subsubsection",ExpressionUUID->"fb97e9a0-5fb1-4406-ab99-38a7edc8e450",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[184560, 4647, 3822, 84, 218, "Input",ExpressionUUID->"4dab4e9d-2936-4ec5-a43c-d9ca9f7dc266",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[188443, 4738, 333, 6, 57, "Section",ExpressionUUID->"4bb3f66c-fe01-4d66-8051-df3dd67609f6",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[188779, 4746, 16767, 412, 427, "Input",ExpressionUUID->"b0e3067b-8ee7-4de7-a7d2-94f772fa76ea",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[205571, 5162, 272, 5, 47, "Subsection",ExpressionUUID->"f27ee69d-2096-4f9d-9d2c-57657e82aabb",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[205868, 5171, 237, 5, 41, "Subsubsection",ExpressionUUID->"7f4bf841-2328-4018-b498-8d94ed4a2b09",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[206108, 5178, 4719, 116, 233, "Input",ExpressionUUID->"a9a0a547-39cb-466a-a362-1c82a7caa54e",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}]},
 "Sensitivity"->{
  Cell[266284, 6698, 212, 4, 60, "Title",ExpressionUUID->"2ce189e8-ece2-4e74-afba-65f86fa4e6b1",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[266521, 6706, 324, 7, 58, "Chapter",ExpressionUUID->"43aaf14b-3679-4a8d-8cd6-8b3aed1902b0",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[266848, 6715, 16862, 452, 556, "Input",ExpressionUUID->"5b921f97-5946-4ee1-8075-ebfec4e411f1",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[283735, 7171, 376, 9, 56, "Section",ExpressionUUID->"ed466a31-2eaa-42f8-854b-b87cbbc1a9b0",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[284114, 7182, 4459, 115, 116, "Input",ExpressionUUID->"255e1417-788a-4b69-a56b-a50d09ff97ba",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[288622, 7303, 219, 4, 58, "Chapter",ExpressionUUID->"742f7a10-6bda-4531-8fc5-a3f03e574d3b",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[288844, 7309, 13097, 334, 379, "Input",ExpressionUUID->"e42c711e-a973-46f4-88a9-717948c379ae",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[301990, 7649, 218, 4, 77, "Title",ExpressionUUID->"268b5966-c044-471d-8d66-d25b1ca611fc",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[302211, 7655, 2686, 67, 163, "Input",ExpressionUUID->"00a97c9c-fda1-4a59-a10c-e35c97e449fb",
   CellTags->{"Sensitivity", "Re-evaluation"}]},
 "Re-evaluation"->{
  Cell[266284, 6698, 212, 4, 60, "Title",ExpressionUUID->"2ce189e8-ece2-4e74-afba-65f86fa4e6b1",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[266521, 6706, 324, 7, 58, "Chapter",ExpressionUUID->"43aaf14b-3679-4a8d-8cd6-8b3aed1902b0",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[266848, 6715, 16862, 452, 556, "Input",ExpressionUUID->"5b921f97-5946-4ee1-8075-ebfec4e411f1",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[283735, 7171, 376, 9, 56, "Section",ExpressionUUID->"ed466a31-2eaa-42f8-854b-b87cbbc1a9b0",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[284114, 7182, 4459, 115, 116, "Input",ExpressionUUID->"255e1417-788a-4b69-a56b-a50d09ff97ba",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[288622, 7303, 219, 4, 58, "Chapter",ExpressionUUID->"742f7a10-6bda-4531-8fc5-a3f03e574d3b",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[288844, 7309, 13097, 334, 379, "Input",ExpressionUUID->"e42c711e-a973-46f4-88a9-717948c379ae",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[301990, 7649, 218, 4, 77, "Title",ExpressionUUID->"268b5966-c044-471d-8d66-d25b1ca611fc",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[302211, 7655, 2686, 67, 163, "Input",ExpressionUUID->"00a97c9c-fda1-4a59-a10c-e35c97e449fb",
   CellTags->{"Sensitivity", "Re-evaluation"}]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Number-of-events", 305368, 7739},
 {"Acceptance", 309500, 7796},
 {"Number-of-events-computation", 313650, 7853},
 {"Acceptance-computation", 323790, 7978},
 {"Sensitivity", 330278, 8053},
 {"Re-evaluation", 331627, 8072}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 207, 3, 68, "Title",ExpressionUUID->"ec489a88-8a17-4268-83b3-d4cc980d9075"],
Cell[790, 27, 4785, 123, 247, "Input",ExpressionUUID->"4fee1dbc-f123-4728-9e60-81aad253082b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5612, 155, 331, 6, 77, "Title",ExpressionUUID->"c7fbc496-1765-4913-bda1-eb19f9d14ec4",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[CellGroupData[{
Cell[5968, 165, 263, 5, 58, "Chapter",ExpressionUUID->"8348c717-8fb9-4ff9-be33-c78045c51d6d",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[CellGroupData[{
Cell[6256, 174, 491, 8, 57, "Section",ExpressionUUID->"990662f6-15c3-4f39-ae61-2c8fc1bd4b2e",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[CellGroupData[{
Cell[6772, 186, 224, 4, 47, "Subsection",ExpressionUUID->"fe07c9af-c0ec-4b3b-bc4f-1be41c5cf7b2",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[6999, 192, 1769, 46, 70, "Input",ExpressionUUID->"eb8c0f16-2688-4f53-8f87-c697473ee20c",
 CellTags->{"Number-of-events", "Acceptance"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[8805, 243, 339, 6, 47, "Subsection",ExpressionUUID->"3dd7b844-8e27-44cd-bb8b-37dac39065de",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[CellGroupData[{
Cell[9169, 253, 4978, 128, 323, "Input",ExpressionUUID->"6d5dcc26-d814-4435-9237-3d68cd75ad0c",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[CellGroupData[{
Cell[14172, 385, 2416, 67, 31, "Print",ExpressionUUID->"ab462dae-c2ce-4275-b896-7854a5100ace",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[16591, 454, 1201, 30, 31, "Print",ExpressionUUID->"a864dc8e-66b6-45a5-9c74-46f9adf345cd",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[17795, 486, 1204, 33, 31, "Print",ExpressionUUID->"f48fb368-d1f8-4e53-9490-07ca85066604",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[19002, 521, 382, 8, 29, "Print",ExpressionUUID->"cebb1ed7-6813-4bf9-8897-6321f529e20b",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[19387, 531, 383, 8, 29, "Print",ExpressionUUID->"87a09b43-9bc1-4078-bc81-8b1a9f8870e6",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[19773, 541, 370, 8, 29, "Print",ExpressionUUID->"8b60106e-86d5-4cd1-89f5-be7d9eb896c2",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[20146, 551, 245, 5, 27, "Print",ExpressionUUID->"012c9c9b-36dd-4dc5-81c7-8711a1e1702b",
 CellTags->{"Number-of-events", "Acceptance"}]
}, Open  ]],
Cell[20406, 559, 315, 7, 51, "Output",ExpressionUUID->"4b3491e6-1fa9-4160-b356-da6577b023d7",
 CellTags->{"Number-of-events", "Acceptance"}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[20794, 574, 243, 6, 58, "Chapter",ExpressionUUID->"9930ec21-c32c-4ff4-b23e-d5a85d028d42",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[CellGroupData[{
Cell[21062, 584, 230, 5, 57, "Section",ExpressionUUID->"1a702223-c453-446a-8188-00f344c9fa89",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[21295, 591, 7720, 184, 191, "Input",ExpressionUUID->"f207a765-7cde-4e75-8a61-076a1dd78c3a",
 CellTags->{"Number-of-events", "Acceptance"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[29052, 780, 255, 5, 57, "Section",ExpressionUUID->"53079a8e-45a4-48ec-9cb4-0078005932ef",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[29310, 787, 7577, 182, 191, "Input",ExpressionUUID->"1da2f8fa-b047-4f2d-b683-584cace5a4a8",
 CellTags->{"Number-of-events", "Acceptance"}]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[36948, 976, 221, 4, 60, "Title",ExpressionUUID->"918dc508-7b59-4717-9363-a48741db503f",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[CellGroupData[{
Cell[37194, 984, 6657, 171, 296, "Input",ExpressionUUID->"a9dc099a-58c7-4b4a-87b0-fae273cf5733",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[43854, 1157, 340, 7, 70, "Output",ExpressionUUID->"fc074c24-928f-4033-bf16-8876b6c97ae8",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[44197, 1166, 279, 6, 70, "Print",ExpressionUUID->"d9540334-e4a4-4525-ac00-81141f0c3b7e",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[44479, 1174, 265, 5, 70, "Output",ExpressionUUID->"50d94629-a31c-47bb-b6ba-3f573c796b2f",
 CellTags->{"Number-of-events", "Acceptance"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[44781, 1184, 224, 4, 58, "Chapter",ExpressionUUID->"389ee8eb-49d3-4272-aea6-a6f7b184662e",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[CellGroupData[{
Cell[45030, 1192, 2028, 48, 217, "Input",ExpressionUUID->"bc53587b-88a1-4f20-8274-cad588e7d06d",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[47061, 1242, 1146, 30, 70, "Output",ExpressionUUID->"c12d5fa5-616d-46b2-a1f0-27544ecf494b",
 CellTags->{"Number-of-events", "Acceptance"}]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[48268, 1279, 204, 4, 60, "Title",ExpressionUUID->"128d78c3-8bd2-4cc0-aade-f5ea999c5498",
 CellTags->"Number-of-events-computation"],
Cell[CellGroupData[{
Cell[48497, 1287, 274, 6, 58, "Chapter",ExpressionUUID->"024306d0-6fd7-404c-b503-13b97cb70d6e",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[48796, 1297, 18217, 498, 531, "Input",ExpressionUUID->"5f950072-065f-4973-a235-bace6753e9f0",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[67016, 1797, 309, 6, 33, "Output",ExpressionUUID->"1648ae56-3733-4148-906c-65e6bde61d65",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[67328, 1805, 309, 6, 33, "Output",ExpressionUUID->"0b44e2ec-0eb7-4e41-8472-6129b61b66b0",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[67640, 1813, 20337, 479, 295, "Output",ExpressionUUID->"4318911e-50a0-4bf6-a329-867e47960d17",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[87980, 2294, 309, 6, 33, "Output",ExpressionUUID->"39b63992-3c2f-4e7c-beec-1edee674fc4b",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[88292, 2302, 13171, 251, 67, "Output",ExpressionUUID->"1786d190-a1d3-4ba0-90c7-665490e37a84",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[101466, 2555, 309, 6, 33, "Output",ExpressionUUID->"1b233804-860d-49a6-b610-1dbe851d3e47",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[101778, 2563, 307, 6, 33, "Output",ExpressionUUID->"da4c0e1c-6574-4e8e-81ca-a961626607af",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[102088, 2571, 307, 6, 33, "Output",ExpressionUUID->"19e10533-4d53-4736-a81b-7ee37b92d37b",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[102398, 2579, 463, 9, 34, "Output",ExpressionUUID->"86c9bc1b-0816-4070-84fd-0e716749fec3",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[102864, 2590, 1742, 34, 69, "Output",ExpressionUUID->"4644ba57-0615-4b04-9881-abb1d20ad659",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[104655, 2630, 472, 8, 58, "Chapter",ExpressionUUID->"775c9f90-cfc2-4104-a914-805ee6203cb5",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[105152, 2642, 345, 7, 57, "Section",ExpressionUUID->"156da2f8-c95e-4643-9f69-1214d81706da",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[105500, 2651, 11215, 260, 422, "Input",ExpressionUUID->"efe9c5f7-ba18-4bd7-a49c-55163fccb032",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[116740, 2915, 328, 6, 47, "Subsection",ExpressionUUID->"e5eaebc3-b32f-410a-bd0f-d31d7689e52c",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[117071, 2923, 12466, 315, 431, "Input",ExpressionUUID->"ccbd42fa-b9d1-4412-9487-e96de9feeedd",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[129574, 3243, 402, 9, 47, "Subsection",ExpressionUUID->"e4c3cc8c-3bd7-4b50-8c99-3abaa32f3378",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[130001, 3256, 245, 5, 41, "Subsubsection",ExpressionUUID->"7f24cf1e-7678-4346-8ebd-675da6011508",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[130249, 3263, 21780, 540, 627, "Input",ExpressionUUID->"0500f499-02b1-452e-baee-ce09bd9cdbae",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[152102, 3811, 206, 4, 58, "Chapter",ExpressionUUID->"18333902-760f-4a49-b2f7-a7db0718c1c0",
 CellTags->"Number-of-events-computation"],
Cell[CellGroupData[{
Cell[152333, 3819, 233, 5, 57, "Section",ExpressionUUID->"50c91ae6-9248-4d28-b800-341ade2a0457",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[152591, 3828, 291, 7, 47, "Subsection",ExpressionUUID->"8bf9ba77-e751-430d-9143-2774faf1e610",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[152885, 3837, 7957, 205, 256, "Input",ExpressionUUID->"fade474d-c258-4c23-9009-9e4dbc52d234",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[160879, 4047, 276, 5, 47, "Subsection",ExpressionUUID->"5c5ffe48-8ff6-40c5-8f78-8439598eb712",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[161158, 4054, 9147, 231, 288, "Input",ExpressionUUID->"b78c9e0d-b198-443c-bb9b-82530589576a",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[170342, 4290, 351, 8, 47, "Subsection",ExpressionUUID->"b54ffa03-0d63-4f8e-a1c9-f7fb2138ef4d",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[170718, 4302, 266, 5, 41, "Subsubsection",ExpressionUUID->"d77ae272-2ba2-46b0-a466-458092d1666f",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[170987, 4309, 6615, 164, 250, "Input",ExpressionUUID->"ac01137b-ad2a-4e37-9bde-5305ad407266",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[177639, 4478, 320, 6, 41, "Subsubsection",ExpressionUUID->"477abc3f-2c58-4168-ac31-f2592812ecf2",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[177962, 4486, 6291, 148, 269, "Input",ExpressionUUID->"4b1b7fca-9fd0-401b-a5a5-05789e71edec",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[184290, 4639, 267, 6, 41, "Subsubsection",ExpressionUUID->"fb97e9a0-5fb1-4406-ab99-38a7edc8e450",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[184560, 4647, 3822, 84, 218, "Input",ExpressionUUID->"4dab4e9d-2936-4ec5-a43c-d9ca9f7dc266",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[188443, 4738, 333, 6, 57, "Section",ExpressionUUID->"4bb3f66c-fe01-4d66-8051-df3dd67609f6",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[188779, 4746, 16767, 412, 427, "Input",ExpressionUUID->"b0e3067b-8ee7-4de7-a7d2-94f772fa76ea",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[205571, 5162, 272, 5, 47, "Subsection",ExpressionUUID->"f27ee69d-2096-4f9d-9d2c-57657e82aabb",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[205868, 5171, 237, 5, 41, "Subsubsection",ExpressionUUID->"7f4bf841-2328-4018-b498-8d94ed4a2b09",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[206108, 5178, 4719, 116, 233, "Input",ExpressionUUID->"a9a0a547-39cb-466a-a362-1c82a7caa54e",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[210888, 5301, 206, 4, 57, "Section",ExpressionUUID->"1e5741a6-b05d-4bed-a216-c0a143aa62e3",
 CellTags->"Number-of-events-computation"],
Cell[CellGroupData[{
Cell[211119, 5309, 264, 5, 47, "Subsection",ExpressionUUID->"3abc9014-e55b-423d-acac-37fad942b452",
 CellTags->"Number-of-events-computation"],
Cell[211386, 5316, 4709, 112, 177, "Input",ExpressionUUID->"740967fd-5392-4235-a2e3-37c275cfd2c9",
 CellTags->"Number-of-events-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[216132, 5433, 342, 8, 47, "Subsection",ExpressionUUID->"9db42e09-8f64-41d5-aa46-834cbdebf1fe",
 CellTags->"Number-of-events-computation"],
Cell[216477, 5443, 4916, 120, 177, "Input",ExpressionUUID->"c94b816b-37a9-4f5b-887b-7a92099fce6f",
 CellTags->"Number-of-events-computation"],
Cell[CellGroupData[{
Cell[221418, 5567, 202, 4, 41, "Subsubsection",ExpressionUUID->"c74a406a-59b3-4eff-8776-0deaf8e47cef",
 CellTags->"Number-of-events-computation"],
Cell[221623, 5573, 8041, 196, 192, "Input",ExpressionUUID->"355f1d40-5091-4a15-b861-9b41936c6fca",
 CellTags->"Number-of-events-computation"],
Cell[229667, 5771, 149, 3, 34, "Input",ExpressionUUID->"27dc2e30-3449-4e35-910b-42f962577a5c"],
Cell[229819, 5776, 172, 3, 34, "Input",ExpressionUUID->"bc333891-2081-4b8d-87d3-275e5ab39f76"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[230040, 5785, 220, 4, 47, "Subsection",ExpressionUUID->"39584463-72ba-412f-9e9d-1b324a6d9ae6",
 CellTags->"Number-of-events-computation"],
Cell[230263, 5791, 22228, 546, 730, "Input",ExpressionUUID->"08eb9edb-e3c6-4de3-9811-d9dc1d320190",
 CellTags->"Number-of-events-computation"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[252564, 6345, 224, 4, 60, "Title",ExpressionUUID->"f5136f97-573d-41ec-bafe-cbcb903e581e",
 CellTags->"Number-of-events-computation"],
Cell[CellGroupData[{
Cell[252813, 6353, 201, 4, 58, "Chapter",ExpressionUUID->"75cf786b-3cae-4471-be7d-a8f2b6c6b657",
 CellTags->"Number-of-events-computation"],
Cell[253017, 6359, 6187, 142, 178, "Input",ExpressionUUID->"7723a626-82c5-4cfa-9029-8486e71b92ea",
 CellTags->"Number-of-events-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[259241, 6506, 197, 4, 58, "Chapter",ExpressionUUID->"e9258198-581c-4466-81fa-c2dce211dd65",
 CellTags->"Number-of-events-computation"],
Cell[CellGroupData[{
Cell[259463, 6514, 209, 4, 57, "Section",ExpressionUUID->"d18313fd-891f-4b57-be4b-ec06a2c36a1a",
 CellTags->"Number-of-events-computation"],
Cell[259675, 6520, 3070, 70, 110, "Input",ExpressionUUID->"86f71900-800f-4fb4-824d-efacfeb51a5b",
 CellTags->"Number-of-events-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[262782, 6595, 390, 7, 57, "Section",ExpressionUUID->"ea35df86-1f74-459c-b50f-d9e15ebea561",
 CellTags->"Number-of-events-computation"],
Cell[263175, 6604, 889, 16, 40, "Input",ExpressionUUID->"8a8a9ffb-2c26-4fa7-ab09-097069ace5ee",
 CellTags->"Number-of-events-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[264101, 6625, 334, 6, 57, "Section",ExpressionUUID->"8c40accd-0a6a-412a-b047-73e5a007e9c0",
 CellTags->"Number-of-events-computation"],
Cell[264438, 6633, 335, 8, 40, "Input",ExpressionUUID->"a37052cf-00dd-4d71-b2cb-241e04531080",
 CellTags->"Number-of-events-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[264810, 6646, 345, 10, 57, "Section",ExpressionUUID->"cb4f246e-720d-4a3f-a151-92aa70c48153",
 CellTags->"Number-of-events-computation"],
Cell[265158, 6658, 373, 9, 42, "Input",ExpressionUUID->"fa4d7454-a05d-48dc-8a3d-82d48a38f059",
 CellTags->"Number-of-events-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[265568, 6672, 323, 9, 57, "Section",ExpressionUUID->"91025b27-36af-4600-9d14-75d9b86ab53c",
 CellTags->"Number-of-events-computation"],
Cell[265894, 6683, 329, 8, 40, "Input",ExpressionUUID->"414e91a8-bb6d-402e-983f-1ba20aaae80d",
 CellTags->"Number-of-events-computation"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[266284, 6698, 212, 4, 60, "Title",ExpressionUUID->"2ce189e8-ece2-4e74-afba-65f86fa4e6b1",
 CellTags->{"Sensitivity", "Re-evaluation"}],
Cell[CellGroupData[{
Cell[266521, 6706, 324, 7, 58, "Chapter",ExpressionUUID->"43aaf14b-3679-4a8d-8cd6-8b3aed1902b0",
 CellTags->{"Sensitivity", "Re-evaluation"}],
Cell[266848, 6715, 16862, 452, 556, "Input",ExpressionUUID->"5b921f97-5946-4ee1-8075-ebfec4e411f1",
 CellTags->{"Sensitivity", "Re-evaluation"}],
Cell[CellGroupData[{
Cell[283735, 7171, 376, 9, 56, "Section",ExpressionUUID->"ed466a31-2eaa-42f8-854b-b87cbbc1a9b0",
 CellTags->{"Sensitivity", "Re-evaluation"}],
Cell[284114, 7182, 4459, 115, 116, "Input",ExpressionUUID->"255e1417-788a-4b69-a56b-a50d09ff97ba",
 CellTags->{"Sensitivity", "Re-evaluation"}]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[288622, 7303, 219, 4, 58, "Chapter",ExpressionUUID->"742f7a10-6bda-4531-8fc5-a3f03e574d3b",
 CellTags->{"Sensitivity", "Re-evaluation"}],
Cell[288844, 7309, 13097, 334, 379, "Input",ExpressionUUID->"e42c711e-a973-46f4-88a9-717948c379ae",
 CellTags->{"Sensitivity", "Re-evaluation"}]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[301990, 7649, 218, 4, 77, "Title",ExpressionUUID->"268b5966-c044-471d-8d66-d25b1ca611fc",
 CellTags->{"Sensitivity", "Re-evaluation"}],
Cell[302211, 7655, 2686, 67, 163, "Input",ExpressionUUID->"00a97c9c-fda1-4a59-a10c-e35c97e449fb",
 CellTags->{"Sensitivity", "Re-evaluation"}]
}, Open  ]]
}
]
*)

