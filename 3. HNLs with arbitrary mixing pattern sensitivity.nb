(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    421274,      10427]
NotebookOptionsPosition[    377829,       9740]
NotebookOutlinePosition[    402989,      10082]
CellTagsIndexPosition[    402748,      10073]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Just launch the code below to run the notebook (shift+enter)", "Title",
 CellChangeTimes->{{3.8934376452895875`*^9, 
  3.8934376644509068`*^9}},ExpressionUUID->"3a6189ab-b48c-4865-a933-\
cc9614b95029"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BlockEvaluation", "[", "tag_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nb", "=", 
      RowBox[{"EvaluationNotebook", "[", "]"}]}], ";", "\n", 
     RowBox[{"NotebookFind", "[", 
      RowBox[{"nb", ",", "tag", ",", "All", ",", "CellTags"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"infoDialog", "[", "phrase_", "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<Proceed\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DirectoryQ", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<Auxiliary data\>\""}], "}"}], "]"}], "]"}], "//", 
       "ToString"}], ")"}], "\[Equal]", "\"\<False\>\""}], ",", 
    RowBox[{"CreateDirectory", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<Auxiliary data\>\""}], "}"}], "]"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DirectoryQ", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<Auxiliary data/HNLs\>\""}], "}"}], "]"}], "]"}], "//", 
       "ToString"}], ")"}], "\[Equal]", "\"\<False\>\""}], ",", 
    RowBox[{"CreateDirectory", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<Auxiliary data/HNLs\>\""}], "}"}], "]"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"choiceslist", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<Acceptance\>\"", ",", "\"\<Tabulated number of events\>\"", ",", 
     "\"\<Sensitivity\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"taglist", "[", "\"\<Tabulated number of events\>\"", "]"}], "=", 
   "\"\<Number-of-events\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"taglist", "[", "\"\<Sensitivity\>\"", "]"}], "=", 
   "\"\<Sensitivity\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"taglist", "[", "\"\<Acceptance\>\"", "]"}], "=", 
   "\"\<Acceptance\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"computationchoice", "=", 
   RowBox[{"dropdownDialog", "[", 
    RowBox[{
    "choiceslist", ",", 
     "\"\<Do you want to compute the tabulated number of events and then \
sensitivity, or just sensitivity (if the tabulated number of events has been \
already produced)?\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tagselected", "=", 
   RowBox[{"taglist", "[", "computationchoice", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"BlockEvaluation", "[", "tagselected", "]"}]}], "Input",
 CellChangeTimes->{{3.893437585709897*^9, 3.8934375895369635`*^9}, {
   3.8934376329497385`*^9, 3.893437658846809*^9}, 3.893573148874529*^9, {
   3.8936653619937787`*^9, 3.893665362662826*^9}, {3.895054198384289*^9, 
   3.895054198620511*^9}, {3.8951271161961904`*^9, 3.8951271342621512`*^9}, 
   3.9025630567005696`*^9, {3.9027294552735224`*^9, 3.9027294812265596`*^9}, 
   3.902817864446456*^9, {3.9038926036482916`*^9, 3.90389261524858*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"67d16bcb-6808-46ec-ae03-72ce61d72bb8"]
}, Closed]],

Cell[CellGroupData[{

Cell["Preliminary definitions (launch first)", "Title",
 CellChangeTimes->{{3.7552434949579296`*^9, 3.755243495237189*^9}, {
  3.88501652694691*^9, 3.885016532955313*^9}, {3.8850204805201235`*^9, 
  3.885020485584347*^9}},
 CellTags->
  "Number-of-events",ExpressionUUID->"f64b31a6-3a21-452a-9085-9eaa0b5708aa"],

Cell[CellGroupData[{

Cell["Parameters and various functions", "Chapter",
 CellChangeTimes->{{3.8846619009140606`*^9, 3.884661902476644*^9}, {
  3.885017296053095*^9, 3.8850172996856313`*^9}},
 CellTags->
  "Number-of-events",ExpressionUUID->"6048c214-b0a8-4591-8c9d-abf34243f3be"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"infoDialog", "[", "phrase_", "]"}], ":=", 
   RowBox[{"DialogInput", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
     RowBox[{"Column", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
        RowBox[{"Button", "[", 
         RowBox[{"\"\<Proceed\>\"", ",", 
          RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
      "]"}]}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", "chbar", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"chbar", "=", " ", 
    RowBox[{"6.6", "*", 
     SuperscriptBox["10", 
      RowBox[{"-", "25"}]], "*", "3", "*", 
     SuperscriptBox["10", "8"]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Masses", " ", "of", " ", "various", " ", "SM", " ", "particles"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mB", "=", "5.3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mBc", "=", "6.3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mK", "=", "0.495"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mDs", "=", "1.97"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mD", "=", "1.87"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MZ", "=", "91"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MW", "=", "80"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M\[Pi]Ch", "=", " ", "0.13957"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M\[Pi]0", "=", "0.134977"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MK", "=", "0.493677"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M\[Rho]", " ", "=", " ", "0.77549"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M\[Eta]", " ", "=", " ", "0.547853"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M\[Eta]prime", " ", "=", " ", "0.95766"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M\[Eta]c", "=", "2.9803"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M\[Omega]", "=", "0.78265"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M\[Phi]", "=", "1.019455"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MD", "=", "1.86484"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MDs", "=", "1.9685"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MDsStar", "=", "2.1123"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MJ\[Psi]", "=", "3.097"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Me", " ", "=", " ", "0.00051099891"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M\[Mu]", " ", "=", "0.105658"}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M\[Tau]", " ", "=", " ", "1.77684"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ml", "=", 
   RowBox[{"{", 
    RowBox[{"Me", ",", "M\[Mu]", ",", "M\[Tau]"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mu", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0.0024", ",", "1.27", ",", "173"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Md", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"0.0048", ",", "0.104", ",", "5"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fermi", " ", "coupling"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Gf", "=", 
    RowBox[{"1.166379", "*", 
     SuperscriptBox["10", 
      RowBox[{"-", "5"}]]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Meson", " ", "couplings"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f\[Pi]", " ", "=", " ", "0.13"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fK", "=", "0.1556"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f\[Eta]", " ", "=", " ", "0.0817"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f\[Eta]prime", " ", "=", " ", "0.094"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f\[Eta]c", "=", "0.237"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fD", "=", "0.212"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fDs", "=", "0.249"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fDsStar", "=", "0.315"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g\[Omega]", "=", "0.153"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g\[Phi]", "=", "0.234"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g\[Rho]", " ", "=", " ", "0.162"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gJ\[Psi]", "=", "1.29"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Decay", " ", "widths", " ", "of", " ", "particles", " ", "at", " ", 
    "rest", " ", "in", " ", "GeV"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GammatotalZ", "=", "2.49"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GammatotalW", "=", "2.085"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]\[CapitalGamma]Zmax", "=", "0.0023"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GammaDs", " ", "=", " ", 
    RowBox[{"1.33", "*", 
     SuperscriptBox["10", 
      RowBox[{"-", "12"}]]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"\[Tau]", " ", "lepton", " ", "lifetime"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Tau]\[Tau]", " ", "=", " ", 
    RowBox[{"290.3", "*", 
     SuperscriptBox["10", 
      RowBox[{"-", "15"}]]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"CKM", " ", "matrix"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CKM1", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.9743", ",", " ", "0.2251", ",", "0.00351"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.2249", ",", "0.9730", ",", "0.0412"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.00867", ",", "0.0404", ",", "0.999"}], "}"}]}], "}"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    SuperscriptBox["sin", "2"], 
    RowBox[{"(", 
     SubscriptBox["\[Theta]", "W"], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sw2", " ", "=", " ", "0.23126"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Br", " ", "of", " ", "decay", " ", "of", " ", 
    SuperscriptBox["\[Eta]", "0"], " ", "and", " ", 
    RowBox[{"\[Eta]", "'"}], " ", "mesons", " ", "to", " ", "charged", " ", 
    "states"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Bretatocharged", "=", "0.28"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Bretaprimetocharged", "=", "0.78"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Br", " ", "of", " ", "decay", " ", "of", " ", 
    SuperscriptBox["\[Omega]", "0"], " ", "and", " ", 
    SuperscriptBox["\[Phi]", "0"], " ", "mesons", " ", "to", " ", "charged", 
    " ", "states"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Brphitocharged", "=", "0.66"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Bromegatocharged", "=", "0.91"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fragmentation", " ", "fractions", " ", "at", " ", "the", " ", "LHC"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fdstau", " ", "=", " ", "0.0543"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fctod0LHC", "=", "0.553"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fctodplusLHC", " ", "=", " ", "0.225"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fctodsLHC", "=", "0.105"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fbtobcLHC", "=", " ", 
   RowBox[{"2.6", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "3"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fbtob0LHC", "=", 
   RowBox[{"fbtobplusLHC", "=", "0.324"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.884661904994011*^9, 3.884661921540403*^9}, {
   3.8850164522887964`*^9, 3.8850165245568185`*^9}, {3.885016628097911*^9, 
   3.8850166282886553`*^9}, 3.885016710182028*^9, {3.8850167568987885`*^9, 
   3.885016762395402*^9}, {3.885016799450395*^9, 3.8850170557864246`*^9}, {
   3.88501712653312*^9, 3.885017216885895*^9}, {3.8850173024453783`*^9, 
   3.8850173372383676`*^9}, {3.885017399572728*^9, 3.88501741270778*^9}, {
   3.8850174625354366`*^9, 3.885017462658634*^9}, {3.8850175591211877`*^9, 
   3.8850175593408356`*^9}, {3.8850182535473127`*^9, 
   3.8850182538962827`*^9}, {3.885018314394388*^9, 3.885018333197164*^9}, {
   3.8850189741121674`*^9, 3.885018974433589*^9}, 3.8850190966970725`*^9, {
   3.885019721482507*^9, 3.8850197654258046`*^9}, {3.885019828534438*^9, 
   3.8850198661946564`*^9}, {3.88501995528426*^9, 3.8850201480526233`*^9}, {
   3.885020185062007*^9, 3.8850201894992275`*^9}, {3.885020291896063*^9, 
   3.8850203335305076`*^9}, {3.885020432284384*^9, 3.8850204475138783`*^9}, {
   3.8850205949824495`*^9, 3.885020600587699*^9}, {3.8850212843213625`*^9, 
   3.88502132833275*^9}, {3.885032891250867*^9, 3.8850329826946216`*^9}, {
   3.885033159126209*^9, 3.885033161690289*^9}, {3.8850331946913424`*^9, 
   3.8850331954065113`*^9}, {3.8850336204217644`*^9, 
   3.8850336226032686`*^9}, {3.8850342557191987`*^9, 
   3.8850344920061417`*^9}, {3.8850345924696712`*^9, 3.885034596199212*^9}, {
   3.886095663976947*^9, 3.8860956701025677`*^9}, {3.886096187077428*^9, 
   3.8860963364493656`*^9}, {3.888641759315454*^9, 3.88864182888459*^9}, 
   3.8886421804133463`*^9, {3.8886422161639967`*^9, 3.8886422184142056`*^9}, {
   3.8886422723082395`*^9, 3.88864227597868*^9}, {3.888642315342514*^9, 
   3.888642317618765*^9}, {3.888642509666093*^9, 3.8886425556017246`*^9}, {
   3.890286782146555*^9, 3.8902867825177317`*^9}, {3.8955883793479033`*^9, 
   3.8955883800700903`*^9}},
 CellTags->"Number-of-events",
 CellLabel->"In[22]:=",ExpressionUUID->"38e841c8-a539-4bae-bc89-9632f0a3f574"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Branching ratios of the HNL production", "Chapter",
 CellChangeTimes->{{3.835270415198964*^9, 3.8352704154970675`*^9}, {
   3.854441650570236*^9, 3.8544416515373263`*^9}, {3.885016402104937*^9, 
   3.8850164030053596`*^9}, 3.885019196491799*^9, {3.885019273945055*^9, 
   3.88501928458453*^9}},
 CellTags->
  "Number-of-events",ExpressionUUID->"623267a1-9c4d-426c-8448-961507b9c3b3"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sum]", "meson"], 
    RowBox[{
     SubscriptBox["f", 
      RowBox[{"q", "\[Rule]", "meson"}]], "*", 
     RowBox[{"Br", "(", 
      RowBox[{"meson", "\[Rule]", "N"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"d7abac09-ecd0-46ef-9891-5f177abf62ad"],
 ") at ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["U", "2"], " ", "=", " ", "1"}], TraditionalForm]],
  ExpressionUUID->"218e06f8-df6f-4a4b-9dac-d08caad75135"]
}], "Section",
 CellChangeTimes->{{3.824285138433869*^9, 3.8242851743078976`*^9}, {
  3.885019256636998*^9, 3.885019275025522*^9}, {3.8886426253963566`*^9, 
  3.888642636596406*^9}},
 CellTags->
  "Number-of-events",ExpressionUUID->"a3928977-6d58-457e-92d7-05fa35ba6218"],

Cell[CellGroupData[{

Cell["1. LHC", "Subsection",
 CellChangeTimes->{{3.885018410956735*^9, 3.885018411795294*^9}, 
   3.885019255625141*^9, {3.8850334852489495`*^9, 3.8850334866389227`*^9}, {
   3.8886425670846896`*^9, 3.8886425740052023`*^9}},
 CellTags->
  "Number-of-events",ExpressionUUID->"3650f247-0ba0-474b-b25c-39864d460945"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dNeLHC", "[", "mN_", "]"}], "=", 
   RowBox[{
    RowBox[{"Interpolation", "[", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "@", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"FileNameSplit", "@", 
            RowBox[{"NotebookDirectory", "[", "]"}]}], ",", 
           "\"\<phenomenology/HNL/branching \
ratios/c_quark_to_N_mixing_e_LHC.dat\>\""}], "]"}]}], ",", "\"\<Table\>\""}], 
       "]"}], ",", 
      RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "mN", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dN\[Mu]LHC", "[", "mN_", "]"}], "=", 
   RowBox[{
    RowBox[{"Interpolation", "[", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "@", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"FileNameSplit", "@", 
            RowBox[{"NotebookDirectory", "[", "]"}]}], ",", 
           "\"\<phenomenology/HNL/branching \
ratios/c_quark_to_N_mixing_mu_LHC.dat\>\""}], "]"}]}], ",", "\"\<Table\>\""}],
        "]"}], ",", 
      RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "mN", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dN\[Tau]LHC", "[", "mN_", "]"}], "=", 
   RowBox[{
    RowBox[{"Interpolation", "[", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "@", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"FileNameSplit", "@", 
            RowBox[{"NotebookDirectory", "[", "]"}]}], ",", 
           "\"\<phenomenology/HNL/branching \
ratios/c_quark_to_N_mixing_tau_LHC.dat\>\""}], "]"}]}], ",", 
        "\"\<Table\>\""}], "]"}], ",", 
      RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "mN", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bNeLHC", "[", "mN_", "]"}], "=", 
   RowBox[{
    RowBox[{"Interpolation", "[", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "@", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"FileNameSplit", "@", 
            RowBox[{"NotebookDirectory", "[", "]"}]}], ",", 
           "\"\<phenomenology/HNL/branching \
ratios/b_quark_to_N_mixing_e_LHC.dat\>\""}], "]"}]}], ",", "\"\<Table\>\""}], 
       "]"}], ",", 
      RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "mN", 
    "]"}]}], ";", 
  RowBox[{
   RowBox[{"bN\[Mu]LHC", "[", "mN_", "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"mN", "<", 
      RowBox[{"6.279", "-", "0.105"}]}], ",", 
     RowBox[{"Evaluate", "[", 
      RowBox[{
       RowBox[{"Interpolation", "[", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{
           RowBox[{"FileNameJoin", "@", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"FileNameSplit", "@", 
               RowBox[{"NotebookDirectory", "[", "]"}]}], ",", 
              "\"\<phenomenology/HNL/branching \
ratios/b_quark_to_N_mixing_mu_LHC.dat\>\""}], "]"}]}], ",", "\"\<Table\>\""}],
           "]"}], ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "mN", 
       "]"}], "]"}], ",", "0"}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"bN\[Tau]LHC", "[", "mN_", "]"}], "=", 
   RowBox[{
    RowBox[{"Interpolation", "[", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "@", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"FileNameSplit", "@", 
            RowBox[{"NotebookDirectory", "[", "]"}]}], ",", 
           "\"\<phenomenology/HNL/branching \
ratios/b_quark_to_N_mixing_tau_LHC.dat\>\""}], "]"}]}], ",", 
        "\"\<Table\>\""}], "]"}], ",", 
      RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "mN", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8850184152661276`*^9, 3.8850184158264256`*^9}, {
  3.8850184542684383`*^9, 3.885018565977172*^9}, {3.885033479685088*^9, 
  3.8850335048796525`*^9}, {3.8850347528831525`*^9, 3.8850347681523733`*^9}, {
  3.892106420018811*^9, 3.892106436953646*^9}},
 CellTags->"Number-of-events",
 CellLabel->"In[81]:=",ExpressionUUID->"a0a33917-1099-4d1d-b550-a1cb1664f85f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["2. SPS", "Subsection",
 CellChangeTimes->{{3.8242851903589*^9, 3.8242851910259905`*^9}},
 CellTags->
  "Number-of-events",ExpressionUUID->"d8ddf444-d95a-4ab3-b525-cb9a8e69acb7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dNeSPS", "[", "mN_", "]"}], "=", 
   RowBox[{
    RowBox[{"Interpolation", "[", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<phenomenology/HNL/branching \
ratios/c_quark_to_N_mixing_e_SPS.dat\>\""}], "}"}], "]"}], ",", 
        "\"\<Table\>\""}], "]"}], ",", 
      RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "mN", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dN\[Mu]SPS", "[", "mN_", "]"}], "=", 
   RowBox[{
    RowBox[{"Interpolation", "[", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<phenomenology/HNL/branching \
ratios/c_quark_to_N_mixing_mu_SPS.dat\>\""}], "}"}], "]"}], ",", 
        "\"\<Table\>\""}], "]"}], ",", 
      RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "mN", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dN\[Tau]SPS", "[", "mN_", "]"}], "=", 
   RowBox[{
    RowBox[{"Interpolation", "[", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<phenomenology/HNL/branching \
ratios/c_quark_to_N_mixing_tau_SPS.dat\>\""}], "}"}], "]"}], ",", 
        "\"\<Table\>\""}], "]"}], ",", 
      RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "mN", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bNeSPS", "[", "mN_", "]"}], "=", 
    RowBox[{
     RowBox[{"Interpolation", "[", 
      RowBox[{
       RowBox[{"Import", "[", 
        RowBox[{
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], ",", 
            "\"\<phenomenology/HNL/branching \
ratios/b_quark_noBc_to_N_mixing_e_SPS.dat\>\""}], "}"}], "]"}], ",", 
         "\"\<Table\>\""}], "]"}], ",", 
       RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "mN", 
     "]"}]}], ";", 
   RowBox[{
    RowBox[{"bN\[Mu]SPS", "[", "mN_", "]"}], "=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"mN", "<", 
       RowBox[{"5.279", "-", "M\[Mu]"}]}], ",", 
      RowBox[{"Evaluate", "[", 
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{
          RowBox[{"Import", "[", 
           RowBox[{
            RowBox[{"FileNameJoin", "@", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"FileNameSplit", "@", 
                RowBox[{"NotebookDirectory", "[", "]"}]}], ",", 
               "\"\<phenomenology/HNL/branching \
ratios/b_quark_noBc_to_N_mixing_mu_SPS.dat\>\""}], "]"}]}], ",", 
            "\"\<Table\>\""}], "]"}], ",", 
          RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "mN", 
        "]"}], "]"}], ",", "0"}], "]"}]}], ";", 
   RowBox[{
    RowBox[{"bN\[Tau]SPS", "[", "mN_", "]"}], "=", 
    RowBox[{
     RowBox[{"Interpolation", "[", 
      RowBox[{
       RowBox[{"Import", "[", 
        RowBox[{
         RowBox[{"FileNameJoin", "@", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"FileNameSplit", "@", 
             RowBox[{"NotebookDirectory", "[", "]"}]}], ",", 
            "\"\<phenomenology/HNL/branching \
ratios/b_quark_noBc_to_N_mixing_tau_SPS.dat\>\""}], "]"}]}], ",", 
         "\"\<Table\>\""}], "]"}], ",", 
       RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "mN", 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Only", " ", "for", " ", "SHiP"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"sNeSPS", "[", "mN_", "]"}], ",", 
     RowBox[{"sN\[Mu]SPS", "[", "mN_", "]"}]}], "}"}], "=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<phenomenology/HNL/branching ratios/Kplus-lN.m\>\""}], "}"}], 
      "]"}], ",", "\"\<MX\>\""}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8850185920140057`*^9, 3.8850186075869584`*^9}, {
   3.8850188692137165`*^9, 3.885018902474017*^9}, {3.88501893912445*^9, 
   3.885018941544327*^9}, {3.8850334718869996`*^9, 3.8850334772414513`*^9}, {
   3.8850347397199*^9, 3.885034748199355*^9}, {3.8921064585290327`*^9, 
   3.8921064660666094`*^9}, {3.9025643275221863`*^9, 3.902564429475723*^9}, {
   3.902650295793579*^9, 3.9026502979739466`*^9}, {3.9026503420102577`*^9, 
   3.902650410929878*^9}, {3.902650505631151*^9, 3.9026505075353613`*^9}, {
   3.9061301110264063`*^9, 3.9061301146323366`*^9}, {3.906130274038473*^9, 
   3.9061302772532415`*^9}, 3.9061856173793445`*^9},
 CellTags->"Number-of-events",
 CellLabel->"In[85]:=",ExpressionUUID->"39cded67-891f-477d-801c-c00836f0df24"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.906185505744157*^9, 3.9061855062063894`*^9}, {
   3.9061855540024247`*^9, 3.906185568680306*^9}, 
   3.9061856144356127`*^9},ExpressionUUID->"ab47fa6e-c5b9-4390-ad56-\
6d2e71b7397b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["3. FermilabBD/DUNE (120 GeV beam)", "Subsection",
 CellChangeTimes->{{3.8242851953989563`*^9, 3.8242851968687725`*^9}, {
   3.8850196191707344`*^9, 3.8850196236529026`*^9}, 3.893520983755642*^9},
 CellTags->
  "Number-of-events",ExpressionUUID->"495f4d30-e5dc-4aba-8ea6-6dd1fa27212c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dNeFermilabBD", "[", "mN_", "]"}], "=", 
   RowBox[{
    RowBox[{"Interpolation", "[", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "@", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"FileNameSplit", "@", 
            RowBox[{"NotebookDirectory", "[", "]"}]}], ",", 
           "\"\<phenomenology/HNL/branching \
ratios/c_quark_to_N_mixing_e_FermilabBD.dat\>\""}], "]"}]}], ",", 
        "\"\<Table\>\""}], "]"}], ",", 
      RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "mN", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dN\[Mu]FermilabBD", "[", "mN_", "]"}], "=", 
   RowBox[{
    RowBox[{"Interpolation", "[", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "@", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"FileNameSplit", "@", 
            RowBox[{"NotebookDirectory", "[", "]"}]}], ",", 
           "\"\<phenomenology/HNL/branching \
ratios/c_quark_to_N_mixing_mu_FermilabBD.dat\>\""}], "]"}]}], ",", 
        "\"\<Table\>\""}], "]"}], ",", 
      RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "mN", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dN\[Tau]FermilabBD", "[", "mN_", "]"}], "=", 
   RowBox[{
    RowBox[{"Interpolation", "[", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "@", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"FileNameSplit", "@", 
            RowBox[{"NotebookDirectory", "[", "]"}]}], ",", 
           "\"\<phenomenology/HNL/branching \
ratios/c_quark_to_N_mixing_tau_FermilabBD.dat\>\""}], "]"}]}], ",", 
        "\"\<Table\>\""}], "]"}], ",", 
      RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "mN", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bNeFermilabBD", "[", "mN_", "]"}], "=", 
   RowBox[{
    RowBox[{"Interpolation", "[", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "@", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"FileNameSplit", "@", 
            RowBox[{"NotebookDirectory", "[", "]"}]}], ",", 
           "\"\<phenomenology/HNL/branching \
ratios/b_quark_noBc_to_N_mixing_e_FermilabBD.dat\>\""}], "]"}]}], ",", 
        "\"\<Table\>\""}], "]"}], ",", 
      RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "mN", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bN\[Mu]FermilabBD", "[", "mN_", "]"}], "=", 
   RowBox[{
    RowBox[{"Interpolation", "[", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "@", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"FileNameSplit", "@", 
            RowBox[{"NotebookDirectory", "[", "]"}]}], ",", 
           "\"\<phenomenology/HNL/branching \
ratios/b_quark_noBc_to_N_mixing_mu_FermilabBD.dat\>\""}], "]"}]}], ",", 
        "\"\<Table\>\""}], "]"}], ",", 
      RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "mN", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bN\[Tau]FermilabBD", "[", "mN_", "]"}], "=", 
   RowBox[{
    RowBox[{"Interpolation", "[", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "@", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"FileNameSplit", "@", 
            RowBox[{"NotebookDirectory", "[", "]"}]}], ",", 
           "\"\<phenomenology/HNL/branching \
ratios/b_quark_noBc_to_N_mixing_tau_FermilabBD.dat\>\""}], "]"}]}], ",", 
        "\"\<Table\>\""}], "]"}], ",", 
      RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "mN", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8850196262703476`*^9, 3.8850196797921553`*^9}, {
  3.8860963571842537`*^9, 3.886096387194947*^9}, {3.893520983762703*^9, 
  3.893520983781662*^9}},
 CellTags->"Number-of-events",
 CellLabel->"In[90]:=",ExpressionUUID->"4f48ed3e-9b7d-45f9-a5cb-600b0ec25dad"]
}, Open  ]],

Cell[CellGroupData[{

Cell["4. FCC-hh", "Subsection",
 CellChangeTimes->{{3.885018410956735*^9, 3.885018411795294*^9}, 
   3.885019255625141*^9, {3.8850334852489495`*^9, 3.8850334866389227`*^9}, {
   3.8886425670846896`*^9, 3.888642603240411*^9}},
 CellTags->
  "Number-of-events",ExpressionUUID->"50717c52-c64e-43ba-aba3-c4301b76b291"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"For", " ", "the", " ", "moment"}], ",", " ", 
    RowBox[{"LHC", " ", "values", " ", "are", " ", "used"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"dNeFCChh", "[", "mN_", "]"}], "=", 
     RowBox[{
      RowBox[{"Interpolation", "[", 
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"FileNameJoin", "@", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"FileNameSplit", "@", 
              RowBox[{"NotebookDirectory", "[", "]"}]}], ",", 
             "\"\<phenomenology/HNL/branching \
ratios/c_quark_to_N_mixing_e_LHC.dat\>\""}], "]"}]}], ",", "\"\<Table\>\""}], 
         "]"}], ",", 
        RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "mN", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dN\[Mu]FCChh", "[", "mN_", "]"}], "=", 
     RowBox[{
      RowBox[{"Interpolation", "[", 
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"FileNameJoin", "@", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"FileNameSplit", "@", 
              RowBox[{"NotebookDirectory", "[", "]"}]}], ",", 
             "\"\<phenomenology/HNL/branching \
ratios/c_quark_to_N_mixing_mu_LHC.dat\>\""}], "]"}]}], ",", "\"\<Table\>\""}],
          "]"}], ",", 
        RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "mN", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dN\[Tau]FCChh", "[", "mN_", "]"}], "=", 
     RowBox[{
      RowBox[{"Interpolation", "[", 
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"FileNameJoin", "@", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"FileNameSplit", "@", 
              RowBox[{"NotebookDirectory", "[", "]"}]}], ",", 
             "\"\<phenomenology/HNL/branching \
ratios/c_quark_to_N_mixing_tau_LHC.dat\>\""}], "]"}]}], ",", 
          "\"\<Table\>\""}], "]"}], ",", 
        RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "mN", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bNeFCChh", "[", "mN_", "]"}], "=", 
     RowBox[{
      RowBox[{"Interpolation", "[", 
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"FileNameJoin", "@", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"FileNameSplit", "@", 
              RowBox[{"NotebookDirectory", "[", "]"}]}], ",", 
             "\"\<phenomenology/HNL/branching \
ratios/b_quark_to_N_mixing_e_LHC.dat\>\""}], "]"}]}], ",", "\"\<Table\>\""}], 
         "]"}], ",", 
        RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "mN", 
      "]"}]}], ";", 
    RowBox[{
     RowBox[{"bN\[Mu]FCChh", "[", "mN_", "]"}], "=", 
     RowBox[{
      RowBox[{"Interpolation", "[", 
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"FileNameJoin", "@", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"FileNameSplit", "@", 
              RowBox[{"NotebookDirectory", "[", "]"}]}], ",", 
             "\"\<phenomenology/HNL/branching \
ratios/b_quark_to_N_mixing_mu_LHC.dat\>\""}], "]"}]}], ",", "\"\<Table\>\""}],
          "]"}], ",", 
        RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "mN", 
      "]"}]}], ";", 
    RowBox[{
     RowBox[{"bN\[Tau]FCChh", "[", "mN_", "]"}], "=", 
     RowBox[{
      RowBox[{"Interpolation", "[", 
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"FileNameJoin", "@", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"FileNameSplit", "@", 
              RowBox[{"NotebookDirectory", "[", "]"}]}], ",", 
             "\"\<phenomenology/HNL/branching \
ratios/b_quark_to_N_mixing_tau_LHC.dat\>\""}], "]"}]}], ",", 
          "\"\<Table\>\""}], "]"}], ",", 
        RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "mN", 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8850184152661276`*^9, 3.8850184158264256`*^9}, {
  3.8850184542684383`*^9, 3.885018565977172*^9}, {3.885033479685088*^9, 
  3.8850335048796525`*^9}, {3.8850347528831525`*^9, 3.8850347681523733`*^9}, {
  3.888642598439249*^9, 3.8886426222723675`*^9}},
 CellTags->"Number-of-events",
 CellLabel->"In[96]:=",ExpressionUUID->"6e1b1600-9a6f-4f8c-86a5-6e16656eb692"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Production ",
 Cell[BoxData[
  FormBox[
   RowBox[{"W", "\[Rule]", " ", 
    RowBox[{"N", "+", "l"}]}], TraditionalForm]],ExpressionUUID->
  "378b5a00-316f-4134-8a25-0b33c4840c95"]
}], "Section",
 CellChangeTimes->{{3.852998401338334*^9, 3.8529984022699037`*^9}, {
  3.854440980526284*^9, 3.8544409891477003`*^9}, {3.85444167057591*^9, 
  3.8544416740999575`*^9}, {3.8850164214759026`*^9, 3.885016427606962*^9}, {
  3.885016667498554*^9, 3.8850166777388954`*^9}},
 CellTags->
  "Number-of-events",ExpressionUUID->"c587ef57-16b6-410f-a7a6-2ea564b37756"],

Cell[CellGroupData[{

Cell["Mixing case", "Subsection",
 CellChangeTimes->{{3.885016681819083*^9, 3.8850166830077286`*^9}},
 CellTags->
  "Number-of-events",ExpressionUUID->"226b3093-ec84-41d5-8009-504c31660c8d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Import", "[", 
     "\"\<https://raw.githubusercontent.com/FeynCalc/feyncalc/master/install.\
m\>\"", "]"}], "\n", 
    RowBox[{"InstallFeynCalc", "[", "]"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "SetDirectory", "[", 
     "\"\</Users/miksi/AppData/Roaming/Mathematica/Applications/FeynCalc\>\"",
      "]"}], ";"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{"<<", "FeynCalc`"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"M", "=", 
     RowBox[{
      FractionBox["g", 
       RowBox[{"2", "*", 
        RowBox[{"Sqrt", "[", "2", "]"}]}]], 
      RowBox[{
       RowBox[{"SpinorUBar", "[", 
        RowBox[{"k1", ",", "ml"}], "]"}], ".", 
       RowBox[{"GA", "[", "\[Mu]", "]"}], ".", 
       RowBox[{"(", 
        RowBox[{"1", "-", "GA5"}], ")"}], ".", 
       RowBox[{"SpinorV", "[", 
        RowBox[{"k2", ",", "mN"}], "]"}]}], "*", 
      RowBox[{"PolarizationVector", "[", 
       RowBox[{"p", ",", "\[Mu]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Mstar", " ", "=", " ", 
    RowBox[{
     RowBox[{"ComplexConjugate", "[", "M", "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{"\[Mu]", "\[Rule]", "\[Mu]C"}], "}"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Msquared", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"Expand", "[", 
        RowBox[{
         FractionBox["1", "3"], 
         RowBox[{"DoPolarizationSums", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"FermionSpinSum", "[", 
               RowBox[{"M", " ", "Mstar"}], "]"}], "/.", 
              RowBox[{"DiracTrace", "\[Rule]", "TR"}]}], "//", "Contract"}], "//",
             "Simplify"}], ",", "p"}], "]"}]}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"ScalarProduct", "[", 
           RowBox[{"p", ",", "p"}], "]"}], "\[Rule]", 
          SuperscriptBox["mW", "2"]}], ",", 
         RowBox[{
          RowBox[{"ScalarProduct", "[", 
           RowBox[{"k1", ",", "k1"}], "]"}], "\[Rule]", " ", 
          SuperscriptBox["ml", "2"]}], ",", 
         RowBox[{
          RowBox[{"ScalarProduct", "[", 
           RowBox[{"k1", ",", "p"}], "]"}], "\[Rule]", " ", 
          FractionBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["mW", "2"], "+", 
             SuperscriptBox["ml", "2"], "-", 
             SuperscriptBox["mN", "2"]}], ")"}], "2"]}], ",", 
         RowBox[{
          RowBox[{"ScalarProduct", "[", 
           RowBox[{"k2", ",", "p"}], "]"}], "\[Rule]", " ", 
          FractionBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["mN", "2"], "+", 
             SuperscriptBox["mW", "2"], "-", 
             SuperscriptBox["ml", "2"]}], ")"}], "2"]}], ",", 
         RowBox[{
          RowBox[{"ScalarProduct", "[", 
           RowBox[{"k1", ",", "k2"}], "]"}], "\[Rule]", 
          FractionBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["mW", "2"], "-", 
             SuperscriptBox["mN", "2"], "-", 
             SuperscriptBox["ml", "2"]}], ")"}], "2"]}]}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Solution", " ", "of", " ", "the", " ", "HNL", " ", "momentum", " ", "in",
      " ", "rest", " ", "frame", " ", "of", " ", "the", " ", "W", " ", 
     "boson"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PN", "[", 
      RowBox[{"mN_", ",", "mW_", ",", "ml_"}], "]"}], "=", 
     RowBox[{"p", "/.", 
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{"mW", "\[Equal]", 
          RowBox[{
           RowBox[{"Sqrt", "[", 
            RowBox[{
             SuperscriptBox["p", "2"], "+", 
             SuperscriptBox["mN", "2"]}], "]"}], "+", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             SuperscriptBox["p", "2"], "+", 
             SuperscriptBox["ml", "2"]}], "]"}]}]}], ",", "p"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Total", " ", "Br", " ", "of", " ", "the", " ", "process", " ", "W"}], 
     " ", "\[Rule]", " ", 
     RowBox[{"l", " ", "+", " ", "N"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TotalBrWtoN", "[", 
      RowBox[{"mN_", ",", "mW_", ",", "ml_", ",", "U2_"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       FractionBox["U2", "GammatotalW"], 
       FractionBox["1", 
        RowBox[{"8", "*", "Pi"}]], "Msquared", "*", 
       FractionBox[
        RowBox[{"PN", "[", 
         RowBox[{"mN", ",", "mW", ",", "ml"}], "]"}], 
        SuperscriptBox["mW", "2"]]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["g", "2"], "\[Rule]", 
        RowBox[{"4", "*", 
         RowBox[{"Sqrt", "[", "2", "]"}], "Gf", "*", 
         SuperscriptBox["mW", "2"]}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "Print", "[", 
    "\"\<Checking the correctness of the calculations - evaluation of total \
Br of decay at zero HNL mass for mixing with electron (should be 0.108, from \
pdg):\>\"", "]"}], "\[IndentingNewLine]", 
   RowBox[{"TotalBrWtoN", "[", 
    RowBox[{"0", ",", "MW", ",", "0", ",", "1"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8529984314234705`*^9, 3.8529984319002533`*^9}, {
   3.8532293561152506`*^9, 3.8532293811466484`*^9}, {3.8542931644241085`*^9, 
   3.854293201320759*^9}, {3.8542933754427185`*^9, 3.854293375573599*^9}, {
   3.8544420374418364`*^9, 3.854442039350297*^9}, {3.854465462986169*^9, 
   3.854465479207183*^9}, {3.854465516390957*^9, 3.8544655373598604`*^9}, {
   3.861953143108*^9, 3.861953143390653*^9}, {3.8659274141578007`*^9, 
   3.865927414847309*^9}, 3.8850164090987225`*^9, {3.8850164731229067`*^9, 
   3.8850164915017977`*^9}, {3.885016590659422*^9, 3.8850165959694805`*^9}, {
   3.886094251164956*^9, 3.886094254076476*^9}},
 CellTags->"Number-of-events",
 CellLabel->
  "In[100]:=",ExpressionUUID->"db96dfef-92e7-4fcf-a73f-421145b7126f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Production Z \[Rule] N+\[Nu]", "Section",
 CellChangeTimes->{{3.852998401338334*^9, 3.8529984022699037`*^9}, {
   3.854440980526284*^9, 3.854440998756501*^9}, {3.8544416770747366`*^9, 
   3.8544416787301197`*^9}, 3.885016418214981*^9, {3.8850202053675585`*^9, 
   3.885020225959137*^9}},
 CellTags->
  "Number-of-events",ExpressionUUID->"91fe10d5-b562-40de-b219-55be5523f3e0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Import", "[", 
     "\"\<https://raw.githubusercontent.com/FeynCalc/feyncalc/master/install.\
m\>\"", "]"}], "\n", 
    RowBox[{"InstallFeynCalc", "[", "]"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "SetDirectory", "[", 
     "\"\</Users/miksi/AppData/Roaming/Mathematica/Applications/FeynCalc\>\"",
      "]"}], ";"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{"<<", "FeynCalc`"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MZdecayMixing", "=", 
     RowBox[{
      RowBox[{"(", 
       FractionBox["g", 
        RowBox[{"4", "*", "cos\[Theta]W"}]], ")"}], 
      RowBox[{
       RowBox[{"SpinorUBar", "[", 
        RowBox[{"k1", ",", "0"}], "]"}], ".", 
       RowBox[{"GA", "[", "\[Mu]", "]"}], ".", 
       RowBox[{"(", 
        RowBox[{"1", "-", "GA5"}], ")"}], ".", 
       RowBox[{"SpinorV", "[", 
        RowBox[{"k2", ",", "mN"}], "]"}]}], "*", 
      RowBox[{"PolarizationVector", "[", 
       RowBox[{"p", ",", "\[Mu]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"MZdecayMixingStar", " ", "=", " ", 
    RowBox[{
     RowBox[{"ComplexConjugate", "[", "MZdecayMixing", "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{"\[Mu]", "\[Rule]", "\[Mu]C"}], "}"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MZdecayMixingSquared", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", "3"], 
          RowBox[{"DoPolarizationSums", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"FermionSpinSum", "[", 
                RowBox[{"MZdecayMixing", " ", "MZdecayMixingStar"}], "]"}], "/.", 
               RowBox[{"DiracTrace", "\[Rule]", "TR"}]}], "//", "Contract"}], 
             "//", "Simplify"}], ",", "p"}], "]"}]}], "//", "Expand"}], ")"}],
        "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"ScalarProduct", "[", 
           RowBox[{"p", ",", "p"}], "]"}], "\[Rule]", 
          SuperscriptBox["mZ", "2"]}], ",", 
         RowBox[{
          RowBox[{"ScalarProduct", "[", 
           RowBox[{"k1", ",", "k1"}], "]"}], "\[Rule]", " ", "0"}], ",", 
         RowBox[{
          RowBox[{"ScalarProduct", "[", 
           RowBox[{"k1", ",", "p"}], "]"}], "\[Rule]", " ", 
          FractionBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["mZ", "2"], "-", 
             SuperscriptBox["mN", "2"]}], ")"}], "2"]}], ",", 
         RowBox[{
          RowBox[{"ScalarProduct", "[", 
           RowBox[{"k2", ",", "p"}], "]"}], "\[Rule]", " ", 
          FractionBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["mN", "2"], "+", 
             SuperscriptBox["mZ", "2"]}], ")"}], "2"]}], ",", 
         RowBox[{
          RowBox[{"ScalarProduct", "[", 
           RowBox[{"k1", ",", "k2"}], "]"}], "\[Rule]", 
          FractionBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["mZ", "2"], "-", 
             SuperscriptBox["mN", "2"]}], ")"}], "2"]}]}], "}"}]}], "//", 
      "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "HNL", " ", "momentum", " ", "in", " ", "rest", " ", "frame", " ", "of", 
     " ", "the", " ", "Z", " ", "boson"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PNZdecayMixing", "[", 
      RowBox[{"mN_", ",", "mZ_"}], "]"}], "=", 
     RowBox[{"p", "/.", 
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{"mZ", "\[Equal]", 
          RowBox[{
           RowBox[{"Sqrt", "[", 
            RowBox[{
             SuperscriptBox["p", "2"], "+", 
             SuperscriptBox["mN", "2"]}], "]"}], "+", "p"}]}], ",", "p"}], 
        "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Total", " ", "Br"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TotalBrZtoNe", "[", 
      RowBox[{"mN_", ",", "mZ_", ",", "U2_"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       FractionBox["U2", "GammatotalZ"], 
       FractionBox["1", 
        RowBox[{"8", "*", "Pi"}]], "MZdecayMixingSquared", "*", 
       FractionBox[
        RowBox[{"PNZdecayMixing", "[", 
         RowBox[{"mN", ",", "mZ"}], "]"}], 
        SuperscriptBox["mZ", "2"]]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["g", "2"], "\[Rule]", 
        RowBox[{"4", "*", 
         RowBox[{"Sqrt", "[", "2", "]"}], "Gf", "*", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["mZ", "2"], 
           SuperscriptBox["cos\[Theta]W", "2"]}], ")"}]}]}], "}"}]}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
   "Print", "[", 
    "\"\<Checking the correctness of the calculations - evaluation of total \
Br of decay at zero HNL mass for mixing with electron (should be 0.06, from \
pdg):\>\"", "]"}], "\[IndentingNewLine]", 
   RowBox[{"TotalBrZtoNe", "[", 
    RowBox[{"0", ",", "MZ", ",", "1"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8529984314234705`*^9, 3.8529984319002533`*^9}, {
  3.8532293561152506`*^9, 3.8532293811466484`*^9}, {3.8542931644241085`*^9, 
  3.854293201320759*^9}, {3.8542933754427185`*^9, 3.854293375573599*^9}, {
  3.8544410430689726`*^9, 3.8544410755894623`*^9}, {3.854441162664857*^9, 
  3.854441165177208*^9}, {3.854441217232272*^9, 3.8544412909411764`*^9}, {
  3.8544415910336103`*^9, 3.854441622872951*^9}, {3.8544419771695957`*^9, 
  3.8544419790721874`*^9}, {3.8544420291823*^9, 3.85444203263091*^9}, {
  3.8544420712993326`*^9, 3.8544420716170063`*^9}, {3.854465450089105*^9, 
  3.8544654505001917`*^9}, {3.854465528477682*^9, 3.8544656044725513`*^9}, {
  3.854465846066965*^9, 3.8544658902574186`*^9}, {3.8850164489785085`*^9, 
  3.8850164493780537`*^9}, {3.8850165693684416`*^9, 3.8850165766004395`*^9}, {
  3.885745181258155*^9, 3.8857451833814964`*^9}},
 CellTags->"Number-of-events",
 CellLabel->
  "In[108]:=",ExpressionUUID->"2b71c445-b980-4930-acc8-25ee449aaab3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Common function", "Section",
 CellChangeTimes->{{3.8850349542806673`*^9, 3.885034956692252*^9}},
 CellTags->
  "Number-of-events",ExpressionUUID->"72e7f531-a92e-4ae3-ab1f-4f4c51dce7c3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"At", " ", 
     SuperscriptBox["U", "2"]}], " ", "=", " ", "1"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"\[Chi]MotherToN", "[", 
    RowBox[{"mN_", ",", "mixing_", ",", "mother_", ",", "facility_"}], "]"}], 
   ":=", 
   RowBox[{
    RowBox[{"Association", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mN", ",", "\"\<e\>\"", ",", "\"\<K\>\"", ",", "\"\<SPS\>\""}], 
         "}"}], "\[Rule]", 
        RowBox[{"sNeSPS", "[", "mN", "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mN", ",", "\"\<e\>\"", ",", "\"\<D\>\"", ",", "\"\<SPS\>\""}], 
         "}"}], "\[Rule]", 
        RowBox[{"dNeSPS", "[", "mN", "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mN", ",", "\"\<e\>\"", ",", "\"\<B\>\"", ",", "\"\<SPS\>\""}], 
         "}"}], "\[Rule]", 
        RowBox[{"bNeSPS", "[", "mN", "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mN", ",", "\"\<e\>\"", ",", "\"\<W\>\"", ",", "\"\<SPS\>\""}], 
         "}"}], "\[Rule]", "0"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mN", ",", "\"\<e\>\"", ",", "\"\<D\>\"", ",", "\"\<LHC\>\""}], 
         "}"}], "\[Rule]", 
        RowBox[{"dNeLHC", "[", "mN", "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mN", ",", "\"\<e\>\"", ",", "\"\<B\>\"", ",", "\"\<LHC\>\""}], 
         "}"}], "\[Rule]", 
        RowBox[{"bNeLHC", "[", "mN", "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mN", ",", "\"\<e\>\"", ",", "\"\<W\>\"", ",", "\"\<LHC\>\""}], 
         "}"}], "\[Rule]", 
        RowBox[{"TotalBrWtoN", "[", 
         RowBox[{"mN", ",", "MW", ",", "Me", ",", "1"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mN", ",", "\"\<e\>\"", ",", "\"\<D\>\"", ",", "\"\<FCC-hh\>\""}], 
         "}"}], "\[Rule]", 
        RowBox[{"dNeFCChh", "[", "mN", "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mN", ",", "\"\<e\>\"", ",", "\"\<B\>\"", ",", "\"\<FCC-hh\>\""}], 
         "}"}], "\[Rule]", 
        RowBox[{"bNeFCChh", "[", "mN", "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mN", ",", "\"\<e\>\"", ",", "\"\<W\>\"", ",", "\"\<FCC-hh\>\""}], 
         "}"}], "\[Rule]", 
        RowBox[{"TotalBrWtoN", "[", 
         RowBox[{"mN", ",", "MW", ",", "Me", ",", "1"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mN", ",", "\"\<e\>\"", ",", "\"\<D\>\"", ",", 
          "\"\<FermilabBD\>\""}], "}"}], "\[Rule]", 
        RowBox[{"dNeFermilabBD", "[", "mN", "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mN", ",", "\"\<e\>\"", ",", "\"\<B\>\"", ",", 
          "\"\<FermilabBD\>\""}], "}"}], "\[Rule]", 
        RowBox[{"bNeFermilabBD", "[", "mN", "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mN", ",", "\"\<e\>\"", ",", "\"\<W\>\"", ",", 
          "\"\<FermilabBD\>\""}], "}"}], "\[Rule]", "0"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mN", ",", "\"\<\[Mu]\>\"", ",", "\"\<K\>\"", ",", "\"\<SPS\>\""}], 
         "}"}], "\[Rule]", 
        RowBox[{"sN\[Mu]SPS", "[", "mN", "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mN", ",", "\"\<\[Mu]\>\"", ",", "\"\<D\>\"", ",", "\"\<SPS\>\""}], 
         "}"}], "\[Rule]", 
        RowBox[{"dN\[Mu]SPS", "[", "mN", "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mN", ",", "\"\<\[Mu]\>\"", ",", "\"\<B\>\"", ",", "\"\<SPS\>\""}], 
         "}"}], "\[Rule]", 
        RowBox[{"bN\[Mu]SPS", "[", "mN", "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mN", ",", "\"\<\[Mu]\>\"", ",", "\"\<W\>\"", ",", "\"\<SPS\>\""}], 
         "}"}], "\[Rule]", "0"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mN", ",", "\"\<\[Mu]\>\"", ",", "\"\<D\>\"", ",", "\"\<LHC\>\""}], 
         "}"}], "\[Rule]", 
        RowBox[{"dN\[Mu]LHC", "[", "mN", "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mN", ",", "\"\<\[Mu]\>\"", ",", "\"\<B\>\"", ",", "\"\<LHC\>\""}], 
         "}"}], "\[Rule]", 
        RowBox[{"bN\[Mu]LHC", "[", "mN", "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mN", ",", "\"\<\[Mu]\>\"", ",", "\"\<W\>\"", ",", "\"\<LHC\>\""}], 
         "}"}], "\[Rule]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"mN", "<", 
           RowBox[{"MW", "-", "M\[Mu]"}]}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"TotalBrWtoN", "[", 
             RowBox[{"mN", ",", "MW", ",", "M\[Mu]", ",", "1"}], "]"}], ",", 
            "0"}], "]"}]}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mN", ",", "\"\<\[Mu]\>\"", ",", "\"\<D\>\"", ",", 
          "\"\<FCC-hh\>\""}], "}"}], "\[Rule]", 
        RowBox[{"dN\[Mu]FCChh", "[", "mN", "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mN", ",", "\"\<\[Mu]\>\"", ",", "\"\<B\>\"", ",", 
          "\"\<FCC-hh\>\""}], "}"}], "\[Rule]", 
        RowBox[{"bN\[Mu]FCChh", "[", "mN", "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mN", ",", "\"\<\[Mu]\>\"", ",", "\"\<W\>\"", ",", 
          "\"\<FCC-hh\>\""}], "}"}], "\[Rule]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"mN", "<", 
           RowBox[{"MW", "-", "M\[Mu]"}]}], ",", 
          RowBox[{"TotalBrWtoN", "[", 
           RowBox[{"mN", ",", "MW", ",", "M\[Mu]", ",", "1"}], "]"}], ",", 
          "0"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mN", ",", "\"\<\[Mu]\>\"", ",", "\"\<D\>\"", ",", 
          "\"\<FermilabBD\>\""}], "}"}], "\[Rule]", 
        RowBox[{"dNeFermilabBD", "[", "mN", "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mN", ",", "\"\<\[Mu]\>\"", ",", "\"\<B\>\"", ",", 
          "\"\<FermilabBD\>\""}], "}"}], "\[Rule]", 
        RowBox[{"bN\[Mu]FermilabBD", "[", "mN", "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mN", ",", "\"\<\[Mu]\>\"", ",", "\"\<W\>\"", ",", 
          "\"\<FermilabBD\>\""}], "}"}], "\[Rule]", "0"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mN", ",", "\"\<\[Tau]\>\"", ",", "\"\<K\>\"", ",", "\"\<SPS\>\""}], 
         "}"}], "\[Rule]", "0"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mN", ",", "\"\<\[Tau]\>\"", ",", "\"\<D\>\"", ",", "\"\<SPS\>\""}], 
         "}"}], "\[Rule]", 
        RowBox[{"dN\[Tau]SPS", "[", "mN", "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mN", ",", "\"\<\[Tau]\>\"", ",", "\"\<B\>\"", ",", "\"\<SPS\>\""}], 
         "}"}], "\[Rule]", 
        RowBox[{"bN\[Tau]SPS", "[", "mN", "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mN", ",", "\"\<\[Tau]\>\"", ",", "\"\<W\>\"", ",", "\"\<SPS\>\""}], 
         "}"}], "\[Rule]", "0"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mN", ",", "\"\<\[Tau]\>\"", ",", "\"\<D\>\"", ",", "\"\<LHC\>\""}], 
         "}"}], "\[Rule]", 
        RowBox[{"dN\[Tau]LHC", "[", "mN", "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mN", ",", "\"\<\[Tau]\>\"", ",", "\"\<B\>\"", ",", "\"\<LHC\>\""}], 
         "}"}], "\[Rule]", 
        RowBox[{"bN\[Tau]LHC", "[", "mN", "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mN", ",", "\"\<\[Tau]\>\"", ",", "\"\<W\>\"", ",", "\"\<LHC\>\""}], 
         "}"}], "\[Rule]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"mN", "<", 
           RowBox[{"MW", "-", "M\[Tau]"}]}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"TotalBrWtoN", "[", 
            RowBox[{"mN", ",", "MW", ",", "M\[Tau]", ",", "1"}], "]"}], "]"}],
           ",", "0"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mN", ",", "\"\<\[Tau]\>\"", ",", "\"\<D\>\"", ",", 
          "\"\<FCC-hh\>\""}], "}"}], "\[Rule]", 
        RowBox[{"dN\[Tau]FCChh", "[", "mN", "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mN", ",", "\"\<\[Tau]\>\"", ",", "\"\<B\>\"", ",", 
          "\"\<FCC-hh\>\""}], "}"}], "\[Rule]", 
        RowBox[{"bN\[Tau]FCChh", "[", "mN", "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mN", ",", "\"\<\[Tau]\>\"", ",", "\"\<W\>\"", ",", 
          "\"\<FCC-hh\>\""}], "}"}], "\[Rule]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"mN", "<", 
           RowBox[{"MW", "-", "M\[Tau]"}]}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"TotalBrWtoN", "[", 
            RowBox[{"mN", ",", "MW", ",", "M\[Tau]", ",", "1"}], "]"}], "]"}],
           ",", "0"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mN", ",", "\"\<\[Tau]\>\"", ",", "\"\<D\>\"", ",", 
          "\"\<FermilabBD\>\""}], "}"}], "\[Rule]", 
        RowBox[{"dN\[Tau]FermilabBD", "[", "mN", "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mN", ",", "\"\<\[Tau]\>\"", ",", "\"\<B\>\"", ",", 
          "\"\<FermilabBD\>\""}], "}"}], "\[Rule]", 
        RowBox[{"bN\[Tau]FermilabBD", "[", "mN", "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mN", ",", "\"\<\[Tau]\>\"", ",", "\"\<W\>\"", ",", 
          "\"\<FermilabBD\>\""}], "}"}], "\[Rule]", "0"}]}], "}"}], "]"}], 
    "[", 
    RowBox[{"{", 
     RowBox[{"mN", ",", "mixing", ",", "mother", ",", "facility"}], "}"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8850349598999557`*^9, 3.885034998962782*^9}, {
  3.88503503438378*^9, 3.8850350485567656`*^9}, {3.8850350983246903`*^9, 
  3.8850354114905777`*^9}, {3.885035516853142*^9, 3.885035521220829*^9}, {
  3.886096374062831*^9, 3.886096374062831*^9}, {3.8860964116673555`*^9, 
  3.886096498465475*^9}, {3.8886426817430363`*^9, 3.888642682026207*^9}, {
  3.8886427134840884`*^9, 3.888642742378552*^9}, {3.892106240622266*^9, 
  3.892106304428671*^9}, {3.8935209838165593`*^9, 3.8935209838695*^9}, {
  3.902564449644393*^9, 3.902564476864433*^9}, {3.902565207597576*^9, 
  3.902565210603054*^9}, {3.902650225574105*^9, 3.9026502312701807`*^9}},
 CellTags->"Number-of-events",
 CellLabel->
  "In[116]:=",ExpressionUUID->"4aac5d21-8162-4c0e-9325-f06b4ee86be8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "HNL decay width, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Br", "vis"], ","}], TraditionalForm]],ExpressionUUID->
  "e7302982-0d79-45b9-a399-e042373019a9"],
 " and decay length"
}], "Chapter",
 CellChangeTimes->{
  3.885017078882038*^9, {3.885019704621191*^9, 3.8850197055215096`*^9}, {
   3.885020570751961*^9, 3.885020573429635*^9}},
 CellTags->
  "Number-of-events",ExpressionUUID->"60a54273-5d77-45a3-902e-f9d9518fcef5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalGamma]table", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<phenomenology/HNL/decay widths/HNLdecayWidth.dat\>\""}], "}"}], 
      "]"}], ",", "\"\<Table\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalGamma]tote", "[", 
    RowBox[{"mN_", ",", "U2_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"10", "^", 
      RowBox[{
       RowBox[{"Interpolation", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"Log10", "[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "+", 
               SuperscriptBox["10", 
                RowBox[{"-", "99"}]]}], "]"}]}], "}"}], "&"}], "/@", 
          RowBox[{"\[CapitalGamma]table", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}]}], ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "mN", 
       "]"}]}], ")"}], "*", "U2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalGamma]tot\[Mu]", "[", 
    RowBox[{"mN_", ",", "U2_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"10", "^", 
      RowBox[{
       RowBox[{"Interpolation", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"Log10", "[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "+", 
               SuperscriptBox["10", 
                RowBox[{"-", "99"}]]}], "]"}]}], "}"}], "&"}], "/@", 
          RowBox[{"\[CapitalGamma]table", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}]}], ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "mN", 
       "]"}]}], ")"}], "*", "U2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalGamma]tot\[Tau]", "[", 
    RowBox[{"mN_", ",", "U2_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"10", "^", 
      RowBox[{
       RowBox[{"Interpolation", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"Log10", "[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "+", 
               SuperscriptBox["10", 
                RowBox[{"-", "99"}]]}], "]"}]}], "}"}], "&"}], "/@", 
          RowBox[{"\[CapitalGamma]table", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "4"}], "}"}]}], "]"}], "]"}]}], ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "mN", 
       "]"}]}], ")"}], "*", "U2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogLogPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[CapitalGamma]tote", "[", 
      RowBox[{"mN", ",", "1"}], "]"}], ",", 
     RowBox[{"\[CapitalGamma]tot\[Mu]", "[", 
      RowBox[{"mN", ",", "1"}], "]"}], ",", 
     RowBox[{"\[CapitalGamma]tot\[Tau]", "[", 
      RowBox[{"mN", ",", "1"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"mN", ",", "0.7", ",", "1.5"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8159886811363955`*^9, 3.815988742442053*^9}, {
   3.815988970156649*^9, 3.8159889717583675`*^9}, {3.815989442389176*^9, 
   3.815989500713952*^9}, {3.8159897029001865`*^9, 3.815989725059951*^9}, {
   3.8159898025517473`*^9, 3.8159899080108905`*^9}, {3.8159900166175056`*^9, 
   3.815990030505353*^9}, {3.8159912386658363`*^9, 3.8159912410414867`*^9}, {
   3.8159913268170643`*^9, 3.815991336688678*^9}, {3.815992386769696*^9, 
   3.81599241008737*^9}, {3.8159925911357193`*^9, 3.815992597578498*^9}, {
   3.815992814895997*^9, 3.8159929637397223`*^9}, {3.815994199513012*^9, 
   3.815994257175153*^9}, {3.816936219340331*^9, 3.8169363061302767`*^9}, {
   3.8169364379591513`*^9, 3.8169364398992386`*^9}, {3.8178969880500407`*^9, 
   3.817896993900795*^9}, 3.8190961956827545`*^9, {3.8200560843689384`*^9, 
   3.8200561841430073`*^9}, {3.8200567228913713`*^9, 
   3.8200567539682293`*^9}, {3.8200574714534793`*^9, 
   3.8200574845514383`*^9}, {3.8213416649656687`*^9, 
   3.8213416906679688`*^9}, {3.8213417357962513`*^9, 
   3.8213417396309958`*^9}, {3.8545205576570625`*^9, 
   3.8545205846259394`*^9}, {3.8545233418598423`*^9, 3.854523350645748*^9}, {
   3.856627269577365*^9, 3.856627301111126*^9}, {3.8566273375470023`*^9, 
   3.856627415801448*^9}, {3.8850179806928935`*^9, 3.8850180714824705`*^9}, {
   3.885020251682765*^9, 3.8850202880618*^9}, {3.885020344620401*^9, 
   3.885020421901428*^9}, {3.8850204975717707`*^9, 3.8850205646137075`*^9}, {
   3.885031900589696*^9, 3.885032028241062*^9}, {3.886092163254841*^9, 
   3.8860921634591393`*^9}, {3.8897689595439043`*^9, 3.889769080704334*^9}, {
   3.8897691439212103`*^9, 3.889769180289068*^9}, {3.8913189051213193`*^9, 
   3.8913189059828205`*^9}, {3.9049029561291513`*^9, 
   3.9049029564747405`*^9}, {3.904903644986633*^9, 3.904903654507643*^9}, {
   3.9049037626142178`*^9, 3.9049037628181453`*^9}, {3.9049038011719437`*^9, 
   3.9049038089139233`*^9}, {3.9049039865940804`*^9, 3.9049039875751715`*^9}},
 CellTags->"Number-of-events",
 CellLabel->
  "In[117]:=",ExpressionUUID->"8ce29ddb-125d-4cc8-b503-8b6d70a0d9d3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Compilable interpolation function mapping one grid into another\
\>", "Chapter",
 CellChangeTimes->{{3.891315426588935*^9, 3.891315432542842*^9}},
 CellTags->
  "Number-of-events",ExpressionUUID->"23566021-74ee-425f-bef4-d18db859e808"],

Cell[CellGroupData[{

Cell["3D to 3D", "Subsection",
 CellChangeTimes->{{3.8906627216475997`*^9, 3.8906627248020773`*^9}, {
  3.8907326559924955`*^9, 3.89073265766968*^9}},
 CellTags->
  "Number-of-events",ExpressionUUID->"c1e82f8a-85f0-4536-8e85-0e0dcad7fdd1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nd", "=", "3"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"cf3", "=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"xgvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<xg\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"igvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<ig\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"tgvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<tg\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"ivars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<i\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"svars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<s\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"tvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<t\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"jvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<j\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}]}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Inactivate", "[", 
         RowBox[{
          RowBox[{"Compile", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"seq", "@", 
               RowBox[{"{", 
                RowBox[{"xgvars", ",", "_Real", ",", "1"}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", "_Real", ",", "nd"}], "}"}]}], "}"}], ",", 
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"seq", "@", "igvars"}], ",", 
                RowBox[{"seq", "@", "tgvars"}], ",", 
                RowBox[{"seq", "@", "ivars"}], ",", 
                RowBox[{"seq", "@", "svars"}], ",", 
                RowBox[{"seq", "@", "tvars"}]}], "}"}], ",", 
              RowBox[{
               RowBox[{"seq", "[", 
                RowBox[{"igvars", "=", 
                 RowBox[{
                  RowBox[{"Floor", "[", "xgvars", "]"}], "-", 
                  RowBox[{"UnitStep", "[", 
                   RowBox[{"xgvars", "-", 
                    RowBox[{"indexed", "@", 
                    RowBox[{"Dimensions", "@", "y"}]}]}], "]"}]}]}], "]"}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"seq", "[", 
                RowBox[{"tgvars", "=", 
                 RowBox[{"xgvars", "-", "igvars"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"seq", "[", 
                   RowBox[{"tvars", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"tgvars", ",", "jvars"}], "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"seq", "[", 
                   RowBox[{"ivars", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"igvars", ",", "jvars"}], "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"seq", "[", 
                   RowBox[{"svars", "=", 
                    RowBox[{"1.", "-", "tvars"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"eval", "@", 
                   RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Times", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], " ", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], "]"}]}], 
                    "&"}], "/@", 
                    RowBox[{"Tuples", "@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"svars", ",", "ivars"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"tvars", ",", 
                    RowBox[{"ivars", "+", "1"}]}], "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}]}]}], 
                    "]"}]}]}], ",", 
                 RowBox[{"seq", "@", 
                  RowBox[{"{", 
                   RowBox[{"jvars", ",", 
                    RowBox[{"Length", "@", "igvars"}]}], "}"}]}]}], "]"}]}]}],
              "]"}], ",", 
            RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
            RowBox[{"RuntimeAttributes", "\[Rule]", 
             RowBox[{"{", "Listable", "}"}]}], ",", 
            RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
            RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}], 
          ",", 
          RowBox[{"Except", "[", 
           RowBox[{"seq", "|", "eval", "|", "indexed"}], "]"}]}], "]"}], "/.", 
        RowBox[{
         RowBox[{"seq", "[", "expr_", "]"}], "\[RuleDelayed]", 
         RowBox[{"RuleCondition", "@", 
          RowBox[{"(", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Inactivate", "[", 
                RowBox[{"expr", ",", 
                 RowBox[{"Except", "[", 
                  RowBox[{"slist", "|", "indexed"}], "]"}]}], "]"}], "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"l_slist", "\[RuleDelayed]", 
                  RowBox[{"l", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"indexed", "[", "l_", "]"}], "\[RuleDelayed]", 
                  RowBox[{
                   RowBox[{"Inactive", "[", "Compile`GetElement", "]"}], "[", 
                   RowBox[{"l", ",", "i"}], "]"}]}]}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "nd"}], "}"}]}], "]"}]}], ")"}]}]}]}], "/.", 
       RowBox[{
        RowBox[{"eval", "@", "expr_"}], "\[RuleDelayed]", 
        RowBox[{"RuleCondition", "[", 
         RowBox[{"Activate", "[", 
          RowBox[{"expr", "/.", 
           RowBox[{"slist", "\[Rule]", "List"}]}], "]"}], "]"}]}]}]}], "]"}], 
    "//", "Activate"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.890711783488103*^9, 3.89071178348964*^9}, {
  3.8907121412539587`*^9, 3.8907121413711557`*^9}, {3.890712694841427*^9, 
  3.8907126950000925`*^9}, {3.890712790376151*^9, 3.8907128219919777`*^9}, {
  3.891018553068019*^9, 3.8910185548862777`*^9}},
 CellTags->"Number-of-events",
 CellLabel->
  "In[122]:=",ExpressionUUID->"7aebc60c-e948-4b7f-8ca6-b5d1d7138b67"]
}, Open  ]],

Cell[CellGroupData[{

Cell["4D to 4D", "Subsection",
 CellChangeTimes->{{3.8906627216475997`*^9, 3.8906627248020773`*^9}, {
  3.8907326559924955`*^9, 3.890732670187893*^9}},
 CellTags->
  "Number-of-events",ExpressionUUID->"a79e9cb4-42ab-4573-ba44-bc65fae822e7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nd", "=", "4"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"cf4", "=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"xgvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<xg\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"igvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<ig\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"tgvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<tg\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"ivars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<i\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"svars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<s\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"tvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<t\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"jvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<j\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}]}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Inactivate", "[", 
         RowBox[{
          RowBox[{"Compile", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"seq", "@", 
               RowBox[{"{", 
                RowBox[{"xgvars", ",", "_Real", ",", "1"}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", "_Real", ",", "nd"}], "}"}]}], "}"}], ",", 
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"seq", "@", "igvars"}], ",", 
                RowBox[{"seq", "@", "tgvars"}], ",", 
                RowBox[{"seq", "@", "ivars"}], ",", 
                RowBox[{"seq", "@", "svars"}], ",", 
                RowBox[{"seq", "@", "tvars"}]}], "}"}], ",", 
              RowBox[{
               RowBox[{"seq", "[", 
                RowBox[{"igvars", "=", 
                 RowBox[{
                  RowBox[{"Floor", "[", "xgvars", "]"}], "-", 
                  RowBox[{"UnitStep", "[", 
                   RowBox[{"xgvars", "-", 
                    RowBox[{"indexed", "@", 
                    RowBox[{"Dimensions", "@", "y"}]}]}], "]"}]}]}], "]"}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"seq", "[", 
                RowBox[{"tgvars", "=", 
                 RowBox[{"xgvars", "-", "igvars"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"seq", "[", 
                   RowBox[{"tvars", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"tgvars", ",", "jvars"}], "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"seq", "[", 
                   RowBox[{"ivars", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"igvars", ",", "jvars"}], "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"seq", "[", 
                   RowBox[{"svars", "=", 
                    RowBox[{"1.", "-", "tvars"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"eval", "@", 
                   RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Times", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], " ", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], "]"}]}], 
                    "&"}], "/@", 
                    RowBox[{"Tuples", "@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"svars", ",", "ivars"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"tvars", ",", 
                    RowBox[{"ivars", "+", "1"}]}], "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}]}]}], 
                    "]"}]}]}], ",", 
                 RowBox[{"seq", "@", 
                  RowBox[{"{", 
                   RowBox[{"jvars", ",", 
                    RowBox[{"Length", "@", "igvars"}]}], "}"}]}]}], "]"}]}]}],
              "]"}], ",", 
            RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
            RowBox[{"RuntimeAttributes", "\[Rule]", 
             RowBox[{"{", "Listable", "}"}]}], ",", 
            RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
            RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}], 
          ",", 
          RowBox[{"Except", "[", 
           RowBox[{"seq", "|", "eval", "|", "indexed"}], "]"}]}], "]"}], "/.", 
        RowBox[{
         RowBox[{"seq", "[", "expr_", "]"}], "\[RuleDelayed]", 
         RowBox[{"RuleCondition", "@", 
          RowBox[{"(", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Inactivate", "[", 
                RowBox[{"expr", ",", 
                 RowBox[{"Except", "[", 
                  RowBox[{"slist", "|", "indexed"}], "]"}]}], "]"}], "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"l_slist", "\[RuleDelayed]", 
                  RowBox[{"l", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"indexed", "[", "l_", "]"}], "\[RuleDelayed]", 
                  RowBox[{
                   RowBox[{"Inactive", "[", "Compile`GetElement", "]"}], "[", 
                   RowBox[{"l", ",", "i"}], "]"}]}]}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "nd"}], "}"}]}], "]"}]}], ")"}]}]}]}], "/.", 
       RowBox[{
        RowBox[{"eval", "@", "expr_"}], "\[RuleDelayed]", 
        RowBox[{"RuleCondition", "[", 
         RowBox[{"Activate", "[", 
          RowBox[{"expr", "/.", 
           RowBox[{"slist", "\[Rule]", "List"}]}], "]"}], "]"}]}]}]}], "]"}], 
    "//", "Activate"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8907148978688216`*^9, 3.890714898931299*^9}, {
  3.8910185630697727`*^9, 3.8910185650759544`*^9}},
 CellTags->"Number-of-events",
 CellLabel->
  "In[124]:=",ExpressionUUID->"af32635a-daf1-4cf6-908b-07263d4288f5"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Specifying the experiment and HNL", "Title",
 CellChangeTimes->{{3.8876178747397523`*^9, 3.8876178773785458`*^9}, {
  3.8888191963965187`*^9, 3.8888191979428654`*^9}},
 CellTags->
  "Number-of-events",ExpressionUUID->"6aee5356-b39c-45f1-83d9-c276143eb260"],

Cell[CellGroupData[{

Cell["HNL", "Chapter",
 CellChangeTimes->{{3.9027285799460387`*^9, 3.90272858025308*^9}},
 CellTags->
  "Number-of-events",ExpressionUUID->"5b02137e-da6c-4b5c-af74-2eb5ac2b44ac"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ListHNLtype", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<Dirac\>\"", ",", "\"\<Majorana\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HNLtype", "=", 
   RowBox[{"dropdownDialog", "[", 
    RowBox[{"ListHNLtype", ",", "\"\<Select the HNL type:\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<HNL type:\>\"", 
  "]"}], "\[IndentingNewLine]", "HNLtype", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "MixingPatterne", ",", "MixingPattern\[Mu]", ",", "MixingPattern\[Tau]"}],
     "}"}], "=", 
   RowBox[{
    RowBox[{"DialogInput", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pattern", "=", 
        RowBox[{"{", 
         RowBox[{"1.", ",", "0.", ",", "0."}], "}"}]}], "}"}], ",", 
      RowBox[{"Column", "[", 
       RowBox[{"{", 
        RowBox[{
        "\"\<Enter the mixing pattern \
\!\(\*SubscriptBox[SuperscriptBox[\(U\), \(2\)], \
\(e\)]\):\!\(\*SubscriptBox[SuperscriptBox[\(U\), \(2\)], \
\(\[Mu]\)]\):\!\(\*SubscriptBox[SuperscriptBox[\(U\), \(2\)], \(\[Tau]\)]\) = \
\!\(\*SuperscriptBox[\(U\), \(2\)]\)(\!\(\*SubscriptBox[\(x\), \
\(e\)]\):\!\(\*SubscriptBox[\(x\), \(\[Mu]\)]\):\!\(\*SubscriptBox[\(x\), \(\
\[Tau]\)]\)) (where \!\(\*SubscriptBox[\(\[CapitalSigma]\), \
\(i\)]\)\!\(\*SubscriptBox[\(x\), \(i\)]\) = 1) in the form \
{xe,x\[Mu],x\[Tau]}:\>\"", ",", 
         RowBox[{"InputField", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "pattern", "]"}], ",", "Expression"}], 
          "]"}], ",", 
         RowBox[{"Button", "[", 
          RowBox[{"\"\<Proceed\>\"", ",", 
           RowBox[{"DialogReturn", "[", "pattern", "]"}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "Automatic"}]}], "]"}]}], "}"}], 
       "]"}]}], "]"}], "//", "N"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Mixing pattern:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"MixingPattern", "=", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
      "MixingPatterne", "+", "MixingPattern\[Mu]", "+", 
       "MixingPattern\[Tau]"}], ")"}], 
     RowBox[{"-", "1"}]], 
    RowBox[{"{", 
     RowBox[{
     "MixingPatterne", ",", "MixingPattern\[Mu]", ",", 
      "MixingPattern\[Tau]"}], "}"}]}], "//", "N"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalGamma]totN", "[", 
    RowBox[{"mN_", ",", "U2_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"HNLtype", "\[Equal]", "\"\<Dirac\>\""}], ",", 
      RowBox[{"1", "/", "2"}], ",", "1"}], "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"MixingPattern", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "*", 
       RowBox[{"\[CapitalGamma]tote", "[", 
        RowBox[{"mN", ",", "U2"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"MixingPattern", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "*", 
       RowBox[{"\[CapitalGamma]tot\[Mu]", "[", 
        RowBox[{"mN", ",", "U2"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"MixingPattern", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "*", 
       RowBox[{"\[CapitalGamma]tot\[Tau]", "[", 
        RowBox[{"mN", ",", "U2"}], "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"c\[Tau]N", "[", 
    RowBox[{"mN_", ",", "U2_"}], "]"}], "=", 
   FractionBox["chbar", 
    RowBox[{"\[CapitalGamma]totN", "[", 
     RowBox[{"mN", ",", "U2"}], "]"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ldecayN", "[", 
    RowBox[{"mN_", ",", "U2_", ",", "EN_"}], "]"}], "=", 
   RowBox[{
    FractionBox[
     SqrtBox[
      RowBox[{
       SuperscriptBox["EN", "2"], "-", 
       SuperscriptBox["mN", "2"]}]], "mN"], "*", 
    RowBox[{"c\[Tau]N", "[", 
     RowBox[{"mN", ",", "U2"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9061842350144906`*^9, 3.9061843007091036`*^9}},
 CellTags->"Number-of-events",
 CellLabel->
  "In[126]:=",ExpressionUUID->"43688868-e9bd-4ecd-99df-1169d9e58d62"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Experiments", "Chapter",
 CellChangeTimes->{{3.9027285799460387`*^9, 3.9027285850167294`*^9}},
 CellTags->
  "Number-of-events",ExpressionUUID->"bf0d84bb-c61a-4372-9cdb-367edc141ad2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Parent", " ", "directory"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NotebookDirectory", "[", "]"}], "//", "ParentDirectory"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AcceptanceDirectory", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Acceptances\>\""}], 
     "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExperimentDirectoriesList", "=", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"FileNames", "[", 
       RowBox[{"\"\<*\>\"", ",", "AcceptanceDirectory", ",", "1"}], "]"}], 
      ",", "DirectoryQ"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"List", " ", "of", " ", "available", " ", "experiments", " ", 
    RowBox[{"(", 
     RowBox[{
     "for", " ", "which", " ", "the", " ", "geometry", " ", "has", " ", 
      "been", " ", "implemented"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentsListTemp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"FileNameTake", "[", 
      RowBox[{
       RowBox[{"ExperimentDirectoriesList", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"-", "1"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "ExperimentDirectoriesList", "]"}], ",", "1"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentsListTemp2", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Partition", "[", 
      RowBox[{"ExperimentsListTemp", ",", "1"}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"TrueQ", "@", 
         RowBox[{"FileExistsQ", "@", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"NotebookDirectory", "[", "]"}], ",", 
             "\"\<Acceptances\>\"", ",", 
             RowBox[{"ExperimentsListTemp", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"ToString", "@", 
              RowBox[{"StringForm", "[", 
               RowBox[{"\"\<Acceptance_``_for_HNL-mixing-e.m\>\"", ",", 
                RowBox[{"ExperimentsListTemp", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], "}"}], 
           "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "ExperimentsListTemp", "]"}]}], "}"}]}], 
      "]"}], ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentsListTemp3", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"ExperimentsListTemp2", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", 
        RowBox[{"{", "1", "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"TrueQ", "@", 
         RowBox[{"FileExistsQ", "@", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"NotebookDirectory", "[", "]"}], ",", 
             "\"\<Acceptances\>\"", ",", 
             RowBox[{
              RowBox[{"ExperimentsListTemp2", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"ToString", "@", 
              RowBox[{"StringForm", "[", 
               RowBox[{"\"\<Acceptance_``_for_HNL-mixing-mu.m\>\"", ",", 
                RowBox[{
                 RowBox[{"ExperimentsListTemp2", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "}"}], 
           "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "ExperimentsListTemp2", "]"}]}], "}"}]}], 
      "]"}], ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentsListTemp4", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"ExperimentsListTemp3", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", 
        RowBox[{"{", "1", "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"TrueQ", "@", 
         RowBox[{"FileExistsQ", "@", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"NotebookDirectory", "[", "]"}], ",", 
             "\"\<Acceptances\>\"", ",", 
             RowBox[{
              RowBox[{"ExperimentsListTemp3", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"ToString", "@", 
              RowBox[{"StringForm", "[", 
               RowBox[{"\"\<Acceptance_``_for_HNL-mixing-tau.m\>\"", ",", 
                RowBox[{
                 RowBox[{"ExperimentsListTemp3", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "}"}], 
           "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "ExperimentsListTemp3", "]"}]}], "}"}]}], 
      "]"}], ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ExperimentsList", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{"ExperimentsListTemp4", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "True"}], "&"}]}], "]"}],
     "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", 
   "Sort"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", "ExperimentsList", "]"}], "\[Equal]", "0"}], ",", 
   RowBox[{
   "Print", "[", 
    "\"\<No experiment is available, generate first the acceptance for the \
given experiment using module 1\>\"", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Selected experiments:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"selectionDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", 
      RowBox[{"{", "}"}]}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{
        "{", "\"\<Select the experiments for which the number of events will \
be computed:\>\"", "}"}], "]"}], ",", 
       RowBox[{"Pane", "[", 
        RowBox[{
         RowBox[{"TogglerBar", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list", ",", 
           RowBox[{"Appearance", "->", 
            RowBox[{"\"\<Vertical\>\"", "->", 
             RowBox[{"{", 
              RowBox[{"Automatic", ",", "5"}], "}"}]}]}]}], "]"}], ",", 
         RowBox[{"ImageSize", "->", 
          RowBox[{"{", 
           RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], ",", 
         RowBox[{"Scrollbars", "->", 
          RowBox[{"{", 
           RowBox[{"False", ",", "True"}], "}"}]}]}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"SelectedExperimentList", "=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "ExperimentsList", "]"}], "\[NotEqual]", "0"}], 
    ",", 
    RowBox[{"selectionDialog", "[", 
     RowBox[{"ExperimentsList", ",", "\"\<Select the experiments:\>\""}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"icounter", "=", "1"}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8851403254718485`*^9, 3.8851403429411273`*^9}, {
   3.8854395484478483`*^9, 3.885439559226637*^9}, {3.8854397351242537`*^9, 
   3.885439739219259*^9}, {3.8858794196350574`*^9, 3.885879423032172*^9}, {
   3.8865840272667904`*^9, 3.8865840338661537`*^9}, {3.886607744879512*^9, 
   3.886607745774307*^9}, {3.8872732396769423`*^9, 3.887273255436386*^9}, {
   3.887276631938718*^9, 3.887276634618329*^9}, {3.887276937792802*^9, 
   3.8872769418915215`*^9}, {3.887278937383339*^9, 3.887278940392472*^9}, {
   3.887616450031478*^9, 3.887616452738494*^9}, {3.8876165118788147`*^9, 
   3.887616536357917*^9}, {3.887616583272811*^9, 3.887616613175548*^9}, {
   3.887620318755148*^9, 3.8876203205821953`*^9}, {3.8876324144338245`*^9, 
   3.887632416400697*^9}, {3.887772846060255*^9, 3.8877729560180535`*^9}, {
   3.888377893669921*^9, 3.8883779148425026`*^9}, {3.888380182047347*^9, 
   3.888380266214329*^9}, {3.8888188937293386`*^9, 3.8888189661788025`*^9}, {
   3.888819109452669*^9, 3.888819109639008*^9}, {3.8888191954565873`*^9, 
   3.888819255480569*^9}, {3.888819492067113*^9, 3.8888196279493523`*^9}, {
   3.889769218774189*^9, 3.889769266526089*^9}, {3.8904482370890455`*^9, 
   3.8904482605909295`*^9}, {3.89208996357168*^9, 3.8920899725400596`*^9}, {
   3.8921110030369463`*^9, 3.8921110290305853`*^9}, 3.8921110632787223`*^9, {
   3.892111711813961*^9, 3.892111719191961*^9}, {3.8921117518579416`*^9, 
   3.892111754967971*^9}, {3.8921117999712076`*^9, 3.892111800286845*^9}, {
   3.8921125181524467`*^9, 3.892112518627368*^9}, {3.8926994021374636`*^9, 
   3.89269940915271*^9}, {3.892699456280077*^9, 3.892699497276529*^9}, {
   3.8926995560368094`*^9, 3.89269969587647*^9}, {3.8932345800980372`*^9, 
   3.89323458382977*^9}, {3.8932562309421606`*^9, 3.893256263737067*^9}, 
   3.9027286111757326`*^9, {3.902728991480379*^9, 3.9027290878754635`*^9}, {
   3.902729584713502*^9, 3.902729585732702*^9}, {3.9028220170727324`*^9, 
   3.9028220286172953`*^9}, {3.904898265894932*^9, 3.9048982689551115`*^9}},
 CellTags->"Number-of-events",
 CellLabel->
  "In[136]:=",ExpressionUUID->"393e1e21-5cde-41a9-ad41-077747a91d52"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Running block for next sections", "Chapter",
 CellChangeTimes->{{3.902729140157612*^9, 3.90272914444062*^9}},
 CellTags->
  "Number-of-events",ExpressionUUID->"e0515968-6d3b-4786-9380-8f6efe4a3b24"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BlockEvaluation", "[", "tag_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nb", "=", 
      RowBox[{"EvaluationNotebook", "[", "]"}]}], ";", "\n", 
     RowBox[{"NotebookFind", "[", 
      RowBox[{"nb", ",", "tag", ",", "All", ",", "CellTags"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"tagselected", "==", "\"\<Number-of-events\>\""}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
      "BlockEvaluation", "[", "\"\<Number-of-events-computation\>\"", "]"}], 
      ";"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"icounter", ",", "1", ",", 
       RowBox[{"Length", "[", "SelectedExperimentList", "]"}], ",", "1"}], 
      "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"tagselected", "==", "\"\<Acceptance\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
        "BlockEvaluation", "[", "\"\<Acceptance-computation\>\"", "]"}], 
        ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"icounter", ",", "1", ",", 
         RowBox[{"Length", "[", "SelectedExperimentList", "]"}], ",", "1"}], 
        "}"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.9027291581950865`*^9, 3.902729215695462*^9}, {
   3.902761777481885*^9, 3.902761802513644*^9}, {3.9028220263736563`*^9, 
   3.9028220265994596`*^9}, 3.9038926310354977`*^9},
 CellTags->"Number-of-events",
 CellLabel->
  "In[151]:=",ExpressionUUID->"977ebf96-c528-46df-9e58-09288035e8b1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Number of events", "Title",
 CellChangeTimes->{{3.8850206136728783`*^9, 3.885020619208237*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"7ba28ec5-2133-49aa-b270-\
328c555fa667"],

Cell[CellGroupData[{

Cell["Cross-sections, acceptances", "Chapter",
 CellChangeTimes->{{3.885020695565913*^9, 3.885020698644303*^9}, {
   3.8866052332485933`*^9, 3.8866052373066683`*^9}, 3.887617904598539*^9, 
   3.8929716629809437`*^9, {3.894637289635679*^9, 3.8946372934959445`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"7bea3ddf-2062-4996-86eb-\
43158cd187b5"],

Cell[CellGroupData[{

Cell["Azimuthal acceptance", "Section",
 CellChangeTimes->{{3.89200413151959*^9, 3.8920041352516775`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"33c6f4da-aa46-4293-b09c-\
5bf1476c4879"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SelectedExperiment", "=", 
   RowBox[{"SelectedExperimentList", "[", 
    RowBox[{"[", 
     RowBox[{"icounter", "++"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dataAcceptancesMixinge", "=", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<Acceptances\>\"", ",", "SelectedExperiment", ",", 
           RowBox[{"ToString", "@", 
            RowBox[{"StringForm", "[", 
             RowBox[{
             "\"\<Acceptance_``_for_HNL-mixing-e.m\>\"", ",", 
              "SelectedExperiment"}], "]"}]}]}], "}"}], "]"}], "}"}], "]"}], 
      ",", "\"\<MX\>\""}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dataAcceptancesMixing\[Mu]", "=", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<Acceptances\>\"", ",", "SelectedExperiment", ",", 
           RowBox[{"ToString", "@", 
            RowBox[{"StringForm", "[", 
             RowBox[{
             "\"\<Acceptance_``_for_HNL-mixing-mu.m\>\"", ",", 
              "SelectedExperiment"}], "]"}]}]}], "}"}], "]"}], "}"}], "]"}], 
      ",", "\"\<MX\>\""}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dataAcceptancesMixing\[Tau]", "=", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<Acceptances\>\"", ",", "SelectedExperiment", ",", 
           RowBox[{"ToString", "@", 
            RowBox[{"StringForm", "[", 
             RowBox[{
             "\"\<Acceptance_``_for_HNL-mixing-tau.m\>\"", ",", 
              "SelectedExperiment"}], "]"}]}]}], "}"}], "]"}], "}"}], "]"}], 
      ",", "\"\<MX\>\""}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ECALoption", "=", 
   RowBox[{"dataAcceptancesMixinge", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FacilityGivenExperiment", "=", 
   RowBox[{"dataAcceptancesMixinge", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "FullAcceptanceHNLmixingeData", ",", "FullAcceptanceHNLmixing\[Mu]Data", 
     ",", "FullAcceptanceHNLmixing\[Tau]Data"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dataAcceptancesMixinge", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"dataAcceptancesMixing\[Mu]", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"dataAcceptancesMixing\[Tau]", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"BrVisMixingTemp", "[", 
      RowBox[{"mFIP_", ",", "\"\<e\>\""}], "]"}], ",", 
     RowBox[{"BrVisMixingTemp", "[", 
      RowBox[{"mFIP_", ",", "\"\<\[Mu]\>\""}], "]"}], ",", 
     RowBox[{"BrVisMixingTemp", "[", 
      RowBox[{"mFIP_", ",", "\"\<\[Tau]\>\""}], "]"}]}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dataAcceptancesMixinge", "[", 
      RowBox[{"[", "5", "]"}], "]"}], ",", 
     RowBox[{"dataAcceptancesMixing\[Mu]", "[", 
      RowBox[{"[", "5", "]"}], "]"}], ",", 
     RowBox[{"dataAcceptancesMixing\[Tau]", "[", 
      RowBox[{"[", "5", "]"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlistBr", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{"m", ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "0.02", ",", "5.1", ",", "0.001"}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"Table", "[", 
      RowBox[{"m", ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "5.12", ",", "20", ",", "0.01"}], "}"}]}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"BrVisMixing", "[", 
      RowBox[{"mFIP_", ",", "\"\<e\>\""}], "]"}], ",", 
     RowBox[{"BrVisMixing", "[", 
      RowBox[{"mFIP_", ",", "\"\<\[Mu]\>\""}], "]"}], ",", 
     RowBox[{"BrVisMixing", "[", 
      RowBox[{"mFIP_", ",", "\"\<\[Tau]\>\""}], "]"}]}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Interpolation", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"mFIP", ",", 
            RowBox[{"BrVisMixingTemp", "[", 
             RowBox[{"mFIP", ",", "\"\<e\>\""}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"mFIP", ",", "mlistBr"}], "}"}]}], "]"}], ",", 
        RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", "mFIP", 
      "]"}], ",", 
     RowBox[{
      RowBox[{"Interpolation", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"mFIP", ",", 
            RowBox[{"BrVisMixingTemp", "[", 
             RowBox[{"mFIP", ",", "\"\<\[Mu]\>\""}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"mFIP", ",", "mlistBr"}], "}"}]}], "]"}], ",", 
        RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", "mFIP", 
      "]"}], ",", 
     RowBox[{
      RowBox[{"Interpolation", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"mFIP", ",", 
            RowBox[{"BrVisMixingTemp", "[", 
             RowBox[{"mFIP", ",", "\"\<\[Tau]\>\""}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"mFIP", ",", "mlistBr"}], "}"}]}], "]"}], ",", 
        RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", "mFIP", 
      "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BrVisMean", "[", "mFIP_", "]"}], "=", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"BrVisMixing", "[", 
       RowBox[{"mFIP", ",", "\"\<e\>\""}], "]"}], "*", 
      RowBox[{"MixingPattern", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"BrVisMixing", "[", 
       RowBox[{"mFIP", ",", "\"\<\[Mu]\>\""}], "]"}], "*", 
      RowBox[{"MixingPattern", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"BrVisMixing", "[", 
       RowBox[{"mFIP", ",", "\"\<\[Tau]\>\""}], "]"}], "*", 
      RowBox[{"MixingPattern", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}]}], 
    RowBox[{
     RowBox[{"MixingPattern", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "+", 
     RowBox[{"MixingPattern", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "+", 
     RowBox[{"MixingPattern", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"BrVisMixing", "[", 
      RowBox[{"mFIP", ",", "\"\<e\>\""}], "]"}], ",", 
     RowBox[{"BrVisMixing", "[", 
      RowBox[{"mFIP", ",", "\"\<\[Mu]\>\""}], "]"}], ",", 
     RowBox[{"BrVisMixing", "[", 
      RowBox[{"mFIP", ",", "\"\<\[Tau]\>\""}], "]"}], ",", 
     RowBox[{"BrVisMean", "[", "mFIP", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"mFIP", ",", 
     RowBox[{"Min", "[", "mlistBr", "]"}], ",", "7"}], "}"}], ",", 
   RowBox[{"FrameStyle", "\[Rule]", 
    RowBox[{"Directive", "[", 
     RowBox[{"Black", ",", " ", "22"}], "]"}]}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Blue"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
        RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
        RowBox[{"Darker", "@", 
         RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Black"}], "}"}]}], 
     "}"}]}], ",", 
   RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.02", ",", "7"}], "}"}], ",", "All"}], "}"}]}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(m\), \(N\)]\) [GeV]\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(Br\), \(vis\)]\)\>\""}], "}"}]}], ",", 
   RowBox[{"PlotLabel", "\[Rule]", " ", 
    RowBox[{"Style", "[", 
     RowBox[{
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{
        "\"\<For \>\"", ",", "SelectedExperiment", ",", 
         "\"\<. \!\(\*SuperscriptBox[SubscriptBox[\(U\), \(e\)], \
\(2\)]\):\!\(\*SuperscriptBox[SubscriptBox[\(U\), \(\[Mu]\)], \
\(2\)]\):\!\(\*SuperscriptBox[SubscriptBox[\(U\), \(\[Tau]\)], \(2\)]\) = \
\>\"", ",", "MixingPattern"}], "}"}], "]"}], ",", " ", "20", ",", " ", 
      "Black"}], "]"}]}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"Placed", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"#", ",", " ", "18"}], "]"}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Pure e mixing\>\"", ",", "\"\<Pure \[Mu] mixing\>\"", ",", 
          "\"\<Pure \[Tau] mixing\>\"", ",", "\"\<Averaged\>\""}], "}"}]}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.75", ",", "0.2"}], "}"}]}], "]"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AzimuthalAcceptanceData", "=", 
    RowBox[{
     RowBox[{"DeleteDuplicatesBy", "[", 
      RowBox[{"FullAcceptanceHNLmixingeData", ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "&"}]}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "4", ",", "5"}], "}"}]}], "]"}], "]"}]}], ";"}], "//",
   "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]Grid", "=", 
   RowBox[{"DeleteDuplicates", "[", 
    RowBox[{"AzimuthalAcceptanceData", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zminmax\[Theta]data", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"MinMax", "[", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"AzimuthalAcceptanceData", ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "==", 
            RowBox[{"\[Theta]Grid", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "&&", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "\[NotEqual]", "0"}]}], "&"}]}], 
        "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "\[Theta]Grid", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zmin\[Theta]", "[", "\[Theta]N_", "]"}], "=", 
   RowBox[{
    RowBox[{"Interpolation", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{"\[Theta]Grid", ",", "1"}], "]"}], ",", 
        RowBox[{"zminmax\[Theta]data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", "1", "}"}]}], "]"}], "]"}], ",", "2"}], "]"}], ",", 
      RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
    "\[Theta]N", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zmax\[Theta]", "[", "\[Theta]N_", "]"}], "=", 
   RowBox[{
    RowBox[{"Interpolation", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{"\[Theta]Grid", ",", "1"}], "]"}], ",", 
        RowBox[{"zminmax\[Theta]data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}], "]"}], ",", "2"}], "]"}], ",", 
      RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
    "\[Theta]N", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AzimuthalAcceptanceHNL", "[", 
   RowBox[{"\[Theta]N_", ",", "zN_"}], "]"}], "=", 
  RowBox[{
   RowBox[{"Interpolation", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"#", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}], "/@", 
      "AzimuthalAcceptanceData"}], ",", 
     RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
   RowBox[{"\[Theta]N", ",", "zN"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.892004256634206*^9, 3.8920042711234274`*^9}, {
  3.892004325362145*^9, 3.8920043340861855`*^9}, {3.892011608600587*^9, 
  3.892011610670393*^9}, {3.8920128583973293`*^9, 3.892012864224994*^9}, {
  3.8921125214499855`*^9, 3.8921125217184653`*^9}, {3.9027617889926863`*^9, 
  3.9027617983984814`*^9}, {3.9028039993439894`*^9, 3.9028040026815987`*^9}, {
  3.9028220346020303`*^9, 3.902822035699456*^9}, {3.904104132359496*^9, 
  3.9041041418640566`*^9}, {3.9048897186955442`*^9, 3.904889777304414*^9}, {
  3.904898371967775*^9, 3.9048983752727375`*^9}, {3.904899233785304*^9, 
  3.904899397789362*^9}, {3.9049021449949007`*^9, 3.904902178948921*^9}, {
  3.9049023022870607`*^9, 3.9049024546124444`*^9}, {3.9049024862827535`*^9, 
  3.904902532791299*^9}, {3.904902633924299*^9, 3.9049026819306192`*^9}, {
  3.9049027208790665`*^9, 3.904902724295291*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[153]:=",ExpressionUUID->"e03f9bc7-6459-479a-ba16-970233bed763"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.887616632812935*^9, 3.8876168497686005`*^9}, {
   3.888251530196273*^9, 3.8882515340160594`*^9}, 3.8882534456879063`*^9, {
   3.8884784564935985`*^9, 3.888478513515301*^9}, {3.889769450733754*^9, 
   3.8897695160785046`*^9}, {3.890276444268669*^9, 3.8902765197982826`*^9}, {
   3.8902769753320246`*^9, 3.890277063848443*^9}, {3.89029301158574*^9, 
   3.8902930326548223`*^9}, {3.890450545303482*^9, 3.8904505545644875`*^9}, {
   3.8906407235353084`*^9, 3.8906407314124126`*^9}, {3.8906408349101224`*^9, 
   3.8906408684018974`*^9}, {3.890640931765955*^9, 3.8906411157907934`*^9}, {
   3.8906413239966087`*^9, 3.890641351146014*^9}, {3.8906416293135357`*^9, 
   3.8906417006238556`*^9}, 3.890649737845924*^9, {3.8907327710594864`*^9, 
   3.8907328244291196`*^9}, {3.890841045817673*^9, 3.8908410473572907`*^9}, {
   3.8908411795939927`*^9, 3.8908412559394007`*^9}, {3.8908816406962395`*^9, 
   3.8908816414138947`*^9}, {3.8910185044000244`*^9, 
   3.8910185055215836`*^9}, {3.891018598736998*^9, 3.8910186531034822`*^9}, {
   3.8910187603916593`*^9, 3.8910188102489433`*^9}, {3.8910189914791217`*^9, 
   3.8910190052678776`*^9}, {3.8910190582236977`*^9, 
   3.8910190891531334`*^9}, {3.8910191525376396`*^9, 
   3.8910191962576494`*^9}, {3.8910192415536337`*^9, 3.891019242051064*^9}, {
   3.891019278738369*^9, 3.891019289551962*^9}, {3.8922836313067636`*^9, 
   3.892283672257635*^9}, {3.8922839861466465`*^9, 3.892284023704517*^9}, {
   3.8922848675053596`*^9, 3.8922848910145073`*^9}, {3.892286670688157*^9, 
   3.892286670906936*^9}, {3.8925415783035374`*^9, 3.892541579018721*^9}, {
   3.892910981609494*^9, 3.8929109821176815`*^9}, {3.8931718223536196`*^9, 
   3.8931718380115795`*^9}, {3.89322450856604*^9, 3.893224512604451*^9}, {
   3.8946364771706233`*^9, 3.894636590020763*^9}, {3.8946366257009597`*^9, 
   3.894636704342059*^9}, {3.894637111414814*^9, 3.894637139145834*^9}, {
   3.895054585436878*^9, 3.895054597657593*^9}, {3.897208167605433*^9, 
   3.8972081790966396`*^9}, 3.8972082634740195`*^9, {3.899198048024173*^9, 
   3.899198070580115*^9}, {3.9026481259639745`*^9, 3.902648129112234*^9}, {
   3.9027636496644955`*^9, 3.902763650168706*^9}, {3.904889793908601*^9, 
   3.9048897953457546`*^9}, {3.904898805074805*^9, 3.904898805137748*^9}, {
   3.9048989514118404`*^9, 3.9048990615643806`*^9}, 3.904899199522458*^9},
 CellLabel->
  "In[451]:=",ExpressionUUID->"3ba53de7-f86a-4383-9147-a3c7461a6505"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cross-sections, decay acceptance", "Section",
 CellChangeTimes->{{3.892004139641836*^9, 3.8920041442348332`*^9}, {
  3.8946373125523567`*^9, 3.894637318944414*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"4df1b4f3-a8c2-4a94-a2ad-\
f3dee43536c2"],

Cell[CellGroupData[{

Cell["Definitions", "Subsection",
 CellChangeTimes->{{3.8969511112079268`*^9, 3.896951112715564*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"92d4e288-d0dd-4f6d-83fd-\
d1e7ba70c173"],

Cell[BoxData[{
 RowBox[{"datachange", "=", 
  RowBox[{
   RowBox[{"Hold", "@", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"data", ",", "_Real", ",", "2"}], "}"}], "}"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"data", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"data", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"data", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"data", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"data", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "data", "]"}], ",", "1"}], "}"}]}], "]"}]}], 
     "]"}]}], "//", "ReleaseHold"}]}], "\[IndentingNewLine]", 
 RowBox[{"datachange1", "=", 
  RowBox[{"Compile", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"data", ",", "_Real", ",", "2"}], "}"}], "}"}], ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Log10", "[", 
         RowBox[{
          RowBox[{"data", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
        RowBox[{"Log10", "[", 
         RowBox[{
          RowBox[{"data", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
        RowBox[{"Log10", "[", 
         RowBox[{
          RowBox[{"data", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
        RowBox[{"Log10", "[", 
         RowBox[{
          RowBox[{"data", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"data", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "6", "]"}], "]"}], "\[Equal]", "0"}], ",", 
          RowBox[{"-", "90."}], ",", 
          RowBox[{"Log10", "[", 
           RowBox[{
            RowBox[{"data", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "6", "]"}], "]"}], "]"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "data", "]"}], ",", "1"}], "}"}]}], "]"}], ",", 
    RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
    RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"datachange2", "=", 
  RowBox[{
   RowBox[{"Hold", "@", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"data", ",", "_Real", ",", "2"}], "}"}], "}"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Log10", "[", 
           RowBox[{
            RowBox[{"data", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Log10", "[", 
           RowBox[{
            RowBox[{"data", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Log10", "[", 
           RowBox[{
            RowBox[{"data", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Log10", "[", 
           RowBox[{
            RowBox[{"data", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"data", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "5", "]"}], "]"}], "*", 
              RowBox[{
               RowBox[{"data", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "6", "]"}], "]"}]}], "\[Equal]", "0"}], ",", 
            RowBox[{"-", "90."}], ",", 
            RowBox[{"Log10", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"data", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "5", "]"}], "]"}], "*", 
              RowBox[{
               RowBox[{"data", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "6", "]"}], "]"}]}], "]"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "data", "]"}], ",", "1"}], "}"}]}], "]"}]}], 
     "]"}]}], "//", "ReleaseHold"}]}]}], "Input",
 CellChangeTimes->{{3.896951278945584*^9, 3.89695132329615*^9}, 
   3.8971993490452995`*^9},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[171]:=",ExpressionUUID->"fd8fa112-ff83-46c7-8706-1b78711e430d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cross-sections and acceptances", "Subsection",
 CellChangeTimes->{{3.8969511112079268`*^9, 3.896951128415675*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"af668fbc-e22d-4e0b-911e-\
f57f149e2428"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Theta]minExpAll", ",", "\[Theta]maxExpAll"}], "}"}], "=", 
   RowBox[{"MinMax", "[", 
    RowBox[{"FullAcceptanceHNLmixingeData", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Theta]minExp", ",", "\[Theta]maxExp"}], "}"}], "=", 
   RowBox[{"MinMax", "[", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"FullAcceptanceHNLmixingeData", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "6", "]"}], "]"}], "\[NotEqual]", "0"}], "&"}]}], 
      "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"zminExp", ",", "zmaxExp"}], "}"}], "=", 
   RowBox[{"MinMax", "[", 
    RowBox[{"FullAcceptanceHNLmixingeData", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mgrid\[Epsilon]", "=", 
    RowBox[{"DeleteDuplicates", "[", 
     RowBox[{"FullAcceptanceHNLmixingeData", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Computing", " ", "weights", " ", "for", " ", "decays", " ", "via", " ", 
    "different", " ", 
    RowBox[{"mixing", ".", " ", "The"}], " ", "weights", " ", "are", " ", 
    SubscriptBox["Br", 
     RowBox[{"vis", ",", "x"}]], "*", 
    RowBox[{
     RowBox[{
      SubscriptBox[
       SuperscriptBox["U", "2"], "x"], "/", 
      SuperscriptBox["U", "2"]}], "/", 
     SubscriptBox["\[CapitalSigma]", "x"]}], 
    SubscriptBox["Br", 
     RowBox[{"vis", ",", "x"}]], "*", 
    RowBox[{
     SubscriptBox[
      SuperscriptBox["U", "2"], "x"], "/", 
     SuperscriptBox["U", "2"]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Weight\[Epsilon]DecayMixing", "=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Partition", "[", 
       RowBox[{"mgrid\[Epsilon]", ",", "1"}], "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         FractionBox["1", 
          RowBox[{
           RowBox[{
            RowBox[{"BrVisMixing", "[", 
             RowBox[{"#", ",", "\"\<e\>\""}], "]"}], "*", 
            RowBox[{"MixingPattern", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"BrVisMixing", "[", 
             RowBox[{"#", ",", "\"\<\[Mu]\>\""}], "]"}], "*", 
            RowBox[{"MixingPattern", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"BrVisMixing", "[", 
             RowBox[{"#", ",", "\"\<\[Tau]\>\""}], "]"}], "*", 
            RowBox[{"MixingPattern", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}]}]], 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"BrVisMixing", "[", 
             RowBox[{"#", ",", "\"\<e\>\""}], "]"}], "*", 
            RowBox[{"MixingPattern", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"BrVisMixing", "[", 
             RowBox[{"#", ",", "\"\<\[Mu]\>\""}], "]"}], "*", 
            RowBox[{"MixingPattern", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"BrVisMixing", "[", 
             RowBox[{"#", ",", "\"\<\[Tau]\>\""}], "]"}], "*", 
            RowBox[{"MixingPattern", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], "&"}], "/@", 
       "mgrid\[Epsilon]"}], ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"The", " ", "averaged", " ", "decay", " ", 
     RowBox[{"acceptance", ":", " ", 
      RowBox[{
      "the", " ", "weights", " ", "for", " ", "the", " ", "given", " ", 
       "mass", " ", "and", " ", "flavor", " ", "are", " ", "contracted", " ", 
       "with", " ", "the", " ", "lists", " ", "of", " ", "the", " ", "decay", 
       " ", "acceptances", " ", "for", " ", "the", " ", "same", " ", "mass", 
       " ", "and", " ", "flavor"}]}]}], ",", " ", 
    RowBox[{
    "and", " ", "then", " ", "there", " ", "is", " ", "a", " ", "summation", 
     " ", "over", " ", "flavors"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Epsilon]DecayDataFinalTemp", "=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"datachange", "[", "FullAcceptanceHNLmixingeData", "]"}], ",", 
      RowBox[{
       RowBox[{"List", "/@", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Weight\[Epsilon]DecayMixing", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}], " ", 
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{"FullAcceptanceHNLmixingeData", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", 
               RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
            FractionBox[
             RowBox[{"Length", "[", "FullAcceptanceHNLmixingeData", "]"}], 
             RowBox[{"Length", "[", "mgrid\[Epsilon]", "]"}]]}], "]"}]}], 
         "]"}]}], "+", 
       RowBox[{"List", "/@", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Weight\[Epsilon]DecayMixing", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "3"}], "]"}], "]"}], " ", 
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{"FullAcceptanceHNLmixing\[Mu]Data", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", 
               RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
            FractionBox[
             RowBox[{"Length", "[", "FullAcceptanceHNLmixing\[Mu]Data", "]"}], 
             RowBox[{"Length", "[", "mgrid\[Epsilon]", "]"}]]}], "]"}]}], 
         "]"}]}], "+", 
       RowBox[{"List", "/@", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Weight\[Epsilon]DecayMixing", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "4"}], "]"}], "]"}], " ", 
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{"FullAcceptanceHNLmixing\[Tau]Data", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", 
               RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
            FractionBox[
             RowBox[{
             "Length", "[", "FullAcceptanceHNLmixing\[Tau]Data", "]"}], 
             RowBox[{"Length", "[", "mgrid\[Epsilon]", "]"}]]}], "]"}]}], 
         "]"}]}]}], ",", "2"}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DecayAcceptanceHNL", "[", 
     RowBox[{"mN_", ",", "\[Theta]N_", ",", "EN_", ",", "zN_"}], "]"}], "=", 
    RowBox[{
     RowBox[{"BrVisMean", "[", "mN", "]"}], "*", 
     RowBox[{"10", "^", 
      RowBox[{
       RowBox[{"Interpolation", "[", 
        RowBox[{
         RowBox[{"datachange1", "[", "\[Epsilon]DecayDataFinalTemp", "]"}], 
         ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
       RowBox[{
        RowBox[{"Log10", "[", "mN", "]"}], ",", 
        RowBox[{"Log10", "[", "\[Theta]N", "]"}], ",", 
        RowBox[{"Log10", "[", "EN", "]"}], ",", 
        RowBox[{"Log10", "[", "zN", "]"}]}], "]"}]}]}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Epsilon]FullDecayDataFinal", "=", 
   RowBox[{"datachange2", "[", "\[Epsilon]DecayDataFinalTemp", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CrossSectionData", "=", 
   RowBox[{
    RowBox[{"dataAcceptancesMixinge", "[", 
     RowBox[{"[", "4", "]"}], "]"}], "//", "Transpose"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NpotGivenExperiment", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"CrossSectionData", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<Npot\>\""}], 
         "&"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Amounts", " ", 
     RowBox[{"(", 
      RowBox[{"per", " ", "PoT"}], ")"}], " ", "of", " ", "c", " ", "or", " ", 
     OverscriptBox["c", "_"]}], ",", " ", 
    RowBox[{"b", " ", "or", " ", 
     OverscriptBox["b", "_"]}], ",", " ", 
    RowBox[{"and", " ", 
     SuperscriptBox["W", "+"], " ", "or", " ", 
     SuperscriptBox["W", "-"], " ", "at", " ", "the", " ", "given", " ", 
     "experiment"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Chi]Prod", "[", "\"\<D\>\"", "]"}], ",", 
    RowBox[{"\[Chi]Prod", "[", "\"\<B\>\"", "]"}], ",", 
    RowBox[{"\[Chi]Prod", "[", "\"\<W\>\"", "]"}]}], "}"}], "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"CrossSectionData", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<Pc\>\""}], 
         "&"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"CrossSectionData", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<Pb\>\""}], 
         "&"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"CrossSectionData", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<PW\>\""}], 
         "&"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Chi]Prod", "[", "\"\<K\>\"", "]"}], "=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"StringContainsQ", "[", 
        RowBox[{"SelectedExperiment", ",", "\"\<SHiP\>\""}], "]"}], "==", 
       "True"}], ",", "0.36", ",", "0"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"infoDialog", "[", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{
      "\"\<The number of proton collisions is \>\"", ",", " ", 
       "NpotGivenExperiment", ",", 
       "\"\<. You may change it at the stage of computing the sensitivities\>\
\""}], "}"}], "]"}], "]"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{
   "\"\<Search for \>\"", ",", "HNLtype", ",", 
    "\"\< HNLs with the mixing pattern {\!\(\*SuperscriptBox[SubscriptBox[\(U\
\), \(e\)], \(2\)]\),\!\(\*SuperscriptBox[SubscriptBox[\(U\), \(\[Mu]\)], \(2\
\)]\),\!\(\*SuperscriptBox[SubscriptBox[\(U\), \(\[Tau]\)], \(2\)]\)} = \
\!\(\*SuperscriptBox[\(U\), \(2\)]\)\>\"", ",", "MixingPattern", ",", 
    "\"\< at \>\"", ",", " ", "SelectedExperiment", ",", " ", 
    "\"\< located at \>\"", ",", "FacilityGivenExperiment", ",", 
    "\"\<. \!\(\*SubscriptBox[\(N\), \(collisions\)]\) = \>\"", ",", 
    "NpotGivenExperiment"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\"\<Quantity\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(min\)]\), rad\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(max\)]\), rad\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(min\)]\)(\!\(\*SubscriptBox[\(\
\[Epsilon]\), \(dec\)]\)), rad\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(max\)]\)(\!\(\*SubscriptBox[\(\
\[Epsilon]\), \(dec\)]\)), rad\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(z\), \(min\)]\), m\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(z\), \(max\)]\), m\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Description\>\"", ",", "\"\<Min angle covered by experiment\>\"", 
      ",", "\"\<Max angle covered by experiment\>\"", ",", 
      "\"\<Min angle where \!\(\*SubscriptBox[\(\[Epsilon]\), \(decay\)]\)\
\[NotEqual]0\>\"", ",", 
      "\"\<Max angle where \!\(\*SubscriptBox[\(\[Epsilon]\), \(decay\)]\)\
\[NotEqual]0\>\"", ",", "\"\<Min long. displacement of the decay volume\>\"", 
      ",", "\"\<Max long. displacement of the decay volume\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Value\>\"", ",", "\[Theta]minExpAll", ",", "\[Theta]maxExpAll", ",",
       "\[Theta]minExp", ",", "\[Theta]maxExp", ",", "zminExp", ",", 
      "zmaxExp"}], "}"}]}], "}"}], "//", "TableForm"}]}], "Input",
 CellChangeTimes->{{3.891315308224288*^9, 3.8913153110660887`*^9}, {
   3.8913158304028397`*^9, 3.891315862718624*^9}, {3.8913159157318444`*^9, 
   3.891315970713377*^9}, {3.8913160267144423`*^9, 3.891316034141837*^9}, {
   3.891316089710725*^9, 3.891316101231227*^9}, {3.8913161474704547`*^9, 
   3.89131614787755*^9}, {3.891316238215657*^9, 3.8913163831091485`*^9}, {
   3.8913165129401426`*^9, 3.8913166300849023`*^9}, {3.891316672115941*^9, 
   3.891316672245857*^9}, 3.8913167291998386`*^9, {3.891316825368518*^9, 
   3.891316839778103*^9}, {3.891316891928527*^9, 3.8913169262768917`*^9}, {
   3.8913171592161474`*^9, 3.8913171599501677`*^9}, {3.891317190715637*^9, 
   3.8913172062263737`*^9}, {3.8913186861471825`*^9, 3.891318812766123*^9}, {
   3.8913189249072776`*^9, 3.891318958288825*^9}, {3.891319009728053*^9, 
   3.8913191347713833`*^9}, {3.891319277374112*^9, 3.891319493871276*^9}, {
   3.8913196077942634`*^9, 3.8913196213301167`*^9}, 3.8920043244078417`*^9, 
   3.8920128528642344`*^9, {3.892012886145022*^9, 3.8920128863401785`*^9}, {
   3.892013662596407*^9, 3.892013776668276*^9}, {3.892013813764868*^9, 
   3.8920138493870564`*^9}, {3.892014583682519*^9, 3.8920145841511574`*^9}, {
   3.892014689359964*^9, 3.892014709544155*^9}, {3.8920152709759784`*^9, 
   3.892015300595564*^9}, {3.8920153416749783`*^9, 3.892015393532316*^9}, {
   3.8920154260349045`*^9, 3.8920155117747793`*^9}, {3.892015651978213*^9, 
   3.892015674470864*^9}, {3.892111787564196*^9, 3.892111795925839*^9}, {
   3.8927016880195646`*^9, 3.892701746477866*^9}, {3.8927017827343802`*^9, 
   3.892701787591179*^9}, 3.8927018393316965`*^9, {3.892702567938387*^9, 
   3.892702606886529*^9}, {3.8927029057694335`*^9, 3.8927029086724358`*^9}, {
   3.8946373066556077`*^9, 3.8946373070013933`*^9}, {3.89505423160577*^9, 
   3.8950542340107393`*^9}, {3.896951133656664*^9, 3.896951344185539*^9}, {
   3.899198136872904*^9, 3.8991981751825795`*^9}, {3.9025645117995453`*^9, 
   3.902564547286093*^9}, {3.9025647702408857`*^9, 3.9025647751143465`*^9}, {
   3.902649870848279*^9, 3.902649873673538*^9}, {3.9048994251428843`*^9, 
   3.9048994457332363`*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[174]:=",ExpressionUUID->"d9a1f761-9bdf-4507-8e27-ee1a512a1916"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Angle-energy distributions and differential yields for the given experiment\
\>", "Chapter",
 CellChangeTimes->{{3.885020702966837*^9, 3.885020711525731*^9}, {
   3.8850216924759345`*^9, 3.8850216984444695`*^9}, {3.8876176312518067`*^9, 
   3.8876176344488187`*^9}, 3.896335055106412*^9},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"ca43363e-b0ad-42a8-bb80-\
42168c339006"],

Cell[CellGroupData[{

Cell["HNL distributions", "Section",
 CellChangeTimes->{{3.8850207275443482`*^9, 3.885020730624566*^9}, 
   3.8850217020674453`*^9},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"d974a6c9-acdd-4497-9845-\
1bd5a79901ed"],

Cell[CellGroupData[{

Cell["Checking if all the relevant files are present", "Subsection",
 CellChangeTimes->{{3.892090334184732*^9, 3.892090339581479*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"a36175a0-adde-42a3-9bf4-\
632241e06c09"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"HNLdistributionFileNames", "[", 
   RowBox[{"facility_", ",", "mixing_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Association", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<SPS\>\"", ",", "\"\<e\>\""}], "}"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<DoubleDistr-From-D-Mixing-e-SPS.dat\>\"", ",", 
         "\"\<DoubleDistr-From-B-Mixing-e-SPS.dat\>\"", ",", 
         "\"\<DoubleDistr-From-K-Mixing-e-SPS.dat\>\""}], "}"}]}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<SPS\>\"", ",", "\"\<\[Mu]\>\""}], "}"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<DoubleDistr-From-D-Mixing-mu-SPS.dat\>\"", ",", 
         "\"\<DoubleDistr-From-B-Mixing-mu-SPS.dat\>\"", ",", 
         "\"\<DoubleDistr-From-K-Mixing-mu-SPS.dat\>\""}], "}"}]}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<SPS\>\"", ",", "\"\<\[Tau]\>\""}], "}"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<DoubleDistr-From-D-Mixing-tau-SPS.dat\>\"", ",", 
         "\"\<DoubleDistr-From-B-Mixing-tau-SPS.dat\>\""}], "}"}]}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<LHC\>\"", ",", "\"\<e\>\""}], "}"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<DoubleDistr-From-D-Mixing-e-LHC.dat\>\"", ",", 
         "\"\<DoubleDistr-From-B-Mixing-e-LHC.dat\>\"", ",", 
         "\"\<DoubleDistr-From-W-Mixing-e-LHC.dat\>\""}], "}"}]}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<LHC\>\"", ",", "\"\<\[Mu]\>\""}], "}"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<DoubleDistr-From-D-Mixing-mu-LHC.dat\>\"", ",", 
         "\"\<DoubleDistr-From-B-Mixing-mu-LHC.dat\>\"", ",", 
         "\"\<DoubleDistr-From-W-Mixing-mu-LHC.dat\>\""}], "}"}]}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<LHC\>\"", ",", "\"\<\[Tau]\>\""}], "}"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<DoubleDistr-From-D-Mixing-tau-LHC.dat\>\"", ",", 
         "\"\<DoubleDistr-From-B-Mixing-tau-LHC.dat\>\"", ",", 
         "\"\<DoubleDistr-From-W-Mixing-tau-LHC.dat\>\""}], "}"}]}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<FermilabBD\>\"", ",", "\"\<e\>\""}], "}"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<DoubleDistr-From-D-Mixing-e-FermilabBD.dat\>\"", ",", 
         "\"\<DoubleDistr-From-B-Mixing-e-FermilabBD.dat\>\""}], "}"}]}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<FermilabBD\>\"", ",", "\"\<\[Mu]\>\""}], "}"}], 
       "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<DoubleDistr-From-D-Mixing-mu-FermilabBD.dat\>\"", ",", 
         "\"\<DoubleDistr-From-B-Mixing-mu-FermilabBD.dat\>\""}], "}"}]}], 
      ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<FermilabBD\>\"", ",", "\"\<\[Tau]\>\""}], "}"}], 
       "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<DoubleDistr-From-D-Mixing-tau-FermilabBD.dat\>\"", ",", 
         "\"\<DoubleDistr-From-B-Mixing-tau-FermilabBD.dat\>\""}], "}"}]}], 
      ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<FCC-hh\>\"", ",", "\"\<e\>\""}], "}"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<DoubleDistr-From-D-Mixing-e-FCC-hh.dat\>\"", ",", 
         "\"\<DoubleDistr-From-B-Mixing-e-FCC-hh.dat\>\"", ",", 
         "\"\<DoubleDistr-From-W-Mixing-e-FCC-hh.dat\>\""}], "}"}]}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<FCC-hh\>\"", ",", "\"\<\[Mu]\>\""}], "}"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<DoubleDistr-From-D-Mixing-mu-FCC-hh.dat\>\"", ",", 
         "\"\<DoubleDistr-From-B-Mixing-mu-FCC-hh.dat\>\"", ",", 
         "\"\<DoubleDistr-From-W-Mixing-mu-FCC-hh.dat\>\""}], "}"}]}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<FCC-hh\>\"", ",", "\"\<\[Tau]\>\""}], "}"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<DoubleDistr-From-D-Mixing-tau-FCC-hh.dat\>\"", ",", 
         "\"\<DoubleDistr-From-B-Mixing-tau-FCC-hh.dat\>\"", ",", 
         "\"\<DoubleDistr-From-W-Mixing-tau-FCC-hh.dat\>\""}], "}"}]}]}], 
     "}"}], "]"}], "[", 
   RowBox[{"{", 
    RowBox[{"facility", ",", "mixing"}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HNLdistributionFileNamesGivenExpe", "=", 
   RowBox[{"HNLdistributionFileNames", "[", 
    RowBox[{"FacilityGivenExperiment", ",", "\"\<e\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HNLdistributionFileNamesGivenExp\[Mu]", "=", 
   RowBox[{"HNLdistributionFileNames", "[", 
    RowBox[{"FacilityGivenExperiment", ",", "\"\<\[Mu]\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HNLdistributionFileNamesGivenExp\[Tau]", "=", 
   RowBox[{"HNLdistributionFileNames", "[", 
    RowBox[{"FacilityGivenExperiment", ",", "\"\<\[Tau]\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"!", 
      RowBox[{"TrueQ", "@", 
       RowBox[{"FileExistsQ", "@", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<spectra/New physics particles spectra/HNLs/\>\"", ",", 
           RowBox[{"HNLdistributionFileNamesGivenExpe", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "}"}], "]"}]}]}]}], ",", 
     RowBox[{"Print", "[", 
      RowBox[{
       RowBox[{"HNLdistributionFileNamesGivenExpe", "[", 
        RowBox[{"[", "j", "]"}], "]"}], ",", 
       "\"\< does not exist. Generate it using module 2!\>\""}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "1", ",", 
     RowBox[{"Length", "[", "HNLdistributionFileNamesGivenExpe", "]"}], ",", 
     "1"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "j", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"!", 
      RowBox[{"TrueQ", "@", 
       RowBox[{"FileExistsQ", "@", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<spectra/New physics particles spectra/HNLs/\>\"", ",", 
           RowBox[{"HNLdistributionFileNamesGivenExp\[Mu]", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "}"}], "]"}]}]}]}], ",", 
     RowBox[{"Print", "[", 
      RowBox[{
       RowBox[{"HNLdistributionFileNamesGivenExp\[Mu]", "[", 
        RowBox[{"[", "j", "]"}], "]"}], ",", 
       "\"\< does not exist. Generate it using module 2!\>\""}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "1", ",", 
     RowBox[{"Length", "[", "HNLdistributionFileNamesGivenExp\[Mu]", "]"}], 
     ",", "1"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "j", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"!", 
      RowBox[{"TrueQ", "@", 
       RowBox[{"FileExistsQ", "@", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<spectra/New physics particles spectra/HNLs/\>\"", ",", 
           RowBox[{"HNLdistributionFileNamesGivenExp\[Tau]", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "}"}], "]"}]}]}]}], ",", 
     RowBox[{"Print", "[", 
      RowBox[{
       RowBox[{"HNLdistributionFileNamesGivenExp\[Tau]", "[", 
        RowBox[{"[", "j", "]"}], "]"}], ",", 
       "\"\< does not exist. Generate it using module 2!\>\""}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "1", ",", 
     RowBox[{"Length", "[", "HNLdistributionFileNamesGivenExp\[Tau]", "]"}], 
     ",", "1"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "j", "]"}]}], "Input",
 CellChangeTimes->{
  3.88502354836834*^9, {3.8850295938036337`*^9, 3.885029595916194*^9}, {
   3.8851435084384613`*^9, 3.8851435231235733`*^9}, 3.8851438059975414`*^9, {
   3.885147973549172*^9, 3.8851479786288724`*^9}, {3.8860905536346626`*^9, 
   3.8860905939871187`*^9}, {3.8860965615892253`*^9, 3.886096588355503*^9}, {
   3.8886428497459316`*^9, 3.888642850391763*^9}, {3.893520984034127*^9, 
   3.893520984072542*^9}, {3.9025648495841527`*^9, 3.902564857423457*^9}, {
   3.902565030775814*^9, 3.9025650388627033`*^9}, {3.902649876120391*^9, 
   3.902649892356205*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[188]:=",ExpressionUUID->"b068ca92-2674-4751-8f55-4363acad7092"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Importing distributions", "Subsection",
 CellChangeTimes->{{3.885021707174692*^9, 3.8850217096287813`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"bd4ad4f3-480f-4867-9984-\
e96650999170"],

Cell[BoxData[{
 RowBox[{"Print", "[", "\"\<List of relevant production channels:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ProductionList", "=", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\"\<D\>\"", ",", "\"\<B\>\""}], "}"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"FacilityGivenExperiment", "\[Equal]", "\"\<LHC\>\""}], "||", 
       RowBox[{"FacilityGivenExperiment", "\[Equal]", "\"\<FCC-hh\>\""}]}], 
      ",", 
      RowBox[{"{", "\"\<W\>\"", "}"}], ",", 
      RowBox[{"{", "}"}]}], "]"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"StringContainsQ", "[", 
        RowBox[{"SelectedExperiment", ",", "\"\<SHiP\>\""}], "]"}], "==", 
       "True"}], ",", 
      RowBox[{"{", "\"\<K\>\"", "}"}], ",", 
      RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DistrDataTmport", "[", "filename_", "]"}], ":=", 
  RowBox[{"Import", "[", 
   RowBox[{
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", 
       "\"\<spectra/New physics particles spectra/HNLs/\>\"", ",", 
       "filename"}], "}"}], "]"}], ",", "\"\<Table\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "DistrDataNfromKe", ",", "DistrDataNfromK\[Mu]", ",", 
      "DistrDataNfromK\[Tau]"}], "}"}], "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"DistrDataTmport", "[", 
        RowBox[{"HNLdistributionFileNamesGivenExpe", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
       RowBox[{"DistrDataTmport", "[", 
        RowBox[{"HNLdistributionFileNamesGivenExp\[Mu]", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", "0."}], "}"}], "&"}], "/@", 
        RowBox[{"DistrDataTmport", "[", 
         RowBox[{"HNLdistributionFileNamesGivenExpe", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "]"}]}]}], "}"}], "//", "N"}]}], 
   ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "DistrDataNfromDe", ",", "DistrDataNfromBe", ",", "DistrDataNfromWe"}], 
     "}"}], "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"DistrDataTmport", "[", 
        RowBox[{"HNLdistributionFileNamesGivenExpe", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
       RowBox[{"DistrDataTmport", "[", 
        RowBox[{"HNLdistributionFileNamesGivenExpe", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"FacilityGivenExperiment", "\[Equal]", "\"\<LHC\>\""}], "||", 
          RowBox[{"FacilityGivenExperiment", "==", "\"\<FCC-hh\>\""}]}], ",", 
         RowBox[{"DistrDataTmport", "[", 
          RowBox[{"HNLdistributionFileNamesGivenExpe", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "]"}]}], "}"}], "//", 
     "N"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "DistrDataNfromD\[Mu]", ",", "DistrDataNfromB\[Mu]", ",", 
      "DistrDataNfromW\[Mu]"}], "}"}], "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"DistrDataTmport", "[", 
        RowBox[{"HNLdistributionFileNamesGivenExp\[Mu]", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
       RowBox[{"DistrDataTmport", "[", 
        RowBox[{"HNLdistributionFileNamesGivenExp\[Mu]", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"FacilityGivenExperiment", "\[Equal]", "\"\<LHC\>\""}], "||", 
          RowBox[{"FacilityGivenExperiment", "==", "\"\<FCC-hh\>\""}]}], ",", 
         RowBox[{"DistrDataTmport", "[", 
          RowBox[{"HNLdistributionFileNamesGivenExp\[Mu]", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "]"}]}], "}"}], "//", 
     "N"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "DistrDataNfromD\[Tau]", ",", "DistrDataNfromB\[Tau]", ",", 
      "DistrDataNfromW\[Tau]"}], "}"}], "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"DistrDataTmport", "[", 
        RowBox[{"HNLdistributionFileNamesGivenExp\[Tau]", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
       RowBox[{"DistrDataTmport", "[", 
        RowBox[{"HNLdistributionFileNamesGivenExp\[Tau]", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"FacilityGivenExperiment", "\[Equal]", "\"\<LHC\>\""}], "||", 
          RowBox[{"FacilityGivenExperiment", "==", "\"\<FCC-hh\>\""}]}], ",", 
         RowBox[{"DistrDataTmport", "[", 
          RowBox[{"HNLdistributionFileNamesGivenExp\[Tau]", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "]"}]}], "}"}], "//", 
     "N"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"DataListN", "[", "\"\<D\>\"", "]"}], ",", 
     RowBox[{"DataListN", "[", "\"\<B\>\"", "]"}], ",", 
     RowBox[{"DataListN", "[", "\"\<W\>\"", "]"}]}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "DistrDataNfromDe", ",", "DistrDataNfromD\[Mu]", ",", 
       "DistrDataNfromD\[Tau]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "DistrDataNfromBe", ",", "DistrDataNfromB\[Mu]", ",", 
       "DistrDataNfromB\[Tau]"}], "}"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"FacilityGivenExperiment", "\[Equal]", "\"\<LHC\>\""}], "||", 
        RowBox[{"FacilityGivenExperiment", "==", "\"\<FCC-hh\>\""}]}], ",", 
       RowBox[{"{", 
        RowBox[{
        "DistrDataNfromWe", ",", "DistrDataNfromW\[Mu]", ",", 
         "DistrDataNfromW\[Tau]"}], "}"}]}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DataListN", "[", "\"\<K\>\"", "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"StringContainsQ", "[", 
       RowBox[{"SelectedExperiment", ",", "\"\<SHiP\>\""}], "]"}], "==", 
      "True"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "DistrDataNfromKe", ",", "DistrDataNfromK\[Mu]", ",", 
       "DistrDataNfromK\[Tau]"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DoubleDistrInt", "[", "data_", "]"}], ":=", 
  RowBox[{"10", "^", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Interpolation", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"Log10", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
           RowBox[{"Log10", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
           RowBox[{"Log10", "[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "4", "]"}], "]"}], "+", 
             SuperscriptBox["10", 
              RowBox[{"-", "90"}]]}], "]"}]}], "}"}], "&"}], "/@", "data"}], 
       ",", 
       RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
     RowBox[{"mN", ",", 
      RowBox[{"Log10", "[", "\[Theta]N", "]"}], ",", 
      RowBox[{"Log10", "[", "EN", "]"}]}], "]"}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EmaxKval", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"StringContainsQ", "[", 
       RowBox[{"SelectedExperiment", ",", "\"\<SHiP\>\""}], "]"}], "==", 
      "True"}], ",", 
     RowBox[{"Max", "[", 
      RowBox[{"DistrDataNfromKe", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}], ",", "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EmaxDval", "=", 
   RowBox[{"Max", "[", 
    RowBox[{"DistrDataNfromDe", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EmaxBval", "=", 
   RowBox[{"Max", "[", 
    RowBox[{"DistrDataNfromBe", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EmaxWval", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"FacilityGivenExperiment", "\[Equal]", "\"\<LHC\>\""}], "||", 
      RowBox[{"FacilityGivenExperiment", "\[Equal]", "\"\<FCC-hh\>\""}]}], 
     ",", 
     RowBox[{"Max", "[", 
      RowBox[{"DistrDataNfromWe", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"DoubleDistrNfromDe", "[", 
               RowBox[{"mN_", ",", "\[Theta]N_", ",", "EN_"}], "]"}], ",", 
              RowBox[{"DoubleDistrNfromBe", "[", 
               RowBox[{"mN_", ",", "\[Theta]N_", ",", "EN_"}], "]"}], ",", 
              RowBox[{"DoubleDistrNfromWe", "[", 
               RowBox[{"mN_", ",", "\[Theta]N_", ",", "EN_"}], "]"}]}], "}"}],
             "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"DoubleDistrInt", "[", "DistrDataNfromDe", "]"}], ",", 
              RowBox[{"DoubleDistrInt", "[", "DistrDataNfromBe", "]"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "FacilityGivenExperiment", "\[Equal]", "\"\<LHC\>\""}], "||", 
                 RowBox[{
                 "FacilityGivenExperiment", "==", "\"\<FCC-hh\>\""}]}], ",", 
                RowBox[{"DoubleDistrInt", "[", "DistrDataNfromWe", "]"}]}], 
               "]"}]}], "}"}]}], ";"}], "//", 
          RowBox[{"AbsoluteTiming", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"DoubleDistrNfromD\[Mu]", "[", 
              RowBox[{"mN_", ",", "\[Theta]N_", ",", "EN_"}], "]"}], ",", 
             RowBox[{"DoubleDistrNfromB\[Mu]", "[", 
              RowBox[{"mN_", ",", "\[Theta]N_", ",", "EN_"}], "]"}], ",", 
             RowBox[{"DoubleDistrNfromW\[Mu]", "[", 
              RowBox[{"mN_", ",", "\[Theta]N_", ",", "EN_"}], "]"}]}], 
            "}"}]}]}], "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"DoubleDistrInt", "[", "DistrDataNfromD\[Mu]", "]"}], ",", 
           RowBox[{"DoubleDistrInt", "[", "DistrDataNfromB\[Mu]", "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"FacilityGivenExperiment", "\[Equal]", "\"\<LHC\>\""}], 
              "||", 
              RowBox[{"FacilityGivenExperiment", "==", "\"\<FCC-hh\>\""}]}], 
             ",", 
             RowBox[{"DoubleDistrInt", "[", "DistrDataNfromW\[Mu]", "]"}]}], 
            "]"}]}], "}"}]}], ";"}], "//", 
       RowBox[{"AbsoluteTiming", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"DoubleDistrNfromD\[Tau]", "[", 
           RowBox[{"mN_", ",", "\[Theta]N_", ",", "EN_"}], "]"}], ",", 
          RowBox[{"DoubleDistrNfromB\[Tau]", "[", 
           RowBox[{"mN_", ",", "\[Theta]N_", ",", "EN_"}], "]"}], ",", 
          RowBox[{"DoubleDistrNfromW\[Tau]", "[", 
           RowBox[{"mN_", ",", "\[Theta]N_", ",", "EN_"}], "]"}]}], "}"}]}]}],
       "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DoubleDistrInt", "[", "DistrDataNfromD\[Tau]", "]"}], ",", 
        RowBox[{"DoubleDistrInt", "[", "DistrDataNfromB\[Tau]", "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"FacilityGivenExperiment", "\[Equal]", "\"\<LHC\>\""}], "||", 
           RowBox[{"FacilityGivenExperiment", "==", "\"\<FCC-hh\>\""}]}], ",", 
          RowBox[{"DoubleDistrInt", "[", "DistrDataNfromW\[Tau]", "]"}]}], 
         "]"}]}], "}"}]}], ";"}], "//", "AbsoluteTiming"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"DoubleDistrNe", "[", 
      RowBox[{"mN_", ",", "\[Theta]N_", ",", "EN_"}], "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
       "FacilityGivenExperiment", "\[NotEqual]", "\"\<FermilabBD\>\""}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"mN", "<", "1.93"}], ",", 
         RowBox[{"DoubleDistrNfromD", "[", 
          RowBox[{"mN", ",", "\[Theta]N", ",", "EN"}], "]"}], ",", 
         RowBox[{"DoubleDistrNfromB", "[", 
          RowBox[{"mN", ",", "\[Theta]N", ",", "EN"}], "]"}]}], "]"}], ",", 
       RowBox[{"DoubleDistrNfromD", "[", 
        RowBox[{"mN", ",", "\[Theta]N", ",", "EN"}], "]"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"EDsmaxSPStemp", "[", "\[Theta]B_", "]"}], "=", 
     RowBox[{"Piecewise", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"300", ",", 
          RowBox[{"0", "<", "\[Theta]B", "\[LessEqual]", " ", "0.02"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"250", ",", 
          RowBox[{"0.02", "<", "\[Theta]B", "\[LessEqual]", "0.04"}]}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"150", ",", 
          RowBox[{"0.04", "<", "\[Theta]B", "\[LessEqual]", "0.055"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"120", ",", 
          RowBox[{"0.055", "<", "\[Theta]B", "\[LessEqual]", "0.065"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"80", ",", 
          RowBox[{"0.065", "<", "\[Theta]B", "\[LessEqual]", "0.085"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"60", ",", 
          RowBox[{"0.085", "<", "\[Theta]B", "\[LessEqual]", "0.105"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"50", ",", 
          RowBox[{"0.105", "<", "\[Theta]B", "\[LessEqual]", "0.125"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"40", ",", 
          RowBox[{"0.125", "<", "\[Theta]B", "\[LessEqual]", "0.143"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"30", ",", 
          RowBox[{"0.143", "<", "\[Theta]B", "\[LessEqual]", "0.25"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"20", ",", 
          RowBox[{"0.25", "<", "\[Theta]B", "\[LessEqual]", "0.4"}]}], 
         "}"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"EBmaxSPStemp", "[", "\[Theta]B_", "]"}], "=", 
     RowBox[{"Piecewise", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"310", ",", 
          RowBox[{"0", "<", "\[Theta]B", "\[LessEqual]", " ", "0.02"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"270", ",", 
          RowBox[{"0.02", "<", "\[Theta]B", "\[LessEqual]", "0.04"}]}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"200", ",", 
          RowBox[{"0.04", "<", "\[Theta]B", "\[LessEqual]", "0.055"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"150", ",", 
          RowBox[{"0.055", "<", "\[Theta]B", "\[LessEqual]", "0.065"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"100", ",", 
          RowBox[{"0.065", "<", "\[Theta]B", "\[LessEqual]", "0.085"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"80", ",", 
          RowBox[{"0.085", "<", "\[Theta]B", "\[LessEqual]", "0.105"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"60", ",", 
          RowBox[{"0.105", "<", "\[Theta]B", "\[LessEqual]", "0.125"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"50", ",", 
          RowBox[{"0.125", "<", "\[Theta]B", "\[LessEqual]", "0.143"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"25", ",", "True"}], 
         RowBox[{"(*", 
          RowBox[{"0.143", "<", "\[Theta]B", "\[LessEqual]", "0.25"}], "*)"}],
          "}"}]}], 
       RowBox[{"(*", 
        RowBox[{",", 
         RowBox[{"{", 
          RowBox[{"2.5", ",", "True"}], "}"}]}], "*)"}], "}"}], "]"}]}], 
    ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<Fraction of produced mother particles per proton collision:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<D\>\"", ",", "\"\<B\>\"", ",", "\"\<W\>\"", ",", "\"\<K\>\""}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Chi]Prod", "[", "\"\<D\>\"", "]"}], ",", 
       RowBox[{"\[Chi]Prod", "[", "\"\<B\>\"", "]"}], ",", 
       RowBox[{"\[Chi]Prod", "[", "\"\<W\>\"", "]"}], ",", 
       RowBox[{"\[Chi]Prod", "[", "\"\<K\>\"", "]"}]}], "}"}]}], "}"}], "//", 
   "TableForm"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Probabilities", " ", "of", " ", "production", " ", "mother"}], 
     "\[Rule]", 
     RowBox[{"HNL", " ", "at", " ", 
      SuperscriptBox["U", "2"]}]}], " ", "=", " ", "1"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Chi]XtoN", "[", 
    RowBox[{"mN_", ",", "\"\<D\>\""}], "]"}], "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Chi]DtoNe", "[", "mN_", "]"}], ",", 
      RowBox[{"\[Chi]DtoN\[Mu]", "[", "mN_", "]"}], ",", 
      RowBox[{"\[Chi]DtoN\[Tau]", "[", "mN_", "]"}]}], "}"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Chi]MotherToN", "[", 
       RowBox[{
       "mN", ",", "#", ",", "\"\<D\>\"", ",", "FacilityGivenExperiment"}], 
       "]"}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{"\"\<e\>\"", ",", "\"\<\[Mu]\>\"", ",", "\"\<\[Tau]\>\""}], 
      "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Chi]XtoN", "[", 
    RowBox[{"mN_", ",", "\"\<B\>\""}], "]"}], "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Chi]BtoNe", "[", "mN_", "]"}], ",", 
      RowBox[{"\[Chi]BtoN\[Mu]", "[", "mN_", "]"}], ",", 
      RowBox[{"\[Chi]BtoN\[Tau]", "[", "mN_", "]"}]}], "}"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Chi]MotherToN", "[", 
       RowBox[{
       "mN", ",", "#", ",", "\"\<B\>\"", ",", "FacilityGivenExperiment"}], 
       "]"}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{"\"\<e\>\"", ",", "\"\<\[Mu]\>\"", ",", "\"\<\[Tau]\>\""}], 
      "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Chi]XtoN", "[", 
    RowBox[{"mN_", ",", "\"\<W\>\""}], "]"}], "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Chi]WtoNe", "[", "mN_", "]"}], ",", 
      RowBox[{"\[Chi]WtoN\[Mu]", "[", "mN_", "]"}], ",", 
      RowBox[{"\[Chi]WtoN\[Tau]", "[", "mN_", "]"}]}], "}"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Chi]MotherToN", "[", 
       RowBox[{
       "mN", ",", "#", ",", "\"\<W\>\"", ",", "FacilityGivenExperiment"}], 
       "]"}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{"\"\<e\>\"", ",", "\"\<\[Mu]\>\"", ",", "\"\<\[Tau]\>\""}], 
      "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Chi]XtoN", "[", 
    RowBox[{"mN_", ",", "\"\<K\>\""}], "]"}], "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Chi]KtoNe", "[", "mN_", "]"}], ",", 
      RowBox[{"\[Chi]KtoN\[Mu]", "[", "mN_", "]"}], ",", 
      RowBox[{"\[Chi]KtoN\[Tau]", "[", "mN_", "]"}]}], "}"}], "=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"StringContainsQ", "[", 
        RowBox[{"SelectedExperiment", ",", "\"\<SHiP\>\""}], "]"}], "==", 
       "True"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Chi]MotherToN", "[", 
         RowBox[{
         "mN", ",", "#", ",", "\"\<K\>\"", ",", "FacilityGivenExperiment"}], 
         "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{"\"\<e\>\"", ",", "\"\<\[Mu]\>\"", ",", "\"\<\[Tau]\>\""}], 
        "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Chi]Xtimes\[Chi]XtoNtot", "[", 
      RowBox[{"mN_", ",", "prod"}], "]"}], "=", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\[Chi]XtoN", "[", 
           RowBox[{"mN", ",", "prod"}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "*", 
         RowBox[{"MixingPattern", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "3", ",", "1"}], "}"}]}], "]"}], "*", 
      RowBox[{"\[Chi]Prod", "[", "prod", "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8850235826067033`*^9, 3.885023675252301*^9}, {
   3.885024034003212*^9, 3.8850240498549843`*^9}, {3.885025959962815*^9, 
   3.885025967302995*^9}, {3.885030706382409*^9, 3.885030745475287*^9}, {
   3.8850309526062856`*^9, 3.88503096483503*^9}, {3.8850332428600683`*^9, 
   3.8850332918388186`*^9}, {3.8850337784450293`*^9, 
   3.8850338200840044`*^9}, {3.8850346161975956`*^9, 3.885034632170972*^9}, {
   3.8850347069728813`*^9, 3.8850347338207564`*^9}, {3.885034778328908*^9, 
   3.885034816041048*^9}, {3.885035433437901*^9, 3.885035564029897*^9}, {
   3.8850518449349937`*^9, 3.8850518483959074`*^9}, {3.885054031843747*^9, 
   3.8850540436323767`*^9}, {3.8852217874570465`*^9, 
   3.8852218214200287`*^9}, {3.8852230110396547`*^9, 3.885223071442103*^9}, {
   3.8852239346646085`*^9, 3.8852239532779055`*^9}, 3.8852241361957426`*^9, {
   3.885227956476835*^9, 3.8852279786060715`*^9}, {3.8853529048084664`*^9, 
   3.885352933856391*^9}, {3.8853529980828967`*^9, 3.885353014892103*^9}, {
   3.88535307255888*^9, 3.8853530818016925`*^9}, {3.8853531842229404`*^9, 
   3.8853532582053022`*^9}, 3.885354270277156*^9, {3.885354456172448*^9, 
   3.885354463331103*^9}, {3.8853781959175596`*^9, 3.8853782390343995`*^9}, {
   3.8860906029219418`*^9, 3.8860911725442004`*^9}, {3.8860965384165745`*^9, 
   3.8860965384199495`*^9}, {3.888642888483157*^9, 3.8886428884987774`*^9}, {
   3.888894896250861*^9, 3.8888949387221327`*^9}, {3.890287053044404*^9, 
   3.890287058497758*^9}, {3.890363390823092*^9, 3.8903633910835714`*^9}, {
   3.892092912023954*^9, 3.892092920559579*^9}, 3.892093052671545*^9, {
   3.892099339116357*^9, 3.892099339257778*^9}, 3.892099687690915*^9, {
   3.892103062168048*^9, 3.8921030627181954`*^9}, {3.8921034841751947`*^9, 
   3.892103589360467*^9}, {3.892103668625312*^9, 3.892103697476217*^9}, {
   3.892115174552057*^9, 3.8921152452218328`*^9}, {3.892115905694204*^9, 
   3.892115910250782*^9}, {3.8927016810840287`*^9, 3.892701681196396*^9}, {
   3.892703013037912*^9, 3.8927030780560856`*^9}, {3.89270311517658*^9, 
   3.8927031859578905`*^9}, {3.8927032209082665`*^9, 
   3.8927032366458054`*^9}, {3.89270327757952*^9, 3.892703278699406*^9}, {
   3.8927041544215317`*^9, 3.8927041547915735`*^9}, 3.8935209841034594`*^9, {
   3.902564889290596*^9, 3.9025648960772314`*^9}, {3.902565005336182*^9, 
   3.9025650527757792`*^9}, {3.9025651025557327`*^9, 
   3.9025651599942455`*^9}, {3.9025652675672913`*^9, 
   3.9025653950643663`*^9}, {3.902565428026998*^9, 3.902565453409232*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[198]:=",ExpressionUUID->"fbe8b7bf-d0b6-401f-acf4-5f426aaeac09"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
\[OpenCurlyDoubleQuote]Gluing\[CloseCurlyDoubleQuote] the HNL distributions \
originated from various mixings\
\>", "Subsection",
 CellChangeTimes->{{3.892090350870555*^9, 3.8920903622368035`*^9}, {
  3.8920909580099277`*^9, 3.8920909800780144`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"d8835fc8-fd3c-42a3-a79a-\
7741688b0bea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Code", " ", "supplementing", " ", "the", " ", "data", " ", "for", " ", 
    "the", " ", "distribution", " ", "up", " ", "to", " ", "the", " ", 
    "given", " ", "mass", " ", "with", " ", "zeros"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"DataSupplementedBlock", "[", 
     RowBox[{"data_", ",", "mmax_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mdatamax", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"data\[Theta]Egrid", "=", 
        RowBox[{
         RowBox[{"SortBy", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"DeleteDuplicatesBy", "[", 
             RowBox[{"data", ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}]}], "]"}], 
            "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}]}], "]"}], "//", 
         "N"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Join", "[", 
        RowBox[{"data", ",", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"mN", ",", 
               RowBox[{
                RowBox[{"data\[Theta]Egrid", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"data\[Theta]Egrid", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"mN", ",", 
               RowBox[{"1.001", "mdatamax"}], ",", "mmax", ",", 
               FractionBox[
                RowBox[{"(", 
                 RowBox[{"mmax", "-", 
                  RowBox[{"1.001", "mdatamax"}]}], ")"}], "3"]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "data\[Theta]Egrid", "]"}], ",", "1"}], 
              "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"DataLogarithmiedComp", "=", 
    RowBox[{
     RowBox[{"Hold", "@", 
      RowBox[{"Compile", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"data", ",", "_Real", ",", "2"}], "}"}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"data", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "4", "]"}], "]"}], "\[Equal]", "0"}], ",", 
            RowBox[{"-", "90."}], ",", 
            RowBox[{"Log10", "[", 
             RowBox[{
              RowBox[{"data", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "4", "]"}], "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "data", "]"}], ",", "1"}], "}"}]}], "]"}], 
        ",", 
        RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
        RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}]}], "//",
      "ReleaseHold"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Code", " ", "mapping", " ", "the", " ", "data", " ", "onto", " ", 
     "another", " ", "grid", " ", "using", " ", "fast", " ", 
     "interpolation"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockGridMappingDistribution", "[", 
     RowBox[{
     "data_", ",", "mGridFinal_", ",", "\[Theta]GridFinal_", ",", 
      "EgridFinal_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"InGrid", ",", "OutGrid", ",", "Vals"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"InGrid", "=", 
        RowBox[{
         RowBox[{"Log10", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}], "}"}], "]"}],
          "//", "N"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Vals", "=", 
        RowBox[{
         RowBox[{"ArrayReshape", "[", 
          RowBox[{
           RowBox[{"DataLogarithmiedComp", "[", "data", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"InGrid", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
             RowBox[{"Length", "[", 
              RowBox[{"InGrid", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
             RowBox[{"Length", "[", 
              RowBox[{"InGrid", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], "//", 
         "N"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"OutGrid", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Log10", "[", "mGridFinal", "]"}], ",", 
           RowBox[{"Log10", "[", "\[Theta]GridFinal", "]"}], ",", 
           RowBox[{"Log10", "[", "EgridFinal", "]"}]}], "}"}], "//", "N"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"OutGridTuples", "=", 
        RowBox[{"Tuples", "[", "OutGrid", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"xigDistr", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Interpolation", "[", 
             RowBox[{
              RowBox[{"Transpose", "@", 
               RowBox[{"{", 
                RowBox[{"#", ",", 
                 RowBox[{"Range", "@", 
                  RowBox[{"Length", "@", "#"}]}]}], "}"}]}], ",", 
              RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
            "#2", "]"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"InGrid", ",", "OutGrid"}], "}"}]}], "]"}]}], ";", "\n", 
       RowBox[{"10", "^", 
        RowBox[{"Join", "[", 
         RowBox[{"OutGridTuples", ",", 
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{"Flatten", "@", 
             RowBox[{"cf3", "[", 
              RowBox[{
               RowBox[{"Sequence", "@@", "xigDistr"}], ",", "Vals"}], "]"}]}],
             ",", "1"}], "]"}], ",", "2"}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockDistrGluing", "[", "ProdChannel_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Data", " ", "corresponding", " ", "to", " ", "the", " ", "given", " ",
         "production", " ", "channel"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DataList", "=", 
        RowBox[{"DataListN", "[", "ProdChannel", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "List", " ", "of", " ", "the", " ", "production", " ", 
         "probabilities", " ", "per", " ", "mixing", " ", "for", " ", "the", 
         " ", "give", " ", 
         RowBox[{"prod", ".", " ", "channel"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Chi]list", "[", "mN_", "]"}], "=", 
        RowBox[{"\[Chi]XtoN", "[", 
         RowBox[{"mN", ",", "ProdChannel"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Max", " ", "HNL", " ", "mass", " ", "from", " ", "the", " ", 
         "data"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"mNmaxList", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"DataList", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"DataList", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"DataList", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mNmaxListEff", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"MixingPattern", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[NotEqual]", "0"}], ",", 
            RowBox[{"mNmaxList", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "0"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "mNmaxList", "]"}], ",", "1"}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"PosmNmaxDistr", ",", "mNmaxDistr"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"mNmaxListEff", ",", 
              RowBox[{"_", "?", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"#", "\[Equal]", 
                  RowBox[{"Max", "[", "mNmaxListEff", "]"}]}], "&"}], 
                ")"}]}]}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"Max", "[", "mNmaxListEff", "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Data", " ", "corresponding", " ", "to", " ", "the", " ", "max", " ", 
         "HNL", " ", "mass"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"DistrDatamNmax", "=", 
        RowBox[{"DataList", "[", 
         RowBox[{"[", "PosmNmaxDistr", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Chi]mNmax", "[", "mN_", "]"}], "=", 
        RowBox[{
         RowBox[{"\[Chi]list", "[", "mN", "]"}], "[", 
         RowBox[{"[", "PosmNmaxDistr", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"MixingPatternmNMax", "=", 
        RowBox[{"MixingPattern", "[", 
         RowBox[{"[", "PosmNmaxDistr", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Below", " ", "there", " ", "is", " ", "the", " ", "block", " ", 
         "gluing", " ", "the", " ", "distributions"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MixingPattern", "[", 
           RowBox[{"[", "PosmNmaxDistr", "]"}], "]"}], "\[Equal]", "1."}], 
         ",", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "4", "]"}], "]"}], "+", 
              SuperscriptBox["10", 
               RowBox[{"-", "90"}]]}]}], "}"}], "&"}], "/@", 
          "DistrDatamNmax"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Chi]left", "[", "mN_", "]"}], "=", 
           RowBox[{"Delete", "[", 
            RowBox[{
             RowBox[{"\[Chi]list", "[", "mN", "]"}], ",", "PosmNmaxDistr"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"MixingPatternLeft", "=", 
           RowBox[{"Delete", "[", 
            RowBox[{"MixingPattern", ",", "PosmNmaxDistr"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"DataLeft", "=", 
           RowBox[{"Delete", "[", 
            RowBox[{"DataList", ",", "PosmNmaxDistr"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"DataSuppl1", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"MixingPatternLeft", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", "0"}], ",", 
             RowBox[{"DataSupplementedBlock", "[", 
              RowBox[{
               RowBox[{"DataLeft", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "mNmaxDistr"}], "]"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"DataSuppl2", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"MixingPatternLeft", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[NotEqual]", "0"}], ",", 
             RowBox[{"DataSupplementedBlock", "[", 
              RowBox[{
               RowBox[{"DataLeft", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "mNmaxDistr"}], "]"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"mGridFinal", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"DeleteDuplicates", "[", 
                RowBox[{"DistrDatamNmax", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"MixingPatternLeft", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", "0"}], ",", 
                 RowBox[{"DeleteDuplicates", "[", 
                  RowBox[{"DataSuppl2", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
                 RowBox[{"{", "}"}]}], "]"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"MixingPatternLeft", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "\[NotEqual]", "0"}], ",", 
                 RowBox[{"DeleteDuplicates", "[", 
                  RowBox[{"DataSuppl2", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
                 RowBox[{"{", "}"}]}], "]"}]}], "]"}], "//", 
             "DeleteDuplicates"}], "//", "Sort"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[Theta]GridFinal", ",", "EgridFinal"}], "}"}], "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"DeleteDuplicates", "[", 
               RowBox[{"DistrDatamNmax", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"DeleteDuplicates", "[", 
               RowBox[{"DistrDatamNmax", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}], "}"}], "//",
             "N"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"GridFinal", "=", 
           RowBox[{"Tuples", "[", 
            RowBox[{"{", 
             RowBox[{
             "mGridFinal", ",", "\[Theta]GridFinal", ",", "EgridFinal"}], 
             "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"DistrMappedmNmax", "=", 
           RowBox[{"BlockGridMappingDistribution", "[", 
            RowBox[{
            "DistrDatamNmax", ",", "mGridFinal", ",", "\[Theta]GridFinal", 
             ",", "EgridFinal"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"DistrMapped1", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"MixingPatternLeft", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", "0"}], ",", 
             RowBox[{"BlockGridMappingDistribution", "[", 
              RowBox[{
              "DataSuppl1", ",", "mGridFinal", ",", "\[Theta]GridFinal", ",", 
               "EgridFinal"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"DistrMapped2", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"MixingPatternLeft", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[NotEqual]", "0"}], ",", 
             RowBox[{"BlockGridMappingDistribution", "[", 
              RowBox[{
              "DataSuppl2", ",", "mGridFinal", ",", "\[Theta]GridFinal", ",", 
               "EgridFinal"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"WeightsValsDatamNmax", "=", 
           RowBox[{"Quiet", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"MixingPatternmNMax", "*", 
                RowBox[{"\[Chi]mNmax", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
             "mGridFinal"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"WeightsValsData1", "=", 
           RowBox[{"Quiet", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"MixingPatternLeft", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "*", 
                RowBox[{
                 RowBox[{"\[Chi]left", "[", "#", "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "&"}], "/@", 
             "mGridFinal"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"WeightsValsData2", "=", 
           RowBox[{"Quiet", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"MixingPatternLeft", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "*", 
                RowBox[{
                 RowBox[{"\[Chi]left", "[", "#", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "&"}], "/@", 
             "mGridFinal"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"WeightsNorm", "=", 
           FractionBox["1", 
            RowBox[{
            "WeightsValsDatamNmax", "+", "WeightsValsData1", "+", 
             "WeightsValsData2"}]]}], ";", "\[IndentingNewLine]", 
          RowBox[{"DistrValsmNmaxReweighted", "=", 
           RowBox[{"List", "/@", 
            RowBox[{"Flatten", "[", 
             RowBox[{"WeightsValsDatamNmax", " ", "WeightsNorm", " ", 
              RowBox[{"Partition", "[", 
               RowBox[{
                RowBox[{"DistrMappedmNmax", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", 
                   RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"Length", "[", "GridFinal", "]"}], "/", 
                 RowBox[{"Length", "[", "mGridFinal", "]"}]}]}], "]"}]}], 
             "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"DistrVals1Reweighted", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"MixingPatternLeft", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", "0"}], ",", 
             RowBox[{"List", "/@", 
              RowBox[{"Flatten", "[", 
               RowBox[{"WeightsValsData1", " ", "WeightsNorm", " ", 
                RowBox[{"Partition", "[", 
                 RowBox[{
                  RowBox[{"DistrMapped1", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"Length", "[", "GridFinal", "]"}], "/", 
                   RowBox[{"Length", "[", "mGridFinal", "]"}]}]}], "]"}]}], 
               "]"}]}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", "0", "}"}], ",", 
               RowBox[{"Length", "[", "DistrValsmNmaxReweighted", "]"}]}], 
              "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"DistrVals2Reweighted", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"MixingPatternLeft", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[NotEqual]", "0"}], ",", 
             RowBox[{"List", "/@", 
              RowBox[{"Flatten", "[", 
               RowBox[{"WeightsValsData2", " ", "WeightsNorm", " ", 
                RowBox[{"Partition", "[", 
                 RowBox[{
                  RowBox[{"DistrMapped2", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"Length", "[", "GridFinal", "]"}], "/", 
                   RowBox[{"Length", "[", "mGridFinal", "]"}]}]}], "]"}]}], 
               "]"}]}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", "0", "}"}], ",", 
               RowBox[{"Length", "[", "DistrValsmNmaxReweighted", "]"}]}], 
              "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "4", "]"}], "]"}], "+", 
               SuperscriptBox["10", 
                RowBox[{"-", "90"}]]}]}], "}"}], "&"}], "/@", 
           RowBox[{"Join", "[", 
            RowBox[{"GridFinal", ",", 
             RowBox[{
             "DistrValsmNmaxReweighted", "+", "DistrVals1Reweighted", "+", 
              "DistrVals2Reweighted"}], ",", "2"}], "]"}]}]}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"DataDistrNfinal", "[", "prod", "]"}], "=", 
         RowBox[{"BlockDistrGluing", "[", "prod", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"DoubleDistrN", "[", 
          RowBox[{"mN_", ",", "\[Theta]N_", ",", "EN_", ",", "prod"}], "]"}], 
         "=", 
         RowBox[{"10", "^", 
          RowBox[{
           RowBox[{"Interpolation", "[", 
            RowBox[{
             RowBox[{"Log10", "[", 
              RowBox[{"DataDistrNfinal", "[", "prod", "]"}], "]"}], ",", 
             RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
           RowBox[{
            RowBox[{"Log10", "[", "mN", "]"}], ",", 
            RowBox[{"Log10", "[", "\[Theta]N", "]"}], ",", 
            RowBox[{"Log10", "[", "EN", "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"MassListDistrN", "[", "prod", "]"}], "=", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{
           RowBox[{"DataDistrNfinal", "[", "prod", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"mNmin", "[", "prod", "]"}], ",", 
           RowBox[{"mNmax", "[", "prod", "]"}]}], "}"}], "=", 
         RowBox[{"MinMax", "[", 
          RowBox[{"MassListDistrN", "[", "prod", "]"}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";"}], "//", 
    "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DirectoryQ", "[", 
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], ",", 
            "\"\<Auxiliary data/HNLs\>\"", ",", "SelectedExperiment"}], "}"}],
           "]"}], "]"}], "//", "ToString"}], ")"}], "\[Equal]", 
      "\"\<False\>\""}], ",", 
     RowBox[{"CreateDirectory", "[", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], ",", 
         "\"\<Auxiliary data/HNLs\>\"", ",", "SelectedExperiment"}], "}"}], 
       "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], ",", 
         "\"\<Auxiliary data/HNLs\>\"", ",", "SelectedExperiment", ",", 
         RowBox[{"ToString", "@", 
          RowBox[{"StringForm", "[", 
           RowBox[{
           "\"\<Double-Distr-Averaged-HNL_mixing-pattern_``-``-``.m\>\"", ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MixingPattern", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"MixingPattern", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"MixingPattern", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}]}], "]"}]}]}], "}"}],
        "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"mNmin", "[", "prod", "]"}], "<", "mN", "<", 
             RowBox[{"mNmax", "[", "prod", "]"}]}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"\[Chi]Xtimes\[Chi]XtoNtot", "[", 
              RowBox[{"mN", ",", "prod"}], "]"}], "]"}], ",", "0"}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ",", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"mNmin", "[", "prod", "]"}], "<", "mN", "<", 
               RowBox[{"mNmax", "[", "prod", "]"}]}], ",", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"\[Chi]Xtimes\[Chi]XtoNtot", "[", 
                RowBox[{"mN", ",", "prod"}], "]"}], "]"}], ",", "0"}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}]], 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"mNmin", "[", "prod", "]"}], "<", "mN", "<", 
              RowBox[{"mNmax", "[", "prod", "]"}]}], ",", 
             RowBox[{"Evaluate", "[", 
              RowBox[{
               RowBox[{"\[Chi]Xtimes\[Chi]XtoNtot", "[", 
                RowBox[{"mN", ",", "prod"}], "]"}], "*", 
               RowBox[{"DoubleDistrN", "[", 
                RowBox[{"mN", ",", "\[Theta]N", ",", "EN", ",", "prod"}], 
                "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}]}]}], 
       "}"}], ",", "\"\<MX\>\""}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.892090541500342*^9, 3.892090703084691*^9}, {
   3.892090735840269*^9, 3.892090751344923*^9}, 3.892090807550028*^9, 
   3.892090934086282*^9, {3.8920910129811583`*^9, 3.892091023031073*^9}, {
   3.8920910804454327`*^9, 3.892091085547815*^9}, {3.8920911617247267`*^9, 
   3.89209129060774*^9}, {3.892091400747138*^9, 3.892091472979203*^9}, {
   3.892091574179184*^9, 3.8920916218094206`*^9}, {3.8920926728982496`*^9, 
   3.892092727321512*^9}, {3.8920928185984893`*^9, 3.892092820159523*^9}, {
   3.892093066939197*^9, 3.8920931214693675`*^9}, {3.892093160560478*^9, 
   3.8920932299480343`*^9}, {3.892093261567911*^9, 3.892093330908249*^9}, {
   3.8920937614886436`*^9, 3.892093946929132*^9}, {3.8920945269075537`*^9, 
   3.892094548542453*^9}, {3.8920948739319067`*^9, 3.8920948862387123`*^9}, {
   3.892097701946145*^9, 3.8920977860348577`*^9}, {3.8920978859975424`*^9, 
   3.8920980615926676`*^9}, {3.892098327333703*^9, 3.8920984111607885`*^9}, {
   3.892098469607106*^9, 3.8920985324832*^9}, {3.8920985660558076`*^9, 
   3.8920986349307284`*^9}, {3.8920991665049205`*^9, 
   3.8920993019538174`*^9}, {3.8920999218020725`*^9, 
   3.8920999426527348`*^9}, {3.8921000113949766`*^9, 3.892100013132874*^9}, {
   3.89210004566156*^9, 3.892100047149428*^9}, {3.8921002009754944`*^9, 
   3.892100203337149*^9}, {3.892100626808548*^9, 3.8921006392540383`*^9}, 
   3.892100712656434*^9, {3.892100842141749*^9, 3.8921008445755987`*^9}, {
   3.8921009362799177`*^9, 3.892100938528495*^9}, {3.8921009705125456`*^9, 
   3.892100974109528*^9}, {3.892101168707383*^9, 3.892101170974386*^9}, {
   3.8921030677841263`*^9, 3.8921030930551386`*^9}, {3.8921031667156725`*^9, 
   3.8921032586538095`*^9}, {3.8921041544848213`*^9, 3.89210416701289*^9}, {
   3.892104925505067*^9, 3.8921050704891033`*^9}, {3.8921051063953934`*^9, 
   3.8921051072167683`*^9}, {3.8921078712742233`*^9, 
   3.8921078911741085`*^9}, {3.8921082472292967`*^9, 3.892108270982639*^9}, {
   3.89210887995632*^9, 3.892109040482913*^9}, {3.892109653178957*^9, 
   3.8921096728037405`*^9}, {3.892114694223406*^9, 3.892114694223406*^9}, {
   3.892115286202919*^9, 3.892115291641926*^9}, {3.8921155666276135`*^9, 
   3.892115589611047*^9}, 3.8921157408930287`*^9, {3.8927032917123237`*^9, 
   3.8927035096777687`*^9}, 3.892703809039032*^9, {3.892703976019764*^9, 
   3.892703977869831*^9}, 3.8927042452438393`*^9, {3.8932576669948797`*^9, 
   3.893257696296561*^9}, {3.9027279036487594`*^9, 3.902727921126442*^9}, {
   3.9028878675198307`*^9, 3.902887869968681*^9}, {3.902889262200158*^9, 
   3.90288926665694*^9}, {3.9061849923341775`*^9, 3.906185000895527*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[219]:=",ExpressionUUID->"15f6e902-7ccc-403a-bb8a-6e270ab16116"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Determining min/max energies for the given polar angle -- needed for good \
precision of Monte-Carlo integration\
\>", "Subsection",
 CellChangeTimes->{{3.8850217140541673`*^9, 3.8850217339343953`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"b4a9a411-6bcb-46f2-adba-\
eeabc7aacbca"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ENfromXmax", "[", 
   RowBox[{"mass_", ",", "data_", ",", "LogMin_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "distr", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"datt", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"data", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "mass"}], "&"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"EmaxVal", "=", 
      RowBox[{
       RowBox[{"datt", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "3"}], "]"}], "]"}], "//", "Max"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Theta]list", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"x", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "\[Theta]minExp", ",", "\[Theta]maxExp", ",", 
          FractionBox[
           RowBox[{"(", 
            RowBox[{"\[Theta]maxExp", "-", "\[Theta]minExp"}], ")"}], "5"]}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"distr", "[", 
       RowBox[{"\[Theta]N_", ",", "EN_"}], "]"}], "=", 
      RowBox[{"Abs", "[", 
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", "3", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "4", "]"}], "]"}], "+", 
                SuperscriptBox["10", 
                 RowBox[{"-", "90"}]]}]}], "}"}], "&"}], "/@", "datt"}], ",", 
           RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
         RowBox[{"\[Theta]N", ",", "EN"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DoubleDistrIntList", "[", "i_", "]"}], ":=", 
      RowBox[{
       RowBox[{"Interpolation", "[", 
        RowBox[{
         RowBox[{"ParallelTable", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"EN", ",", 
             RowBox[{"Quiet", "[", 
              RowBox[{"NIntegrate", "[", 
               RowBox[{
                RowBox[{"distr", "[", 
                 RowBox[{"\[Theta]N", ",", "EN"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"\[Theta]N", ",", 
                  RowBox[{"\[Theta]list", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", 
                  RowBox[{"\[Theta]list", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"Method", "\[Rule]", "\"\<AdaptiveMonteCarlo\>\""}]}],
                "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"EN", ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               SuperscriptBox["10", "x"], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{"Log10", "[", 
                  RowBox[{"1.1", "*", "mass"}], "]"}], ",", 
                 RowBox[{"Log10", "[", "EmaxVal", "]"}], ",", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"Log10", "[", "EmaxVal", "]"}], "-", 
                   RowBox[{"Log10", "[", 
                    RowBox[{"1.1", "*", "mass"}], "]"}]}], "50."]}], "}"}]}], 
              "]"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "EN", 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]Ndistrlist", "[", "EN_", "]"}], "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"\[Theta]list", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "+", 
            RowBox[{"\[Theta]list", "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "2"], ",", 
          RowBox[{"DoubleDistrIntList", "[", "i", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{
           RowBox[{"Length", "[", "\[Theta]list", "]"}], "-", "1"}], ",", 
          "1"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Theta]EmaxList", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"\[Theta]Ndistrlist", "[", "EN", "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"SortBy", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"EN", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Theta]Ndistrlist", "[", "EN", "]"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"EN", ",", "mass", ",", "EmaxVal", ",", "1"}], 
                 "}"}]}], "]"}], ",", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"\[Theta]Ndistrlist", "[", "EN", "]"}], "]"}], ",", "1"}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]EmaxListInt", "[", "\[Theta]N_", "]"}], "=", 
      RowBox[{
       RowBox[{"Interpolation", "[", 
        RowBox[{"\[Theta]EmaxList", ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
       "\[Theta]N", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"NormVals", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"\[Theta]Ndistrlist", "[", "EN", "]"}], "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", 
           SuperscriptBox["10", 
            RowBox[{"-", "90."}]]}], ",", 
          RowBox[{"{", 
           RowBox[{"EN", ",", "mass", ",", "EmaxVal"}], "}"}], ",", 
          RowBox[{
          "Method", "\[Rule]", "\"\<InterpolationPointsSubdivision\>\""}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"\[Theta]Ndistrlist", "[", "EN", "]"}], "]"}], ",", "1"}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cdf", "[", 
       RowBox[{"es_", ",", "i_"}], "]"}], ":=", 
      RowBox[{"1", "-", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"NormVals", "[", 
          RowBox[{"[", "i", "]"}], "]"}]], 
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"\[Theta]Ndistrlist", "[", "EN", "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"EN", ",", "mass", ",", "es"}], "}"}], ",", 
          RowBox[{
          "Method", "\[Rule]", "\"\<InterpolationPointsSubdivision\>\""}]}], 
         "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cdftab", "[", "EN_", "]"}], "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"\[Theta]Ndistrlist", "[", "EN", "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"Interpolation", "[", 
            RowBox[{
             RowBox[{"ParallelTable", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"10", "^", "es"}], ",", 
                 RowBox[{"Quiet", "[", 
                  RowBox[{"cdf", "[", 
                   RowBox[{
                    RowBox[{"10", "^", "es"}], ",", "i"}], "]"}], "]"}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"es", ",", 
                 RowBox[{"Log10", "[", "mass", "]"}], ",", 
                 RowBox[{"Log10", "[", "EmaxVal", "]"}], ",", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"Log10", "[", "EmaxVal", "]"}], "-", 
                   RowBox[{"Log10", "[", "mass", "]"}]}], "50"]}], "}"}]}], 
              "]"}], ",", 
             RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
           "EN", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"\[Theta]Ndistrlist", "[", "EN", "]"}], "]"}], ",", "1"}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"logmin", "[", "\[Theta]N_", "]"}], "=", "LogMin"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Estart", "[", "\[Theta]N_", "]"}], "=", 
      RowBox[{"Min", "[", 
       RowBox[{
        RowBox[{"2", "*", 
         RowBox[{"\[Theta]EmaxListInt", "[", "\[Theta]N", "]"}]}], ",", 
        RowBox[{"0.9", "*", "EmaxVal"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Emaxv", "[", "i_", "]"}], ":=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"NormVals", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "<", 
         SuperscriptBox["10", 
          RowBox[{"-", "15"}]]}], ",", "mass", ",", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"EN", "/.", 
           RowBox[{"FindRoot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Log10", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"cdftab", "[", 
                  SuperscriptBox["10", "EN"], "]"}], "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], "\[Equal]", 
              RowBox[{"logmin", "[", 
               RowBox[{
                RowBox[{"\[Theta]EmaxList", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"EN", ",", 
               RowBox[{"Log10", "[", 
                RowBox[{"Estart", "[", 
                 RowBox[{
                  RowBox[{"\[Theta]EmaxList", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"Log10", "[", 
                RowBox[{
                 RowBox[{"\[Theta]EmaxList", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
               RowBox[{"Log10", "[", "EmaxVal", "]"}]}], "}"}]}], "]"}]}], 
          ")"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tabtemp", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Theta]EmaxList", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"Emaxv", "[", "i", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "\[Theta]EmaxList", "]"}], ",", "1"}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tab", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"\[Theta]minExp", ",", 
           RowBox[{
            RowBox[{"tabtemp", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "}"}], ",", 
        RowBox[{"Drop", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{"tabtemp", ",", "1"}], "]"}], ",", 
          RowBox[{"-", "1"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"\[Theta]maxExp", ",", 
           RowBox[{
            RowBox[{"tabtemp", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"10", "^", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Log10", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
              RowBox[{"Log10", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
           "tab"}], ",", 
          RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
        RowBox[{"Log10", "[", "\[Theta]N", "]"}], "]"}], ")"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ENmaxBlock", "[", 
   RowBox[{"data_", ",", "logmin_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mlist", "=", 
      RowBox[{"Drop", "[", 
       RowBox[{
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"EmaxTemp", "[", 
       RowBox[{"mN_", ",", "\[Theta]N_"}], "]"}], "=", 
      RowBox[{"Max", "[", 
       RowBox[{"mN", ",", 
        RowBox[{"ENfromXmax", "[", 
         RowBox[{
          RowBox[{"mlist", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "data", ",", "logmin"}], 
         "]"}], ",", 
        RowBox[{"ENfromXmax", "[", 
         RowBox[{
          RowBox[{"mlist", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], ",", "data", ",", "logmin"}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Theta]list", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"x", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "\[Theta]minExp", ",", "\[Theta]maxExp", ",", 
          FractionBox[
           RowBox[{"(", 
            RowBox[{"\[Theta]maxExp", "-", "\[Theta]minExp"}], ")"}], "10"]}],
          "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"10", "^", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"Log10", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
              RowBox[{"Log10", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"mN", ",", "\[Theta]N", ",", 
                 RowBox[{"EmaxTemp", "[", 
                  RowBox[{"mN", ",", "\[Theta]N"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"mN", ",", 
                 RowBox[{"mlist", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"mlist", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"mlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"mlist", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", "10"}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"\[Theta]N", ",", "\[Theta]list"}], "}"}]}], "]"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ",", 
          RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
        RowBox[{"mN", ",", 
         RowBox[{"Log10", "[", "\[Theta]N", "]"}]}], "]"}], ")"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ENmax", "[", 
       RowBox[{"mN_", ",", "\[Theta]N_", ",", "prod"}], "]"}], "=", 
      RowBox[{"ENmaxBlock", "[", 
       RowBox[{
        RowBox[{"DataDistrNfinal", "[", "prod", "]"}], ",", 
        RowBox[{"-", "7"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{"LogLogPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ENmax", "[", 
      RowBox[{"1.5", ",", "\[Theta]N", ",", "\"\<D\>\""}], "]"}], ",", 
     RowBox[{"ENmax", "[", 
      RowBox[{"1.5", ",", "\[Theta]N", ",", "\"\<B\>\""}], "]"}], ",", 
     RowBox[{"ENmax", "[", 
      RowBox[{"1.5", ",", "\[Theta]N", ",", "\"\<W\>\""}], "]"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"\[Theta]N", ",", "\[Theta]minExp", ",", "\[Theta]maxExp"}], 
    "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8920894952081366`*^9, 3.8920895256694145`*^9}, {
  3.8927042830199156`*^9, 3.8927042831893654`*^9}, {3.8971987875001926`*^9, 
  3.89719878762756*^9}, {3.8971988277381597`*^9, 3.8971988278763666`*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[226]:=",ExpressionUUID->"7a13b4b5-40c4-4453-adef-7b2abbd3a149"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Number of events", "Chapter",
 CellChangeTimes->{{3.8935731783578434`*^9, 3.893573180246764*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"5fbb4af8-dafa-4fc1-a941-\
3c9daaf61f32"],

Cell[CellGroupData[{

Cell["Definitions", "Section",
 CellChangeTimes->{{3.897198873663946*^9, 3.8971988750678434`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"45f096be-93cf-4e54-a28a-\
00e98e01b159"],

Cell[CellGroupData[{

Cell["\<\
Grids for the initial data with acceptances and distributions\
\>", "Subsection",
 CellChangeTimes->{{3.897198934328184*^9, 3.89719895293719*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"c4d18ce7-1929-4268-a3ee-\
cf2b7713f9a9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Grid", " ", 
     SubscriptBox["m", "S"]}], ",", " ", 
    SubscriptBox["\[Theta]", "S"], ",", " ", 
    SubscriptBox["E", "S"], ",", " ", 
    RowBox[{
     SubscriptBox["z", "S"], " ", "for", " ", "the", " ", "initial", " ", 
     "acceptance", " ", "data"}], ",", " ", "logarithmized"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"InGridm\[Epsilon]", "=", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"\[Epsilon]FullDecayDataFinal", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InGrid\[Theta]\[Epsilon]", "=", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"\[Epsilon]FullDecayDataFinal", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InGridE\[Epsilon]", "=", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"\[Epsilon]FullDecayDataFinal", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InGridz\[Epsilon]", "=", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"\[Epsilon]FullDecayDataFinal", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Array", " ", "of", " ", "values", " ", "of", " ", "the", " ", "initial",
       " ", "acceptance", " ", "data"}], ",", " ", "reshaped"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Epsilon]vals", "=", 
     RowBox[{"ArrayReshape", "[", 
      RowBox[{
       RowBox[{"\[Epsilon]FullDecayDataFinal", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "5"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Length", "[", "InGridm\[Epsilon]", "]"}], ",", 
         RowBox[{"Length", "[", "InGrid\[Theta]\[Epsilon]", "]"}], ",", 
         RowBox[{"Length", "[", "InGridE\[Epsilon]", "]"}], ",", 
         RowBox[{"Length", "[", "InGridz\[Epsilon]", "]"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Epsilon]azValscomp", "=", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"data", ",", "_Real", ",", "2"}], "}"}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"data", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "5", "]"}], "]"}], "==", "0"}], ",", 
           RowBox[{"-", "90."}], ",", 
           RowBox[{"Log10", "[", 
            RowBox[{
             RowBox[{"data", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "5", "]"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "data", "]"}], ",", "1"}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
       RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Epsilon]azvals", "=", 
     RowBox[{"ArrayReshape", "[", 
      RowBox[{
       RowBox[{
       "\[Epsilon]azValscomp", "[", "FullAcceptanceHNLmixingeData", "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Length", "[", "InGridm\[Epsilon]", "]"}], ",", 
         RowBox[{"Length", "[", "InGrid\[Theta]\[Epsilon]", "]"}], ",", 
         RowBox[{"Length", "[", "InGridE\[Epsilon]", "]"}], ",", 
         RowBox[{"Length", "[", "InGridz\[Epsilon]", "]"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
     "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
     "___", "__"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Grid", " ", 
      SubscriptBox["m", "S"]}], ",", " ", 
     SubscriptBox["\[Theta]", "S"], ",", " ", 
     RowBox[{
      SubscriptBox["E", "S"], " ", "for", " ", "the", " ", "initial", " ", 
      "FIP", " ", "distribution", " ", "data"}], ",", " ", "logarithmized"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"DataLogarithmiedComp", "=", 
    RowBox[{
     RowBox[{"Hold", "@", 
      RowBox[{"Compile", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"data", ",", "_Real", ",", "2"}], "}"}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"data", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "4", "]"}], "]"}], "\[Equal]", "0"}], ",", 
            RowBox[{"-", "90."}], ",", 
            RowBox[{"Log10", "[", 
             RowBox[{
              RowBox[{"data", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "4", "]"}], "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "data", "]"}], ",", "1"}], "}"}]}], "]"}], 
        ",", 
        RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
        RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}]}], "//",
      "ReleaseHold"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockGridsValsDistr", "[", "ProdChannel_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"GridIn", ",", "vals"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"GridIn", "=", 
        RowBox[{"Log10", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{
             RowBox[{"DataDistrNfinal", "[", "ProdChannel", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "#"}], "]"}], "]"}], "]"}], "&"}], "/@", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"vals", "=", 
        RowBox[{"ArrayReshape", "[", 
         RowBox[{
          RowBox[{"DataLogarithmiedComp", "[", 
           RowBox[{"DataDistrNfinal", "[", "ProdChannel", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"GridIn", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
            RowBox[{"Length", "[", 
             RowBox[{"GridIn", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
            RowBox[{"Length", "[", 
             RowBox[{"GridIn", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"GridIn", ",", "vals"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"GridInFinal", "[", "prod", "]"}], ",", 
          RowBox[{"DistrVals", "[", "prod", "]"}]}], "}"}], "=", 
        RowBox[{"BlockGridsValsDistr", "[", "prod", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";"}], "//", 
    "AbsoluteTiming"}]}]}]], "Input",
 CellChangeTimes->{{3.897199659637949*^9, 3.8971996790804834`*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[230]:=",ExpressionUUID->"362947e6-0af8-4fba-8ad4-008d1861456a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Grid to be used to calculate the number of events", "Subsection",
 CellChangeTimes->{{3.8971989779703307`*^9, 3.8971989844379535`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"dcb44a18-3337-4468-b94c-\
ee43b8a5f39f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Grid", " ", 
     SubscriptBox["\[Theta]", "S"]}], ",", " ", 
    RowBox[{
     SubscriptBox["z", "S"], " ", "for", " ", "the", " ", "final", " ", 
     "acceptance", " ", "data"}], ",", " ", "logarithmized"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"OutGrid\[Theta]final", "=", 
     RowBox[{"(*", "InGrid\[Theta]\[Epsilon]", "*)"}], 
     RowBox[{"Log10", "[", 
      RowBox[{"Table", "[", 
       RowBox[{"x", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"10", "^", 
           RowBox[{"Min", "[", "InGrid\[Theta]\[Epsilon]", "]"}]}], ",", 
          RowBox[{"10", "^", 
           RowBox[{"Max", "[", "InGrid\[Theta]\[Epsilon]", "]"}]}], ",", 
          FractionBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"10", "^", 
              RowBox[{"Max", "[", "InGrid\[Theta]\[Epsilon]", "]"}]}], "-", 
             RowBox[{"10", "^", 
              RowBox[{"Min", "[", "InGrid\[Theta]\[Epsilon]", "]"}]}]}], 
            ")"}], "30"]}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"OutGridzfinal", "=", 
     RowBox[{"Log10", "[", 
      RowBox[{"Table", "[", 
       RowBox[{"x", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          SuperscriptBox["10", 
           RowBox[{"InGridz\[Epsilon]", "[", 
            RowBox[{"[", "1", "]"}], "]"}]], ",", 
          SuperscriptBox["10", 
           RowBox[{"InGridz\[Epsilon]", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]], ",", 
          RowBox[{"Min", "[", 
           RowBox[{
            FractionBox[
             RowBox[{
              SuperscriptBox["10", 
               RowBox[{"InGridz\[Epsilon]", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}]], "-", 
              SuperscriptBox["10", 
               RowBox[{"InGridz\[Epsilon]", "[", 
                RowBox[{"[", "1", "]"}], "]"}]]}], "5"], ",", 
            RowBox[{"Max", "[", 
             RowBox[{"0.5", ",", 
              FractionBox[
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["10", 
                  RowBox[{"InGridz\[Epsilon]", "[", 
                   RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]], "-", 
                 SuperscriptBox["10", 
                  RowBox[{"InGridz\[Epsilon]", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]]}], ")"}], "30"]}], "]"}]}],
            "]"}]}], "}"}]}], "]"}], "]"}]}], 
    RowBox[{"(*", "InGridz\[Epsilon]", "*)"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalDelta]xVals", "[", "list_", "]"}], ":=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        FractionBox[
         RowBox[{
          RowBox[{"list", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"list", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "2"], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"list", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "-", 
          RowBox[{"list", "[", 
           RowBox[{"[", 
            RowBox[{"i", "-", "1"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"Length", "[", "list", "]"}], ",", "1"}], "}"}]}], "]"}]}],
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalDelta]\[Theta]vals", "=", 
     RowBox[{"\[CapitalDelta]xVals", "[", 
      SuperscriptBox["10", "OutGrid\[Theta]final"], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalDelta]zvals", "=", 
     RowBox[{"\[CapitalDelta]xVals", "[", 
      SuperscriptBox["10", "OutGridzfinal"], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Final", " ", "energy", " ", 
      RowBox[{"grid", ".", " ", "Mass"}]}], "-", " ", 
     RowBox[{"and", " ", "production", " ", "channel"}], "-", "dependent"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"StepEtemp", "[", "Efip_", "]"}], "=", 
     RowBox[{"Piecewise", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.3", ",", 
          RowBox[{"Efip", "\[LessEqual]", "2.5"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.5", ",", 
          RowBox[{"2.5", "<", "Efip", "<", "35"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", 
          RowBox[{"35", "\[LessEqual]", "Efip", "\[LessEqual]", "50"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", 
          RowBox[{"50", "<", "Efip", "<", "160"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5", ",", 
          RowBox[{"160", "\[LessEqual]", "Efip", "<", "300"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"40", ",", 
          RowBox[{"300", "\[LessEqual]", "Efip", "<", "700"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"50", ",", 
          RowBox[{"700", "\[LessEqual]", "Efip", "<", "2000"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"200", ",", 
          RowBox[{"2000", "\[LessEqual]", "Efip", "<", "4000"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"400", ",", 
          RowBox[{"4000", "\[LessEqual]", "Efip", "<", "7000"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"500", ",", 
          RowBox[{"7000", "\[LessEqual]", "Efip", "\[LessEqual]", "50000"}]}],
          "}"}]}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"OutGridEnergy", "[", 
     RowBox[{"m_", ",", "ProdChannel_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"start", "=", 
            RowBox[{"1.01", "m"}]}], ",", 
           RowBox[{"end", "=", 
            RowBox[{"ENmax", "[", 
             RowBox[{"m", ",", "\[Theta]minExp", ",", "ProdChannel"}], 
             "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Log10", "[", 
          RowBox[{"NestWhileList", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "+", 
              RowBox[{"StepEtemp", "[", "#", "]"}]}], "&"}], ",", "start", 
            ",", 
            RowBox[{
             RowBox[{"#", "\[LessEqual]", "end"}], "&"}], ",", "1", ",", 
            "\[Infinity]", ",", 
            RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}], "//", "N"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalDelta]xValsTotComp", "=", 
     RowBox[{
      RowBox[{"Hold", "@", 
       RowBox[{"Compile", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[CapitalDelta]\[Theta]vals", ",", "_Real", ",", "1"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[CapitalDelta]Evals", ",", "_Real", ",", "1"}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"\[CapitalDelta]zvals", ",", "_Real", ",", "1"}], "}"}]}],
           "}"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[CapitalDelta]\[Theta]vals", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "*", 
             RowBox[{"\[CapitalDelta]Evals", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "*", 
             RowBox[{"\[CapitalDelta]zvals", "[", 
              RowBox[{"[", "k", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "\[CapitalDelta]\[Theta]vals", "]"}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "\[CapitalDelta]Evals", "]"}]}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", 
             RowBox[{"Length", "[", "\[CapitalDelta]zvals", "]"}]}], "}"}]}], 
          "]"}], ",", 
         RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
         RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}]}], "//",
       "ReleaseHold"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8972023930977507`*^9, 3.8972024003159914`*^9}, {
  3.8972037912719955`*^9, 3.897203794873706*^9}, {3.8972042319753127`*^9, 
  3.8972042376735725`*^9}, {3.8972043473390894`*^9, 3.897204353429783*^9}, {
  3.8972047978657155`*^9, 3.89720480634333*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[240]:=",ExpressionUUID->"f304f3ae-7673-42f0-8d21-f2dc640445b1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Code that computes the number of events - using the mapping method \
\>", "Subsection",
 CellChangeTimes->{{3.897199076623907*^9, 3.8971990900052223`*^9}, {
  3.8972009084104066`*^9, 3.897200920680235*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"6491e7e8-2b47-409d-8dc5-\
04c3c61be598"],

Cell[CellGroupData[{

Cell["Grid for distribution times acceptance", "Subsubsection",
 CellChangeTimes->{{3.8972000893750353`*^9, 3.897200100182712*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"04edeee7-d473-4910-931e-\
5114eeb1b1e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Block", " ", "that", " ", "computes", " ", "the", " ", "grid", " ", 
     SubscriptBox["\[Theta]", "S"]}], ",", 
    SubscriptBox["E", "S"], ",", 
    SubscriptBox["z", "S"], ",", " ", 
    RowBox[{
     SubscriptBox["\[Epsilon]", "Full"], "\[Times]", 
     SubscriptBox["f", 
      RowBox[{
       SubscriptBox["\[Theta]", "S"], ",", 
       SubscriptBox["E", "S"]}]]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"TableIntegrandDiscret", "[", 
    RowBox[{"m_", ",", "ProdChannel_", ",", "\[Epsilon]DecOp_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"OutGridEfinal", "=", 
       RowBox[{"OutGridEnergy", "[", 
        RowBox[{
         RowBox[{"N", "[", "m", "]"}], ",", "ProdChannel"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalDelta]Evals", "=", 
       RowBox[{"\[CapitalDelta]xVals", "[", 
        SuperscriptBox["10", "OutGridEfinal"], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalDelta]xValsTot", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"\[CapitalDelta]xValsTotComp", "[", 
          RowBox[{
          "\[CapitalDelta]\[Theta]vals", ",", "\[CapitalDelta]Evals", ",", 
           "\[CapitalDelta]zvals"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"OutGridFinal", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Log10", "[", 
            RowBox[{"N", "[", "m", "]"}], "]"}], "}"}], ",", 
          "OutGrid\[Theta]final", ",", "OutGridEfinal", ",", 
          "OutGridzfinal"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"OutGridFinal1", "=", 
       RowBox[{"10", "^", 
        RowBox[{"OutGridFinal", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "3", ",", "4"}], "}"}]}], "]"}], "]"}]}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"g\[Epsilon]", "=", 
       RowBox[{"{", 
        RowBox[{
        "InGridm\[Epsilon]", ",", "InGrid\[Theta]\[Epsilon]", ",", 
         "InGridE\[Epsilon]", ",", "InGridz\[Epsilon]"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xg\[Epsilon]", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Log10", "[", 
           RowBox[{"N", "[", "m", "]"}], "]"}], "}"}], ",", 
         "OutGrid\[Theta]final", ",", "OutGridEfinal", ",", "OutGridzfinal"}],
         "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xig\[Epsilon]", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Interpolation", "[", 
            RowBox[{
             RowBox[{"Transpose", "@", 
              RowBox[{"{", 
               RowBox[{"#", ",", 
                RowBox[{"Range", "@", 
                 RowBox[{"Length", "@", "#"}]}]}], "}"}]}], ",", 
             RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
           "#2", "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"g\[Epsilon]", ",", "xg\[Epsilon]"}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"\[Epsilon]Result", "=", 
       RowBox[{"10", "^", 
        RowBox[{"Flatten", "@", 
         RowBox[{"cf4", "[", 
          RowBox[{
           RowBox[{"Sequence", "@@", "xig\[Epsilon]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"\[Epsilon]DecOp", "==", "\"\<True\>\""}], ",", 
             "\[Epsilon]vals", ",", "\[Epsilon]azvals"}], "]"}]}], 
          "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gDistr", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"GridInFinal", "[", "ProdChannel", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"GridInFinal", "[", "ProdChannel", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"GridInFinal", "[", "ProdChannel", "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xgDistr", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Log10", "[", 
           RowBox[{"N", "[", "m", "]"}], "]"}], "}"}], ",", 
         "OutGrid\[Theta]final", ",", "OutGridEfinal"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xigDistr", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Interpolation", "[", 
            RowBox[{
             RowBox[{"Transpose", "@", 
              RowBox[{"{", 
               RowBox[{"#", ",", 
                RowBox[{"Range", "@", 
                 RowBox[{"Length", "@", "#"}]}]}], "}"}]}], ",", 
             RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
           "#2", "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"gDistr", ",", "xgDistr"}], "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"DistrResult", "=", 
       RowBox[{"10", "^", 
        RowBox[{"Flatten", "@", 
         RowBox[{"cf3", "[", 
          RowBox[{
           RowBox[{"Sequence", "@@", "xigDistr"}], ",", 
           RowBox[{"DistrVals", "[", "ProdChannel", "]"}]}], "]"}]}]}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"TabTemp0", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"OutGridFinal1", ",", 
         RowBox[{"List", "/@", 
          RowBox[{"Flatten", "[", 
           RowBox[{"DistrResult", " ", 
            RowBox[{"Partition", "[", 
             RowBox[{"\[Epsilon]Result", ",", 
              RowBox[{"Length", "[", "OutGridzfinal", "]"}]}], "]"}]}], 
           "]"}]}], ",", "\[CapitalDelta]xValsTot", ",", "2"}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8971994275280633`*^9, 3.897199455815837*^9}, {
  3.897199582357897*^9, 3.897199655914138*^9}, {3.897199710190297*^9, 
  3.8971997629515643`*^9}, {3.8971998392552953`*^9, 3.897199857485531*^9}, {
  3.8971999081472673`*^9, 3.897199913176509*^9}, {3.897200806217702*^9, 
  3.897200808930355*^9}, {3.8972008448098516`*^9, 3.897200868455401*^9}, {
  3.8972021893667536`*^9, 3.897202196806899*^9}, {3.89720660886187*^9, 
  3.8972066089868507`*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[248]:=",ExpressionUUID->"6c3d2756-cd43-4d3a-8d20-6edcabc2f4d0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Convoluting acceptances with pre-factor", "Subsubsection",
 CellChangeTimes->{{3.8972001073570213`*^9, 3.8972001113381767`*^9}, {
  3.897200680751539*^9, 3.8972006887621703`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"31b8b541-df2e-455f-b136-\
ead82cb8c48c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Values", " ", 
     SubscriptBox["f", "FIP"], "\[Times]", 
     SubscriptBox["\[Epsilon]", "FIP"], "\[Times]", 
     FractionBox[
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", 
         SubscriptBox["z", "FIP"]}], "/", 
        RowBox[{"(", 
         RowBox[{"cos", 
          RowBox[{"(", 
           SubscriptBox["\[Theta]", "FIP"], ")"}], 
          SubscriptBox["c\[Tau]", "FIP"], 
          RowBox[{
           SubscriptBox["p", "FIP"], "/", 
           SubscriptBox["m", "FIP"]}]}], ")"}]}], "]"}], 
      RowBox[{"cos", 
       RowBox[{"(", 
        SubscriptBox["\[Theta]", "FIP"], ")"}], 
       SubscriptBox["c\[Tau]", "FIP"], 
       RowBox[{
        SubscriptBox["p", "FIP"], "/", 
        SubscriptBox["m", "FIP"]}]}]], "\[Times]", 
     SubscriptBox["\[Epsilon]", "decay"], 
     SubscriptBox["\[CapitalDelta]z", "FIP"], 
     SubscriptBox["\[CapitalDelta]E", "FIP"], 
     SubscriptBox["\[CapitalDelta]\[Theta]", "FIP"], " ", "for", " ", "the", 
     " ", "grid", " ", "of", " ", "values", " ", 
     SubscriptBox["\[Theta]", "FIP"]}], ",", " ", 
    SubscriptBox["E", "FIP"], ",", " ", 
    RowBox[{
     SubscriptBox["z", "FIP"], " ", "fixed", " ", "values", " ", "of", " ", 
     SubscriptBox["c\[Tau]", "FIP"], " ", "and", " ", 
     SubscriptBox["m", "FIP"]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tableprefac", "=", 
     RowBox[{
      RowBox[{"Hold", "@", 
       RowBox[{"Compile", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"tabb", ",", "_Real", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", "_Real"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c\[Tau]", ",", "_Real"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"decProb", ",", "_Integer"}], "}"}]}], "}"}], ",", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "angles", ",", "energies", ",", "zv", ",", "values", ",", 
             "\[CapitalDelta]s", ",", "prefactor"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"values", "=", 
             RowBox[{"Compile`GetElement", "[", 
              RowBox[{"tabb", ",", "4"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"\[CapitalDelta]s", "=", 
             RowBox[{"Compile`GetElement", "[", 
              RowBox[{"tabb", ",", "5"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"decProb", "==", "1"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"angles", "=", 
                RowBox[{"Compile`GetElement", "[", 
                 RowBox[{"tabb", ",", "1"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"energies", "=", 
                RowBox[{"Compile`GetElement", "[", 
                 RowBox[{"tabb", ",", "2"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"zv", "=", 
                RowBox[{"Compile`GetElement", "[", 
                 RowBox[{"tabb", ",", "3"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"prefactor", "=", 
                FractionBox[
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", "zv"}], "/", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Cos", "[", "angles", "]"}], "*", "c\[Tau]", "*", 
                    FractionBox[
                    SqrtBox[
                    RowBox[{
                    SuperscriptBox["energies", "2"], "-", 
                    SuperscriptBox["m", "2"]}]], "m"]}], ")"}]}], "]"}], 
                 RowBox[{
                  RowBox[{"Cos", "[", "angles", "]"}], "*", "c\[Tau]", "*", 
                  FractionBox[
                   SqrtBox[
                    RowBox[{
                    SuperscriptBox["energies", "2"], "-", 
                    SuperscriptBox["m", "2"]}]], "m"]}]]}]}], ",", 
              RowBox[{"prefactor", "=", "1."}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"prefactor", "*", "\[CapitalDelta]s", "*", "values"}]}]}],
           "]"}], ",", 
         RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
         RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
         RowBox[{"Parallelization", "\[Rule]", "\"\<True\>\""}], ",", 
         RowBox[{"RuntimeAttributes", "\[Rule]", 
          RowBox[{"{", "Listable", "}"}]}]}], "]"}]}], "//", 
      "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Summation", " ", "of", " ", "the", " ", "values", " ", "above"}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sumcompile", "=", 
     RowBox[{
      RowBox[{"Hold", "@", 
       RowBox[{"Compile", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"tabc\[Tau]m", ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
         RowBox[{"Total", "[", "tabc\[Tau]m", "]"}], ",", 
         RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
         RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
         RowBox[{"Parallelization", "\[Rule]", "\"\<True\>\""}]}], "]"}]}], "//",
       "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mmin\[Epsilon]", ",", "mmax\[Epsilon]"}], "}"}], "=", 
    RowBox[{"10", "^", 
     RowBox[{"MinMax", "[", "InGridm\[Epsilon]", "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{
  3.897200675960476*^9, {3.8972040486175427`*^9, 3.897204049008037*^9}, {
   3.897204079641328*^9, 3.8972040859999785`*^9}, {3.8972057591435843`*^9, 
   3.8972057626279507`*^9}, {3.897209025837668*^9, 3.897209026230255*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[249]:=",ExpressionUUID->"ce57dd68-88a2-4cc8-893d-5ea3f66ad10f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Acceptances", "Subsubsection",
 CellChangeTimes->{{3.8972009286929445`*^9, 3.8972009324601674`*^9}, 
   3.897201517674982*^9},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"9e99525b-3954-43c0-b2e5-\
6e0e571aabe0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FactorANUBISceiling", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"SelectedExperiment", "==", "\"\<ANUBIS-ceiling\>\""}], ",", "2",
      ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AcceptanceDiscret", "[", 
   RowBox[{
   "m_", ",", "ProdChannel_", ",", "\[Epsilon]decOp_", ",", "decProb_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"NevDiscret", ",", "NpotTimes\[Chi]val"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"mNmin", "[", "ProdChannel", "]"}], ",", "mmin\[Epsilon]"}],
          "]"}], "<", "m", "<", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"mNmax", "[", "ProdChannel", "]"}], ",", "mmax\[Epsilon]"}],
          "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"integrandtab", "=", 
         RowBox[{"TableIntegrandDiscret", "[", 
          RowBox[{"m", ",", "ProdChannel", ",", "\[Epsilon]decOp"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"brvis", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"\[Epsilon]decOp", "==", "1"}], ",", 
           RowBox[{"BrVisMean", "[", "m", "]"}], ",", "1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Test", " ", "lifetime", " ", "for", " ", "the", " ", "acceptance"}],
          "*)"}], "\[IndentingNewLine]", 
        RowBox[{"c\[Tau]acc", "=", 
         SuperscriptBox["10", "9"]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Prefactor", " ", "for", " ", "the", " ", 
          RowBox[{"acceptance", ".", " ", "If"}], " ", "only", " ", 
          "azimuthal", " ", "and"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"prefacacc", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"decProb", "==", "1"}], ",", "c\[Tau]acc", ",", 
           FractionBox["1", 
            RowBox[{"zmaxExp", "-", "zminExp"}]]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"accdiscret", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"brvis", "!=", "0"}], ",", 
           RowBox[{"FactorANUBISceiling", "*", "brvis", "*", "prefacacc", "*", 
            RowBox[{"sumcompile", "[", 
             RowBox[{"tableprefac", "[", 
              RowBox[{
              "integrandtab", ",", "m", ",", "c\[Tau]acc", ",", "decProb"}], 
              "]"}], "]"}]}], ",", "0"}], "]"}]}]}], ",", 
       RowBox[{"accdiscret", "=", "0"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "accdiscret"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.8972011084712963`*^9, 3.897201128340288*^9}, {
   3.8972011891481795`*^9, 3.89720124049387*^9}, {3.8972012897384634`*^9, 
   3.897201325360157*^9}, {3.897201589075931*^9, 3.8972016624203763`*^9}, {
   3.8972018160050974`*^9, 3.8972018498780518`*^9}, {3.89720191795713*^9, 
   3.8972019346903367`*^9}, {3.8972020225483*^9, 3.8972020975166674`*^9}, {
   3.8972023111284375`*^9, 3.897202311275799*^9}, 3.8972023780567894`*^9, {
   3.897205334073205*^9, 3.8972053351996293`*^9}, {3.897206603491517*^9, 
   3.8972066036108027`*^9}, {3.8972090193978825`*^9, 3.8972090198332167`*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[252]:=",ExpressionUUID->"d1b47169-8d0d-476a-988c-68cf11ceb917"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Acceptances and approximate lower/upper bounds computation", "Section",
 CellChangeTimes->{{3.8972012648879433`*^9, 3.897201267668914*^9}, {
  3.8972059482630224`*^9, 3.8972059524445267`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"4c15ac19-2b32-497c-9efb-\
3dbe6240cb77"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"mNlistAcceptance", "[", "prod", "]"}], "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"m", ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", 
           RowBox[{"1.01", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"mNmin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}], 
             "]"}]}], ",", 
           RowBox[{"0.95", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"mNmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}], 
             "]"}]}], ",", 
           RowBox[{"Min", "[", 
            RowBox[{
             FractionBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"0.95", 
                 RowBox[{"Min", "[", 
                  RowBox[{
                   RowBox[{"mNmax", "[", "prod", "]"}], ",", 
                   "mmax\[Epsilon]"}], "]"}]}], "-", 
                RowBox[{"1.01", 
                 RowBox[{"Max", "[", 
                  RowBox[{
                   RowBox[{"mNmin", "[", "prod", "]"}], ",", 
                   "mmin\[Epsilon]"}], "]"}]}]}], ")"}], "20"], ",", "2"}], 
            "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.99", 
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"mNmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}], 
          "]"}]}], "}"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"mN", ",", 
          RowBox[{"AcceptanceDiscret", "[", 
           RowBox[{"mN", ",", "prod", ",", "\"\<False\>\"", ",", "0"}], "]"}],
           ",", 
          RowBox[{"AcceptanceDiscret", "[", 
           RowBox[{"mN", ",", "prod", ",", "\"\<True\>\"", ",", "0"}], "]"}], 
          ",", 
          RowBox[{"AcceptanceDiscret", "[", 
           RowBox[{"mN", ",", "prod", ",", "\"\<False\>\"", ",", "1"}], "]"}],
           ",", 
          RowBox[{"AcceptanceDiscret", "[", 
           RowBox[{"mN", ",", "prod", ",", "\"\<True\>\"", ",", "1"}], 
           "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"mN", ",", 
          RowBox[{"mNlistAcceptance", "[", "prod", "]"}]}], "}"}]}], "]"}]}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlotAcc", "[", "ProdChannel_", "]"}], ":=", 
  RowBox[{"ListLogPlot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "4"}], "}"}]}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "5"}], "}"}]}], "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", " ", "22"}], "]"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Blue"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
         RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
         RowBox[{"Darker", "@", 
          RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Black"}], "}"}]}], 
      "}"}]}], ",", 
    RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"MinMax", "[", 
        RowBox[{
         RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.9", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}], "]"}]}], ",", 
         RowBox[{"1.1", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}]}], "]"}]}]}], 
        "}"}]}], "}"}]}], ",", 
    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(m\), \(N\)]\) [GeV]\>\"", ",", 
       "\"\<Acceptance\>\""}], "}"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", " ", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<From \>\"", ",", "ProdChannel"}], "}"}], "]"}], ",", 
       " ", "20", ",", " ", "Black"}], "]"}]}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"Placed", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"#", ",", " ", "18"}], "]"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{
          "\"\<<\!\(\*SubscriptBox[\(\[Epsilon]\), \(FIP\)]\)>\>\"", ",", 
           "\"\<<\!\(\*SubscriptBox[\(\[Epsilon]\), \
\(FIP\)]\)\!\(\*SubscriptBox[\(\[Epsilon]\), \(decay\)]\)>\>\"", ",", 
           "\"\<c\[Tau]<\!\(\*SubscriptBox[\(\[Epsilon]\), \
\(FIP\)]\)\!\(\*SubscriptBox[\(P\), \(decay\)]\)>\>\"", ",", 
           "\"\<c\[Tau]<\!\(\*SubscriptBox[\(\[Epsilon]\), \
\(FIP\)]\)\!\(\*SubscriptBox[\(P\), \(decay\)]\)\!\(\*SubscriptBox[\(\
\[Epsilon]\), \(decay\)]\)>\>\""}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.75", ",", "0.2"}], "}"}]}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Style", "[", 
   RowBox[{
    RowBox[{"Row", "[", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"PlotAcc", "[", "prod", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "]"}], 
     "]"}], ",", 
    RowBox[{"ImageSizeMultipliers", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"FilenameAcceptance", "[", "prod", "]"}], "=", 
       RowBox[{"ToString", "@", 
        RowBox[{"StringForm", "[", 
         RowBox[{
         "\"\<Acceptance_HNL_mixing-pattern_``-``-``_at_``_From_``.dat\>\"", 
          ",", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"MixingPattern", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"MixingPattern", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"MixingPattern", "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", "SelectedExperiment", ",", 
             "prod"}], "}"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<Auxiliary data/HNLs\>\"", ",", "SelectedExperiment", ",", 
           RowBox[{"FilenameAcceptance", "[", "prod", "]"}]}], "}"}], "]"}], 
        ",", 
        RowBox[{
         RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "4", ",", "5"}], "}"}]}], "]"}], 
         "]"}], ",", "\"\<Table\>\""}], "]"}]}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AccAveraged", "[", "mN_", "]"}], "=", 
   RowBox[{"NpotGivenExperiment", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"mNmin", "[", "prod", "]"}], "<", "mN", "<", 
           RowBox[{"mNmax", "[", "prod", "]"}]}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"\[Chi]Xtimes\[Chi]XtoNtot", "[", 
            RowBox[{"mN", ",", "prod"}], "]"}], "]"}], ",", "0"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ",", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"mNmin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}], 
            "]"}], "<", "mN", "<", 
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"mNmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}], 
            "]"}]}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"\[Chi]Xtimes\[Chi]XtoNtot", "[", 
             RowBox[{"mN", ",", "prod"}], "]"}], "*", 
            RowBox[{
             RowBox[{"Interpolation", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
               RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
             "mN", "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ",", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"mNmin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}], 
            "]"}], "<", "mN", "<", 
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"mNmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}], 
            "]"}]}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"\[Chi]Xtimes\[Chi]XtoNtot", "[", 
              RowBox[{"mN", ",", "prod"}], "]"}], "c\[Tau]acc"], "*", 
            RowBox[{
             RowBox[{"Interpolation", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "4"}], "}"}]}], "]"}], "]"}], ",", 
               RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
             "mN", "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ",", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"mNmin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}], 
            "]"}], "<", "mN", "<", 
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"mNmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}], 
            "]"}]}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"\[Chi]Xtimes\[Chi]XtoNtot", "[", 
              RowBox[{"mN", ",", "prod"}], "]"}], "c\[Tau]acc"], "*", 
            RowBox[{
             RowBox[{"Interpolation", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "5"}], "}"}]}], "]"}], "]"}], ",", 
               RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
             "mN", "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}]}], "}"}]}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<Auxiliary data/HNLs\>\"", ",", "SelectedExperiment", ",", 
      RowBox[{"ToString", "@", 
       RowBox[{"StringForm", "[", 
        RowBox[{
        "\"\<Acceptance_averaged_HNL_mixing-pattern_``-``-``.m\>\"", ",", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"MixingPattern", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"MixingPattern", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"MixingPattern", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}]}], "]"}]}]}], "}"}], 
    "]"}], ",", 
   RowBox[{"AccAveraged", "[", "mN", "]"}], ",", "\"\<MX\>\""}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.897205194596387*^9, 3.8972052417988367`*^9}, {
  3.897205309605931*^9, 3.89720539403836*^9}, {3.8972055297271395`*^9, 
  3.89720562453496*^9}, {3.8972056761558304`*^9, 3.897205703295968*^9}, {
  3.897205781529233*^9, 3.8972057841962852`*^9}, {3.897205893477086*^9, 
  3.897205918862975*^9}, {3.897206478456417*^9, 3.8972065044154882`*^9}, {
  3.902650628096882*^9, 3.9026506323180237`*^9}, {3.9028909253472185`*^9, 
  3.9028909282956314`*^9}, {3.903892722173996*^9, 3.9038927247502317`*^9}, {
  3.9039419773987193`*^9, 3.9039419776984277`*^9}, {3.905840789471221*^9, 
  3.905840795298962*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[254]:=",ExpressionUUID->"f3fe450d-f3e5-4dcf-a461-3b60f738e10a"],

Cell[CellGroupData[{

Cell["Rough estimates of the upper and lower bounds", "Subsection",
 CellChangeTimes->{{3.8850328066928463`*^9, 3.8850328135228024`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"5d40a47f-a3f4-4c55-bfdd-\
de6659311dff"],

Cell[CellGroupData[{

Cell["Definitions", "Subsubsection",
 CellChangeTimes->{{3.877676708463168*^9, 3.877676711193803*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"4620d5c6-4ba4-4160-a53a-\
2e1ec6d66d3c"],

Cell[BoxData[{
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"U2minEstimate", "[", 
      RowBox[{"mN_", ",", "prod"}], "]"}], "=", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox[
        RowBox[{"NpotGivenExperiment", "*", 
         RowBox[{"\[Chi]Xtimes\[Chi]XtoNtot", "[", 
          RowBox[{"mN", ",", "prod"}], "]"}], "*", 
         RowBox[{
          RowBox[{"Interpolation", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "5"}], "}"}]}], "]"}], "]"}], ",", 
            RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
          "mN", "]"}]}], 
        RowBox[{"2.3", 
         RowBox[{"ldecayN", "[", 
          RowBox[{"mN", ",", "1", ",", "EN"}], "]"}], "*", 
         FractionBox["mN", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["EN", "2"], "-", 
            SuperscriptBox["mN", "2"]}]]]}]], ")"}], 
      RowBox[{
       RowBox[{"-", "1"}], "/", "2."}]]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"U2maxEstimate", "[", 
      RowBox[{"mN_", ",", "prod"}], "]"}], "=", 
     RowBox[{"Re", "[", 
      RowBox[{"Evaluate", "[", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"ProductLog", "[", 
           RowBox[{
            RowBox[{"-", "1"}], ",", 
            RowBox[{
             RowBox[{"-", "2.3"}], "*", 
             FractionBox["b", "a"]}]}], "]"}], "b"]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a", "\[Rule]", " ", 
           RowBox[{"NpotGivenExperiment", "*", 
            RowBox[{"\[Chi]Xtimes\[Chi]XtoNtot", "[", 
             RowBox[{"mN", ",", "prod"}], "]"}], "*", 
            RowBox[{
             RowBox[{"Interpolation", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
               RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
             "mN", "]"}]}]}], ",", 
          RowBox[{"b", "\[Rule]", 
           FractionBox["zminExp", 
            RowBox[{"ldecayN", "[", 
             RowBox[{"mN", ",", "1", ",", 
              RowBox[{"ENmax", "[", 
               RowBox[{"0.1", ",", "\[Theta]minExp", ",", "prod"}], "]"}]}], 
             "]"}]]}]}], "}"}]}], "]"}], "]"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"prod", ",", "ProductionList"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"LogLogPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"U2minEstimate", "[", 
      RowBox[{"mN", ",", "\"\<D\>\""}], "]"}], ",", 
     RowBox[{"U2minEstimate", "[", 
      RowBox[{"mN", ",", "\"\<B\>\""}], "]"}], ",", 
     RowBox[{"U2maxEstimate", "[", 
      RowBox[{"mN", ",", "\"\<B\>\""}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"mN", ",", "0.05", ",", "5.3"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8927045521296835`*^9, 3.892704618398532*^9}, {
   3.892704651576499*^9, 3.892704652867281*^9}, 3.8951292466391563`*^9, {
   3.8972064547512426`*^9, 3.8972064548441195`*^9}, {3.8972065272743893`*^9, 
   3.8972065273639555`*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[260]:=",ExpressionUUID->"e0cd2be1-c14d-4ab5-9f48-84d9da50a0e2"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Number of events", "Section",
 CellChangeTimes->{{3.8972012736109533`*^9, 3.897201275449023*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"52ce57d0-f982-4567-bb71-\
be778a9c5b79"],

Cell[CellGroupData[{

Cell["Number of events - fast", "Subsection",
 CellChangeTimes->{{3.897206442190997*^9, 3.8972064427846107`*^9}, {
  3.905840801739196*^9, 3.90584080453067*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"5c76bc0a-1db7-4811-bd32-\
c85fe14817d5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FactorLowerBound", "=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<ANUBIS-shaft-volume-1\>\"", ",", 
           "\"\<ANUBIS-shaft-volume-2\>\"", ",", 
           "\"\<ANUBIS-shaft-volume-3\>\""}], "}"}], ",", 
         "SelectedExperiment"}], "]"}], "==", "True"}], ",", "0.1", ",", 
      "0.3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Number", " ", "of", " ", "events"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NeventsDiscret", "[", 
   RowBox[{"m_", ",", "ProdChannel_", ",", "U2list_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"NevDiscret", ",", "NpotTimes\[Chi]val"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"mNmin", "[", "ProdChannel", "]"}], ",", "mmin\[Epsilon]"}], 
        "]"}], "<", "m", "<", 
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"mNmax", "[", "ProdChannel", "]"}], ",", "mmax\[Epsilon]"}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"integrandtab", "=", 
        RowBox[{"TableIntegrandDiscret", "[", 
         RowBox[{"m", ",", "ProdChannel", ",", "\"\<True\>\""}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NpotTimes\[Chi]val", "[", "U2_", "]"}], "=", 
        RowBox[{"NpotGivenExperiment", "*", 
         RowBox[{"\[Chi]Xtimes\[Chi]XtoNtot", "[", 
          RowBox[{"m", ",", "ProdChannel"}], "]"}], "*", "U2"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"lowerbound", ",", "upperbound"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"U2minEstimate", "[", 
           RowBox[{"m", ",", "ProdChannel"}], "]"}], ",", 
          RowBox[{"U2maxEstimate", "[", 
           RowBox[{"m", ",", "ProdChannel"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"brvis", "=", 
        RowBox[{"BrVisMean", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NevDiscret", "[", "U2_", "]"}], ":=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"brvis", "!=", "0"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"FactorLowerBound", "*", "lowerbound"}], "<", "U2", "<", 
             RowBox[{"1.5", "upperbound"}]}], ",", 
            RowBox[{"FactorANUBISceiling", "*", 
             RowBox[{"NpotTimes\[Chi]val", "[", "U2", "]"}], "*", "brvis", 
             "*", 
             RowBox[{"sumcompile", "[", 
              RowBox[{"tableprefac", "[", 
               RowBox[{"integrandtab", ",", "m", ",", 
                RowBox[{"c\[Tau]N", "[", 
                 RowBox[{"m", ",", "U2"}], "]"}], ",", "1"}], "]"}], "]"}]}], 
            ",", "0"}], "]"}], ",", "0"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"m", ",", 
           RowBox[{"U2list", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"NevDiscret", "[", 
            RowBox[{"U2list", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "U2list", "]"}], ",", "1"}], "}"}]}], 
        "]"}]}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"m", ",", 
          RowBox[{"U2list", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "U2list", "]"}], ",", "1"}], "}"}]}], 
       "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.897200964730176*^9, 3.897200965970766*^9}, {
   3.89720118259857*^9, 3.8972011870868115`*^9}, {3.8972012433916793`*^9, 
   3.8972012434804716`*^9}, {3.8972021109080114`*^9, 3.897202111357911*^9}, {
   3.897205130000824*^9, 3.8972051305748835`*^9}, 3.897206599004672*^9, {
   3.897209033815679*^9, 3.897209034629726*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[262]:=",ExpressionUUID->"1da0870e-6f30-475c-a37c-399f53a2446c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Number of events - slow (using built-in Mathematica functions Interpolation, \
NIntegrate)\
\>", "Subsection",
 CellChangeTimes->{{3.8972050850842867`*^9, 3.897205097581136*^9}, {
  3.9058408064511366`*^9, 3.9058408128973536`*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"291df21e-e39d-48d1-9816-\
af096ec7783f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PdecayDensity", "[", 
    RowBox[{"mN_", ",", "U2_", ",", "\[Theta]N_", ",", "EN_", ",", "zN_"}], 
    "]"}], "=", 
   FractionBox[
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", "zN"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]N", "]"}], "*", 
        RowBox[{"ldecayN", "[", 
         RowBox[{"mN", ",", "U2", ",", "EN"}], "]"}]}], ")"}]}], "]"}], 
    RowBox[{
     RowBox[{"Cos", "[", "\[Theta]N", "]"}], "*", 
     RowBox[{"ldecayN", "[", 
      RowBox[{"mN", ",", "U2", ",", "EN"}], "]"}]}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"IntegrandN", "[", 
     RowBox[{
     "mN_", ",", "U2_", ",", "\[Theta]N_", ",", "EN_", ",", "zN_", ",", 
      "prod"}], "]"}], "=", 
    RowBox[{
     RowBox[{"DoubleDistrN", "[", 
      RowBox[{"mN", ",", "\[Theta]N", ",", "EN", ",", "prod"}], "]"}], "*", 
     RowBox[{"PdecayDensity", "[", 
      RowBox[{"mN", ",", "U2", ",", "\[Theta]N", ",", "EN", ",", "zN"}], 
      "]"}], "*", 
     RowBox[{"AzimuthalAcceptanceHNL", "[", 
      RowBox[{"\[Theta]N", ",", "zN"}], "]"}], "*", 
     RowBox[{"DecayAcceptanceHNL", "[", 
      RowBox[{"mN", ",", "\[Theta]N", ",", "EN", ",", "zN"}], "]"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"prod", ",", "ProductionList"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IntegralN", "[", 
   RowBox[{"mN_", ",", "U2_", ",", "ProdChannel_"}], "]"}], ":=", 
  RowBox[{"NIntegrate", "[", 
   RowBox[{
    RowBox[{"Abs", "[", 
     RowBox[{"IntegrandN", "[", 
      RowBox[{
      "mN", ",", "U2", ",", "\[Theta]N", ",", "EN", ",", "zN", ",", 
       "ProdChannel"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Theta]N", ",", "\[Theta]minExp", ",", "\[Theta]maxExp"}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"EN", ",", "mN", ",", 
      RowBox[{"ENmax", "[", 
       RowBox[{"mN", ",", "\[Theta]N", ",", "ProdChannel"}], "]"}]}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"zN", ",", 
      RowBox[{"zmin\[Theta]", "[", "\[Theta]N", "]"}], ",", 
      RowBox[{"zmax\[Theta]", "[", "\[Theta]N", "]"}]}], "}"}], ",", 
    RowBox[{"Method", "\[Rule]", "\"\<AdaptiveMonteCarlo\>\""}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nevents", "[", 
   RowBox[{"mN_", ",", "U2_", ",", "ProdChannel_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"mNmin", "[", "ProdChannel", "]"}], "\[LessEqual]", "mN", 
      "\[LessEqual]", 
      RowBox[{"mNmax", "[", "ProdChannel", "]"}]}], "&&", 
     RowBox[{
      RowBox[{"BrVisMean", "[", "mN", "]"}], "!=", "0"}]}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"FactorLowerBound", "*", 
        RowBox[{"U2minEstimate", "[", 
         RowBox[{"mN", ",", "ProdChannel"}], "]"}]}], "<", "U2", "<", 
       RowBox[{"1.8", 
        RowBox[{"U2maxEstimate", "[", 
         RowBox[{"mN", ",", "ProdChannel"}], "]"}]}]}], ",", 
      RowBox[{"FactorANUBISceiling", "*", "NpotGivenExperiment", "*", 
       RowBox[{"\[Chi]Xtimes\[Chi]XtoNtot", "[", 
        RowBox[{"mN", ",", "ProdChannel"}], "]"}], "*", "U2", "*", 
       RowBox[{"IntegralN", "[", 
        RowBox[{"mN", ",", "U2", ",", "ProdChannel"}], "]"}]}], ",", "0"}], 
     "]"}], ",", "0"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.897206676519309*^9, 3.8972066766919394`*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[264]:=",ExpressionUUID->"eb7ffb3d-8072-4807-a3e0-dabda50d141b"],

Cell[CellGroupData[{

Cell["Test", "Subsubsection",
 CellChangeTimes->{{3.8921113169894333`*^9, 3.8921113174761143`*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"b08eb9e9-1d17-4be6-b837-\
6727be6144e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "This", " ", "is", " ", "a", " ", "comparison", " ", "between", " ", 
     "the", " ", "slow", " ", "and", " ", "fast", " ", "integration", " ", 
     RowBox[{"methods", ".", " ", "For"}], " ", "the", " ", "selected", " ", 
     "mass", " ", "and", " ", "production", " ", "channel"}], ",", " ", 
    RowBox[{
    "the", " ", "numbers", " ", "of", " ", "events", " ", "obtained", " ", 
     "using", " ", "the", " ", "methods", " ", "should", " ", "agree", " ", 
     "within", " ", "10", "%"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"If", " ", "the", " ", "agreement", " ", "is", " ", "worse"}], 
    ",", " ", 
    RowBox[{
    "there", " ", "may", " ", "be", " ", "a", " ", "few", " ", "reasons"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"1", ")"}], " ", "The", " ", "grid", " ", "for", " ", "the", " ",
      "fast", " ", "method", " ", "is", " ", "not", " ", "dense", " ", 
     RowBox[{"enough", ".", " ", "Try"}], " ", "to", " ", "increase", " ", 
     "the", " ", "grid", " ", "density", " ", 
     RowBox[{"(", 
      RowBox[{
      "OutGrid\[Theta]final", ",", " ", "OutGridEfinal", ",", " ", 
       "OutGridzfinal"}], ")"}], " ", "to", " ", "see", " ", "whether", " ", 
     "the", " ", "agreement", " ", 
     RowBox[{"improves", ".", " ", "Sometimes"}]}], ",", " ", 
    RowBox[{
    "even", " ", "a", " ", "slightly", " ", "denser", " ", "grid", " ", "for",
      " ", 
     RowBox[{"e", ".", "g", ".", " ", "z"}], " ", "may", " ", "lead", " ", 
     "to", " ", "a", " ", "significant", " ", "improvement", " ", "in", " ", 
     "the", " ", "agrement"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"2", ")"}], " ", "The", " ", "Monte"}], "-", 
      RowBox[{
      "Carlo", " ", "integrator", " ", "for", " ", "the", " ", "slow", " ", 
       "method", " ", "fails", " ", "to", " ", "evaluate", " ", 
       "properly"}]}], ";", " ", 
     RowBox[{
     "this", " ", "may", " ", "happen", " ", "if", " ", "the", " ", "range", 
      " ", "of", " ", "the", " ", "integration", " ", "over", " ", "energies",
       " ", "is", " ", "too", " ", "large", " ", "compared", " ", "to", " ", 
      "the", " ", "domain", " ", "where", " ", "most", " ", "of", " ", "the", 
      " ", "events", " ", "actually", " ", "are", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"off", "-", 
         RowBox[{
         "axis", " ", "experiments", " ", "such", " ", "as", " ", "MATHUSLA", 
          " ", "and", " ", "ANUBIS"}]}], ")"}], ".", " ", "Another"}], " ", 
      "symptom", " ", "is", " ", "that", " ", "for", " ", "the", " ", "given",
       " ", "mass", " ", "and", " ", "coupling", " ", "the", " ", "integral", 
      " ", "\"\<jumps\>\""}]}], ",", " ", 
    RowBox[{"i", ".", "e", "."}], ",", " ", 
    RowBox[{
    "returns", " ", "values", " ", "with", " ", "large", " ", "error"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"mtest", "=", "0.43"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ProdTest", "=", "\"\<D\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"U2list", "=", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["10", 
          RowBox[{"-", "12"}]], ",", 
         RowBox[{"3", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "12"}]]}], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "12"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "11"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "11"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "10"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "10"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "9"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "9"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "8"}]], ",", 
         RowBox[{"2", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "8"}]]}], ",", 
         RowBox[{"4", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "8"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "7"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"6", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"7", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"8", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"9", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "6"}]], ",", 
         RowBox[{"2", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "6"}]]}]}], "}"}], "//", "N"}], "*)"}], 
     RowBox[{"Table", "[", 
      RowBox[{
       SuperscriptBox["10", "x"], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"-", "12."}], ",", 
         RowBox[{"-", "1.5"}], ",", "0.1"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dat1", "=", 
      RowBox[{"NeventsDiscret", "[", 
       RowBox[{"mtest", ",", "ProdTest", ",", "U2list"}], "]"}]}], ";"}], "//",
     "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dat2", "=", 
      RowBox[{"ParallelTable", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"U2list", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"c\[Tau]N", "[", 
           RowBox[{"mtest", ",", 
            RowBox[{"U2list", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"Nevents", "[", 
           RowBox[{"mtest", ",", 
            RowBox[{"U2list", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "ProdTest"}], "]"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "U2list", "]"}], ",", "1"}], "}"}]}], 
       "]"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{"dat1", ",", 
      RowBox[{"dat2", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "2"}], "}"}]}], "]"}], "]"}], ",", "2"}], "]"}], "//",
     "TableForm"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQB2IQ/WGGz585/9841uZ6Mc4F0o9WbeQH0Uz2KgIg+u/s
uzIgWipTSQ5Ei5u/DgLRFUyfI0C0ZhpPLIg++O5QOoh22ThrLYie8WAumA4o
vXgJRE9hfAim3fruPQXRNqueg+m2DK63ILr4BS+YNtvtzjYPSOdO6uIH0e1/
dAvnA+kPzfpgukRt2rEzjG8ddWTkToBojmJ1hXNAOqTxhhKILgkOD7/J8dZR
oCwdTNvM5y4C0X+exoLpiA+ZzSB6rVMDmNbS4Pz7EEh/cboGoad8Y38MpB94
hHCA6B2VqpFPgLRQWXs1iJa9E1wPoi8cLW0C0Xf2e7eBaLnGtC4QXfZ28t0P
wm8dHR5I3gfR1zbOPPtN4q0jS8tKMA0AaJHLDA==
  "],
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[268]:=",ExpressionUUID->"f91d634e-d2ea-4f8a-ad54-213b450a81a5"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Differential number of events", "Subsection",
 CellChangeTimes->{{3.892111289211891*^9, 3.892111293865343*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"81f7b327-4279-40bc-bdd8-\
0cdc2e2facd4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "same", " ", "as", " ", "tableprefac", " ", "but", " ", "also",
     " ", "including", " ", "the", " ", "grid"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tableGridPrefac", "=", 
     RowBox[{
      RowBox[{"Hold", "@", 
       RowBox[{"Compile", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"tabb", ",", "_Real", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"mN", ",", "_Real"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c\[Tau]", ",", "_Real"}], "}"}]}], "}"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Cos", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "*", "c\[Tau]", 
                   "*", 
                   FractionBox[
                    SqrtBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "2"], "-", 
                    SuperscriptBox["mN", "2"]}]], "mN"]}], ")"}]}], "]"}], 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "*", "c\[Tau]", "*", 
                FractionBox[
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "2"], "-", 
                   SuperscriptBox["mN", "2"]}]], "mN"]}]], 
              RowBox[{"#", "[", 
               RowBox[{"[", "4", "]"}], "]"}], "*", 
              RowBox[{"#", "[", 
               RowBox[{"[", "5", "]"}], "]"}]}]}], "}"}], "&"}], "/@", 
          "tabb"}], ",", 
         RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
         RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
         RowBox[{"Parallelization", "\[Rule]", "\"\<True\>\""}], ",", 
         RowBox[{"RuntimeAttributes", "\[Rule]", 
          RowBox[{"{", "Listable", "}"}]}]}], "]"}]}], "//", 
      "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Summation", " ", "returning", " ", "the", " ", "differential", " ", 
      "number", " ", "of", " ", "events", " ", "X"}], ",", " ", 
     RowBox[{"df", "/", "dX"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"NdiffCompiled", "=", 
    RowBox[{
     RowBox[{"Hold", "@", 
      RowBox[{"Compile", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"tabNdiff", ",", "_Real", ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"GridQuantity", ",", "_Real", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"LengthPerVariable", ",", "_Integer"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"NPoTtimesPprod", ",", "_Real"}], "}"}]}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"tabNdiff", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"LengthPerVariable", "*", 
                 RowBox[{"(", 
                  RowBox[{"i", "-", "1"}], ")"}]}], "+", "1"}], "]"}], "]"}], 
             "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"NPoTtimesPprod", "*", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"tabNdiff", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"LengthPerVariable", "*", 
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}]}], "+", "j"}], "]"}], 
                 "]"}], "[", 
                RowBox[{"[", "4", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", "LengthPerVariable", ",", "1"}], 
                "}"}]}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "GridQuantity", "]"}], ",", "1"}], "}"}]}],
          "]"}], ",", 
        RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
        RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
        RowBox[{"Parallelization", "\[Rule]", "\"\<True\>\""}]}], "]"}]}], "//",
      "ReleaseHold"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Variable", " ", "=", " ", 
      "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\""}], ",", 
     "\"\<\!\(\*SubscriptBox[\(x\), \(x\)]\)\>\"", ",", 
     RowBox[{
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", ".", " ", "The"}], 
      " ", "number", " ", "belongs", " ", "to", " ", "the", " ", "column", 
      " ", "in", " ", "the", " ", "tabulated", " ", "data"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"iVal", ":=", 
    RowBox[{"Association", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\"", " ", "\[Rule]", "2"}], 
       ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", "\[Rule]", "1"}], 
       ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(x\), \(x\)]\)\>\"", "\[Rule]", "3"}]}], 
      "}"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Differential", " ", "number", " ", "of", " ", "events"}], "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NeventsDifferentialDiscret", "[", 
     RowBox[{"m_", ",", "ProdChannel_", ",", "U2_", ",", "Variable_"}], "]"}],
     ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "NpotTimes\[Chi]val", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ival", "=", 
        RowBox[{"iVal", "[", "Variable", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"NpotTimes\[Chi]val", "=", 
        RowBox[{"NpotGivenExperiment", "*", 
         RowBox[{"\[Chi]Xtimes\[Chi]XtoNtot", "[", 
          RowBox[{"m", ",", "ProdChannel"}], "]"}], "*", "U2"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tablegrid0", "=", 
        RowBox[{"TableIntegrandDiscret", "[", 
         RowBox[{"m", ",", "ProdChannel", ",", "\"\<True\>\""}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"\[CapitalDelta]xvals", ":=", 
        RowBox[{"Association", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\"", "\[Rule]", 
            "\[CapitalDelta]Evals"}], ",", 
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", "\[Rule]", 
            " ", "\[CapitalDelta]\[Theta]vals"}], ",", 
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(x\), \(X\)]\)\>\"", "\[Rule]", " ", 
            "\[CapitalDelta]zvals"}]}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[CapitalDelta]xval", "=", 
        RowBox[{"\[CapitalDelta]xvals", "[", "Variable", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"c\[Tau]Val", "=", 
        RowBox[{"c\[Tau]N", "[", 
         RowBox[{"m", ",", "U2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"brvis", "=", 
        RowBox[{"BrVisMean", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ilist", "=", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"{", 
          RowBox[{"ival", ",", "1", ",", "2", ",", "3"}], "}"}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"tablegrid1", "=", 
        RowBox[{"SortBy", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"ilist", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"ilist", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"ilist", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "&"}], "/@", 
           RowBox[{"tableGridPrefac", "[", 
            RowBox[{"tablegrid0", ",", "m", ",", "c\[Tau]Val"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"GridQuantity", "=", 
        RowBox[{
         RowBox[{"tablegrid1", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", 
         "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"LengthPerVariable", "=", 
        RowBox[{
         RowBox[{"Length", "[", "tablegrid1", "]"}], "/", 
         RowBox[{"Length", "[", "GridQuantity", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tab1", "=", 
        RowBox[{"NdiffCompiled", "[", 
         RowBox[{
         "tablegrid1", ",", "GridQuantity", ",", "LengthPerVariable", ",", 
          RowBox[{"NpotTimes\[Chi]val", "*", "brvis"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"tab1", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", "1", "}"}]}], "]"}], "]"}], ",", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"tab1", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}], "*", 
            SuperscriptBox["\[CapitalDelta]xval", 
             RowBox[{"-", "1"}]]}], ",", "1"}], "]"}], ",", "2"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mvaltest", "=", "0.4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"U2test", "=", 
     SuperscriptBox["10", 
      RowBox[{"-", "7."}]]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"quantity", "=", "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"LegendX", ":=", 
    RowBox[{"Association", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\"", "\[Rule]", 
        "\"\<\!\(\*SubscriptBox[\(E\), \(N\)]\) [GeV]\>\""}], ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", "\[Rule]", 
        "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(N\)]\) [rad]\>\""}], ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(x\), \(X\)]\)\>\"", "\[Rule]", " ", 
        "\"\<\!\(\*SubscriptBox[\(z\), \(N\)]\) [m]\>\""}]}], "}"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"LegendY", ":=", 
    RowBox[{"Association", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\"", "\[Rule]", 
        "\"\<\!\(\*SubscriptBox[\(dN\), \(ev\)]\)/\!\(\*SubscriptBox[\(dE\), \
\(N\)]\) [\!\(\*SuperscriptBox[\(GeV\), \(-1\)]\)]\>\""}], ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", "\[Rule]", 
        "\"\<\!\(\*SubscriptBox[\(dN\), \(ev\)]\)/\!\(\*SubscriptBox[\(d\
\[Theta]\), \(N\)]\) [\!\(\*SuperscriptBox[\(rad\), \(-1\)]\)]\>\""}], ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(x\), \(X\)]\)\>\"", "\[Rule]", " ", 
        "\"\<\!\(\*SubscriptBox[\(dN\), \(ev\)]\)/\!\(\*SubscriptBox[\(dz\), \
\(N\)]\) [\!\(\*SuperscriptBox[\(m\), \(-1\)]\)]\>\""}]}], "}"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"proclisttemp", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{"mNmin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}], 
          "]"}], "<", "mvaltest", "<", 
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"mNmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"proclisttemp", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"proclisttemp", ",", 
            RowBox[{"{", "prod", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"NdiffData", "[", "prod", "]"}], "=", 
          RowBox[{"NeventsDifferentialDiscret", "[", 
           RowBox[{"mvaltest", ",", "prod", ",", "U2test", ",", "quantity"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"XvalminmaxNdiff", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"NdiffData", "[", "prod", "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ">", 
                SuperscriptBox["10", 
                 RowBox[{"-", "40"}]]}], "&"}]}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "MinMax"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"NdiffInt", "[", 
           RowBox[{"X_", ",", "prod"}], "]"}], "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"XvalminmaxNdiff", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "<", "X", "<", 
             RowBox[{"XvalminmaxNdiff", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"10", "^", 
              RowBox[{
               RowBox[{"Interpolation", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log10", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Log10", "[", 
                    RowBox[{
                    RowBox[{"FactorANUBISceiling", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "+", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "90"}]]}], "]"}]}], "}"}], "&"}], "/@", 
                  RowBox[{"NdiffData", "[", "prod", "]"}]}], ",", 
                 RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
               RowBox[{"Log10", "[", "X", "]"}], "]"}]}], "]"}], ",", "0"}], 
           "]"}]}]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NdiffInt", "[", 
      RowBox[{"X_", ",", "\"\<Total\>\""}], "]"}], "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"NdiffInt", "[", 
        RowBox[{"X", ",", "prod"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"prod", ",", "proclisttemp"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LegendList", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", "\"\<Total\>\"", "}"}], ",", "proclisttemp"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"QuantityMinMax", "=", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"MinMax", "[", 
          RowBox[{
           RowBox[{"NdiffData", "[", "prod", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"prod", ",", "proclisttemp"}], "}"}]}], "]"}], ",", "1"}], 
      "]"}], "//", "MinMax"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ValueMinMax", "=", 
     RowBox[{"Max", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"NdiffData", "[", "#", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "&"}], "/@", 
       "proclisttemp"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"LogLogPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NdiffInt", "[", 
         RowBox[{"X", ",", "prod"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "LegendList"}], "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"X", ",", 
       RowBox[{"QuantityMinMax", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"QuantityMinMax", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox["10", 
           RowBox[{"-", "5"}]], ",", 
          RowBox[{"2", "ValueMinMax"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Black"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Darker", "@", 
           RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Darker", "@", "Cyan"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Magenta"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Blue", ",", 
          RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Darker", "@", "Red"}], ",", 
          RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Darker", "@", 
           RowBox[{"Darker", "@", "Green"}]}], ",", 
          RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"Placed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"#", ",", "20"}], "]"}], "&"}], "/@", "LegendList"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.85", ",", "0.7"}], "}"}]}], "]"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"LegendX", "[", "quantity", "]"}], " ", ",", 
        RowBox[{"LegendY", "[", "quantity", "]"}]}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", " ", "23"}], "]"}]}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{
          "SelectedExperiment", ",", 
           "\"\<. \!\(\*SubscriptBox[\(m\), \(N\)]\) = \>\"", ",", "mvaltest",
            ",", "\"\< GeV, \!\(\*SuperscriptBox[\(U\), \(2\)]\) = \>\"", ",",
            "U2test"}], "}"}], "]"}], ",", "20", ",", "Black"}], "]"}]}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8921163996135225`*^9, 3.8921164016036096`*^9}, {
   3.8921164560955544`*^9, 3.892116475031265*^9}, {3.892116516434699*^9, 
   3.8921165782759094`*^9}, {3.8921166461579666`*^9, 
   3.8921166470109124`*^9}, {3.8921167042134895`*^9, 3.892116729930051*^9}, {
   3.8927049818255663`*^9, 3.8927049991222277`*^9}, {3.8929115471019087`*^9, 
   3.892911593659387*^9}, {3.8929721720425777`*^9, 3.892972173350433*^9}, {
   3.8929722208773427`*^9, 3.8929722211847763`*^9}, {3.8932578131000147`*^9, 
   3.893257813645747*^9}, {3.8934746693595037`*^9, 3.893474675301323*^9}, {
   3.8935154039618015`*^9, 3.893515450284458*^9}, {3.893515943430369*^9, 
   3.893515962817915*^9}, 3.893516005738713*^9, {3.893516036174548*^9, 
   3.893516050479193*^9}, {3.893516088577403*^9, 3.893516089018369*^9}, {
   3.893516189974946*^9, 3.8935161902213464`*^9}, {3.8935162352543807`*^9, 
   3.8935162734266047`*^9}, {3.893516595793399*^9, 3.893516611219179*^9}, {
   3.893606026577932*^9, 3.8936060575609436`*^9}, 3.8955578364377675`*^9, {
   3.8969794021337876`*^9, 3.89697940417612*^9}, {3.897206579842867*^9, 
   3.897206594529684*^9}, {3.9026499642485466`*^9, 3.902649964280243*^9}, {
   3.902768965184558*^9, 3.9027689658101315`*^9}, {3.9028039373256345`*^9, 
   3.9028039391298485`*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[274]:=",ExpressionUUID->"cb90c87c-f03c-424d-b49a-66ae1ce879f0"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Exporting tabulated number of events", "Title",
 CellChangeTimes->{{3.8850207904521627`*^9, 3.885020796464762*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"d9cc7f48-090a-4576-84bf-\
78e61b4f24e1"],

Cell[CellGroupData[{

Cell["Definitions", "Chapter",
 CellChangeTimes->{{3.8850542017641125`*^9, 3.885054203349573*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"2954a636-16b9-43d9-baa5-\
a2a8079c668c"],

Cell[BoxData[{
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"DirectoryQ", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", 
          "\"\<Tabulated Nevents\>\""}], "}"}], "]"}], "]"}], "//", 
      "ToString"}], ")"}], "\[Equal]", "\"\<False\>\""}], ",", 
   RowBox[{"CreateDirectory", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", 
       "\"\<Tabulated Nevents\>\""}], "}"}], "]"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"DirectoryQ", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", 
          "\"\<Tabulated Nevents/HNLs\>\""}], "}"}], "]"}], "]"}], "//", 
      "ToString"}], ")"}], "\[Equal]", "\"\<False\>\""}], ",", 
   RowBox[{"CreateDirectory", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", 
       "\"\<Tabulated Nevents/HNLs\>\""}], "}"}], "]"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"DirectoryQ", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", 
          "\"\<Tabulated Nevents/HNLs\>\"", ",", "SelectedExperiment"}], 
         "}"}], "]"}], "]"}], "//", "ToString"}], ")"}], "\[Equal]", 
    "\"\<False\>\""}], ",", 
   RowBox[{"CreateDirectory", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", 
       "\"\<Tabulated Nevents/HNLs\>\"", ",", "SelectedExperiment"}], "}"}], 
     "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<List of filenames with exported tabulated number of events\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"FilenameNevents", "[", "prod", "]"}], "=", 
    RowBox[{"ToString", "@", 
     RowBox[{"StringForm", "[", 
      RowBox[{
      "\"\<Nevents_HNL_MixingPattern_``-``-``_type_``_at_``_Npot=``_From_``.\
dat\>\"", ",", 
       RowBox[{"Sequence", "@@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"MixingPattern", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"ToString", "[", 
           RowBox[{"MixingPattern", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
          RowBox[{"ToString", "[", 
           RowBox[{"MixingPattern", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", "HNLtype", ",", 
          "SelectedExperiment", ",", 
          RowBox[{
           RowBox[{"NpotGivenExperiment", "//", "CForm"}], "//", "ToString"}],
           ",", "prod"}], "}"}]}]}], "]"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"prod", ",", "ProductionList"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"FilenameNevents", "[", "prod", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "//", 
  "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mNlistExport", "[", "\"\<K\>\"", "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{"mx", ",", 
     RowBox[{"{", 
      RowBox[{"mx", ",", "0.051", ",", "0.495", ",", "0.02"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mNlistExport", "[", "\"\<D\>\"", "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{"mx", ",", 
     RowBox[{"{", 
      RowBox[{"mx", ",", "0.051", ",", "1.951", ",", "0.02"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mNlistExport", "[", "\"\<B\>\"", "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{"mx", ",", 
     RowBox[{"{", 
      RowBox[{"mx", ",", "0.051", ",", "6.301", ",", "0.02"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mNlistExport", "[", "\"\<W\>\"", "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<LHC\>\"", ",", "\"\<FCC-hh\>\""}], "}"}], ",", 
        "FacilityGivenExperiment"}], "]"}], "==", "True"}], ",", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"mx", ",", 
         RowBox[{"{", 
          RowBox[{"mx", ",", "0.051", ",", "3.301", ",", "0.02"}], "}"}]}], 
        "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"mx", ",", 
         RowBox[{"{", 
          RowBox[{"mx", ",", "3.35", ",", "10", ",", "0.05"}], "}"}]}], "]"}],
        ",", 
       RowBox[{"Table", "[", 
        RowBox[{"mx", ",", 
         RowBox[{"{", 
          RowBox[{"mx", ",", "10.1", ",", "20.", ",", "0.1"}], "}"}]}], 
        "]"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U2range", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SuperscriptBox["10", "x"], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "13"}], ",", 
       RowBox[{"-", "3"}], ",", "0.03"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8850528402073092`*^9, 3.885052964529935*^9}, {
   3.8850529967024455`*^9, 3.88505313318991*^9}, {3.885053172661522*^9, 
   3.885053247354876*^9}, {3.885053717249408*^9, 3.8850537696983976`*^9}, {
   3.885054057416253*^9, 3.88505420740788*^9}, {3.8850542428480587`*^9, 
   3.885054257815028*^9}, {3.885054905514982*^9, 3.885054927992525*^9}, {
   3.88523276755499*^9, 3.885232776819412*^9}, {3.885455723827387*^9, 
   3.885455752199112*^9}, {3.8860943280607367`*^9, 3.88609453355086*^9}, {
   3.886095483621874*^9, 3.8860955126810937`*^9}, {3.886127990264927*^9, 
   3.88612799141245*^9}, 3.888642888624179*^9, {3.8927050133604655`*^9, 
   3.8927050485447173`*^9}, {3.89270509762475*^9, 3.8927051590738735`*^9}, {
   3.8927051996590557`*^9, 3.892705244059099*^9}, {3.892972242768362*^9, 
   3.8929722651603527`*^9}, {3.895054416512721*^9, 3.89505442773033*^9}, {
   3.895129365318982*^9, 3.8951293726690607`*^9}, {3.8951295427032895`*^9, 
   3.8951295742143564`*^9}, {3.9025655422778378`*^9, 
   3.9025655612003827`*^9}, {3.9061950056497498`*^9, 3.9061950332851324`*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[290]:=",ExpressionUUID->"8c0b6592-284c-4a87-9a77-8e50d3c85c08"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Exporting", "Chapter",
 CellChangeTimes->{{3.885054212114191*^9, 3.885054213032151*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"94264685-3bea-4e26-b629-\
98b9c56f1aa5"],

Cell[CellGroupData[{

Cell["Common definition", "Section",
 CellChangeTimes->{{3.8921886043857117`*^9, 3.8921886076155424`*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"ba8c2bda-9c02-4d57-8be1-\
d67e61121d9a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BlockExport", "[", "ProdChannel_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"ProductionList", ",", 
         RowBox[{
          RowBox[{"#", "\[Equal]", "ProdChannel"}], "&"}]}], "]"}], 
       "\[Equal]", 
       RowBox[{"{", "}"}]}], ",", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mlist", "=", 
        RowBox[{"mNlistExport", "[", "ProdChannel", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"TabFrom", "=", 
        RowBox[{"Monitor", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"NeventsDiscret", "[", 
             RowBox[{
              RowBox[{"mlist", "[", 
               RowBox[{"[", "k", "]"}], "]"}], ",", "ProdChannel", ",", 
              "U2range"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", 
              RowBox[{"Length", "[", "mlist", "]"}], ",", "1"}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"Row", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ProgressIndicator", "[", 
               RowBox[{"k", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"Length", "[", "mlist", "]"}]}], "}"}]}], "]"}], 
              ",", "\"\<i = \>\"", ",", "k", ",", "\"\</\>\"", ",", 
              RowBox[{"Length", "[", "mlist", "]"}], ",", "\"\<, m = \>\"", 
              ",", 
              RowBox[{"mlist", "[", 
               RowBox[{"[", "k", "]"}], "]"}], ",", "\"\< GeV\>\""}], "}"}], 
            ",", "\"\< \>\""}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], ",", 
            "\"\<Tabulated Nevents/HNLs\>\"", ",", "SelectedExperiment", ",", 
            RowBox[{"FilenameNevents", "[", "ProdChannel", "]"}]}], "}"}], 
          "]"}], ",", 
         RowBox[{"Flatten", "[", 
          RowBox[{"TabFrom", ",", "1"}], "]"}], ",", "\"\<Table\>\""}], 
        "]"}]}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8921886102299604`*^9, 3.892188661864987*^9}, {
  3.892188696661598*^9, 3.892188782889353*^9}, {3.8921888713769283`*^9, 
  3.8921888914281387`*^9}, {3.892190937661848*^9, 3.8921909466626697`*^9}, {
  3.8922765048644934`*^9, 3.8922765048725324`*^9}, {3.892541051864915*^9, 
  3.8925411081031237`*^9}, {3.8925422299627275`*^9, 3.8925422591259813`*^9}, {
  3.892542627960807*^9, 3.8925426356350746`*^9}, {3.8927052313065047`*^9, 
  3.892705270088846*^9}, {3.8927053287465887`*^9, 3.8927053297156878`*^9}, {
  3.895077832600239*^9, 3.895077843762785*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[301]:=",ExpressionUUID->"d8897b55-8608-4f93-a9b8-e4eb10318129"]
}, Open  ]],

Cell[CellGroupData[{

Cell["From K", "Section",
 CellChangeTimes->{{3.8850542186134644`*^9, 3.8850542193674097`*^9}, {
  3.9025655684285784`*^9, 3.902565568630622*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"c0d31812-e00d-4f07-8293-\
1a2985ebd0ed"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BlockExport", "[", "\"\<K\>\"", "]"}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.892132308475672*^9, 3.8921323350960183`*^9}, {
  3.8921323817772865`*^9, 3.892132382029834*^9}, {3.8927052875378094`*^9, 
  3.89270529134868*^9}, {3.902565570123613*^9, 3.9025655707687845`*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[302]:=",ExpressionUUID->"4dbf3bc6-33af-451e-9e90-dfa042f12c15"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8850542358688993`*^9, 3.8850542382094545`*^9}, {
  3.885054277631763*^9, 3.885054363431921*^9}, {3.8854557630088234`*^9, 
  3.885455763826865*^9}, {3.892132374109867*^9, 3.892132379794366*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[303]:=",ExpressionUUID->"64b03c95-e5ba-4d59-a325-de40f88ffd0e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["From D", "Section",
 CellChangeTimes->{{3.8850542186134644`*^9, 3.8850542193674097`*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"ab70e0c0-a2f2-4eda-ae9d-\
8733577337f0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BlockExport", "[", "\"\<D\>\"", "]"}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.892132308475672*^9, 3.8921323350960183`*^9}, {
  3.8921323817772865`*^9, 3.892132382029834*^9}, {3.8927052875378094`*^9, 
  3.89270529134868*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[304]:=",ExpressionUUID->"b7212a65-e9fa-485c-922e-58b2c7ab5f0e"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8850542358688993`*^9, 3.8850542382094545`*^9}, {
  3.885054277631763*^9, 3.885054363431921*^9}, {3.8854557630088234`*^9, 
  3.885455763826865*^9}, {3.892132374109867*^9, 3.892132379794366*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[305]:=",ExpressionUUID->"2455d9a1-174c-4f5d-b466-4c48245a7c0c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["From B", "Section",
 CellChangeTimes->{{3.8850542186134644`*^9, 3.8850542291940546`*^9}, {
  3.8850543968830786`*^9, 3.8850543972568283`*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"a62c93fe-2498-41f7-bb06-\
1c80acdee202"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BlockExport", "[", "\"\<B\>\"", "]"}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.885054438676489*^9, 3.8850544565771933`*^9}, {
   3.885232743746546*^9, 3.8852327455696564`*^9}, 3.885455770969474*^9, {
   3.892132385020011*^9, 3.892132399717909*^9}, {3.8927052890018206`*^9, 
   3.8927052931943846`*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[306]:=",ExpressionUUID->"5e2c5cda-f94a-4ec8-a372-3af4d38a8085"]
}, Open  ]],

Cell[CellGroupData[{

Cell["From W", "Section",
 CellChangeTimes->{{3.8850542186134644`*^9, 3.8850542262841854`*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"a9d83eda-ea97-4796-bd70-\
3bedf791cd78"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BlockExport", "[", "\"\<W\>\"", "]"}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8850542358688993`*^9, 3.8850542382094545`*^9}, {
   3.885054277631763*^9, 3.8850543855153503`*^9}, 3.8854557742800846`*^9, 
   3.888642888633216*^9, {3.8921324072446823`*^9, 3.8921324438060894`*^9}, {
   3.892705295908903*^9, 3.8927052971819277`*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[307]:=",ExpressionUUID->"038c749c-3e35-42b3-8907-6059aa02feeb"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Computing sensitivities", "Title",
 CellChangeTimes->{{3.885020809493571*^9, 3.88502081261261*^9}},
 CellTags->{
  "Sensitivity", 
   "Re-evaluation"},ExpressionUUID->"02de58fe-c9d7-4ae0-8388-b0795f1824e0"],

Cell[CellGroupData[{

Cell["Specifying the experiment and the HNL model", "Chapter",
 CellChangeTimes->{{3.886564872549308*^9, 3.886564875387725*^9}, {
  3.886564937811318*^9, 3.886564939550208*^9}, {3.886565087181673*^9, 
  3.8865650891186666`*^9}, {3.8927054451167526`*^9, 3.892705446139044*^9}},
 CellTags->{
  "Sensitivity", 
   "Re-evaluation"},ExpressionUUID->"ce0499a7-0458-4fca-8906-49450de0903c"],

Cell[BoxData[{
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"DirectoryQ", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", 
          "\"\<Sensitivity domains\>\""}], "}"}], "]"}], "]"}], "//", 
      "ToString"}], ")"}], "\[Equal]", "\"\<False\>\""}], ",", 
   RowBox[{"CreateDirectory", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", 
       "\"\<Sensitivity domains\>\""}], "}"}], "]"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"DirectoryQ", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", 
          "\"\<Sensitivity domains\>\"", ",", "\"\<HNLs\>\""}], "}"}], "]"}], 
       "]"}], "//", "ToString"}], ")"}], "\[Equal]", "\"\<False\>\""}], ",", 
   RowBox[{"CreateDirectory", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", 
       "\"\<Sensitivity domains\>\"", ",", "\"\<HNLs\>\""}], "}"}], "]"}], 
    "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NeventsDirectory", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<Tabulated Nevents/HNLs\>\""}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentDirectoriesListNevents", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"FileNames", "[", 
      RowBox[{"\"\<*\>\"", ",", "NeventsDirectory", ",", "1"}], "]"}], ",", 
     "DirectoryQ"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<List of available experiments with tabulated \!\(\*SubscriptBox[\(N\), \
\(events\)]\) for HNLs:\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentsListNevents", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"FileNameTake", "[", 
       RowBox[{
        RowBox[{"ExperimentDirectoriesListNevents", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "ExperimentDirectoriesListNevents", "]"}], ",",
         "1"}], "}"}]}], "]"}], "//", "Sort"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ExperimentsListNevents", "//", "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", "ExperimentsListNevents", "]"}], "\[Equal]", "0"}],
    ",", 
   RowBox[{
   "Print", "[", 
    "\"\<No experiment is available, generate first the acceptance for the \
given experiment using module 1\>\"", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Selected experiment:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", "ExperimentsListNevents", "]"}], "\[NotEqual]", 
    "0"}], ",", 
   RowBox[{"GivenExperimentForSensitivityComputation", "=", 
    RowBox[{"dropdownDialog", "[", 
     RowBox[{
     "ExperimentsListNevents", ",", "\"\<Select the experiment:\>\""}], 
     "]"}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CondANUBIS", "=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<ANUBIS-shaft-volume-1\>\"", ",", "\"\<ANUBIS-shaft-volume-2\>\"", 
       ",", "\"\<ANUBIS-shaft-volume-3\>\""}], "}"}], ",", 
     "GivenExperimentForSensitivityComputation"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"CondANUBIS", "\[Equal]", "True"}], ",", 
   RowBox[{"infoDialog", "[", 
    RowBox[{"Row", "[", 
     RowBox[{
     "{", "\"\<One of the modules of ANUBIS-shaft is chosen. The full \
sensitivity includes three modules. The importing will be over all modules, \
so for all ot the the sensitivity has to be computed\>\"", "}"}], "]"}], 
    "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"CondANUBIS", "\[Equal]", "False"}], ",", 
    RowBox[{"GivenExperimentForSensitivityComputationList", "=", 
     RowBox[{"{", "GivenExperimentForSensitivityComputation", "}"}]}], ",", 
    RowBox[{"GivenExperimentForSensitivityComputationList", "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\<ANUBIS-shaft-volume-1\>\"", ",", "\"\<ANUBIS-shaft-volume-2\>\"", 
       ",", "\"\<ANUBIS-shaft-volume-3\>\""}], "}"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filesNevents", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"filesNevents", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"filesNevents", ",", 
       RowBox[{"FileNames", "[", 
        RowBox[{"\"\<*.dat\>\"", ",", 
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], ",", 
            "\"\<Tabulated Nevents/HNLs\>\"", ",", "exp"}], "}"}], "]"}]}], 
        "]"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "GivenExperimentForSensitivityComputationList"}], 
     "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FilenamesNevents", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Last", "@", 
      RowBox[{"FileNameSplit", "@", 
       RowBox[{"filesNevents", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "filesNevents", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FilenameParametersTemp", "[", "i_", "]"}], ":=", 
  RowBox[{
   RowBox[{"StringCases", "[", 
    RowBox[{
     RowBox[{"FilenamesNevents", "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{
      "\"\<Nevents_HNL_MixingPattern_\>\"", "~~", "mixinge__", "~~", 
       "\"\<-\>\"", "~~", "mixing\[Mu]__", "~~", "\"\<-\>\"", "~~", 
       "mixing\[Tau]__", "~~", "\"\<_type_\>\"", "~~", "type__", "~~", 
       "\"\<_at_\>\"", "~~", "experiment__", "~~", "\"\<_Npot=\>\"", "~~", 
       "Npot__", "~~", "\"\<_From_\>\"", "~~", "mother__", "~~", 
       "\"\<.dat\>\""}], "\[RuleDelayed]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"mixinge", "//", "ToExpression"}], ",", 
        RowBox[{"mixing\[Mu]", "//", "ToExpression"}], ",", 
        RowBox[{"mixing\[Tau]", "//", "ToExpression"}], ",", "type", ",", 
        "experiment", ",", "Npot", ",", "mother"}], "}"}]}]}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FilenameParameters", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"FilenameParametersTemp", "[", "i", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "FilenamesNevents", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TableHNLtype", "=", 
   RowBox[{"DeleteDuplicates", "[", 
    RowBox[{"FilenameParameters", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}], "]"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[SubscriptBox[\(U\), \(e\)], \
\(2\)]\)/\!\(\*SuperscriptBox[\(U\), \(2\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[SubscriptBox[\(U\), \(\[Mu]\)], \
\(2\)]\)/\!\(\*SuperscriptBox[\(U\), \(2\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[SubscriptBox[\(U\), \(\[Tau]\)], \(2\)]\)/\!\
\(\*SuperscriptBox[\(U\), \(2\)]\)\>\"", ",", "\"\<HNL type\>\""}], "}"}], 
     "}"}], ",", "TableHNLtype"}], "]"}], "//", 
  "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{"dataSelected", "=", 
  RowBox[{"dropdownDialog", "[", 
   RowBox[{
   "TableHNLtype", ",", 
    "\"\<Choose available HNL mixing pattern and type \
(xe,x\[Mu],x\[Tau],Type):\>\""}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Selected mixing pattern:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"SelectedMixingPattern", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"dataSelected", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "//", "ToExpression"}], ",", 
    RowBox[{
     RowBox[{"dataSelected", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "//", "ToExpression"}], ",", 
    RowBox[{
     RowBox[{"dataSelected", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "//", "ToExpression"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Selected type - Dirac or Majorana:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"SelectedHNLtype", "=", 
  RowBox[{"dataSelected", "[", 
   RowBox[{"[", "4", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Data to import:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ParametersToImport", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"FilenameParameters", ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "==", 
        RowBox[{"dataSelected", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "&&", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "==", 
        RowBox[{"dataSelected", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "&&", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "==", 
        RowBox[{"dataSelected", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "&&", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "\[Equal]", 
        RowBox[{"dataSelected", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}]}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ParametersToImport", "//", "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NpotDefault", "=", 
   RowBox[{
    RowBox[{"Interpreter", "[", "\"\<Number\>\"", "]"}], "[", 
    RowBox[{
     RowBox[{"ParametersToImport", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "6", "]"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8865649067496457`*^9, 3.88656508233171*^9}, {
   3.8872798363330927`*^9, 3.8872798374280677`*^9}, 3.888895664352442*^9, {
   3.888895713983474*^9, 3.8888957215017242`*^9}, 3.8888980606101313`*^9, {
   3.888898120321432*^9, 3.888898138405764*^9}, {3.8888981782494583`*^9, 
   3.8888982464959397`*^9}, {3.88889833906439*^9, 3.888898345664979*^9}, {
   3.892705420067673*^9, 3.8927054237266884`*^9}, {3.8929729461904254`*^9, 
   3.892973047156645*^9}, {3.892973093086362*^9, 3.8929731659367743`*^9}, {
   3.893234602577506*^9, 3.8932346171023717`*^9}, {3.893260923559686*^9, 
   3.893260927821177*^9}, {3.893525336629264*^9, 3.8935254868389573`*^9}, {
   3.893525528418161*^9, 3.893525657278275*^9}, {3.8935256912872095`*^9, 
   3.8935257678488913`*^9}, {3.8935258136850977`*^9, 3.89352584051357*^9}, {
   3.8935258724344406`*^9, 3.8935259530239325`*^9}, {3.893526006190361*^9, 
   3.8935260203804526`*^9}, {3.8935732569376335`*^9, 
   3.8935732770951977`*^9}, {3.8950544385365515`*^9, 3.895054494246854*^9}, {
   3.895655438994194*^9, 3.895655440194024*^9}, 3.8961549410773125`*^9, {
   3.8961668042998157`*^9, 3.896166837500887*^9}, {3.896715342749509*^9, 
   3.896715356620757*^9}, 3.89684640329733*^9, {3.8968464821165648`*^9, 
   3.8968464933065434`*^9}, {3.8969550572401066`*^9, 3.8969550577754507`*^9}, 
   3.899193236863467*^9},
 CellTags->{"Sensitivity", "Re-evaluation"},
 CellLabel->
  "In[424]:=",ExpressionUUID->"0f11c942-1cb1-4bab-9d05-80dde7ee4ac3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Sensitivity evaluation", "Chapter",
 CellChangeTimes->{{3.886095016389345*^9, 3.8860950181567917`*^9}, {
  3.886565096158227*^9, 3.886565100235546*^9}},
 CellTags->{
  "Sensitivity", 
   "Re-evaluation"},ExpressionUUID->"a3ac3b31-6511-446d-ae9f-1a8d23a31004"],

Cell[CellGroupData[{

Cell["Data importing and interpolation", "Section",
 CellChangeTimes->{{3.886565107608671*^9, 3.8865651092900896`*^9}, {
   3.8888989520135384`*^9, 3.888898956208157*^9}, 3.905402568673003*^9},
 CellTags->{
  "Sensitivity", 
   "Re-evaluation"},ExpressionUUID->"3e602227-00a3-4fb9-8b9d-550ce649b396"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"NevData", "[", "i_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"filetoimport", "=", 
      RowBox[{"ToString", "@", 
       RowBox[{"StringForm", "[", 
        RowBox[{
        "\"\<Nevents_HNL_MixingPattern_``-``-``_type_``_at_``_Npot=``_From_``.\
dat\>\"", ",", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"ParametersToImport", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dat", "=", 
      RowBox[{"Import", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", 
          "\"\<Tabulated Nevents/HNLs\>\"", ",", 
          RowBox[{
           RowBox[{"ParametersToImport", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "5", "]"}], "]"}], ",", "filetoimport"}], "}"}], 
        "]"}], "]"}]}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dataimported", " ", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"NevData", "[", "i", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "ParametersToImport", "]"}], ",", "1"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IfzeroList", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"dataimported", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}], "<", 
        SuperscriptBox["10", 
         RowBox[{"-", "3"}]]}], ",", "0", ",", "1"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "dataimported", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dataimported", " ", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"IfzeroList", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "==", "1"}], ",", 
         RowBox[{"dataimported", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "IfzeroList", "]"}], ",", "1"}], "}"}]}], 
      "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"{", "Null", "}"}], ",", "#"}], "]"}], "==", "False"}], 
      "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"mNminMax", "[", "i", "]"}], ",", 
      RowBox[{"U2minMax", "[", "i", "]"}]}], "}"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"MinMax", "[", 
       RowBox[{
        RowBox[{"dataimported", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
      RowBox[{"MinMax", "[", 
       RowBox[{
        RowBox[{"dataimported", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "dataimported", "]"}], ",", "1"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"mNminMaxOverall", ",", "U2minmaxOverall"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"MinMax", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{"##", ",", "1"}], "]"}], "&"}], "@@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"mNminMax", "[", "i", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "dataimported", " ", "]"}]}], "}"}]}], 
        "]"}]}], "]"}], ",", 
     RowBox[{"MinMax", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{"##", ",", "1"}], "]"}], "&"}], "@@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"U2minMax", "[", "i", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "dataimported", " ", "]"}]}], "}"}]}], 
        "]"}]}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NevInt", "[", 
      RowBox[{"mN_", ",", "U2_", ",", "i"}], "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"mNminMax", "[", "i", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", "mN", 
         "\[LessEqual]", 
         RowBox[{
          RowBox[{"mNminMax", "[", "i", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "&&", 
        RowBox[{
         RowBox[{
          RowBox[{"U2minMax", "[", "i", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", "U2", 
         "\[LessEqual]", 
         RowBox[{
          RowBox[{"U2minMax", "[", "i", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Interpolation", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Log10", "[", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"Log10", "[", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"Log10", "[", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "+", 
                   SuperscriptBox["10", 
                    RowBox[{"-", "90"}]]}], "]"}]}], "}"}], "&"}], "/@", 
              RowBox[{"dataimported", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
           RowBox[{
            RowBox[{"Log10", "[", "mN", "]"}], ",", 
            RowBox[{"Log10", "[", "U2", "]"}]}], "]"}], ")"}]}], "]"}], ",", 
       "0"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "dataimported", " ", "]"}], ",", "1"}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NevIntTot", "[", 
    RowBox[{"mN_", ",", "U2_"}], "]"}], "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"NevInt", "[", 
      RowBox[{"mN", ",", "U2", ",", "i"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "dataimported", " ", "]"}], ",", "1"}], "}"}]}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentFolder", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"CondANUBIS", "\[Equal]", "True"}], ",", "\"\<ANUBIS-shaft\>\"", 
     ",", "GivenExperimentForSensitivityComputation"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"DirectoryQ", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", 
          "\"\<Sensitivity domains\>\"", ",", "\"\<HNLs\>\"", ",", 
          "ExperimentFolder"}], "}"}], "]"}], "]"}], "//", "ToString"}], 
     ")"}], "\[Equal]", "\"\<False\>\""}], ",", 
   RowBox[{"CreateDirectory", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", 
       "\"\<Sensitivity domains\>\"", ",", "\"\<HNLs\>\"", ",", 
       "ExperimentFolder"}], "}"}], "]"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8888983920663214`*^9, 3.888898635334957*^9}, {
   3.888898667943739*^9, 3.8888988055549335`*^9}, {3.8888988941544647`*^9, 
   3.888898937485649*^9}, {3.8929117504041605`*^9, 3.8929118976198163`*^9}, {
   3.8929119277887383`*^9, 3.8929120594750996`*^9}, {3.892973217274458*^9, 
   3.892973307169466*^9}, 3.893259419669223*^9, {3.8935260718320713`*^9, 
   3.8935260809550447`*^9}, {3.89352616418572*^9, 3.8935261987416224`*^9}, {
   3.8935263033747253`*^9, 3.893526304738557*^9}, {3.895054501255924*^9, 
   3.8950545038904667`*^9}, {3.896715366555463*^9, 3.8967153682258854`*^9}, {
   3.9054022133191314`*^9, 3.905402292437648*^9}, {3.905402524439004*^9, 
   3.905402532797618*^9}, {3.905402605889249*^9, 3.9054026255337467`*^9}, {
   3.9054026998556724`*^9, 3.905402746692725*^9}, {3.9054027914153585`*^9, 
   3.9054028828970246`*^9}, {3.905403703616481*^9, 3.9054037049711976`*^9}},
 CellTags->{"Sensitivity", "Re-evaluation"},
 CellLabel->
  "In[454]:=",ExpressionUUID->"b16e043c-492d-45d6-a73a-c48a6829d23f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubscriptBox["N", "events"], TraditionalForm]],ExpressionUUID->
  "f2841523-5ef9-4932-a82b-bab48e63705b"],
 " density plot"
}], "Section",
 CellChangeTimes->{{3.89291161772971*^9, 3.8929116255034943`*^9}},
 CellTags->{
  "Sensitivity", 
   "Re-evaluation"},ExpressionUUID->"39e6da3a-e227-483d-be39-0d9a1bce65bb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Nevmax", "=", 
   RowBox[{"Max", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{"dataimported", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "dataimported", "]"}], ",", "1"}], "}"}]}], 
     "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"plot", "=", 
  RowBox[{"DensityPlot", "[", 
   RowBox[{
    RowBox[{"Evaluate", "[", 
     RowBox[{"Log10", "[", 
      RowBox[{"NevIntTot", "[", 
       RowBox[{"mN", ",", "U2"}], "]"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"mN", ",", 
      RowBox[{"mNminMaxOverall", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"mNminMaxOverall", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"U2", ",", 
      RowBox[{"U2minmaxOverall", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"U2minmaxOverall", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"ScalingFunctions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Log\>\"", ",", "\"\<Log\>\""}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "0.78"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"All", ",", "All", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log10", "[", "2.3", "]"}], ",", 
         RowBox[{"Log10", "[", "Nevmax", "]"}]}], "}"}]}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(m\), \(N\)]\) [GeV]\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(U\), \(2\)]\)\>\""}], "}"}]}], ",", " ", 
    RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", " ", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", " ", "25"}], "]"}]}], ",", 
    RowBox[{"PlotPoints", "->", "100"}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"Placed", "[", 
      RowBox[{
       RowBox[{"BarLegend", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Automatic", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Log10", "[", "2.3", "]"}], ",", 
             RowBox[{"Log10", "[", "Nevmax", "]"}]}], "}"}]}], "}"}], ",", 
         RowBox[{"LegendMarkerSize", "\[Rule]", "340"}], ",", 
         RowBox[{"LegendLabel", "\[Rule]", 
          RowBox[{"Placed", "[", 
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(Log\), \
\(10\)]\)[\!\(\*SubscriptBox[\(N\), \(ev\)]\)]\>\"", ",", "Bottom"}], "]"}]}],
          ",", 
         RowBox[{"LabelStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"FontSize", "\[Rule]", "22"}], "}"}]}], ",", 
         RowBox[{"Method", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
            RowBox[{"AxesStyle", "\[Rule]", "None"}], ",", 
            RowBox[{"TicksStyle", "\[Rule]", "Black"}]}], "}"}]}]}], "]"}], 
       ",", "Right"}], "]"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{"{", "ExperimentFolder", "}"}], "]"}], ",", "20", ",", 
       "Black"}], "]"}]}]}], 
   RowBox[{"(*", 
    RowBox[{",", 
     RowBox[{"FrameTicks", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Automatic", ",", "Automatic"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"TicksPlotx", ",", "None"}], "}"}]}], "}"}]}]}], "*)"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<NeventsDensityPlotExample.pdf\>\""}], "}"}], "]"}], ",", "plot", 
     ",", 
     RowBox[{"\"\<AllowRasterization\>\"", "->", "False"}]}], "]"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.8929116398228235`*^9, 3.892911640819866*^9}, {
   3.8929117000725927`*^9, 3.8929117019883537`*^9}, {3.892912071098483*^9, 
   3.8929121392668476`*^9}, 3.892973399038414*^9, 3.893526212624839*^9, {
   3.893526322069903*^9, 3.8935263243906045`*^9}, {3.8937453741659374`*^9, 
   3.8937453762371025`*^9}, {3.895655470663905*^9, 3.8956555023701625`*^9}, {
   3.9054037163163233`*^9, 3.9054037397249928`*^9}},
 CellTags->{"Sensitivity", "Re-evaluation"},
 CellLabel->
  "In[464]:=",ExpressionUUID->"d4d65c7b-8dd1-4283-851a-4fc0b32dadbc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Sensitivity", "Section",
 CellChangeTimes->{{3.886565115214114*^9, 3.8865651186785173`*^9}},
 CellTags->{
  "Sensitivity", 
   "Re-evaluation"},ExpressionUUID->"20efcc73-93a4-4db0-b95c-2c9126c9e7ce"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SensitivityBlock", "[", 
   RowBox[{"Nev_", ",", "Npot_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RegSens", "=", 
      RowBox[{"RegionPlot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          FractionBox["Npot", "NpotDefault"], 
          RowBox[{"NevIntTot", "[", 
           RowBox[{
            SuperscriptBox["10", "mN"], ",", 
            SuperscriptBox["10", "U2"]}], "]"}]}], "\[GreaterEqual]", " ", 
         "Nev"}], ",", 
        RowBox[{"{", 
         RowBox[{"mN", ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"mNminMaxOverall", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"mNminMaxOverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"U2", ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"U2minmaxOverall", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"U2minmaxOverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SensTemp", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"Normal", "@", "RegSens"}], ",", 
        RowBox[{
         RowBox[{"Line", "[", "x_", "]"}], "\[RuleDelayed]", "x"}], ",", 
        "Infinity"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Sens", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"10", "^", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"10", "^", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], "&"}], "/@", 
         RowBox[{"SensTemp", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "SensTemp", "]"}], ",", "1"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", 
          "\"\<Sensitivity domains\>\"", ",", "\"\<HNLs\>\"", ",", 
          "ExperimentFolder", ",", 
          RowBox[{"ToString", "@", 
           RowBox[{"StringForm", "[", 
            RowBox[{
            "\"\<Sensitivity_HNL_MixingPattern_``-``-``_type_``_at_``_Nev=``_\
Npot=``.xls\>\"", ",", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"SelectedMixingPattern", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "//", "ToString"}], ",", 
                RowBox[{
                 RowBox[{"SelectedMixingPattern", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "//", "ToString"}], ",", 
                RowBox[{
                 RowBox[{"SelectedMixingPattern", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "//", "ToString"}], ",", 
                "SelectedHNLtype", ",", "ExperimentFolder", ",", 
                RowBox[{"Nev", "//", "ToString"}], ",", 
                RowBox[{
                 RowBox[{"Npot", "//", "CForm"}], "//", "ToString"}]}], 
               "}"}]}]}], "]"}]}]}], "}"}], "]"}], ",", "Sens"}], "]"}], ";", 
     "\[IndentingNewLine]", "Sens"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"U2seesaw", "[", "mN_", "]"}], "=", 
   FractionBox[
    RowBox[{"5", "*", 
     SuperscriptBox["10", 
      RowBox[{"-", "11"}]]}], "mN"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<The minimal number of events \!\(\*SubscriptBox[\(N\), \(events, \
min\)]\) for which the sensitivity will be computed:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"NevMinVal", "=", 
  RowBox[{
   RowBox[{"DialogInput", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nev", "=", "2.3"}], "}"}], ",", 
     RowBox[{"Column", "[", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Enter the value of \!\(\*SubscriptBox[\(N\), \(events, min\)]\) \
for which the sensitivity will be computed:\>\"", ",", 
        RowBox[{"InputField", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "nev", "]"}], ",", "Expression"}], "]"}], 
        ",", 
        RowBox[{"Button", "[", 
         RowBox[{"\"\<Proceed\>\"", ",", 
          RowBox[{"DialogReturn", "[", "nev", "]"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Automatic"}]}], "]"}]}], "}"}], 
      "]"}]}], "]"}], "//", "N"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<\!\(\*SubscriptBox[\(N\), \(p\\\ \(\(collisions\)\(:\)\)\)]\)\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NpotDefault", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"DialogInput", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"br", "=", "NpotDefault"}], "}"}], ",", 
       RowBox[{"Column", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<Enter the number of proton collisions\>\"", ",", 
          RowBox[{"InputField", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", "br", "]"}], ",", "Expression"}], "]"}], 
          ",", 
          RowBox[{"Button", "[", 
           RowBox[{"\"\<Proceed\>\"", ",", 
            RowBox[{"DialogReturn", "[", "br", "]"}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "Automatic"}]}], "]"}]}], "}"}], 
        "]"}]}], "]"}], "//", "ToExpression"}], "//", "N"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sens", "=", 
   RowBox[{"SensitivityBlock", "[", 
    RowBox[{"NevMinVal", ",", "NpotDefault"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListLogLogPlot", "[", 
    RowBox[{
     RowBox[{"Cases", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"sens", ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"mN", ",", 
             RowBox[{"U2seesaw", "[", "mN", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"mN", ",", 
             RowBox[{"1.01", 
              RowBox[{"mNminMaxOverall", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"1.1", 
              RowBox[{"mNminMaxOverall", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             FractionBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"1.1", 
                 RowBox[{"mNminMaxOverall", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "-", 
                RowBox[{"1.01", 
                 RowBox[{"mNminMaxOverall", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}], "50"]}], "}"}]}],
           "]"}]}], "}"}], ",", 
       RowBox[{"_", "?", "MatrixQ"}], ",", "All"}], "]"}], ",", 
     RowBox[{"Joined", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"True", ",", "True", ",", "True", ",", "True"}], "}"}]}], ",", 
     " ", 
     RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(m\), \(N\)]\) [GeV]\>\"", " ", ",", " ", 
        "\"\<\!\(\*SuperscriptBox[\(U\), \(2\)]\)\>\""}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", " ", "23"}], "]"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ConstantArray", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MatrixQ", "[", "sens", "]"}], ",", "1", ",", 
              RowBox[{"Length", "@", "sens"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Thick", ",", "Gray"}], "}"}], ",", "1"}], "]"}]}], 
         "}"}], ",", "1"}], "]"}]}], ",", 
     RowBox[{"Filling", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "sens", "]"}], "+", "1"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Bottom", ",", 
          RowBox[{"Directive", "[", 
           RowBox[{"Gray", ",", 
            RowBox[{"Opacity", "[", "0.3", "]"}]}], "]"}]}], "}"}]}], "}"}]}],
      ",", "\[IndentingNewLine]", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1.01", 
           RowBox[{"mNminMaxOverall", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"1.1", 
           RowBox[{"mNminMaxOverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"0.3", 
           RowBox[{"U2minmaxOverall", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"0.99", 
           RowBox[{"U2minmaxOverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{
          "\"\<\!\(\*SubscriptBox[\(N\), \(events\)]\) \[GreaterEqual] \>\"", 
           ",", "NevMinVal", ",", "\"\<, mixing pattern = \>\"", ",", 
           RowBox[{"SelectedMixingPattern", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<, \>\"", ",", 
           RowBox[{"SelectedMixingPattern", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<, \>\"", ",", 
           RowBox[{"SelectedMixingPattern", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "]"}], ",", "18", ",", 
        "Black"}], "]"}]}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"Placed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"#", ",", "15"}], "]"}], "&"}], "/@", 
         RowBox[{"{", "ExperimentFolder", "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"0.2", ",", "0.15"}], "}"}]}], "]"}]}]}], "]"}], ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{"Text", "[", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"\"\<Seesaw\>\"", ",", "24", ",", "Black"}], "]"}], ",", 
       RowBox[{"Scaled", "[", 
        RowBox[{"{", 
         RowBox[{"0.5", ",", "0.07"}], "}"}], "]"}]}], "]"}], "}"}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8860950920688515`*^9, 3.8860954655276003`*^9}, {
   3.8861280395485344`*^9, 3.8861280410019855`*^9}, {3.88647972392144*^9, 
   3.886479725273675*^9}, {3.8864797950477133`*^9, 3.8864798018553343`*^9}, {
   3.886480035786476*^9, 3.886480036285406*^9}, {3.8872798675785656`*^9, 
   3.887279880334217*^9}, {3.8888989631474533`*^9, 3.8888990272328596`*^9}, {
   3.888899100854557*^9, 3.8888992662273664`*^9}, {3.8888993007840223`*^9, 
   3.8888993747054234`*^9}, {3.8929116851550765`*^9, 
   3.8929116860606117`*^9}, {3.8929118044484444`*^9, 3.892911804586389*^9}, {
   3.892973424485577*^9, 3.8929735062457585`*^9}, {3.8932595324898405`*^9, 
   3.893259534538739*^9}, {3.893259583943966*^9, 3.89325958408368*^9}, {
   3.8935262192412004`*^9, 3.893526224783012*^9}, {3.893526341108305*^9, 
   3.8935263546094613`*^9}, 3.893526506817713*^9, {3.8950542442741404`*^9, 
   3.895054256837692*^9}, {3.895054513146216*^9, 3.8950545421752167`*^9}, {
   3.8950546520795608`*^9, 3.895054655945615*^9}, 3.895077817943701*^9, {
   3.8950797227800293`*^9, 3.8950797229338818`*^9}, {3.895655520488201*^9, 
   3.8956555290039434`*^9}, {3.8956555648841257`*^9, 
   3.8956556165140133`*^9}, {3.896154836152176*^9, 3.8961548370156183`*^9}, {
   3.896154885845129*^9, 3.89615489312577*^9}, {3.9049027863166275`*^9, 
   3.9049027864672694`*^9}, {3.9061852726254454`*^9, 3.9061853032943134`*^9}, 
   3.906185698355516*^9, {3.906196630429819*^9, 3.906196631035243*^9}},
 CellTags->{"Sensitivity", "Re-evaluation"},
 CellLabel->
  "In[474]:=",ExpressionUUID->"e7b460ff-2c3e-428c-a2d0-619da649c9fd"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Deleting generated cells", "Title",
 CellChangeTimes->{{3.9025559465149946`*^9, 3.9025559494966087`*^9}},
 CellTags->{
  "Sensitivity", 
   "Re-evaluation"},ExpressionUUID->"03eaf80f-3fae-43b9-a3eb-4335a406e99e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"relaunch", "=", 
  RowBox[{"dropdownDialog", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\"\<Yes\>\"", ",", "\"\<No\>\""}], "}"}], ",", 
    RowBox[{"Row", "[", 
     RowBox[{
     "{", "\"\<Would you like to re-launch the sensitivity calculation for \
another experiment after the given computation?\>\"", "}"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"relaunch", "==", "\"\<Yes\>\""}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nb", "=", 
     RowBox[{"EvaluationNotebook", "[", "]"}]}], ";", "\n", 
    RowBox[{"NotebookFind", "[", 
     RowBox[{
     "nb", ",", "\"\<Re-evaluation\>\"", ",", "All", ",", "CellTags"}], "]"}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"relaunch", "==", "\"\<No\>\""}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"deletecellsopt", "=", 
     RowBox[{"dropdownDialog", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<Yes\>\"", ",", "\"\<No\>\""}], "}"}], ",", 
       RowBox[{"Row", "[", 
        RowBox[{
        "{", "\"\<Would you like to remove all the generated output \
cells?\>\"", "}"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"deletecellsopt", "==", "\"\<Yes\>\""}], ",", 
      RowBox[{
      "FrontEndTokenExecute", "[", "\"\<DeleteGeneratedCells\>\"", "]"}]}], 
     "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.9025559062888603`*^9, 3.9025559062888603`*^9}, {
   3.902555964086707*^9, 3.902555989355214*^9}, {3.9027292861725445`*^9, 
   3.9027292863536406`*^9}, {3.902729355782529*^9, 3.902729362414282*^9}, {
   3.9028515224589033`*^9, 3.902851539338553*^9}, 3.903972016103257*^9},
 CellTags->{"Sensitivity", "Re-evaluation"},
 CellLabel->
  "In[222]:=",ExpressionUUID->"7d10b700-1bba-4e06-966c-f839d4e7cb52"]
}, Open  ]]
},
WindowSize->{1142.1, 570.9},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
ShowCellTags->True,
Magnification:>0.8 Inherited,
FrontEndVersion->"13.2 for Microsoft Windows (64-bit) (November 18, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"4eb3f58a-f794-4bd8-8522-5a7ff6709a44"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Number-of-events"->{
  Cell[5619, 156, 311, 5, 69, "Title",ExpressionUUID->"f64b31a6-3a21-452a-9085-9eaa0b5708aa",
   CellTags->"Number-of-events"],
  Cell[5955, 165, 259, 4, 66, "Chapter",ExpressionUUID->"6048c214-b0a8-4591-8c9d-abf34243f3be",
   CellTags->"Number-of-events"],
  Cell[6217, 171, 10538, 263, 1086, "Input",ExpressionUUID->"38e841c8-a539-4bae-bc89-9632f0a3f574",
   CellTags->"Number-of-events"],
  Cell[16792, 439, 389, 6, 66, "Chapter",ExpressionUUID->"623267a1-9c4d-426c-8448-961507b9c3b3",
   CellTags->"Number-of-events"],
  Cell[17206, 449, 775, 22, 67, "Section",ExpressionUUID->"a3928977-6d58-457e-92d7-05fa35ba6218",
   CellTags->"Number-of-events"],
  Cell[18006, 475, 313, 5, 54, "Subsection",ExpressionUUID->"3650f247-0ba0-474b-b25c-39864d460945",
   CellTags->"Number-of-events"],
  Cell[18322, 482, 4331, 117, 236, "Input",ExpressionUUID->"a0a33917-1099-4d1d-b550-a1cb1664f85f",
   CellTags->"Number-of-events"],
  Cell[22690, 604, 183, 3, 54, "Subsection",ExpressionUUID->"d8ddf444-d95a-4ab3-b525-cb9a8e69acb7",
   CellTags->"Number-of-events"],
  Cell[22876, 609, 5168, 135, 221, "Input",ExpressionUUID->"39cded67-891f-477d-801c-c00836f0df24",
   CellTags->"Number-of-events"],
  Cell[28315, 755, 290, 4, 54, "Subsection",ExpressionUUID->"495f4d30-e5dc-4aba-8ea6-6dd1fa27212c",
   CellTags->"Number-of-events"],
  Cell[28608, 761, 4196, 113, 299, "Input",ExpressionUUID->"4f48ed3e-9b7d-45f9-a5cb-600b0ec25dad",
   CellTags->"Number-of-events"],
  Cell[32841, 879, 314, 5, 54, "Subsection",ExpressionUUID->"50717c52-c64e-43ba-aba3-c4301b76b291",
   CellTags->"Number-of-events"],
  Cell[33158, 886, 4547, 119, 220, "Input",ExpressionUUID->"6e1b1600-9a6f-4f8c-86a5-6e16656eb692",
   CellTags->"Number-of-events"],
  Cell[37754, 1011, 570, 13, 66, "Section",ExpressionUUID->"c587ef57-16b6-410f-a7a6-2ea564b37756",
   CellTags->"Number-of-events"],
  Cell[38349, 1028, 190, 3, 54, "Subsection",ExpressionUUID->"226b3093-ec84-41d5-8009-504c31660c8d",
   CellTags->"Number-of-events"],
  Cell[38542, 1033, 6152, 161, 307, "Input",ExpressionUUID->"db96dfef-92e7-4fcf-a73f-421145b7126f",
   CellTags->"Number-of-events"],
  Cell[44743, 1200, 382, 6, 64, "Section",ExpressionUUID->"91fe10d5-b562-40de-b219-55be5523f3e0",
   CellTags->"Number-of-events"],
  Cell[45128, 1208, 6098, 157, 306, "Input",ExpressionUUID->"2b71c445-b980-4930-acc8-25ee449aaab3",
   CellTags->"Number-of-events"],
  Cell[51263, 1370, 191, 3, 64, "Section",ExpressionUUID->"72e7f531-a92e-4ae3-ab1f-4f4c51dce7c3",
   CellTags->"Number-of-events"],
  Cell[51457, 1375, 10713, 287, 251, "Input",ExpressionUUID->"4aac5d21-8162-4c0e-9325-f06b4ee86be8",
   CellTags->"Number-of-events"],
  Cell[62219, 1668, 459, 13, 65, "Chapter",ExpressionUUID->"60a54273-5d77-45a3-902e-f9d9518fcef5",
   CellTags->"Number-of-events"],
  Cell[62681, 1683, 5943, 140, 102, "Input",ExpressionUUID->"8ce29ddb-125d-4cc8-b503-8b6d70a0d9d3",
   CellTags->"Number-of-events"],
  Cell[68661, 1828, 245, 5, 66, "Chapter",ExpressionUUID->"23566021-74ee-425f-bef4-d18db859e808",
   CellTags->"Number-of-events"],
  Cell[68931, 1837, 239, 4, 54, "Subsection",ExpressionUUID->"c1e82f8a-85f0-4536-8e85-0e0dcad7fdd1",
   CellTags->"Number-of-events"],
  Cell[69173, 1843, 7659, 184, 234, "Input",ExpressionUUID->"7aebc60c-e948-4b7f-8ca6-b5d1d7138b67",
   CellTags->"Number-of-events"],
  Cell[76869, 2032, 240, 4, 54, "Subsection",ExpressionUUID->"a79e9cb4-42ab-4573-ba44-bc65fae822e7",
   CellTags->"Number-of-events"],
  Cell[77112, 2038, 7512, 182, 234, "Input",ExpressionUUID->"af32635a-daf1-4cf6-908b-07263d4288f5",
   CellTags->"Number-of-events"],
  Cell[84685, 2227, 262, 4, 69, "Title",ExpressionUUID->"6aee5356-b39c-45f1-83d9-c276143eb260",
   CellTags->"Number-of-events"],
  Cell[84972, 2235, 178, 3, 66, "Chapter",ExpressionUUID->"5b02137e-da6c-4b5c-af74-2eb5ac2b44ac",
   CellTags->"Number-of-events"],
  Cell[85153, 2240, 4033, 111, 264, "Input",ExpressionUUID->"43688868-e9bd-4ecd-99df-1169d9e58d62",
   CellTags->"Number-of-events"],
  Cell[89223, 2356, 189, 3, 66, "Chapter",ExpressionUUID->"bf0d84bb-c61a-4372-9cdb-367edc141ad2",
   CellTags->"Number-of-events"],
  Cell[89415, 2361, 10661, 257, 539, "Input",ExpressionUUID->"393e1e21-5cde-41a9-ad41-077747a91d52",
   CellTags->"Number-of-events"],
  Cell[100113, 2623, 204, 3, 66, "Chapter",ExpressionUUID->"e0515968-6d3b-4786-9380-8f6efe4a3b24",
   CellTags->"Number-of-events"],
  Cell[100320, 2628, 1947, 48, 248, "Input",ExpressionUUID->"977ebf96-c528-46df-9e58-09288035e8b1",
   CellTags->"Number-of-events"]},
 "Number-of-events-computation"->{
  Cell[102316, 2682, 204, 4, 89, "Title",ExpressionUUID->"7ba28ec5-2133-49aa-b270-328c555fa667",
   CellTags->"Number-of-events-computation"],
  Cell[102545, 2690, 399, 7, 66, "Chapter",ExpressionUUID->"7bea3ddf-2062-4996-86eb-43158cd187b5",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[102969, 2701, 241, 5, 66, "Section",ExpressionUUID->"33c6f4da-aa46-4293-b09c-5bf1476c4879",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[103213, 2708, 14479, 387, 521, "Input",ExpressionUUID->"e03f9bc7-6459-479a-ba16-970233bed763",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[120201, 3136, 305, 6, 66, "Section",ExpressionUUID->"4df1b4f3-a8c2-4a94-a2ad-f3dee43536c2",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[120531, 3146, 236, 5, 54, "Subsection",ExpressionUUID->"92d4e288-d0dd-4f6d-83fd-d1e7ba70c173",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[120770, 3153, 5482, 149, 142, "Input",ExpressionUUID->"fd8fa112-ff83-46c7-8706-1b78711e430d",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[126289, 3307, 255, 5, 54, "Subsection",ExpressionUUID->"af668fbc-e22d-4e0b-911e-f57f149e2428",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[126547, 3314, 15075, 365, 604, "Input",ExpressionUUID->"d9a1f761-9bdf-4507-8e27-ee1a512a1916",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[141683, 3686, 433, 9, 66, "Chapter",ExpressionUUID->"ca43363e-b0ad-42a8-bb80-42168c339006",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[142141, 3699, 267, 6, 66, "Section",ExpressionUUID->"d974a6c9-acdd-4497-9845-1bd5a79901ed",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[142433, 3709, 269, 5, 54, "Subsection",ExpressionUUID->"a36175a0-adde-42a3-9bf4-632241e06c09",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[142705, 3716, 8734, 209, 446, "Input",ExpressionUUID->"b068ca92-2674-4751-8f55-4363acad7092",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[151476, 3930, 248, 5, 54, "Subsection",ExpressionUUID->"bd4ad4f3-480f-4867-9984-e96650999170",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[151727, 3937, 23906, 609, 770, "Input",ExpressionUUID->"fbe8b7bf-d0b6-401f-acf4-5f426aaeac09",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[175670, 4551, 395, 9, 54, "Subsection",ExpressionUUID->"d8835fc8-fd3c-42a3-a79a-7741688b0bea",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[176068, 4562, 31120, 732, 1206, "Input",ExpressionUUID->"15f6e902-7ccc-403a-bb8a-6e270ab16116",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[207225, 5299, 347, 8, 54, "Subsection",ExpressionUUID->"b4a9a411-6bcb-46f2-adba-eeabc7aacbca",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[207575, 5309, 18308, 474, 712, "Input",ExpressionUUID->"7a13b4b5-40c4-4453-adef-7b2abbd3a149",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[225944, 5790, 206, 4, 66, "Chapter",ExpressionUUID->"5fbb4af8-dafa-4fc1-a941-3c9daaf61f32",
   CellTags->"Number-of-events-computation"],
  Cell[226175, 5798, 233, 5, 66, "Section",ExpressionUUID->"45f096be-93cf-4e54-a28a-00e98e01b159",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[226433, 5807, 291, 7, 54, "Subsection",ExpressionUUID->"c4d18ce7-1929-4268-a3ee-cf2b7713f9a9",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[226727, 5816, 7837, 203, 310, "Input",ExpressionUUID->"362947e6-0af8-4fba-8ad4-008d1861456a",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[234601, 6024, 276, 5, 54, "Subsection",ExpressionUUID->"dcb44a18-3337-4468-b94c-ee43b8a5f39f",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[234880, 6031, 8799, 226, 328, "Input",ExpressionUUID->"f304f3ae-7673-42f0-8d21-f2dc640445b1",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[243716, 6262, 351, 8, 54, "Subsection",ExpressionUUID->"6491e7e8-2b47-409d-8dc5-04c3c61be598",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[244092, 6274, 266, 5, 47, "Subsubsection",ExpressionUUID->"04edeee7-d473-4910-931e-5114eeb1b1e5",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[244361, 6281, 6614, 164, 287, "Input",ExpressionUUID->"6c3d2756-cd43-4d3a-8d20-6edcabc2f4d0",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[251012, 6450, 320, 6, 47, "Subsubsection",ExpressionUUID->"31b8b541-df2e-455f-b136-ead82cb8c48c",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[251335, 6458, 6068, 143, 300, "Input",ExpressionUUID->"ce57dd68-88a2-4cc8-893d-5ea3f66ad10f",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[257440, 6606, 267, 6, 47, "Subsubsection",ExpressionUUID->"9e99525b-3954-43c0-b2e5-6e0e571aabe0",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[257710, 6614, 3526, 79, 247, "Input",ExpressionUUID->"d1b47169-8d0d-476a-988c-68cf11ceb917",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[261297, 6700, 333, 6, 66, "Section",ExpressionUUID->"4c15ac19-2b32-497c-9efb-3dbe6240cb77",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[261633, 6708, 15528, 402, 547, "Input",ExpressionUUID->"f3fe450d-f3e5-4dcf-a461-3b60f738e10a",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[277186, 7114, 272, 5, 54, "Subsection",ExpressionUUID->"5d40a47f-a3f4-4c55-bfdd-de6659311dff",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[277483, 7123, 237, 5, 47, "Subsubsection",ExpressionUUID->"4620d5c6-4ba4-4160-a53a-2e1ec6d66d3c",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[277723, 7130, 3579, 93, 203, "Input",ExpressionUUID->"e0cd2be1-c14d-4ab5-9f48-84d9da50a0e2",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[281363, 7230, 206, 4, 66, "Section",ExpressionUUID->"52ce57d0-f982-4567-bb71-be778a9c5b79",
   CellTags->"Number-of-events-computation"],
  Cell[281594, 7238, 264, 5, 54, "Subsection",ExpressionUUID->"5c76bc0a-1db7-4811-bd32-c85fe14817d5",
   CellTags->"Number-of-events-computation"],
  Cell[281861, 7245, 4443, 111, 203, "Input",ExpressionUUID->"1da0870e-6f30-475c-a37c-399f53a2446c",
   CellTags->"Number-of-events-computation"],
  Cell[286341, 7361, 344, 8, 54, "Subsection",ExpressionUUID->"291df21e-e39d-48d1-9816-af096ec7783f",
   CellTags->"Number-of-events-computation"],
  Cell[286688, 7371, 3560, 94, 161, "Input",ExpressionUUID->"eb7ffb3d-8072-4807-a3e0-dabda50d141b",
   CellTags->"Number-of-events-computation"],
  Cell[290273, 7469, 202, 4, 47, "Subsubsection",ExpressionUUID->"b08eb9e9-1d17-4be6-b837-6727be6144e5",
   CellTags->"Number-of-events-computation"],
  Cell[290478, 7475, 7322, 188, 234, "Input",ExpressionUUID->"f91d634e-d2ea-4f8a-ad54-213b450a81a5",
   CellTags->"Number-of-events-computation"],
  Cell[297849, 7669, 220, 4, 54, "Subsection",ExpressionUUID->"81f7b327-4279-40bc-bdd8-0cdc2e2facd4",
   CellTags->"Number-of-events-computation"],
  Cell[298072, 7675, 21703, 534, 849, "Input",ExpressionUUID->"cb90c87c-f03c-424d-b49a-66ae1ce879f0",
   CellTags->"Number-of-events-computation"],
  Cell[319848, 8217, 224, 4, 69, "Title",ExpressionUUID->"d9cc7f48-090a-4576-84bf-78e61b4f24e1",
   CellTags->"Number-of-events-computation"],
  Cell[320097, 8225, 201, 4, 66, "Chapter",ExpressionUUID->"2954a636-16b9-43d9-baa5-a2a8079c668c",
   CellTags->"Number-of-events-computation"],
  Cell[320301, 8231, 6647, 175, 295, "Input",ExpressionUUID->"8c0b6592-284c-4a87-9a77-8e50d3c85c08",
   CellTags->"Number-of-events-computation"],
  Cell[326985, 8411, 197, 4, 66, "Chapter",ExpressionUUID->"94264685-3bea-4e26-b629-98b9c56f1aa5",
   CellTags->"Number-of-events-computation"],
  Cell[327207, 8419, 209, 4, 66, "Section",ExpressionUUID->"ba8c2bda-9c02-4d57-8be1-d67e61121d9a",
   CellTags->"Number-of-events-computation"],
  Cell[327419, 8425, 3057, 70, 126, "Input",ExpressionUUID->"d8897b55-8608-4f93-a9b8-e4eb10318129",
   CellTags->"Number-of-events-computation"],
  Cell[330513, 8500, 249, 5, 66, "Section",ExpressionUUID->"c0d31812-e00d-4f07-8293-1a2985ebd0ed",
   CellTags->"Number-of-events-computation"],
  Cell[330765, 8507, 474, 10, 33, "Input",ExpressionUUID->"4dbf3bc6-33af-451e-9e90-dfa042f12c15",
   CellTags->"Number-of-events-computation"],
  Cell[331242, 8519, 368, 6, 33, "Input",ExpressionUUID->"64b03c95-e5ba-4d59-a325-de40f88ffd0e",
   CellTags->"Number-of-events-computation"],
  Cell[331647, 8530, 198, 4, 66, "Section",ExpressionUUID->"ab70e0c0-a2f2-4eda-ae9d-8733577337f0",
   CellTags->"Number-of-events-computation"],
  Cell[331848, 8536, 426, 10, 33, "Input",ExpressionUUID->"b7212a65-e9fa-485c-922e-58b2c7ab5f0e",
   CellTags->"Number-of-events-computation"],
  Cell[332277, 8548, 368, 6, 33, "Input",ExpressionUUID->"2455d9a1-174c-4f5d-b466-4c48245a7c0c",
   CellTags->"Number-of-events-computation"],
  Cell[332682, 8559, 251, 5, 66, "Section",ExpressionUUID->"a62c93fe-2498-41f7-bb06-1c80acdee202",
   CellTags->"Number-of-events-computation"],
  Cell[332936, 8566, 503, 11, 33, "Input",ExpressionUUID->"5e2c5cda-f94a-4ec8-a372-3af4d38a8085",
   CellTags->"Number-of-events-computation"],
  Cell[333476, 8582, 198, 4, 66, "Section",ExpressionUUID->"a9d83eda-ea97-4796-bd70-3bedf791cd78",
   CellTags->"Number-of-events-computation"],
  Cell[333677, 8588, 531, 11, 33, "Input",ExpressionUUID->"038c749c-3e35-42b3-8907-6059aa02feeb",
   CellTags->"Number-of-events-computation"]},
 "Acceptance-computation"->{
  Cell[102545, 2690, 399, 7, 66, "Chapter",ExpressionUUID->"7bea3ddf-2062-4996-86eb-43158cd187b5",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[102969, 2701, 241, 5, 66, "Section",ExpressionUUID->"33c6f4da-aa46-4293-b09c-5bf1476c4879",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[103213, 2708, 14479, 387, 521, "Input",ExpressionUUID->"e03f9bc7-6459-479a-ba16-970233bed763",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[120201, 3136, 305, 6, 66, "Section",ExpressionUUID->"4df1b4f3-a8c2-4a94-a2ad-f3dee43536c2",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[120531, 3146, 236, 5, 54, "Subsection",ExpressionUUID->"92d4e288-d0dd-4f6d-83fd-d1e7ba70c173",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[120770, 3153, 5482, 149, 142, "Input",ExpressionUUID->"fd8fa112-ff83-46c7-8706-1b78711e430d",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[126289, 3307, 255, 5, 54, "Subsection",ExpressionUUID->"af668fbc-e22d-4e0b-911e-f57f149e2428",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[126547, 3314, 15075, 365, 604, "Input",ExpressionUUID->"d9a1f761-9bdf-4507-8e27-ee1a512a1916",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[141683, 3686, 433, 9, 66, "Chapter",ExpressionUUID->"ca43363e-b0ad-42a8-bb80-42168c339006",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[142141, 3699, 267, 6, 66, "Section",ExpressionUUID->"d974a6c9-acdd-4497-9845-1bd5a79901ed",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[142433, 3709, 269, 5, 54, "Subsection",ExpressionUUID->"a36175a0-adde-42a3-9bf4-632241e06c09",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[142705, 3716, 8734, 209, 446, "Input",ExpressionUUID->"b068ca92-2674-4751-8f55-4363acad7092",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[151476, 3930, 248, 5, 54, "Subsection",ExpressionUUID->"bd4ad4f3-480f-4867-9984-e96650999170",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[151727, 3937, 23906, 609, 770, "Input",ExpressionUUID->"fbe8b7bf-d0b6-401f-acf4-5f426aaeac09",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[175670, 4551, 395, 9, 54, "Subsection",ExpressionUUID->"d8835fc8-fd3c-42a3-a79a-7741688b0bea",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[176068, 4562, 31120, 732, 1206, "Input",ExpressionUUID->"15f6e902-7ccc-403a-bb8a-6e270ab16116",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[207225, 5299, 347, 8, 54, "Subsection",ExpressionUUID->"b4a9a411-6bcb-46f2-adba-eeabc7aacbca",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[207575, 5309, 18308, 474, 712, "Input",ExpressionUUID->"7a13b4b5-40c4-4453-adef-7b2abbd3a149",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[226175, 5798, 233, 5, 66, "Section",ExpressionUUID->"45f096be-93cf-4e54-a28a-00e98e01b159",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[226433, 5807, 291, 7, 54, "Subsection",ExpressionUUID->"c4d18ce7-1929-4268-a3ee-cf2b7713f9a9",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[226727, 5816, 7837, 203, 310, "Input",ExpressionUUID->"362947e6-0af8-4fba-8ad4-008d1861456a",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[234601, 6024, 276, 5, 54, "Subsection",ExpressionUUID->"dcb44a18-3337-4468-b94c-ee43b8a5f39f",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[234880, 6031, 8799, 226, 328, "Input",ExpressionUUID->"f304f3ae-7673-42f0-8d21-f2dc640445b1",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[243716, 6262, 351, 8, 54, "Subsection",ExpressionUUID->"6491e7e8-2b47-409d-8dc5-04c3c61be598",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[244092, 6274, 266, 5, 47, "Subsubsection",ExpressionUUID->"04edeee7-d473-4910-931e-5114eeb1b1e5",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[244361, 6281, 6614, 164, 287, "Input",ExpressionUUID->"6c3d2756-cd43-4d3a-8d20-6edcabc2f4d0",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[251012, 6450, 320, 6, 47, "Subsubsection",ExpressionUUID->"31b8b541-df2e-455f-b136-ead82cb8c48c",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[251335, 6458, 6068, 143, 300, "Input",ExpressionUUID->"ce57dd68-88a2-4cc8-893d-5ea3f66ad10f",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[257440, 6606, 267, 6, 47, "Subsubsection",ExpressionUUID->"9e99525b-3954-43c0-b2e5-6e0e571aabe0",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[257710, 6614, 3526, 79, 247, "Input",ExpressionUUID->"d1b47169-8d0d-476a-988c-68cf11ceb917",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[261297, 6700, 333, 6, 66, "Section",ExpressionUUID->"4c15ac19-2b32-497c-9efb-3dbe6240cb77",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[261633, 6708, 15528, 402, 547, "Input",ExpressionUUID->"f3fe450d-f3e5-4dcf-a461-3b60f738e10a",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[277186, 7114, 272, 5, 54, "Subsection",ExpressionUUID->"5d40a47f-a3f4-4c55-bfdd-de6659311dff",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[277483, 7123, 237, 5, 47, "Subsubsection",ExpressionUUID->"4620d5c6-4ba4-4160-a53a-2e1ec6d66d3c",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[277723, 7130, 3579, 93, 203, "Input",ExpressionUUID->"e0cd2be1-c14d-4ab5-9f48-84d9da50a0e2",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}]},
 "Sensitivity"->{
  Cell[334269, 8606, 212, 4, 89, "Title",ExpressionUUID->"02de58fe-c9d7-4ae0-8388-b0795f1824e0",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[334506, 8614, 383, 6, 66, "Chapter",ExpressionUUID->"ce0499a7-0458-4fca-8906-49450de0903c",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[334892, 8622, 12507, 315, 617, "Input",ExpressionUUID->"0f11c942-1cb1-4bab-9d05-80dde7ee4ac3",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[347436, 8942, 265, 5, 66, "Chapter",ExpressionUUID->"a3ac3b31-6511-446d-ae9f-1a8d23a31004",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[347726, 8951, 300, 5, 66, "Section",ExpressionUUID->"3e602227-00a3-4fb9-8b9d-550ce649b396",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[348029, 8958, 9108, 246, 258, "Input",ExpressionUUID->"b16e043c-492d-45d6-a73a-c48a6829d23f",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[357174, 9209, 357, 10, 66, "Section",ExpressionUUID->"39e6da3a-e227-483d-be39-0d9a1bce65bb",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[357534, 9221, 4698, 121, 147, "Input",ExpressionUUID->"d4d65c7b-8dd1-4283-851a-4fc0b32dadbc",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[362269, 9347, 205, 4, 66, "Section",ExpressionUUID->"20efcc73-93a4-4db0-b95c-2c9126c9e7ce",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[362477, 9353, 12397, 305, 543, "Input",ExpressionUUID->"e7b460ff-2c3e-428c-a2d0-619da649c9fd",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[374935, 9665, 218, 4, 89, "Title",ExpressionUUID->"03eaf80f-3fae-43b9-a3eb-4335a406e99e",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[375156, 9671, 2657, 66, 187, "Input",ExpressionUUID->"7d10b700-1bba-4e06-966c-f839d4e7cb52",
   CellTags->{"Sensitivity", "Re-evaluation"}]},
 "Re-evaluation"->{
  Cell[334269, 8606, 212, 4, 89, "Title",ExpressionUUID->"02de58fe-c9d7-4ae0-8388-b0795f1824e0",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[334506, 8614, 383, 6, 66, "Chapter",ExpressionUUID->"ce0499a7-0458-4fca-8906-49450de0903c",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[334892, 8622, 12507, 315, 617, "Input",ExpressionUUID->"0f11c942-1cb1-4bab-9d05-80dde7ee4ac3",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[347436, 8942, 265, 5, 66, "Chapter",ExpressionUUID->"a3ac3b31-6511-446d-ae9f-1a8d23a31004",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[347726, 8951, 300, 5, 66, "Section",ExpressionUUID->"3e602227-00a3-4fb9-8b9d-550ce649b396",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[348029, 8958, 9108, 246, 258, "Input",ExpressionUUID->"b16e043c-492d-45d6-a73a-c48a6829d23f",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[357174, 9209, 357, 10, 66, "Section",ExpressionUUID->"39e6da3a-e227-483d-be39-0d9a1bce65bb",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[357534, 9221, 4698, 121, 147, "Input",ExpressionUUID->"d4d65c7b-8dd1-4283-851a-4fc0b32dadbc",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[362269, 9347, 205, 4, 66, "Section",ExpressionUUID->"20efcc73-93a4-4db0-b95c-2c9126c9e7ce",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[362477, 9353, 12397, 305, 543, "Input",ExpressionUUID->"e7b460ff-2c3e-428c-a2d0-619da649c9fd",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[374935, 9665, 218, 4, 89, "Title",ExpressionUUID->"03eaf80f-3fae-43b9-a3eb-4335a406e99e",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[375156, 9671, 2657, 66, 187, "Input",ExpressionUUID->"7d10b700-1bba-4e06-966c-f839d4e7cb52",
   CellTags->{"Sensitivity", "Re-evaluation"}]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Number-of-events", 378336, 9755},
 {"Number-of-events-computation", 382897, 9824},
 {"Acceptance-computation", 392998, 9949},
 {"Sensitivity", 399159, 10020},
 {"Re-evaluation", 400952, 10045}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 207, 3, 78, "Title",ExpressionUUID->"3a6189ab-b48c-4865-a933-cc9614b95029"],
Cell[790, 27, 4792, 124, 297, "Input",ExpressionUUID->"67d16bcb-6808-46ec-ae03-72ce61d72bb8"]
}, Closed]],
Cell[CellGroupData[{
Cell[5619, 156, 311, 5, 69, "Title",ExpressionUUID->"f64b31a6-3a21-452a-9085-9eaa0b5708aa",
 CellTags->"Number-of-events"],
Cell[CellGroupData[{
Cell[5955, 165, 259, 4, 66, "Chapter",ExpressionUUID->"6048c214-b0a8-4591-8c9d-abf34243f3be",
 CellTags->"Number-of-events"],
Cell[6217, 171, 10538, 263, 1086, "Input",ExpressionUUID->"38e841c8-a539-4bae-bc89-9632f0a3f574",
 CellTags->"Number-of-events"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16792, 439, 389, 6, 66, "Chapter",ExpressionUUID->"623267a1-9c4d-426c-8448-961507b9c3b3",
 CellTags->"Number-of-events"],
Cell[CellGroupData[{
Cell[17206, 449, 775, 22, 67, "Section",ExpressionUUID->"a3928977-6d58-457e-92d7-05fa35ba6218",
 CellTags->"Number-of-events"],
Cell[CellGroupData[{
Cell[18006, 475, 313, 5, 54, "Subsection",ExpressionUUID->"3650f247-0ba0-474b-b25c-39864d460945",
 CellTags->"Number-of-events"],
Cell[18322, 482, 4331, 117, 236, "Input",ExpressionUUID->"a0a33917-1099-4d1d-b550-a1cb1664f85f",
 CellTags->"Number-of-events"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22690, 604, 183, 3, 54, "Subsection",ExpressionUUID->"d8ddf444-d95a-4ab3-b525-cb9a8e69acb7",
 CellTags->"Number-of-events"],
Cell[22876, 609, 5168, 135, 221, "Input",ExpressionUUID->"39cded67-891f-477d-801c-c00836f0df24",
 CellTags->"Number-of-events"],
Cell[28047, 746, 231, 4, 22, "Input",ExpressionUUID->"ab47fa6e-c5b9-4390-ad56-6d2e71b7397b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28315, 755, 290, 4, 54, "Subsection",ExpressionUUID->"495f4d30-e5dc-4aba-8ea6-6dd1fa27212c",
 CellTags->"Number-of-events"],
Cell[28608, 761, 4196, 113, 299, "Input",ExpressionUUID->"4f48ed3e-9b7d-45f9-a5cb-600b0ec25dad",
 CellTags->"Number-of-events"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32841, 879, 314, 5, 54, "Subsection",ExpressionUUID->"50717c52-c64e-43ba-aba3-c4301b76b291",
 CellTags->"Number-of-events"],
Cell[33158, 886, 4547, 119, 220, "Input",ExpressionUUID->"6e1b1600-9a6f-4f8c-86a5-6e16656eb692",
 CellTags->"Number-of-events"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[37754, 1011, 570, 13, 66, "Section",ExpressionUUID->"c587ef57-16b6-410f-a7a6-2ea564b37756",
 CellTags->"Number-of-events"],
Cell[CellGroupData[{
Cell[38349, 1028, 190, 3, 54, "Subsection",ExpressionUUID->"226b3093-ec84-41d5-8009-504c31660c8d",
 CellTags->"Number-of-events"],
Cell[38542, 1033, 6152, 161, 307, "Input",ExpressionUUID->"db96dfef-92e7-4fcf-a73f-421145b7126f",
 CellTags->"Number-of-events"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[44743, 1200, 382, 6, 64, "Section",ExpressionUUID->"91fe10d5-b562-40de-b219-55be5523f3e0",
 CellTags->"Number-of-events"],
Cell[45128, 1208, 6098, 157, 306, "Input",ExpressionUUID->"2b71c445-b980-4930-acc8-25ee449aaab3",
 CellTags->"Number-of-events"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51263, 1370, 191, 3, 64, "Section",ExpressionUUID->"72e7f531-a92e-4ae3-ab1f-4f4c51dce7c3",
 CellTags->"Number-of-events"],
Cell[51457, 1375, 10713, 287, 251, "Input",ExpressionUUID->"4aac5d21-8162-4c0e-9325-f06b4ee86be8",
 CellTags->"Number-of-events"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[62219, 1668, 459, 13, 65, "Chapter",ExpressionUUID->"60a54273-5d77-45a3-902e-f9d9518fcef5",
 CellTags->"Number-of-events"],
Cell[62681, 1683, 5943, 140, 102, "Input",ExpressionUUID->"8ce29ddb-125d-4cc8-b503-8b6d70a0d9d3",
 CellTags->"Number-of-events"]
}, Open  ]],
Cell[CellGroupData[{
Cell[68661, 1828, 245, 5, 66, "Chapter",ExpressionUUID->"23566021-74ee-425f-bef4-d18db859e808",
 CellTags->"Number-of-events"],
Cell[CellGroupData[{
Cell[68931, 1837, 239, 4, 54, "Subsection",ExpressionUUID->"c1e82f8a-85f0-4536-8e85-0e0dcad7fdd1",
 CellTags->"Number-of-events"],
Cell[69173, 1843, 7659, 184, 234, "Input",ExpressionUUID->"7aebc60c-e948-4b7f-8ca6-b5d1d7138b67",
 CellTags->"Number-of-events"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76869, 2032, 240, 4, 54, "Subsection",ExpressionUUID->"a79e9cb4-42ab-4573-ba44-bc65fae822e7",
 CellTags->"Number-of-events"],
Cell[77112, 2038, 7512, 182, 234, "Input",ExpressionUUID->"af32635a-daf1-4cf6-908b-07263d4288f5",
 CellTags->"Number-of-events"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[84685, 2227, 262, 4, 69, "Title",ExpressionUUID->"6aee5356-b39c-45f1-83d9-c276143eb260",
 CellTags->"Number-of-events"],
Cell[CellGroupData[{
Cell[84972, 2235, 178, 3, 66, "Chapter",ExpressionUUID->"5b02137e-da6c-4b5c-af74-2eb5ac2b44ac",
 CellTags->"Number-of-events"],
Cell[85153, 2240, 4033, 111, 264, "Input",ExpressionUUID->"43688868-e9bd-4ecd-99df-1169d9e58d62",
 CellTags->"Number-of-events"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89223, 2356, 189, 3, 66, "Chapter",ExpressionUUID->"bf0d84bb-c61a-4372-9cdb-367edc141ad2",
 CellTags->"Number-of-events"],
Cell[89415, 2361, 10661, 257, 539, "Input",ExpressionUUID->"393e1e21-5cde-41a9-ad41-077747a91d52",
 CellTags->"Number-of-events"]
}, Open  ]],
Cell[CellGroupData[{
Cell[100113, 2623, 204, 3, 66, "Chapter",ExpressionUUID->"e0515968-6d3b-4786-9380-8f6efe4a3b24",
 CellTags->"Number-of-events"],
Cell[100320, 2628, 1947, 48, 248, "Input",ExpressionUUID->"977ebf96-c528-46df-9e58-09288035e8b1",
 CellTags->"Number-of-events"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[102316, 2682, 204, 4, 89, "Title",ExpressionUUID->"7ba28ec5-2133-49aa-b270-328c555fa667",
 CellTags->"Number-of-events-computation"],
Cell[CellGroupData[{
Cell[102545, 2690, 399, 7, 66, "Chapter",ExpressionUUID->"7bea3ddf-2062-4996-86eb-43158cd187b5",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[102969, 2701, 241, 5, 66, "Section",ExpressionUUID->"33c6f4da-aa46-4293-b09c-5bf1476c4879",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[103213, 2708, 14479, 387, 521, "Input",ExpressionUUID->"e03f9bc7-6459-479a-ba16-970233bed763",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[117695, 3097, 2469, 34, 22, "Input",ExpressionUUID->"3ba53de7-f86a-4383-9147-a3c7461a6505"]
}, Open  ]],
Cell[CellGroupData[{
Cell[120201, 3136, 305, 6, 66, "Section",ExpressionUUID->"4df1b4f3-a8c2-4a94-a2ad-f3dee43536c2",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[120531, 3146, 236, 5, 54, "Subsection",ExpressionUUID->"92d4e288-d0dd-4f6d-83fd-d1e7ba70c173",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[120770, 3153, 5482, 149, 142, "Input",ExpressionUUID->"fd8fa112-ff83-46c7-8706-1b78711e430d",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[126289, 3307, 255, 5, 54, "Subsection",ExpressionUUID->"af668fbc-e22d-4e0b-911e-f57f149e2428",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[126547, 3314, 15075, 365, 604, "Input",ExpressionUUID->"d9a1f761-9bdf-4507-8e27-ee1a512a1916",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[141683, 3686, 433, 9, 66, "Chapter",ExpressionUUID->"ca43363e-b0ad-42a8-bb80-42168c339006",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[142141, 3699, 267, 6, 66, "Section",ExpressionUUID->"d974a6c9-acdd-4497-9845-1bd5a79901ed",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[142433, 3709, 269, 5, 54, "Subsection",ExpressionUUID->"a36175a0-adde-42a3-9bf4-632241e06c09",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[142705, 3716, 8734, 209, 446, "Input",ExpressionUUID->"b068ca92-2674-4751-8f55-4363acad7092",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[151476, 3930, 248, 5, 54, "Subsection",ExpressionUUID->"bd4ad4f3-480f-4867-9984-e96650999170",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[151727, 3937, 23906, 609, 770, "Input",ExpressionUUID->"fbe8b7bf-d0b6-401f-acf4-5f426aaeac09",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[175670, 4551, 395, 9, 54, "Subsection",ExpressionUUID->"d8835fc8-fd3c-42a3-a79a-7741688b0bea",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[176068, 4562, 31120, 732, 1206, "Input",ExpressionUUID->"15f6e902-7ccc-403a-bb8a-6e270ab16116",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[207225, 5299, 347, 8, 54, "Subsection",ExpressionUUID->"b4a9a411-6bcb-46f2-adba-eeabc7aacbca",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[207575, 5309, 18308, 474, 712, "Input",ExpressionUUID->"7a13b4b5-40c4-4453-adef-7b2abbd3a149",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[225944, 5790, 206, 4, 66, "Chapter",ExpressionUUID->"5fbb4af8-dafa-4fc1-a941-3c9daaf61f32",
 CellTags->"Number-of-events-computation"],
Cell[CellGroupData[{
Cell[226175, 5798, 233, 5, 66, "Section",ExpressionUUID->"45f096be-93cf-4e54-a28a-00e98e01b159",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[226433, 5807, 291, 7, 54, "Subsection",ExpressionUUID->"c4d18ce7-1929-4268-a3ee-cf2b7713f9a9",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[226727, 5816, 7837, 203, 310, "Input",ExpressionUUID->"362947e6-0af8-4fba-8ad4-008d1861456a",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[234601, 6024, 276, 5, 54, "Subsection",ExpressionUUID->"dcb44a18-3337-4468-b94c-ee43b8a5f39f",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[234880, 6031, 8799, 226, 328, "Input",ExpressionUUID->"f304f3ae-7673-42f0-8d21-f2dc640445b1",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[243716, 6262, 351, 8, 54, "Subsection",ExpressionUUID->"6491e7e8-2b47-409d-8dc5-04c3c61be598",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[244092, 6274, 266, 5, 47, "Subsubsection",ExpressionUUID->"04edeee7-d473-4910-931e-5114eeb1b1e5",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[244361, 6281, 6614, 164, 287, "Input",ExpressionUUID->"6c3d2756-cd43-4d3a-8d20-6edcabc2f4d0",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[251012, 6450, 320, 6, 47, "Subsubsection",ExpressionUUID->"31b8b541-df2e-455f-b136-ead82cb8c48c",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[251335, 6458, 6068, 143, 300, "Input",ExpressionUUID->"ce57dd68-88a2-4cc8-893d-5ea3f66ad10f",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[257440, 6606, 267, 6, 47, "Subsubsection",ExpressionUUID->"9e99525b-3954-43c0-b2e5-6e0e571aabe0",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[257710, 6614, 3526, 79, 247, "Input",ExpressionUUID->"d1b47169-8d0d-476a-988c-68cf11ceb917",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[261297, 6700, 333, 6, 66, "Section",ExpressionUUID->"4c15ac19-2b32-497c-9efb-3dbe6240cb77",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[261633, 6708, 15528, 402, 547, "Input",ExpressionUUID->"f3fe450d-f3e5-4dcf-a461-3b60f738e10a",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[277186, 7114, 272, 5, 54, "Subsection",ExpressionUUID->"5d40a47f-a3f4-4c55-bfdd-de6659311dff",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[277483, 7123, 237, 5, 47, "Subsubsection",ExpressionUUID->"4620d5c6-4ba4-4160-a53a-2e1ec6d66d3c",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[277723, 7130, 3579, 93, 203, "Input",ExpressionUUID->"e0cd2be1-c14d-4ab5-9f48-84d9da50a0e2",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[281363, 7230, 206, 4, 66, "Section",ExpressionUUID->"52ce57d0-f982-4567-bb71-be778a9c5b79",
 CellTags->"Number-of-events-computation"],
Cell[CellGroupData[{
Cell[281594, 7238, 264, 5, 54, "Subsection",ExpressionUUID->"5c76bc0a-1db7-4811-bd32-c85fe14817d5",
 CellTags->"Number-of-events-computation"],
Cell[281861, 7245, 4443, 111, 203, "Input",ExpressionUUID->"1da0870e-6f30-475c-a37c-399f53a2446c",
 CellTags->"Number-of-events-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[286341, 7361, 344, 8, 54, "Subsection",ExpressionUUID->"291df21e-e39d-48d1-9816-af096ec7783f",
 CellTags->"Number-of-events-computation"],
Cell[286688, 7371, 3560, 94, 161, "Input",ExpressionUUID->"eb7ffb3d-8072-4807-a3e0-dabda50d141b",
 CellTags->"Number-of-events-computation"],
Cell[CellGroupData[{
Cell[290273, 7469, 202, 4, 47, "Subsubsection",ExpressionUUID->"b08eb9e9-1d17-4be6-b837-6727be6144e5",
 CellTags->"Number-of-events-computation"],
Cell[290478, 7475, 7322, 188, 234, "Input",ExpressionUUID->"f91d634e-d2ea-4f8a-ad54-213b450a81a5",
 CellTags->"Number-of-events-computation"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[297849, 7669, 220, 4, 54, "Subsection",ExpressionUUID->"81f7b327-4279-40bc-bdd8-0cdc2e2facd4",
 CellTags->"Number-of-events-computation"],
Cell[298072, 7675, 21703, 534, 849, "Input",ExpressionUUID->"cb90c87c-f03c-424d-b49a-66ae1ce879f0",
 CellTags->"Number-of-events-computation"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[319848, 8217, 224, 4, 69, "Title",ExpressionUUID->"d9cc7f48-090a-4576-84bf-78e61b4f24e1",
 CellTags->"Number-of-events-computation"],
Cell[CellGroupData[{
Cell[320097, 8225, 201, 4, 66, "Chapter",ExpressionUUID->"2954a636-16b9-43d9-baa5-a2a8079c668c",
 CellTags->"Number-of-events-computation"],
Cell[320301, 8231, 6647, 175, 295, "Input",ExpressionUUID->"8c0b6592-284c-4a87-9a77-8e50d3c85c08",
 CellTags->"Number-of-events-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[326985, 8411, 197, 4, 66, "Chapter",ExpressionUUID->"94264685-3bea-4e26-b629-98b9c56f1aa5",
 CellTags->"Number-of-events-computation"],
Cell[CellGroupData[{
Cell[327207, 8419, 209, 4, 66, "Section",ExpressionUUID->"ba8c2bda-9c02-4d57-8be1-d67e61121d9a",
 CellTags->"Number-of-events-computation"],
Cell[327419, 8425, 3057, 70, 126, "Input",ExpressionUUID->"d8897b55-8608-4f93-a9b8-e4eb10318129",
 CellTags->"Number-of-events-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[330513, 8500, 249, 5, 66, "Section",ExpressionUUID->"c0d31812-e00d-4f07-8293-1a2985ebd0ed",
 CellTags->"Number-of-events-computation"],
Cell[330765, 8507, 474, 10, 33, "Input",ExpressionUUID->"4dbf3bc6-33af-451e-9e90-dfa042f12c15",
 CellTags->"Number-of-events-computation"],
Cell[331242, 8519, 368, 6, 33, "Input",ExpressionUUID->"64b03c95-e5ba-4d59-a325-de40f88ffd0e",
 CellTags->"Number-of-events-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[331647, 8530, 198, 4, 66, "Section",ExpressionUUID->"ab70e0c0-a2f2-4eda-ae9d-8733577337f0",
 CellTags->"Number-of-events-computation"],
Cell[331848, 8536, 426, 10, 33, "Input",ExpressionUUID->"b7212a65-e9fa-485c-922e-58b2c7ab5f0e",
 CellTags->"Number-of-events-computation"],
Cell[332277, 8548, 368, 6, 33, "Input",ExpressionUUID->"2455d9a1-174c-4f5d-b466-4c48245a7c0c",
 CellTags->"Number-of-events-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[332682, 8559, 251, 5, 66, "Section",ExpressionUUID->"a62c93fe-2498-41f7-bb06-1c80acdee202",
 CellTags->"Number-of-events-computation"],
Cell[332936, 8566, 503, 11, 33, "Input",ExpressionUUID->"5e2c5cda-f94a-4ec8-a372-3af4d38a8085",
 CellTags->"Number-of-events-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[333476, 8582, 198, 4, 66, "Section",ExpressionUUID->"a9d83eda-ea97-4796-bd70-3bedf791cd78",
 CellTags->"Number-of-events-computation"],
Cell[333677, 8588, 531, 11, 33, "Input",ExpressionUUID->"038c749c-3e35-42b3-8907-6059aa02feeb",
 CellTags->"Number-of-events-computation"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[334269, 8606, 212, 4, 89, "Title",ExpressionUUID->"02de58fe-c9d7-4ae0-8388-b0795f1824e0",
 CellTags->{"Sensitivity", "Re-evaluation"}],
Cell[CellGroupData[{
Cell[334506, 8614, 383, 6, 66, "Chapter",ExpressionUUID->"ce0499a7-0458-4fca-8906-49450de0903c",
 CellTags->{"Sensitivity", "Re-evaluation"}],
Cell[334892, 8622, 12507, 315, 617, "Input",ExpressionUUID->"0f11c942-1cb1-4bab-9d05-80dde7ee4ac3",
 CellTags->{"Sensitivity", "Re-evaluation"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[347436, 8942, 265, 5, 66, "Chapter",ExpressionUUID->"a3ac3b31-6511-446d-ae9f-1a8d23a31004",
 CellTags->{"Sensitivity", "Re-evaluation"}],
Cell[CellGroupData[{
Cell[347726, 8951, 300, 5, 66, "Section",ExpressionUUID->"3e602227-00a3-4fb9-8b9d-550ce649b396",
 CellTags->{"Sensitivity", "Re-evaluation"}],
Cell[348029, 8958, 9108, 246, 258, "Input",ExpressionUUID->"b16e043c-492d-45d6-a73a-c48a6829d23f",
 CellTags->{"Sensitivity", "Re-evaluation"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[357174, 9209, 357, 10, 66, "Section",ExpressionUUID->"39e6da3a-e227-483d-be39-0d9a1bce65bb",
 CellTags->{"Sensitivity", "Re-evaluation"}],
Cell[357534, 9221, 4698, 121, 147, "Input",ExpressionUUID->"d4d65c7b-8dd1-4283-851a-4fc0b32dadbc",
 CellTags->{"Sensitivity", "Re-evaluation"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[362269, 9347, 205, 4, 66, "Section",ExpressionUUID->"20efcc73-93a4-4db0-b95c-2c9126c9e7ce",
 CellTags->{"Sensitivity", "Re-evaluation"}],
Cell[362477, 9353, 12397, 305, 543, "Input",ExpressionUUID->"e7b460ff-2c3e-428c-a2d0-619da649c9fd",
 CellTags->{"Sensitivity", "Re-evaluation"}]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[374935, 9665, 218, 4, 89, "Title",ExpressionUUID->"03eaf80f-3fae-43b9-a3eb-4335a406e99e",
 CellTags->{"Sensitivity", "Re-evaluation"}],
Cell[375156, 9671, 2657, 66, 187, "Input",ExpressionUUID->"7d10b700-1bba-4e06-966c-f839d4e7cb52",
 CellTags->{"Sensitivity", "Re-evaluation"}]
}, Open  ]]
}
]
*)

