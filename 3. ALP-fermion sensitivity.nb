(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    276765,       6659]
NotebookOptionsPosition[    246969,       6209]
NotebookOutlinePosition[    264806,       6445]
CellTagsIndexPosition[    264502,       6435]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Just launch the code below to run the notebook (shift+enter)", "Title",
 CellChangeTimes->{{3.8934376452895875`*^9, 
  3.893437664450907*^9}},ExpressionUUID->"0839ea5b-1982-4dfb-8c5d-\
195bcd99f6e9"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ParallelEvaluate", "[", 
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BlockEvaluation", "[", "tag_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nb", "=", 
      RowBox[{"EvaluationNotebook", "[", "]"}]}], ";", "\n", 
     RowBox[{"NotebookFind", "[", 
      RowBox[{"nb", ",", "tag", ",", "All", ",", "CellTags"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CloseKernels", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LaunchKernels", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"infoDialog", "[", "phrase_", "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<Proceed\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DirectoryQ", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<Auxiliary data\>\""}], "}"}], "]"}], "]"}], "//", 
       "ToString"}], ")"}], "\[Equal]", "\"\<False\>\""}], ",", 
    RowBox[{"CreateDirectory", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<Auxiliary data\>\""}], "}"}], "]"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"choiceslist", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<Tabulated Nevents+sensitivity\>\"", ",", 
     "\"\<Sensitivity only (tabulated Nevents must be produced before)\>\"", 
     ",", "\"\<Acceptance\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"taglist", "[", "\"\<Acceptance\>\"", "]"}], "=", 
   "\"\<Acceptance\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"taglist", "[", "\"\<Tabulated Nevents+sensitivity\>\"", "]"}], 
   "=", "\"\<Number-of-events+sensitivity\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "taglist", "[", 
    "\"\<Sensitivity only (tabulated Nevents must be produced before)\>\"", 
    "]"}], "=", "\"\<Sensitivity\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"computationchoice", "=", 
   RowBox[{"dropdownDialog", "[", 
    RowBox[{
    "choiceslist", ",", 
     "\"\<Do you want to compute the tabulated number of events and then \
sensitivity, or just sensitivity (if the tabulated number of events has been \
already produced)?\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"tagselected", "=", 
  RowBox[{"taglist", "[", "computationchoice", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"BlockEvaluation", "[", "tagselected", "]"}]}], "Input",
 CellChangeTimes->{{3.893437585709897*^9, 3.893437589536964*^9}, {
   3.8934376329497385`*^9, 3.893437658846809*^9}, 3.893573049582372*^9, {
   3.8936653425702*^9, 3.8936653432627907`*^9}, {3.895052665512171*^9, 
   3.895052665712869*^9}, {3.895126994040556*^9, 3.895127000106095*^9}, {
   3.902561886909021*^9, 3.902561987917991*^9}, {3.902562067085945*^9, 
   3.902562067322758*^9}, 3.902729488593798*^9, {3.903788557154269*^9, 
   3.9037885613831005`*^9}, {3.9038033934699326`*^9, 
   3.9038034371611333`*^9}, {3.903854932333012*^9, 3.9038549328265457`*^9}, {
   3.914663085581284*^9, 3.9146631523773155`*^9}, {3.9168223861214433`*^9, 
   3.916822386303161*^9}, {3.917021562882574*^9, 3.917021563065056*^9}},
 CellLabel->
  "In[1406]:=",ExpressionUUID->"3ff672e3-e982-49fe-8fe3-e69285f06990"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Preliminary definitions", "Title",
 CellChangeTimes->{{3.755243494957929*^9, 3.755243495237189*^9}, {
   3.88501652694691*^9, 3.885016532955313*^9}, {3.885020480520123*^9, 
   3.885020485584347*^9}, 3.887617574733776*^9},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"dc98cc40-afde-45ba-ae22-\
74afbd95ce04"],

Cell[CellGroupData[{

Cell["Various directories", "Chapter",
 CellChangeTimes->{{3.913804059957842*^9, 3.913804062327417*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"1320ba97-7abe-4017-b5a5-\
ae36b7fec1b3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"LLPdirName", "=", "\"\<ALP-fermion\>\""}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Set", " ", "the", " ", "directory", " ", "for", " ", "the", " ", "search",
     " ", "where", " ", "tabulated", " ", "acceptances", " ", "are", " ", 
    "located"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"directory", "[", "\"\<Acceptances\>\"", "]"}], "=", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Acceptances\>\""}], 
      "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Set", " ", "the", " ", "directory", " ", "for", " ", "the", " ", 
     "search", " ", "where", " ", "tabulated", " ", "angle"}], "-", 
    RowBox[{"energy", " ", "distributions", " ", "are", " ", "located"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"directory", "[", "\"\<Distribution\>\"", "]"}], "=", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", 
       "\"\<spectra/New physics particles spectra\>\"", ",", "LLPdirName"}], 
      "}"}], "]"}]}], ";"}], " ", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "directory", " ", "storing", " ", "production", " ", "weights",
     " ", "of", " ", "the", " ", "given", " ", "LLP"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"directory", "[", "\"\<Production weights\>\"", "]"}], "=", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<phenomenology\>\"", 
       ",", "LLPdirName", ",", "\"\<Production probabilities\>\""}], "}"}], 
     "]"}]}], ";"}], " ", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Directory", " ", "to", " ", "which", " ", "various", " ", "auxillary", 
    " ", "datasets", " ", "will", " ", "be", " ", "stored"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"directory", "[", "\"\<Auxiliary\>\"", "]"}], "=", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Auxiliary data\>\"",
        ",", "LLPdirName"}], "}"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"!", 
      RowBox[{"DirectoryQ", "[", 
       RowBox[{"directory", "[", "\"\<Auxiliary\>\"", "]"}], "]"}]}], ",", 
     RowBox[{"CreateDirectory", "[", 
      RowBox[{"directory", "[", "\"\<Auxiliary\>\"", "]"}], "]"}]}], "]"}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Directory", " ", "containing", " ", "decay", " ", "widths", " ", "of", 
    " ", "the", " ", "LLPs"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"directory", "[", "\"\<Decays\>\"", "]"}], "=", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<phenomenology\>\"", 
       ",", "LLPdirName", ",", "\"\<decay widths\>\""}], "}"}], "]"}]}], 
   ";"}], " "}]}], "Input",
 CellChangeTimes->{{3.913804080271287*^9, 3.913804171309696*^9}, {
   3.913804205284999*^9, 3.913804380241178*^9}, {3.9138103204454637`*^9, 
   3.913810321646991*^9}, 3.9138295316757774`*^9, {3.913866403007876*^9, 
   3.913866404407455*^9}, {3.915642976515701*^9, 3.91564297653104*^9}},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->
  "In[1421]:=",ExpressionUUID->"d67e103e-ff85-49fc-80ad-39fdd6887281"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Parameters and various functions", "Chapter",
 CellChangeTimes->{{3.88466190091406*^9, 3.884661902476644*^9}, {
  3.885017296053095*^9, 3.8850172996856313`*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"9e90539e-357b-496f-b4bb-\
a60bd5224fbd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"infoDialog", "[", "phrase_", "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<Proceed\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"selectionDialog", "[", 
    RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
   RowBox[{"DialogInput", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"choice", "=", 
       RowBox[{"{", "}"}]}], "}"}], ",", 
     RowBox[{"Column", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{
         "{", "\"\<Select the experiments for which the number of events will \
be computed:\>\"", "}"}], "]"}], ",", 
        RowBox[{"Pane", "[", 
         RowBox[{
          RowBox[{"TogglerBar", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list", ",", 
            RowBox[{"Appearance", "->", 
             RowBox[{"\"\<Vertical\>\"", "->", 
              RowBox[{"{", 
               RowBox[{"Automatic", ",", "5"}], "}"}]}]}]}], "]"}], ",", 
          RowBox[{"ImageSize", "->", 
           RowBox[{"{", 
            RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], ",", 
          RowBox[{"Scrollbars", "->", 
           RowBox[{"{", 
            RowBox[{"False", ",", "True"}], "}"}]}]}], "]"}], ",", 
        RowBox[{"Button", "[", 
         RowBox[{"\"\<OK\>\"", ",", 
          RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
      "]"}]}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", "chbar", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"chbar", "=", " ", 
    RowBox[{"6.6", "*", 
     SuperscriptBox["10", 
      RowBox[{"-", "25"}]], "*", "3", "*", 
     SuperscriptBox["10", "8"]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Decay", " ", "width", " ", "of", " ", "mesons"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Tau]\[Pi]0", "=", 
   RowBox[{"8.52", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "17"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalGamma]\[Pi]0", "=", 
   FractionBox["chbar", "\[Tau]\[Pi]0"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Tau]B", "=", 
   RowBox[{"1.64", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "12"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hbar", "=", 
   RowBox[{"6.58", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "25"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalGamma]BdecayGeV", "=", 
    FractionBox["hbar", "\[Tau]B"]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Bare", " ", "quark", " ", "masses", " ", "from", " ", "pdg"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"md", "=", 
   RowBox[{"4.67", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "3"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mu", "=", 
   RowBox[{"2.16", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "3"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ms", "=", "0.093"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "Scales", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalLambda]wVal", "=", "80"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalLambda]QCDval", "=", "0.34"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Coupling", " ", "constants"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]EM", "=", 
   RowBox[{"1", "/", "137"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]W", "=", 
   RowBox[{"1", "/", "29."}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f\[Pi]", "=", "0.093"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]\[Eta]\[Eta]pr", "=", 
    RowBox[{"ArcSin", "[", 
     RowBox[{
      RowBox[{"-", "1"}], "/", "3."}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  
  RowBox[{"(*", 
   RowBox[{"Cross", "-", "sections"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Sigma]pNucleonInpb", "[", "Atarget_", "]"}], "=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"Atarget", "==", "1."}], ",", " ", 
      RowBox[{"42.5", "*", 
       RowBox[{"10", "^", 
        RowBox[{"(", "9", ")"}]}]}], ",", 
      RowBox[{"51", "*", 
       SuperscriptBox["Atarget", 
        RowBox[{"-", "0.29"}]], "*", 
       SuperscriptBox["10", "9"]}]}], "]"}]}], ";"}], "  ", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "first", " ", "case", " ", "is", " ", "for", " ", "SHIFT", " ",
     "target"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]ppLHC", "=", 
    RowBox[{"72", "*", 
     SuperscriptBox["10", "9"]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Masses", " ", "of", " ", "various", " ", "SM", " ", "particles"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"mSM", "[", "\"\<Bplus\>\"", "]"}], ",", 
      RowBox[{"mSM", "[", "\"\<Kplus\>\"", "]"}], ",", 
      RowBox[{"mSM", "[", "\"\<PiPlus\>\"", "]"}], ",", 
      RowBox[{"mSM", "[", "\"\<h\>\"", "]"}], ",", 
      RowBox[{"mSM", "[", "\"\<Bs\>\"", "]"}]}], "}"}], "=", 
    RowBox[{"{", 
     RowBox[{"5.279", ",", "0.495", ",", "0.139", ",", "62.5", ",", "5.366"}],
      "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Alpha]S", "[", "ma_", "]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"Interpolation", "[", 
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"NotebookDirectory", "[", "]"}], ",", 
             "\"\<phenomenology/AlphaS.txt\>\""}], "}"}], "]"}], ",", 
          "\"\<Table\>\""}], "]"}], ",", 
        RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "ma", 
      "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"___", "___", "___", "___", "___", "___", "__"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"B", "/", "K"}], " ", "fragmentation", " ", "fractions"}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"___", "___", "___", "___", "___", "___", "__"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Fragmentation", " ", "fractions", " ", "at", " ", "the", " ", 
     RowBox[{"LHC", ".", " ", "For"}], " ", "the", " ", "moment"}], ",", " ", 
    
    RowBox[{
     RowBox[{
     "the", " ", "same", " ", "fractions", " ", "are", " ", "assumed", " ", 
      "to", " ", "be", " ", "at", " ", "the", " ", "FCC"}], "-", "hh"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fbtob0", "[", "\"\<LHC\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"fbtobplus", "[", "\"\<LHC\>\"", "]"}], "=", 
    RowBox[{
     RowBox[{"fbtob0", "[", "\"\<FCC-hh\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"fbtobplus", "[", "\"\<FCC-hh\>\"", "]"}], "=", "0.324"}]}]}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fbtobs", "[", "\"\<LHC\>\"", "]"}], "=", 
    RowBox[{
     RowBox[{"fbtobs", "[", "\"\<FCC-hh\>\"", "]"}], "=", "0.09"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fragmentation", " ", "fractions", " ", "at", " ", 
    RowBox[{"SPS", ".", " ", "From"}], " ", "SHiP", " ", "physics", " ", 
    "paper"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fbtobs", "[", "\"\<SPS\>\"", "]"}], "=", "0.11"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fbtob0", "[", "\"\<SPS\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"fbtobplus", "[", "\"\<SPS\>\"", "]"}], "=", "0.411"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fstokplus", "[", "\"\<SPS\>\"", "]"}], "=", "0.5"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fstok0l", "[", "\"\<SPS\>\"", "]"}], "=", "0.25"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Fraction", " ", "of", " ", 
      SuperscriptBox["K", 
       RowBox[{"+", 
        RowBox[{"/", "-"}]}]], " ", "decaying", " ", "in"}], "-", 
     RowBox[{"flight", " ", "at", " ", "SPS"}]}], ",", " ", 
    RowBox[{
     RowBox[{"from", " ", 
      RowBox[{"https", ":"}]}], "//", 
     RowBox[{
      RowBox[{
       RowBox[{"arxiv", ".", "org"}], "/", "pdf"}], "/", 
      RowBox[{"2004.07974", ".", "pdf"}]}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fractionDecayInFlightKplusKminus", "=", 
    RowBox[{"(", 
     RowBox[{"0.29", "+", "0.07"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fragmentation", " ", "fractions", " ", "at", " ", 
    RowBox[{"FermilabBD", ".", " ", "Assumed"}], " ", "to", " ", "be", " ", 
    "the", " ", "same", " ", "as", " ", "at", " ", "SPS"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fbtobs", "[", "\"\<FermilabBD\>\"", "]"}], "=", "0.11"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fbtob0", "[", "\"\<FermilabBD\>\"", "]"}], "=", 
    RowBox[{
     RowBox[{"fbtobplus", "[", "\"\<FermilabBD\>\"", "]"}], "=", "0.411"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fragmentation", " ", "fractions", " ", "at", " ", 
    RowBox[{"Serpukhov", ".", " ", "Assumed"}], " ", "to", " ", "be", " ", 
    "zero"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fbtobs", "[", "\"\<Serpukhov\>\"", "]"}], "=", "0."}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fbtob0", "[", "\"\<Serpukhov\>\"", "]"}], "=", 
    RowBox[{
     RowBox[{"fbtobplus", "[", "\"\<Serpukhov\>\"", "]"}], "=", "0."}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fragmentation", " ", "fractions", " ", "at", " ", "LHC", " ", "fixed", 
    " ", "target"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Calculated", " ", "for", " ", "c", " ", "quarks", " ", "and", " ", 
    "estimated", " ", "for", " ", "b", " ", "quarks"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fbtobplus", "[", "\"\<LHC-fixed-target\>\"", "]"}], "=", "0.4"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fbtob0", "[", "\"\<LHC-fixed-target\>\"", "]"}], "=", "0.4"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fbtobs", "[", "\"\<LHC-fixed-target\>\"", "]"}], "=", "0.1"}], 
   ";"}], " ", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"copied", " ", "for", " ", "SPS"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fstokplus", "[", "\"\<LHC-fixed-target\>\"", "]"}], "=", "0.5"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fstok0l", "[", "\"\<LHC-fixed-target\>\"", "]"}], "=", "0.25"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.884661904994011*^9, 3.884661921540403*^9}, {
   3.8850164522887964`*^9, 3.885016524556818*^9}, {3.885016628097911*^9, 
   3.8850166282886553`*^9}, 3.885016710182028*^9, {3.8850167568987885`*^9, 
   3.885016762395402*^9}, {3.885016799450395*^9, 3.8850170557864246`*^9}, {
   3.88501712653312*^9, 3.885017216885895*^9}, {3.885017302445379*^9, 
   3.8850173372383676`*^9}, {3.885017399572728*^9, 3.88501741270778*^9}, {
   3.885017462535437*^9, 3.885017462658634*^9}, {3.885017559121188*^9, 
   3.8850175593408356`*^9}, {3.885018253547313*^9, 3.8850182538962827`*^9}, {
   3.885018314394388*^9, 3.885018333197164*^9}, {3.885018974112167*^9, 
   3.885018974433589*^9}, 3.885019096697073*^9, {3.885019721482507*^9, 
   3.885019765425804*^9}, {3.885019828534438*^9, 3.885019866194657*^9}, {
   3.88501995528426*^9, 3.8850201480526237`*^9}, {3.885020185062007*^9, 
   3.885020189499227*^9}, {3.885020291896063*^9, 3.885020333530507*^9}, {
   3.885020432284384*^9, 3.8850204475138783`*^9}, {3.8850205949824495`*^9, 
   3.885020600587699*^9}, {3.885021284321363*^9, 3.88502132833275*^9}, {
   3.885032891250867*^9, 3.885032982694621*^9}, {3.885033159126209*^9, 
   3.885033161690289*^9}, {3.8850331946913424`*^9, 3.8850331954065113`*^9}, {
   3.8850336204217644`*^9, 3.885033622603268*^9}, {3.885034255719199*^9, 
   3.8850344920061417`*^9}, {3.8850345924696712`*^9, 3.885034596199212*^9}, {
   3.885137383509305*^9, 3.885137406655247*^9}, {3.885137468502787*^9, 
   3.885137655416061*^9}, {3.885137692569293*^9, 3.885137784659045*^9}, {
   3.885137825500775*^9, 3.885137825675703*^9}, {3.8851383907242584`*^9, 
   3.885138392478346*^9}, {3.88513944801902*^9, 3.8851394797221875`*^9}, {
   3.885139512250944*^9, 3.8851395456971474`*^9}, {3.8851395939313087`*^9, 
   3.885139596117799*^9}, {3.885962358064992*^9, 3.8859624268736906`*^9}, {
   3.885962495384333*^9, 3.885962683096117*^9}, {3.885962735843563*^9, 
   3.8859627976972876`*^9}, {3.88596283011916*^9, 3.885962890857554*^9}, {
   3.885963158435935*^9, 3.885963249728134*^9}, {3.885964057005262*^9, 
   3.885964083223074*^9}, {3.885966197458858*^9, 3.8859662142093754`*^9}, {
   3.885966318198004*^9, 3.885966320641197*^9}, {3.885966447872212*^9, 
   3.885966506060196*^9}, {3.8859675052817345`*^9, 3.8859675311750975`*^9}, {
   3.885967601307781*^9, 3.885967609066586*^9}, {3.8859683762378*^9, 
   3.885968381214256*^9}, {3.88597383041576*^9, 3.885973834917327*^9}, {
   3.886568360749238*^9, 3.886568363243331*^9}, {3.886574653457847*^9, 
   3.8865746733313556`*^9}, {3.8866746207176623`*^9, 3.886674629953519*^9}, {
   3.886693647528898*^9, 3.8866936498862143`*^9}, {3.890288834517202*^9, 
   3.890288834677594*^9}, {3.8934972089819117`*^9, 3.893497216368944*^9}, {
   3.893520919046756*^9, 3.8935209190527515`*^9}, {3.893740434030961*^9, 
   3.893740543984796*^9}, {3.893745916046507*^9, 3.8937459169433384`*^9}, {
   3.895658670971438*^9, 3.895658671930601*^9}, {3.905231730357545*^9, 
   3.905231734237323*^9}, {3.9138664799503975`*^9, 3.913866531148331*^9}, {
   3.93386101221012*^9, 3.9338610128241577`*^9}, 3.9338611182856903`*^9, {
   3.933861179578142*^9, 3.93386122279669*^9}, {3.933861271624909*^9, 
   3.933861300653153*^9}},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->
  "In[1428]:=",ExpressionUUID->"81abd027-7ae4-4675-ae59-2bfc340f66bb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "LLP phenomenology: prodution probabilities, decay widths (y = ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"2", 
     RowBox[{
      SubscriptBox["v", "h"], "/", 
      SubscriptBox["f", "a"]}]}], ")"}], TraditionalForm]],ExpressionUUID->
  "b5f5b3e3-1e8e-4bf9-9310-0b66631f845d"]
}], "Chapter",
 CellChangeTimes->{{3.835270415198964*^9, 3.835270415497067*^9}, {
   3.854441650570236*^9, 3.854441651537327*^9}, {3.885016402104937*^9, 
   3.885016403005359*^9}, 3.885019196491799*^9, {3.885019273945055*^9, 
   3.88501928458453*^9}, {3.9137189927638803`*^9, 3.9137190046798325`*^9}, {
   3.913885745903579*^9, 3.913885754439905*^9}, 3.915642976553888*^9},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"979d2b9d-1e75-46f3-89d5-\
8590b80509b3"],

Cell[CellGroupData[{

Cell["Scanning for tabulated distributions", "Section",
 CellChangeTimes->{{3.913715001027456*^9, 3.9137150224099426`*^9}, {
  3.913715411520641*^9, 3.913715414252445*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"dd9e6701-41aa-4962-a9b7-\
dd611f556fa6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Define", " ", "the", " ", "file", " ", "pattern"}], "*)"}], "\n", 
  
  RowBox[{
   RowBox[{
    RowBox[{"pattern", "=", "\"\<DoubleDistr_*_*_*.m\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Search", " ", "for", " ", "files", " ", "matching", " ", "the", " ", 
     "pattern", " ", "in", " ", "the", " ", "directory", " ", "and", " ", 
     "its", " ", "subdirectories"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"matchingFiles", "=", 
     RowBox[{"FileNames", "[", 
      RowBox[{"pattern", ",", 
       RowBox[{"{", 
        RowBox[{"directory", "[", "\"\<Distribution\>\"", "]"}], "}"}], ",", 
       "Infinity"}], "]"}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"List", " ", "of", " ", "LLPs"}], ",", " ", 
     RowBox[{"production", " ", "modes"}], ",", " ", 
     RowBox[{
     "and", " ", "facilities", " ", "for", " ", "which", " ", "the", " ", 
      "tabulated", " ", "distributions", " ", "have", " ", "been", " ", 
      "computed", " ", "at", " ", "the", " ", "previous", " ", "stage", " ", 
      "of", " ", "using", " ", "SensCalc"}]}], "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"ExtractedProductionParameters", "=", 
     RowBox[{"Function", "[", 
      RowBox[{"filename", ",", 
       RowBox[{
        RowBox[{"parts", "=", 
         RowBox[{"StringSplit", "[", 
          RowBox[{
           RowBox[{"FileNameTake", "[", "filename", "]"}], ",", "\"\<_\>\""}],
           "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"parts", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"parts", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"StringDrop", "[", 
           RowBox[{
            RowBox[{"parts", "[", 
             RowBox[{"[", "4", "]"}], "]"}], ",", 
            RowBox[{"-", "2"}]}], "]"}]}], "}"}]}]}], " ", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"combinations", " ", "selected", " ", "LLP"}], ",", " ", 
     RowBox[{"production", " ", "channel"}], ",", " ", 
     RowBox[{
     "facility", " ", "for", " ", "which", " ", "the", " ", "tabulated", " ", 
      "distributions", " ", "are", " ", "present"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"DistrCombinations", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"ExtractedProductionParameters", "/@", "matchingFiles"}], ")"}],
      "//", "Sort"}]}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", "\"\<Phenomenology choice:\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"phen", "=", 
     RowBox[{"dropdownDialog", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<Revised\>\"", ",", "\"\<Old\>\""}], "}"}], ",", 
       "\"\<Use the revised phenomenology (2310.03524), or the old one \
(1901.09966; no hadronic decays, production only via B->K/K*)? Must be \
consistent with the choice made in 1. Acceptances.nb\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"phen", "==", "Null"}], ",", 
      RowBox[{"phen", "=", "\"\<Revised\>\""}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "phen", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"phen", "==", "\"\<Old\>\""}], ",", 
     RowBox[{"DistrCombinations", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"DistrCombinations", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "==", "\"\<B\>\""}], "&"}]}], 
       "]"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9137151636915593`*^9, 3.9137152465178146`*^9}, {
   3.9137153053586187`*^9, 3.913715399589816*^9}, {3.913718678447782*^9, 
   3.913718708673525*^9}, {3.913719203960288*^9, 3.9137192388759947`*^9}, {
   3.913804074855399*^9, 3.913804089247952*^9}, 3.913804313526248*^9, {
   3.913810357631002*^9, 3.913810363616334*^9}, {3.9138256248481236`*^9, 
   3.9138256471350822`*^9}, 3.913866565923759*^9, {3.915642976567477*^9, 
   3.915642976568613*^9}, {3.9181445624582376`*^9, 3.918144583829173*^9}},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->
  "In[1465]:=",ExpressionUUID->"d7f75d59-b6b8-43b5-84f6-94a071f6c958"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Production probabilities", "Section",
 CellChangeTimes->{{3.826713169183443*^9, 3.826713169854465*^9}, {
  3.885138658855132*^9, 3.8851386649516826`*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"78ee7ba3-4532-4920-80f8-\
e1fc4e784430"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ProductionProbabilitiesCoefs", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"directory", "[", "\"\<Production weights\>\"", "]"}], ",", 
        "\"\<Coefs-production-Fermion universal-scale-1000.-GeV.m\>\""}], 
       "}"}], "]"}], ",", "\"\<MX\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vh", "=", "246."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]am02", "[", 
      RowBox[{"\"\<Pi0\>\"", ",", "ma_", ",", "y_"}], "]"}], ",", 
     RowBox[{"\[Theta]am02", "[", 
      RowBox[{"\"\<Eta\>\"", ",", "ma_", ",", "y_"}], "]"}], ",", 
     RowBox[{"\[Theta]am02", "[", 
      RowBox[{"\"\<EtaPr\>\"", ",", "ma_", ",", "y_"}], "]"}], ",", 
     RowBox[{"BrBtoALPtotal", "[", 
      RowBox[{"ma_", ",", "y_"}], "]"}], ",", 
     RowBox[{"cGGeff", "[", 
      RowBox[{"ma_", ",", "y_"}], "]"}], ",", 
     RowBox[{"BrBtoALPKplus", "[", 
      RowBox[{"ma_", ",", "y_"}], "]"}], ",", 
     RowBox[{"BrBtoALPKstar", "[", 
      RowBox[{"ma_", ",", "y_"}], "]"}]}], "}"}], "=", 
   RowBox[{"ProductionProbabilitiesCoefs", "/.", 
    RowBox[{"{", 
     RowBox[{"f", "->", 
      FractionBox[
       RowBox[{"2", "vh"}], "y"]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogLogPlot", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]am02", "[", 
       RowBox[{"\"\<Pi0\>\"", ",", "ma", ",", "1"}], "]"}], ",", 
      RowBox[{"\[Theta]am02", "[", 
       RowBox[{"\"\<Eta\>\"", ",", "ma", ",", "1"}], "]"}], ",", 
      RowBox[{"\[Theta]am02", "[", 
       RowBox[{"\"\<EtaPr\>\"", ",", "ma", ",", "1"}], "]"}]}], "}"}], "]"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"ma", ",", "0.1", ",", "10"}], "}"}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Large"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FacilitiesList", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<SPS\>\"", ",", "\"\<FermilabBD\>\"", ",", "\"\<LHC\>\"", ",", 
     "\"\<FCC-hh\>\"", ",", "\"\<Serpukhov\>\"", ",", "\"\<ESS\>\"", ",", 
     " ", "\"\<LHC-fixed-target\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"PmotherToLLP", "[", 
      RowBox[{"mLLP_", ",", "y_", ",", "part", ",", "Facility"}], "]"}], "=", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"phen", "==", "\"\<Revised\>\""}], ",", 
       RowBox[{"\[Theta]am02", "[", 
        RowBox[{"part", ",", "mLLP", ",", "y"}], "]"}], ",", "0."}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"part", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Pi0\>\"", ",", "\"\<Eta\>\"", ",", "\"\<EtaPr\>\""}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"PmotherToLLP", "[", 
       RowBox[{"mLLP_", ",", "y_", ",", "\"\<B\>\"", ",", "Facility"}], "]"}],
       "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"fbtob0", "[", "Facility", "]"}], "+", 
         RowBox[{"fbtobplus", "[", "Facility", "]"}]}], ")"}], 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"phen", "==", "\"\<Revised\>\""}], ",", 
         RowBox[{"BrBtoALPtotal", "[", 
          RowBox[{"mLLP", ",", "y"}], "]"}], ",", 
         RowBox[{
          RowBox[{"BrBtoALPKplus", "[", 
           RowBox[{"mLLP", ",", "y"}], "]"}], "+", 
          RowBox[{"BrBtoALPKstar", "[", 
           RowBox[{"mLLP", ",", "y"}], "]"}]}]}], "]"}]}]}], ";"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Production", " ", "from", " ", "Drell"}], "-", 
    RowBox[{"Yan", " ", "process"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]DrellYanData", "[", "Facility_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dat", "=", 
      RowBox[{"Import", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"directory", "[", "\"\<Production weights\>\"", "]"}], ",", 
           RowBox[{
           "\"\<sigmaDrellYan_ALP-fermion_\>\"", "<>", "Facility", "<>", 
            "\"\<.txt\>\""}]}], "}"}], "]"}], ",", "\"\<Table\>\""}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MinMaxMassesDrellYan", "[", "Facility", "]"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Min", "[", 
         RowBox[{"dat", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{"4", ",", 
          RowBox[{"Max", "[", 
           RowBox[{"dat", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}]}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"int", "[", "ma_", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"MinMaxMassesDrellYan", "[", "Facility", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", " ", "ma", 
         "\[LessEqual]", 
         RowBox[{
          RowBox[{"MinMaxMassesDrellYan", "[", "Facility", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"10", "^", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Interpolation", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Log10", "[", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                  RowBox[{"Log10", "[", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "90"}]]}], "]"}]}], "}"}], "&"}], "/@", 
               "dat"}], ",", 
              RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
            RowBox[{"Log10", "[", "ma", "]"}], "]"}], ")"}]}], "]"}], ",", 
        "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PmotherToLLP", "[", 
       RowBox[{"mLLP_", ",", "y_", ",", "\"\<DrellYan\>\"", ",", "Facility"}],
        "]"}], "=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{"cGGeff", "[", 
          RowBox[{"mLLP", ",", "y"}], "]"}], "]"}], "2"], "*", 
       FractionBox[
        RowBox[{"int", "[", "mLLP", "]"}], 
        RowBox[{"\[Sigma]pNucleonInpb", "[", "Atarget", "]"}]]}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"\[Sigma]DrellYanData", "[", "Facility", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"Facility", ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<SPS\>\"", ",", "\"\<FermilabBD\>\"", ",", "\"\<LHC\>\"", ",", " ", 
       "\"\<LHC-fixed-target\>\""}], "}"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WeightsCombinations", "=", 
   RowBox[{"Cases", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Keys", "[", 
           RowBox[{"DownValues", "@", "PmotherToLLP"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{"3", ",", "4"}], "}"}]}], "//", "Transpose"}], "//", 
      "Sort"}], ",", 
     RowBox[{"_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"DistrCombinations", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "]"}], ",", "#"}], 
         "]"}], "&"}], ")"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<If there are production weights to all available distributions:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"IfCondDistrToWeights", "=", 
  RowBox[{
   RowBox[{"DistrCombinations", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "]"}], "==", 
   "WeightsCombinations"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"!", "IfCondDistrToWeights"}], ",", 
   RowBox[{
    RowBox[{
    "infoDialog", "[", 
     "\"\<You have not provided the production probabilities PmotherToLLP to \
all the generated tabulated distributions! Please do this first to avoid \
problems\>\"", "]"}], ";"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.903789100961299*^9, 3.9037893216023083`*^9}, {
   3.903789523395295*^9, 3.903789572409629*^9}, {3.903789604768315*^9, 
   3.90378977356562*^9}, {3.903789890324987*^9, 3.9037899000449486`*^9}, {
   3.9037899642050085`*^9, 3.903790005785064*^9}, {3.903790036701384*^9, 
   3.903790056975609*^9}, {3.903790184930455*^9, 3.9037902290750732`*^9}, {
   3.903790296392641*^9, 3.903790361606089*^9}, {3.9052322085806866`*^9, 
   3.905232251160842*^9}, {3.9057041721278706`*^9, 3.905704172799265*^9}, {
   3.910436960236367*^9, 3.9104369662151794`*^9}, {3.9138666043191*^9, 
   3.9138668331482778`*^9}, {3.913866923560096*^9, 3.9138669837047396`*^9}, {
   3.913867121436616*^9, 3.913867148187557*^9}, {3.913867226227738*^9, 
   3.913867280909151*^9}, {3.9138673124389005`*^9, 3.913867458862328*^9}, {
   3.9138692668786926`*^9, 3.913869300866382*^9}, 3.913869391160121*^9, {
   3.91387068921657*^9, 3.9138707160377755`*^9}, 3.9138865312401304`*^9, {
   3.913886824054584*^9, 3.913886824419585*^9}, {3.915642976584443*^9, 
   3.9156429766276245`*^9}, {3.916502868618496*^9, 3.916502870454643*^9}, {
   3.918144556456888*^9, 3.9181445569500875`*^9}, {3.933861324036358*^9, 
   3.933861345386923*^9}},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->
  "In[1474]:=",ExpressionUUID->"fec40a05-ba64-4ab5-86c9-a0eb22a607d0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["LLP lifetime and branching ratios", "Section",
 CellChangeTimes->{{3.7725113836218624`*^9, 3.7725113869263597`*^9}, {
   3.826651830998455*^9, 3.826651834218698*^9}, {3.8267130444352474`*^9, 
   3.8267130466742153`*^9}, {3.885139954002949*^9, 3.885139956051908*^9}, 
   3.8859669419752054`*^9, {3.9146559319699306`*^9, 3.914655933261186*^9}, 
   3.915642976634613*^9},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"12e0bee4-6a1a-451c-b99f-\
fa0db8a155eb"],

Cell[CellGroupData[{

Cell["Lifetimes and branching ratios", "Subsection",
 CellChangeTimes->{{3.826651853928807*^9, 3.8266518561959257`*^9}, {
   3.877248260034466*^9, 3.8772482610102777`*^9}, 3.885139957534796*^9, {
   3.903790416325832*^9, 3.9037904195043745`*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"0a5caafb-270c-4b49-8d0a-\
a733f8c6fed5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "widths", " ", "of", " ", "the", " ", "ALP", " ", 
    "into", " ", "various", " ", "final", " ", "states"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"DecayWidthsDataTemp", "=", 
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"directory", "[", "\"\<Decays\>\"", "]"}], ",", 
          "\"\<Widths-model-Fermion universal-scale-1000.-GeV.m\>\""}], "}"}],
         "]"}], ",", "\"\<MX\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DecayWidthsDataTemp2", "=", 
     RowBox[{"DecayWidthsDataTemp", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{"i", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"DecayWidthsDataTemp2", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "1"}], "}"}]}], "]"}],
       ",", 
      RowBox[{"DecayWidthsDataTemp2", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "//", "TableForm"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DecayWidthsData", "=", 
     RowBox[{"Drop", "[", 
      RowBox[{"DecayWidthsDataTemp2", ",", "3"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Total", " ", "decay", " ", "width", " ", "and", " ", "lifetime"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"totalwidthdata", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"phen", "==", "\"\<Revised\>\""}], ",", 
       RowBox[{"DecayWidthsData", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}], ",", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"DecayWidthsData", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", "1", "}"}]}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"DecayWidthsData", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"{", "2", "}"}]}], "]"}], "]"}], "+", 
          RowBox[{"DecayWidthsData", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"{", "4", "}"}]}], "]"}], "]"}], "+", 
          RowBox[{"DecayWidthsData", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"{", "5", "}"}]}], "]"}], "]"}]}], ",", "2"}], "]"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalGamma]LLP", "[", 
      RowBox[{"mLLP_", ",", "y_"}], "]"}], "=", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["1", 
         RowBox[{"2", "vh"}]], ")"}], "2"], 
      SuperscriptBox["y", "2"], 
      RowBox[{
       RowBox[{"Interpolation", "[", 
        RowBox[{"totalwidthdata", ",", 
         RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", "mLLP", 
       "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"c\[Tau]LLP", "[", 
      RowBox[{"mLLP_", ",", "y_"}], "]"}], "=", 
     FractionBox["chbar", 
      RowBox[{"\[CapitalGamma]LLP", "[", 
       RowBox[{"mLLP", ",", "y"}], "]"}]]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ldecayLLP", "[", 
      RowBox[{"mLLP_", ",", "y_", ",", "ELLP_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"c\[Tau]LLP", "[", 
       RowBox[{"mLLP", ",", "y"}], "]"}], 
      FractionBox[
       SqrtBox[
        RowBox[{
         SuperscriptBox["ELLP", "2"], "-", 
         SuperscriptBox["mLLP", "2"]}]], "mLLP"]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.885966750627146*^9, 3.885966791206058*^9}, {
   3.885966836424579*^9, 3.8859669074950113`*^9}, 3.885966941982392*^9, {
   3.8859715979950085`*^9, 3.885971603579268*^9}, {3.885974695642521*^9, 
   3.885974721565711*^9}, {3.886673217124567*^9, 3.886673218603608*^9}, {
   3.889769657115446*^9, 3.889769754379297*^9}, {3.903789673385208*^9, 
   3.903789673405342*^9}, {3.903790316314316*^9, 3.9037903275646257`*^9}, {
   3.903790500628828*^9, 3.903790729474674*^9}, {3.903790784540344*^9, 
   3.903790853374163*^9}, {3.9037908912108645`*^9, 3.903791100724623*^9}, {
   3.903793337349135*^9, 3.903793339945244*^9}, {3.9037937001663475`*^9, 
   3.903793717204276*^9}, {3.904902837278482*^9, 3.904902837561043*^9}, {
   3.904902887149907*^9, 3.9049028887197638`*^9}, {3.905231744853395*^9, 
   3.905231948969136*^9}, {3.905232021447636*^9, 3.9052320316413155`*^9}, {
   3.9057040844572673`*^9, 3.90570412226708*^9}, {3.905704159567094*^9, 
   3.905704160407111*^9}, {3.905962038706494*^9, 3.905962043600975*^9}, 
   3.91386675221645*^9, {3.9138674945173087`*^9, 3.9138675182935505`*^9}, {
   3.913867552057797*^9, 3.913867616821158*^9}, {3.9138693084804177`*^9, 
   3.9138693175719366`*^9}, 3.9138694747743807`*^9, {3.9156429766431*^9, 
   3.9156429766800623`*^9}, {3.918134627208931*^9, 3.9181346293807435`*^9}, {
   3.9181455809594193`*^9, 3.918145583868434*^9}},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->
  "In[1487]:=",ExpressionUUID->"6b40e71e-4d73-422f-a8a1-e2d1d3309f91"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Loading necessary routines", "Chapter",
 CellChangeTimes->{{3.891315426588935*^9, 3.891315432542842*^9}, {
  3.9165033404709945`*^9, 3.916503346398584*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"c9967d9e-0dfa-4ef8-95ab-\
cf6e6b36fed3"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", "inecessary", "]"}], "==", "0"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NotebookEvaluate", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<codes/generic.nb\>\""}], "}"}], "]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"NotebookEvaluate", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<codes/for-sensitivities.nb\>\""}], "}"}], "]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"inecessary", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.890711783488103*^9, 3.89071178348964*^9}, {
   3.8907121412539587`*^9, 3.8907121413711557`*^9}, {3.890712694841427*^9, 
   3.8907126950000925`*^9}, {3.890712790376151*^9, 3.890712821991978*^9}, {
   3.891018553068019*^9, 3.8910185548862777`*^9}, {3.914141327087761*^9, 
   3.914141328258805*^9}, 3.9165033910195627`*^9, {3.916503434997039*^9, 
   3.9165034401725807`*^9}, 3.916646128874757*^9},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->
  "In[1495]:=",ExpressionUUID->"23e88572-18a2-48b7-93ee-40187286fc03"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Specifying the experiments", "Title",
 CellChangeTimes->{{3.8876174764645414`*^9, 3.887617482214775*^9}, 
   3.903805898537039*^9},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"bd147158-f526-489d-afb7-\
12c825eddce3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Parent", " ", "directory"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NotebookDirectory", "[", "]"}], "//", "ParentDirectory"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExperimentDirectoriesList", "=", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"FileNames", "[", 
       RowBox[{"\"\<*\>\"", ",", 
        RowBox[{"directory", "[", "\"\<Acceptances\>\"", "]"}], ",", "1"}], 
       "]"}], ",", "DirectoryQ"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"List", " ", "of", " ", "available", " ", "experiments", " ", 
    RowBox[{"(", 
     RowBox[{
     "for", " ", "which", " ", "the", " ", "geometry", " ", "has", " ", 
      "been", " ", "implemented"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentsListTemp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"FileNameTake", "[", 
      RowBox[{
       RowBox[{"ExperimentDirectoriesList", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"-", "1"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "ExperimentDirectoriesList", "]"}], ",", "1"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentsListTemp2", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Partition", "[", 
      RowBox[{"ExperimentsListTemp", ",", "1"}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"TrueQ", "@", 
         RowBox[{"FileExistsQ", "@", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"directory", "[", "\"\<Acceptances\>\"", "]"}], ",", 
             RowBox[{"ExperimentsListTemp", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"ToString", "@", 
              RowBox[{"StringForm", "[", 
               RowBox[{"\"\<Acceptance_``_for_``.m\>\"", ",", 
                RowBox[{"Sequence", "@@", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"ExperimentsListTemp", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "LLPdirName"}], 
                  "}"}]}]}], "]"}]}]}], "}"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "ExperimentsListTemp", "]"}]}], "}"}]}], 
      "]"}], ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ExperimentsList", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{"ExperimentsListTemp2", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "True"}], "&"}]}], "]"}],
     "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", 
   "Sort"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", "ExperimentsList", "]"}], "\[Equal]", "0"}], ",", 
   RowBox[{
   "Print", "[", 
    "\"\<No experiment is available, generate first the acceptance for the \
given experiment using module 1\>\"", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Selected experiments:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"SelectedExperimentList", "=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "ExperimentsList", "]"}], "\[NotEqual]", "0"}], 
    ",", 
    RowBox[{"selectionDialog", "[", 
     RowBox[{"ExperimentsList", ",", "\"\<Select the experiments:\>\""}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"icounter", "=", "1"}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.885140325471848*^9, 3.885140342941128*^9}, {
   3.885439548447849*^9, 3.885439559226637*^9}, {3.8854397351242537`*^9, 
   3.885439739219259*^9}, {3.885879419635057*^9, 3.885879423032172*^9}, 
   3.886141121558817*^9, {3.8876173384285884`*^9, 3.887617343137988*^9}, 
   3.8879528512136784`*^9, 3.888910953061735*^9, {3.888991864545177*^9, 
   3.888991864973507*^9}, {3.89028892992096*^9, 3.890288929973218*^9}, {
   3.892132996360413*^9, 3.8921329963973475`*^9}, {3.892273487209856*^9, 
   3.892273493459851*^9}, 3.89323426738691*^9, {3.893234348855938*^9, 
   3.89323434901425*^9}, 3.893348200726568*^9, 3.902557307526181*^9, {
   3.902762608567563*^9, 3.902762613326627*^9}, 3.903791119173597*^9, {
   3.9037911899337234`*^9, 3.903791190104163*^9}, {3.905231719911791*^9, 
   3.9052317257412796`*^9}, {3.913867733576295*^9, 3.9138677694805813`*^9}, 
   3.9138678726081395`*^9, 3.915642976688235*^9},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->
  "In[1496]:=",ExpressionUUID->"c05031d8-0efd-4502-a294-675e6231eb7c"],

Cell[CellGroupData[{

Cell["Running block for next sections", "Chapter",
 CellChangeTimes->{{3.902729140157612*^9, 3.90272914444062*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"f6b19458-661d-4b9a-84b2-\
be5f3bbf270c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BlockEvaluation", "[", "tag_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nb", "=", 
      RowBox[{"EvaluationNotebook", "[", "]"}]}], ";", "\n", 
     RowBox[{"NotebookFind", "[", 
      RowBox[{"nb", ",", "tag", ",", "All", ",", "CellTags"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"tagselected", "==", "\"\<Number-of-events+sensitivity\>\""}], ",",
    "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
      "BlockEvaluation", "[", 
       "\"\<Number-of-events-computation+sensitivity\>\"", "]"}], ";"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"icounter", ",", "1", ",", 
       RowBox[{"Length", "[", "SelectedExperimentList", "]"}], ",", "1"}], 
      "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"tagselected", "==", "\"\<Acceptance\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
        "BlockEvaluation", "[", "\"\<Acceptance-computation\>\"", "]"}], 
        ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"icounter", ",", "1", ",", 
         RowBox[{"Length", "[", "SelectedExperimentList", "]"}], ",", "1"}], 
        "}"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.9027291581950865`*^9, 3.902729215695462*^9}, {
   3.902761777481885*^9, 3.902761802513644*^9}, {3.903791187433768*^9, 
   3.903791187683767*^9}, 3.903803493616716*^9, {3.9146632430801764`*^9, 
   3.9146632570767794`*^9}, {3.914667113824792*^9, 3.914667131887417*^9}, {
   3.918145756308647*^9, 3.9181457570301857`*^9}},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->
  "In[1506]:=",ExpressionUUID->"4c060b6c-ecc3-4469-86c0-269c265b419b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Number of events", "Title",
 CellChangeTimes->{{3.885140281753849*^9, 3.885140283678184*^9}},
 CellTags->
  "Number-of-events-computation+sensitivity",ExpressionUUID->"3e9a02fd-97c3-\
44ee-9f5b-9ca3983b66da"],

Cell[CellGroupData[{

Cell["Particular experiment", "Chapter",
 CellChangeTimes->{{3.916504200155148*^9, 3.916504204120729*^9}, {
  3.9165090857383037`*^9, 3.916509094318386*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"b58a105b-0eb2-\
42ec-8386-a1aec7ee56e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SelectedExperiment", "=", 
   RowBox[{"SelectedExperimentList", "[", 
    RowBox[{"[", 
     RowBox[{"icounter", "++"}], "]"}], "]"}]}], ";"}]], "Input",
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[1508]:=",ExpressionUUID->"cd85975d-be44-4973-874e-283780fb4371"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cross-sections, acceptances", "Chapter",
 CellChangeTimes->{{3.887617515556376*^9, 3.887617519296738*^9}, {
  3.8946372037023845`*^9, 3.8946372090126057`*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"4cb86986-b7a3-\
4409-91ed-f7461f351ed0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dataAcceptances", "=", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"directory", "[", "\"\<Acceptances\>\"", "]"}], ",", 
           "SelectedExperiment", ",", 
           RowBox[{"ToString", "@", 
            RowBox[{"StringForm", "[", 
             RowBox[{"\"\<Acceptance_``_for_``.m\>\"", ",", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"{", 
                RowBox[{"SelectedExperiment", ",", "LLPdirName"}], "}"}]}]}], 
             "]"}]}]}], "}"}], "]"}], "}"}], "]"}], ",", "\"\<MX\>\""}], 
     "]"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"FacilityGivenExperiment", ",", "FullAcceptanceData0", ",", 
     RowBox[{"BrVis", "[", "mLLP_", "]"}]}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"dataAcceptances", "[", 
      RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
    RowBox[{"{", 
     RowBox[{"1", ",", "3", ",", "5"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LogLogPlot", "[", 
   RowBox[{
    RowBox[{"Evaluate", "[", 
     RowBox[{"BrVis", "[", "mLLP", "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"mLLP", ",", "0.02", ",", "10"}], "}"}], ",", 
    RowBox[{"Frame", "->", "True"}], ",", 
    RowBox[{"ImageSize", "->", "Large"}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", " ", "22"}], "]"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Blue"}], "}"}], ",", 
       
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
         RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
         RowBox[{"Darker", "@", 
          RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Black"}], "}"}]}], 
      "}"}]}], ",", 
    RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.1", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.01", ",", "1.2"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<m [GeV]\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(Br\), \(vis\)]\)\>\""}], "}"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", " ", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<For \>\"", ",", "SelectedExperiment"}], "}"}], "]"}], 
       ",", " ", "20", ",", " ", "Black"}], "]"}]}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"___", "___", "___", "___", "___", "___", "___", "___", "___"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Interpolation", " ", "of", " ", "the", " ", "tabulated", " ", 
     "azimuthal", " ", "acceptance"}], ",", " ", 
    RowBox[{"extracting", " ", 
     SubscriptBox["\[Theta]", 
      RowBox[{"min", "/", "max"}]]}], ",", " ", 
    RowBox[{"etc", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"___", "___", "___", "___", "___", "___", "___", "___", "___"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"AzimuthalAcceptanceInt", "[", 
       RowBox[{"\[Theta]LLP_", ",", "zLLP_"}], "]"}], ",", 
      "\[Theta]minExpAll", ",", "\[Theta]maxExpAll", ",", "\[Theta]minExp", 
      ",", "\[Theta]maxExp", ",", "zminExp", ",", "zmaxExp", ",", 
      RowBox[{"zmin\[Theta]", "[", "\[Theta]LLP_", "]"}], ",", 
      RowBox[{"zmax\[Theta]", "[", "\[Theta]LLP_", "]"}]}], "}"}], "=", 
    RowBox[{"Block\[Epsilon]Azimuthal", "[", "FullAcceptanceData0", "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Logarithmized", " ", "data", " ", "with", " ", "full", " ", 
     "acceptance"}], ",", " ", 
    RowBox[{
    "and", " ", "also", " ", "decay", " ", "acceptance", " ", "and", " ", 
     "full", " ", "acceptance", " ", "interpolations"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"FullAcceptanceData", ",", 
     RowBox[{"DecayAcceptanceInt", "[", 
      RowBox[{"mLLP_", ",", "\[Theta]LLP_", ",", "ELLP_", ",", "zLLP_"}], 
      "]"}], ",", 
     RowBox[{"FullAcceptanceInt", "[", 
      RowBox[{"mLLP_", ",", "\[Theta]LLP_", ",", "ELLP_", ",", "zLLP_"}], 
      "]"}], ",", "InGridm\[Epsilon]", ",", "InGrid\[Theta]\[Epsilon]", ",", 
     "InGridE\[Epsilon]", ",", "InGridz\[Epsilon]", ",", "\[Epsilon]vals", 
     ",", "\[Epsilon]azvals", ",", "mmin\[Epsilon]", ",", "mmax\[Epsilon]"}], 
    "}"}], "=", 
   RowBox[{"Block\[Epsilon]Decay", "[", 
    RowBox[{"FullAcceptanceData0", ",", "zminExp", ",", "BrVis"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CrossSectionData", "=", 
   RowBox[{
    RowBox[{"dataAcceptances", "[", 
     RowBox[{"[", "4", "]"}], "]"}], "//", "Transpose"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NpotGivenExperiment", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"CrossSectionData", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<Npot\>\""}], 
         "&"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "//", "N"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProbMother", "[", "\"\<B\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"CrossSectionData", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<Pb\>\""}], "&"}]}],
       "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProbMother", "[", "\"\<Pi0\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"CrossSectionData", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<PPi0\>\""}], 
        "&"}]}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProbMother", "[", "\"\<Eta\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"CrossSectionData", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<PEta\>\""}], 
        "&"}]}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProbMother", "[", "\"\<EtaPr\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"CrossSectionData", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<PEtapr\>\""}], 
        "&"}]}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProbMother", "[", "\"\<DrellYan\>\"", "]"}], "=", "1."}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AtargetVal", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"CrossSectionData", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<Atarget\>\""}], 
        "&"}]}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(\[Chi]\), \(b\\\  or\\\  \
\*OverscriptBox[\(b\), \(_\)]\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(\[Chi]\), SuperscriptBox[\(\[Pi]\), \
\(0\)]]\)\>\"", ",", "\"\<\!\(\*SubscriptBox[\(\[Chi]\), \(\[Eta]\)]\)\>\"", 
       ",", "\"\<\!\(\*SubscriptBox[\(\[Chi]\), \(\[Eta]'\)]\)\>\""}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ProbMother", "[", "\"\<B\>\"", "]"}], ",", 
       RowBox[{"ProbMother", "[", "\"\<Pi0\>\"", "]"}], ",", 
       RowBox[{"ProbMother", "[", "\"\<Eta\>\"", "]"}], ",", 
       RowBox[{"ProbMother", "[", "\"\<EtaPr\>\"", "]"}]}], "}"}]}], "}"}], "//",
    "TableForm"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"infoDialog", "[", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{
      "\"\<The number of proton collisions is \>\"", ",", " ", 
       "NpotGivenExperiment", ",", 
       "\"\<. You may change it at the stage of computing the sensitivities\>\
\""}], "}"}], "]"}], "]"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
    "\"\<Search for \>\"", "<>", "LLPdirName", " ", "<>", "\"\< at \>\""}], 
    ",", " ", "SelectedExperiment", ",", " ", "\"\< located at \>\"", ",", 
    "FacilityGivenExperiment", ",", 
    "\"\<. \!\(\*SubscriptBox[\(N\), \(collisions\)]\) = \>\"", ",", 
    "NpotGivenExperiment"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\"\<Quantity\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(min\)]\), rad\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(max\)]\), rad\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(min\)]\)(\!\(\*SubscriptBox[\(\
\[Epsilon]\), \(dec\)]\)), rad\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(max\)]\)(\!\(\*SubscriptBox[\(\
\[Epsilon]\), \(dec\)]\)), rad\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(z\), \(min\)]\), m\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(z\), \(max\)]\), m\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Description\>\"", ",", "\"\<Min angle covered by experiment\>\"", 
      ",", "\"\<Max angle covered by experiment\>\"", ",", 
      "\"\<Min angle where \!\(\*SubscriptBox[\(\[Epsilon]\), \(decay\)]\)\
\[NotEqual]0\>\"", ",", 
      "\"\<Max angle where \!\(\*SubscriptBox[\(\[Epsilon]\), \(decay\)]\)\
\[NotEqual]0\>\"", ",", "\"\<Min long. displacement of the decay volume\>\"", 
      ",", "\"\<Max long. displacement of the decay volume\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Value\>\"", ",", "\[Theta]minExpAll", ",", "\[Theta]maxExpAll", ",",
       "\[Theta]minExp", ",", "\[Theta]maxExp", ",", "zminExp", ",", 
      "zmaxExp"}], "}"}]}], "}"}], "//", 
  "TableForm"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.887616632812935*^9, 3.8876168497686005`*^9}, {
   3.887616957223375*^9, 3.88761698471849*^9}, {3.887617065527506*^9, 
   3.887617076894349*^9}, 3.887617106955623*^9, {3.8876171406331663`*^9, 
   3.8876171534880905`*^9}, 3.8876171853380766`*^9, {3.887617277300462*^9, 
   3.8876172910033817`*^9}, {3.887617348810663*^9, 3.887617349563163*^9}, {
   3.887617380771906*^9, 3.887617387749444*^9}, {3.887954851237727*^9, 
   3.887954882480399*^9}, {3.888910969072772*^9, 3.888910986302345*^9}, {
   3.889769759229668*^9, 3.889769783989515*^9}, {3.890288994931154*^9, 
   3.890289005479728*^9}, {3.890289046677289*^9, 3.890289091235558*^9}, {
   3.890289310042413*^9, 3.890289348842971*^9}, {3.8921325536562467`*^9, 
   3.8921327449707036`*^9}, {3.8921327781536665`*^9, 3.89213297677147*^9}, {
   3.892133046488756*^9, 3.89213305432375*^9}, {3.8921359392522163`*^9, 
   3.892135940765498*^9}, 3.892136039490557*^9, {3.892136892048996*^9, 
   3.892136892680512*^9}, {3.8921370374571185`*^9, 3.892137038158225*^9}, 
   3.893348204595518*^9, {3.894178873045617*^9, 3.89417888661617*^9}, {
   3.89463720120516*^9, 3.8946372014907866`*^9}, {3.8950529552788444`*^9, 
   3.895052958705437*^9}, {3.899198460033712*^9, 3.8991984775370417`*^9}, {
   3.902762641227653*^9, 3.9027626417289543`*^9}, {3.9027638647415314`*^9, 
   3.902763867298991*^9}, {3.903791118063882*^9, 3.903791118078563*^9}, {
   3.9038058586140475`*^9, 3.9038058750916357`*^9}, {3.904889549715294*^9, 
   3.904889568017098*^9}, {3.9049015890518956`*^9, 3.904901594949988*^9}, {
   3.913867551598299*^9, 3.913867563741498*^9}, {3.9138679416777687`*^9, 
   3.91386801728654*^9}, {3.913868067216427*^9, 3.9138681364562488`*^9}, {
   3.913868187616731*^9, 3.913868301540289*^9}, {3.9138701314833584`*^9, 
   3.9138701382361374`*^9}, {3.9138730035884037`*^9, 
   3.9138730052566104`*^9}, {3.9140628252814837`*^9, 3.914062829998874*^9}, {
   3.914514877285455*^9, 3.914514885795359*^9}, {3.915642976711395*^9, 
   3.91564297685727*^9}, {3.916503103974023*^9, 3.9165031047889967`*^9}, 
   3.9165032969766207`*^9, {3.9165035802662907`*^9, 3.916503642216813*^9}, {
   3.916503796181175*^9, 3.9165038080857544`*^9}, 3.916646171869815*^9},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[1509]:=",ExpressionUUID->"5e37716e-c5ef-4959-a8f2-3412a62b2217"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Angle-energy distributions for the given experiment", "Chapter",
 CellChangeTimes->{{3.885020702966837*^9, 3.885020711525731*^9}, {
   3.885021692475935*^9, 3.8850216984444695`*^9}, {3.8851404110391603`*^9, 
   3.8851404117847*^9}, 3.885966942007949*^9, {3.887617366288483*^9, 
   3.8876173699611483`*^9}, {3.896334866051643*^9, 3.896334870004681*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"41c8c006-200d-\
49b8-91a2-db90a194f508"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ProductionPatternSelected", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"DistrCombinations", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "==", "FacilityGivenExperiment"}], 
      "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Production list:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ProductionList", "=", 
  RowBox[{
   RowBox[{"ProductionPatternSelected", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "2"}], "]"}], "]"}], "//", 
   "DeleteDuplicates"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "prod", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"prod", "=", 
       RowBox[{
        RowBox[{"ProductionPatternSelected", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Importing", " ", "the", " ", "data", " ", "with", " ", 
        "distribution"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"dirimp", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"prod", "==", "\"\<DrellYan\>\""}], ",", 
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"directory", "[", "\"\<Distribution\>\"", "]"}], ",", 
            "\"\<Pregenerated\>\""}], "}"}], "]"}], ",", 
         RowBox[{"directory", "[", "\"\<Distribution\>\"", "]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DistrDataImport", "[", "prod", "]"}], "=", 
       RowBox[{"Import", "[", 
        RowBox[{
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{"dirimp", ",", 
            RowBox[{
            "\"\<DoubleDistr_\>\"", "<>", "LLPdirName", "<>", "\"\<_\>\"", "<>",
              "prod", "<>", "\"\<_\>\"", "<>", "FacilityGivenExperiment", 
             "<>", "\"\<.m\>\""}]}], "}"}], "]"}], ",", "\"\<MX\>\""}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"prod", "==", "\"\<DrellYan\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"DistrDataImport", "[", "prod", "]"}], "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"DistrDataImport", "[", "prod", "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
               "MinMaxMassesDrellYan", "[", "FacilityGivenExperiment", "]"}], 
               "[", 
               RowBox[{"[", "1", "]"}], "]"}], "<=", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "<=", 
              RowBox[{
               RowBox[{
               "MinMaxMassesDrellYan", "[", "FacilityGivenExperiment", "]"}], 
               "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Min", "/", "mass"}], " ", "mass", " ", "of", " ", "the", " ",
         "LLP", " ", "from", " ", "the", " ", "data"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mlistDistr", "[", "prod", "]"}], "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{
         RowBox[{"DistrDataImport", "[", "prod", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"mLLPmin", "[", "prod", "]"}], ",", 
         RowBox[{"mLLPmax", "[", "prod", "]"}]}], "}"}], "=", 
       RowBox[{"MinMax", "[", 
        RowBox[{"mlistDistr", "[", "prod", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Interpolation", " ", "of", " ", "the", " ", "tabulated", " ", 
        "distribution"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DoubleDistrLLPint", "[", 
        RowBox[{"mLLP_", ",", "\[Theta]LLP_", ",", "ELLP_", ",", "prod"}], 
        "]"}], "=", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Interpolation", "[", 
           RowBox[{
            RowBox[{"distrlogComp", "[", 
             RowBox[{"DistrDataImport", "[", "prod", "]"}], "]"}], ",", 
            RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
          RowBox[{
           RowBox[{"Log10", "[", "mLLP", "]"}], ",", 
           RowBox[{"Log10", "[", "\[Theta]LLP", "]"}], ",", 
           RowBox[{"Log10", "[", "ELLP", "]"}]}], "]"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Probability", " ", "to", " ", "produce", " ", "LLP"}], "*)"}],
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ProbLLP", "[", 
        RowBox[{"mLLP_", ",", "finv_", ",", "prod"}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"ProbMother", "[", "prod", "]"}], "*", 
         RowBox[{"PmotherToLLP", "[", 
          RowBox[{
          "mLLP", ",", "finv", ",", "prod", ",", "FacilityGivenExperiment"}], 
          "]"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"Atarget", "->", "AtargetVal"}], "}"}]}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "ProductionPatternSelected", "]"}], ",", "1"}], 
    "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"directory", "[", "\"\<Auxiliary-experiment\>\"", "]"}], "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"directory", "[", "\"\<Auxiliary\>\"", "]"}], ",", 
      "SelectedExperiment"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"DirectoryQ", "[", 
      RowBox[{"directory", "[", "\"\<Auxiliary-experiment\>\"", "]"}], 
      "]"}]}], ",", 
    RowBox[{"CreateDirectory", "[", 
     RowBox[{"directory", "[", "\"\<Auxiliary-experiment\>\"", "]"}], "]"}]}],
    "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"directory", "[", "\"\<Auxiliary-experiment\>\"", "]"}], ",", 
       RowBox[{
       "\"\<Double-Distr-Averaged-\>\"", "<>", "LLPdirName", "<>", 
        "\"\<.m\>\""}]}], "}"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"mLLPmin", "[", "prod", "]"}], "<", "mLLP", "<", 
           RowBox[{"mLLPmax", "[", "prod", "]"}]}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"ProbLLP", "[", 
            RowBox[{"mLLP", ",", "1", ",", "prod"}], "]"}], "]"}], ",", "0"}],
          "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ",", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"mLLPmin", "[", "prod", "]"}], "<", "mLLP", "<", 
             RowBox[{"mLLPmax", "[", "prod", "]"}]}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"ProbLLP", "[", 
              RowBox[{"mLLP", ",", "1", ",", "prod"}], "]"}], "]"}], ",", 
            "0"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}]], 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"mLLPmin", "[", "prod", "]"}], "<", "mLLP", "<", 
            RowBox[{"mLLPmax", "[", "prod", "]"}]}], ",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{
             RowBox[{"ProbLLP", "[", 
              RowBox[{"mLLP", ",", "1", ",", "prod"}], "]"}], "*", 
             RowBox[{"DoubleDistrLLPint", "[", 
              RowBox[{"mLLP", ",", "\[Theta]LLP", ",", "ELLP", ",", "prod"}], 
              "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}]}]}], "}"}], 
    ",", "\"\<MX\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"GridInFinal", "[", "prod", "]"}], ",", 
         RowBox[{"DistrVals", "[", "prod", "]"}]}], "}"}], "=", 
       RowBox[{"BlockGridsValsDistr", "[", 
        RowBox[{"prod", ",", "DistrDataImport"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";"}], "//", 
   "AbsoluteTiming"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "___", "___", "___", "___", "___", "___", "___", "___", "___", "_"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Finding", " ", 
    SubscriptBox["E", "max"], 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["m", "LLP"], ",", 
      SubscriptBox["\[Theta]", "LLP"]}], ")"}], " ", "for", " ", "the", " ", 
    "angular", " ", "range", " ", "at", " ", "the", " ", "given", " ", 
    "experiment"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "___", "___", "___", "___", "___", "___", "___", "___", "___", "_"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ELLPmax", "[", 
       RowBox[{"mfip_", ",", "\[Theta]fip_", ",", "prod"}], "]"}], "=", 
      RowBox[{"EmaxBlock", "[", 
       RowBox[{
       "prod", ",", "9", ",", "DistrDataImport", ",", 
        "FacilityGivenExperiment"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"prod", ",", 
       RowBox[{"Select", "[", 
        RowBox[{"ProductionList", ",", 
         RowBox[{
          RowBox[{"#", "!=", "\"\<Bremsstrahlung\>\""}], "&"}]}], "]"}]}], 
      "}"}]}], "]"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Temporary", " ", "fix", " ", "for", " ", "ALPs", " ", "from", " ", 
    "mixing"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"SelectedExperiment", "==", "\"\<NuCal\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ELLPmax", "[", 
        RowBox[{"mfip_", ",", "\[Theta]fip_", ",", "prod"}], "]"}], "=", 
       "70."}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", 
        RowBox[{"Select", "[", 
         RowBox[{"ProductionList", ",", 
          RowBox[{
           RowBox[{"#", "!=", "\"\<Bremsstrahlung\>\""}], "&"}]}], "]"}]}], 
       "}"}]}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"SelectedExperiment", "==", "\"\<NA62-dump\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ELLPmax", "[", 
        RowBox[{"mfip_", ",", "\[Theta]fip_", ",", "prod"}], "]"}], "=", 
       "400."}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", 
        RowBox[{"Select", "[", 
         RowBox[{"ProductionList", ",", 
          RowBox[{
           RowBox[{"#", "!=", "\"\<Bremsstrahlung\>\""}], "&"}]}], "]"}]}], 
       "}"}]}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ptenergies", "=", 
   RowBox[{"LogLogPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"ELLPmax", "[", 
         RowBox[{"0.1", ",", "\[Theta]LLP", ",", "prod"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "]"}], ",", 
     
     RowBox[{"{", 
      RowBox[{"\[Theta]LLP", ",", "\[Theta]minExp", ",", "\[Theta]maxExp"}], 
      "}"}], ",", 
     RowBox[{"Frame", "->", "True"}], ",", 
     RowBox[{"ImageSize", "->", "Large"}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"Placed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"#", ",", "15"}], "]"}], "&"}], "/@", "ProductionList"}], 
        ",", "Right"}], "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ptprodprob", "=", 
   RowBox[{"LogLogPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"ProbLLP", "[", 
         RowBox[{"ma", ",", "1", ",", "prod"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "]"}], ",", 
     
     RowBox[{"{", 
      RowBox[{"ma", ",", "mmin\[Epsilon]", ",", "mmax\[Epsilon]"}], "}"}], 
     ",", 
     RowBox[{"Frame", "->", "True"}], ",", 
     RowBox[{"ImageSize", "->", "Large"}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"Placed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"#", ",", "15"}], "]"}], "&"}], "/@", "ProductionList"}], 
        ",", "Right"}], "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Style", "[", 
  RowBox[{
   RowBox[{"Row", "[", 
    RowBox[{"{", 
     RowBox[{"ptprodprob", ",", "ptenergies"}], "}"}], "]"}], ",", 
   RowBox[{"ImageSizeMultipliers", "->", 
    RowBox[{"{", 
     RowBox[{"1", ",", " ", "1"}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.9138264426995506`*^9, 3.9138265779867578`*^9}, {
   3.913826965658716*^9, 3.913827094252314*^9}, 3.913827173058236*^9, 
   3.913828072535197*^9, {3.9138685969328623`*^9, 3.9138686662515535`*^9}, {
   3.9138687097216063`*^9, 3.913868827467691*^9}, {3.913869908183678*^9, 
   3.913869908527342*^9}, {3.913870019764023*^9, 3.913870024259905*^9}, {
   3.913870742059718*^9, 3.913870786176013*^9}, {3.913871804452815*^9, 
   3.913871804457403*^9}, {3.9156429960123367`*^9, 3.915642996120566*^9}, 
   3.9162513252963047`*^9, {3.916287561155079*^9, 3.916287704198366*^9}, {
   3.916504616759512*^9, 3.916504623641607*^9}, {3.916505419246566*^9, 
   3.916505466772704*^9}, {3.91685666432423*^9, 3.9168566691319733`*^9}, 
   3.9181350149758773`*^9, {3.918144519640317*^9, 3.918144522278537*^9}, {
   3.918144627122503*^9, 3.9181446317609262`*^9}, {3.9181483956736984`*^9, 
   3.918148395992083*^9}, {3.918148503299447*^9, 3.9181485424475875`*^9}, {
   3.9181526023229294`*^9, 3.918152668767782*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[1525]:=",ExpressionUUID->"62819a8f-ef93-4611-8129-3022b4040630"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Number of events", "Chapter",
 CellChangeTimes->{{3.8935731783578434`*^9, 3.893573180246764*^9}},
 CellTags->
  "Number-of-events-computation+sensitivity",ExpressionUUID->"913a2300-dec2-\
4b0f-8b44-4b75cf0adccf"],

Cell[CellGroupData[{

Cell["Number of events - using the mapping method ", "Section",
 CellChangeTimes->{{3.897198873663946*^9, 3.8971988750678434`*^9}, 
   3.9165065585390453`*^9, 3.9165070655729046`*^9},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"c94998ff-f59b-\
459d-be1c-ddc73e99c9ae"],

Cell[CellGroupData[{

Cell["Initializing all routines", "Subsection",
 CellChangeTimes->{{3.897199076623907*^9, 3.8971990900052223`*^9}, {
   3.8972009084104066`*^9, 3.897200920680235*^9}, 3.916506561920749*^9, {
   3.9165071319109154`*^9, 3.916507136145134*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"7f579b6b-5ef4-\
4a58-9013-8c1dd56d76ec"],

Cell[BoxData[{
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"OutGrid\[Theta]final", "[", "prod", "]"}], ",", 
      RowBox[{"\[CapitalDelta]\[Theta]vals", "[", "prod", "]"}]}], "}"}], "=", 
    RowBox[{"OutGrid\[Theta]Temp", "[", 
     RowBox[{
     "InGrid\[Theta]\[Epsilon]", ",", "30", ",", "prod", ",", 
      "\[Theta]maxBrem"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"prod", ",", "ProductionList"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"OutGridzfinal", ",", "\[CapitalDelta]zvals"}], "}"}], "=", 
    RowBox[{"OutGridszTemp", "[", 
     RowBox[{"InGridz\[Epsilon]", ",", "30", ",", "zminExp"}], "]"}]}], ";"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Final", " ", "energy", " ", 
     RowBox[{"grid", ".", " ", "Mass"}]}], "-", " ", 
    RowBox[{"and", " ", "production", " ", "channel"}], "-", "dependent"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"FacilityGivenExperiment", "!=", "\"\<ESS\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"StepEtemp", "[", "Efip_", "]"}], "=", 
      RowBox[{"Piecewise", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.3", ",", 
           RowBox[{"Efip", "\[LessEqual]", "2.5"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.5", ",", 
           RowBox[{"2.5", "<", "Efip", "<", "35"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", 
           RowBox[{"35", "\[LessEqual]", "Efip", "\[LessEqual]", "50"}]}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", 
           RowBox[{"50", "<", "Efip", "<", "160"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"5", ",", 
           RowBox[{"160", "\[LessEqual]", "Efip", "<=", "400"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"25", ",", 
           RowBox[{"400", "<", "Efip", "<", "600"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"50", ",", 
           RowBox[{"600", "<=", "Efip", "<", "2000"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"200", ",", 
           RowBox[{"2000", "\[LessEqual]", "Efip", "<", "4000"}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"400", ",", 
           RowBox[{"4000", "\[LessEqual]", "Efip", "<", "7000"}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"500", ",", 
           RowBox[{
           "7000", "\[LessEqual]", "Efip", "\[LessEqual]", "50000"}]}], 
          "}"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"OutGridEnergy", "[", 
       RowBox[{"m_", ",", "ProdChannel_"}], "]"}], ":=", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"emin", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ProdChannel", "!=", "\"\<Bremsstrahlung\>\""}], ",", 
            RowBox[{"1.0", "m"}], ",", 
            RowBox[{"ELLPmin", "[", "\"\<Bremsstrahlung\>\"", "]"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"egridtemp", "=", 
          RowBox[{
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"start", "=", "emin"}], ",", 
               RowBox[{"end", "=", 
                RowBox[{"ELLPmax", "[", 
                 RowBox[{"m", ",", "\[Theta]minExp", ",", "ProdChannel"}], 
                 "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Log10", "[", 
              RowBox[{"NestWhileList", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "+", 
                  RowBox[{"StepEtemp", "[", "#", "]"}]}], "&"}], ",", "start",
                 ",", 
                RowBox[{
                 RowBox[{"#", "\[LessEqual]", "end"}], "&"}], ",", "1", ",", 
                "\[Infinity]", ",", 
                RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}], "//", "N"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "egridtemp", "]"}], "==", "1"}], ",", 
           RowBox[{"egridtemp", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"egridtemp", ",", 
              RowBox[{"{", 
               RowBox[{"Log10", "[", 
                RowBox[{"2", "*", "emin"}], "]"}], "}"}]}], "]"}]}]}], "]"}], 
         ";", "\[IndentingNewLine]", "egridtemp"}]}], "\[IndentingNewLine]", 
       "]"}]}]}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"StepEtemp", "[", "Efip_", "]"}], "=", "0.001"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"OutGridEnergy", "[", 
       RowBox[{"m_", ",", "ProdChannel_"}], "]"}], ":=", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tabt", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"e", ",", 
            RowBox[{"{", 
             RowBox[{"e", ",", 
              RowBox[{"1.0001", "m"}], ",", 
              RowBox[{"ELLPmax", "[", 
               RowBox[{"m", ",", "\[Theta]minExp", ",", "ProdChannel"}], 
               "]"}], ",", "0.001"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "tabt", "]"}], "==", "1"}], ",", 
           RowBox[{"tabt", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{"tabt", ",", 
                RowBox[{"{", 
                 RowBox[{"ELLPmax", "[", 
                  RowBox[{"m", ",", "\[Theta]minExp", ",", "ProdChannel"}], 
                  "]"}], "}"}]}], "]"}], "//", "Sort"}], "//", 
             "DeleteDuplicates"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Log10", "[", "tabt", "]"}], "//", "N"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}]}], "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Block", " ", "that", " ", "computes", " ", "the", " ", "grid", " ", 
     SubscriptBox["\[Theta]", "S"]}], ",", 
    SubscriptBox["E", "S"], ",", 
    SubscriptBox["z", "S"], ",", " ", 
    RowBox[{
     SubscriptBox["\[Epsilon]", "Full"], "\[Times]", 
     SubscriptBox["f", 
      RowBox[{
       SubscriptBox["\[Theta]", "S"], ",", 
       SubscriptBox["E", "S"]}]]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TableIntegrandDiscret", "[", 
   RowBox[{"m_", ",", "ProdChannel_", ",", "\[Epsilon]DecOp_"}], "]"}], ":=", 
  
  RowBox[{"TableIntegrandDiscretTemp", "[", 
   RowBox[{
   "m", ",", "ProdChannel", ",", "\[Epsilon]DecOp", ",", "\[Epsilon]vals", 
    ",", "\[Epsilon]azvals", ",", 
    RowBox[{"OutGrid\[Theta]final", "[", "ProdChannel", "]"}], ",", 
    "OutGridzfinal", ",", "OutGridEnergy", ",", "InGridm\[Epsilon]", ",", 
    "InGrid\[Theta]\[Epsilon]", ",", "InGridE\[Epsilon]", ",", 
    "InGridz\[Epsilon]", ",", 
    RowBox[{"\[CapitalDelta]\[Theta]vals", "[", "ProdChannel", "]"}], ",", 
    "\[CapitalDelta]zvals", ",", "zminExp", ",", "GridInFinal", ",", 
    "DistrVals", ",", "FacilityGivenExperiment"}], "]"}]}]}], "Input",
 CellChangeTimes->{
  3.914065400601883*^9, {3.914495591508691*^9, 3.914495605102999*^9}, {
   3.9144963994464293`*^9, 3.91449645003281*^9}, 3.915642996180926*^9, 
   3.916251406258167*^9, {3.916332203281742*^9, 3.9163322040420866`*^9}, {
   3.916332256159724*^9, 3.916332315776701*^9}, {3.916332682855117*^9, 
   3.916332697278437*^9}, {3.916332729581109*^9, 3.9163327827424316`*^9}, {
   3.916332995032469*^9, 3.916333041851855*^9}, {3.9163330893535175`*^9, 
   3.916333120115777*^9}, {3.916388303145535*^9, 3.916388309940223*^9}, {
   3.91639027241718*^9, 3.9163902725145645`*^9}, {3.916390440036625*^9, 
   3.9163904429286966`*^9}, {3.9163913725242844`*^9, 
   3.9163913900649643`*^9}, {3.916506011253288*^9, 3.9165060531405983`*^9}, {
   3.916506386454261*^9, 3.9165063916867723`*^9}, {3.916506437814754*^9, 
   3.916506440204628*^9}, {3.916506606348799*^9, 3.9165066068133373`*^9}, {
   3.916506770781*^9, 3.916506770986845*^9}, {3.916506818360832*^9, 
   3.916506834494148*^9}, {3.91650702210918*^9, 3.916507055596775*^9}, 
   3.9165070945532017`*^9, {3.9165072348013864`*^9, 3.916507258828418*^9}, {
   3.916508224380382*^9, 3.9165082246202826`*^9}, {3.9165089341902924`*^9, 
   3.9165089344447155`*^9}, {3.916677934815047*^9, 3.9166779370852003`*^9}, {
   3.916855304217818*^9, 3.916855311637482*^9}, {3.9168554155151453`*^9, 
   3.9168554199074984`*^9}, {3.918139174345289*^9, 3.9181392251320496`*^9}, {
   3.918139275836054*^9, 3.9181392855336113`*^9}, 3.9181438903751693`*^9},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[1539]:=",ExpressionUUID->"48950797-56e6-42de-8395-450c95505cf7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generalized acceptances", "Subsection",
 CellChangeTimes->{{3.9165071505021195`*^9, 3.916507153692098*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"44c5d7dc-f4d8-\
4683-af20-91145a2314a0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Tabulated", " ", "acceptance"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FactorANUBISceiling", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"SelectedExperiment", "==", "\"\<ANUBIS-ceiling\>\""}], ",", 
       "2", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AcceptanceDiscret", "[", 
     RowBox[{
     "m_", ",", "ProdChannel_", ",", "\[Epsilon]decOp_", ",", "decProb_"}], 
     "]"}], ":=", 
    RowBox[{"AcceptanceDiscretTemp", "[", 
     RowBox[{
     "m", ",", "ProdChannel", ",", "\[Epsilon]decOp", ",", "decProb", ",", 
      "mLLPmin", ",", "mmin\[Epsilon]", ",", "mLLPmax", ",", "mmax\[Epsilon]",
       ",", "ELLPmax", ",", "\[Theta]minExp", ",", "TableIntegrandDiscret", 
      ",", "BrVis", ",", "zmaxExp", ",", "zminExp", ",", 
      "FactorANUBISceiling", ",", "0."}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"mlistAcceptance", "[", "prod", "]"}], "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"m", ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", 
             RowBox[{"1.01", 
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{"mLLPmin", "[", "prod", "]"}], ",", 
                "mmin\[Epsilon]"}], "]"}]}], ",", 
             RowBox[{"0.95", 
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{"mLLPmax", "[", "prod", "]"}], ",", 
                "mmax\[Epsilon]"}], "]"}]}], ",", 
             RowBox[{"Min", "[", 
              RowBox[{
               FractionBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"0.95", 
                   RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"mLLPmax", "[", "prod", "]"}], ",", 
                    "mmax\[Epsilon]"}], "]"}]}], "-", 
                  RowBox[{"1.01", 
                   RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"mLLPmin", "[", "prod", "]"}], ",", 
                    "mmin\[Epsilon]"}], "]"}]}]}], ")"}], "20"], ",", "2"}], 
              "]"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.99", 
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"mLLPmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}], 
            "]"}]}], "}"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "=", 
         RowBox[{"ParallelTable", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"m", ",", 
             RowBox[{"AcceptanceDiscret", "[", 
              RowBox[{"m", ",", "prod", ",", "\"\<False\>\"", ",", "0"}], 
              "]"}], ",", 
             RowBox[{"AcceptanceDiscret", "[", 
              RowBox[{"m", ",", "prod", ",", "\"\<True\>\"", ",", "0"}], 
              "]"}], ",", 
             RowBox[{"AcceptanceDiscret", "[", 
              RowBox[{"m", ",", "prod", ",", "\"\<False\>\"", ",", "1"}], 
              "]"}], ",", 
             RowBox[{"AcceptanceDiscret", "[", 
              RowBox[{"m", ",", "prod", ",", "\"\<True\>\"", ",", "1"}], 
              "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", 
             RowBox[{"mlistAcceptance", "[", "prod", "]"}]}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Max", "[", 
                RowBox[{
                 RowBox[{"mLLPmin", "[", "prod", "]"}], ",", 
                 "mmin\[Epsilon]"}], "]"}], "}"}], ",", 
              RowBox[{"Drop", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}]}], "]"}], 
            "}"}], ",", 
           RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Min", "[", 
                RowBox[{
                 RowBox[{"mLLPmax", "[", "prod", "]"}], ",", 
                 "mmax\[Epsilon]"}], "]"}], "}"}], ",", 
              RowBox[{"Drop", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "1"}], "]"}], "]"}], ",", "1"}], "]"}]}], 
             "]"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";"}], "//", 
    "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PlotAcc", "[", "ProdChannel_", "]"}], ":=", 
    RowBox[{"ListLogPlot", "[", 
     RowBox[{
      RowBox[{"Evaluate", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "4"}], "}"}]}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "5"}], "}"}]}], "]"}], "]"}]}], "}"}], "]"}], 
      ",", 
      RowBox[{"FrameStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", " ", "22"}], "]"}]}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Blue"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
           RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
           RowBox[{"Darker", "@", 
            RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Black"}], "}"}]}], 
        "}"}]}], ",", 
      RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"MinMax", "[", 
          RowBox[{
           RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"0.9", 
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{"Min", "[", 
                 RowBox[{
                  RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], 
                  "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}], ",", 
                RowBox[{"Min", "[", 
                 RowBox[{
                  RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], 
                  "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}], "]"}]}], 
             ",", 
             SuperscriptBox["10", 
              RowBox[{"-", "5"}]]}], "]"}], ",", 
           RowBox[{"1.1", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
                
                RowBox[{"[", 
                 RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
                
                RowBox[{"[", 
                 RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}]}], "]"}]}]}], 
          "}"}]}], "}"}]}], ",", 
      RowBox[{"Joined", "\[Rule]", "True"}], ",", 
      RowBox[{"Frame", "\[Rule]", "True"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<m [GeV]\>\"", ",", "\"\<Acceptance\>\""}], "}"}]}], ",", 
      
      RowBox[{"PlotLabel", "\[Rule]", " ", 
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"Row", "[", 
          RowBox[{"{", 
           RowBox[{"\"\<From \>\"", ",", "ProdChannel"}], "}"}], "]"}], ",", 
         " ", "20", ",", " ", "Black"}], "]"}]}], ",", 
      RowBox[{"PlotLegends", "\[Rule]", 
       RowBox[{"Placed", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"#", ",", " ", "18"}], "]"}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{
            "\"\<<\!\(\*SubscriptBox[\(\[Epsilon]\), \(LLP\)]\)>\>\"", ",", 
             "\"\<<\!\(\*SubscriptBox[\(\[Epsilon]\), \
\(LLP\)]\)\!\(\*SubscriptBox[\(\[Epsilon]\), \(decay\)]\)>\>\"", ",", 
             "\"\<c\[Tau]<\!\(\*SubscriptBox[\(\[Epsilon]\), \
\(LLP\)]\)\!\(\*SubscriptBox[\(P\), \(decay\)]\)>\>\"", ",", 
             "\"\<c\[Tau]<\!\(\*SubscriptBox[\(\[Epsilon]\), \
\(LLP\)]\)\!\(\*SubscriptBox[\(P\), \(decay\)]\)\!\(\*SubscriptBox[\(\
\[Epsilon]\), \(decay\)]\)>\>\""}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.75", ",", "0.2"}], "}"}]}], "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"Style", "[", 
    RowBox[{
     RowBox[{"Row", "[", 
      RowBox[{"Evaluate", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"PlotAcc", "[", "prod", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "]"}], 
      "]"}], ",", 
     RowBox[{"ImageSizeMultipliers", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"FilenameAcceptance", "[", "prod", "]"}], "=", 
        RowBox[{"ToString", "@", 
         RowBox[{"StringForm", "[", 
          RowBox[{"\"\<Acceptance_ALP-fermion_at_``_From_``.dat\>\"", ",", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"{", 
             RowBox[{"SelectedExperiment", ",", 
              RowBox[{"ExportList", "[", "prod", "]"}]}], "}"}]}]}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], ",", 
            "\"\<Auxiliary data/ALPs with fermion coupling\>\"", ",", 
            "SelectedExperiment", ",", 
            RowBox[{"FilenameAcceptance", "[", "prod", "]"}]}], "}"}], "]"}], 
         ",", 
         RowBox[{
          RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", "4", ",", "5"}], "}"}]}], "]"}], 
          "]"}], ",", "\"\<Table\>\""}], "]"}]}], "\[IndentingNewLine]", ",", 
      
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AccAveraged", "[", 
      RowBox[{"mLLP_", ",", "c\[Tau]_"}], "]"}], "=", 
     RowBox[{"NpotGivenExperiment", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"mLLPmin", "[", "prod", "]"}], "<", "mLLP", "<", 
             RowBox[{"mLLPmax", "[", "prod", "]"}]}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"ProbLLP", "[", 
              RowBox[{"mLLP", ",", "1", ",", "prod"}], "]"}], "]"}], ",", 
            "0"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ",", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"mLLPmin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}],
               "]"}], "<", "mLLP", "<", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"mLLPmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}],
               "]"}]}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{
              RowBox[{"ProbLLP", "[", 
               RowBox[{"mLLP", ",", "1", ",", "prod"}], "]"}], "*", 
              RowBox[{
               RowBox[{"Interpolation", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
                 RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[",
                "mLLP", "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ",", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"mLLPmin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}],
               "]"}], "<", "mLLP", "<", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"mLLPmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}],
               "]"}]}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{
              FractionBox[
               RowBox[{"ProbLLP", "[", 
                RowBox[{"mLLP", ",", "1", ",", "prod"}], "]"}], "c\[Tau]"], 
              "*", 
              RowBox[{
               RowBox[{"Interpolation", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "4"}], "}"}]}], "]"}], "]"}], ",", 
                 RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[",
                "mLLP", "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ",", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"mLLPmin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}],
               "]"}], "<", "mLLP", "<", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"mLLPmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}],
               "]"}]}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{
              FractionBox[
               RowBox[{"ProbLLP", "[", 
                RowBox[{"mLLP", ",", "1", ",", "prod"}], "]"}], "c\[Tau]"], 
              "*", 
              RowBox[{
               RowBox[{"Interpolation", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "5"}], "}"}]}], "]"}], "]"}], ",", 
                 RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[",
                "mLLP", "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}]}], 
       "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"directory", "[", "\"\<Auxiliary-experiment\>\"", "]"}], ",", 
         RowBox[{
         "\"\<AcceptanceAveraged-\>\"", "<>", "LLPdirName", "<>", 
          "\"\<.m\>\""}]}], "}"}], "]"}], ",", 
      RowBox[{"AccAveraged", "[", 
       RowBox[{"mLLP", ",", "c\[Tau]"}], "]"}], ",", "\"\<MX\>\""}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9165072608467913`*^9, 3.91650727179105*^9}, {
  3.916511834115503*^9, 3.916511970448192*^9}, {3.916671279810882*^9, 
  3.9166712821254025`*^9}, {3.918145811241404*^9, 3.918145811814251*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[1543]:=",ExpressionUUID->"12dd6420-8c42-4806-b7fe-f40c3a254e24"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Rough estimates of the upper and lower bounds", "Subsection",
 CellChangeTimes->{{3.885032806692847*^9, 3.8850328135228024`*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"5711c196-5f6f-\
42a6-9eb3-4b39f13fa8ea"],

Cell[CellGroupData[{

Cell["Definitions", "Subsubsection",
 CellChangeTimes->{{3.877676708463168*^9, 3.877676711193803*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"54d39439-f77a-\
4f87-9127-6cea0da2e472"],

Cell[BoxData[{
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"LowerBoundEstimate", "[", 
      RowBox[{"mLLP_", ",", "prod"}], "]"}], "=", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox[
        RowBox[{"NpotGivenExperiment", "*", 
         RowBox[{"ProbLLP", "[", 
          RowBox[{"mLLP", ",", "1", ",", "prod"}], "]"}], "*", 
         RowBox[{
          RowBox[{"Interpolation", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "5"}], "}"}]}], "]"}], "]"}], ",", 
            RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
          "mLLP", "]"}]}], 
        RowBox[{"2.3", 
         RowBox[{"ldecayLLP", "[", 
          RowBox[{"mLLP", ",", "1", ",", "ELLP"}], "]"}], 
         FractionBox["mLLP", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["ELLP", "2"], "-", 
            SuperscriptBox["mLLP", "2"]}]]]}]], ")"}], 
      RowBox[{"-", 
       FractionBox["1", "4"]}]]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"UpperBoundEstimate", "[", 
      RowBox[{"mLLP_", ",", "prod"}], "]"}], "=", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"Abs", "[", 
        RowBox[{"Re", "[", 
         RowBox[{"Evaluate", "[", 
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             RowBox[{"ProductLog", "[", 
              RowBox[{
               RowBox[{"-", "1"}], ",", 
               RowBox[{
                RowBox[{"-", "2.3"}], "*", 
                FractionBox["b", "a"]}]}], "]"}], "b"]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a", "\[Rule]", " ", 
              RowBox[{"NpotGivenExperiment", "*", 
               RowBox[{"ProbLLP", "[", 
                RowBox[{"mLLP", ",", "1", ",", "prod"}], "]"}], "*", 
               RowBox[{
                RowBox[{"Interpolation", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
                  RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], 
                "[", "mLLP", "]"}]}]}], ",", 
             RowBox[{"b", "\[Rule]", 
              FractionBox["zminExp", 
               RowBox[{"ldecayLLP", "[", 
                RowBox[{"mLLP", ",", "1", ",", 
                 RowBox[{"ELLPmax", "[", 
                  RowBox[{"0.5", ",", "\[Theta]minExp", ",", "prod"}], 
                  "]"}]}], "]"}]]}]}], "}"}]}], "]"}], "]"}], "]"}], ")"}], 
      FractionBox["1", "2"]]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"prod", ",", "ProductionList"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProdTest", "=", 
   RowBox[{"ProductionList", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogLogPlot", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"0.3", 
       RowBox[{"LowerBoundEstimate", "[", 
        RowBox[{"mLLP", ",", "ProdTest"}], "]"}]}], ",", 
      RowBox[{"1.8", 
       RowBox[{"UpperBoundEstimate", "[", 
        RowBox[{"mLLP", ",", "ProdTest"}], "]"}]}]}], "}"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"mLLP", ",", 
     RowBox[{"Max", "[", 
      RowBox[{
       RowBox[{"mLLPmin", "[", "ProdTest", "]"}], ",", "mmin\[Epsilon]"}], 
      "]"}], ",", 
     RowBox[{"Min", "[", 
      RowBox[{
       RowBox[{"mLLPmax", "[", "ProdTest", "]"}], ",", "mmax\[Epsilon]"}], 
      "]"}]}], "}"}], ",", 
   RowBox[{"Frame", "->", "True"}], ",", 
   RowBox[{"ImageSize", "->", "Large"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8927045521296835`*^9, 3.892704618398532*^9}, {
   3.892704651576499*^9, 3.892704652867281*^9}, 3.895129246639157*^9, {
   3.897206454751242*^9, 3.897206454844119*^9}, {3.8972065272743893`*^9, 
   3.8972065273639555`*^9}, {3.897208556347765*^9, 3.8972085563922853`*^9}, {
   3.897208642634513*^9, 3.897208654173244*^9}, {3.897232414966792*^9, 
   3.897232417587074*^9}, {3.897232987699747*^9, 3.897233009729268*^9}, {
   3.897233322436949*^9, 3.8972333287617497`*^9}, 3.897233684153979*^9, {
   3.897234006941648*^9, 3.897234007169805*^9}, {3.897234114920539*^9, 
   3.8972341194170074`*^9}, {3.9027273710668883`*^9, 3.902727371070483*^9}, {
   3.9037896747950044`*^9, 3.903789674805071*^9}, {3.903791118363947*^9, 
   3.903791118368486*^9}, {3.903793681320034*^9, 3.903793682290308*^9}, {
   3.904923151729263*^9, 3.904923157976531*^9}, {3.9049231902009006`*^9, 
   3.904923190656528*^9}, 3.904926376200742*^9, {3.911027289230471*^9, 
   3.9110273124658933`*^9}, {3.9110277505648003`*^9, 3.911027764091008*^9}, 
   3.913866752239462*^9, {3.913867551646231*^9, 3.9138675637833986`*^9}, {
   3.913868221247493*^9, 3.913868221253111*^9}, {3.913869043976644*^9, 
   3.913869043981699*^9}, {3.9138691384932804`*^9, 3.913869147288597*^9}, {
   3.913869202156701*^9, 3.913869205518555*^9}, {3.913869239652417*^9, 
   3.9138692400334797`*^9}, {3.913869474546574*^9, 3.913869474546574*^9}, {
   3.913870429970599*^9, 3.913870442530464*^9}, {3.913874413597405*^9, 
   3.913874414587882*^9}, {3.9156429963777804`*^9, 3.915642996428277*^9}, {
   3.916391759919177*^9, 3.916391773937995*^9}, {3.916512010716703*^9, 
   3.916512030283941*^9}, {3.918144871425367*^9, 3.918144874611933*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[1551]:=",ExpressionUUID->"fe30cfbc-c6a5-4446-91f9-40458edebe07"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Number of events - fast", "Subsection",
 CellChangeTimes->{{3.897206442190997*^9, 3.8972064427846107`*^9}, {
  3.905840324777521*^9, 3.905840328994842*^9}},
 CellTags->{
  "Number-of-events-computation+sensitivity", 
   "Acceptance-computation"},ExpressionUUID->"b8339207-1749-4c68-88c0-\
88356257de98"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FactorLowerBound", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\"\<ANUBIS-shaft-volume-1\>\"", ",", 
          "\"\<ANUBIS-shaft-volume-2\>\"", ",", 
          "\"\<ANUBIS-shaft-volume-3\>\""}], "}"}], ",", 
        "SelectedExperiment"}], "]"}], "==", "True"}], ",", "0.1", ",", 
     "0.3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NeventsDiscret", "[", 
   RowBox[{"m_", ",", "ProdChannel_", ",", "couplinglist_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"NevDiscret", ",", "NpotTimes\[Chi]val", ",", "zshift"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"mLLPmin", "[", "ProdChannel", "]"}], ",", 
         "mmin\[Epsilon]"}], "]"}], "<", "m", "<", 
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"mLLPmax", "[", "ProdChannel", "]"}], ",", 
         "mmax\[Epsilon]"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"integrandtab", "=", 
        RowBox[{"TableIntegrandDiscret", "[", 
         RowBox[{"m", ",", "ProdChannel", ",", "\"\<True\>\""}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NpotTimes\[Chi]val", "[", "coupling_", "]"}], "=", 
        RowBox[{"NpotGivenExperiment", "*", 
         RowBox[{"ProbLLP", "[", 
          RowBox[{"m", ",", "coupling", ",", "ProdChannel"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"lowerbound", ",", "upperbound"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"LowerBoundEstimate", "[", 
           RowBox[{"m", ",", "ProdChannel"}], "]"}], ",", 
          RowBox[{"UpperBoundEstimate", "[", 
           RowBox[{"m", ",", "ProdChannel"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"brvis", "=", 
        RowBox[{"BrVis", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NevDiscret", "[", "coupling_", "]"}], ":=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"0.1", "lowerbound"}], "<", "coupling", "<", 
           RowBox[{"(*", "1.5", "*)"}], 
           RowBox[{"2", "upperbound"}]}], ",", 
          RowBox[{
           RowBox[{"NpotTimes\[Chi]val", "[", "coupling", "]"}], "*", "brvis",
            "*", 
           RowBox[{"sumcompile", "[", 
            RowBox[{"tableprefac", "[", 
             RowBox[{"integrandtab", ",", "m", ",", 
              RowBox[{"c\[Tau]LLP", "[", 
               RowBox[{"m", ",", "coupling"}], "]"}], ",", "1", ",", "0."}], 
             "]"}], "]"}]}], ",", "0."}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"m", ",", 
           RowBox[{"couplinglist", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"NevDiscret", "[", 
            RowBox[{"couplinglist", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "couplinglist", "]"}], ",", "1"}], "}"}]}], 
        "]"}]}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"m", ",", 
          RowBox[{"couplinglist", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "0."}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "couplinglist", "]"}], ",", "1"}], "}"}]}], 
       "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.897200964730176*^9, 3.897200965970766*^9}, {
   3.89720118259857*^9, 3.897201187086811*^9}, {3.89720124339168*^9, 
   3.8972012434804716`*^9}, {3.897202110908011*^9, 3.897202111357911*^9}, {
   3.897205130000824*^9, 3.8972051305748825`*^9}, 3.897206599004672*^9, {
   3.897208544505431*^9, 3.8972085493226857`*^9}, {3.897208729717713*^9, 
   3.897208782995672*^9}, {3.897232355754225*^9, 3.897232355758215*^9}, {
   3.897232520888267*^9, 3.897232579312927*^9}, {3.897233018363705*^9, 
   3.8972330186824374`*^9}, {3.8972330557477093`*^9, 
   3.8972330786629734`*^9}, {3.897233188587227*^9, 3.897233189274019*^9}, {
   3.897233372953797*^9, 3.8972334102237387`*^9}, {3.897233632248149*^9, 
   3.897233706831365*^9}, {3.897233770343194*^9, 3.897233794850586*^9}, {
   3.897234027583762*^9, 3.897234039222018*^9}, 3.902727371095085*^9, {
   3.903789674824919*^9, 3.9037896748651905`*^9}, {3.903790316364489*^9, 
   3.903790327604648*^9}, 3.903791118373599*^9, {3.903793681334241*^9, 
   3.903793681337234*^9}, {3.903793815495824*^9, 3.9037938405670395`*^9}, {
   3.9110273360582476`*^9, 3.911027382154455*^9}, {3.9110275909078875`*^9, 
   3.9110276162959757`*^9}, {3.911027735769429*^9, 3.911027736051933*^9}, {
   3.91102782490703*^9, 3.9110278664472694`*^9}, {3.911027908345337*^9, 
   3.9110279086712365`*^9}, 3.913867583368688*^9, {3.9138687734466343`*^9, 
   3.913868778336495*^9}, 3.913869043987434*^9, {3.91386913849867*^9, 
   3.91386914700126*^9}, {3.9138718044634438`*^9, 3.9138718044763336`*^9}, {
   3.913874426589578*^9, 3.9138744439740767`*^9}, {3.915642996438535*^9, 
   3.9156429964465065`*^9}, {3.916646396767962*^9, 3.916646476602578*^9}, {
   3.916671314097481*^9, 3.916671356416057*^9}, {3.9166714366048737`*^9, 
   3.916671443926481*^9}, 3.916679251809806*^9},
 CellTags->{
  "Number-of-events-computation+sensitivity", "Acceptance-computation"},
 CellLabel->
  "In[1554]:=",ExpressionUUID->"071a453e-c563-482b-9648-d4047b0165a9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Number of events - slow (using built-in Mathematica functions Interpolation, \
NIntegrate)\
\>", "Subsection",
 CellChangeTimes->{{3.916673042143861*^9, 3.916673050136638*^9}},
 CellTags->{
  "Number-of-events-computation+sensitivity", 
   "Acceptance-computation"},ExpressionUUID->"6bf34b32-d93c-4cd2-aff7-\
0161ce769f26"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Differential", " ", "decay", " ", "probability", " ", 
     FractionBox["1", "ldecay"], 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "l"}], "/", "ldecay"}], "]"}]}], ",", " ", 
    RowBox[{
    "where", " ", "l", " ", "is", " ", "expressed", " ", "in", " ", "terms", 
     " ", "of", " ", "the", " ", "longitudinal", " ", "displacement", " ", 
     "z", " ", "and", " ", "polar", " ", "angle", " ", "\[Theta]", " ", "as", 
     " ", 
     RowBox[{"z", "/", "cos\[Theta]"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Differential", " ", "decay", " ", "probability", " ", 
     RowBox[{"(", 
      RowBox[{"1", "/", "ldecay"}], ")"}], 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "l"}], "/", "ldecay"}], "]"}]}], ",", " ", 
    RowBox[{
    "where", " ", "l", " ", "is", " ", "expressed", " ", "in", " ", "terms", 
     " ", "of", " ", "the", " ", "longitudinal", " ", "displacement", " ", 
     "z", " ", "and", " ", "polar", " ", "angle", " ", "\[Theta]", " ", "as", 
     " ", 
     RowBox[{"z", "/", "cos\[Theta]"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"PdecayDensity", "[", 
      RowBox[{
      "mLLP_", ",", "coupling_", ",", "\[Theta]LLP_", ",", "ELLP_", ",", 
       "zLLP_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "zLLP"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]LLP", "]"}], "*", 
          RowBox[{"ldecayLLP", "[", 
           RowBox[{"mLLP", ",", "coupling", ",", "ELLP"}], "]"}]}], ")"}]}], 
       "]"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"Cos", "[", "\[Theta]LLP", "]"}], "]"}], "*", 
        RowBox[{"ldecayLLP", "[", 
         RowBox[{"mLLP", ",", "coupling", ",", "ELLP"}], "]"}]}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "The", " ", "integrand", " ", "determining", " ", "the", " ", 
     "differential", " ", "rate", " ", "for", " ", "events"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"IntegrandLLP", "[", 
       RowBox[{
       "mLLP_", ",", "coupling_", ",", "\[Theta]LLP_", ",", "ELLP_", ",", 
        "zLLP_", ",", "prod"}], "]"}], "=", 
      RowBox[{
       RowBox[{"DoubleDistrLLPint", "[", 
        RowBox[{"mLLP", ",", "\[Theta]LLP", ",", "ELLP", ",", "prod"}], "]"}],
        "*", 
       RowBox[{"PdecayDensity", "[", 
        RowBox[{
        "mLLP", ",", "coupling", ",", "\[Theta]LLP", ",", "ELLP", ",", 
         "zLLP"}], "]"}], "*", 
       RowBox[{"AzimuthalAcceptanceInt", "[", 
        RowBox[{"\[Theta]LLP", ",", "zLLP"}], "]"}], "*", 
       RowBox[{"DecayAcceptanceInt", "[", 
        RowBox[{"mLLP", ",", "\[Theta]LLP", ",", "ELLP", ",", "zLLP"}], 
        "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IntegralLLP", "[", 
     RowBox[{"mLLP_", ",", "coupling_", ",", "ProdChannel_"}], "]"}], ":=", 
    RowBox[{"NIntegrate", "[", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"IntegrandLLP", "[", 
         RowBox[{"mLLP", ",", "coupling", ",", "\[Theta]LLP", ",", 
          RowBox[{"Exp", "[", "ELLP", "]"}], ",", "zLLP", ",", 
          "ProdChannel"}], "]"}], 
        RowBox[{"Exp", "[", "ELLP", "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]LLP", ",", "\[Theta]minExp", ",", "\[Theta]maxExp"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ELLP", ",", 
        RowBox[{"Log", "[", "mLLP", "]"}], ",", 
        RowBox[{"Log", "[", 
         RowBox[{"ELLPmax", "[", 
          RowBox[{"mLLP", ",", "\[Theta]LLP", ",", "ProdChannel"}], "]"}], 
         "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"zLLP", ",", 
        RowBox[{"zmin\[Theta]", "[", "\[Theta]LLP", "]"}], ",", 
        RowBox[{"zmax\[Theta]", "[", "\[Theta]LLP", "]"}]}], "}"}], ",", 
      RowBox[{"Method", "\[Rule]", "\"\<AdaptiveMonteCarlo\>\""}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"IntegralLLP", "[", 
      RowBox[{"mLLP_", ",", "finv_", ",", "ProdChannel_"}], "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"IntegrandLLP", "[", 
          RowBox[{"mLLP", ",", "finv", ",", 
           RowBox[{"Exp", "[", "\[Theta]LLP", "]"}], ",", 
           RowBox[{"Exp", "[", "ELLP", "]"}], ",", 
           RowBox[{"Exp", "[", "zLLP", "]"}], ",", "ProdChannel"}], "]"}], 
         "]"}], 
        RowBox[{"Exp", "[", 
         RowBox[{"\[Theta]LLP", "+", "ELLP", "+", "zLLP"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]LLP", ",", 
         RowBox[{"Log", "[", "\[Theta]minExp", "]"}], ",", 
         RowBox[{"Log", "[", "\[Theta]maxExp", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ELLP", ",", 
         RowBox[{"Log", "[", "mLLP", "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"ELLPmax", "[", 
           RowBox[{"mLLP", ",", 
            RowBox[{"Exp", "[", "\[Theta]LLP", "]"}], ",", "ProdChannel"}], 
           "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"zLLP", ",", 
         RowBox[{"Log", "[", 
          RowBox[{"zmin\[Theta]", "[", 
           RowBox[{"Exp", "[", "\[Theta]LLP", "]"}], "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"zmax\[Theta]", "[", 
           RowBox[{"Exp", "[", "\[Theta]LLP", "]"}], "]"}], "]"}]}], "}"}], 
       ",", 
       RowBox[{"Method", "\[Rule]", "\"\<AdaptiveMonteCarlo\>\""}]}], "]"}]}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NeventsInt", "[", 
     RowBox[{"mLLP_", ",", "coupling_", ",", "ProdChannel_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"mLLPmin", "[", "ProdChannel", "]"}], "\[LessEqual]", "mLLP", 
        "\[LessEqual]", 
        RowBox[{"mLLPmax", "[", "ProdChannel", "]"}]}], "&&", 
       RowBox[{
        RowBox[{"BrVis", "[", "mLLP", "]"}], "!=", "0"}]}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"0.1", 
          RowBox[{"LowerBoundEstimate", "[", 
           RowBox[{"mLLP", ",", "ProdChannel"}], "]"}]}], "<", "coupling", 
         "<", 
         RowBox[{"2", 
          RowBox[{"UpperBoundEstimate", "[", 
           RowBox[{"mLLP", ",", "ProdChannel"}], "]"}]}]}], ",", 
        RowBox[{"NpotGivenExperiment", "*", 
         RowBox[{"ProbLLP", "[", 
          RowBox[{"mLLP", ",", "coupling", ",", "ProdChannel"}], "]"}], "*", 
         RowBox[{"IntegralLLP", "[", 
          RowBox[{"mLLP", ",", "coupling", ",", "ProdChannel"}], "]"}]}], ",",
         "0."}], "]"}], ",", "0."}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IntegralLLPE", "[", 
     RowBox[{"mLLP_", ",", "coupling_", ",", "ProdChannel_", ",", "ELLP_"}], 
     "]"}], ":=", 
    RowBox[{"NIntegrate", "[", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"IntegrandLLP", "[", 
        RowBox[{
        "mLLP", ",", "coupling", ",", "\[Theta]LLP", ",", "ELLP", ",", "zLLP",
          ",", "ProdChannel"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]LLP", ",", "\[Theta]minExp", ",", "\[Theta]maxExp"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"zLLP", ",", 
        RowBox[{"zmin\[Theta]", "[", "\[Theta]LLP", "]"}], ",", 
        RowBox[{"zmax\[Theta]", "[", "\[Theta]LLP", "]"}]}], "}"}], ",", 
      RowBox[{"Method", "\[Rule]", "\"\<AdaptiveMonteCarlo\>\""}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NeventsDiffInt", "[", 
     RowBox[{"mLLP_", ",", "coupling_", ",", "ProdChannel_", ",", "ELLP_"}], 
     "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"mLLPmin", "[", "ProdChannel", "]"}], "\[LessEqual]", "mLLP", 
        "\[LessEqual]", 
        RowBox[{"mLLPmax", "[", "ProdChannel", "]"}]}], "&&", 
       RowBox[{
        RowBox[{"BrVis", "[", "mLLP", "]"}], "!=", "0"}], "&&", 
       RowBox[{"mLLP", "<", "ELLP", "<=", 
        RowBox[{"ELLPmax", "[", 
         RowBox[{"mLLP", ",", "\[Theta]minExp", ",", "ProdChannel"}], 
         "]"}]}]}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"0.1", 
          RowBox[{"LowerBoundEstimate", "[", 
           RowBox[{"mLLP", ",", "ProdChannel"}], "]"}]}], "<", "coupling", 
         "<", 
         RowBox[{"2", 
          RowBox[{"UpperBoundEstimate", "[", 
           RowBox[{"mLLP", ",", "ProdChannel"}], "]"}]}]}], ",", 
        RowBox[{"NpotGivenExperiment", "*", 
         RowBox[{"ProbLLP", "[", 
          RowBox[{"mLLP", ",", "coupling", ",", "ProdChannel"}], "]"}], "*", 
         RowBox[{"IntegralLLPE", "[", 
          RowBox[{"mLLP", ",", "coupling", ",", "ProdChannel", ",", "ELLP"}], 
          "]"}]}], ",", "0."}], "]"}], ",", "0."}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.918145989523658*^9, 3.918145989807642*^9}},
 CellTags->{
  "Number-of-events-computation+sensitivity", "Acceptance-computation"},
 CellLabel->
  "In[1556]:=",ExpressionUUID->"242885b3-5b9f-46f1-af82-c6520d0e3109"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tests", "Section",
 CellChangeTimes->{{3.897201273610954*^9, 3.897201275449023*^9}, {
  3.916507477177098*^9, 3.916507477391102*^9}, {3.916679238462612*^9, 
  3.9166792396390905`*^9}},
 CellTags->
  "Number-of-events-computation+sensitivity",ExpressionUUID->"167f2e29-d8ac-\
4d05-ba40-dc1f6e10be8e"],

Cell[CellGroupData[{

Cell["Total number of events", "Subsection",
 CellChangeTimes->{{3.9165075006155853`*^9, 3.9165075011995907`*^9}, {
  3.9166792414258637`*^9, 3.916679244197138*^9}},
 CellTags->
  "Number-of-events-computation+sensitivity",ExpressionUUID->"f24bf8ca-a4fe-\
4caa-91a9-196241966aee"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "This", " ", "is", " ", "a", " ", "comparison", " ", "between", " ", 
     "the", " ", "slow", " ", "and", " ", "fast", " ", "integration", " ", 
     RowBox[{"methods", ".", " ", "For"}], " ", "the", " ", "selected", " ", 
     "mass", " ", "and", " ", "production", " ", "channel"}], ",", " ", 
    RowBox[{
    "the", " ", "numbers", " ", "of", " ", "events", " ", "obtained", " ", 
     "using", " ", "the", " ", "methods", " ", "should", " ", "agree", " ", 
     "within", " ", "10", "%"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"If", " ", "the", " ", "agreement", " ", "is", " ", "worse"}], 
    ",", " ", 
    RowBox[{
    "there", " ", "may", " ", "be", " ", "a", " ", "few", " ", "reasons"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"1", ")"}], " ", "The", " ", "grid", " ", "for", " ", "the", " ",
      "fast", " ", "method", " ", "is", " ", "not", " ", "dense", " ", 
     RowBox[{"enough", ".", " ", "Try"}], " ", "to", " ", "increase", " ", 
     "the", " ", "grid", " ", "density", " ", 
     RowBox[{"(", 
      RowBox[{
      "OutGrid\[Theta]final", ",", " ", "OutGridEfinal", ",", " ", 
       "OutGridzfinal"}], ")"}], " ", "to", " ", "see", " ", "whether", " ", 
     "the", " ", "agreement", " ", 
     RowBox[{"improves", ".", " ", "Sometimes"}]}], ",", " ", 
    RowBox[{
    "even", " ", "a", " ", "slightly", " ", "denser", " ", "grid", " ", "for",
      " ", 
     RowBox[{"e", ".", "g", ".", " ", "z"}], " ", "may", " ", "lead", " ", 
     "to", " ", "a", " ", "significant", " ", "improvement", " ", "in", " ", 
     "the", " ", "agrement"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"2", ")"}], " ", "The", " ", "Monte"}], "-", 
      RowBox[{
      "Carlo", " ", "integrator", " ", "for", " ", "the", " ", "slow", " ", 
       "method", " ", "fails", " ", "to", " ", "evaluate", " ", 
       "properly"}]}], ";", " ", 
     RowBox[{
     "this", " ", "may", " ", "happen", " ", "if", " ", "the", " ", "range", 
      " ", "of", " ", "the", " ", "integration", " ", "over", " ", "energies",
       " ", "is", " ", "too", " ", "large", " ", "compared", " ", "to", " ", 
      "the", " ", "domain", " ", "where", " ", "most", " ", "of", " ", "the", 
      " ", "events", " ", "actually", " ", "are", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"off", "-", 
         RowBox[{
         "axis", " ", "experiments", " ", "such", " ", "as", " ", "MATHUSLA", 
          " ", "and", " ", "ANUBIS"}]}], ")"}], ".", " ", "Another"}], " ", 
      "symptom", " ", "is", " ", "that", " ", "for", " ", "the", " ", "given",
       " ", "mass", " ", "and", " ", "coupling", " ", "the", " ", "integral", 
      " ", "\"\<jumps\>\""}]}], ",", " ", 
    RowBox[{"i", ".", "e", "."}], ",", " ", 
    RowBox[{
    "returns", " ", "values", " ", "with", " ", "large", " ", "error"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "A", " ", "separate", " ", "discussion", " ", "should", " ", "be", " ", 
     "made", " ", "for", " ", "the", " ", "couplings", " ", "belong", " ", 
     "to", " ", "the", " ", "domain", " ", "c\[Tau]", " ", "\[Gamma]", " ", 
     RowBox[{
      RowBox[{"<<", " ", 
       SubscriptBox["z", "experiment"]}], ".", " ", "The"}], " ", 
     "discrepancy", " ", "may", " ", "be", " ", "significant"}], ",", " ", 
    RowBox[{
    "and", " ", "the", " ", "reason", " ", "is", " ", "insufficient", " ", 
     "grid", " ", "density", " ", "for", " ", "the", " ", "fast", " ", 
     "integration", " ", 
     RowBox[{"method", ".", " ", "However"}]}], ",", " ", 
    RowBox[{
    "due", " ", "to", " ", "the", " ", "exponential", " ", "suppression", " ",
      "of", " ", "the", " ", "number", " ", "of", " ", "events"}], ",", " ", 
    RowBox[{
    "this", " ", "may", " ", "be", " ", "compensated", " ", "by", " ", "a", 
     " ", "tiny", " ", "shift", " ", "in", " ", "the", " ", "coupling"}], ",",
     " ", 
    RowBox[{
    "so", " ", "the", " ", "discrepancy", " ", "should", " ", "be", " ", 
     "considered", " ", "as", " ", 
     RowBox[{"appropriate", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ProdTest", "=", 
    RowBox[{"ProductionList", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"mtest", "=", 
    RowBox[{"RandomReal", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"mmin\[Epsilon]", ",", 
         RowBox[{"mLLPmin", "[", "ProdTest", "]"}]}], "]"}], ",", 
       RowBox[{"Min", "[", 
        RowBox[{"mmax\[Epsilon]", ",", 
         RowBox[{"mLLPmax", "[", "ProdTest", "]"}]}], "]"}]}], "}"}], "]"}]}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"couplinglist", "=", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["10", 
          RowBox[{"-", "12"}]], ",", 
         RowBox[{"3", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "12"}]]}], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "12"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "11"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "11"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "10"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "10"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "9"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "9"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "8"}]], ",", 
         RowBox[{"2", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "8"}]]}], ",", 
         RowBox[{"4", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "8"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "7"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"6", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"7", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"8", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"9", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "6"}]], ",", 
         RowBox[{"2", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "6"}]]}]}], "}"}], "//", "N"}], "*)"}], 
     RowBox[{"Table", "[", 
      RowBox[{
       SuperscriptBox["10", "x"], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"-", "7.5"}], ",", 
         RowBox[{"-", "0.3"}], ",", "0.1"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dat1", "=", 
      RowBox[{"NeventsDiscret", "[", 
       RowBox[{"mtest", ",", "ProdTest", ",", "couplinglist"}], "]"}]}], 
     ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dat2", "=", 
      RowBox[{"ParallelTable", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"couplinglist", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"c\[Tau]LLP", "[", 
           RowBox[{"mtest", ",", 
            RowBox[{"couplinglist", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"NeventsInt", "[", 
           RowBox[{"mtest", ",", 
            RowBox[{"couplinglist", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "ProdTest"}], "]"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "couplinglist", "]"}], ",", "1"}], "}"}]}], 
       "]"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*FractionBox[SubscriptBox[\(m\), \(LLP\)], \(GeV\)]\)\>\"", 
         ",", "\"\<coupling\>\"", ",", 
         "\"\<\!\(\*FractionBox[\(c\[Tau]\), SubscriptBox[\(z\), \
\(min\)]]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[\(N\), \(events, fast\)]\)\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[\(N\), \(events, slow\)]\)\>\""}], "}"}], 
       "}"}], ",", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"dat1", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           FractionBox[
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "zminExp"], "}"}], "&"}], "/@", 
         "dat2"}], ",", 
        RowBox[{"dat1", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", "3", "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"dat2", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", "3", "}"}]}], "]"}], "]"}], ",", "2"}], "]"}]}], 
     "]"}], "//", "TableForm"}]}]}]], "Input",
 CellChangeTimes->{{3.892111330393669*^9, 3.892111370325865*^9}, {
   3.8921114855521097`*^9, 3.892111489132691*^9}, {3.892111590925291*^9, 
   3.89211160107533*^9}, {3.892112023350475*^9, 3.8921120715940514`*^9}, {
   3.8921121043874707`*^9, 3.892112190091645*^9}, {3.892112748834139*^9, 
   3.892112748933666*^9}, {3.892113046545571*^9, 3.892113047031443*^9}, {
   3.892113198954867*^9, 3.89211319923953*^9}, {3.892113256325259*^9, 
   3.892113256434625*^9}, {3.892113458241603*^9, 3.8921135323303742`*^9}, {
   3.892116361437076*^9, 3.8921163614848557`*^9}, {3.893257780692194*^9, 
   3.893257792940939*^9}, {3.893260545232792*^9, 3.893260566765787*^9}, {
   3.896953530728937*^9, 3.896953531233162*^9}, {3.896953744363188*^9, 
   3.8969537469343243`*^9}, {3.896953883310589*^9, 3.896953884008139*^9}, {
   3.896971240286153*^9, 3.896971246695673*^9}, {3.8969733757056828`*^9, 
   3.896973378633896*^9}, {3.8969760731711073`*^9, 3.896976348233163*^9}, {
   3.8969763786206193`*^9, 3.896976403680397*^9}, {3.89697643436717*^9, 
   3.8969764672032604`*^9}, 3.897208833447896*^9, 3.8972326136604834`*^9, 
   3.897233424756247*^9, 3.897234070429367*^9, {3.9037938624346876`*^9, 
   3.903793863697696*^9}, {3.9049233552208714`*^9, 3.9049233846445026`*^9}, {
   3.905233491599722*^9, 3.905233491683108*^9}, {3.9104192195014668`*^9, 
   3.910419220919059*^9}, {3.910437157740117*^9, 3.910437198942398*^9}, 
   3.913866752244583*^9, 3.913867583374674*^9, {3.913869518281082*^9, 
   3.913869534616631*^9}, {3.9138740675789227`*^9, 3.913874080997648*^9}, {
   3.91387681476606*^9, 3.9138768200447183`*^9}, {3.9138810373100653`*^9, 
   3.913881064778409*^9}, 3.913881099289591*^9, 3.913881550640315*^9, {
   3.913881585879263*^9, 3.9138815982880993`*^9}, {3.913881660929047*^9, 
   3.91388166133914*^9}, {3.914496761652851*^9, 3.9144967641801987`*^9}, {
   3.914496807188168*^9, 3.91449701363063*^9}, {3.914497051782301*^9, 
   3.9144971085541267`*^9}, 3.914514827811349*^9, {3.915642996700496*^9, 
   3.9156429967030587`*^9}, {3.915878098531219*^9, 3.915878110222004*^9}, {
   3.916646520767328*^9, 3.9166465226448946`*^9}, {3.916671402784476*^9, 
   3.916671410946563*^9}, {3.9181448868261175`*^9, 3.918144939233001*^9}, {
   3.918145834252439*^9, 3.9181458547058067`*^9}},
 CellTags->"Number-of-events-computation+sensitivity",
 CellLabel->
  "In[1562]:=",ExpressionUUID->"593ffff2-9bb4-46f4-97b7-3e70963ba6d2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Differential number of events", "Subsection",
 CellChangeTimes->{{3.892111289211891*^9, 3.892111293865343*^9}},
 CellTags->
  "Number-of-events-computation+sensitivity",ExpressionUUID->"f30415e2-9b73-\
40ca-8e93-e38cc874c0c3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Variable", " ", "=", " ", "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\""}],
     ",", "\"\<\!\(\*SubscriptBox[\(z\), \(X\)]\)\>\"", ",", 
    RowBox[{
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", ".", " ", "The"}], 
     " ", "number", " ", "belongs", " ", "to", " ", "the", " ", "column", " ",
      "in", " ", "the", " ", "tabulated", " ", "data"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"iVal", ":=", 
    RowBox[{"Association", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\"", " ", "\[Rule]", "2"}], 
       ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", "\[Rule]", "1"}], 
       ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(z\), \(X\)]\)\>\"", "\[Rule]", "3"}]}], 
      "}"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
     "\[CapitalDelta]xvals", "[", 
      "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\"", "]"}], ":=", 
     "\[CapitalDelta]Evals"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
     "\[CapitalDelta]xvals", "[", 
      "\"\<\!\(\*SubscriptBox[\(z\), \(X\)]\)\>\"", "]"}], "=", 
     "\[CapitalDelta]zvals"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalDelta]xvals", "[", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", ",", "prod"}], 
        "]"}], "=", 
       RowBox[{"\[CapitalDelta]\[Theta]vals", "[", "prod", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"LegendX", ":=", 
    RowBox[{"Association", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\"", "\[Rule]", 
        "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\) [GeV]\>\""}], ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", "\[Rule]", 
        "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\) [rad]\>\""}], ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(z\), \(X\)]\)\>\"", "\[Rule]", " ", 
        "\"\<\!\(\*SubscriptBox[\(z\), \(X\)]\) [m]\>\""}]}], "}"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"LegendY", ":=", 
    RowBox[{"Association", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\"", "\[Rule]", 
        "\"\<\!\(\*SubscriptBox[\(dN\), \(ev\)]\)/\!\(\*SubscriptBox[\(dE\), \
\(X\)]\) [\!\(\*SuperscriptBox[\(GeV\), \(-1\)]\)]\>\""}], ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", "\[Rule]", 
        "\"\<\!\(\*SubscriptBox[\(dN\), \(ev\)]\)/\!\(\*SubscriptBox[\(d\
\[Theta]\), \(X\)]\) [\!\(\*SuperscriptBox[\(rad\), \(-1\)]\)]\>\""}], ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(z\), \(X\)]\)\>\"", "\[Rule]", " ", 
        "\"\<\!\(\*SubscriptBox[\(dN\), \(ev\)]\)/\!\(\*SubscriptBox[\(dz\), \
\(X\)]\) [\!\(\*SuperscriptBox[\(m\), \(-1\)]\)]\>\""}]}], "}"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Differential", " ", "number", " ", "of", " ", "events"}], "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NeventsDifferentialDiscretProd", "[", 
     RowBox[{"m_", ",", "ProdChannel_", ",", "coupling_", ",", "Variable_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "NpotTimes\[Chi]val", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ival", "=", 
        RowBox[{"iVal", "[", "Variable", "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"NpotTimes\[Chi]val", "=", 
        RowBox[{"NpotGivenExperiment", "*", 
         RowBox[{"ProbLLP", "[", 
          RowBox[{"m", ",", "coupling", ",", "ProdChannel"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tablegrid0", "=", 
        RowBox[{"TableIntegrandDiscret", "[", 
         RowBox[{"m", ",", "ProdChannel", ",", "\"\<True\>\""}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"OutGridEfinalTemp", "=", 
        RowBox[{"OutGridEnergy", "[", 
         RowBox[{
          RowBox[{"N", "[", "m", "]"}], ",", "ProdChannel"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[CapitalDelta]Evals", "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Rest", "[", 
           SuperscriptBox["10", "OutGridEfinalTemp"], "]"}], "-", 
          RowBox[{"Most", "[", 
           SuperscriptBox["10", "OutGridEfinalTemp"], "]"}]}], ")"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[CapitalDelta]xval", "=", 
        RowBox[{"\[CapitalDelta]xvals", "[", "Variable", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"c\[Tau]Val", "=", 
        RowBox[{"c\[Tau]LLP", "[", 
         RowBox[{"m", ",", "coupling"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"brvis", "=", 
        RowBox[{"BrVis", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ilist", "=", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"{", 
          RowBox[{"ival", ",", "1", ",", "2", ",", "3"}], "}"}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"tablegrid1", "=", 
        RowBox[{"SortBy", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"ilist", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"ilist", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"ilist", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "&"}], "/@", 
           RowBox[{"tableGridPrefac", "[", 
            RowBox[{"tablegrid0", ",", "m", ",", "c\[Tau]Val", ",", "0."}], 
            "]"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"GridQuantity", "=", 
        RowBox[{
         RowBox[{"tablegrid1", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", 
         "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"LengthPerVariable", "=", 
        RowBox[{
         RowBox[{"Length", "[", "tablegrid1", "]"}], "/", 
         RowBox[{"Length", "[", "GridQuantity", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tab1", "=", 
        RowBox[{"NdiffCompiled", "[", 
         RowBox[{
         "tablegrid1", ",", "GridQuantity", ",", "LengthPerVariable", ",", 
          RowBox[{"NpotTimes\[Chi]val", "*", "brvis"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"tab1", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", "1", "}"}]}], "]"}], "]"}], ",", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"tab1", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}], "*", 
            SuperscriptBox["\[CapitalDelta]xval", 
             RowBox[{"-", "1"}]]}], ",", "1"}], "]"}], ",", "2"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NeventsDifferentialDiscret", "[", 
     RowBox[{"m_", ",", "coupling_", ",", "Variable_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "NdiffInt", ",", "LegendList", ",", "QuantityMinMax", ",", 
        "ValueMinMax"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"prodlisttemp", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"mLLPmin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}], 
             "]"}], "<", "m", "<", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"mLLPmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}], 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"prodlisttemp", "=", 
             RowBox[{"Join", "[", 
              RowBox[{"prodlisttemp", ",", 
               RowBox[{"{", "prod", "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"NdiffData", "[", "prod", "]"}], "=", 
             RowBox[{"NeventsDifferentialDiscretProd", "[", 
              RowBox[{"m", ",", "prod", ",", "coupling", ",", "Variable"}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"XvalminmaxNdiff", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"NdiffData", "[", "prod", "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ">", 
                   SuperscriptBox["10", 
                    RowBox[{"-", "40"}]]}], "&"}]}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "MinMax"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"NdiffInt", "[", 
              RowBox[{"X_", ",", "prod"}], "]"}], "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"XvalminmaxNdiff", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "<", "X", "<", 
                RowBox[{"XvalminmaxNdiff", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               RowBox[{"Evaluate", "[", 
                RowBox[{"10", "^", 
                 RowBox[{
                  RowBox[{"Interpolation", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log10", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Log10", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "90"}]]}], "]"}]}], "}"}], "&"}], "/@", 
                    RowBox[{"NdiffData", "[", "prod", "]"}]}], ",", 
                    RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], 
                  "[", 
                  RowBox[{"Log10", "[", "X", "]"}], "]"}]}], "]"}], ",", 
               "0"}], "]"}]}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NdiffInt", "[", 
         RowBox[{"X_", ",", "\"\<Total\>\""}], "]"}], "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"NdiffInt", "[", 
           RowBox[{"X", ",", "prod"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "prodlisttemp"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"LegendList", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", "\"\<Total\>\"", "}"}], ",", "prodlisttemp"}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"QuantityMinMax", "=", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"MinMax", "[", 
              RowBox[{
               RowBox[{"NdiffData", "[", "prod", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"prod", ",", "prodlisttemp"}], "}"}]}], "]"}], ",", 
           "1"}], "]"}], "//", "MinMax"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ValueMinMax", "=", 
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"NdiffData", "[", "#", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "&"}], "/@", 
          "prodlisttemp"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"NdiffInt", "[", 
            RowBox[{"X", ",", "prod"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"prod", ",", "LegendList"}], "}"}]}], "]"}], ",", 
         "LegendList", ",", "QuantityMinMax", ",", "ValueMinMax"}], "}"}]}]}],
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mvaltest", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FacilityGivenExperiment", "==", "\"\<ESS\>\""}], ",", "0.04", 
       ",", "0.2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"couplingvaltest", "=", 
     RowBox[{"1.4", 
      RowBox[{"LowerBoundEstimate", "[", 
       RowBox[{"mvaltest", ",", 
        RowBox[{"ProductionList", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"quantity", "=", "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NdiffTab", "[", "X_", "]"}], ",", "LegendList", ",", 
       "QuantityMinMax", ",", "ValueMinMax"}], "}"}], "=", 
     RowBox[{"NeventsDifferentialDiscret", "[", 
      RowBox[{"mvaltest", ",", "couplingvaltest", ",", "quantity"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"prch", "=", 
        RowBox[{"LegendList", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NdiffInt", "[", 
         RowBox[{"X_", ",", "prch"}], "]"}], "=", 
        RowBox[{
         RowBox[{"NdiffTab", "[", "X", "]"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
      
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "LegendList", "]"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"plotdiff", "=", 
    RowBox[{"LogLogPlot", "[", 
     RowBox[{
      RowBox[{"Evaluate", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NdiffInt", "[", 
          RowBox[{"X", ",", "prod"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"prod", ",", "LegendList"}], "}"}]}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"X", ",", 
        RowBox[{"QuantityMinMax", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"QuantityMinMax", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"Frame", "\[Rule]", "True"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{
           SuperscriptBox["10", 
            RowBox[{"-", "5"}]], ",", 
           RowBox[{"2", "ValueMinMax"}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Thick", ",", "Black"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", 
           RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", 
           RowBox[{"Darker", "@", 
            RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", 
           RowBox[{"Darker", "@", "Cyan"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", "Magenta"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", "Blue", ",", 
           RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", 
           RowBox[{"Darker", "@", "Red"}], ",", 
           RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", 
           RowBox[{"Darker", "@", 
            RowBox[{"Darker", "@", "Green"}]}], ",", 
           RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"PlotLegends", "\[Rule]", 
       RowBox[{"Placed", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"#", ",", "20"}], "]"}], "&"}], "/@", "LegendList"}], ",",
          "Right"}], "]"}]}], ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LegendX", "[", "quantity", "]"}], " ", ",", 
         RowBox[{"LegendY", "[", "quantity", "]"}]}], "}"}]}], ",", 
      RowBox[{"FrameStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", " ", "18"}], "]"}]}], ",", 
      RowBox[{"PlotLabel", "\[Rule]", 
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"Row", "[", 
          RowBox[{"{", 
           RowBox[{
           "SelectedExperiment", ",", 
            "\"\<. \!\(\*SubscriptBox[\(m\), \(a\)]\) = \>\"", ",", 
            "mvaltest", ",", 
            "\"\< GeV, \!\(\*SubscriptBox[\(g\), \(Y\)]\) = \>\"", ",", 
            RowBox[{"couplingvaltest", "//", "N"}]}], "}"}], "]"}], ",", "14",
          ",", "Black"}], "]"}]}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.892116399613522*^9, 3.8921164016036086`*^9}, {
   3.8921164560955544`*^9, 3.892116475031265*^9}, {3.892116516434699*^9, 
   3.8921165782759094`*^9}, {3.8921166461579666`*^9, 3.892116647010913*^9}, {
   3.892116704213489*^9, 3.892116729930051*^9}, {3.8927049818255663`*^9, 
   3.892704999122227*^9}, {3.892911547101909*^9, 3.892911593659387*^9}, {
   3.8929721720425777`*^9, 3.892972173350433*^9}, {3.892972220877343*^9, 
   3.8929722211847763`*^9}, {3.8932578131000147`*^9, 3.893257813645747*^9}, {
   3.8934746693595037`*^9, 3.893474675301323*^9}, {3.8935154039618006`*^9, 
   3.893515450284458*^9}, {3.893515943430369*^9, 3.893515962817915*^9}, 
   3.893516005738713*^9, {3.893516036174548*^9, 3.893516050479193*^9}, {
   3.893516088577403*^9, 3.893516089018369*^9}, {3.893516189974946*^9, 
   3.893516190221347*^9}, {3.8935162352543807`*^9, 3.8935162734266047`*^9}, {
   3.893516595793399*^9, 3.893516611219179*^9}, {3.893606026577932*^9, 
   3.8936060575609436`*^9}, 3.895557836437767*^9, {3.8969794021337867`*^9, 
   3.89697940417612*^9}, {3.897206579842867*^9, 3.897206594529684*^9}, {
   3.897208544525418*^9, 3.89720854933476*^9}, {3.897208919899889*^9, 
   3.897208931547951*^9}, {3.897232355781791*^9, 3.8972323557889285`*^9}, {
   3.897232650441552*^9, 3.897232655613889*^9}, {3.897233445816729*^9, 
   3.897233451877641*^9}, {3.897233738926023*^9, 3.89723374848701*^9}, {
   3.8972341759970245`*^9, 3.897234180523908*^9}, 3.9027273711383595`*^9, 
   3.903790322052125*^9, 3.903791118403775*^9, {3.90379388260617*^9, 
   3.90379391368436*^9}, {3.903793985440897*^9, 3.903793996697591*^9}, {
   3.903806138641766*^9, 3.903806141571057*^9}, {3.9049234022965198`*^9, 
   3.904923404719922*^9}, {3.9049234552044992`*^9, 3.9049234557077*^9}, {
   3.905241298600586*^9, 3.905241322456391*^9}, 3.9138675833998876`*^9, {
   3.913868212910805*^9, 3.913868212916352*^9}, {3.913868773464786*^9, 
   3.9138687783481526`*^9}, {3.913868990884107*^9, 3.913868990892577*^9}, 
   3.9138690440046268`*^9, {3.913871804520094*^9, 3.9138718176925616`*^9}, {
   3.913874095556819*^9, 3.913874098948403*^9}, {3.913877232309046*^9, 
   3.91387723268427*^9}, {3.913879654609223*^9, 3.91387965462405*^9}, {
   3.913881645619234*^9, 3.913881646128089*^9}, {3.913881704552607*^9, 
   3.913881709270204*^9}, {3.9144962634466343`*^9, 3.9144962636579084`*^9}, {
   3.915642996732589*^9, 3.915642996753282*^9}, {3.916289412312564*^9, 
   3.916289616465511*^9}, {3.9162896759598675`*^9, 3.916289806201638*^9}, 
   3.9163945964185715`*^9, {3.916395341223231*^9, 3.916395345479702*^9}, {
   3.9163954358459406`*^9, 3.916395476754702*^9}, 3.916507576032919*^9, 
   3.916507636448643*^9, {3.91650772903246*^9, 3.916507758147762*^9}, {
   3.9165115197870893`*^9, 3.916511520195762*^9}, {3.916512138255837*^9, 
   3.916512144983124*^9}, {3.9165122548977995`*^9, 3.916512283348137*^9}, {
   3.916646293733116*^9, 3.9166462947751274`*^9}, {3.916646520793968*^9, 
   3.9166465208234444`*^9}, {3.916646738933076*^9, 3.91664674369617*^9}, {
   3.9166719290223193`*^9, 3.9166719293698535`*^9}, {3.916804921189234*^9, 
   3.916804977276477*^9}, {3.9168061232156515`*^9, 3.9168061561923175`*^9}, {
   3.916806216322298*^9, 3.9168062251202345`*^9}, 3.916808220695965*^9, {
   3.916847517130616*^9, 3.9168475477311544`*^9}, {3.91685495004175*^9, 
   3.916854957445075*^9}, {3.918143341273554*^9, 3.918143343343209*^9}, {
   3.918143446282981*^9, 3.918143451736936*^9}, {3.918143934213302*^9, 
   3.918143936156442*^9}, {3.9181449424578676`*^9, 3.918144963771795*^9}, {
   3.91814590537285*^9, 3.9181459058310533`*^9}, {3.918146234447649*^9, 
   3.918146254508343*^9}},
 CellTags->"Number-of-events-computation+sensitivity",
 CellLabel->
  "In[1568]:=",ExpressionUUID->"96a90d25-fa01-4601-87c3-3de8f9d226a6"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Exporting tabulated number of events", "Title",
 CellChangeTimes->{{3.885020790452163*^9, 3.885020796464762*^9}, 
   3.886649940088234*^9},
 CellTags->
  "Number-of-events-computation+sensitivity",ExpressionUUID->"0923b405-c0ba-\
437a-a0a1-eb2d8707c8c5"],

Cell[CellGroupData[{

Cell["Definitions", "Chapter",
 CellChangeTimes->{{3.885054201764113*^9, 3.885054203349573*^9}},
 CellTags->
  "Number-of-events-computation+sensitivity",ExpressionUUID->"2ada0cc1-1695-\
4a57-a86b-b11e240b979f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"directory", "[", "\"\<Nevents\>\"", "]"}], "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<Tabulated Nevents\>\""}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"directory", "[", "\"\<Nevents-LLP\>\"", "]"}], "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<Tabulated Nevents\>\"", ",", "LLPdirName"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"directory", "[", "\"\<Nevents-LLP-experiment\>\"", "]"}], "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<Tabulated Nevents\>\"", ",", "LLPdirName", ",", 
      "SelectedExperiment"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"DirectoryQ", "[", 
        RowBox[{"directory", "[", "#", "]"}], "]"}]}], ",", 
      RowBox[{"CreateDirectory", "[", 
       RowBox[{"directory", "[", "#", "]"}], "]"}]}], "]"}], "&"}], "/@", 
   RowBox[{"{", 
    RowBox[{
    "\"\<Nevents\>\"", ",", "\"\<Nevents-LLP\>\"", ",", 
     "\"\<Nevents-LLP-experiment\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<Filenames with tabulated \!\(\*SubscriptBox[\(N\), \(events\)]\):\>\"",
   "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"FilenameNevents", "[", "prod", "]"}], "=", 
    RowBox[{"ToString", "@", 
     RowBox[{"StringForm", "[", 
      RowBox[{"\"\<Nevents_``_``_at_``_Npot=``.dat\>\"", ",", 
       RowBox[{"Sequence", "@@", 
        RowBox[{"{", 
         RowBox[{"LLPdirName", ",", "prod", ",", "SelectedExperiment", ",", 
          RowBox[{
           RowBox[{"NpotGivenExperiment", "//", "CForm"}], "//", 
           "ToString"}]}], "}"}]}]}], "]"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"prod", ",", "ProductionList"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FilenameNevents", "[", "#", "]"}], "&"}], "/@", 
  "ProductionList"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"mRangeExport", "[", "prod", "]"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "0.02", ",", "0.03", ",", "0.04", ",", "0.05", ",", "0.06", ",", 
        "0.07", ",", "0.08", ",", "0.09", ",", "0.1", ",", "0.11", ",", 
        "0.12", ",", "0.13", ",", "0.14", ",", "0.151", ",", "0.2", ",", 
        "0.21", ",", "0.215", ",", "0.218", ",", "0.22", ",", "0.225", ",", 
        "0.23", ",", "0.24", ",", "0.25", ",", "0.27", ",", "0.301", ",", 
        "0.35", ",", "0.4", ",", "0.425", ",", "0.45", ",", "0.47", ",", 
        "0.5", ",", "0.51", ",", "0.52", ",", "0.53", ",", "0.535", ",", 
        "0.54", ",", "0.543", ",", "0.544", ",", "0.545", ",", "0.546", ",", 
        "0.55", ",", "0.56", ",", "0.57", ",", "0.58", ",", "0.59", ",", 
        "0.6", ",", "0.61", ",", "0.62", ",", "0.63", ",", "0.64", ",", 
        "0.65", ",", "0.67", ",", "0.7", ",", "0.725", ",", "0.75", ",", 
        "0.77", ",", "0.8", ",", "0.825", ",", "0.85", ",", "0.87", ",", 
        "0.88", ",", "0.89", ",", "0.9", ",", "0.91", ",", "0.92", ",", 
        "0.93", ",", "0.94", ",", "0.95", ",", "0.953", ",", "0.954", ",", 
        "0.955", ",", "0.956", ",", "0.96", ",", "0.961", ",", "0.962", ",", 
        "0.963", ",", "0.966", ",", "0.97", ",", "0.973", ",", "0.975", ",", 
        "0.98", ",", "1.", ",", "1.01", ",", "1.02", ",", "1.03", ",", "1.05",
         ",", "1.07", ",", "1.1", ",", "1.12", ",", "1.15", ",", "1.2", ",", 
        "1.25", ",", "1.3", ",", "1.4", ",", "1.5", ",", "1.6", ",", "1.7", 
        ",", "1.8", ",", "1.9", ",", "2.", ",", "2.1", ",", "2.2", ",", "2.3",
         ",", "2.4", ",", "2.5", ",", "2.6", ",", "2.7", ",", "2.9", ",", 
        "3.2", ",", "3.3", ",", "3.4", ",", "3.5", ",", "3.6", ",", "3.7", 
        ",", "3.8", ",", "3.9", ",", "4.", ",", "4.1", ",", "4.2", ",", "4.3",
         ",", "4.4", ",", "4.5", ",", "4.6", ",", "4.7", ",", "4.76"}], "}"}],
       "//", "N"}]}], ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"prod", ",", "ProductionList"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"couplingsRangeExport", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      SuperscriptBox["10", "x"], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"-", "7"}], ",", 
        RowBox[{"-", "1"}], ",", "0.017"}], "}"}]}], "]"}], "//", "N"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8850528402073092`*^9, 3.885052964529935*^9}, {
   3.885052996702445*^9, 3.88505313318991*^9}, {3.885053172661522*^9, 
   3.885053247354876*^9}, {3.885053717249408*^9, 3.8850537696983976`*^9}, {
   3.885054057416253*^9, 3.88505420740788*^9}, {3.885054242848059*^9, 
   3.885054257815028*^9}, {3.885054905514982*^9, 3.885054927992525*^9}, {
   3.88523276755499*^9, 3.885232776819412*^9}, {3.885455620457822*^9, 
   3.8854556494874506`*^9}, {3.885456016527883*^9, 3.885456192123282*^9}, {
   3.8854563516684437`*^9, 3.885456363168164*^9}, {3.885456439233843*^9, 
   3.885456605782855*^9}, {3.8854567400235205`*^9, 3.885456743964001*^9}, {
   3.885542660052145*^9, 3.8855427304549437`*^9}, {3.8855427881537523`*^9, 
   3.885542788237467*^9}, {3.885543006762053*^9, 3.885543013668437*^9}, 
   3.885966882096207*^9, {3.8859669421437807`*^9, 3.8859669421488247`*^9}, {
   3.885968641323983*^9, 3.8859686709916077`*^9}, {3.8859700818035088`*^9, 
   3.885970116005333*^9}, {3.8859726427933483`*^9, 3.885972662162679*^9}, {
   3.8859727076000075`*^9, 3.885972770558454*^9}, {3.886048260680982*^9, 
   3.886048270758037*^9}, 3.8927074033680496`*^9, {3.892710424494131*^9, 
   3.8927104396943235`*^9}, {3.892912564399712*^9, 3.8929125705695467`*^9}, {
   3.893498037302079*^9, 3.893498051475497*^9}, {3.8950528099087296`*^9, 
   3.8950528378354964`*^9}, {3.895069852359413*^9, 3.895069870098545*^9}, {
   3.8950705608302083`*^9, 3.895070565809863*^9}, {3.89507701915416*^9, 
   3.895077025325854*^9}, {3.8951278228356895`*^9, 3.8951278681121373`*^9}, {
   3.895560201717767*^9, 3.895560203921951*^9}, {3.9027274496040297`*^9, 
   3.902727450274849*^9}, {3.903791118413924*^9, 3.903791118423604*^9}, {
   3.903794012559026*^9, 3.903794083915003*^9}, {3.90379441671765*^9, 
   3.90379444541631*^9}, {3.903795270551989*^9, 3.903795270602932*^9}, {
   3.903797141226776*^9, 3.903797172010522*^9}, {3.90379752430272*^9, 
   3.903797527105424*^9}, {3.905233682249745*^9, 3.9052336869139786`*^9}, {
   3.910168601483687*^9, 3.910168607501469*^9}, {3.911026697129974*^9, 
   3.911026781892647*^9}, {3.913869518284073*^9, 3.913869518287491*^9}, {
   3.9138696020664196`*^9, 3.91386966218481*^9}, {3.9156429776401563`*^9, 
   3.91564297765859*^9}},
 CellTags->"Number-of-events-computation+sensitivity",
 CellLabel->
  "In[1582]:=",ExpressionUUID->"d36d89ea-2d97-457b-aa5b-4b098e8235d8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Exporting", "Chapter",
 CellChangeTimes->{{3.885054212114191*^9, 3.885054213032151*^9}},
 CellTags->
  "Number-of-events-computation+sensitivity",ExpressionUUID->"a58bd3a7-f345-\
470d-ba5e-82c520e24a7e"],

Cell[CellGroupData[{

Cell["Common definition", "Section",
 CellChangeTimes->{{3.892188604385711*^9, 3.8921886076155424`*^9}},
 CellTags->
  "Number-of-events-computation+sensitivity",ExpressionUUID->"d9a2b292-24ca-\
4f51-9905-1bcde103c869"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BlockExport", "[", "ProdChannel_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "mlist", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mlist", "=", 
      RowBox[{"mRangeExport", "[", "ProdChannel", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"TabFrom", "=", 
      RowBox[{"ParallelTable", "[", 
       RowBox[{
        RowBox[{"Quiet", "[", 
         RowBox[{"NeventsDiscret", "[", 
          RowBox[{
           RowBox[{"mlist", "[", 
            RowBox[{"[", "k", "]"}], "]"}], ",", "ProdChannel", ",", 
           "couplingsRangeExport"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", 
          RowBox[{"Length", "[", "mlist", "]"}], ",", "1"}], "}"}]}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"directory", "[", "\"\<Nevents-LLP-experiment\>\"", "]"}], 
          ",", 
          RowBox[{"FilenameNevents", "[", "ProdChannel", "]"}]}], "}"}], 
        "]"}], ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{"TabFrom", ",", "1"}], "]"}], ",", "\"\<Table\>\""}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"prod", "=", 
        RowBox[{"ProductionList", "[", 
         RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"BlockExport", "[", "prod", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", 
        RowBox[{"Length", "[", "ProductionList", "]"}], ",", "1"}], "}"}]}], 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ProgressIndicator", "[", 
        RowBox[{"j", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"Length", "[", "ProductionList", "]"}]}], "}"}]}], "]"}], 
       ",", "\"\< Production mode = \>\"", ",", 
       RowBox[{"ProductionList", "[", 
        RowBox[{"[", "j", "]"}], "]"}], ",", "\"\< (\>\"", ",", " ", "j", 
       ",", "\"\</\>\"", ",", 
       RowBox[{"Length", "[", "ProductionList", "]"}], ",", "\"\<)\>\""}], 
      "}"}], "]"}]}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"icounter", ">", 
    RowBox[{"Length", "[", "SelectedExperimentList", "]"}]}], ",", 
   RowBox[{"BlockEvaluation", "[", "\"\<Sensitivity\>\"", "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.89218861022996*^9, 3.892188661864987*^9}, {
   3.892188696661598*^9, 3.892188782889353*^9}, {3.8921888713769283`*^9, 
   3.8921888914281383`*^9}, {3.892190937661848*^9, 3.8921909466626697`*^9}, {
   3.8922765048644934`*^9, 3.8922765048725324`*^9}, {3.892541051864915*^9, 
   3.892541108103123*^9}, {3.8925422299627266`*^9, 3.892542259125981*^9}, {
   3.892542627960807*^9, 3.8925426356350737`*^9}, {3.892710474686255*^9, 
   3.892710508465253*^9}, {3.8950703812229633`*^9, 3.895070389767537*^9}, 
   3.902727456141352*^9, {3.903791118428642*^9, 3.90379111843118*^9}, 
   3.9037940600873713`*^9, 3.9138695182916346`*^9, {3.9138696778224015`*^9, 
   3.9138697217311115`*^9}, {3.9146644219469934`*^9, 3.914664476499*^9}, 
   3.915642977667258*^9},
 CellTags->"Number-of-events-computation+sensitivity",
 CellLabel->
  "In[1591]:=",ExpressionUUID->"b5ddb613-f8ce-4354-bf3e-3dc63b62f3d5"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Computing sensitivities", "Title",
 CellChangeTimes->{{3.885020809493571*^9, 3.88502081261261*^9}},
 CellTags->
  "Sensitivity",ExpressionUUID->"43632709-93c8-43ea-aac4-c4cdd9738fd6"],

Cell[CellGroupData[{

Cell["Basic definitions", "Chapter",
 CellChangeTimes->{{3.913831474538881*^9, 3.913831477098402*^9}},
 CellTags->
  "Sensitivity",ExpressionUUID->"c47d29ae-1d53-4941-a324-cae19d7aa2d4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPdirName", "=", "\"\<ALP-fermion\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"directory", "[", "\"\<Sensitivity\>\"", "]"}], "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<Sensitivity domains\>\""}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"directory", "[", "\"\<Sensitivity-LLP\>\"", "]"}], "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"directory", "[", "\"\<Sensitivity\>\"", "]"}], ",", 
      "LLPdirName"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"DirectoryQ", "[", 
        RowBox[{"directory", "[", "#", "]"}], "]"}]}], ",", 
      RowBox[{"CreateDirectory", "[", 
       RowBox[{"directory", "[", "#", "]"}], "]"}]}], "]"}], "&"}], "/@", 
   RowBox[{"{", 
    RowBox[{"\"\<Sensitivity\>\"", ",", "\"\<Sensitivity-LLP\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"directory", "[", "\"\<Nevents-LLP\>\"", "]"}], "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<Tabulated Nevents\>\"", ",", "LLPdirName"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"infoDialog", "[", "phrase_", "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<Proceed\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"selectionDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", 
      RowBox[{"{", "}"}]}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{"{", "phrase", "}"}], "]"}], ",", 
       RowBox[{"Pane", "[", 
        RowBox[{
         RowBox[{"TogglerBar", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list", ",", 
           RowBox[{"Appearance", "->", 
            RowBox[{"\"\<Vertical\>\"", "->", 
             RowBox[{"{", 
              RowBox[{"Automatic", ",", "5"}], "}"}]}]}]}], "]"}], ",", 
         RowBox[{"ImageSize", "->", 
          RowBox[{"{", 
           RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], ",", 
         RowBox[{"Scrollbars", "->", 
          RowBox[{"{", 
           RowBox[{"False", ",", "True"}], "}"}]}]}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentDirectoriesListNevents", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"FileNames", "[", 
      RowBox[{"\"\<*\>\"", ",", 
       RowBox[{"directory", "[", "\"\<Nevents-LLP\>\"", "]"}], ",", "1"}], 
      "]"}], ",", "DirectoryQ"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
  "\"\<List of available experiments with tabulated \!\(\*SubscriptBox[\(N\), \
\(events\)]\) for \>\"", " ", "<>", "LLPdirName", "<>", "\"\<:\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentsListNevents", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"FileNameTake", "[", 
       RowBox[{
        RowBox[{"ExperimentDirectoriesListNevents", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "ExperimentDirectoriesListNevents", "]"}], ",",
         "1"}], "}"}]}], "]"}], "//", "Sort"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ExperimentsListNevents", "//", "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", "ExperimentsListNevents", "]"}], "\[Equal]", "0"}],
    ",", 
   RowBox[{
   "Print", "[", 
    "\"\<No experiment is available, generate first the acceptance for the \
given experiment using module 1\>\"", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SelectedExperimentList", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "ExperimentsListNevents", "]"}], "\[NotEqual]",
         "0"}], ",", 
       RowBox[{"selectionDialog", "[", 
        RowBox[{
        "ExperimentsListNevents", ",", 
         "\"\<Select the experiments for which the sensitivity will be \
computed:\>\""}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"icounter", "=", "1"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"BlockEvaluation", "[", "tag_", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nb", "=", 
         RowBox[{"EvaluationNotebook", "[", "]"}]}], ";", "\n", 
        RowBox[{"NotebookFind", "[", 
         RowBox[{"nb", ",", "tag", ",", "All", ",", "CellTags"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
       "BlockEvaluation", "[", "\"\<Sensitivity-computation\>\"", "]"}], 
       ";"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"icounter", ",", "1", ",", 
        RowBox[{"Length", "[", "SelectedExperimentList", "]"}], ",", "1"}], 
       "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.9138315400875535`*^9, 3.91383154039198*^9}, {
   3.913871030317705*^9, 3.913871036018191*^9}, {3.913972431945261*^9, 
   3.9139724320924325`*^9}, {3.9146634336553288`*^9, 3.914663434225196*^9}, {
   3.914663483841358*^9, 3.914663523646078*^9}, {3.9146635818120675`*^9, 
   3.914663718820899*^9}, {3.914665730457777*^9, 3.914665733449438*^9}, {
   3.914665859586949*^9, 3.914665862519333*^9}, 3.915262591588784*^9, {
   3.915642977679679*^9, 3.9156429777037826`*^9}, 3.916646661097157*^9},
 CellTags->"Sensitivity",
 CellLabel->
  "In[1594]:=",ExpressionUUID->"f7b1c868-dce7-4820-abe5-5a1951693960"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.915262593042534*^9},ExpressionUUID->"599d9a02-c6ca-4c42-afbf-\
30fec1b5ea91"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Specifying the experiment and interpolating the tabulated number of events\
\>", "Chapter",
 CellChangeTimes->{{3.8865657605515084`*^9, 3.886565789800824*^9}, {
  3.889154717919751*^9, 3.88915472812621*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"4f28db5f-3e98-48c2-a98d-\
ef371754d56f"],

Cell[CellGroupData[{

Cell["Selecting the experiment", "Section",
 CellChangeTimes->{{3.91396730853413*^9, 3.913967310881191*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"a2df8568-b188-42b9-a9ff-\
c2eef351309c"],

Cell[BoxData[{
 RowBox[{"Print", "[", "\"\<Selected experiment:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"GivenExperimentForSensitivityComputation", "=", 
  RowBox[{"SelectedExperimentList", "[", 
   RowBox[{"[", 
    RowBox[{"icounter", "++"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CondANUBIS", "=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<ANUBIS-shaft-volume-1\>\"", ",", "\"\<ANUBIS-shaft-volume-2\>\"", 
       ",", "\"\<ANUBIS-shaft-volume-3\>\""}], "}"}], ",", 
     "GivenExperimentForSensitivityComputation"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"CondANUBIS", "\[Equal]", "True"}], ",", 
   RowBox[{"infoDialog", "[", 
    RowBox[{"Row", "[", 
     RowBox[{
     "{", "\"\<One of the modules of ANUBIS-shaft is chosen. The full \
sensitivity includes three modules. The importing will be over all modules, \
so for all ot the the sensitivity has to be computed\>\"", "}"}], "]"}], 
    "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"CondANUBIS", "\[Equal]", "False"}], ",", 
    RowBox[{"GivenExperimentForSensitivityComputationList", "=", 
     RowBox[{"{", "GivenExperimentForSensitivityComputation", "}"}]}], ",", 
    RowBox[{"GivenExperimentForSensitivityComputationList", "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\<ANUBIS-shaft-volume-1\>\"", ",", "\"\<ANUBIS-shaft-volume-2\>\"", 
       ",", "\"\<ANUBIS-shaft-volume-3\>\""}], "}"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"directoriesNeventsSelected", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{"directoriesNeventsSelected", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"directoriesNeventsSelected", ",", 
        RowBox[{"FileNames", "[", 
         RowBox[{"\"\<*.dat\>\"", ",", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"directory", "[", "\"\<Nevents-LLP\>\"", "]"}], ",", 
             "exp"}], "}"}], "]"}]}], "]"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "GivenExperimentForSensitivityComputationList"}], 
      "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Creating", " ", "the", " ", "directory", " ", "for", " ", "exporting", 
    " ", "sensitivity", " ", "curves"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentFolder", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"CondANUBIS", "\[Equal]", "True"}], ",", "\"\<ANUBIS\>\"", ",", 
     "GivenExperimentForSensitivityComputation"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"directory", "[", "\"\<Sensitivity-LLP-exp\>\"", "]"}], "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"directory", "[", "\"\<Sensitivity-LLP\>\"", "]"}], ",", 
      "ExperimentFolder"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"!", 
    RowBox[{"DirectoryQ", "[", 
     RowBox[{"directory", "[", "\"\<Sensitivity-LLP-exp\>\"", "]"}], "]"}]}], 
   ",", 
   RowBox[{"CreateDirectory", "[", 
    RowBox[{"directory", "[", "\"\<Sensitivity-LLP-exp\>\"", "]"}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.913967331064651*^9, 3.913967332613941*^9}, 
   3.9146635941602*^9, 3.91466368682129*^9, {3.914663724214395*^9, 
   3.91466374658012*^9}, {3.915642977710781*^9, 3.9156429777197733`*^9}, {
   3.915820653271777*^9, 3.915820653277291*^9}},
 CellTags->"Sensitivity-computation",
 CellLabel->
  "In[1607]:=",ExpressionUUID->"7514cf55-f983-402c-aa09-fecdad6ca627"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Importing and interpolations", "Section",
 CellChangeTimes->{{3.91396730853413*^9, 3.913967317219821*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"394e46f6-d9e3-4b2a-ae85-\
1d9a1c0b0481"],

Cell[BoxData[{
 RowBox[{"Print", "[", "\"\<List of production channels:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FilenamesNevents", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Last", "@", 
      RowBox[{"FileNameSplit", "@", 
       RowBox[{"directoriesNeventsSelected", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "directoriesNeventsSelected", "]"}], ",", "1"}],
       "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FilenameParameters", "[", "i_", "]"}], ":=", 
   RowBox[{
    RowBox[{"StringCases", "[", 
     RowBox[{
      RowBox[{"FilenamesNevents", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"\"\<Nevents_\>\"", "<>", "LLPdirName", "<>", "\"\<_\>\""}], "~~",
         "mother__", "~~", "\"\<_at_\>\"", "~~", "experiment__", "~~", 
        "\"\<_Npot=\>\"", "~~", "Npot__", "~~", "\"\<.dat\>\""}], ":>", 
       RowBox[{"{", 
        RowBox[{"mother", ",", "experiment", ",", "Npot"}], "}"}]}]}], "]"}], 
    "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
    "___", "___", "___", "___", "___", "___", "___", "___"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Importing", " ", "and", " ", "interpolation"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
    "___", "___", "___", "___", "___", "___", "___", "___"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductionInfoList", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"FilenameParameters", "[", "i", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "FilenamesNevents", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Mother\>\"", ",", "\"\<Experiment\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(N\), \(PoT\)]\)\>\""}], "}"}], "}"}], ",", 
    "ProductionInfoList"}], "]"}], "//", "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductionChannelsList", "=", 
   RowBox[{"ProductionInfoList", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NpotDefault", "=", 
   RowBox[{
    RowBox[{"Interpreter", "[", "\"\<Number\>\"", "]"}], "[", 
    RowBox[{
     RowBox[{"ProductionInfoList", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NeventsTabulated", "//", "Clear"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Epsilon]reco", "[", "mLLP_", "]"}], "=", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"StringContainsQ", "[", 
     RowBox[{
     "GivenExperimentForSensitivityComputation", ",", 
      "\"\<LHCb-downstream\>\""}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Epsilon]reco", "[", "mLLP_", "]"}], "=", "0.4"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"StringContainsQ", "[", 
     RowBox[{
     "GivenExperimentForSensitivityComputation", ",", 
      "\"\<CHARM-lepton\>\""}], "]"}], ",", 
    RowBox[{
     RowBox[{"\[Epsilon]reco", "[", "mLLP_", "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"mLLP", "<", 
        RowBox[{"0.105", "*", "2"}]}], ",", "0.51", ",", "0.85"}], "]"}]}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"StringContainsQ", "[", 
     RowBox[{
     "GivenExperimentForSensitivityComputation", ",", "\"\<NuCal\>\""}], 
     "]"}], ",", 
    RowBox[{
     RowBox[{"\[Epsilon]reco", "[", "mLLP_", "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"mLLP", "<", 
        RowBox[{"0.105", "*", "2"}]}], ",", "0.7", ",", "0.8"}], "]"}]}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "prod", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"prod", "=", 
       RowBox[{"ProductionChannelsList", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "The", " ", "condition", " ", "if", " ", "one", " ", "sums", " ", 
        "the", " ", "number", " ", "of", " ", "events", " ", "for", " ", 
        "the", " ", "same", " ", "production", " ", "mode", " ", "over", " ", 
        "several", " ", "experiments"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"IfprodExists", "=", 
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Keys", "[", 
           RowBox[{"DownValues", "@", "NeventsTabulated"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], ",", "prod"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NeventsTabulated", "[", "prod", "]"}], "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", "IfprodExists"}], ",", 
         RowBox[{"Import", "[", 
          RowBox[{
           RowBox[{"directoriesNeventsSelected", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<Table\>\""}], "]"}], 
         ",", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"NeventsTabulated", "[", "prod", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"NeventsTabulated", "[", "prod", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", 
               RowBox[{"{", "3", "}"}]}], "]"}], "]"}], "+", 
            RowBox[{
             RowBox[{"Import", "[", 
              RowBox[{
               RowBox[{"directoriesNeventsSelected", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<Table\>\""}], "]"}],
              "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", 
               RowBox[{"{", "3", "}"}]}], "]"}], "]"}]}]}], "]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"mminmax", "[", "prod", "]"}], ",", 
         RowBox[{"couplingminmax", "[", "prod", "]"}]}], "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"NeventsTabulated", "[", "prod", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "#"}], "]"}], "]"}], "//", "MinMax"}], ")"}],
          "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NevMax", "[", "prod", "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"NeventsTabulated", "[", "prod", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "3"}], "]"}], "]"}], "//", "Max"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NevInt", "[", 
        RowBox[{"mLLP_", ",", "y_", ",", "prod"}], "]"}], "=", 
       RowBox[{
        RowBox[{"\[Epsilon]reco", "[", "mLLP", "]"}], "*", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"mminmax", "[", "prod", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", " ", "mLLP", 
            "\[LessEqual]", 
            RowBox[{
             RowBox[{"mminmax", "[", "prod", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "&&", 
           RowBox[{
            RowBox[{
             RowBox[{"couplingminmax", "[", "prod", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", "y", 
            "\[LessEqual]", 
            RowBox[{
             RowBox[{"couplingminmax", "[", "prod", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Interpolation", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Log10", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Log10", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Log10", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "+", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "90"}]]}], "]"}]}], "}"}], "&"}], "/@", 
                 RowBox[{"NeventsTabulated", "[", "prod", "]"}]}], ",", 
                RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
              
              RowBox[{
               RowBox[{"Log10", "[", "mLLP", "]"}], ",", 
               RowBox[{"Log10", "[", "y", "]"}]}], "]"}], ")"}]}], "]"}], ",",
           "0"}], "]"}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "ProductionInfoList", "]"}], ",", "1"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"mminmaxOverall", ",", "couplingminmaxOverall"}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"MinMax", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"#", "[", "prod", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"prod", ",", "ProductionChannelsList"}], "}"}]}], "]"}], "//",
        "Flatten"}], "]"}], "&"}], "/@", 
    RowBox[{"{", 
     RowBox[{"mminmax", ",", "couplingminmax"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NevMaxOverall", "=", 
   RowBox[{"Max", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"NevMax", "[", "prod", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionChannelsList"}], "}"}]}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NevIntOverall", "[", 
    RowBox[{"mLLP_", ",", "y_"}], "]"}], "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"NevInt", "[", 
      RowBox[{"mLLP", ",", "y", ",", "prod"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"prod", ",", "ProductionChannelsList"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pt", "[", "mLLP_", "]"}], ":=", 
  RowBox[{"LogLogPlot", "[", 
   RowBox[{
    RowBox[{"Evaluate", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"NevInt", "[", 
        RowBox[{"mLLP", ",", "y", ",", "prod"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"prod", ",", "ProductionChannelsList"}], "}"}]}], "]"}], 
     "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", 
      RowBox[{"couplingminmaxOverall", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"couplingminmaxOverall", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"Placed", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"#", ",", "15"}], "]"}], "&"}], "/@", 
        "ProductionChannelsList"}], ",", "Right"}], "]"}]}], ",", 
    RowBox[{"PlotRange", "->", 
     RowBox[{"{", 
      RowBox[{"couplingminmaxOverall", ",", 
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["10", 
          RowBox[{"-", "2"}]], ",", "NevMaxOverall"}], "}"}]}], "}"}]}], ",", 
    
    RowBox[{"Frame", "->", "True"}], ",", 
    RowBox[{"ImageSize", "->", "Large"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<y\>\"", " ", ",", " ", 
       "\"\<\!\(\*SubscriptBox[\(N\), \(events\)]\)[\!\(\*SubscriptBox[\(m\), \
\(a\)]\),y]\>\""}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", " ", "23"}], "]"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", 
         RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", 
         RowBox[{"Darker", "@", 
          RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Black"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Blue", ",", 
         RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", 
         RowBox[{"Darker", "@", "Red"}], ",", 
         RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", 
         RowBox[{"Darker", "@", 
          RowBox[{"Darker", "@", "Green"}]}], ",", 
         RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Black", ",", 
         RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{"{", 
         RowBox[{
         "GivenExperimentForSensitivityComputation", ",", 
          "\"\<. \!\(\*SubscriptBox[\(m\), \(a\)]\) = \>\"", ",", "mLLP", ",",
           " ", "\"\< GeV\>\""}], "}"}], "]"}], ",", "20", ",", "Black"}], 
      "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"pt", "[", "0.6", "]"}]}], "Input",
 CellChangeTimes->{{3.8889934219191484`*^9, 3.8889934572936487`*^9}, {
   3.888993488436164*^9, 3.888993519629824*^9}, {3.888993631131192*^9, 
   3.888993631767372*^9}, {3.8889941168931828`*^9, 3.888994131488901*^9}, {
   3.889154952022648*^9, 3.8891549556386337`*^9}, {3.88915555629116*^9, 
   3.889155565695465*^9}, {3.893234388228975*^9, 3.89323440249368*^9}, {
   3.893570918180713*^9, 3.8935709459623637`*^9}, {3.893570996934983*^9, 
   3.893571049142565*^9}, {3.893571774685277*^9, 3.893571780554794*^9}, {
   3.8935723217820005`*^9, 3.893572363431644*^9}, {3.893744918014161*^9, 
   3.893744938342885*^9}, {3.895052847928608*^9, 3.895052904223016*^9}, {
   3.896846565306531*^9, 3.896846570642375*^9}, 3.8991934061928263`*^9, {
   3.9037911184438295`*^9, 3.903791118468619*^9}, {3.903793882094927*^9, 
   3.903793882098492*^9}, {3.903797026745615*^9, 3.9037970452607584`*^9}, {
   3.9049216111057444`*^9, 3.904921662274201*^9}, {3.9049217218934116`*^9, 
   3.904921726199708*^9}, {3.90492396885961*^9, 3.904923969081383*^9}, {
   3.9049240804362497`*^9, 3.904924080508557*^9}, {3.904924179607125*^9, 
   3.904924179705194*^9}, {3.905241244077003*^9, 3.90524124436055*^9}, {
   3.905242084580451*^9, 3.905242093557647*^9}, {3.905242164124911*^9, 
   3.905242164296854*^9}, {3.9052422710738244`*^9, 3.905242280663824*^9}, 
   3.9052780094855423`*^9, {3.9054038445509152`*^9, 3.905403844832307*^9}, 
   3.905834623869658*^9, {3.9058347300087337`*^9, 3.905834752542229*^9}, {
   3.907411732383304*^9, 3.907411756240266*^9}, {3.907412241347188*^9, 
   3.9074122616342597`*^9}, {3.907646540157587*^9, 3.907646541817969*^9}, {
   3.907646769227744*^9, 3.907646770045806*^9}, {3.910262177159488*^9, 
   3.91026220038578*^9}, {3.910419860221153*^9, 3.91041992062967*^9}, {
   3.912155734548005*^9, 3.912155735176034*^9}, {3.913867551671985*^9, 
   3.9138675697677517`*^9}, {3.9138687892109585`*^9, 3.913868789217184*^9}, 
   3.9138694472004433`*^9, {3.913869518299142*^9, 3.913869518315772*^9}, {
   3.9138710596580105`*^9, 3.9138712184697266`*^9}, 3.9138714395639253`*^9, {
   3.913871484442711*^9, 3.913871484514428*^9}, {3.913964035930587*^9, 
   3.913964083316618*^9}, {3.913964151872108*^9, 3.913964242588086*^9}, 
   3.913964298376277*^9, {3.913965596246517*^9, 3.9139656080541754`*^9}, {
   3.913965955368236*^9, 3.9139659826523647`*^9}, {3.913967325277449*^9, 
   3.913967336029952*^9}, 3.914062808836896*^9, {3.915642977738755*^9, 
   3.915642977784467*^9}, {3.915820653287503*^9, 3.915820653297264*^9}, {
   3.918145415657481*^9, 3.9181454904587054`*^9}},
 CellTags->"Sensitivity-computation",
 CellLabel->
  "In[1617]:=",ExpressionUUID->"933c8a14-e475-435b-9eee-64b877f62c55"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Sensitivity computation", "Chapter",
 CellChangeTimes->{{3.8889936571476192`*^9, 3.88899365971122*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"70b84e06-d773-437f-8360-\
f1845520d830"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubscriptBox["N", "events"], TraditionalForm]],ExpressionUUID->
  "2ab19898-3d59-4e12-97e3-4459455aeff1"],
 " density plot"
}], "Section",
 CellChangeTimes->{{3.892912581226515*^9, 3.892912582686805*^9}, {
  3.892912635494676*^9, 3.89291263700839*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"d1f628ba-3bad-4159-94f9-\
0c8b5549e590"],

Cell[BoxData[{
 RowBox[{"plot", "=", 
  RowBox[{"DensityPlot", "[", 
   RowBox[{
    RowBox[{"Evaluate", "[", 
     RowBox[{"Log10", "[", 
      RowBox[{"NevIntOverall", "[", 
       RowBox[{"mLLP", ",", "y"}], "]"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"mLLP", ",", 
      RowBox[{"mminmaxOverall", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"mminmaxOverall", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", 
      RowBox[{"couplingminmaxOverall", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"couplingminmaxOverall", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"ScalingFunctions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Log\>\"", ",", "\"\<Log\>\""}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "0.78"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"All", ",", "All", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log10", "[", "2.3", "]"}], ",", 
         RowBox[{"Log10", "[", "NevMaxOverall", "]"}]}], "}"}]}], "}"}]}], 
    ",", 
    RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(m\), \(a\)]\) [GeV]\>\"", ",", "\"\<y\>\""}], 
      "}"}]}], ",", " ", 
    RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", " ", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", " ", "25"}], "]"}]}], ",", 
    RowBox[{"PlotPoints", "\[Rule]", "100"}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"Placed", "[", 
      RowBox[{
       RowBox[{"BarLegend", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Automatic", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Log10", "[", "2.3", "]"}], ",", 
             RowBox[{"Log10", "[", "NevMaxOverall", "]"}]}], "}"}]}], "}"}], 
         ",", 
         RowBox[{"LegendMarkerSize", "\[Rule]", "340"}], ",", 
         RowBox[{"LegendLabel", "\[Rule]", 
          RowBox[{"Placed", "[", 
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(Log\), \
\(10\)]\)[\!\(\*SubscriptBox[\(N\), \(ev\)]\)]\>\"", ",", "Bottom"}], "]"}]}],
          ",", 
         RowBox[{"LabelStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"FontSize", "\[Rule]", "22"}], "}"}]}], ",", 
         RowBox[{"Method", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
            RowBox[{"AxesStyle", "\[Rule]", "None"}], ",", 
            RowBox[{"TicksStyle", "\[Rule]", "Black"}]}], "}"}]}]}], "]"}], 
       ",", "Right"}], "]"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{"{", "ExperimentFolder", "}"}], "]"}], ",", "20", ",", 
       "Black"}], "]"}]}]}], 
   RowBox[{"(*", 
    RowBox[{",", 
     RowBox[{"FrameTicks", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Automatic", ",", "Automatic"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"TicksPlotx", ",", "None"}], "}"}]}], "}"}]}]}], "*)"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<plots/SensCalc/NeventsDensityPlotExample.pdf\>\""}], "}"}], 
      "]"}], ",", "plot", ",", 
     RowBox[{"\"\<AllowRasterization\>\"", "->", "False"}]}], "]"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.8929126599219103`*^9, 3.89291269568573*^9}, {
  3.893571057642872*^9, 3.893571063922956*^9}, {3.893744928154723*^9, 
  3.893744928154723*^9}, {3.8937450416896353`*^9, 3.8937450720779657`*^9}, {
  3.8937454492214108`*^9, 3.8937454519340353`*^9}, {3.9037896751851945`*^9, 
  3.9037896751902313`*^9}, {3.903790322054761*^9, 3.903790327609686*^9}, {
  3.903794580975305*^9, 3.903794589179802*^9}, {3.90379703592099*^9, 
  3.9037970359259787`*^9}, {3.91386755796309*^9, 3.913867557966664*^9}, {
  3.913964112108584*^9, 3.913964135212936*^9}, {3.913964310235572*^9, 
  3.9139643110894804`*^9}, {3.913965596263534*^9, 3.9139655962666063`*^9}, {
  3.915642977793975*^9, 3.9156429777981305`*^9}},
 CellTags->"Sensitivity-computation",
 CellLabel->
  "In[1635]:=",ExpressionUUID->"30f23ecc-adae-4e4e-bb37-3bcb631d2638"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Constraints importing", "Section",
 CellChangeTimes->{{3.895052713576123*^9, 3.895052715327282*^9}, {
  3.913967299387415*^9, 3.913967300849271*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"f8bcca72-97f4-4877-af48-\
43288ca88e21"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"importformat", "[", "\"\<txt\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"importformat", "[", "\"\<dat\>\"", "]"}], "=", 
      "\"\<Table\>\""}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"importformat", "[", "\"\<m\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"importformat", "[", "\"\<mx\>\"", "]"}], "=", "\"\<MX\>\""}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"importformat", "[", "\"\<xls\>\"", "]"}], "=", "\"\<XLS\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dir", "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<contours\>\"", ",",
         "LLPdirName"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"DirectoryQ", "[", "dir", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"filenames", "=", 
        RowBox[{"FileNames", "[", 
         RowBox[{
          RowBox[{"LLPdirName", "<>", "\"\<-excluded*\>\""}], ",", "dir", ",",
           "Infinity"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ExcludedRegions", "[", "LLPdirName", "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Import", "[", 
           RowBox[{"#", ",", 
            RowBox[{"importformat", "[", 
             RowBox[{"FileExtension", "[", "#", "]"}], "]"}]}], "]"}], "&"}], 
         "/@", 
         RowBox[{"FileNames", "[", 
          RowBox[{
           RowBox[{"LLPdirName", "<>", "\"\<-excluded*\>\""}], ",", "dir", 
           ",", "Infinity"}], "]"}]}]}], ";"}]}], "\[IndentingNewLine]", 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"!", 
      RowBox[{"DirectoryQ", "[", "dir", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ExcludedRegions", "[", "LLPdirName", "]"}], "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"10.", ",", "10."}], "}"}], "}"}], "}"}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.903794607976071*^9, 3.903794609139128*^9}, 
   3.9037950242375803`*^9, {3.914663829724105*^9, 3.9146638864002028`*^9}, {
   3.914663963479074*^9, 3.91466396912128*^9}, {3.915642977805637*^9, 
   3.915642977814176*^9}},
 CellTags->"Sensitivity-computation",
 CellLabel->
  "In[1636]:=",ExpressionUUID->"c305b913-cdc5-4677-8d25-2c15d3b88372"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Sensitivity", "Section",
 CellChangeTimes->{{3.895052721789363*^9, 3.895052722781258*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"93105a27-56ff-4fc6-9267-\
69c09e4a4e65"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SensitivityBlock", "[", 
   RowBox[{"Nev_", ",", "Npot_", ",", "SelectedProduction_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"NevTot", "[", 
       RowBox[{"mLLP_", ",", "y_"}], "]"}], "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"NevInt", "[", 
         RowBox[{"mLLP", ",", "y", ",", "prod"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "SelectedProduction"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RegSens1", "=", 
      RowBox[{"RegionPlot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          FractionBox["Npot", "NpotDefault"], 
          RowBox[{"NevTot", "[", 
           RowBox[{
            SuperscriptBox["10", "mLLP"], ",", 
            SuperscriptBox["10", "ga"]}], "]"}], "*", 
          RowBox[{"Boole", "[", 
           RowBox[{"!", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"0.125", "<", 
               SuperscriptBox["10", "mLLP"], "<", "0.14"}], "||", 
              RowBox[{"0.538", "<", 
               SuperscriptBox["10", "mLLP"], "<", "0.555"}], "||", 
              RowBox[{"0.94", "<", 
               SuperscriptBox["10", "mLLP"], "<", "0.974"}]}], ")"}]}], 
           "]"}]}], "\[GreaterEqual]", "Nev"}], ",", 
        RowBox[{"{", 
         RowBox[{"mLLP", ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"mminmaxOverall", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Log10", "[", "0.125", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"ga", ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"couplingminmaxOverall", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"couplingminmaxOverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotPoints", "->", "200"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RegSens2", "=", 
      RowBox[{"RegionPlot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          FractionBox["Npot", "NpotDefault"], 
          RowBox[{"NevTot", "[", 
           RowBox[{
            SuperscriptBox["10", "mLLP"], ",", 
            SuperscriptBox["10", "ga"]}], "]"}], "*", 
          RowBox[{"Boole", "[", 
           RowBox[{"!", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"0.125", "<", 
               SuperscriptBox["10", "mLLP"], "<", "0.14"}], "||", 
              RowBox[{"0.538", "<", 
               SuperscriptBox["10", "mLLP"], "<", "0.555"}], "||", 
              RowBox[{"0.94", "<", 
               SuperscriptBox["10", "mLLP"], "<", "0.974"}]}], ")"}]}], 
           "]"}]}], "\[GreaterEqual]", "Nev"}], ",", 
        RowBox[{"{", 
         RowBox[{"mLLP", ",", 
          RowBox[{"Log10", "[", "0.14", "]"}], ",", 
          RowBox[{"Log10", "[", "0.538", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"ga", ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"couplingminmaxOverall", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"couplingminmaxOverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotPoints", "->", "200"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RegSens3", "=", 
      RowBox[{"RegionPlot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          FractionBox["Npot", "NpotDefault"], 
          RowBox[{"NevTot", "[", 
           RowBox[{
            SuperscriptBox["10", "mLLP"], ",", 
            SuperscriptBox["10", "ga"]}], "]"}], "*", 
          RowBox[{"Boole", "[", 
           RowBox[{"!", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"0.125", "<", 
               SuperscriptBox["10", "mLLP"], "<", "0.14"}], "||", 
              RowBox[{"0.538", "<", 
               SuperscriptBox["10", "mLLP"], "<", "0.555"}], "||", 
              RowBox[{"0.94", "<", 
               SuperscriptBox["10", "mLLP"], "<", "0.974"}]}], ")"}]}], 
           "]"}]}], "\[GreaterEqual]", "Nev"}], ",", 
        RowBox[{"{", 
         RowBox[{"mLLP", ",", 
          RowBox[{"Log10", "[", "0.538", "]"}], ",", 
          RowBox[{"Log10", "[", "0.94", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"ga", ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"couplingminmaxOverall", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"couplingminmaxOverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotPoints", "->", "200"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RegSens4", "=", 
      RowBox[{"RegionPlot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          FractionBox["Npot", "NpotDefault"], 
          RowBox[{"NevTot", "[", 
           RowBox[{
            SuperscriptBox["10", "mLLP"], ",", 
            SuperscriptBox["10", "ga"]}], "]"}], "*", 
          RowBox[{"Boole", "[", 
           RowBox[{"!", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"0.125", "<", 
               SuperscriptBox["10", "mLLP"], "<", "0.14"}], "||", 
              RowBox[{"0.538", "<", 
               SuperscriptBox["10", "mLLP"], "<", "0.555"}], "||", 
              RowBox[{"0.94", "<", 
               SuperscriptBox["10", "mLLP"], "<", "0.974"}]}], ")"}]}], 
           "]"}]}], "\[GreaterEqual]", "Nev"}], ",", 
        RowBox[{"{", 
         RowBox[{"mLLP", ",", 
          RowBox[{"Log10", "[", "0.974", "]"}], ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"mminmaxOverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"ga", ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"couplingminmaxOverall", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"couplingminmaxOverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotPoints", "->", "200"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Sens", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"10", "^", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"10", "^", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], "&"}], "/@", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"Normal", "@", "RegSens"}], ",", 
              RowBox[{
               RowBox[{"Line", "[", "x_", "]"}], "\[RuleDelayed]", "x"}], ",",
               "Infinity"}], "]"}], "]"}], ",", "2"}], "]"}]}]}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"SensTemp", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"Normal", "@", "#"}], ",", 
          RowBox[{
           RowBox[{"Line", "[", "x_", "]"}], "\[RuleDelayed]", "x"}], ",", 
          "Infinity"}], "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{
        "RegSens1", ",", "RegSens2", ",", "RegSens3", ",", "RegSens4"}], 
        "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"SensTemp1", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"SensTemp", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"SensTemp", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"SensTemp", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", 
        RowBox[{"SensTemp", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Sens", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"10", "^", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"10", "^", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], "&"}], "/@", 
         RowBox[{"SensTemp1", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "SensTemp1", "]"}], ",", "1"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"directory", "[", "\"\<Sensitivity-LLP-exp\>\"", "]"}], ",", 
          RowBox[{"ToString", "@", 
           RowBox[{"StringForm", "[", 
            RowBox[{"\"\<Sensitivity_``_at_``_Nev=``_Npot=``.xls\>\"", ",", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"{", 
               RowBox[{"LLPdirName", ",", "ExperimentFolder", ",", 
                RowBox[{"Nev", "//", "ToString"}], ",", 
                RowBox[{
                 RowBox[{"Npot", "//", "CForm"}], "//", "ToString"}]}], 
               "}"}]}]}], "]"}]}]}], "}"}], "]"}], ",", "Sens"}], "]"}], ";", 
     "\[IndentingNewLine]", "Sens"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"productionlist", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", "\"\<All\>\"", "}"}], ",", "ProductionChannelsList"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DynamicModule", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"input1", "=", "NpotDefault"}], ",", 
      RowBox[{"input2", "=", "2.3"}], ",", 
      RowBox[{"choice", "=", 
       RowBox[{"{", "\"\<All\>\"", "}"}]}], ",", "list", ",", "phrase"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"DialogInput", "[", 
     RowBox[{"Column", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"GivenExperimentForSensitivityComputation", ",", "Bold"}], 
         "]"}], ",", 
        RowBox[{
        "TextCell", "[", "\"\<Enter the number of proton collisions:\>\"", 
         "]"}], ",", 
        RowBox[{"InputField", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "input1", "]"}], ",", "Expression"}], "]"}],
         ",", 
        RowBox[{
        "TextCell", "[", 
         "\"\<Enter the value of N_ev,min for which the sensitivity will be \
computed:\>\"", "]"}], ",", 
        RowBox[{"InputField", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "input2", "]"}], ",", "Expression"}], "]"}],
         ",", 
        RowBox[{"Row", "[", 
         RowBox[{
         "{", "\"\<Select the production channels to be used for the \
sensitivity calculation:\>\"", "}"}], "]"}], ",", 
        RowBox[{"Pane", "[", 
         RowBox[{
          RowBox[{"TogglerBar", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", "choice", "]"}], ",", "productionlist", 
            ",", 
            RowBox[{"Appearance", "->", 
             RowBox[{"\"\<Vertical\>\"", "->", 
              RowBox[{"{", 
               RowBox[{"Automatic", ",", "1"}], "}"}]}]}]}], "]"}], ",", 
          RowBox[{"ImageSize", "->", 
           RowBox[{"{", 
            RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], ",", 
          RowBox[{"Scrollbars", "->", 
           RowBox[{"{", 
            RowBox[{"False", ",", "True"}], "}"}]}]}], "]"}], ",", 
        RowBox[{"Button", "[", 
         RowBox[{"\"\<Submit\>\"", ",", 
          RowBox[{"DialogReturn", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"NpotVal", ",", "NevMinVal", ",", "SelectedProduction"}],
              "}"}], "=", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"input1", ",", "input2", ",", "choice"}], "}"}], "//", 
             "N"}]}], "]"}], ",", 
          RowBox[{"ImageSize", "->", "Automatic"}]}], "]"}]}], "}"}], "]"}], 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"MemberQ", "[", 
    RowBox[{"SelectedProduction", ",", "\"\<All\>\""}], "]"}], ",", 
   RowBox[{
    RowBox[{"SelectedProduction", "=", "ProductionChannelsList"}], ";"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(N\), \(PoT\)]\) for computation\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(N\), \(ev, min\)]\)\>\"", ",", 
      "\"\<Selected production modes\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"NpotVal", ",", "NevMinVal", ",", "SelectedProduction"}], 
     "}"}]}], "}"}], "//", "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sens", "=", 
   RowBox[{"SensitivityBlock", "[", 
    RowBox[{"NevMinVal", ",", "NpotVal", ",", "SelectedProduction"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListLogLogPlot", "[", 
    RowBox[{
     RowBox[{"Cases", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"sens", ",", 
         RowBox[{"ExcludedRegions", "[", "LLPdirName", "]"}]}], "}"}], ",", 
       RowBox[{"_", "?", "MatrixQ"}], ",", "All"}], "]"}], ",", 
     RowBox[{"Joined", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"True", ",", "True", ",", "True", ",", "True"}], "}"}]}], ",", 
     
     RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(m\), \(a\)]\) [GeV]\>\"", " ", ",", " ", 
        "\"\<\!\(\*SubscriptBox[\(g\), \(y\)]\) = 2\!\(\*SubscriptBox[\(v\), \
\(h\)]\)/\!\(\*SubscriptBox[\(f\), \(a\)]\)\>\""}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", " ", "23"}], "]"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ConstantArray", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MatrixQ", "[", "sens", "]"}], ",", "1", ",", 
              RowBox[{"Length", "@", "sens"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Thick", ",", "Gray"}], "}"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MatrixQ", "[", 
               RowBox[{"ExcludedRegions", "[", "LLPdirName", "]"}], "]"}], 
              ",", "1", ",", 
              RowBox[{"Length", "@", 
               RowBox[{"ExcludedRegions", "[", "LLPdirName", "]"}]}]}], 
             "]"}]}], "]"}]}], "}"}], ",", "1"}], "]"}]}], ",", 
     RowBox[{"Filling", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "sens", "]"}], "+", "1"}], "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"True", ",", 
           RowBox[{"Directive", "[", 
            RowBox[{"Gray", ",", 
             RowBox[{"Opacity", "[", "0.3", "]"}]}], "]"}]}], "}"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "sens", "]"}], "+", "2"}], "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"True", ",", 
           RowBox[{"Directive", "[", 
            RowBox[{"Gray", ",", 
             RowBox[{"Opacity", "[", "0.3", "]"}]}], "]"}]}], "}"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "sens", "]"}], "+", "3"}], "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"True", ",", 
           RowBox[{"Directive", "[", 
            RowBox[{"Gray", ",", 
             RowBox[{"Opacity", "[", "0.3", "]"}]}], "]"}]}], "}"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "sens", "]"}], "+", "4"}], "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"True", ",", 
           RowBox[{"Directive", "[", 
            RowBox[{"Gray", ",", 
             RowBox[{"Opacity", "[", "0.3", "]"}]}], "]"}]}], "}"}]}]}], 
       "}"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1.01", 
           RowBox[{"mminmaxOverall", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"1.1", 
           RowBox[{"mminmaxOverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"0.3", 
           RowBox[{"Min", "[", 
            RowBox[{"Flatten", "[", "Sens", "]"}], "]"}]}], ",", 
          RowBox[{"0.99", 
           RowBox[{"couplingminmaxOverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{
          "\"\<\!\(\*SubscriptBox[\(N\), \(events\)]\) \[GreaterEqual] \>\"", 
           ",", "NevMinVal"}], "}"}], "]"}], ",", "18", ",", "Black"}], 
       "]"}]}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"Placed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"#", ",", "15"}], "]"}], "&"}], "/@", 
         RowBox[{"{", "ExperimentFolder", "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"0.2", ",", "0.15"}], "}"}]}], "]"}]}]}], "]"}], 
   RowBox[{"(*", 
    RowBox[{",", 
     RowBox[{"LogLogPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", 
         SuperscriptBox["x", "2"], ",", 
         SuperscriptBox["x", "3"], ",", 
         SuperscriptBox["x", "4"], ",", 
         SuperscriptBox["x", "5"], ",", 
         SuperscriptBox["x", "6"]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0.05", ",", "62.49"}], "}"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.006", "]"}], ",", "Blue"}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.006", "]"}], ",", 
            RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.006", "]"}], ",", 
            RowBox[{"Darker", "@", "Red"}], ",", 
            RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.006", "]"}], ",", "Black"}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.01", "]"}], ",", 
            RowBox[{"Darker", "@", "Cyan"}], ",", 
            RowBox[{"Dashing", "[", "0.007", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", 
             RowBox[{"Darker", "@", "Green"}]}], ",", 
            RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", "Red"}]}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"#", ",", "15"}], "]"}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{
            "\"\<SHiP\>\"", ",", 
             "\"\<\!\(\*SubscriptBox[\(SHADOWS\), \(specified\\\ in\\\ LoI\)]\
\)\>\"", ",", 
             "\"\<\!\(\*SubscriptBox[\(SHADOWS\), \(specified\\\ by\\\ \
Gaia\)]\)\>\"", ",", " ", 
             "\"\<\!\(\*SubscriptBox[\(SHADOWS\), \(collab\\\ estimate\)]\)\>\
\""}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"0.26", ",", "0.15"}], "}"}]}], "]"}]}]}], "]"}]}], "*)"}],
    ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{"Text", "[", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"\"\<Excluded\>\"", ",", "24", ",", "Black"}], "]"}], ",", 
       RowBox[{"Scaled", "[", 
        RowBox[{"{", 
         RowBox[{"0.7", ",", "0.95"}], "}"}], "]"}]}], "]"}], "}"}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.888993699776234*^9, 3.888993738292191*^9}, {
   3.88899385262287*^9, 3.888993853042823*^9}, {3.88899390319474*^9, 
   3.8889939052817664`*^9}, {3.8889939588761797`*^9, 3.888994072394391*^9}, {
   3.8889941392721796`*^9, 3.8889941490041194`*^9}, {3.8889941930377913`*^9, 
   3.888994195131672*^9}, {3.8889942375929313`*^9, 3.888994293018688*^9}, 
   3.889155194091461*^9, {3.889155544467631*^9, 3.889155549549215*^9}, {
   3.893571069154917*^9, 3.893571071767774*^9}, {3.8935717622889113`*^9, 
   3.893571762661867*^9}, {3.893744928193007*^9, 3.893744928193007*^9}, {
   3.895052697251217*^9, 3.8950527065423837`*^9}, {3.895052741520686*^9, 
   3.895052773888977*^9}, {3.8950531140499234`*^9, 3.8950531238647203`*^9}, {
   3.895053472932121*^9, 3.8950534805926676`*^9}, {3.895054123563283*^9, 
   3.895054124582183*^9}, {3.89506997775191*^9, 3.895069978330577*^9}, 
   3.895076898280742*^9, {3.8955602490044713`*^9, 3.895560287932702*^9}, {
   3.895560370984571*^9, 3.8955603759796324`*^9}, {3.895560785367902*^9, 
   3.895560786049657*^9}, {3.8956541535400777`*^9, 3.895654263939839*^9}, {
   3.895654314007687*^9, 3.895654320367178*^9}, {3.895654423200385*^9, 
   3.895654448115474*^9}, {3.895654565591157*^9, 3.895654588365079*^9}, {
   3.89565495606467*^9, 3.8956549563255477`*^9}, {3.8961553899588175`*^9, 
   3.896155399739152*^9}, {3.897234346691803*^9, 3.897234358286152*^9}, {
   3.8975468465813932`*^9, 3.897546850816727*^9}, {3.8975468853793488`*^9, 
   3.897546895875827*^9}, {3.903791118494033*^9, 3.903791118498568*^9}, 
   3.903795098023933*^9, {3.903797035936547*^9, 3.903797035991943*^9}, 
   3.9037971257176876`*^9, {3.903797196741515*^9, 3.903797301701374*^9}, 
   3.903854322563696*^9, {3.906194481542715*^9, 3.9061945201280785`*^9}, {
   3.907258710089539*^9, 3.9072587160108223`*^9}, {3.912155799675736*^9, 
   3.912155807333581*^9}, {3.912164344972019*^9, 3.912164350952278*^9}, {
   3.9138675579944177`*^9, 3.913867558020425*^9}, {3.9138715965312796`*^9, 
   3.9138716276874847`*^9}, {3.9138719120212083`*^9, 3.913871919908587*^9}, {
   3.913964350487351*^9, 3.913964379658358*^9}, {3.9139655799631124`*^9, 
   3.913965596381463*^9}, {3.91466392193549*^9, 3.9146640546911325`*^9}, {
   3.915262539562829*^9, 3.9152625437365313`*^9}, 3.915298131057535*^9, {
   3.915642977846141*^9, 3.915642978040464*^9}},
 CellTags->"Sensitivity-computation",
 CellLabel->
  "In[1642]:=",ExpressionUUID->"9ff01d3d-2235-405c-ab36-8ec261f4d137"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Deleting generated cells", "Title",
 CellChangeTimes->{{3.902555946514994*^9, 
  3.9025559494966083`*^9}},ExpressionUUID->"519ed843-8f32-4e91-84d0-\
5f5d5f152eee"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FrontEndTokenExecute", "[", "\"\<DeleteGeneratedCells\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FrontEndTokenExecute", "[", "\"\<SelectAll\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "FrontEndTokenExecute", "[", "\"\<SelectionCloseAllGroups\>\"", "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9025559062888594`*^9, 3.9025559062888594`*^9}, {
   3.902555964086707*^9, 3.902555989355214*^9}, {3.902561568481839*^9, 
   3.902561569816837*^9}, {3.902729327686987*^9, 3.9027293300327225`*^9}, {
   3.9027673630554657`*^9, 3.902767365763246*^9}, {3.902856733042252*^9, 
   3.902856748718687*^9}, {3.9039717334857006`*^9, 3.903971734143115*^9}, {
   3.9181488428724*^9, 3.9181488454828224`*^9}, 3.920048625390925*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"da6a725b-270d-45e0-bd71-6f5132a81d48"]
}, Closed]]
},
WindowSize->{Full, Full},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
ShowCellTags->True,
FrontEndVersion->"14.0 para Mac OS X x86 (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"ccc6192f-1aa7-4a75-996f-24f618e62e06"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Acceptance"->{
  Cell[5635, 151, 350, 7, 112, "Title",ExpressionUUID->"dc98cc40-afde-45ba-ae22-74afbd95ce04",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[6010, 162, 227, 5, 83, "Chapter",ExpressionUUID->"1320ba97-7abe-4017-b5a5-ae36b7fec1b3",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[6240, 169, 3706, 96, 364, "Input",ExpressionUUID->"d67e103e-ff85-49fc-80ad-39fdd6887281",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[9983, 270, 290, 6, 82, "Chapter",ExpressionUUID->"9e90539e-357b-496f-b4bb-a60bd5224fbd",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[10276, 278, 15349, 390, 1460, "Input",ExpressionUUID->"81abd027-7ae4-4675-ae59-2bfc340f66bb",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[25662, 673, 803, 19, 82, "Chapter",ExpressionUUID->"979d2b9d-1e75-46f3-89d5-8590b80509b3",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[26490, 696, 295, 6, 81, "Section",ExpressionUUID->"dd9e6701-41aa-4962-a9b7-dd611f556fa6",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[26788, 704, 4334, 104, 481, "Input",ExpressionUUID->"d7f75d59-b6b8-43b5-84f6-94a071f6c958",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[31159, 813, 283, 6, 81, "Section",ExpressionUUID->"78ee7ba3-4532-4920-80f8-e1fc4e784430",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[31445, 821, 10523, 269, 832, "Input",ExpressionUUID->"fec40a05-ba64-4ab5-86c9-a0eb22a607d0",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[42005, 1095, 497, 9, 81, "Section",ExpressionUUID->"12e0bee4-6a1a-451c-b99f-fa0db8a155eb",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[42527, 1108, 369, 7, 67, "Subsection",ExpressionUUID->"0a5caafb-270c-4b49-8d0a-a733f8c6fed5",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[42899, 1117, 5357, 131, 392, "Input",ExpressionUUID->"6b40e71e-4d73-422f-a8a1-e2d1d3309f91",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[48317, 1255, 285, 6, 82, "Chapter",ExpressionUUID->"c9967d9e-0dfa-4ef8-95ab-cf6e6b36fed3",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[48605, 1263, 1400, 33, 188, "Input",ExpressionUUID->"23e88572-18a2-48b7-93ee-40187286fc03",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[50054, 1302, 260, 6, 111, "Title",ExpressionUUID->"bd147158-f526-489d-afb7-12c825eddce3",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[50317, 1310, 4932, 120, 542, "Input",ExpressionUUID->"c05031d8-0efd-4502-a294-675e6231eb7c",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[55274, 1434, 238, 5, 82, "Chapter",ExpressionUUID->"f6b19458-661d-4b9a-84b2-be5f3bbf270c",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[55515, 1441, 2153, 51, 506, "Input",ExpressionUUID->"4c060b6c-ecc3-4469-86c0-269c265b419b",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}]},
 "Number-of-events+sensitivity"->{
  Cell[5635, 151, 350, 7, 112, "Title",ExpressionUUID->"dc98cc40-afde-45ba-ae22-74afbd95ce04",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[6010, 162, 227, 5, 83, "Chapter",ExpressionUUID->"1320ba97-7abe-4017-b5a5-ae36b7fec1b3",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[6240, 169, 3706, 96, 364, "Input",ExpressionUUID->"d67e103e-ff85-49fc-80ad-39fdd6887281",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[9983, 270, 290, 6, 82, "Chapter",ExpressionUUID->"9e90539e-357b-496f-b4bb-a60bd5224fbd",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[10276, 278, 15349, 390, 1460, "Input",ExpressionUUID->"81abd027-7ae4-4675-ae59-2bfc340f66bb",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[25662, 673, 803, 19, 82, "Chapter",ExpressionUUID->"979d2b9d-1e75-46f3-89d5-8590b80509b3",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[26490, 696, 295, 6, 81, "Section",ExpressionUUID->"dd9e6701-41aa-4962-a9b7-dd611f556fa6",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[26788, 704, 4334, 104, 481, "Input",ExpressionUUID->"d7f75d59-b6b8-43b5-84f6-94a071f6c958",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[31159, 813, 283, 6, 81, "Section",ExpressionUUID->"78ee7ba3-4532-4920-80f8-e1fc4e784430",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[31445, 821, 10523, 269, 832, "Input",ExpressionUUID->"fec40a05-ba64-4ab5-86c9-a0eb22a607d0",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[42005, 1095, 497, 9, 81, "Section",ExpressionUUID->"12e0bee4-6a1a-451c-b99f-fa0db8a155eb",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[42527, 1108, 369, 7, 67, "Subsection",ExpressionUUID->"0a5caafb-270c-4b49-8d0a-a733f8c6fed5",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[42899, 1117, 5357, 131, 392, "Input",ExpressionUUID->"6b40e71e-4d73-422f-a8a1-e2d1d3309f91",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[48317, 1255, 285, 6, 82, "Chapter",ExpressionUUID->"c9967d9e-0dfa-4ef8-95ab-cf6e6b36fed3",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[48605, 1263, 1400, 33, 188, "Input",ExpressionUUID->"23e88572-18a2-48b7-93ee-40187286fc03",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[50054, 1302, 260, 6, 111, "Title",ExpressionUUID->"bd147158-f526-489d-afb7-12c825eddce3",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[50317, 1310, 4932, 120, 542, "Input",ExpressionUUID->"c05031d8-0efd-4502-a294-675e6231eb7c",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[55274, 1434, 238, 5, 82, "Chapter",ExpressionUUID->"f6b19458-661d-4b9a-84b2-be5f3bbf270c",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[55515, 1441, 2153, 51, 506, "Input",ExpressionUUID->"4c060b6c-ecc3-4469-86c0-269c265b419b",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}]},
 "Number-of-events-computation+sensitivity"->{
  Cell[57717, 1498, 214, 4, 111, "Title",ExpressionUUID->"3e9a02fd-97c3-44ee-9f5b-9ca3983b66da",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[57956, 1506, 304, 6, 82, "Chapter",ExpressionUUID->"b58a105b-0eb2-42ec-8386-a1aec7ee56e5",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[58263, 1514, 358, 9, 57, "Input",ExpressionUUID->"cd85975d-be44-4973-874e-283780fb4371",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[58658, 1528, 312, 6, 82, "Chapter",ExpressionUUID->"4cb86986-b7a3-4409-91ed-f7461f351ed0",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[58973, 1536, 13620, 334, 868, "Input",ExpressionUUID->"5e37716e-c5ef-4959-a8f2-3412a62b2217",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[72630, 1875, 505, 8, 82, "Chapter",ExpressionUUID->"41c8c006-200d-49b8-91a2-db90a194f508",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[73138, 1885, 14757, 383, 1333, "Input",ExpressionUUID->"62819a8f-ef93-4611-8129-3022b4040630",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[87932, 2273, 218, 4, 82, "Chapter",ExpressionUUID->"913a2300-dec2-4b0f-8b44-4b75cf0adccf",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[88175, 2281, 330, 6, 81, "Section",ExpressionUUID->"c94998ff-f59b-459d-be1c-ddc73e99c9ae",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[88530, 2291, 388, 7, 67, "Subsection",ExpressionUUID->"7f579b6b-5ef4-4a58-9013-8c1dd56d76ec",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[88921, 2300, 9116, 215, 716, "Input",ExpressionUUID->"48950797-56e6-42de-8395-450c95505cf7",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[98074, 2520, 260, 5, 67, "Subsection",ExpressionUUID->"44c5d7dc-f4d8-4683-af20-91145a2314a0",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[98337, 2527, 17922, 453, 1310, "Input",ExpressionUUID->"12dd6420-8c42-4806-b7fe-f40c3a254e24",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[116296, 2985, 282, 5, 68, "Subsection",ExpressionUUID->"5711c196-5f6f-42a6-9eb3-4b39f13fa8ea",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[116603, 2994, 249, 5, 59, "Subsubsection",ExpressionUUID->"54d39439-f77a-4f87-9127-6cea0da2e472",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[116855, 3001, 5774, 132, 443, "Input",ExpressionUUID->"fe30cfbc-c6a5-4446-91f9-40458edebe07",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[122678, 3139, 309, 6, 68, "Subsection",ExpressionUUID->"b8339207-1749-4c68-88c0-88356257de98",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[122990, 3147, 5762, 125, 330, "Input",ExpressionUUID->"071a453e-c563-482b-9648-d4047b0165a9",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[128789, 3277, 333, 8, 68, "Subsection",ExpressionUUID->"6bf34b32-d93c-4cd2-aff7-0161ce769f26",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[129125, 3287, 9353, 233, 607, "Input",ExpressionUUID->"242885b3-5b9f-46f1-af82-c6520d0e3109",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[138527, 3526, 305, 6, 81, "Section",ExpressionUUID->"167f2e29-d8ac-4d05-ba40-dc1f6e10be8e",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[138857, 3536, 280, 5, 68, "Subsection",ExpressionUUID->"f24bf8ca-a4fe-4caa-91a9-196241966aee",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[139140, 3543, 11792, 273, 596, "Input",ExpressionUUID->"593ffff2-9bb4-46f4-97b7-3e70963ba6d2",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[150969, 3821, 232, 4, 68, "Subsection",ExpressionUUID->"f30415e2-9b73-40ca-8e93-e38cc874c0c3",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[151204, 3827, 22144, 515, 1622, "Input",ExpressionUUID->"96a90d25-fa01-4601-87c3-3de8f9d226a6",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[173421, 4350, 260, 5, 112, "Title",ExpressionUUID->"0923b405-c0ba-437a-a0a1-eb2d8707c8c5",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[173706, 4359, 211, 4, 83, "Chapter",ExpressionUUID->"2ada0cc1-1695-4a57-a86b-b11e240b979f",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[173920, 4365, 7156, 146, 552, "Input",ExpressionUUID->"d36d89ea-2d97-457b-aa5b-4b098e8235d8",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[181113, 4516, 209, 4, 83, "Chapter",ExpressionUUID->"a58bd3a7-f345-470d-ba5e-82c520e24a7e",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[181347, 4524, 219, 4, 81, "Section",ExpressionUUID->"d9a2b292-24ca-4f51-9905-1bcde103c869",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[181569, 4530, 3569, 83, 373, "Input",ExpressionUUID->"b5ddb613-f8ce-4354-bf3e-3dc63b62f3d5",
   CellTags->"Number-of-events-computation+sensitivity"]},
 "Acceptance-computation"->{
  Cell[57956, 1506, 304, 6, 82, "Chapter",ExpressionUUID->"b58a105b-0eb2-42ec-8386-a1aec7ee56e5",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[58263, 1514, 358, 9, 57, "Input",ExpressionUUID->"cd85975d-be44-4973-874e-283780fb4371",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[58658, 1528, 312, 6, 82, "Chapter",ExpressionUUID->"4cb86986-b7a3-4409-91ed-f7461f351ed0",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[58973, 1536, 13620, 334, 868, "Input",ExpressionUUID->"5e37716e-c5ef-4959-a8f2-3412a62b2217",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[72630, 1875, 505, 8, 82, "Chapter",ExpressionUUID->"41c8c006-200d-49b8-91a2-db90a194f508",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[73138, 1885, 14757, 383, 1333, "Input",ExpressionUUID->"62819a8f-ef93-4611-8129-3022b4040630",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[88175, 2281, 330, 6, 81, "Section",ExpressionUUID->"c94998ff-f59b-459d-be1c-ddc73e99c9ae",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[88530, 2291, 388, 7, 67, "Subsection",ExpressionUUID->"7f579b6b-5ef4-4a58-9013-8c1dd56d76ec",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[88921, 2300, 9116, 215, 716, "Input",ExpressionUUID->"48950797-56e6-42de-8395-450c95505cf7",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[98074, 2520, 260, 5, 67, "Subsection",ExpressionUUID->"44c5d7dc-f4d8-4683-af20-91145a2314a0",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[98337, 2527, 17922, 453, 1310, "Input",ExpressionUUID->"12dd6420-8c42-4806-b7fe-f40c3a254e24",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[116296, 2985, 282, 5, 68, "Subsection",ExpressionUUID->"5711c196-5f6f-42a6-9eb3-4b39f13fa8ea",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[116603, 2994, 249, 5, 59, "Subsubsection",ExpressionUUID->"54d39439-f77a-4f87-9127-6cea0da2e472",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[116855, 3001, 5774, 132, 443, "Input",ExpressionUUID->"fe30cfbc-c6a5-4446-91f9-40458edebe07",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[122678, 3139, 309, 6, 68, "Subsection",ExpressionUUID->"b8339207-1749-4c68-88c0-88356257de98",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[122990, 3147, 5762, 125, 330, "Input",ExpressionUUID->"071a453e-c563-482b-9648-d4047b0165a9",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[128789, 3277, 333, 8, 68, "Subsection",ExpressionUUID->"6bf34b32-d93c-4cd2-aff7-0161ce769f26",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[129125, 3287, 9353, 233, 607, "Input",ExpressionUUID->"242885b3-5b9f-46f1-af82-c6520d0e3109",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}]},
 "Sensitivity"->{
  Cell[185199, 4620, 189, 3, 112, "Title",ExpressionUUID->"43632709-93c8-43ea-aac4-c4cdd9738fd6",
   CellTags->"Sensitivity"],
  Cell[185413, 4627, 186, 3, 83, "Chapter",ExpressionUUID->"c47d29ae-1d53-4941-a324-cae19d7aa2d4",
   CellTags->"Sensitivity"],
  Cell[185602, 4632, 7309, 190, 927, "Input",ExpressionUUID->"f7b1c868-dce7-4820-abe5-5a1951693960",
   CellTags->"Sensitivity"]},
 "Sensitivity-computation"->{
  Cell[193079, 4832, 315, 7, 83, "Chapter",ExpressionUUID->"4f28db5f-3e98-48c2-a98d-ef371754d56f",
   CellTags->"Sensitivity-computation"],
  Cell[193419, 4843, 206, 4, 81, "Section",ExpressionUUID->"a2df8568-b188-42b9-a9ff-c2eef351309c",
   CellTags->"Sensitivity-computation"],
  Cell[193628, 4849, 3749, 93, 514, "Input",ExpressionUUID->"7514cf55-f983-402c-aa09-fecdad6ca627",
   CellTags->"Sensitivity-computation"],
  Cell[197414, 4947, 210, 4, 81, "Section",ExpressionUUID->"394e46f6-d9e3-4b2a-ae85-1d9a1c0b0481",
   CellTags->"Sensitivity-computation"],
  Cell[197627, 4953, 16840, 420, 1353, "Input",ExpressionUUID->"933c8a14-e475-435b-9eee-64b877f62c55",
   CellTags->"Sensitivity-computation"],
  Cell[214516, 5379, 207, 4, 83, "Chapter",ExpressionUUID->"70b84e06-d773-437f-8360-f1845520d830",
   CellTags->"Sensitivity-computation"],
  Cell[214748, 5387, 395, 11, 82, "Section",ExpressionUUID->"d1f628ba-3bad-4159-94f9-0c8b5549e590",
   CellTags->"Sensitivity-computation"],
  Cell[215146, 5400, 4508, 112, 246, "Input",ExpressionUUID->"30f23ecc-adae-4e4e-bb37-3bcb631d2638",
   CellTags->"Sensitivity-computation"],
  Cell[219691, 5517, 253, 5, 81, "Section",ExpressionUUID->"f8bcca72-97f4-4877-af48-43288ca88e21",
   CellTags->"Sensitivity-computation"],
  Cell[219947, 5524, 2605, 68, 351, "Input",ExpressionUUID->"c305b913-cdc5-4677-8d25-2c15d3b88372",
   CellTags->"Sensitivity-computation"],
  Cell[222589, 5597, 194, 4, 81, "Section",ExpressionUUID->"93105a27-56ff-4fc6-9267-69c09e4a4e65",
   CellTags->"Sensitivity-computation"],
  Cell[222786, 5603, 23054, 574, 1550, "Input",ExpressionUUID->"9ff01d3d-2235-405c-ab36-8ec261f4d137",
   CellTags->"Sensitivity-computation"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Acceptance", 247381, 6222},
 {"Number-of-events+sensitivity", 250461, 6261},
 {"Number-of-events-computation+sensitivity", 253553, 6300},
 {"Acceptance-computation", 258993, 6363},
 {"Sensitivity", 262369, 6400},
 {"Sensitivity-computation", 262785, 6407}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 205, 3, 98, "Title",ExpressionUUID->"0839ea5b-1982-4dfb-8c5d-195bcd99f6e9"],
Cell[788, 27, 4810, 119, 616, "Input",ExpressionUUID->"3ff672e3-e982-49fe-8fe3-e69285f06990"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5635, 151, 350, 7, 112, "Title",ExpressionUUID->"dc98cc40-afde-45ba-ae22-74afbd95ce04",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[CellGroupData[{
Cell[6010, 162, 227, 5, 83, "Chapter",ExpressionUUID->"1320ba97-7abe-4017-b5a5-ae36b7fec1b3",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[6240, 169, 3706, 96, 364, "Input",ExpressionUUID->"d67e103e-ff85-49fc-80ad-39fdd6887281",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[9983, 270, 290, 6, 82, "Chapter",ExpressionUUID->"9e90539e-357b-496f-b4bb-a60bd5224fbd",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[10276, 278, 15349, 390, 1460, "Input",ExpressionUUID->"81abd027-7ae4-4675-ae59-2bfc340f66bb",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[25662, 673, 803, 19, 82, "Chapter",ExpressionUUID->"979d2b9d-1e75-46f3-89d5-8590b80509b3",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[CellGroupData[{
Cell[26490, 696, 295, 6, 81, "Section",ExpressionUUID->"dd9e6701-41aa-4962-a9b7-dd611f556fa6",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[26788, 704, 4334, 104, 481, "Input",ExpressionUUID->"d7f75d59-b6b8-43b5-84f6-94a071f6c958",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[31159, 813, 283, 6, 81, "Section",ExpressionUUID->"78ee7ba3-4532-4920-80f8-e1fc4e784430",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[31445, 821, 10523, 269, 832, "Input",ExpressionUUID->"fec40a05-ba64-4ab5-86c9-a0eb22a607d0",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[42005, 1095, 497, 9, 81, "Section",ExpressionUUID->"12e0bee4-6a1a-451c-b99f-fa0db8a155eb",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[CellGroupData[{
Cell[42527, 1108, 369, 7, 67, "Subsection",ExpressionUUID->"0a5caafb-270c-4b49-8d0a-a733f8c6fed5",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[42899, 1117, 5357, 131, 392, "Input",ExpressionUUID->"6b40e71e-4d73-422f-a8a1-e2d1d3309f91",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[48317, 1255, 285, 6, 82, "Chapter",ExpressionUUID->"c9967d9e-0dfa-4ef8-95ab-cf6e6b36fed3",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[48605, 1263, 1400, 33, 188, "Input",ExpressionUUID->"23e88572-18a2-48b7-93ee-40187286fc03",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[50054, 1302, 260, 6, 111, "Title",ExpressionUUID->"bd147158-f526-489d-afb7-12c825eddce3",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[50317, 1310, 4932, 120, 542, "Input",ExpressionUUID->"c05031d8-0efd-4502-a294-675e6231eb7c",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[CellGroupData[{
Cell[55274, 1434, 238, 5, 82, "Chapter",ExpressionUUID->"f6b19458-661d-4b9a-84b2-be5f3bbf270c",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[55515, 1441, 2153, 51, 506, "Input",ExpressionUUID->"4c060b6c-ecc3-4469-86c0-269c265b419b",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[57717, 1498, 214, 4, 111, "Title",ExpressionUUID->"3e9a02fd-97c3-44ee-9f5b-9ca3983b66da",
 CellTags->"Number-of-events-computation+sensitivity"],
Cell[CellGroupData[{
Cell[57956, 1506, 304, 6, 82, "Chapter",ExpressionUUID->"b58a105b-0eb2-42ec-8386-a1aec7ee56e5",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[58263, 1514, 358, 9, 57, "Input",ExpressionUUID->"cd85975d-be44-4973-874e-283780fb4371",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[58658, 1528, 312, 6, 82, "Chapter",ExpressionUUID->"4cb86986-b7a3-4409-91ed-f7461f351ed0",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[58973, 1536, 13620, 334, 868, "Input",ExpressionUUID->"5e37716e-c5ef-4959-a8f2-3412a62b2217",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[72630, 1875, 505, 8, 82, "Chapter",ExpressionUUID->"41c8c006-200d-49b8-91a2-db90a194f508",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[73138, 1885, 14757, 383, 1333, "Input",ExpressionUUID->"62819a8f-ef93-4611-8129-3022b4040630",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[87932, 2273, 218, 4, 82, "Chapter",ExpressionUUID->"913a2300-dec2-4b0f-8b44-4b75cf0adccf",
 CellTags->"Number-of-events-computation+sensitivity"],
Cell[CellGroupData[{
Cell[88175, 2281, 330, 6, 81, "Section",ExpressionUUID->"c94998ff-f59b-459d-be1c-ddc73e99c9ae",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[CellGroupData[{
Cell[88530, 2291, 388, 7, 67, "Subsection",ExpressionUUID->"7f579b6b-5ef4-4a58-9013-8c1dd56d76ec",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[88921, 2300, 9116, 215, 716, "Input",ExpressionUUID->"48950797-56e6-42de-8395-450c95505cf7",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[98074, 2520, 260, 5, 67, "Subsection",ExpressionUUID->"44c5d7dc-f4d8-4683-af20-91145a2314a0",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[98337, 2527, 17922, 453, 1310, "Input",ExpressionUUID->"12dd6420-8c42-4806-b7fe-f40c3a254e24",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[116296, 2985, 282, 5, 68, "Subsection",ExpressionUUID->"5711c196-5f6f-42a6-9eb3-4b39f13fa8ea",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[CellGroupData[{
Cell[116603, 2994, 249, 5, 59, "Subsubsection",ExpressionUUID->"54d39439-f77a-4f87-9127-6cea0da2e472",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[116855, 3001, 5774, 132, 443, "Input",ExpressionUUID->"fe30cfbc-c6a5-4446-91f9-40458edebe07",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[122678, 3139, 309, 6, 68, "Subsection",ExpressionUUID->"b8339207-1749-4c68-88c0-88356257de98",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
Cell[122990, 3147, 5762, 125, 330, "Input",ExpressionUUID->"071a453e-c563-482b-9648-d4047b0165a9",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[128789, 3277, 333, 8, 68, "Subsection",ExpressionUUID->"6bf34b32-d93c-4cd2-aff7-0161ce769f26",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
Cell[129125, 3287, 9353, 233, 607, "Input",ExpressionUUID->"242885b3-5b9f-46f1-af82-c6520d0e3109",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[138527, 3526, 305, 6, 81, "Section",ExpressionUUID->"167f2e29-d8ac-4d05-ba40-dc1f6e10be8e",
 CellTags->"Number-of-events-computation+sensitivity"],
Cell[CellGroupData[{
Cell[138857, 3536, 280, 5, 68, "Subsection",ExpressionUUID->"f24bf8ca-a4fe-4caa-91a9-196241966aee",
 CellTags->"Number-of-events-computation+sensitivity"],
Cell[139140, 3543, 11792, 273, 596, "Input",ExpressionUUID->"593ffff2-9bb4-46f4-97b7-3e70963ba6d2",
 CellTags->"Number-of-events-computation+sensitivity"]
}, Open  ]],
Cell[CellGroupData[{
Cell[150969, 3821, 232, 4, 68, "Subsection",ExpressionUUID->"f30415e2-9b73-40ca-8e93-e38cc874c0c3",
 CellTags->"Number-of-events-computation+sensitivity"],
Cell[151204, 3827, 22144, 515, 1622, "Input",ExpressionUUID->"96a90d25-fa01-4601-87c3-3de8f9d226a6",
 CellTags->"Number-of-events-computation+sensitivity"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[173421, 4350, 260, 5, 112, "Title",ExpressionUUID->"0923b405-c0ba-437a-a0a1-eb2d8707c8c5",
 CellTags->"Number-of-events-computation+sensitivity"],
Cell[CellGroupData[{
Cell[173706, 4359, 211, 4, 83, "Chapter",ExpressionUUID->"2ada0cc1-1695-4a57-a86b-b11e240b979f",
 CellTags->"Number-of-events-computation+sensitivity"],
Cell[173920, 4365, 7156, 146, 552, "Input",ExpressionUUID->"d36d89ea-2d97-457b-aa5b-4b098e8235d8",
 CellTags->"Number-of-events-computation+sensitivity"]
}, Open  ]],
Cell[CellGroupData[{
Cell[181113, 4516, 209, 4, 83, "Chapter",ExpressionUUID->"a58bd3a7-f345-470d-ba5e-82c520e24a7e",
 CellTags->"Number-of-events-computation+sensitivity"],
Cell[CellGroupData[{
Cell[181347, 4524, 219, 4, 81, "Section",ExpressionUUID->"d9a2b292-24ca-4f51-9905-1bcde103c869",
 CellTags->"Number-of-events-computation+sensitivity"],
Cell[181569, 4530, 3569, 83, 373, "Input",ExpressionUUID->"b5ddb613-f8ce-4354-bf3e-3dc63b62f3d5",
 CellTags->"Number-of-events-computation+sensitivity"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[185199, 4620, 189, 3, 112, "Title",ExpressionUUID->"43632709-93c8-43ea-aac4-c4cdd9738fd6",
 CellTags->"Sensitivity"],
Cell[CellGroupData[{
Cell[185413, 4627, 186, 3, 83, "Chapter",ExpressionUUID->"c47d29ae-1d53-4941-a324-cae19d7aa2d4",
 CellTags->"Sensitivity"],
Cell[185602, 4632, 7309, 190, 927, "Input",ExpressionUUID->"f7b1c868-dce7-4820-abe5-5a1951693960",
 CellTags->"Sensitivity"],
Cell[192914, 4824, 128, 3, 30, "Input",ExpressionUUID->"599d9a02-c6ca-4c42-afbf-30fec1b5ea91"]
}, Open  ]],
Cell[CellGroupData[{
Cell[193079, 4832, 315, 7, 83, "Chapter",ExpressionUUID->"4f28db5f-3e98-48c2-a98d-ef371754d56f",
 CellTags->"Sensitivity-computation"],
Cell[CellGroupData[{
Cell[193419, 4843, 206, 4, 81, "Section",ExpressionUUID->"a2df8568-b188-42b9-a9ff-c2eef351309c",
 CellTags->"Sensitivity-computation"],
Cell[193628, 4849, 3749, 93, 514, "Input",ExpressionUUID->"7514cf55-f983-402c-aa09-fecdad6ca627",
 CellTags->"Sensitivity-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[197414, 4947, 210, 4, 81, "Section",ExpressionUUID->"394e46f6-d9e3-4b2a-ae85-1d9a1c0b0481",
 CellTags->"Sensitivity-computation"],
Cell[197627, 4953, 16840, 420, 1353, "Input",ExpressionUUID->"933c8a14-e475-435b-9eee-64b877f62c55",
 CellTags->"Sensitivity-computation"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[214516, 5379, 207, 4, 83, "Chapter",ExpressionUUID->"70b84e06-d773-437f-8360-f1845520d830",
 CellTags->"Sensitivity-computation"],
Cell[CellGroupData[{
Cell[214748, 5387, 395, 11, 82, "Section",ExpressionUUID->"d1f628ba-3bad-4159-94f9-0c8b5549e590",
 CellTags->"Sensitivity-computation"],
Cell[215146, 5400, 4508, 112, 246, "Input",ExpressionUUID->"30f23ecc-adae-4e4e-bb37-3bcb631d2638",
 CellTags->"Sensitivity-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[219691, 5517, 253, 5, 81, "Section",ExpressionUUID->"f8bcca72-97f4-4877-af48-43288ca88e21",
 CellTags->"Sensitivity-computation"],
Cell[219947, 5524, 2605, 68, 351, "Input",ExpressionUUID->"c305b913-cdc5-4677-8d25-2c15d3b88372",
 CellTags->"Sensitivity-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[222589, 5597, 194, 4, 81, "Section",ExpressionUUID->"93105a27-56ff-4fc6-9267-69c09e4a4e65",
 CellTags->"Sensitivity-computation"],
Cell[222786, 5603, 23054, 574, 1550, "Input",ExpressionUUID->"9ff01d3d-2235-405c-ab36-8ec261f4d137",
 CellTags->"Sensitivity-computation"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[245901, 6184, 169, 3, 98, "Title",ExpressionUUID->"519ed843-8f32-4e91-84d0-5f5d5f152eee"],
Cell[246073, 6189, 880, 17, 67, "Input",ExpressionUUID->"da6a725b-270d-45e0-bd71-6f5132a81d48"]
}, Closed]]
}
]
*)

