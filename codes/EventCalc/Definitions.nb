(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    103695,       2260]
NotebookOptionsPosition[    101149,       2208]
NotebookOutlinePosition[    101584,       2225]
CellTagsIndexPosition[    101541,       2222]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Some compiled codes and basic definitions", "Chapter",
 CellChangeTimes->{{3.9261335625257215`*^9, 3.926133565728759*^9}, {
  3.926133720005872*^9, 
  3.9261337231668644`*^9}},ExpressionUUID->"d7be49df-2bf3-43f5-ba3c-\
41377b65e643"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "indices", " ", "of", " ", "the", " ", "columns", " ", "corresponding", 
    " ", "to", " ", "the", " ", "output", " ", "data", " ", "for", " ", 
    "decaying", " ", "LLPs"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "indexpx", ",", "indexpy", ",", "indexpz", ",", "indexenergy", ",", 
       "indexmass", ",", "indexc\[Theta]", ",", "indexptom", ",", "indexpdec",
        ",", "indexxdec", ",", "indexydec", ",", "indexzdec", ",", 
       "indexazacc", ",", "indexnprodtot", ",", "indexyield"}], "}"}], "=", 
     RowBox[{"Range", "[", 
      RowBox[{"1", ",", "14"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"valsComp", "=", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"data", ",", "_Real", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "_Integer"}], "}"}]}], "}"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"data", ",", "i"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"-", "90."}], ",", 
         RowBox[{"Log10", "[", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"data", ",", "i"}], "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"CompilationTarget", "->", "\"\<MVM\>\""}], ",", 
       RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
       RowBox[{"RuntimeAttributes", "->", 
        RowBox[{"{", "Listable", "}"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DataLogarithmiedComp", "=", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"data", ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"data", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"data", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Compile`GetElement", "[", 
             RowBox[{"data", ",", "3"}], "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{"Log", "[", 
            SuperscriptBox["10", 
             RowBox[{"-", "90."}]], "]"}], ",", 
           RowBox[{"Log", "[", 
            RowBox[{"Compile`GetElement", "[", 
             RowBox[{"data", ",", "3"}], "]"}], "]"}]}], "]"}]}], "}"}], ",", 
       RowBox[{"CompilationTarget", "\[Rule]", "\"\<MVM\>\""}], ",", 
       RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
       RowBox[{"RuntimeAttributes", "->", 
        RowBox[{"{", "Listable", "}"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Shortland", " ", "notations", " ", "for", " ", 
     RowBox[{"RuleOwn", "@", " ", "and"}], " ", 
     RowBox[{"RuleDown", "@"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{"ruleDown", ",", "HoldAll"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ruleDown", "[", "list_", "]"}], ":=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"DownValues", "/@", 
      RowBox[{"(", 
       RowBox[{"Unevaluated", "@", "list"}], ")"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{"ruleOwn", ",", "HoldAll"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"ruleOwn", "[", "list_", "]"}], ":=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"OwnValues", "/@", 
      RowBox[{"(", 
       RowBox[{"Unevaluated", "@", "list"}], ")"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dropdownDialog", "[", 
     RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
    RowBox[{"DialogInput", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
      RowBox[{"Column", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
         RowBox[{"PopupMenu", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
         RowBox[{"Button", "[", 
          RowBox[{"\"\<OK\>\"", ",", 
           RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
       "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"infoDialog", "[", "phrase_", "]"}], ":=", 
    RowBox[{"DialogInput", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
      RowBox[{"Column", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
         RowBox[{"Button", "[", 
          RowBox[{"\"\<Proceed\>\"", ",", 
           RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
       "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"selectionDialog", "[", 
     RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
    RowBox[{"DialogInput", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"choice", "=", 
        RowBox[{"{", "}"}]}], "}"}], ",", 
      RowBox[{"Column", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Row", "[", 
          RowBox[{"{", "phrase", "}"}], "]"}], ",", 
         RowBox[{"Pane", "[", 
          RowBox[{
           RowBox[{"TogglerBar", "[", 
            RowBox[{
             RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list", ",", 
             RowBox[{"Appearance", "->", 
              RowBox[{"\"\<Vertical\>\"", "->", 
               RowBox[{"{", 
                RowBox[{"Automatic", ",", "5"}], "}"}]}]}]}], "]"}], ",", 
           RowBox[{"ImageSize", "->", 
            RowBox[{"{", 
             RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], ",", 
           RowBox[{"Scrollbars", "->", 
            RowBox[{"{", 
             RowBox[{"False", ",", "True"}], "}"}]}]}], "]"}], ",", 
         RowBox[{"Button", "[", 
          RowBox[{"\"\<OK\>\"", ",", 
           RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
       "]"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.926133718466426*^9, 3.9261337409922743`*^9}, {
  3.9261456493161173`*^9, 3.926145649661745*^9}, {3.9290932233946686`*^9, 
  3.9290932235952168`*^9}, {3.931249237921031*^9, 3.9312492563963003`*^9}, {
  3.931249589732275*^9, 3.9312495942457952`*^9}, {3.931249654423868*^9, 
  3.931249656223455*^9}},ExpressionUUID->"c2e6ed6f-6c23-4776-b163-\
326a04f3ebf9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Parameters", "Chapter",
 CellChangeTimes->{{3.9261336862494335`*^9, 
  3.9261336875712447`*^9}},ExpressionUUID->"c7c96310-9bf8-4b94-933a-\
6878fa052910"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "PDG", " ", "identifiers", " ", "of", " ", "the", " ", "decay", " ", 
     RowBox[{"products", ".", " ", 
      OverscriptBox["g", "_"]}], " ", "is", " ", "formally", " ", 
     "introduced", " ", "as", " ", "an", " ", "antiparticle", " ", "to", " ", 
     "g"}], ",", " ", 
    RowBox[{
     RowBox[{
     "to", " ", "allow", " ", "the", " ", "routine", " ", "calculating", " ", 
      "the", " ", "decay", " ", "acceptance", " ", "for", " ", "experiments", 
      " ", "without", " ", "calorimeter", " ", "decay", " ", 
      RowBox[{"e", ".", "g", ".", " ", "S"}]}], "\[Rule]", "gg"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ListSMparticlesSymbols", "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(e\), \(-\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(e\), \(+\)]\)\>\"", ",", "\"\<\[Nu]\>\"", 
       ",", "\"\<\!\(\*OverscriptBox[\(\[Nu]\), \(_\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(e\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(\[Mu]\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(\[Tau]\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Nu]\), \(_\)], \(e\)]\)\>\"",
        ",", "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Nu]\), \(_\)], \(\[Mu]\
\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Nu]\), \(_\)], \(\[Tau]\)]\)\
\>\"", ",", "\"\<\!\(\*SubscriptBox[\(K\), \(L\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(K\), \(S\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(K\), \(+\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(K\), \(-\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(-\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Rho]\), \(0\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Rho]\), \(+\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Rho]\), \(-\)]\)\>\"", ",", 
       "\"\<\[Eta]\>\"", ",", "\"\<\[Gamma]\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(-\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Tau]\), \(-\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Tau]\), \(+\)]\)\>\"", ",", 
       "\"\<Null\>\"", ",", "\"\<Intermediate\>\"", ",", "\"\<jet\>\"", ",", 
       "\"\<\!\(\*OverscriptBox[\(jet\), \(_\)]\)\>\"", ",", "\"\<g\>\"", 
       ",", "\"\<\!\(\*OverscriptBox[\(g\), \(_\)]\)\>\"", ",", "\"\<s\>\"", 
       ",", "\"\<\!\(\*OverscriptBox[\(s\), \(_\)]\)\>\"", ",", "\"\<c\>\"", 
       ",", "\"\<\!\(\*OverscriptBox[\(c\), \(_\)]\)\>\"", ",", "\"\<b\>\"", 
       ",", "\"\<\!\(\*OverscriptBox[\(b\), \(_\)]\)\>\"", ",", "\"\<u\>\"", 
       ",", "\"\<\!\(\*OverscriptBox[\(u\), \(_\)]\)\>\"", ",", "\"\<d\>\"", 
       ",", "\"\<\!\(\*OverscriptBox[\(d\), \(_\)]\)\>\"", ",", 
       "\"\<\[Omega]\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(K\), \(\(*\)\(+\)\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(K\), \(\(*\)\(-\)\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(K\), \(\(*\)\(0\)\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[OverscriptBox[\(K\), \(_\)], \(\(*\)\(0\)\)]\
\)\>\"", ",", "\"\<\[Eta]'\>\"", ",", "\"\<p\>\"", ",", 
       "\"\<\!\(\*OverscriptBox[\(p\), \(_\)]\)\>\"", ",", "\"\<n\>\"", ",", 
       "\"\<\!\(\*OverscriptBox[\(n\), \(_\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(a\), \(1\)]\)\>\"", ",", "\"\<\[Phi]\>\"", 
       ",", "\"\<\!\(\*SubscriptBox[\(\[Chi]\), \(1\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(\[Chi]\), \(2\)]\)\>\"", ",", "\"\<V\>\""}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ListPDGs", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"11", ",", 
        RowBox[{"-", "11"}], ",", "12", ",", 
        RowBox[{"-", "12"}], ",", "12", ",", "14", ",", "16", ",", 
        RowBox[{"-", "12"}], ",", 
        RowBox[{"-", "14"}], ",", 
        RowBox[{"-", "16"}], ",", "130", ",", "310", ",", "321", ",", 
        RowBox[{"-", "321"}], ",", "111", ",", "211", ",", 
        RowBox[{"-", "211"}], ",", "113", ",", "213", ",", 
        RowBox[{"-", "213"}], ",", "221", ",", "22", ",", "13", ",", 
        RowBox[{"-", "13"}], ",", "15", ",", 
        RowBox[{"-", "15"}], ",", "999999", ",", 
        RowBox[{"-", "12345678"}], ",", "2", ",", 
        RowBox[{"-", "2"}], ",", "21", ",", 
        RowBox[{"-", "21"}], ",", "3", ",", 
        RowBox[{"-", "3"}], ",", "4", ",", 
        RowBox[{"-", "4"}], ",", "5", ",", 
        RowBox[{"-", "5"}], ",", "2", ",", 
        RowBox[{"-", "2"}], ",", "1", ",", 
        RowBox[{"-", "1"}], ",", "223", ",", "323", ",", 
        RowBox[{"-", "323"}], ",", "313", ",", 
        RowBox[{"-", "313"}], ",", "331", ",", "2212", ",", 
        RowBox[{"-", "2212"}], ",", "2112", ",", 
        RowBox[{"-", "2112"}], ",", "20113", ",", "333", ",", "1111.", ",", 
        "2222.", ",", "3333."}], "}"}], "//", "N"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ParamProductToPDGid", "[", "#1", "]"}], "=", "#2"}], ")"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"ListSMparticlesSymbols", ",", "ListPDGs"}], "}"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ParamPDGidToProduct", "[", "#1", "]"}], "=", "#2"}], ")"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"ListPDGs", ",", "ListSMparticlesSymbols"}], "}"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Whether", " ", "the", " ", "decay", " ", "product", " ", "is", " ", 
      "stable", " ", "at", " ", "the", " ", "scale", " ", "of", " ", "the", 
      " ", 
      RowBox[{"experiment", ".", " ", 
       SubscriptBox["K", "L"]}]}], ",", 
     SuperscriptBox["K", "+"], ",", 
     SuperscriptBox["\[Pi]", "+"], ",", 
     RowBox[{
      SuperscriptBox["\[Mu]", "+"], " ", "are", " ", "considered", " ", 
      "stable"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ParamProductStability", "[", "#1", "]"}], "=", "#2"}], 
        ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"ListPDGs", ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
           ",", "1", ",", "1", ",", "1", ",", "1", ",", "0", ",", "1", ",", 
           "1", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0", ",", 
           "1", ",", "0", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
           ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
           "1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", "0", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
           "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "}"}], "//", 
         "N"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Mass", " ", "of", " ", "decay", " ", 
      RowBox[{"product", ".", " ", "For"}], " ", "jets"}], ",", " ", 
     RowBox[{
     "their", " ", "mass", " ", "is", " ", "assumed", " ", "to", " ", "be", 
      " ", "te", " ", "mass", " ", "of", " ", "the", " ", "lightest", " ", 
      "constituent"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ParamProductMass", "[", "#1", "]"}], "=", "#2"}], ")"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"ListPDGs", ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "0.0005", ",", "0.0005", ",", "0.", ",", "0.", ",", "0.", ",", "0.",
            ",", "0.", ",", "0.", ",", "0.", ",", "0.", ",", "0.4976", ",", 
           "0.4976", ",", "0.4937", ",", "0.4937", ",", "0.135", ",", "0.14", 
           ",", "0.14", ",", "0.775", ",", "0.775", ",", "0.775", ",", 
           "0.547", ",", "0.", ",", "0.105", ",", "0.105", ",", "1.77", ",", 
           "1.77", ",", "0.", ",", "123.", ",", "0.135", ",", "0.135", ",", 
           "0.135", ",", "0.135", ",", "0.495", ",", "0.495", ",", "1.87", 
           ",", "1.87", ",", "5.279", ",", "5.279", ",", "0.135", ",", 
           "0.135", ",", "0.135", ",", "0.135", ",", "0.782", ",", "0.892", 
           ",", "0.892`", ",", "0.892`", ",", "0.892", ",", "0.958", ",", 
           "0.938", ",", "0.938", ",", "0.939", ",", "0.939", ",", "1.26", 
           ",", "1.02", ",", "M\[Chi]1", ",", "M\[Chi]2", ",", "MV"}], "}"}], 
         "//", "N"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Electric", " ", "charges", " ", "of", " ", "decay", " ", 
      RowBox[{"products", ".", " ", "For"}], " ", 
      RowBox[{"jets", "/", "gluons"}]}], ",", " ", 
     RowBox[{
      RowBox[{"electric", " ", "charges"}], " ", "\[Equal]", " ", 
      RowBox[{"1", "/", 
       RowBox[{"-", "1"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ParamProductCharge", "[", "#1", "]"}], "=", "#2"}], ")"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"ListPDGs", ",", 
        RowBox[{
         FormBox[
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1."}], ",", "1.", ",", "0.", ",", "0.", ",", "0.", 
            ",", "0.", ",", "0.", ",", "0.", ",", "0.", ",", "0.", ",", "0.", 
            ",", "0.", ",", "1.", ",", 
            RowBox[{"-", "1."}], ",", "0.", ",", "1.", ",", 
            RowBox[{"-", "1."}], ",", "0.", ",", "1.", ",", 
            RowBox[{"-", "1."}], ",", "0.", ",", "0.", ",", 
            RowBox[{"-", "1."}], ",", "1.", ",", 
            RowBox[{"-", "1."}], ",", "1.", ",", "0.", ",", "0.", ",", "1.", 
            ",", 
            RowBox[{"-", "1."}], ",", "1.", ",", 
            RowBox[{"-", "1."}], ",", "1.", ",", 
            RowBox[{"-", "1."}], ",", "1.", ",", 
            RowBox[{"-", "1."}], ",", "1.", ",", 
            RowBox[{"-", "1."}], ",", "1.", ",", 
            RowBox[{"-", "1."}], ",", "1.", ",", 
            RowBox[{"-", "1."}], ",", "0.", ",", "1.", ",", 
            RowBox[{"-", "1."}], ",", "0.", ",", "0.", ",", "0.", ",", "1.", 
            ",", 
            RowBox[{"-", "1."}], ",", "0.", ",", "0.", ",", "0.", ",", "0.", 
            ",", "0.", ",", "0.", ",", "0."}], "}"}],
          TraditionalForm], "//", "N"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ParamProductWidth", "[", "#1", "]"}], "=", "#2"}], ")"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"113.", ",", "223.", ",", "333."}], "}"}], ",", 
        RowBox[{
         FormBox[
          RowBox[{"{", 
           RowBox[{"0.15", ",", "0.0081", ",", 
            RowBox[{"4.26", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "3."}]]}]}], "}"}],
          TraditionalForm], "//", "N"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "Print", "[", "\"\<Full information about decay products:\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "\"\<Product\>\"", "}"}], ",", 
        RowBox[{"{", "\"\<PDG ID\>\"", "}"}], ",", 
        RowBox[{"{", "\"\<Stability\>\"", "}"}], ",", 
        RowBox[{"{", "\"\<Mass\>\"", "}"}], ",", 
        RowBox[{"{", "\"\<Electric charge\>\"", "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ListSMparticlesSymbols", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"ParamProductToPDGid", "[", "#", "]"}], "&"}], "/@", 
         "ListSMparticlesSymbols"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"ParamProductStability", "[", "#", "]"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"ParamProductToPDGid", "[", "#", "]"}], "&"}], "/@", 
           "ListSMparticlesSymbols"}], ")"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"ParamProductMass", "[", "#", "]"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"ParamProductToPDGid", "[", "#", "]"}], "&"}], "/@", 
           "ListSMparticlesSymbols"}], ")"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"ParamProductCharge", "[", "#", "]"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"ParamProductToPDGid", "[", "#", "]"}], "&"}], "/@", 
           "ListSMparticlesSymbols"}], ")"}]}]}], "}"}], ",", "2"}], "]"}], "//",
     "TableForm"}], "\[IndentingNewLine]", 
   RowBox[{
   "Print", "[", "\"\<List of recognizable decay products:\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Keys", "[", 
     RowBox[{"DownValues", "@", "ParamProductToPDGid"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
   "Print", "[", "\"\<List of PDG ids that may be detected:\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"detectablepdgs", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1.", ",", 
       RowBox[{"-", "1."}], ",", "2.", ",", 
       RowBox[{"-", "2."}], ",", "3.", ",", 
       RowBox[{"-", "3."}], ",", "4.", ",", 
       RowBox[{"-", "4."}], ",", "5.", ",", 
       RowBox[{"-", "5."}], ",", "21.", ",", 
       RowBox[{"-", "21."}], ",", "22.", ",", "11.", ",", 
       RowBox[{"-", "11."}], ",", "13.", ",", 
       RowBox[{"-", "13."}], ",", "211.", ",", 
       RowBox[{"-", "211."}], ",", "130.", ",", "321.", ",", 
       RowBox[{"-", "321."}], ",", "2112.", ",", 
       RowBox[{"-", "2112."}], ",", "2212.", ",", 
       RowBox[{"-", "2212."}]}], "}"}], "//", "Sort"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Branching", " ", "ratios", " ", "of", " ", "decays", " ", "of", " ", 
     "light", " ", "mesons", " ", "into", " ", "photons"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Br\[Pi]To\[Gamma]\[Gamma]", "=", "0.98799"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Br\[Eta]To\[Gamma]\[Gamma]", "=", "0.3931181"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Br\[Omega]To\[Pi]0\[Gamma]", "=", "0.0834941"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Br\[Eta]prTo\[Gamma]\[Gamma]", "=", "0.0219297"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"pN", " ", "cross"}], "-", 
     RowBox[{"section", " ", "in", " ", "pb"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Sigma]pNucleonInpb", "[", "Atarget_", "]"}], "=", 
     RowBox[{"51", "*", 
      SuperscriptBox["Atarget", 
       RowBox[{"-", "0.29"}]], "*", 
      SuperscriptBox["10", "9"]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9175428639211707`*^9, 3.9175428738916817`*^9}, {
  3.9181125339376063`*^9, 3.9181125900480423`*^9}, {3.918116033973049*^9, 
  3.918116038528684*^9}, {3.9261338390876174`*^9, 3.9261338588489985`*^9}, {
  3.926137488178781*^9, 3.92613749860756*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"abe8c1ef-9006-45bb-a0e9-f9a17a90acb2"],

Cell[BoxData[
 FormBox["\<\"Full information about decay products:\"\>", 
  TraditionalForm]], "Print",
 CellChangeTimes->{
  3.917542353332431*^9, 3.9175428761130857`*^9, 3.9175441377533054`*^9, 
   3.917580114057884*^9, 3.917593085987754*^9, 3.917593501381232*^9, 
   3.9175942699905868`*^9, 3.9176002589877443`*^9, 3.917624735590356*^9, 
   3.917625042790537*^9, 3.917625735719287*^9, 3.917625960012333*^9, 
   3.917626152020481*^9, 3.9176268737140346`*^9, 3.9176275271081476`*^9, 
   3.9176277996242943`*^9, 3.9176281592939987`*^9, 3.917668982696627*^9, 
   3.9176797469909763`*^9, 3.917680231348815*^9, 3.917681871926083*^9, 
   3.917715414587489*^9, 3.9177159614179554`*^9, 3.917720907750064*^9, 
   3.917771233619032*^9, 3.9177727259841366`*^9, 3.9177733151835318`*^9, 
   3.9177782658863015`*^9, 3.917779684107951*^9, 3.9177965823285875`*^9, 
   3.9177971367115955`*^9, 3.917797517647115*^9, 3.917802098860591*^9, 
   3.917803015471791*^9, 3.9178591015427217`*^9, 3.9178607331445713`*^9, 
   3.9178847042276845`*^9, 3.9178872354154043`*^9, 3.9178892820958986`*^9, 
   3.917890864734646*^9, 3.917891088847048*^9, 3.9178912850765753`*^9, 
   3.917891646785087*^9, 3.9178918405398855`*^9, 3.917950142579378*^9, 
   3.917953244209095*^9, 3.9180563152384295`*^9, 3.918058076084407*^9, 
   3.918058185112062*^9, 3.9180592670269327`*^9, 3.9181068728253217`*^9, 
   3.918108844707608*^9, 3.918112632890006*^9, 3.9181128319537315`*^9, 
   3.9181130516991167`*^9, 3.9181133780686903`*^9, 3.918114949052499*^9, 
   3.918115145672631*^9, 3.9181160389341106`*^9, 3.918117982782547*^9, 
   3.9181186606069336`*^9, 3.9181188140482407`*^9, 3.9181205652903423`*^9, 
   3.9181913972482843`*^9, 3.9181915398756847`*^9, 3.918193955750596*^9, 
   3.918196743904891*^9, 3.918201765092985*^9, 3.9182041998307104`*^9, 
   3.918204383212243*^9, 3.9182068393680506`*^9, 3.9182283529702997`*^9, 
   3.918232052857725*^9, 3.9182348980260143`*^9, 3.918274924392663*^9, 
   3.9182759863775516`*^9, 3.918285092598817*^9, 3.918371551740173*^9, 
   3.918376542646188*^9, 3.918459353119134*^9, 3.918459514101215*^9, 
   3.9184597990270033`*^9, 3.9184604980910425`*^9, 3.9184616895938606`*^9, 
   3.9184648110491624`*^9, 3.9185583152133055`*^9, 3.9185735626414537`*^9, 
   3.9185752129427004`*^9, 3.9185755423482957`*^9, 3.918576116960142*^9, 
   3.918577168460145*^9, 3.9185792117980022`*^9, 3.918618357541848*^9, 
   3.918618688182459*^9, 3.918620002948202*^9, 3.918620552362259*^9, 
   3.918643755960573*^9, 3.9186618047984285`*^9, {3.9186643597954683`*^9, 
   3.9186643859971156`*^9}, 3.918697535588599*^9, 3.918924735300172*^9, 
   3.9189253369685864`*^9, 3.918926134887946*^9, 3.918926990141918*^9, 
   3.9189997749003725`*^9, 3.919000500455595*^9, 3.9190088356876884`*^9, 
   3.9190119333589287`*^9, 3.9190132518825903`*^9, 3.919013703728224*^9, 
   3.9190141311676383`*^9, 3.9190150327079506`*^9, 3.919015622713456*^9, 
   3.9190159263742943`*^9, 3.9190165378084607`*^9, 3.9190445161895638`*^9, 
   3.9190663709022937`*^9, 3.9190667414236574`*^9, 3.919067046530066*^9, 
   3.9190692699189634`*^9, 3.9190814471601615`*^9, 3.9194426898604565`*^9, 
   3.920049406005402*^9, 3.920050002071634*^9, 3.920092768045205*^9, 
   3.9200955338426986`*^9, 3.9200961634798007`*^9, 3.920129440706479*^9, 
   3.920180491571046*^9, 3.9218125208419285`*^9, 3.9218317928616295`*^9, 
   3.9219258519718904`*^9, 3.926133227477258*^9, 3.926133693274705*^9, 
   3.92613374500545*^9, 3.926133859221389*^9, 3.9261349120625076`*^9, 
   3.9261375012083464`*^9},
 CellLabel->
  "During evaluation of \
In[45]:=",ExpressionUUID->"d7f0f13a-e1c4-4262-a06d-9f02c905834e"],

Cell[BoxData[
 FormBox[
  TagBox[GridBox[{
     {"\<\"Product\"\>", "\<\"\\!\\(\\*SuperscriptBox[\\(e\\), \
\\(-\\)]\\)\"\>", "\<\"\\!\\(\\*SuperscriptBox[\\(e\\), \\(+\\)]\\)\"\>", "\<\
\"\[Nu]\"\>", "\<\"\\!\\(\\*OverscriptBox[\\(\[Nu]\\), \\(_\\)]\\)\"\>", \
"\<\"\\!\\(\\*SubscriptBox[\\(\[Nu]\\), \\(e\\)]\\)\"\>", \
"\<\"\\!\\(\\*SubscriptBox[\\(\[Nu]\\), \\(\[Mu]\\)]\\)\"\>", \
"\<\"\\!\\(\\*SubscriptBox[\\(\[Nu]\\), \\(\[Tau]\\)]\\)\"\>", \
"\<\"\\!\\(\\*SubscriptBox[OverscriptBox[\\(\[Nu]\\), \\(_\\)], \\(e\\)]\\)\"\
\>", "\<\"\\!\\(\\*SubscriptBox[OverscriptBox[\\(\[Nu]\\), \\(_\\)], \\(\[Mu]\
\\)]\\)\"\>", "\<\"\\!\\(\\*SubscriptBox[OverscriptBox[\\(\[Nu]\\), \\(_\\)], \
\\(\[Tau]\\)]\\)\"\>", "\<\"\\!\\(\\*SubscriptBox[\\(K\\), \\(L\\)]\\)\"\>", \
"\<\"\\!\\(\\*SubscriptBox[\\(K\\), \\(S\\)]\\)\"\>", \
"\<\"\\!\\(\\*SuperscriptBox[\\(K\\), \\(+\\)]\\)\"\>", \
"\<\"\\!\\(\\*SuperscriptBox[\\(K\\), \\(-\\)]\\)\"\>", \
"\<\"\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \\(0\\)]\\)\"\>", \
"\<\"\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \\(+\\)]\\)\"\>", \
"\<\"\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \\(-\\)]\\)\"\>", \
"\<\"\\!\\(\\*SuperscriptBox[\\(\[Rho]\\), \\(0\\)]\\)\"\>", \
"\<\"\\!\\(\\*SuperscriptBox[\\(\[Rho]\\), \\(+\\)]\\)\"\>", \
"\<\"\\!\\(\\*SuperscriptBox[\\(\[Rho]\\), \\(-\\)]\\)\"\>", \
"\<\"\[Eta]\"\>", "\<\"\[Gamma]\"\>", \
"\<\"\\!\\(\\*SuperscriptBox[\\(\[Mu]\\), \\(-\\)]\\)\"\>", \
"\<\"\\!\\(\\*SuperscriptBox[\\(\[Mu]\\), \\(+\\)]\\)\"\>", \
"\<\"\\!\\(\\*SuperscriptBox[\\(\[Tau]\\), \\(-\\)]\\)\"\>", \
"\<\"\\!\\(\\*SuperscriptBox[\\(\[Tau]\\), \\(+\\)]\\)\"\>", "\<\"Null\"\>", \
"\<\"Intermediate\"\>", "\<\"jet\"\>", "\<\"\\!\\(\\*OverscriptBox[\\(jet\\), \
\\(_\\)]\\)\"\>", "\<\"g\"\>", "\<\"\\!\\(\\*OverscriptBox[\\(g\\), \
\\(_\\)]\\)\"\>", "\<\"s\"\>", "\<\"\\!\\(\\*OverscriptBox[\\(s\\), \
\\(_\\)]\\)\"\>", "\<\"c\"\>", "\<\"\\!\\(\\*OverscriptBox[\\(c\\), \
\\(_\\)]\\)\"\>", "\<\"b\"\>", "\<\"\\!\\(\\*OverscriptBox[\\(b\\), \
\\(_\\)]\\)\"\>", "\<\"u\"\>", "\<\"\\!\\(\\*OverscriptBox[\\(u\\), \
\\(_\\)]\\)\"\>", "\<\"d\"\>", "\<\"\\!\\(\\*OverscriptBox[\\(d\\), \
\\(_\\)]\\)\"\>", "\<\"\[Omega]\"\>", "\<\"\\!\\(\\*SuperscriptBox[\\(K\\), \
\\(\\(*\\)\\(+\\)\\)]\\)\"\>", "\<\"\\!\\(\\*SuperscriptBox[\\(K\\), \
\\(\\(*\\)\\(-\\)\\)]\\)\"\>", "\<\"\\!\\(\\*SuperscriptBox[\\(K\\), \
\\(\\(*\\)\\(0\\)\\)]\\)\"\>", \
"\<\"\\!\\(\\*SuperscriptBox[OverscriptBox[\\(K\\), \\(_\\)], \
\\(\\(*\\)\\(0\\)\\)]\\)\"\>", "\<\"\[Eta]'\"\>", "\<\"p\"\>", \
"\<\"\\!\\(\\*OverscriptBox[\\(p\\), \\(_\\)]\\)\"\>", "\<\"n\"\>", \
"\<\"\\!\\(\\*OverscriptBox[\\(n\\), \\(_\\)]\\)\"\>", \
"\<\"\\!\\(\\*SubscriptBox[\\(a\\), \\(1\\)]\\)\"\>", "\<\"\[Phi]\"\>", "\<\"\
\\!\\(\\*SubscriptBox[\\(\[Chi]\\), \\(1\\)]\\)\"\>", \
"\<\"\\!\\(\\*SubscriptBox[\\(\[Chi]\\), \\(2\\)]\\)\"\>", "\<\"V\"\>"},
     {"\<\"PDG ID\"\>", "11.`", 
      RowBox[{"-", "11.`"}], "12.`", 
      RowBox[{"-", "12.`"}], "12.`", "14.`", "16.`", 
      RowBox[{"-", "12.`"}], 
      RowBox[{"-", "14.`"}], 
      RowBox[{"-", "16.`"}], "130.`", "310.`", "321.`", 
      RowBox[{"-", "321.`"}], "111.`", "211.`", 
      RowBox[{"-", "211.`"}], "113.`", "213.`", 
      RowBox[{"-", "213.`"}], "221.`", "22.`", "13.`", 
      RowBox[{"-", "13.`"}], "15.`", 
      RowBox[{"-", "15.`"}], "999999.`", 
      RowBox[{"-", "1.2345678`*^7"}], "2.`", 
      RowBox[{"-", "2.`"}], "21.`", 
      RowBox[{"-", "21.`"}], "3.`", 
      RowBox[{"-", "3.`"}], "4.`", 
      RowBox[{"-", "4.`"}], "5.`", 
      RowBox[{"-", "5.`"}], "2.`", 
      RowBox[{"-", "2.`"}], "1.`", 
      RowBox[{"-", "1.`"}], "223.`", "323.`", 
      RowBox[{"-", "323.`"}], "313.`", 
      RowBox[{"-", "313.`"}], "331.`", "2212.`", 
      RowBox[{"-", "2212.`"}], "2112.`", 
      RowBox[{"-", "2112.`"}], "20113.`", "333.`", "1111.`", "2222.`", 
      "3333.`"},
     {"\<\"Stability\"\>", "1.`", "1.`", "1.`", "1.`", "1.`", "1.`", "1.`", 
      "1.`", "1.`", "1.`", "1.`", "0.`", "1.`", "1.`", "0.`", "1.`", "1.`", 
      "0.`", "0.`", "0.`", "0.`", "1.`", "1.`", "1.`", "0.`", "0.`", "1.`", 
      "0.`", "1.`", "1.`", "1.`", "1.`", "1.`", "1.`", "1.`", "1.`", "1.`", 
      "1.`", "1.`", "1.`", "1.`", "1.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "1.`", "1.`", "1.`", "1.`", "0.`", "0.`", "1.`", "0.`", "0.`"},
     {"\<\"Mass\"\>", "0.0005`", "0.0005`", "0.`", "0.`", "0.`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "0.4976`", "0.4976`", "0.4937`", "0.4937`", 
      "0.135`", "0.14`", "0.14`", "0.775`", "0.775`", "0.775`", "0.547`", 
      "0.`", "0.105`", "0.105`", "1.77`", "1.77`", "0.`", "123.`", "0.135`", 
      "0.135`", "0.135`", "0.135`", "0.495`", "0.495`", "1.87`", "1.87`", 
      "5.279`", "5.279`", "0.135`", "0.135`", "0.135`", "0.135`", "0.782`", 
      "0.892`", "0.892`", "0.892`", "0.892`", "0.958`", "0.938`", "0.938`", 
      "0.939`", "0.939`", "1.26`", "1.02`", "M\[Chi]1", "M\[Chi]2", "MV"},
     {"\<\"Electric charge\"\>", 
      RowBox[{"-", "1.`"}], "1.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "1.`", 
      RowBox[{"-", "1.`"}], "0.`", "1.`", 
      RowBox[{"-", "1.`"}], "0.`", "1.`", 
      RowBox[{"-", "1.`"}], "0.`", "0.`", 
      RowBox[{"-", "1.`"}], "1.`", 
      RowBox[{"-", "1.`"}], "1.`", "0.`", "0.`", "1.`", 
      RowBox[{"-", "1.`"}], "1.`", 
      RowBox[{"-", "1.`"}], "1.`", 
      RowBox[{"-", "1.`"}], "1.`", 
      RowBox[{"-", "1.`"}], "1.`", 
      RowBox[{"-", "1.`"}], "1.`", 
      RowBox[{"-", "1.`"}], "1.`", 
      RowBox[{"-", "1.`"}], "0.`", "1.`", 
      RowBox[{"-", "1.`"}], "0.`", "0.`", "0.`", "1.`", 
      RowBox[{"-", "1.`"}], "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[2.0999999999999996`]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Function[BoxForm`e$, 
    TableForm[BoxForm`e$]]], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9175423533471417`*^9, 3.917542876181904*^9, 3.917544138401149*^9, 
   3.9175801141748085`*^9, 3.9175930860578203`*^9, 3.9175935014735656`*^9, 
   3.917594270152607*^9, 3.9176002590006037`*^9, 3.917624735659501*^9, 
   3.9176250428429384`*^9, 3.917625735732069*^9, 3.9176259600528603`*^9, 
   3.917626152054738*^9, 3.917626873876249*^9, 3.9176275271474485`*^9, 
   3.9176277997521877`*^9, 3.917628159341399*^9, 3.917668982827531*^9, 
   3.917679747038709*^9, 3.917680231388856*^9, 3.917681871947959*^9, 
   3.9177154146434956`*^9, 3.917715961450903*^9, 3.917720907761561*^9, 
   3.9177712336652985`*^9, 3.917772726025262*^9, 3.9177733152478533`*^9, 
   3.9177782659734287`*^9, 3.9177796841428576`*^9, 3.917796582389223*^9, 
   3.917797136748993*^9, 3.91779751767564*^9, 3.9178020988915524`*^9, 
   3.917803015499759*^9, 3.917859101574503*^9, 3.9178607331755075`*^9, 
   3.9178847042613735`*^9, 3.9178872354436073`*^9, 3.917889282123623*^9, 
   3.917890864760646*^9, 3.9178910888794036`*^9, 3.917891285110143*^9, 
   3.9178916467988777`*^9, 3.9178918406004176`*^9, 3.917950142606881*^9, 
   3.917953244237399*^9, 3.9180563152735662`*^9, 3.9180580761594076`*^9, 
   3.9180581851679673`*^9, 3.9180592670889144`*^9, 3.918106872895426*^9, 
   3.9181088447506695`*^9, 3.918112632930778*^9, 3.9181128320078464`*^9, 
   3.9181130517291574`*^9, 3.918113378097988*^9, 3.918114949081773*^9, 
   3.9181151457041597`*^9, 3.9181160389512215`*^9, 3.918117982832355*^9, 
   3.9181186606554413`*^9, 3.9181188140982647`*^9, 3.918120565321519*^9, 
   3.918191397273393*^9, 3.918191539946827*^9, 3.918193955849105*^9, 
   3.9181967439422965`*^9, 3.918201765127984*^9, 3.918204199860663*^9, 
   3.918204383244171*^9, 3.918206839401971*^9, 3.9182283530605793`*^9, 
   3.9182320528889627`*^9, 3.91823489805544*^9, 3.9182749244176793`*^9, 
   3.918275986403261*^9, 3.918285092631265*^9, 3.9183715517771544`*^9, 
   3.918376542678655*^9, 3.9184593531463985`*^9, 3.9184595141333838`*^9, 
   3.9184597990580964`*^9, 3.9184604981282315`*^9, 3.918461689625449*^9, 
   3.918464811083887*^9, 3.918558315247269*^9, 3.9185735626587987`*^9, 
   3.9185752129711275`*^9, 3.9185755423674903`*^9, 3.9185761169816103`*^9, 
   3.918577168488962*^9, 3.918579211817449*^9, 3.9186183575713453`*^9, 
   3.9186186881905155`*^9, 3.91862000299105*^9, 3.918620552383114*^9, 
   3.9186437559995804`*^9, 3.918661804812936*^9, {3.918664359816717*^9, 
   3.9186643860343685`*^9}, 3.9186975356211777`*^9, 3.918924735362071*^9, 
   3.918925336990407*^9, 3.918926134917117*^9, 3.918926990172857*^9, 
   3.9189997749996376`*^9, 3.9190005004705553`*^9, 3.9190088357145753`*^9, 
   3.9190119333898783`*^9, 3.9190132518840995`*^9, 3.9190137037509193`*^9, 
   3.919014131182832*^9, 3.9190150327586565`*^9, 3.9190156227465754`*^9, 
   3.9190159264086227`*^9, 3.9190165378378825`*^9, 3.919044516222477*^9, 
   3.9190663709441757`*^9, 3.9190667414561734`*^9, 3.9190670465617323`*^9, 
   3.9190692699534397`*^9, 3.9190814471916275`*^9, 3.9194426898908243`*^9, 
   3.920049406063095*^9, 3.920050002077175*^9, 3.9200927680714393`*^9, 
   3.9200955338757553`*^9, 3.9200961634939*^9, 3.9201294407359695`*^9, 
   3.9201804916089444`*^9, 3.9218125208790035`*^9, 3.921831792879518*^9, 
   3.9219258519884477`*^9, 3.9261332275139256`*^9, 3.926133693290539*^9, 
   3.926133745019514*^9, 3.926133859241248*^9, 3.926134912085552*^9, 
   3.9261375012276516`*^9},
 CellLabel->
  "Out[54]//TableForm=",ExpressionUUID->"d9a2bfd2-bdef-404c-b2d6-\
492856845e62"],

Cell[BoxData[
 FormBox["\<\"List of recognizable decay products:\"\>", 
  TraditionalForm]], "Print",
 CellChangeTimes->{
  3.917542353332431*^9, 3.9175428761130857`*^9, 3.9175441377533054`*^9, 
   3.917580114057884*^9, 3.917593085987754*^9, 3.917593501381232*^9, 
   3.9175942699905868`*^9, 3.9176002589877443`*^9, 3.917624735590356*^9, 
   3.917625042790537*^9, 3.917625735719287*^9, 3.917625960012333*^9, 
   3.917626152020481*^9, 3.9176268737140346`*^9, 3.9176275271081476`*^9, 
   3.9176277996242943`*^9, 3.9176281592939987`*^9, 3.917668982696627*^9, 
   3.9176797469909763`*^9, 3.917680231348815*^9, 3.917681871926083*^9, 
   3.917715414587489*^9, 3.9177159614179554`*^9, 3.917720907750064*^9, 
   3.917771233619032*^9, 3.9177727259841366`*^9, 3.9177733151835318`*^9, 
   3.9177782658863015`*^9, 3.917779684107951*^9, 3.9177965823285875`*^9, 
   3.9177971367115955`*^9, 3.917797517647115*^9, 3.917802098860591*^9, 
   3.917803015471791*^9, 3.9178591015427217`*^9, 3.9178607331445713`*^9, 
   3.9178847042276845`*^9, 3.9178872354154043`*^9, 3.9178892820958986`*^9, 
   3.917890864734646*^9, 3.917891088847048*^9, 3.9178912850765753`*^9, 
   3.917891646785087*^9, 3.9178918405398855`*^9, 3.917950142579378*^9, 
   3.917953244209095*^9, 3.9180563152384295`*^9, 3.918058076084407*^9, 
   3.918058185112062*^9, 3.9180592670269327`*^9, 3.9181068728253217`*^9, 
   3.918108844707608*^9, 3.918112632890006*^9, 3.9181128319537315`*^9, 
   3.9181130516991167`*^9, 3.9181133780686903`*^9, 3.918114949052499*^9, 
   3.918115145672631*^9, 3.9181160389341106`*^9, 3.918117982782547*^9, 
   3.9181186606069336`*^9, 3.9181188140482407`*^9, 3.9181205652903423`*^9, 
   3.9181913972482843`*^9, 3.9181915398756847`*^9, 3.918193955750596*^9, 
   3.918196743904891*^9, 3.918201765092985*^9, 3.9182041998307104`*^9, 
   3.918204383212243*^9, 3.9182068393680506`*^9, 3.9182283529702997`*^9, 
   3.918232052857725*^9, 3.9182348980260143`*^9, 3.918274924392663*^9, 
   3.9182759863775516`*^9, 3.918285092598817*^9, 3.918371551740173*^9, 
   3.918376542646188*^9, 3.918459353119134*^9, 3.918459514101215*^9, 
   3.9184597990270033`*^9, 3.9184604980910425`*^9, 3.9184616895938606`*^9, 
   3.9184648110491624`*^9, 3.9185583152133055`*^9, 3.9185735626414537`*^9, 
   3.9185752129427004`*^9, 3.9185755423482957`*^9, 3.918576116960142*^9, 
   3.918577168460145*^9, 3.9185792117980022`*^9, 3.918618357541848*^9, 
   3.918618688182459*^9, 3.918620002948202*^9, 3.918620552362259*^9, 
   3.918643755960573*^9, 3.9186618047984285`*^9, {3.9186643597954683`*^9, 
   3.9186643859971156`*^9}, 3.918697535588599*^9, 3.918924735300172*^9, 
   3.9189253369685864`*^9, 3.918926134887946*^9, 3.918926990141918*^9, 
   3.9189997749003725`*^9, 3.919000500455595*^9, 3.9190088356876884`*^9, 
   3.9190119333589287`*^9, 3.9190132518825903`*^9, 3.919013703728224*^9, 
   3.9190141311676383`*^9, 3.9190150327079506`*^9, 3.919015622713456*^9, 
   3.9190159263742943`*^9, 3.9190165378084607`*^9, 3.9190445161895638`*^9, 
   3.9190663709022937`*^9, 3.9190667414236574`*^9, 3.919067046530066*^9, 
   3.9190692699189634`*^9, 3.9190814471601615`*^9, 3.9194426898604565`*^9, 
   3.920049406005402*^9, 3.920050002071634*^9, 3.920092768045205*^9, 
   3.9200955338426986`*^9, 3.9200961634798007`*^9, 3.920129440706479*^9, 
   3.920180491571046*^9, 3.9218125208419285`*^9, 3.9218317928616295`*^9, 
   3.9219258519718904`*^9, 3.926133227477258*^9, 3.926133693274705*^9, 
   3.92613374500545*^9, 3.926133859221389*^9, 3.9261349120625076`*^9, 
   3.92613750125056*^9},
 CellLabel->
  "During evaluation of \
In[45]:=",ExpressionUUID->"71d1c72a-b415-4711-9585-7caf37aac74b"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"\<\"b\"\>", ",", "\<\"c\"\>", ",", "\<\"d\"\>", ",", "\<\"g\"\>", 
    ",", "\<\"Intermediate\"\>", ",", "\<\"jet\"\>", ",", "\<\"n\"\>", 
    ",", "\<\"Null\"\>", 
    ",", "\<\"\\!\\(\\*OverscriptBox[\\(b\\), \\(_\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*OverscriptBox[\\(c\\), \\(_\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*OverscriptBox[\\(d\\), \\(_\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*OverscriptBox[\\(g\\), \\(_\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*OverscriptBox[\\(jet\\), \\(_\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*OverscriptBox[\\(n\\), \\(_\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*OverscriptBox[\\(p\\), \\(_\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*OverscriptBox[\\(s\\), \\(_\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*OverscriptBox[\\(u\\), \\(_\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*OverscriptBox[\\(\[Nu]\\), \\(_\\)]\\)\"\>", 
    ",", "\<\"p\"\>", ",", "\<\"s\"\>", 
    ",", "\<\"\\!\\(\\*SubscriptBox[\\(a\\), \\(1\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SubscriptBox[\\(K\\), \\(L\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SubscriptBox[\\(K\\), \\(S\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SubscriptBox[OverscriptBox[\\(\[Nu]\\), \\(_\\)], \\(e\
\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SubscriptBox[OverscriptBox[\\(\[Nu]\\), \\(_\\)], \\(\
\[Mu]\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SubscriptBox[OverscriptBox[\\(\[Nu]\\), \\(_\\)], \\(\
\[Tau]\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Nu]\\), \\(e\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Nu]\\), \\(\[Mu]\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Nu]\\), \\(\[Tau]\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Chi]\\), \\(1\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Chi]\\), \\(2\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SuperscriptBox[\\(e\\), \\(-\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SuperscriptBox[\\(e\\), \\(+\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SuperscriptBox[\\(K\\), \\(-\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SuperscriptBox[\\(K\\), \\(+\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SuperscriptBox[\\(K\\), \\(\\(*\\)\\(-\\)\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SuperscriptBox[\\(K\\), \\(\\(*\\)\\(+\\)\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SuperscriptBox[\\(K\\), \\(\\(*\\)\\(0\\)\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SuperscriptBox[OverscriptBox[\\(K\\), \\(_\\)], \
\\(\\(*\\)\\(0\\)\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SuperscriptBox[\\(\[Mu]\\), \\(-\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SuperscriptBox[\\(\[Mu]\\), \\(+\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \\(-\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \\(+\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \\(0\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SuperscriptBox[\\(\[Rho]\\), \\(-\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SuperscriptBox[\\(\[Rho]\\), \\(+\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SuperscriptBox[\\(\[Rho]\\), \\(0\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SuperscriptBox[\\(\[Tau]\\), \\(-\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SuperscriptBox[\\(\[Tau]\\), \\(+\\)]\\)\"\>", 
    ",", "\<\"u\"\>", ",", "\<\"V\"\>", ",", "\<\"\[Gamma]\"\>", 
    ",", "\<\"\[Eta]\"\>", ",", "\<\"\[Eta]'\"\>", ",", "\<\"\[Nu]\"\>", 
    ",", "\<\"\[Phi]\"\>", ",", "\<\"\[Omega]\"\>"}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9175423533471417`*^9, 3.917542876181904*^9, 3.917544138401149*^9, 
   3.9175801141748085`*^9, 3.9175930860578203`*^9, 3.9175935014735656`*^9, 
   3.917594270152607*^9, 3.9176002590006037`*^9, 3.917624735659501*^9, 
   3.9176250428429384`*^9, 3.917625735732069*^9, 3.9176259600528603`*^9, 
   3.917626152054738*^9, 3.917626873876249*^9, 3.9176275271474485`*^9, 
   3.9176277997521877`*^9, 3.917628159341399*^9, 3.917668982827531*^9, 
   3.917679747038709*^9, 3.917680231388856*^9, 3.917681871947959*^9, 
   3.9177154146434956`*^9, 3.917715961450903*^9, 3.917720907761561*^9, 
   3.9177712336652985`*^9, 3.917772726025262*^9, 3.9177733152478533`*^9, 
   3.9177782659734287`*^9, 3.9177796841428576`*^9, 3.917796582389223*^9, 
   3.917797136748993*^9, 3.91779751767564*^9, 3.9178020988915524`*^9, 
   3.917803015499759*^9, 3.917859101574503*^9, 3.9178607331755075`*^9, 
   3.9178847042613735`*^9, 3.9178872354436073`*^9, 3.917889282123623*^9, 
   3.917890864760646*^9, 3.9178910888794036`*^9, 3.917891285110143*^9, 
   3.9178916467988777`*^9, 3.9178918406004176`*^9, 3.917950142606881*^9, 
   3.917953244237399*^9, 3.9180563152735662`*^9, 3.9180580761594076`*^9, 
   3.9180581851679673`*^9, 3.9180592670889144`*^9, 3.918106872895426*^9, 
   3.9181088447506695`*^9, 3.918112632930778*^9, 3.9181128320078464`*^9, 
   3.9181130517291574`*^9, 3.918113378097988*^9, 3.918114949081773*^9, 
   3.9181151457041597`*^9, 3.9181160389512215`*^9, 3.918117982832355*^9, 
   3.9181186606554413`*^9, 3.9181188140982647`*^9, 3.918120565321519*^9, 
   3.918191397273393*^9, 3.918191539946827*^9, 3.918193955849105*^9, 
   3.9181967439422965`*^9, 3.918201765127984*^9, 3.918204199860663*^9, 
   3.918204383244171*^9, 3.918206839401971*^9, 3.9182283530605793`*^9, 
   3.9182320528889627`*^9, 3.91823489805544*^9, 3.9182749244176793`*^9, 
   3.918275986403261*^9, 3.918285092631265*^9, 3.9183715517771544`*^9, 
   3.918376542678655*^9, 3.9184593531463985`*^9, 3.9184595141333838`*^9, 
   3.9184597990580964`*^9, 3.9184604981282315`*^9, 3.918461689625449*^9, 
   3.918464811083887*^9, 3.918558315247269*^9, 3.9185735626587987`*^9, 
   3.9185752129711275`*^9, 3.9185755423674903`*^9, 3.9185761169816103`*^9, 
   3.918577168488962*^9, 3.918579211817449*^9, 3.9186183575713453`*^9, 
   3.9186186881905155`*^9, 3.91862000299105*^9, 3.918620552383114*^9, 
   3.9186437559995804`*^9, 3.918661804812936*^9, {3.918664359816717*^9, 
   3.9186643860343685`*^9}, 3.9186975356211777`*^9, 3.918924735362071*^9, 
   3.918925336990407*^9, 3.918926134917117*^9, 3.918926990172857*^9, 
   3.9189997749996376`*^9, 3.9190005004705553`*^9, 3.9190088357145753`*^9, 
   3.9190119333898783`*^9, 3.9190132518840995`*^9, 3.9190137037509193`*^9, 
   3.919014131182832*^9, 3.9190150327586565`*^9, 3.9190156227465754`*^9, 
   3.9190159264086227`*^9, 3.9190165378378825`*^9, 3.919044516222477*^9, 
   3.9190663709441757`*^9, 3.9190667414561734`*^9, 3.9190670465617323`*^9, 
   3.9190692699534397`*^9, 3.9190814471916275`*^9, 3.9194426898908243`*^9, 
   3.920049406063095*^9, 3.920050002077175*^9, 3.9200927680714393`*^9, 
   3.9200955338757553`*^9, 3.9200961634939*^9, 3.9201294407359695`*^9, 
   3.9201804916089444`*^9, 3.9218125208790035`*^9, 3.921831792879518*^9, 
   3.9219258519884477`*^9, 3.9261332275139256`*^9, 3.926133693290539*^9, 
   3.926133745019514*^9, 3.926133859241248*^9, 3.926134912085552*^9, 
   3.9261375012576904`*^9},
 CellLabel->"Out[56]=",ExpressionUUID->"678a2040-92ed-4f2f-a4fa-94fc0ca5556e"],

Cell[BoxData[
 FormBox["\<\"List of PDG ids that may be detected:\"\>", 
  TraditionalForm]], "Print",
 CellChangeTimes->{
  3.917542353332431*^9, 3.9175428761130857`*^9, 3.9175441377533054`*^9, 
   3.917580114057884*^9, 3.917593085987754*^9, 3.917593501381232*^9, 
   3.9175942699905868`*^9, 3.9176002589877443`*^9, 3.917624735590356*^9, 
   3.917625042790537*^9, 3.917625735719287*^9, 3.917625960012333*^9, 
   3.917626152020481*^9, 3.9176268737140346`*^9, 3.9176275271081476`*^9, 
   3.9176277996242943`*^9, 3.9176281592939987`*^9, 3.917668982696627*^9, 
   3.9176797469909763`*^9, 3.917680231348815*^9, 3.917681871926083*^9, 
   3.917715414587489*^9, 3.9177159614179554`*^9, 3.917720907750064*^9, 
   3.917771233619032*^9, 3.9177727259841366`*^9, 3.9177733151835318`*^9, 
   3.9177782658863015`*^9, 3.917779684107951*^9, 3.9177965823285875`*^9, 
   3.9177971367115955`*^9, 3.917797517647115*^9, 3.917802098860591*^9, 
   3.917803015471791*^9, 3.9178591015427217`*^9, 3.9178607331445713`*^9, 
   3.9178847042276845`*^9, 3.9178872354154043`*^9, 3.9178892820958986`*^9, 
   3.917890864734646*^9, 3.917891088847048*^9, 3.9178912850765753`*^9, 
   3.917891646785087*^9, 3.9178918405398855`*^9, 3.917950142579378*^9, 
   3.917953244209095*^9, 3.9180563152384295`*^9, 3.918058076084407*^9, 
   3.918058185112062*^9, 3.9180592670269327`*^9, 3.9181068728253217`*^9, 
   3.918108844707608*^9, 3.918112632890006*^9, 3.9181128319537315`*^9, 
   3.9181130516991167`*^9, 3.9181133780686903`*^9, 3.918114949052499*^9, 
   3.918115145672631*^9, 3.9181160389341106`*^9, 3.918117982782547*^9, 
   3.9181186606069336`*^9, 3.9181188140482407`*^9, 3.9181205652903423`*^9, 
   3.9181913972482843`*^9, 3.9181915398756847`*^9, 3.918193955750596*^9, 
   3.918196743904891*^9, 3.918201765092985*^9, 3.9182041998307104`*^9, 
   3.918204383212243*^9, 3.9182068393680506`*^9, 3.9182283529702997`*^9, 
   3.918232052857725*^9, 3.9182348980260143`*^9, 3.918274924392663*^9, 
   3.9182759863775516`*^9, 3.918285092598817*^9, 3.918371551740173*^9, 
   3.918376542646188*^9, 3.918459353119134*^9, 3.918459514101215*^9, 
   3.9184597990270033`*^9, 3.9184604980910425`*^9, 3.9184616895938606`*^9, 
   3.9184648110491624`*^9, 3.9185583152133055`*^9, 3.9185735626414537`*^9, 
   3.9185752129427004`*^9, 3.9185755423482957`*^9, 3.918576116960142*^9, 
   3.918577168460145*^9, 3.9185792117980022`*^9, 3.918618357541848*^9, 
   3.918618688182459*^9, 3.918620002948202*^9, 3.918620552362259*^9, 
   3.918643755960573*^9, 3.9186618047984285`*^9, {3.9186643597954683`*^9, 
   3.9186643859971156`*^9}, 3.918697535588599*^9, 3.918924735300172*^9, 
   3.9189253369685864`*^9, 3.918926134887946*^9, 3.918926990141918*^9, 
   3.9189997749003725`*^9, 3.919000500455595*^9, 3.9190088356876884`*^9, 
   3.9190119333589287`*^9, 3.9190132518825903`*^9, 3.919013703728224*^9, 
   3.9190141311676383`*^9, 3.9190150327079506`*^9, 3.919015622713456*^9, 
   3.9190159263742943`*^9, 3.9190165378084607`*^9, 3.9190445161895638`*^9, 
   3.9190663709022937`*^9, 3.9190667414236574`*^9, 3.919067046530066*^9, 
   3.9190692699189634`*^9, 3.9190814471601615`*^9, 3.9194426898604565`*^9, 
   3.920049406005402*^9, 3.920050002071634*^9, 3.920092768045205*^9, 
   3.9200955338426986`*^9, 3.9200961634798007`*^9, 3.920129440706479*^9, 
   3.920180491571046*^9, 3.9218125208419285`*^9, 3.9218317928616295`*^9, 
   3.9219258519718904`*^9, 3.926133227477258*^9, 3.926133693274705*^9, 
   3.92613374500545*^9, 3.926133859221389*^9, 3.9261349120625076`*^9, 
   3.9261375012636285`*^9},
 CellLabel->
  "During evaluation of \
In[45]:=",ExpressionUUID->"543d1afb-1fbc-47ad-ad7b-a3a2052b5fdf"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"-", "2212.`"}], ",", 
    RowBox[{"-", "2112.`"}], ",", 
    RowBox[{"-", "321.`"}], ",", 
    RowBox[{"-", "211.`"}], ",", 
    RowBox[{"-", "21.`"}], ",", 
    RowBox[{"-", "13.`"}], ",", 
    RowBox[{"-", "11.`"}], ",", 
    RowBox[{"-", "5.`"}], ",", 
    RowBox[{"-", "4.`"}], ",", 
    RowBox[{"-", "3.`"}], ",", 
    RowBox[{"-", "2.`"}], ",", 
    RowBox[{"-", "1.`"}], ",", "1.`", ",", "2.`", ",", "3.`", ",", "4.`", ",",
     "5.`", ",", "11.`", ",", "13.`", ",", "21.`", ",", "22.`", ",", "130.`", 
    ",", "211.`", ",", "321.`", ",", "2112.`", ",", "2212.`"}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9175423533471417`*^9, 3.917542876181904*^9, 3.917544138401149*^9, 
   3.9175801141748085`*^9, 3.9175930860578203`*^9, 3.9175935014735656`*^9, 
   3.917594270152607*^9, 3.9176002590006037`*^9, 3.917624735659501*^9, 
   3.9176250428429384`*^9, 3.917625735732069*^9, 3.9176259600528603`*^9, 
   3.917626152054738*^9, 3.917626873876249*^9, 3.9176275271474485`*^9, 
   3.9176277997521877`*^9, 3.917628159341399*^9, 3.917668982827531*^9, 
   3.917679747038709*^9, 3.917680231388856*^9, 3.917681871947959*^9, 
   3.9177154146434956`*^9, 3.917715961450903*^9, 3.917720907761561*^9, 
   3.9177712336652985`*^9, 3.917772726025262*^9, 3.9177733152478533`*^9, 
   3.9177782659734287`*^9, 3.9177796841428576`*^9, 3.917796582389223*^9, 
   3.917797136748993*^9, 3.91779751767564*^9, 3.9178020988915524`*^9, 
   3.917803015499759*^9, 3.917859101574503*^9, 3.9178607331755075`*^9, 
   3.9178847042613735`*^9, 3.9178872354436073`*^9, 3.917889282123623*^9, 
   3.917890864760646*^9, 3.9178910888794036`*^9, 3.917891285110143*^9, 
   3.9178916467988777`*^9, 3.9178918406004176`*^9, 3.917950142606881*^9, 
   3.917953244237399*^9, 3.9180563152735662`*^9, 3.9180580761594076`*^9, 
   3.9180581851679673`*^9, 3.9180592670889144`*^9, 3.918106872895426*^9, 
   3.9181088447506695`*^9, 3.918112632930778*^9, 3.9181128320078464`*^9, 
   3.9181130517291574`*^9, 3.918113378097988*^9, 3.918114949081773*^9, 
   3.9181151457041597`*^9, 3.9181160389512215`*^9, 3.918117982832355*^9, 
   3.9181186606554413`*^9, 3.9181188140982647`*^9, 3.918120565321519*^9, 
   3.918191397273393*^9, 3.918191539946827*^9, 3.918193955849105*^9, 
   3.9181967439422965`*^9, 3.918201765127984*^9, 3.918204199860663*^9, 
   3.918204383244171*^9, 3.918206839401971*^9, 3.9182283530605793`*^9, 
   3.9182320528889627`*^9, 3.91823489805544*^9, 3.9182749244176793`*^9, 
   3.918275986403261*^9, 3.918285092631265*^9, 3.9183715517771544`*^9, 
   3.918376542678655*^9, 3.9184593531463985`*^9, 3.9184595141333838`*^9, 
   3.9184597990580964`*^9, 3.9184604981282315`*^9, 3.918461689625449*^9, 
   3.918464811083887*^9, 3.918558315247269*^9, 3.9185735626587987`*^9, 
   3.9185752129711275`*^9, 3.9185755423674903`*^9, 3.9185761169816103`*^9, 
   3.918577168488962*^9, 3.918579211817449*^9, 3.9186183575713453`*^9, 
   3.9186186881905155`*^9, 3.91862000299105*^9, 3.918620552383114*^9, 
   3.9186437559995804`*^9, 3.918661804812936*^9, {3.918664359816717*^9, 
   3.9186643860343685`*^9}, 3.9186975356211777`*^9, 3.918924735362071*^9, 
   3.918925336990407*^9, 3.918926134917117*^9, 3.918926990172857*^9, 
   3.9189997749996376`*^9, 3.9190005004705553`*^9, 3.9190088357145753`*^9, 
   3.9190119333898783`*^9, 3.9190132518840995`*^9, 3.9190137037509193`*^9, 
   3.919014131182832*^9, 3.9190150327586565`*^9, 3.9190156227465754`*^9, 
   3.9190159264086227`*^9, 3.9190165378378825`*^9, 3.919044516222477*^9, 
   3.9190663709441757`*^9, 3.9190667414561734`*^9, 3.9190670465617323`*^9, 
   3.9190692699534397`*^9, 3.9190814471916275`*^9, 3.9194426898908243`*^9, 
   3.920049406063095*^9, 3.920050002077175*^9, 3.9200927680714393`*^9, 
   3.9200955338757553`*^9, 3.9200961634939*^9, 3.9201294407359695`*^9, 
   3.9201804916089444`*^9, 3.9218125208790035`*^9, 3.921831792879518*^9, 
   3.9219258519884477`*^9, 3.9261332275139256`*^9, 3.926133693290539*^9, 
   3.926133745019514*^9, 3.926133859241248*^9, 3.926134912085552*^9, 
   3.9261375012681336`*^9},
 CellLabel->"Out[58]=",ExpressionUUID->"73334b73-f678-4a9a-9dfe-1451e54e6df1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compilable interpolations", "Chapter",
 CellChangeTimes->{{3.92929104088654*^9, 
  3.92929104472843*^9}},ExpressionUUID->"fec07903-3749-4fac-970b-\
ea37cbae47b9"],

Cell[CellGroupData[{

Cell[TextData[{
 "Mapping ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["x", "1"], ",", "...", ",", 
      SubscriptBox["x", "n"], ",", "f"}], "}"}], "->", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox[
       RowBox[{"x", "'"}], "1"], ",", "...", ",", 
      SubscriptBox[
       RowBox[{"x", "'"}], "n"], ",", "f"}], "}"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "6a5d643a-bb7b-4a7e-a073-e40bc2868cb5"]
}], "Section",
 CellChangeTimes->{{3.9292910540086966`*^9, 
  3.9292911438676805`*^9}},ExpressionUUID->"7fcd254a-945c-4fd1-a3c2-\
be9954cdccc4"],

Cell[CellGroupData[{

Cell["2D to 2D", "Subsection",
 CellChangeTimes->{{3.929291178376808*^9, 
  3.929291179690534*^9}},ExpressionUUID->"4cd12ce7-68fd-4faf-86e7-\
6fc3126752fc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nd", "=", "2"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"cf2", "=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"xgvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<xg\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"igvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<ig\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"tgvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<tg\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"ivars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<i\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"svars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<s\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"tvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<t\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"jvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<j\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}]}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Inactivate", "[", 
         RowBox[{
          RowBox[{"Compile", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"seq", "@", 
               RowBox[{"{", 
                RowBox[{"xgvars", ",", "_Real", ",", "1"}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", "_Real", ",", "nd"}], "}"}]}], "}"}], ",", 
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"seq", "@", "igvars"}], ",", 
                RowBox[{"seq", "@", "tgvars"}], ",", 
                RowBox[{"seq", "@", "ivars"}], ",", 
                RowBox[{"seq", "@", "svars"}], ",", 
                RowBox[{"seq", "@", "tvars"}]}], "}"}], ",", 
              RowBox[{
               RowBox[{"seq", "[", 
                RowBox[{"igvars", "=", 
                 RowBox[{
                  RowBox[{"Floor", "[", "xgvars", "]"}], "-", 
                  RowBox[{"UnitStep", "[", 
                   RowBox[{"xgvars", "-", 
                    RowBox[{"indexed", "@", 
                    RowBox[{"Dimensions", "@", "y"}]}]}], "]"}]}]}], "]"}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"seq", "[", 
                RowBox[{"tgvars", "=", 
                 RowBox[{"xgvars", "-", "igvars"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"seq", "[", 
                   RowBox[{"tvars", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"tgvars", ",", "jvars"}], "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"seq", "[", 
                   RowBox[{"ivars", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"igvars", ",", "jvars"}], "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"seq", "[", 
                   RowBox[{"svars", "=", 
                    RowBox[{"1.", "-", "tvars"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"eval", "@", 
                   RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Times", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], " ", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], "]"}]}], 
                    "&"}], "/@", 
                    RowBox[{"Tuples", "@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"svars", ",", "ivars"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"tvars", ",", 
                    RowBox[{"ivars", "+", "1"}]}], "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}]}]}], 
                    "]"}]}]}], ",", 
                 RowBox[{"seq", "@", 
                  RowBox[{"{", 
                   RowBox[{"jvars", ",", 
                    RowBox[{"Length", "@", "igvars"}]}], "}"}]}]}], "]"}]}]}],
              "]"}], ",", 
            RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
            RowBox[{"RuntimeAttributes", "\[Rule]", 
             RowBox[{"{", "Listable", "}"}]}], ",", 
            RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
            RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}], 
          ",", 
          RowBox[{"Except", "[", 
           RowBox[{"seq", "|", "eval", "|", "indexed"}], "]"}]}], "]"}], "/.", 
        RowBox[{
         RowBox[{"seq", "[", "expr_", "]"}], "\[RuleDelayed]", 
         RowBox[{"RuleCondition", "@", 
          RowBox[{"(", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Inactivate", "[", 
                RowBox[{"expr", ",", 
                 RowBox[{"Except", "[", 
                  RowBox[{"slist", "|", "indexed"}], "]"}]}], "]"}], "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"l_slist", "\[RuleDelayed]", 
                  RowBox[{"l", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"indexed", "[", "l_", "]"}], "\[RuleDelayed]", 
                  RowBox[{
                   RowBox[{"Inactive", "[", "Compile`GetElement", "]"}], "[", 
                   RowBox[{"l", ",", "i"}], "]"}]}]}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "nd"}], "}"}]}], "]"}]}], ")"}]}]}]}], "/.", 
       RowBox[{
        RowBox[{"eval", "@", "expr_"}], "\[RuleDelayed]", 
        RowBox[{"RuleCondition", "[", 
         RowBox[{"Activate", "[", 
          RowBox[{"expr", "/.", 
           RowBox[{"slist", "\[Rule]", "List"}]}], "]"}], "]"}]}]}]}], "]"}], 
    "//", "Activate"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.890711783488103*^9, 3.89071178348964*^9}, {
  3.8907121412539587`*^9, 3.8907121413711557`*^9}, {3.890712694841427*^9, 
  3.8907126950000925`*^9}, {3.890712790376151*^9, 3.8907128219919777`*^9}, {
  3.891018553068019*^9, 3.8910185548862777`*^9}, {3.914141327087761*^9, 
  3.9141413282588053`*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"4fed2535-394c-41fc-93ed-fd2170456a2d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["3D to 3D", "Subsection",
 CellChangeTimes->{{3.929291178376808*^9, 
  3.929291188577453*^9}},ExpressionUUID->"43e57746-cc3f-45fe-abc8-\
17390c0bfeb8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nd", "=", "3"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"cf3", "=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"xgvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<xg\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"igvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<ig\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"tgvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<tg\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"ivars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<i\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"svars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<s\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"tvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<t\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"jvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<j\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}]}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Inactivate", "[", 
         RowBox[{
          RowBox[{"Compile", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"seq", "@", 
               RowBox[{"{", 
                RowBox[{"xgvars", ",", "_Real", ",", "1"}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", "_Real", ",", "nd"}], "}"}]}], "}"}], ",", 
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"seq", "@", "igvars"}], ",", 
                RowBox[{"seq", "@", "tgvars"}], ",", 
                RowBox[{"seq", "@", "ivars"}], ",", 
                RowBox[{"seq", "@", "svars"}], ",", 
                RowBox[{"seq", "@", "tvars"}]}], "}"}], ",", 
              RowBox[{
               RowBox[{"seq", "[", 
                RowBox[{"igvars", "=", 
                 RowBox[{
                  RowBox[{"Floor", "[", "xgvars", "]"}], "-", 
                  RowBox[{"UnitStep", "[", 
                   RowBox[{"xgvars", "-", 
                    RowBox[{"indexed", "@", 
                    RowBox[{"Dimensions", "@", "y"}]}]}], "]"}]}]}], "]"}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"seq", "[", 
                RowBox[{"tgvars", "=", 
                 RowBox[{"xgvars", "-", "igvars"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"seq", "[", 
                   RowBox[{"tvars", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"tgvars", ",", "jvars"}], "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"seq", "[", 
                   RowBox[{"ivars", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"igvars", ",", "jvars"}], "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"seq", "[", 
                   RowBox[{"svars", "=", 
                    RowBox[{"1.", "-", "tvars"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"eval", "@", 
                   RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Times", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], " ", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], "]"}]}], 
                    "&"}], "/@", 
                    RowBox[{"Tuples", "@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"svars", ",", "ivars"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"tvars", ",", 
                    RowBox[{"ivars", "+", "1"}]}], "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}]}]}], 
                    "]"}]}]}], ",", 
                 RowBox[{"seq", "@", 
                  RowBox[{"{", 
                   RowBox[{"jvars", ",", 
                    RowBox[{"Length", "@", "igvars"}]}], "}"}]}]}], "]"}]}]}],
              "]"}], ",", 
            RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
            RowBox[{"RuntimeAttributes", "\[Rule]", 
             RowBox[{"{", "Listable", "}"}]}], ",", 
            RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
            RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}], 
          ",", 
          RowBox[{"Except", "[", 
           RowBox[{"seq", "|", "eval", "|", "indexed"}], "]"}]}], "]"}], "/.", 
        RowBox[{
         RowBox[{"seq", "[", "expr_", "]"}], "\[RuleDelayed]", 
         RowBox[{"RuleCondition", "@", 
          RowBox[{"(", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Inactivate", "[", 
                RowBox[{"expr", ",", 
                 RowBox[{"Except", "[", 
                  RowBox[{"slist", "|", "indexed"}], "]"}]}], "]"}], "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"l_slist", "\[RuleDelayed]", 
                  RowBox[{"l", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"indexed", "[", "l_", "]"}], "\[RuleDelayed]", 
                  RowBox[{
                   RowBox[{"Inactive", "[", "Compile`GetElement", "]"}], "[", 
                   RowBox[{"l", ",", "i"}], "]"}]}]}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "nd"}], "}"}]}], "]"}]}], ")"}]}]}]}], "/.", 
       RowBox[{
        RowBox[{"eval", "@", "expr_"}], "\[RuleDelayed]", 
        RowBox[{"RuleCondition", "[", 
         RowBox[{"Activate", "[", 
          RowBox[{"expr", "/.", 
           RowBox[{"slist", "\[Rule]", "List"}]}], "]"}], "]"}]}]}]}], "]"}], 
    "//", "Activate"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.890711783488103*^9, 3.89071178348964*^9}, {
  3.8907121412539587`*^9, 3.8907121413711557`*^9}, {3.890712694841427*^9, 
  3.8907126950000925`*^9}, {3.890712790376151*^9, 3.8907128219919777`*^9}, {
  3.891018553068019*^9, 3.8910185548862777`*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"1e2bea03-6068-4ff0-989d-2fd194fa83bf"]
}, Open  ]],

Cell[CellGroupData[{

Cell["4D to 4D", "Subsection",
 CellChangeTimes->{{3.929291178376808*^9, 
  3.9292912088908777`*^9}},ExpressionUUID->"3127b976-2d34-4825-9a1d-\
334c1a211a43"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nd", "=", "4"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"cf4", "=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"xgvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<xg\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"igvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<ig\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"tgvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<tg\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"ivars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<i\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"svars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<s\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"tvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<t\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"jvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<j\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}]}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Inactivate", "[", 
         RowBox[{
          RowBox[{"Compile", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"seq", "@", 
               RowBox[{"{", 
                RowBox[{"xgvars", ",", "_Real", ",", "1"}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", "_Real", ",", "nd"}], "}"}]}], "}"}], ",", 
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"seq", "@", "igvars"}], ",", 
                RowBox[{"seq", "@", "tgvars"}], ",", 
                RowBox[{"seq", "@", "ivars"}], ",", 
                RowBox[{"seq", "@", "svars"}], ",", 
                RowBox[{"seq", "@", "tvars"}]}], "}"}], ",", 
              RowBox[{
               RowBox[{"seq", "[", 
                RowBox[{"igvars", "=", 
                 RowBox[{
                  RowBox[{"Floor", "[", "xgvars", "]"}], "-", 
                  RowBox[{"UnitStep", "[", 
                   RowBox[{"xgvars", "-", 
                    RowBox[{"indexed", "@", 
                    RowBox[{"Dimensions", "@", "y"}]}]}], "]"}]}]}], "]"}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"seq", "[", 
                RowBox[{"tgvars", "=", 
                 RowBox[{"xgvars", "-", "igvars"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"seq", "[", 
                   RowBox[{"tvars", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"tgvars", ",", "jvars"}], "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"seq", "[", 
                   RowBox[{"ivars", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"igvars", ",", "jvars"}], "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"seq", "[", 
                   RowBox[{"svars", "=", 
                    RowBox[{"1.", "-", "tvars"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"eval", "@", 
                   RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Times", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], " ", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], "]"}]}], 
                    "&"}], "/@", 
                    RowBox[{"Tuples", "@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"svars", ",", "ivars"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"tvars", ",", 
                    RowBox[{"ivars", "+", "1"}]}], "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}]}]}], 
                    "]"}]}]}], ",", 
                 RowBox[{"seq", "@", 
                  RowBox[{"{", 
                   RowBox[{"jvars", ",", 
                    RowBox[{"Length", "@", "igvars"}]}], "}"}]}]}], "]"}]}]}],
              "]"}], ",", 
            RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
            RowBox[{"RuntimeAttributes", "\[Rule]", 
             RowBox[{"{", "Listable", "}"}]}], ",", 
            RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
            RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}], 
          ",", 
          RowBox[{"Except", "[", 
           RowBox[{"seq", "|", "eval", "|", "indexed"}], "]"}]}], "]"}], "/.", 
        RowBox[{
         RowBox[{"seq", "[", "expr_", "]"}], "\[RuleDelayed]", 
         RowBox[{"RuleCondition", "@", 
          RowBox[{"(", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Inactivate", "[", 
                RowBox[{"expr", ",", 
                 RowBox[{"Except", "[", 
                  RowBox[{"slist", "|", "indexed"}], "]"}]}], "]"}], "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"l_slist", "\[RuleDelayed]", 
                  RowBox[{"l", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"indexed", "[", "l_", "]"}], "\[RuleDelayed]", 
                  RowBox[{
                   RowBox[{"Inactive", "[", "Compile`GetElement", "]"}], "[", 
                   RowBox[{"l", ",", "i"}], "]"}]}]}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "nd"}], "}"}]}], "]"}]}], ")"}]}]}]}], "/.", 
       RowBox[{
        RowBox[{"eval", "@", "expr_"}], "\[RuleDelayed]", 
        RowBox[{"RuleCondition", "[", 
         RowBox[{"Activate", "[", 
          RowBox[{"expr", "/.", 
           RowBox[{"slist", "\[Rule]", "List"}]}], "]"}], "]"}]}]}]}], "]"}], 
    "//", "Activate"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8907148978688216`*^9, 3.890714898931299*^9}, {
  3.8910185630697727`*^9, 3.8910185650759544`*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"ae02cbef-a43f-4e9c-ba1f-35233f642f89"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Linear and bilinear interpolations mapping ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "f"}], "}"}], "->", 
    RowBox[{"{", 
     RowBox[{"f", "(", 
      RowBox[{
       SubscriptBox["x", "rand"], ",", 
       SubscriptBox["y", "rand"]}], ")"}], "}"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "2f03577a-cc74-4460-a269-a9d8860f8418"]
}], "Section",
 CellChangeTimes->{{3.9292910540086966`*^9, 
  3.929291080265304*^9}},ExpressionUUID->"acec5e41-feda-4c23-b8ce-\
1b7ff21e5898"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"For", " ", "mapping", " ", "from", " ", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", 
       RowBox[{"f", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], "}"}], " ", "to", 
     FormBox[
      RowBox[{" ", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["x", "random"], ",", 
         SubscriptBox["y", "random"], ",", 
         RowBox[{"f", "[", 
          RowBox[{
           SubscriptBox["x", "random"], ",", 
           SubscriptBox["y", "random"]}], "]"}]}]}]}],
      TraditionalForm]}], "}"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"linint2", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"rand\[Theta]log", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"randElog", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"grid\[Theta]log", ",", "_Real", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"gridElog", ",", "_Real", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"index\[Theta]", ",", "_Integer"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"indexE", ",", "_Integer"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"distrlog", ",", "_Real", ",", "2"}], "}"}]}], "}"}], ",", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\[Theta]el", ",", "Eel", ",", "x1", ",", "x2", ",", "y1", ",", "y2",
           ",", "z11", ",", "z21", ",", "z12", ",", "z22", ",", 
          "\[CapitalDelta]", ",", "indexlarger\[Theta]", ",", "indexlargerE", 
          ",", "lenE"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Finding", " ", "the", " ", "index", " ", "of", " ", "the", " ", 
          "grids", " ", "with", " ", "the", " ", "elements", " ", "larged", 
          " ", "than", " ", "the", " ", "given", " ", "random", " ", 
          "point"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Theta]el", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"grid\[Theta]log", ",", "index\[Theta]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"indexlarger\[Theta]", "=", 
          RowBox[{"index\[Theta]", "+", 
           RowBox[{"UnitStep", "[", 
            RowBox[{"rand\[Theta]log", "-", "\[Theta]el"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Eel", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"gridElog", ",", "indexE"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"indexlargerE", "=", 
          RowBox[{"indexE", "+", 
           RowBox[{"UnitStep", "[", 
            RowBox[{"randElog", "-", "Eel"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"The", " ", "two", " ", "points", " ", "x1"}], ",", " ", 
           RowBox[{
            RowBox[{"x2", " ", "with", " ", "x1"}], " ", "<", " ", "x", " ", 
            "<", " ", "x2"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"x1", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"grid\[Theta]log", ",", 
            RowBox[{"indexlarger\[Theta]", "-", "1"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"x2", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"grid\[Theta]log", ",", "indexlarger\[Theta]"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"y1", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"gridElog", ",", 
            RowBox[{"indexlargerE", "-", "1"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"y2", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"gridElog", ",", "indexlargerE"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Corresponding", " ", "values", " ", "of", " ", "the", " ", 
           "function"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"lenE", "=", 
          RowBox[{"Length", "[", "gridElog", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"z11", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"distrlog", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"indexlarger\[Theta]", "-", "2"}], ")"}], "*", 
              "lenE"}], "+", "indexlargerE", "-", "1"}], ",", "3"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"z21", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"distrlog", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"indexlarger\[Theta]", "-", "1"}], ")"}], "*", 
              "lenE"}], "+", "indexlargerE", "-", "1"}], ",", "3"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"z12", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"distrlog", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"indexlarger\[Theta]", "-", "2"}], ")"}], "*", 
              "lenE"}], "+", "indexlargerE"}], ",", "3"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"z22", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"distrlog", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"indexlarger\[Theta]", "-", "1"}], ")"}], "*", 
              "lenE"}], "+", "indexlargerE"}], ",", "3"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"\[CapitalDelta]", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x2", "-", "x1"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"y2", "-", "y1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Exp", "[", 
          RowBox[{"(*", 
           RowBox[{"{", 
            RowBox[{
            "rand\[Theta]log", ",", "x1", ",", "x2", ",", "randElog", ",", 
             "y1", ",", "y2", ",", "z11", ",", "z21", ",", "z12", ",", "z22", 
             ","}]}], "*)"}], 
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{"x2", "-", "rand\[Theta]log"}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{"y2", "-", "randElog"}], ")"}]}], "\[CapitalDelta]"], 
            "*", "z11"}], "+", 
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{"rand\[Theta]log", "-", "x1"}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{"y2", "-", "randElog"}], ")"}]}], "\[CapitalDelta]"], 
            "z21"}], "+", 
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{"x2", "-", "rand\[Theta]log"}], ")"}], 
              RowBox[{"(", 
               RowBox[{"randElog", "-", "y1"}], ")"}]}], "\[CapitalDelta]"], 
            "*", "z12"}], "+", 
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{"rand\[Theta]log", "-", "x1"}], ")"}], 
              RowBox[{"(", 
               RowBox[{"randElog", "-", "y1"}], ")"}]}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"x2", "-", "x1"}], ")"}], 
              RowBox[{"(", 
               RowBox[{"y2", "-", "y1"}], ")"}]}]], "z22"}]}], "]"}]}]}], 
       RowBox[{"(*", "}", "*)"}], "\[IndentingNewLine]", "]"}], ",", 
      RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
      RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
      RowBox[{"RuntimeAttributes", "->", 
       RowBox[{"{", "Listable", "}"}]}], ",", 
      RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"<<", "CompiledFunctionTools`"}], "\n", 
   RowBox[{
    RowBox[{"CompilePrint", "@", "linint2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"linint1", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"rand\[Theta]log", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"grid\[Theta]log", ",", "_Real", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"index\[Theta]", ",", "_Integer"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"distrlog", ",", "_Real", ",", "2"}], "}"}]}], "}"}], ",", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\[Theta]el", ",", "x1", ",", "x2", ",", "z1", ",", "z2", ",", 
          "\[CapitalDelta]", ",", "indexlarger\[Theta]"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Finding", " ", "the", " ", "index", " ", "of", " ", "the", " ", 
          "grids", " ", "with", " ", "the", " ", "elements", " ", "larged", 
          " ", "than", " ", "the", " ", "given", " ", "random", " ", 
          "point"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Theta]el", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"grid\[Theta]log", ",", "index\[Theta]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"indexlarger\[Theta]", "=", 
          RowBox[{"index\[Theta]", "+", 
           RowBox[{"UnitStep", "[", 
            RowBox[{"rand\[Theta]log", "-", "\[Theta]el"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"The", " ", "two", " ", "points", " ", "x1"}], ",", " ", 
           RowBox[{
            RowBox[{"x2", " ", "with", " ", "x1"}], " ", "<", " ", "x", " ", 
            "<", " ", "x2"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"x1", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"grid\[Theta]log", ",", 
            RowBox[{"indexlarger\[Theta]", "-", "1"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"x2", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"grid\[Theta]log", ",", "indexlarger\[Theta]"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Corresponding", " ", "values", " ", "of", " ", "the", " ", 
           "function"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"z1", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"distrlog", ",", "indexlarger\[Theta]", ",", "2"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"z2", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"distrlog", ",", 
            RowBox[{"indexlarger\[Theta]", "-", "1"}], ",", "2"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"\[CapitalDelta]", "=", 
          RowBox[{"(", 
           RowBox[{"x2", "-", "x1"}], ")"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"{", 
           RowBox[{
           "rand\[Theta]log", ",", "x1", ",", "x2", ",", "z1", ",", "z2", 
            ","}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"z1", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"rand\[Theta]log", "-", "x1"}], ")"}], "*", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"z2", "-", "z1"}], ")"}], "/", 
            "\[CapitalDelta]"}]}]}]}]}], 
       RowBox[{"(*", "}", "*)"}], "\[IndentingNewLine]", "]"}], ",", 
      RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
      RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
      RowBox[{"RuntimeAttributes", "->", 
       RowBox[{"{", "Listable", "}"}]}], ",", 
      RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"<<", "CompiledFunctionTools`"}], "\n", 
   RowBox[{
    RowBox[{"CompilePrint", "@", "linint1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Basic", " ", "linear", " ", "search", " ", "function", " ", "adjusted", 
     " ", "to", " ", "return", " ", "the", " ", "index", " ", "of", " ", 
     "the", " ", "largest", " ", "element", " ", "smaller", " ", "than", " ", 
     "or", " ", "equal", " ", "to", " ", "val"}], "*)"}], 
   RowBox[{
    RowBox[{"nearestIndexSearch", "=", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"arr", ",", "_Real", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"val", ",", "_Real"}], "}"}]}], "}"}], ",", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", "=", "1"}], "}"}], ",", 
         RowBox[{
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "<=", 
              RowBox[{"Length", "[", "arr", "]"}]}], "&&", 
             RowBox[{"val", ">=", 
              RowBox[{"arr", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
            RowBox[{"i", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"i", "-", "1"}]}]}], "]"}], ",", 
       RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
       RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"linint2WithNearest", "=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"nf", "=", "nearestIndexSearch"}], "}"}], ",", 
       RowBox[{"Compile", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"xlogrand", ",", "_Real"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"ylogrand", ",", "_Real"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"gridxlog", ",", "_Real", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"gridylog", ",", "_Real", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"distrlog", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "xel", ",", "yel", ",", "x1", ",", "x2", ",", "y1", ",", "y2", 
             ",", "z11", ",", "z21", ",", "z12", ",", "z22", ",", 
             "\[CapitalDelta]", ",", "leny", ",", "indexlargerx", ",", 
             "indexlargery", ",", "nearestindexx", ",", "nearestindexy"}], 
            "}"}], ",", 
           RowBox[{"(*", 
            RowBox[{
            "Finding", " ", "the", " ", "index", " ", "of", " ", "the", " ", 
             "grids", " ", "with", " ", "the", " ", "elements", " ", "larger",
              " ", "than", " ", "the", " ", "given", " ", "random", " ", 
             "point"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nearestindexx", "=", 
             RowBox[{"nf", "[", 
              RowBox[{"gridxlog", ",", "xlogrand"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"nearestindexy", "=", 
             RowBox[{"nf", "[", 
              RowBox[{"gridylog", ",", "ylogrand"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "Adjust", " ", "indices", " ", "to", " ", "ensure", " ", "the", 
              " ", "correct", " ", "bounding", " ", "values"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"indexlargerx", "=", 
             RowBox[{"nearestindexx", "+", "1"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"indexlargery", "=", 
             RowBox[{"nearestindexy", "+", "1"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"The", " ", "two", " ", "points", " ", "x1"}], ",", " ", 
              RowBox[{
               RowBox[{"x2", " ", "with", " ", "x1"}], " ", "<", " ", "x", 
               " ", "<", " ", "x2"}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"x1", "=", 
             RowBox[{"Compile`GetElement", "[", 
              RowBox[{"gridxlog", ",", 
               RowBox[{"indexlargerx", "-", "1"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"x2", "=", 
             RowBox[{"Compile`GetElement", "[", 
              RowBox[{"gridxlog", ",", "indexlargerx"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"y1", "=", 
             RowBox[{"Compile`GetElement", "[", 
              RowBox[{"gridylog", ",", 
               RowBox[{"indexlargery", "-", "1"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"y2", "=", 
             RowBox[{"Compile`GetElement", "[", 
              RowBox[{"gridylog", ",", "indexlargery"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "Corresponding", " ", "values", " ", "of", " ", "the", " ", 
              "function"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"leny", "=", 
             RowBox[{"Length", "[", "gridylog", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"z11", "=", 
             RowBox[{"Compile`GetElement", "[", 
              RowBox[{"distrlog", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"indexlargerx", "-", "2"}], ")"}], "*", "leny"}], 
                "+", "indexlargery", "-", "1"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"z21", "=", 
             RowBox[{"Compile`GetElement", "[", 
              RowBox[{"distrlog", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"indexlargerx", "-", "1"}], ")"}], "*", "leny"}], 
                "+", "indexlargery", "-", "1"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"z12", "=", 
             RowBox[{"Compile`GetElement", "[", 
              RowBox[{"distrlog", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"indexlargerx", "-", "2"}], ")"}], "*", "leny"}], 
                "+", "indexlargery"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"z22", "=", 
             RowBox[{"Compile`GetElement", "[", 
              RowBox[{"distrlog", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"indexlargerx", "-", "1"}], ")"}], "*", "leny"}], 
                "+", "indexlargery"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"\[CapitalDelta]", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"x2", "-", "x1"}], ")"}], 
              RowBox[{"(", 
               RowBox[{"y2", "-", "y1"}], ")"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Exp", "[", 
             RowBox[{"(*", 
              RowBox[{"{", 
               RowBox[{
               "rand\[Theta]log", ",", "x1", ",", "x2", ",", "randElog", ",", 
                "y1", ",", "y2", ",", "z11", ",", "z21", ",", "z12", ",", 
                "z22", ","}]}], "*)"}], 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"x2", "-", "xlogrand"}], ")"}], "*", 
                 RowBox[{"(", 
                  RowBox[{"y2", "-", "ylogrand"}], ")"}]}], 
                "\[CapitalDelta]"], "*", "z11"}], "+", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"xlogrand", "-", "x1"}], ")"}], "*", 
                 RowBox[{"(", 
                  RowBox[{"y2", "-", "ylogrand"}], ")"}]}], 
                "\[CapitalDelta]"], "z21"}], "+", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"x2", "-", "xlogrand"}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{"ylogrand", "-", "y1"}], ")"}]}], 
                "\[CapitalDelta]"], "*", "z12"}], "+", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"xlogrand", "-", "x1"}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{"ylogrand", "-", "y1"}], ")"}]}], 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"x2", "-", "x1"}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{"y2", "-", "y1"}], ")"}]}]], "z22"}]}], "]"}]}]}], 
          RowBox[{"(*", "}", "*)"}], "]"}], "\[IndentingNewLine]", ",", 
         RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
         RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
         RowBox[{"RuntimeAttributes", "->", 
          RowBox[{"{", "Listable", "}"}]}], ",", 
         RowBox[{"Parallelization", "->", "True"}], ",", 
         RowBox[{"CompilationOptions", "->", 
          RowBox[{"{", 
           RowBox[{"\"\<InlineCompiledFunctions\>\"", "->", "True"}], 
           "}"}]}]}], "]"}]}], "]"}]}], ";"}]}]}]], "Input",ExpressionUUID->\
"be73174a-8d0d-4157-8a73-61dd1317e2e4"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1117.2, 642.9},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>0.9 Inherited,
FrontEndVersion->"13.2 for Microsoft Windows (64-bit) (November 18, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"3a37a0ac-9990-4337-814e-6ed4a5a23b84"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 239, 4, 62, "Chapter",ExpressionUUID->"d7be49df-2bf3-43f5-ba3c-41377b65e643"],
Cell[822, 28, 6624, 167, 377, "Input",ExpressionUUID->"c2e6ed6f-6c23-4776-b163-326a04f3ebf9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7483, 200, 159, 3, 62, "Chapter",ExpressionUUID->"c7c96310-9bf8-4b94-933a-6878fa052910"],
Cell[CellGroupData[{
Cell[7667, 207, 15876, 359, 724, "Input",ExpressionUUID->"abe8c1ef-9006-45bb-a0e9-f9a17a90acb2"],
Cell[23546, 568, 3620, 53, 20, "Print",ExpressionUUID->"d7f0f13a-e1c4-4262-a06d-9f02c905834e"],
Cell[27169, 623, 9590, 161, 112, "Output",ExpressionUUID->"d9a2bfd2-bdef-404c-b2d6-492856845e62"],
Cell[36762, 786, 3615, 53, 20, "Print",ExpressionUUID->"71d1c72a-b415-4711-9585-7caf37aac74b"],
Cell[40380, 841, 6780, 102, 32, "Output",ExpressionUUID->"678a2040-92ed-4f2f-a4fa-94fc0ca5556e"],
Cell[47163, 945, 3619, 53, 20, "Print",ExpressionUUID->"543d1afb-1fbc-47ad-ad7b-a3a2052b5fdf"],
Cell[50785, 1000, 4166, 67, 28, "Output",ExpressionUUID->"73334b73-f678-4a9a-9dfe-1451e54e6df1"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[55000, 1073, 168, 3, 62, "Chapter",ExpressionUUID->"fec07903-3749-4fac-970b-ea37cbae47b9"],
Cell[CellGroupData[{
Cell[55193, 1080, 632, 20, 59, "Section",ExpressionUUID->"7fcd254a-945c-4fd1-a3c2-be9954cdccc4"],
Cell[CellGroupData[{
Cell[55850, 1104, 156, 3, 48, "Subsection",ExpressionUUID->"4cd12ce7-68fd-4faf-86e7-6fc3126752fc"],
Cell[56009, 1109, 7675, 183, 302, "Input",ExpressionUUID->"4fed2535-394c-41fc-93ed-fd2170456a2d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63721, 1297, 156, 3, 48, "Subsection",ExpressionUUID->"43e57746-cc3f-45fe-abc8-17390c0bfeb8"],
Cell[63880, 1302, 7624, 182, 302, "Input",ExpressionUUID->"1e2bea03-6068-4ff0-989d-2fd194fa83bf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71541, 1489, 158, 3, 48, "Subsection",ExpressionUUID->"3127b976-2d34-4825-9a1d-334c1a211a43"],
Cell[71702, 1494, 7477, 180, 302, "Input",ExpressionUUID->"ae02cbef-a43f-4e9c-ba1f-35233f642f89"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[79228, 1680, 573, 17, 59, "Section",ExpressionUUID->"acec5e41-feda-4c23-b8ce-1b7ff21e5898"],
Cell[79804, 1699, 21317, 505, 1307, "Input",ExpressionUUID->"be73174a-8d0d-4157-8a73-61dd1317e2e4"]
}, Open  ]]
}, Open  ]]
}
]
*)

