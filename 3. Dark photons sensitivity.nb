(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    349939,       8549]
NotebookOptionsPosition[    307707,       7910]
NotebookOutlinePosition[    334194,       8262]
CellTagsIndexPosition[    333924,       8252]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Just launch the code below to run the notebook (shift+enter)", "Title",
 CellChangeTimes->{{3.8934376452895875`*^9, 
  3.8934376644509068`*^9}},ExpressionUUID->"cc091cd5-168d-44d1-9a83-\
ebb576c10ceb"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BlockEvaluation", "[", "tag_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nb", "=", 
      RowBox[{"EvaluationNotebook", "[", "]"}]}], ";", "\n", 
     RowBox[{"NotebookFind", "[", 
      RowBox[{"nb", ",", "tag", ",", "All", ",", "CellTags"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"infoDialog", "[", "phrase_", "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<Proceed\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DirectoryQ", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<Auxiliary data\>\""}], "}"}], "]"}], "]"}], "//", 
       "ToString"}], ")"}], "\[Equal]", "\"\<False\>\""}], ",", 
    RowBox[{"CreateDirectory", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<Auxiliary data\>\""}], "}"}], "]"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DirectoryQ", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<Auxiliary data/Dark photons\>\""}], "}"}], "]"}], "]"}], "//",
        "ToString"}], ")"}], "\[Equal]", "\"\<False\>\""}], ",", 
    RowBox[{"CreateDirectory", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<Auxiliary data/Dark photons\>\""}], "}"}], "]"}], "]"}]}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"choiceslist", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<Acceptance\>\"", ",", "\"\<Tabulated number of events\>\"", ",", 
     "\"\<Sensitivity\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"taglist", "[", "\"\<Tabulated number of events\>\"", "]"}], "=", 
   "\"\<Number-of-events\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"taglist", "[", "\"\<Sensitivity\>\"", "]"}], "=", 
   "\"\<Sensitivity\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"taglist", "[", "\"\<Acceptance\>\"", "]"}], "=", 
   "\"\<Acceptance\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"computationchoice", "=", 
   RowBox[{"dropdownDialog", "[", 
    RowBox[{
    "choiceslist", ",", 
     "\"\<Do you want to compute the tabulated number of events and then \
sensitivity, or just sensitivity (if the tabulated number of events has been \
already produced)?\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tagselected", "=", 
   RowBox[{"taglist", "[", "computationchoice", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"BlockEvaluation", "[", "tagselected", "]"}]}], "Input",
 CellChangeTimes->{{3.893437585709897*^9, 3.8934375895369635`*^9}, {
   3.8934376329497385`*^9, 3.893437658846809*^9}, 3.893573113541499*^9, {
   3.89366535580302*^9, 3.8936653565596275`*^9}, {3.895053865536884*^9, 
   3.8950538657696643`*^9}, {3.895127061998116*^9, 3.8951270800527506`*^9}, 
   3.9025629436017327`*^9, 3.9027295382725515`*^9, 3.9028895266343613`*^9, {
   3.9038925204404736`*^9, 3.903892532444302*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"c8a7c6bd-754e-4c81-b344-1b6f8cd06de4"]
}, Closed]],

Cell[CellGroupData[{

Cell["Definitions", "Title",
 CellChangeTimes->{{3.8765025649423122`*^9, 3.876502598054132*^9}, {
  3.876502741347786*^9, 3.876502742695223*^9}, {3.876503237989088*^9, 
  3.876503241621973*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"294691d8-aa8b-4eec-b72c-7eddbed8edd7"],

Cell[CellGroupData[{

Cell["Parameters", "Chapter",
 CellChangeTimes->{{3.8765032665997076`*^9, 3.876503268324252*^9}, 
   3.8867405532570024`*^9},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"cf63fabc-7a3b-4498-8bf8-f69a301f20dc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"infoDialog", "[", "phrase_", "]"}], ":=", 
   RowBox[{"DialogInput", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
     RowBox[{"Column", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
        RowBox[{"Button", "[", 
         RowBox[{"\"\<Proceed\>\"", ",", 
          RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
      "]"}]}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"pp", " ", "cross"}], "-", 
    RowBox[{
    "section", " ", "in", " ", "mb", " ", "in", " ", "terms", " ", "of", " ", 
     "invariant", " ", "mass", " ", "s"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Z", "=", "35.45"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", "=", "0.308"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Y1", "=", "42.53"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Y2", "=", "33.34"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s0", "=", 
   SuperscriptBox["5.38", "2"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Eta]1", "=", "0.458"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Eta]2", "=", "0.545"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MP", "=", "0.938"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S", "[", 
    RowBox[{"Pp_", ",", "mp_"}], "]"}], "=", 
   RowBox[{"2", "*", "Pp", "*", "mp"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sigmapp", "[", "s_", "]"}], "=", 
   RowBox[{"Z", "+", 
    RowBox[{"B", "*", 
     SuperscriptBox[
      RowBox[{"Log", "[", 
       RowBox[{"s", "/", "s0"}], "]"}], "2"]}], "+", 
    RowBox[{"Y1", "*", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"s1", "/", "s"}], ")"}], "\[Eta]1"]}], "-", 
    RowBox[{"Y2", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"s1", "/", "s"}], ")"}], "\[Eta]2"]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]pNucleonInpb", "[", "Atarget_", "]"}], "=", 
   RowBox[{"51.", "*", 
    SuperscriptBox["Atarget", 
     RowBox[{"-", "0.29"}]], "*", 
    SuperscriptBox["10", "9"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]ppLHC", "=", 
    RowBox[{"72.", "*", 
     SuperscriptBox["10", "9"]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Invariant", " ", "mass", " ", "of", " ", "two", " ", "protons", " ", "in",
     " ", "lab", " ", "frame", " ", "of", " ", "one", " ", "proton"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SPP", "[", "Eplab_", "]"}], "=", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"Eplab", "+", "1"}], ")"}], "2"], "-", 
    SuperscriptBox["Eplab", "2"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S", "[", 
    RowBox[{"Pp_", ",", "mp_"}], "]"}], "=", 
   RowBox[{"2", "*", "Pp", "*", "mp"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Sprime", "[", 
     RowBox[{"mp_", ",", "Pp_", ",", "PV_"}], "]"}], "=", 
    RowBox[{"2", "*", "mp", "*", 
     RowBox[{"(", 
      RowBox[{"Pp", "-", "PV"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Conversion", " ", "units"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GeVMinusOneTom", "=", 
   RowBox[{"2", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "16"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"chbarval", "=", 
    RowBox[{"3", "*", 
     SuperscriptBox["10", "8"], "*", "6.58", "*", 
     SuperscriptBox["10", 
      RowBox[{"-", "25"}]]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"EM", " ", "coupling"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Alpha]EM", "=", 
    RowBox[{"1", "/", "137"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Mesons", " ", "masses"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m\[Rho]0", "=", "0.775"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m\[Pi]0", "=", "0.135"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m\[Eta]", "=", "0.547"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m\[Eta]pr", "=", "0.958"}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQfXJKx6frD984TpX/B6aV+ay5bgJpL5cGbhD985VM
V9zXN47lN9X6QHRm1uZdIPqZ9IPdIJp/WS5nPJBWWbAGTH+xU0xIANJZYVPz
QXRi5d5SED3rc3sZiP5RnN8Mom2vHG0B0XeF93WB6ICJzt0gesLXlBnpQHrR
XqGZIFpCbdoWEP0hxXQ7iJariXkGou8djQPTKTLqKzKAtLlo6GoQXcB0oU3p
zxvH91JXwLT37/gER6a3jn4TgnJB9L4puatAdMSmtLUgusZL+NZuIO0Sbw2m
Bcwsn25heeu4I2E1mI663OEQzP7WkYNxDpgGAPZIo9g=
  "],
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->"In[1]:=",ExpressionUUID->"2c1cafc9-37d9-434e-bd2d-c0787bc6f55b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["DP phenomenology", "Chapter",
 CellChangeTimes->{{3.876502665052594*^9, 3.8765026657521577`*^9}, 
   3.8765032389371314`*^9, 3.8867405737216787`*^9, {3.886821364395908*^9, 
   3.886821366824774*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"bfd36837-c4ed-4fec-ab58-b1be4facaa6c"],

Cell[CellGroupData[{

Cell["Decays", "Section",
 CellChangeTimes->{{3.877584114519929*^9, 3.877584115297123*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"04c8f572-467e-4c76-8fac-f5585da995c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Decay", " ", "width", " ", "in", " ", "GeV"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalGamma]DP", "[", 
      RowBox[{"mV_", ",", "\[Epsilon]2_"}], "]"}], "=", 
     RowBox[{"\[Epsilon]2", "*", 
      RowBox[{"10", "^", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Log10", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
               RowBox[{"Log10", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
            RowBox[{"Import", "[", 
             RowBox[{
              RowBox[{"FileNameJoin", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"NotebookDirectory", "[", "]"}], ",", 
                 "\"\<phenomenology/Dark photon/decay \
widths/GammaDarkPhoton.txt\>\""}], "}"}], "]"}], ",", "\"\<Table\>\""}], 
             "]"}]}], ",", 
           RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
         RowBox[{"Log10", "[", "mV", "]"}], "]"}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"LogLogPlot", "[", 
    RowBox[{
     RowBox[{"\[CapitalGamma]DP", "[", 
      RowBox[{"mV", ",", "1"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"mV", ",", "0.05", ",", "5"}], "}"}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Decay", " ", "length"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"c\[Tau]DP", "[", 
      RowBox[{"mV_", ",", "\[Epsilon]2_"}], "]"}], "=", 
     FractionBox["chbarval", 
      RowBox[{"\[CapitalGamma]DP", "[", 
       RowBox[{"mV", ",", "\[Epsilon]2"}], "]"}]]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ldecayDP", "[", 
      RowBox[{"mV_", ",", "\[Epsilon]2_", ",", "EV_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"c\[Tau]DP", "[", 
       RowBox[{"mV", ",", "\[Epsilon]2"}], "]"}], "*", 
      FractionBox[
       SqrtBox[
        RowBox[{
         SuperscriptBox["EV", "2"], "-", 
         SuperscriptBox["mV", "2"]}]], "mV"]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8765027030040936`*^9, 3.876502712230002*^9}, {
   3.8765056490712585`*^9, 3.8765056684143023`*^9}, {3.8775935816940823`*^9, 
   3.877593651036413*^9}, {3.8775936851602736`*^9, 3.877593693594926*^9}, {
   3.8867405804606123`*^9, 3.886740855468573*^9}, {3.886740927115221*^9, 
   3.8867410004506335`*^9}, {3.8867589177998257`*^9, 3.886758933299265*^9}, 
   3.8868371903483343`*^9, {3.892180950096738*^9, 3.892180969099872*^9}, {
   3.8928884714154296`*^9, 3.892888477362914*^9}, {3.904903264799167*^9, 
   3.904903264924593*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"bfe2aed5-8f0a-4cad-a1aa-1740c3919a79"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Production probabilities", "Section",
 CellChangeTimes->{{3.877584122615653*^9, 3.8775841289684377`*^9}, {
  3.886741240873562*^9, 3.886741242690644*^9}, {3.8868213989059453`*^9, 
  3.8868214008628902`*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"2c3557ed-dc43-425a-be83-789280bbdf3c"],

Cell[CellGroupData[{

Cell["Bremsstrahlung", "Subsection",
 CellChangeTimes->{{3.8867412669050264`*^9, 3.8867412688103676`*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"34cdd10a-d410-4f6f-bbdd-1d6a49f550a0"],

Cell[CellGroupData[{

Cell["Proton form-factor in timelike region ", "Subsubsection",
 CellChangeTimes->{{3.886741274972128*^9, 3.8867412800960164`*^9}, {
  3.886759221990326*^9, 3.8867592476574197`*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"0b267ea5-8acf-426c-a2cd-fec2eaa31b1c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"The", " ", "form"}], "-", 
      RowBox[{
      "factor", " ", "is", " ", "derived", " ", "assuming", " ", "the", " ", 
       "mixing", " ", "of", " ", "DPs", " ", "with", " ", "3", " ", "\[Rho]", 
       " ", "and", " ", "3", " ", "\[Omega]", " ", "resonances"}]}], ",", 
     RowBox[{
      RowBox[{
      "with", " ", "the", " ", "6", " ", "couplings", " ", "fixed", " ", 
       "from", " ", "experiment", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"lowest", " ", "\[Rho]"}], ",", 
         RowBox[{"\[Omega]", " ", "resonances"}]}], ")"}]}], " ", "+", 
      RowBox[{"boundary", " ", "conditions"}]}]}], ")"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Masses", " ", "and", " ", "other", " ", "parameters"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"f\[Omega]DP", "=", "1.011"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f\[Rho]DP", "=", "0.616"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"M\[Omega]780", ",", "M\[Omega]1420", ",", "M\[Omega]1650"}], 
      "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"0.78", ",", "1.42", ",", "1.65"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Gamma\[Omega]780", ",", "Gamma\[Omega]1420", ",", 
       "Gamma\[Omega]1650"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"0.0084", ",", "0.29", ",", "0.315"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"M\[Rho]780", ",", "M\[Rho]1450", ",", "M\[Rho]1700"}], "}"}], 
     "=", 
     RowBox[{"{", 
      RowBox[{"0.77", ",", "1.45", ",", "1.7"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Gamma\[Rho]780", ",", "Gamma\[Rho]1450", ",", "Gamma\[Rho]1700"}], 
      "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"0.15", ",", "0.4", ",", "0.25"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FormFactorBremDPTemp", "[", 
      RowBox[{"mV_", ",", "mx_", ",", "\[CapitalGamma]x_", ",", "fx_"}], 
      "]"}], "=", 
     FractionBox[
      RowBox[{"fx", "*", 
       SuperscriptBox["mx", "2"]}], 
      RowBox[{
       SuperscriptBox["mx", "2"], "-", 
       SuperscriptBox["mV", "2"], "-", 
       RowBox[{"I", "*", "\[CapitalGamma]x", "*", "mx"}]}]]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FormFactorBremDP\[Omega]Temp", "[", "mV_", "]"}], "=", 
    RowBox[{"Chop", "[", 
     RowBox[{
      RowBox[{"FormFactorBremDPTemp", "[", 
       RowBox[{
        RowBox[{"I", "*", "mV"}], ",", "M\[Omega]780", ",", "0", ",", 
        "f\[Omega]DP"}], "]"}], "+", 
      RowBox[{"FormFactorBremDPTemp", "[", 
       RowBox[{
        RowBox[{"I", "*", "mV"}], ",", "M\[Omega]1420", ",", "0", ",", 
        "f\[Omega]Pr"}], "]"}], "+", 
      RowBox[{"FormFactorBremDPTemp", "[", 
       RowBox[{
        RowBox[{"I", "*", "mV"}], ",", "M\[Omega]1650", ",", "0", ",", 
        "f\[Omega]PrPr"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FormFactorBremDP\[Rho]Temp", "[", "mV_", "]"}], "=", 
     RowBox[{"Chop", "[", 
      RowBox[{
       RowBox[{"FormFactorBremDPTemp", "[", 
        RowBox[{
         RowBox[{"I", "*", "mV"}], ",", "M\[Rho]780", ",", "0", ",", 
         "f\[Rho]DP"}], "]"}], "+", 
       RowBox[{"FormFactorBremDPTemp", "[", 
        RowBox[{
         RowBox[{"I", "*", "mV"}], ",", "M\[Rho]1450", ",", "0", ",", 
         "f\[Rho]Pr"}], "]"}], "+", 
       RowBox[{"FormFactorBremDPTemp", "[", 
        RowBox[{
         RowBox[{"I", "*", "mV"}], ",", "M\[Rho]1700", ",", "0", ",", 
         "f\[Rho]PrPr"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"sol\[Omega]", "=", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"FormFactorBremDP\[Omega]Temp", "[", "0", "]"}], "\[Equal]",
           "0.5"}], "&&", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Limit", "[", 
            RowBox[{
             RowBox[{
              SuperscriptBox["mV", "2"], 
              RowBox[{"FormFactorBremDP\[Omega]Temp", "[", "mV", "]"}]}], ",", 
             RowBox[{"mV", "\[Rule]", "Infinity"}]}], "]"}], ")"}], 
          "\[Equal]", "0"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"f\[Omega]Pr", ",", "f\[Omega]PrPr"}], "}"}]}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"sol\[Rho]", "=", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"FormFactorBremDP\[Rho]Temp", "[", "0", "]"}], "\[Equal]", 
          "0.5"}], "&&", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Limit", "[", 
            RowBox[{
             RowBox[{
              SuperscriptBox["mV", "2"], 
              RowBox[{"FormFactorBremDP\[Rho]Temp", "[", "mV", "]"}]}], ",", 
             RowBox[{"mV", "\[Rule]", "Infinity"}]}], "]"}], ")"}], 
          "\[Equal]", "0"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"f\[Rho]Pr", ",", "f\[Rho]PrPr"}], "}"}]}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FormFactorBremDP", "[", "mV_", "]"}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"FormFactorBremDPTemp", "[", 
         RowBox[{
         "mV", ",", "M\[Omega]780", ",", "Gamma\[Omega]780", ",", 
          "f\[Omega]DP"}], "]"}], "+", 
        RowBox[{"FormFactorBremDPTemp", "[", 
         RowBox[{"mV", ",", "M\[Omega]1420", ",", "Gamma\[Omega]1420", ",", 
          RowBox[{"f\[Omega]Pr", "/.", "sol\[Omega]"}]}], "]"}], "+", 
        RowBox[{"FormFactorBremDPTemp", "[", 
         RowBox[{"mV", ",", "M\[Omega]1650", ",", "Gamma\[Omega]1650", ",", 
          RowBox[{"f\[Omega]PrPr", "/.", "sol\[Omega]"}]}], "]"}]}], ")"}], 
      "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"FormFactorBremDPTemp", "[", 
         RowBox[{
         "mV", ",", "M\[Rho]780", ",", "Gamma\[Rho]780", ",", "f\[Rho]DP"}], 
         "]"}], "+", 
        RowBox[{"FormFactorBremDPTemp", "[", 
         RowBox[{"mV", ",", "M\[Rho]1450", ",", "Gamma\[Rho]1450", ",", 
          RowBox[{"f\[Rho]Pr", "/.", "sol\[Rho]"}]}], "]"}], "+", 
        RowBox[{"FormFactorBremDPTemp", "[", 
         RowBox[{"mV", ",", "M\[Rho]1700", ",", "Gamma\[Rho]1700", ",", 
          RowBox[{"f\[Rho]PrPr", "/.", "sol\[Rho]"}]}], "]"}]}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"LogLogPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Abs", "[", 
       RowBox[{"FormFactorBremDP", "[", "mV", "]"}], "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"mV", ",", "0.1", ",", "2"}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.822472937377986*^9, 3.822472958787899*^9}, {
   3.822473164264882*^9, 3.8224732169513645`*^9}, {3.8224732650870314`*^9, 
   3.82247340649076*^9}, {3.8224739149924173`*^9, 3.8224739215133142`*^9}, {
   3.8224739584042616`*^9, 3.8224739701273427`*^9}, 3.822474249386196*^9, {
   3.822474485929841*^9, 3.822474542582522*^9}, {3.8224748380407495`*^9, 
   3.8224748464105816`*^9}, {3.8765031553789*^9, 3.8765031570765734`*^9}, {
   3.8867410352643704`*^9, 3.886741035534209*^9}, {3.8867410760390997`*^9, 
   3.8867410783231735`*^9}, {3.886741117233474*^9, 3.886741208713107*^9}, {
   3.886759249554492*^9, 3.8867592836208363`*^9}, {3.88675937342173*^9, 
   3.8867594003906803`*^9}, {3.886759559571762*^9, 3.8867596483855095`*^9}},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->"In[31]:=",ExpressionUUID->"70094ca6-e1b1-4123-80be-219218a54741"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bremsstrahlung probability", "Subsubsection",
 CellChangeTimes->{{3.886741352659154*^9, 3.8867413608643293`*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"47c3ab2a-08a9-4007-8ead-36f50d19083d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Double", " ", "differential", " ", "cross"}], "-", 
     RowBox[{"section", " ", 
      FractionBox[
       RowBox[{
        SuperscriptBox["d", "2"], 
        SubscriptBox["\[Sigma]", "brem"]}], 
       RowBox[{
        SubscriptBox["dp", "T"], "dz"}]]}]}], ",", " ", 
    RowBox[{
     RowBox[{"where", " ", 
      SubscriptBox["p", "T"], " ", "is", " ", "the", " ", 
      RowBox[{"DP", "'"}], "s", " ", "transverse", " ", "momentum", " ", 
      "and", " ", "z"}], " ", "=", " ", 
     RowBox[{
      SubscriptBox["E", "DP"], "/", 
      SubscriptBox["p", "beam"]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"H1", "[", 
      RowBox[{"z_", ",", "pT_", ",", "mp_", ",", "mV_"}], "]"}], "=", 
     RowBox[{
      SuperscriptBox["pT", "2"], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "z"}], ")"}], "*", 
       SuperscriptBox["mV", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["z", "2"], "*", 
       SuperscriptBox["mp", "2"]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"d2NdpTdz", "[", 
      RowBox[{
      "mp_", ",", "z_", ",", "pT_", ",", "Pp_", ",", "mV_", ",", 
       "\[Epsilon]2_", ",", "\[Alpha]em_"}], "]"}], "=", 
     RowBox[{
      FractionBox[
       RowBox[{"2", "*", "pT", "*", "\[Epsilon]2", "*", "\[Alpha]em"}], 
       RowBox[{"2", "*", "Pi", "*", 
        RowBox[{"H1", "[", 
         RowBox[{"z", ",", "pT", ",", "mp", ",", "mV"}], "]"}]}]], "*", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "-", "z"}], ")"}], "2"]}], ")"}], "z"], "-", 
        RowBox[{"2", "*", "z", "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", "z"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "*", 
               SuperscriptBox["mp", "2"]}], "+", 
              SuperscriptBox["mV", "2"]}], ")"}], 
            RowBox[{"H1", "[", 
             RowBox[{"z", ",", "pT", ",", "mp", ",", "mV"}], "]"}]], "-", 
           FractionBox[
            RowBox[{
             SuperscriptBox["z", "2"], "*", "2", "*", 
             SuperscriptBox["mp", "4"]}], 
            SuperscriptBox[
             RowBox[{"H1", "[", 
              RowBox[{"z", ",", "pT", ",", "mp", ",", "mV"}], "]"}], "2"]]}], 
          ")"}]}], "+", 
        FractionBox[
         RowBox[{"2", "*", "z", "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", "z"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"z", "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "-", "z"}], ")"}], "2"]}], ")"}], "*", 
          SuperscriptBox["mp", "2"], "*", 
          SuperscriptBox["mV", "2"]}], 
         SuperscriptBox[
          RowBox[{"H1", "[", 
           RowBox[{"z", ",", "pT", ",", "mp", ",", "mV"}], "]"}], "2"]], "+", 
        FractionBox[
         RowBox[{"2", "*", "z", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "z"}], ")"}], "2"], 
          SuperscriptBox["mV", "4"]}], 
         SuperscriptBox[
          RowBox[{"H1", "[", 
           RowBox[{"z", ",", "pT", ",", "mp", ",", "mV"}], "]"}], "2"]]}], 
       ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     SubscriptBox["p", "T"], ",", 
     RowBox[{"z", " ", "\[Rule]", " ", 
      SubscriptBox["\[Theta]", "V"]}], ",", 
     SubscriptBox["E", "V"]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pTv", "[", 
      RowBox[{"EV_", ",", "\[Theta]_"}], "]"}], "=", 
     RowBox[{"EV", "*", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"zvp", "[", 
      RowBox[{"EV_", ",", "pBeam_"}], "]"}], "=", 
     FractionBox["EV", "pBeam"]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"JacobianpTzToEV\[Theta]", "[", 
      RowBox[{"EV_", ",", "pBeam_", ",", "\[Theta]_"}], "]"}], "=", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"pTv", "[", 
            RowBox[{"EV", ",", "\[Theta]"}], "]"}], ",", "EV"}], "]"}], "*", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"zvp", "[", 
            RowBox[{"EV", ",", "pBeam"}], "]"}], ",", "\[Theta]"}], "]"}]}], 
        "-", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"pTv", "[", 
            RowBox[{"EV", ",", "\[Theta]"}], "]"}], ",", "\[Theta]"}], "]"}], 
         "*", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"zvp", "[", 
            RowBox[{"EV", ",", "pBeam"}], "]"}], ",", "EV"}], "]"}]}]}], 
       ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Limitations", " ", "of", " ", "applicability", " ", "of", " ", "the", 
     " ", "approximation", " ", "used", " ", "to", " ", "derive", " ", "the", 
     " ", "bremsstrahlung", " ", "probability"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pTmaxBrem", "=", 
     RowBox[{
      RowBox[{"DialogInput", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"cut", "=", "\"\<\>\""}], "}"}], ",", 
        RowBox[{"Column", "[", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Enter the maximal \!\(\*SubscriptBox[\(p\), \(T\)]\) of dark \
photons (in GeV) for bremsstrahlung. Typical value is 1 GeV\>\"", ",", 
           RowBox[{"InputField", "[", 
            RowBox[{
             RowBox[{"Dynamic", "[", "cut", "]"}], ",", "Number"}], "]"}], 
           ",", 
           RowBox[{"Button", "[", 
            RowBox[{"\"\<Proceed\>\"", ",", 
             RowBox[{"DialogReturn", "[", "cut", "]"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "Automatic"}]}], "]"}]}], "}"}], 
         "]"}]}], "]"}], "//", "N"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Ppfacility", "[", "\"\<SPS\>\"", "]"}], ",", 
       RowBox[{"Ppfacility", "[", "\"\<LHC\>\"", "]"}], ",", 
       RowBox[{"Ppfacility", "[", "\"\<FCC-hh\>\"", "]"}], ",", 
       RowBox[{"Ppfacility", "[", "\"\<FermilabBD\>\"", "]"}]}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"400.", ",", "7000.", ",", "50000.", ",", "120."}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"zMinBrem", "[", "\"\<FermilabBD\>\"", "]"}], ",", 
       RowBox[{"zMinBrem", "[", "\"\<SPS\>\"", "]"}], ",", 
       RowBox[{"zMinBrem", "[", "\"\<LHC\>\"", "]"}], ",", 
       RowBox[{"zMinBrem", "[", "\"\<FCC-hh\>\"", "]"}]}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"0.1", ",", "0.1", ",", "0.005", ",", "0.0001"}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"zMaxBrem", "=", "0.9"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ApplicabilityParameter", "[", 
      RowBox[{"z_", ",", "pT_", ",", "mV_", ",", "Pp_", ",", "mX_"}], "]"}], 
     "=", 
     FractionBox[
      RowBox[{
       RowBox[{
        SuperscriptBox["mV", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"z", "-", "1"}], ")"}]}], ")"}]}], "+", 
       SuperscriptBox["pT", "2"], "+", 
       RowBox[{
        SuperscriptBox["mX", "2"], " ", 
        SuperscriptBox["z", "2"]}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"z", "-", "1"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["mV", "2"], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["Pp", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"z", "-", "1"}], ")"}], " ", "z"}]}], ")"}]}]]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DistrBrem\[Theta]EdarkPhotonNoFormFactorTemp", "[", 
      RowBox[{
      "mV_", ",", "\[Theta]V_", ",", "EV_", ",", "pBeam_", ",", "zmin_"}], 
      "]"}], "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"JacobianpTzToEV\[Theta]", "[", 
        RowBox[{"EV", ",", "pBeam", ",", "\[Theta]V"}], "]"}], "*", 
       RowBox[{"d2NdpTdz", "[", 
        RowBox[{"MP", ",", 
         RowBox[{"zvp", "[", 
          RowBox[{"EV", ",", "pBeam"}], "]"}], ",", 
         RowBox[{"pTv", "[", 
          RowBox[{"EV", ",", "\[Theta]V"}], "]"}], ",", "pBeam", ",", "mV", 
         ",", "1", ",", "\[Alpha]EM"}], "]"}], 
       RowBox[{"(*", 
        RowBox[{"*", 
         RowBox[{"UnitStep", "[", 
          RowBox[{"0.1", "-", 
           RowBox[{"ApplicabilityParameter", "[", 
            RowBox[{
             RowBox[{"zvp", "[", 
              RowBox[{"EV", ",", "pBeam"}], "]"}], ",", 
             RowBox[{"pTv", "[", 
              RowBox[{"EV", ",", "\[Theta]V"}], "]"}], ",", "mV", ",", 
             "pBeam", ",", "MP"}], "]"}]}], "]"}]}], "*)"}], "*", 
       RowBox[{"UnitStep", "[", 
        RowBox[{"EV", "-", 
         RowBox[{"zmin", "*", "pBeam"}]}], "]"}], "*", 
       RowBox[{"UnitStep", "[", 
        RowBox[{"pTmaxBrem", "-", 
         RowBox[{"pTv", "[", 
          RowBox[{"EV", ",", "\[Theta]V"}], "]"}]}], "]"}]}], ")"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mVminFromBrem", ",", "mVmaxFromBrem"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"0.02", ",", "4"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"EVmaxBremBeam", "[", 
      RowBox[{"Facility_", ",", "\[Theta]V_"}], "]"}], ":=", 
     RowBox[{"Min", "[", 
      RowBox[{
       RowBox[{"zMaxBrem", "*", 
        RowBox[{"Ppfacility", "[", "Facility", "]"}]}], ",", 
       FractionBox["pTmaxBrem", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"pTv", "[", 
           RowBox[{"1", ",", "\[Theta]V"}], "]"}], "]"}], "+", 
         SuperscriptBox["10", 
          RowBox[{"-", "7"}]]}]]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]maxBremTemp", "[", "Facility_", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Theta]V", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"zMinBrem", "[", "Facility", "]"}], "*", 
             RowBox[{"Ppfacility", "[", "Facility", "]"}]}], "\[Equal]", 
            FractionBox["pTmaxBrem", 
             RowBox[{"Sin", "[", "\[Theta]V", "]"}]]}], ",", "\[Theta]V"}], 
          "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         TemplateBox[{"1"},
          "C"], "\[Rule]", "0"}], "}"}]}], ")"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Theta]maxBremFacility", "[", "\"\<FermilabBD\>\"", "]"}], 
       ",", 
       RowBox[{"\[Theta]maxBremFacility", "[", "\"\<SPS\>\"", "]"}], ",", 
       RowBox[{"\[Theta]maxBremFacility", "[", "\"\<LHC\>\"", "]"}], ",", 
       RowBox[{"\[Theta]maxBremFacility", "[", "\"\<FCC-hh\>\"", "]"}]}], 
      "}"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Theta]maxBremTemp", "[", "#", "]"}], "&"}], "/@", 
      RowBox[{"{", 
       RowBox[{
       "\"\<FermilabBD\>\"", ",", "\"\<SPS\>\"", ",", "\"\<LHC\>\"", ",", 
        "\"\<FCC-hh\>\""}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NormalizationBremNoFormFactorTemp", "[", "Facility_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"zmin", ",", "EVmaxfrombrem"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pbeam", "=", 
        RowBox[{"Ppfacility", "[", "Facility", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"zmin", "=", 
        RowBox[{"zMinBrem", "[", "Facility", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"EVmaxfrombrem", "[", "\[Theta]V_", "]"}], "=", 
        RowBox[{"EVmaxBremBeam", "[", 
         RowBox[{"Facility", ",", "\[Theta]V"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Theta]maxbrem", "=", 
        RowBox[{"\[Theta]maxBremFacility", "[", "Facility", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"mV", ",", 
              RowBox[{"NIntegrate", "[", 
               RowBox[{
                RowBox[{"DistrBrem\[Theta]EdarkPhotonNoFormFactorTemp", "[", 
                 RowBox[{
                 "mV", ",", "\[Theta]V", ",", "EV", ",", "pbeam", ",", 
                  "zmin"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"\[Theta]V", ",", "0", ",", "\[Theta]maxbrem"}], 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"EV", ",", 
                  RowBox[{"zmin", "*", "pbeam"}], ",", 
                  RowBox[{"Max", "[", 
                   RowBox[{
                    RowBox[{"zmin", "*", "pbeam"}], ",", 
                    RowBox[{"EVmaxfrombrem", "[", "\[Theta]V", "]"}]}], 
                   "]"}]}], "}"}], ",", 
                RowBox[{"Method", "\[Rule]", "\"\<AdaptiveMonteCarlo\>\""}]}],
                "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"mV", ",", "mVminFromBrem", ",", "mVmaxFromBrem", ",", 
              FractionBox[
               RowBox[{"(", 
                RowBox[{"mVmaxFromBrem", "-", "mVminFromBrem"}], ")"}], 
               "20"]}], "}"}]}], "]"}], ",", 
          RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "mV", 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"NormalizationBremNoFormFactor", "[", 
         RowBox[{"mV_", ",", "Facility"}], "]"}], "=", 
        RowBox[{"NormalizationBremNoFormFactorTemp", "[", "Facility", "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DoubleDistrDPfromBremFacility", "[", 
         RowBox[{"mV_", ",", "\[Theta]V_", ",", "EV_", ",", "Facility"}], 
         "]"}], "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
          "mVminFromBrem", "\[LessEqual]", "mV", "\[LessEqual]", 
           "mVmaxFromBrem"}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            FractionBox["1", 
             RowBox[{"NormalizationBremNoFormFactor", "[", 
              RowBox[{"mV", ",", "Facility"}], "]"}]], "*", 
            RowBox[{"DistrBrem\[Theta]EdarkPhotonNoFormFactorTemp", "[", 
             RowBox[{"mV", ",", "\[Theta]V", ",", "EV", ",", 
              RowBox[{"Ppfacility", "[", "Facility", "]"}], ",", 
              RowBox[{"zMinBrem", "[", "Facility", "]"}]}], "]"}]}], "]"}], 
          ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"PbremFacility", "[", 
         RowBox[{"mV_", ",", "\[Epsilon]2_", ",", "Facility"}], "]"}], "=", 
        RowBox[{"\[Epsilon]2", "*", 
         SuperscriptBox[
          RowBox[{"Abs", "[", 
           RowBox[{"FormFactorBremDP", "[", "mV", "]"}], "]"}], "2"], "*", 
         RowBox[{"NormalizationBremNoFormFactor", "[", 
          RowBox[{"mV", ",", "Facility"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"EVmaxFromBrem", "[", 
         RowBox[{"mV_", ",", "\[Theta]V_", ",", "Facility"}], "]"}], "=", 
        RowBox[{"EVmaxBremBeam", "[", 
         RowBox[{"Facility", ",", "\[Theta]V"}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"Facility", ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<FermilabBD\>\"", ",", "\"\<SPS\>\"", ",", "\"\<LHC\>\"", ",", 
          "\"\<FCC-hh\>\""}], "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Tabulated", " ", "distribution", " ", "to", " ", "be", " ", "used", " ", 
     "in", " ", "next", " ", "sections"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TableBremDistr", "[", 
     RowBox[{"\[Theta]minExp_", ",", "\[Theta]maxExp_", ",", "Facility_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "eminbrem", ",", "\[Theta]Vlistbrem", ",", "EvlistBremTemp", ",", 
        "EvlistBrem"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eminbrem", "=", 
        RowBox[{
         RowBox[{"Ppfacility", "[", "Facility", "]"}], "*", 
         RowBox[{"zMinBrem", "[", "Facility", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Theta]Vlistbrem", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"\[Theta]V", ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]V", ",", 
            RowBox[{"0.99", "\[Theta]minExp"}], ",", 
            RowBox[{"1.01", "\[Theta]maxExp"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"1.01", "\[Theta]maxExp"}], "-", 
               RowBox[{"0.99", "\[Theta]minExp"}]}], ")"}], "/", "50"}]}], 
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"EvlistBremTemp", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"x", ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0.02", ",", "eminbrem", ",", "1"}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"10", "^", "x"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"Log10", "[", 
               RowBox[{"1.02", "*", "eminbrem"}], "]"}], ",", 
              RowBox[{"Log10", "[", 
               RowBox[{"Ppfacility", "[", "Facility", "]"}], "]"}], ",", 
              FractionBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Log10", "[", 
                  RowBox[{"Ppfacility", "[", "Facility", "]"}], "]"}], "-", 
                 RowBox[{"Log10", "[", 
                  RowBox[{"1.02", "*", "eminbrem"}], "]"}]}], ")"}], "50"]}], 
             "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"EvlistBrem", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"EvlistBremTemp", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"EVmaxBremBeam", "[", 
               RowBox[{"Facility", ",", "#"}], "]"}], "&"}], "/@", 
             "\[Theta]Vlistbrem"}]}], "]"}], "//", "Sort"}], "//", 
         "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"mV", ",", "\[Theta]V", ",", "EV", ",", 
             RowBox[{
              RowBox[{"DoubleDistrDPfromBremFacility", "[", 
               RowBox[{"mV", ",", "\[Theta]V", ",", "EV", ",", "Facility"}], 
               "]"}], "+", 
              SuperscriptBox["10", 
               RowBox[{"-", "90"}]]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"mV", ",", "mVminFromBrem", ",", 
             RowBox[{"mVmaxFromBrem", "//", "N"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"mVmaxFromBrem", "//", "N"}], ")"}], "-", 
                "mVminFromBrem"}], ")"}], "/", "10"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Theta]V", ",", "\[Theta]Vlistbrem"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"EV", ",", "EvlistBrem"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8867413870113516`*^9, 3.886741540701558*^9}, {
   3.8867416150085926`*^9, 3.8867416858917875`*^9}, {3.886741763910581*^9, 
   3.886741873463111*^9}, {3.8867431693622923`*^9, 3.88674317047512*^9}, {
   3.88675912650349*^9, 3.886759206087909*^9}, {3.8867597043528013`*^9, 
   3.886759755586966*^9}, {3.8867603578143253`*^9, 3.8867604196106296`*^9}, {
   3.886760617244815*^9, 3.886760865322702*^9}, {3.8867611750575757`*^9, 
   3.88676119071132*^9}, {3.886822306577469*^9, 3.886822316571784*^9}, {
   3.886832736983899*^9, 3.8868328526588106`*^9}, {3.8868376225654526`*^9, 
   3.8868376275089264`*^9}, {3.8868377047500257`*^9, 
   3.8868377500423417`*^9}, {3.8868391692356443`*^9, 
   3.8868391981720943`*^9}, {3.8921752130780435`*^9, 
   3.8921752473571453`*^9}, {3.892175350303725*^9, 3.892175351846941*^9}, {
   3.892175521630472*^9, 3.8921755238840203`*^9}, {3.8921756208211412`*^9, 
   3.892175674689103*^9}, {3.89217595151208*^9, 3.8921759832833643`*^9}, {
   3.8921761179182405`*^9, 3.8921761298085823`*^9}, {3.8921763172151895`*^9, 
   3.892176651308589*^9}, {3.8921768037891006`*^9, 3.8921769939727063`*^9}, {
   3.893471786674537*^9, 3.893471944190617*^9}, {3.8934719923316636`*^9, 
   3.893472120538704*^9}, {3.893472172040388*^9, 3.893472237278451*^9}, {
   3.8934724280610037`*^9, 3.8934724478702726`*^9}, {3.8934724906214085`*^9, 
   3.8934726100231547`*^9}, {3.8934726965780334`*^9, 3.893472719078771*^9}, 
   3.893472814711776*^9, {3.8934728976727943`*^9, 3.8934730876325455`*^9}, {
   3.8934731519633265`*^9, 3.893473184555513*^9}, 3.8934733383368425`*^9, {
   3.8934743664461913`*^9, 3.8934743955646086`*^9}, {3.89347444304001*^9, 
   3.893474491803772*^9}, {3.893520967114831*^9, 3.8935209671303005`*^9}, {
   3.8936004209704275`*^9, 3.893600421656349*^9}, {3.8936018530142164`*^9, 
   3.8936018531888504`*^9}, 3.8936019581529026`*^9, {3.893602164820368*^9, 
   3.8936021993678665`*^9}, {3.8936041500444*^9, 3.893604150255808*^9}, {
   3.8936049169399033`*^9, 3.893604967103578*^9}, {3.8939498042442403`*^9, 
   3.8939498280077534`*^9}},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->"In[44]:=",ExpressionUUID->"c1395d61-d1ed-44b4-bbe7-2f9e2a4dd415"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Via decays of mesons and mixing: br ratios and meson multiplicities \
\>", "Subsection",
 CellChangeTimes->{{3.8867412989661756`*^9, 3.8867413212030272`*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"4b291a99-120b-4b0b-a595-06d4e5a109b7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Br\[Pi]To\[Gamma]\[Gamma]", "=", "0.98799"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Br\[Eta]To\[Gamma]\[Gamma]", "=", "0.3931181"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Br\[Omega]To\[Pi]\[Gamma]", "=", "0.0834941"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Br\[Eta]prTo\[Gamma]\[Gamma]", "=", "0.0219297"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Br\[Pi]0ToV", "[", "mV_", "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"mV", "<", "m\[Pi]0"}], ",", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"2", "*", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           SuperscriptBox["mV", "2"], "/", 
           SuperscriptBox["m\[Pi]0", "2"]}]}], ")"}], "3"], "*", 
       "Br\[Pi]To\[Gamma]\[Gamma]"}], "]"}], ",", "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Br\[Eta]ToV", "[", "mV_", "]"}], "=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"mV", "<", "m\[Eta]"}], ",", 
      RowBox[{"Evaluate", "[", 
       RowBox[{"2", "*", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{
            SuperscriptBox["mV", "2"], "/", 
            SuperscriptBox["m\[Eta]", "2"]}]}], ")"}], "3"], "*", 
        "Br\[Eta]To\[Gamma]\[Gamma]"}], "]"}], ",", "0"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Br\[Omega]ToV", "[", "mV_", "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"mV", "<", 
        RowBox[{"m\[Omega]", "-", "m\[Pi]0"}]}], ",", 
       RowBox[{"Br\[Omega]To\[Pi]\[Gamma]", "*", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["m\[Omega]", "2"], "-", 
           SuperscriptBox["mV", "2"], "-", 
           SuperscriptBox["m\[Pi]0", "2"]}], ")"}], "2"], "*", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["m\[Omega]", "2"], "-", 
              SuperscriptBox["mV", "2"], "+", 
              SuperscriptBox["m\[Pi]0", "2"]}], ")"}], "2"], "-", 
           RowBox[{"4", "*", 
            SuperscriptBox["m\[Omega]", "2"], "*", 
            SuperscriptBox["m\[Pi]0", "2"]}]}], "]"}], "/", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["m\[Omega]", "2"], "-", 
            SuperscriptBox["mV", "2"]}], ")"}], "3"]}]}], ",", "0"}], "]"}]}],
     ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Br\[Eta]prToV", "[", "mV_", "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"mV", "<", "m\[Eta]pr"}], ",", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"2", "*", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           SuperscriptBox["mV", "2"], "/", 
           SuperscriptBox["m\[Eta]pr", "2"]}]}], ")"}], "3"], "*", 
       "Br\[Eta]prTo\[Gamma]\[Gamma]"}], "]"}], ",", "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BrDecay", "[", 
    RowBox[{"mV_", ",", "\[Epsilon]2_", ",", "meson_"}], "]"}], ":=", 
   RowBox[{"\[Epsilon]2", "*", 
    RowBox[{
     RowBox[{"Association", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "mV", ",", "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\""}], 
          "}"}], "\[Rule]", 
         RowBox[{"Br\[Pi]0ToV", "[", "mV", "]"}]}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"mV", ",", "\"\<\[Eta]\>\""}], "}"}], "\[Rule]", 
         RowBox[{"Br\[Eta]ToV", "[", "mV", "]"}]}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"mV", ",", "\"\<\[Eta]'\>\""}], "}"}], "\[Rule]", 
         RowBox[{"Br\[Eta]prToV", "[", "mV", "]"}]}]}], "}"}], "]"}], "[", 
     RowBox[{"{", 
      RowBox[{"mV", ",", "meson"}], "}"}], "]"}]}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Mixing", " ", "angle", " ", 
      SuperscriptBox["\[Rho]", "0"]}], "-", 
     RowBox[{
      RowBox[{"DP", ".", " ", "Following"}], " ", 
      RowBox[{"https", ":"}]}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{"arxiv", ".", "org"}], "/", "pdf"}], "/", 
     RowBox[{"1810.01879", ".", "pdf"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g\[Rho]0", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]DP\[Rho]02", "[", 
    RowBox[{"mV_", ",", "\[Epsilon]2_"}], "]"}], "=", 
   RowBox[{"\[Epsilon]2", "*", 
    FractionBox[
     RowBox[{"4", "Pi", "*", "\[Alpha]EM"}], 
     SuperscriptBox["g\[Rho]0", "2"]], 
    FractionBox[
     SuperscriptBox["m\[Rho]0", "4"], 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["mV", "2"], "-", 
         SuperscriptBox["m\[Rho]0", "2"]}], ")"}], "2"], "+", 
      RowBox[{
       SuperscriptBox["Gamma\[Rho]780", "2"], "*", 
       SuperscriptBox["M\[Rho]780", "2"]}]}]]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.886741324632948*^9, 3.88674133750587*^9}, {
   3.886743349704631*^9, 3.886743469951105*^9}, {3.8867435208363976`*^9, 
   3.886743559442109*^9}, {3.8867436030673923`*^9, 3.8867436380024014`*^9}, {
   3.886743677147029*^9, 3.886743791056388*^9}, {3.886759023397938*^9, 
   3.886759051632529*^9}, {3.886759084894906*^9, 3.886759102806116*^9}, {
   3.886759322833825*^9, 3.886759324091713*^9}, {3.8867597957163935`*^9, 
   3.886760018253701*^9}, {3.8867600560403585`*^9, 3.8867601972064524`*^9}, {
   3.8867608717265434`*^9, 3.886760928433196*^9}, {3.8902877382139034`*^9, 
   3.8902877885168395`*^9}, {3.890287908819491*^9, 3.8902879384574685`*^9}, 
   3.890287972630889*^9, {3.892180139844576*^9, 3.8921801533898745`*^9}, {
   3.895134860239647*^9, 3.8951348618856735`*^9}},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->"In[62]:=",ExpressionUUID->"fb6fcf97-f707-4a92-8ec2-ca831fac76d4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Drell-Yan", "Subsection",
 CellChangeTimes->{{3.886743986990315*^9, 3.8867439898240757`*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"dbb5e9a1-011b-4ae3-aff9-607e768d7cdb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Average", " ", "enhancement", " ", "LO", " ", "vs", " ", "LO"}], 
    "+", 
    RowBox[{
    "NLO", " ", "obtained", " ", "for", " ", "SPS", " ", "energies", " ", 
     "in", " ", "2011.05115"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"kfactorNLO", "=", "1.7"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]DrellYanData", "[", "file_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dat", "=", 
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"NotebookDirectory", "[", "]"}], ",", 
             "\"\<phenomenology/Dark photon/branching ratios\>\"", ",", 
             "file"}], "}"}], "]"}], ",", "\"\<Table\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"MinMaxMassesDrellYan", "=", 
        RowBox[{"MinMax", "[", 
         RowBox[{"dat", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"MinMaxMassesDrellYan", ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"MinMaxMassesDrellYan", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", " ", "mV", 
            "\[LessEqual]", 
            RowBox[{"MinMaxMassesDrellYan", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"10", "^", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Interpolation", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log10", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Log10", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "90"}]]}], "]"}]}], "}"}], "&"}], "/@", 
                  "dat"}], ",", 
                 RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
               RowBox[{"Log10", "[", "mV", "]"}], "]"}], ")"}]}], "]"}], ",", 
           "0"}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mDrellYanMinLHC", ",", "mDrellYanMaxLHC"}], "}"}], ",", 
       RowBox[{"\[Sigma]DrellYanpbLHCatLO", "[", "mV_", "]"}]}], "}"}], "=", 
     RowBox[{
     "\[Sigma]DrellYanData", "[", "\"\<sigma-Drell-Yan-DP-LHC.txt\>\"", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mDrellYanMinSPS", ",", "mDrellYanMaxSPS"}], "}"}], ",", 
       RowBox[{"\[Sigma]DrellYanpbSPSatLO", "[", "mV_", "]"}]}], "}"}], "=", 
     RowBox[{
     "\[Sigma]DrellYanData", "[", "\"\<sigma-Drell-Yan-DP-SPS.txt\>\"", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mDrellYanMinFermilabBD", ",", "mDrellYanMaxFermilabBD"}], 
        "}"}], ",", 
       RowBox[{"\[Sigma]DrellYanpbFermilabBDatLO", "[", "mV_", "]"}]}], "}"}],
      "=", 
     RowBox[{
     "\[Sigma]DrellYanData", "[", "\"\<sigma-Drell-Yan-DP-FermilabBD.txt\>\"",
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"PDrellYanFacility", "[", 
       RowBox[{
       "mV_", ",", "\[Epsilon]2_", ",", "Atarget_", ",", 
        "\"\<FermilabBD\>\""}], "]"}], ",", 
      RowBox[{"PDrellYanFacility", "[", 
       RowBox[{
       "mV_", ",", "\[Epsilon]2_", ",", "Atarget_", ",", "\"\<SPS\>\""}], 
       "]"}], ",", 
      RowBox[{"PDrellYanFacility", "[", 
       RowBox[{
       "mV_", ",", "\[Epsilon]2_", ",", "Atarget_", ",", "\"\<LHC\>\""}], 
       "]"}], ",", 
      RowBox[{"PDrellYanFacility", "[", 
       RowBox[{"mV_", ",", "\[Epsilon]2_", ",", "A_", ",", "\"\<FCC-hh\>\""}],
        "]"}]}], "}"}], "=", 
    RowBox[{"\[Epsilon]2", "*", 
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        RowBox[{"\[Sigma]DrellYanpbFermilabBDatLO", "[", "mV", "]"}], 
        RowBox[{"\[Sigma]pNucleonInpb", "[", "Atarget", "]"}]], ",", 
       RowBox[{"kfactorNLO", 
        FractionBox[
         RowBox[{"\[Sigma]DrellYanpbSPSatLO", "[", "mV", "]"}], 
         RowBox[{"\[Sigma]pNucleonInpb", "[", "Atarget", "]"}]]}], ",", 
       FractionBox[
        RowBox[{"\[Sigma]DrellYanpbLHCatLO", "[", "mV", "]"}], 
        "\[Sigma]ppLHC"], ",", "0"}], "}"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.8867439953320885`*^9, 3.8867443056738534`*^9}, {
  3.886744688505722*^9, 3.8867448017690363`*^9}, {3.8867602172841234`*^9, 
  3.8867602450458765`*^9}, {3.886760302636557*^9, 3.8867603337848253`*^9}, {
  3.8867605369307594`*^9, 3.8867606025869236`*^9}, {3.886760945508157*^9, 
  3.8867609651142406`*^9}, {3.8867611207481756`*^9, 3.886761162865342*^9}, {
  3.8868400708860817`*^9, 3.8868400727457695`*^9}, {3.8921793389157085`*^9, 
  3.892179366020566*^9}, {3.89349660534874*^9, 3.8934966761100206`*^9}, {
  3.893496755609863*^9, 3.8934968237352333`*^9}, {3.893496865517758*^9, 
  3.8934970127124376`*^9}, {3.8935209673073406`*^9, 3.8935209673163195`*^9}},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->"In[71]:=",ExpressionUUID->"ffe4bd1e-17f5-479f-b654-d839b1f344d7"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Compilable interpolation function mapping one grid into another\
\>", "Chapter",
 CellChangeTimes->{{3.891315426588935*^9, 3.891315432542842*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"0fddb25a-a632-4751-8775-41d96137bd6d"],

Cell[CellGroupData[{

Cell["3D to 3D", "Subsection",
 CellChangeTimes->{{3.8906627216475997`*^9, 3.8906627248020773`*^9}, {
  3.8907326559924955`*^9, 3.89073265766968*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"a880651e-1eca-4b4f-b7f3-77b0def9580f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nd", "=", "3"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"cf3", "=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"xgvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<xg\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"igvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<ig\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"tgvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<tg\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"ivars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<i\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"svars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<s\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"tvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<t\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"jvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<j\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}]}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Inactivate", "[", 
         RowBox[{
          RowBox[{"Compile", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"seq", "@", 
               RowBox[{"{", 
                RowBox[{"xgvars", ",", "_Real", ",", "1"}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", "_Real", ",", "nd"}], "}"}]}], "}"}], ",", 
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"seq", "@", "igvars"}], ",", 
                RowBox[{"seq", "@", "tgvars"}], ",", 
                RowBox[{"seq", "@", "ivars"}], ",", 
                RowBox[{"seq", "@", "svars"}], ",", 
                RowBox[{"seq", "@", "tvars"}]}], "}"}], ",", 
              RowBox[{
               RowBox[{"seq", "[", 
                RowBox[{"igvars", "=", 
                 RowBox[{
                  RowBox[{"Floor", "[", "xgvars", "]"}], "-", 
                  RowBox[{"UnitStep", "[", 
                   RowBox[{"xgvars", "-", 
                    RowBox[{"indexed", "@", 
                    RowBox[{"Dimensions", "@", "y"}]}]}], "]"}]}]}], "]"}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"seq", "[", 
                RowBox[{"tgvars", "=", 
                 RowBox[{"xgvars", "-", "igvars"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"seq", "[", 
                   RowBox[{"tvars", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"tgvars", ",", "jvars"}], "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"seq", "[", 
                   RowBox[{"ivars", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"igvars", ",", "jvars"}], "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"seq", "[", 
                   RowBox[{"svars", "=", 
                    RowBox[{"1.", "-", "tvars"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"eval", "@", 
                   RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Times", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], " ", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], "]"}]}], 
                    "&"}], "/@", 
                    RowBox[{"Tuples", "@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"svars", ",", "ivars"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"tvars", ",", 
                    RowBox[{"ivars", "+", "1"}]}], "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}]}]}], 
                    "]"}]}]}], ",", 
                 RowBox[{"seq", "@", 
                  RowBox[{"{", 
                   RowBox[{"jvars", ",", 
                    RowBox[{"Length", "@", "igvars"}]}], "}"}]}]}], "]"}]}]}],
              "]"}], ",", 
            RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
            RowBox[{"RuntimeAttributes", "\[Rule]", 
             RowBox[{"{", "Listable", "}"}]}], ",", 
            RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
            RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}], 
          ",", 
          RowBox[{"Except", "[", 
           RowBox[{"seq", "|", "eval", "|", "indexed"}], "]"}]}], "]"}], "/.", 
        RowBox[{
         RowBox[{"seq", "[", "expr_", "]"}], "\[RuleDelayed]", 
         RowBox[{"RuleCondition", "@", 
          RowBox[{"(", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Inactivate", "[", 
                RowBox[{"expr", ",", 
                 RowBox[{"Except", "[", 
                  RowBox[{"slist", "|", "indexed"}], "]"}]}], "]"}], "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"l_slist", "\[RuleDelayed]", 
                  RowBox[{"l", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"indexed", "[", "l_", "]"}], "\[RuleDelayed]", 
                  RowBox[{
                   RowBox[{"Inactive", "[", "Compile`GetElement", "]"}], "[", 
                   RowBox[{"l", ",", "i"}], "]"}]}]}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "nd"}], "}"}]}], "]"}]}], ")"}]}]}]}], "/.", 
       RowBox[{
        RowBox[{"eval", "@", "expr_"}], "\[RuleDelayed]", 
        RowBox[{"RuleCondition", "[", 
         RowBox[{"Activate", "[", 
          RowBox[{"expr", "/.", 
           RowBox[{"slist", "\[Rule]", "List"}]}], "]"}], "]"}]}]}]}], "]"}], 
    "//", "Activate"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.890711783488103*^9, 3.89071178348964*^9}, {
  3.8907121412539587`*^9, 3.8907121413711557`*^9}, {3.890712694841427*^9, 
  3.8907126950000925`*^9}, {3.890712790376151*^9, 3.8907128219919777`*^9}, {
  3.891018553068019*^9, 3.8910185548862777`*^9}},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->"In[77]:=",ExpressionUUID->"c206a552-6f39-4b30-8dc8-af7ceee53d27"]
}, Open  ]],

Cell[CellGroupData[{

Cell["4D to 4D", "Subsection",
 CellChangeTimes->{{3.8906627216475997`*^9, 3.8906627248020773`*^9}, {
  3.8907326559924955`*^9, 3.890732670187893*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"aaabee25-6353-4c34-9850-c513e840a7f9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nd", "=", "4"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"cf4", "=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"xgvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<xg\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"igvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<ig\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"tgvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<tg\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"ivars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<i\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"svars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<s\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"tvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<t\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"jvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<j\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}]}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Inactivate", "[", 
         RowBox[{
          RowBox[{"Compile", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"seq", "@", 
               RowBox[{"{", 
                RowBox[{"xgvars", ",", "_Real", ",", "1"}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", "_Real", ",", "nd"}], "}"}]}], "}"}], ",", 
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"seq", "@", "igvars"}], ",", 
                RowBox[{"seq", "@", "tgvars"}], ",", 
                RowBox[{"seq", "@", "ivars"}], ",", 
                RowBox[{"seq", "@", "svars"}], ",", 
                RowBox[{"seq", "@", "tvars"}]}], "}"}], ",", 
              RowBox[{
               RowBox[{"seq", "[", 
                RowBox[{"igvars", "=", 
                 RowBox[{
                  RowBox[{"Floor", "[", "xgvars", "]"}], "-", 
                  RowBox[{"UnitStep", "[", 
                   RowBox[{"xgvars", "-", 
                    RowBox[{"indexed", "@", 
                    RowBox[{"Dimensions", "@", "y"}]}]}], "]"}]}]}], "]"}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"seq", "[", 
                RowBox[{"tgvars", "=", 
                 RowBox[{"xgvars", "-", "igvars"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"seq", "[", 
                   RowBox[{"tvars", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"tgvars", ",", "jvars"}], "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"seq", "[", 
                   RowBox[{"ivars", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"igvars", ",", "jvars"}], "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"seq", "[", 
                   RowBox[{"svars", "=", 
                    RowBox[{"1.", "-", "tvars"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"eval", "@", 
                   RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Times", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], " ", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], "]"}]}], 
                    "&"}], "/@", 
                    RowBox[{"Tuples", "@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"svars", ",", "ivars"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"tvars", ",", 
                    RowBox[{"ivars", "+", "1"}]}], "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}]}]}], 
                    "]"}]}]}], ",", 
                 RowBox[{"seq", "@", 
                  RowBox[{"{", 
                   RowBox[{"jvars", ",", 
                    RowBox[{"Length", "@", "igvars"}]}], "}"}]}]}], "]"}]}]}],
              "]"}], ",", 
            RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
            RowBox[{"RuntimeAttributes", "\[Rule]", 
             RowBox[{"{", "Listable", "}"}]}], ",", 
            RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
            RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}], 
          ",", 
          RowBox[{"Except", "[", 
           RowBox[{"seq", "|", "eval", "|", "indexed"}], "]"}]}], "]"}], "/.", 
        RowBox[{
         RowBox[{"seq", "[", "expr_", "]"}], "\[RuleDelayed]", 
         RowBox[{"RuleCondition", "@", 
          RowBox[{"(", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Inactivate", "[", 
                RowBox[{"expr", ",", 
                 RowBox[{"Except", "[", 
                  RowBox[{"slist", "|", "indexed"}], "]"}]}], "]"}], "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"l_slist", "\[RuleDelayed]", 
                  RowBox[{"l", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"indexed", "[", "l_", "]"}], "\[RuleDelayed]", 
                  RowBox[{
                   RowBox[{"Inactive", "[", "Compile`GetElement", "]"}], "[", 
                   RowBox[{"l", ",", "i"}], "]"}]}]}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "nd"}], "}"}]}], "]"}]}], ")"}]}]}]}], "/.", 
       RowBox[{
        RowBox[{"eval", "@", "expr_"}], "\[RuleDelayed]", 
        RowBox[{"RuleCondition", "[", 
         RowBox[{"Activate", "[", 
          RowBox[{"expr", "/.", 
           RowBox[{"slist", "\[Rule]", "List"}]}], "]"}], "]"}]}]}]}], "]"}], 
    "//", "Activate"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8907148978688216`*^9, 3.890714898931299*^9}, {
  3.8910185630697727`*^9, 3.8910185650759544`*^9}},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->"In[79]:=",ExpressionUUID->"d62d583a-710d-4b99-ab03-5766ac554b05"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Specifying the experiment", "Title",
 CellChangeTimes->{{3.8876177939846563`*^9, 3.8876177965376587`*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"6bf41310-9786-4a2d-9c45-da72c297facc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Parent", " ", "directory"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NotebookDirectory", "[", "]"}], "//", "ParentDirectory"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AcceptanceDirectory", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Acceptances\>\""}], 
     "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExperimentDirectoriesList", "=", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"FileNames", "[", 
       RowBox[{"\"\<*\>\"", ",", "AcceptanceDirectory", ",", "1"}], "]"}], 
      ",", "DirectoryQ"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"List", " ", "of", " ", "available", " ", "experiments", " ", 
    RowBox[{"(", 
     RowBox[{
     "for", " ", "which", " ", "the", " ", "geometry", " ", "has", " ", 
      "been", " ", "implemented"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentsListTemp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"FileNameTake", "[", 
      RowBox[{
       RowBox[{"ExperimentDirectoriesList", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"-", "1"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "ExperimentDirectoriesList", "]"}], ",", "1"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentsListTemp2", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Partition", "[", 
      RowBox[{"ExperimentsListTemp", ",", "1"}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"TrueQ", "@", 
         RowBox[{"FileExistsQ", "@", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"NotebookDirectory", "[", "]"}], ",", 
             "\"\<Acceptances\>\"", ",", 
             RowBox[{"ExperimentsListTemp", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"ToString", "@", 
              RowBox[{"StringForm", "[", 
               RowBox[{"\"\<Acceptance_``_for_DP.m\>\"", ",", 
                RowBox[{"ExperimentsListTemp", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], "}"}], 
           "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "ExperimentsListTemp", "]"}]}], "}"}]}], 
      "]"}], ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ExperimentsList", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{"ExperimentsListTemp2", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "True"}], "&"}]}], "]"}],
     "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", 
   "Sort"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", "ExperimentsList", "]"}], "\[Equal]", "0"}], ",", 
   RowBox[{
   "Print", "[", 
    "\"\<No experiment is available, generate first the acceptance for the \
given experiment using module 1\>\"", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Selected experiments:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"selectionDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", 
      RowBox[{"{", "}"}]}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{
        "{", "\"\<Select the experiments for which the number of events will \
be computed:\>\"", "}"}], "]"}], ",", 
       RowBox[{"Pane", "[", 
        RowBox[{
         RowBox[{"TogglerBar", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list", ",", 
           RowBox[{"Appearance", "->", 
            RowBox[{"\"\<Vertical\>\"", "->", 
             RowBox[{"{", 
              RowBox[{"Automatic", ",", "5"}], "}"}]}]}]}], "]"}], ",", 
         RowBox[{"ImageSize", "->", 
          RowBox[{"{", 
           RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], ",", 
         RowBox[{"Scrollbars", "->", 
          RowBox[{"{", 
           RowBox[{"False", ",", "True"}], "}"}]}]}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"SelectedExperimentList", "=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "ExperimentsList", "]"}], "\[NotEqual]", "0"}], 
    ",", 
    RowBox[{"selectionDialog", "[", 
     RowBox[{"ExperimentsList", ",", "\"\<Select the experiments:\>\""}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"icounter", "=", "1"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8851403254718485`*^9, 3.8851403429411273`*^9}, {
   3.8854395484478483`*^9, 3.885439559226637*^9}, {3.8854397351242537`*^9, 
   3.885439739219259*^9}, {3.8858794196350574`*^9, 3.885879423032172*^9}, 
   3.886141121558817*^9, {3.886821665769628*^9, 3.8868216684602585`*^9}, {
   3.887617086304534*^9, 3.8876170990910044`*^9}, 3.889080211074895*^9, {
   3.890287800311657*^9, 3.890287802587648*^9}, {3.892189472726385*^9, 
   3.8921895121150846`*^9}, 3.892705546310735*^9, 3.8932345108531446`*^9, 
   3.902763528561518*^9, {3.902889537778877*^9, 3.9028895446827335`*^9}},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->"In[81]:=",ExpressionUUID->"14cf246a-dfe6-4f84-bced-6779a027f776"],

Cell[CellGroupData[{

Cell["Running block for next sections", "Chapter",
 CellChangeTimes->{{3.902729140157612*^9, 3.90272914444062*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"bf5cb1ca-586b-421c-9b8f-bcdda79a4c7d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BlockEvaluation", "[", "tag_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nb", "=", 
      RowBox[{"EvaluationNotebook", "[", "]"}]}], ";", "\n", 
     RowBox[{"NotebookFind", "[", 
      RowBox[{"nb", ",", "tag", ",", "All", ",", "CellTags"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"tagselected", "==", "\"\<Number-of-events\>\""}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
      "BlockEvaluation", "[", "\"\<Number-of-events-computation\>\"", "]"}], 
      ";"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"icounter", ",", "1", ",", 
       RowBox[{"Length", "[", "SelectedExperimentList", "]"}], ",", "1"}], 
      "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"tagselected", "==", "\"\<Acceptance\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
        "BlockEvaluation", "[", "\"\<Acceptance-computation\>\"", "]"}], 
        ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"icounter", ",", "1", ",", 
         RowBox[{"Length", "[", "SelectedExperimentList", "]"}], ",", "1"}], 
        "}"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.9027291581950865`*^9, 3.902729215695462*^9}, {
   3.902761777481885*^9, 3.902761802513644*^9}, 3.902889536609843*^9, 
   3.9038925480063467`*^9},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->"In[94]:=",ExpressionUUID->"8ccbe0c0-5799-4a13-b89d-58d5d3aa1550"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Number of events", "Title",
 CellChangeTimes->{{3.885140281753849*^9, 3.8851402836781845`*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"ec7d1ed4-b833-4ca9-b86b-\
68ef0bdfdc5e"],

Cell[CellGroupData[{

Cell["Cross-sections, acceptances", "Chapter",
 CellChangeTimes->{{3.885020695565913*^9, 3.885020698644303*^9}, 
   3.887617827187765*^9, {3.89463726983397*^9, 3.894637273109426*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"ddc91657-c605-432a-9fc4-\
3dde27689d78"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SelectedExperiment", "=", 
   RowBox[{"SelectedExperimentList", "[", 
    RowBox[{"[", 
     RowBox[{"icounter", "++"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dataAcceptances", "=", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<Acceptances\>\"", ",", "SelectedExperiment", ",", 
           RowBox[{"ToString", "@", 
            RowBox[{"StringForm", "[", 
             RowBox[{
             "\"\<Acceptance_``_for_DP.m\>\"", ",", "SelectedExperiment"}], 
             "]"}]}]}], "}"}], "]"}], "}"}], "]"}], ",", "\"\<MX\>\""}], 
     "]"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FacilityGivenExperiment", "=", 
   RowBox[{"dataAcceptances", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ECALoption", "=", 
   RowBox[{"dataAcceptances", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullAcceptanceData0", "=", 
   RowBox[{"dataAcceptances", "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BrVisTemp", "[", "mFIP_", "]"}], "=", 
   RowBox[{"dataAcceptances", "[", 
    RowBox[{"[", "5", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlistBr", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"Table", "[", 
     RowBox[{"m", ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0.02", ",", "5.1", ",", "0.005"}], "}"}]}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BrVis", "[", "mFIP_", "]"}], "=", 
    RowBox[{
     RowBox[{"Interpolation", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"mFIP", ",", 
           RowBox[{"BrVisTemp", "[", "mFIP", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"mFIP", ",", "mlistBr"}], "}"}]}], "]"}], ",", 
       RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", "mFIP", 
     "]"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{"LogLogPlot", "[", 
  RowBox[{
   RowBox[{"BrVis", "[", "mFIP", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"mFIP", ",", "0.02", ",", "10"}], "}"}], ",", 
   RowBox[{"Frame", "->", "True"}], ",", 
   RowBox[{"ImageSize", "->", "Large"}], ",", 
   RowBox[{"FrameStyle", "\[Rule]", 
    RowBox[{"Directive", "[", 
     RowBox[{"Black", ",", " ", "22"}], "]"}]}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Blue"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
        RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
        RowBox[{"Darker", "@", 
         RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Black"}], "}"}]}], 
     "}"}]}], ",", 
   RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"MinMax", "[", "mlistBr", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.01", ",", "1.2"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<m [GeV]\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(Br\), \(vis\)]\)\>\""}], "}"}]}], ",", 
   RowBox[{"PlotLabel", "\[Rule]", " ", 
    RowBox[{"Style", "[", 
     RowBox[{
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<For \>\"", ",", "SelectedExperiment"}], "}"}], "]"}], 
      ",", " ", "20", ",", " ", "Black"}], "]"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Theta]minExpAll", ",", "\[Theta]maxExpAll"}], "}"}], "=", 
   RowBox[{"MinMax", "[", 
    RowBox[{"FullAcceptanceData0", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Theta]minExp", ",", "\[Theta]maxExp"}], "}"}], "=", 
   RowBox[{"MinMax", "[", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"FullAcceptanceData0", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "6", "]"}], "]"}], "\[NotEqual]", "0"}], "&"}]}], 
      "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"zminExp", ",", "zmaxExp"}], "}"}], "=", 
   RowBox[{"MinMax", "[", 
    RowBox[{"FullAcceptanceData0", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AzimuthalAcceptanceData", "=", 
    RowBox[{
     RowBox[{"DeleteDuplicatesBy", "[", 
      RowBox[{"FullAcceptanceData0", ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "&"}]}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "4", ",", "5"}], "}"}]}], "]"}], "]"}]}], ";"}], "//",
   "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]Grid", "=", 
   RowBox[{"DeleteDuplicates", "[", 
    RowBox[{"AzimuthalAcceptanceData", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zminmax\[Theta]data", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"MinMax", "[", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"AzimuthalAcceptanceData", ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "==", 
            RowBox[{"\[Theta]Grid", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "&&", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "\[NotEqual]", "0"}]}], "&"}]}], 
        "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "\[Theta]Grid", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zmin\[Theta]", "[", "\[Theta]V_", "]"}], "=", 
   RowBox[{
    RowBox[{"Interpolation", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{"\[Theta]Grid", ",", "1"}], "]"}], ",", 
        RowBox[{"zminmax\[Theta]data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", "1", "}"}]}], "]"}], "]"}], ",", "2"}], "]"}], ",", 
      RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
    "\[Theta]V", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zmax\[Theta]", "[", "\[Theta]V_", "]"}], "=", 
   RowBox[{
    RowBox[{"Interpolation", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{"\[Theta]Grid", ",", "1"}], "]"}], ",", 
        RowBox[{"zminmax\[Theta]data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}], "]"}], ",", "2"}], "]"}], ",", 
      RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
    "\[Theta]V", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AzimuthalAcceptanceDP", "[", 
    RowBox[{"\[Theta]V_", ",", "zV_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Interpolation", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}], "/@", 
       "AzimuthalAcceptanceData"}], ",", 
      RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
    RowBox[{"\[Theta]V", ",", "zV"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DecAccDataLogarithmizedComp", "=", 
   RowBox[{
    RowBox[{"Hold", "@", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"FullAcceptanceData", ",", "_Real", ",", "2"}], "}"}], "}"}],
        ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Log10", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
           RowBox[{"Log10", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
           RowBox[{"Log10", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
           RowBox[{"Log10", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "]"}], ",", 
           RowBox[{"Log10", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "6", "]"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
        "FullAcceptanceData"}]}], "]"}]}], "//", "ReleaseHold"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"DecayAcceptanceDP", "[", 
      RowBox[{"mV_", ",", "\[Theta]V_", ",", "EV_", ",", "zV_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"BrVis", "[", "mV", "]"}], "*", 
      RowBox[{"10", "^", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{
           RowBox[{
           "DecAccDataLogarithmizedComp", "[", "FullAcceptanceData0", "]"}], 
           ",", 
           RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
         RowBox[{
          RowBox[{"Log10", "[", "mV", "]"}], ",", 
          RowBox[{"Log10", "[", "\[Theta]V", "]"}], ",", 
          RowBox[{"Log10", "[", "EV", "]"}], ",", 
          RowBox[{"Log10", "[", "zV", "]"}]}], "]"}], ")"}]}]}]}], ";"}], "//",
    "AbsoluteTiming"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Interpolation", " ", "for", " ", "the", " ", "full", " ", "acceptance"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"acccomp", "=", 
    RowBox[{
     RowBox[{"Hold", "@", 
      RowBox[{"Compile", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"data", ",", "_Real", ",", "2"}], "}"}], "}"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Log10", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
            RowBox[{"Log10", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
            RowBox[{"Log10", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
            RowBox[{"Log10", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "4", "]"}], "]"}], "]"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "5", "]"}], "]"}], "*", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "6", "]"}], "]"}]}], "\[Equal]", "0"}], ",", 
              RowBox[{"-", "90"}], ",", 
              RowBox[{"Log10", "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "5", "]"}], "]"}], "*", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "6", "]"}], "]"}]}], "]"}]}], "]"}]}], "}"}], 
          "&"}], "/@", 
         RowBox[{"SortBy", "[", 
          RowBox[{"data", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "&"}]}], "]"}]}]}], 
       "]"}]}], "//", "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Interpolation", " ", "for", " ", "the", " ", "full", " ", "acceptance"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FullAcceptanceData", "=", 
    RowBox[{"acccomp", "[", "FullAcceptanceData0", "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FullAcceptanceDP", "[", 
     RowBox[{"mV_", ",", "\[Theta]V_", ",", "EV_", ",", "zV_"}], "]"}], "=", 
    RowBox[{"10", "^", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Interpolation", "[", 
        RowBox[{"FullAcceptanceData", ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
       RowBox[{
        RowBox[{"Log10", "[", "mV", "]"}], ",", 
        RowBox[{"Log10", "[", "\[Theta]V", "]"}], ",", 
        RowBox[{"Log10", "[", "EV", "]"}], ",", 
        RowBox[{"Log10", "[", "zV", "]"}]}], "]"}], ")"}]}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CrossSectionsData", "=", 
   RowBox[{
    RowBox[{"dataAcceptances", "[", 
     RowBox[{"[", "4", "]"}], "]"}], "//", "Transpose"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NpotGivenExperiment", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"CrossSectionsData", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<Npot\>\""}], 
        "&"}]}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "\[Chi]Xprod", "[", "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", 
    "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"CrossSectionsData", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<PPi0\>\""}], 
        "&"}]}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Chi]Xprod", "[", "\"\<\[Eta]\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"CrossSectionsData", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<PEta\>\""}], 
        "&"}]}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Chi]Xprod", "[", "\"\<\[Eta]'\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"CrossSectionsData", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<PEtapr\>\""}], 
        "&"}]}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "\[Chi]Xprod", "[", "\"\<\!\(\*SuperscriptBox[\(\[Rho]\), \(0\)]\)\>\"", 
    "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"CrossSectionsData", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<PRho0\>\""}], 
        "&"}]}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AtargetVal", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"CrossSectionsData", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<Atarget\>\""}], 
         "&"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"infoDialog", "[", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{
      "\"\<The number of proton collisions is \>\"", ",", " ", 
       "NpotGivenExperiment", ",", 
       "\"\<. You may change it at the stage of computing the sensitivities\>\
\""}], "}"}], "]"}], "]"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{
   "\"\<Search for dark photons at \>\"", ",", " ", "SelectedExperiment", ",",
     " ", "\"\< located at \>\"", ",", "FacilityGivenExperiment", ",", 
    "\"\<. \!\(\*SubscriptBox[\(N\), \(collisions\)]\) = \>\"", ",", 
    "NpotGivenExperiment"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\"\<Quantity\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(min\)]\), rad\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(max\)]\), rad\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(min\)]\)(\!\(\*SubscriptBox[\(\
\[Epsilon]\), \(dec\)]\)), rad\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(max\)]\)(\!\(\*SubscriptBox[\(\
\[Epsilon]\), \(dec\)]\)), rad\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(z\), \(min\)]\), m\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(z\), \(max\)]\), m\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Description\>\"", ",", "\"\<Min angle covered by experiment\>\"", 
      ",", "\"\<Max angle covered by experiment\>\"", ",", 
      "\"\<Min angle where \!\(\*SubscriptBox[\(\[Epsilon]\), \(decay\)]\)\
\[NotEqual]0\>\"", ",", 
      "\"\<Max angle where \!\(\*SubscriptBox[\(\[Epsilon]\), \(decay\)]\)\
\[NotEqual]0\>\"", ",", "\"\<Min long. displacement of the decay volume\>\"", 
      ",", "\"\<Max long. displacement of the decay volume\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Value\>\"", ",", "\[Theta]minExpAll", ",", "\[Theta]maxExpAll", ",",
       "\[Theta]minExp", ",", "\[Theta]maxExp", ",", "zminExp", ",", 
      "zmaxExp"}], "}"}]}], "}"}], "//", "TableForm"}]}], "Input",
 CellChangeTimes->{{3.8921748442124033`*^9, 3.892174924863473*^9}, {
   3.892888493615114*^9, 3.892888495922745*^9}, {3.894178999539856*^9, 
   3.8941789997847443`*^9}, 3.894382708283858*^9, {3.8946372752697067`*^9, 
   3.8946372755375957`*^9}, 3.894781717122591*^9, {3.895053884461896*^9, 
   3.895053887613945*^9}, {3.899198252634884*^9, 3.89919827008097*^9}, {
   3.899215227082757*^9, 3.899215228721673*^9}, {3.9027635076975436`*^9, 
   3.902763508122694*^9}, {3.902763783256745*^9, 3.902763785618586*^9}, {
   3.9048896890123234`*^9, 3.9048896904995394`*^9}, {3.9049007877418613`*^9, 
   3.9049008009407682`*^9}, {3.9049010126152215`*^9, 3.904901012646469*^9}, 
   3.9049018234921083`*^9},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->"In[96]:=",ExpressionUUID->"c815bc21-895a-435e-aff8-c368c51a223c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Angle-energy distributions and differential yields  for the given experiment\
\>", "Chapter",
 CellChangeTimes->{{3.885020702966837*^9, 3.885020711525731*^9}, {
   3.8850216924759345`*^9, 3.8850216984444695`*^9}, {3.8851404110391607`*^9, 
   3.8851404117847*^9}, 3.8859669420079484`*^9, {3.887617811213402*^9, 
   3.88761781429661*^9}, {3.896334961873438*^9, 3.8963349667311535`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"2ed58b5e-8fa1-4a99-b81c-\
130884bcdd21"],

Cell[CellGroupData[{

Cell["DP distributions", "Section",
 CellChangeTimes->{{3.8850207275443482`*^9, 3.885020730624566*^9}, 
   3.8850217020674453`*^9, {3.8851404135605536`*^9, 3.8851404142703238`*^9}, 
   3.885966942012986*^9, 3.8868216621554785`*^9},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"55cf97a8-2660-4bce-8ec9-\
801bafbdf76d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Check", " ", "if", " ", "all", " ", "distributions", " ", "generated", 
    " ", "by", " ", "Module", " ", "2", " ", "are", " ", "present"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"DPDistributionFileNames", ":=", 
    RowBox[{"Association", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<DoubleDistr-DP-from-rho0-FermilabBD.dat\>\"", ",", 
          "\"\<DoubleDistr-DPs-From-Eta-FermilabBD.dat\>\"", ",", 
          "\"\<DoubleDistr-DPs-From-Etapr-FermilabBD.dat\>\"", ",", 
          "\"\<DoubleDistr-DPs-From-pi0-FermilabBD.dat\>\""}], "}"}]}], ",", 
       RowBox[{"\"\<LHC\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<DoubleDistr-DP-from-rho0-LHC.dat\>\"", ",", 
          "\"\<DoubleDistr-DPs-From-Eta-LHC.dat\>\"", ",", 
          "\"\<DoubleDistr-DPs-From-Etapr-LHC.dat\>\"", ",", 
          "\"\<DoubleDistr-DPs-From-pi0-LHC.dat\>\""}], "}"}]}], ",", 
       RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<DoubleDistr-DP-from-rho0-FCC-hh.dat\>\"", ",", 
          "\"\<DoubleDistr-DPs-From-Eta-FCC-hh.dat\>\"", ",", 
          "\"\<DoubleDistr-DPs-From-Etapr-FCC-hh.dat\>\"", ",", 
          "\"\<DoubleDistr-DPs-From-pi0-FCC-hh.dat\>\""}], "}"}]}], ",", 
       RowBox[{"\"\<SPS\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<DoubleDistr-DP-from-rho0-SPS.dat\>\"", ",", 
          "\"\<DoubleDistr-DPs-From-Eta-SPS.dat\>\"", ",", 
          "\"\<DoubleDistr-DPs-From-Etapr-SPS.dat\>\"", ",", 
          "\"\<DoubleDistr-DPs-From-pi0-SPS.dat\>\""}], "}"}]}]}], "}"}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DPDistributionFileNamesGivenExp", "=", 
     RowBox[{
     "DPDistributionFileNames", "[", "FacilityGivenExperiment", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"TrueQ", "@", 
         RowBox[{"FileExistsQ", "@", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"NotebookDirectory", "[", "]"}], ",", 
             "\"\<spectra/New physics particles spectra/Dark photons/\>\"", 
             ",", 
             RowBox[{"DPDistributionFileNamesGivenExp", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], "}"}], "]"}]}]}]}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
         RowBox[{"DPDistributionFileNamesGivenExp", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ",", 
         "\"\< does not exist Generate it using module 2!\>\""}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", "DPDistributionFileNamesGivenExp", "]"}], ",", 
       "1"}], "}"}]}], "]"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{
  3.88502354836834*^9, {3.8850295938036337`*^9, 3.885029595916194*^9}, {
   3.8851404366578946`*^9, 3.8851404845456142`*^9}, {3.885438338435359*^9, 
   3.8854384585798616`*^9}, 3.8855484092677927`*^9, {3.8859669420224924`*^9, 
   3.885966942043624*^9}, {3.885967092081048*^9, 3.8859671770851784`*^9}, {
   3.886761322142398*^9, 3.8867613222054567`*^9}, {3.8867613568657713`*^9, 
   3.8867614253781595`*^9}, {3.886761460228565*^9, 3.886761478517923*^9}, {
   3.886821662166826*^9, 3.886821662171852*^9}, {3.887617836095932*^9, 
   3.887617844975481*^9}, {3.8922841186539793`*^9, 3.8922841611745014`*^9}, {
   3.8922842075951023`*^9, 3.8922842229448953`*^9}, {3.893520967515341*^9, 
   3.893520967523321*^9}, {3.894119501216527*^9, 3.894119518573574*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[137]:=",ExpressionUUID->"af91a4df-a2ec-4b76-bfe7-3122355d5590"],

Cell[CellGroupData[{

Cell["Importing distributions", "Subsection",
 CellChangeTimes->{{3.885021707174692*^9, 3.8850217096287813`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"3b43ff78-6b27-4d93-8d69-\
7457f7f8823d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Relevant", " ", "production", " ", "channels"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ProductionList", "=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\"\<\!\(\*SuperscriptBox[\(\[Rho]\), \(0\)]\)\>\"", ",", 
        "\"\<\[Eta]\>\"", ",", "\"\<\[Eta]'\>\"", ",", 
        "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\""}], "}"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FacilityGivenExperiment", "\[NotEqual]", "\"\<FCC-hh\>\""}], 
        ",", 
        RowBox[{"{", "\"\<Drell-Yan\>\"", "}"}], ",", 
        RowBox[{"{", "}"}]}], "]"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"\[Theta]minExp", "<", 
         RowBox[{
         "\[Theta]maxBremFacility", "[", "FacilityGivenExperiment", "]"}]}], 
        ",", 
        RowBox[{"{", "\"\<Brem\>\"", "}"}], ",", 
        RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"ListExport", ":=", 
    RowBox[{"Association", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "\"\<\!\(\*SuperscriptBox[\(\[Rho]\), \(0\)]\)\>\"", "->", 
        "\"\<Rho0\>\""}], ",", 
       RowBox[{"\"\<\[Eta]\>\"", "->", "\"\<Eta\>\""}], ",", 
       RowBox[{"\"\<\[Eta]'\>\"", "->", "\"\<Etapr\>\""}], ",", 
       RowBox[{
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", "->", 
        "\"\<Pi0\>\""}], ",", 
       RowBox[{"\"\<Drell-Yan\>\"", "->", "\"\<DrellYan\>\""}], ",", 
       RowBox[{"\"\<Brem\>\"", "->", "\"\<Brem\>\""}]}], "}"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DoubleDistrDPfromBremDat", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"\[Theta]minExp", "<", 
        RowBox[{
        "\[Theta]maxBremFacility", "[", "FacilityGivenExperiment", "]"}]}], 
       ",", 
       RowBox[{"TableBremDistr", "[", 
        RowBox[{
        "\[Theta]minExp", ",", "\[Theta]maxExp", ",", 
         "FacilityGivenExperiment"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dataDistr", "[", "filename_", "]"}], ":=", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], ",", 
         "\"\<spectra/New physics particles spectra/Dark photons/\>\"", ",", 
         "filename"}], "}"}], "]"}], ",", "\"\<Table\>\""}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "DataDistrDP", "[", 
        "\"\<\!\(\*SuperscriptBox[\(\[Rho]\), \(0\)]\)\>\"", "]"}], ",", 
       RowBox[{"DataDistrDP", "[", "\"\<\[Eta]\>\"", "]"}], ",", 
       RowBox[{"DataDistrDP", "[", "\"\<\[Eta]'\>\"", "]"}], ",", 
       RowBox[{
       "DataDistrDP", "[", "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"",
         "]"}], ",", 
       RowBox[{"DataDistrDP", "[", "\"\<Drell-Yan\>\"", "]"}], ",", 
       RowBox[{"DataDistrDP", "[", "\"\<Brem\>\"", "]"}]}], "}"}], "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"dataDistr", "[", 
          RowBox[{"DPDistributionFileNamesGivenExp", "[", 
           RowBox[{"[", "#", "]"}], "]"}], "]"}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
           "FacilityGivenExperiment", "\[NotEqual]", "\"\<FCC-hh\>\""}], ",", 
           RowBox[{"Import", "[", 
            RowBox[{
             RowBox[{"FileNameJoin", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"NotebookDirectory", "[", "]"}], ",", 
                "\"\<spectra/New physics particles spectra/Dark \
photons/Pregenerated/\>\"", ",", 
                RowBox[{"ToString", "@", 
                 RowBox[{"StringForm", "[", 
                  RowBox[{
                  "\"\<DoubleDistrDarkPhotonsDrellYan-``.txt\>\"", ",", 
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"{", "FacilityGivenExperiment", "}"}]}]}], 
                  "]"}]}]}], "}"}], "]"}], ",", "\"\<Table\>\""}], "]"}]}], 
          "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"\[Theta]minExp", "<", 
            RowBox[{
            "\[Theta]maxBremFacility", "[", "FacilityGivenExperiment", 
             "]"}]}], ",", "DoubleDistrDPfromBremDat"}], "]"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Probability", " ", "to", " ", "produce", " ", "the", " ", "DP", " ", 
     "per", " ", "PoT", " ", "at", " ", "the", " ", "given", " ", 
     "facility"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Chi]Xtimes\[Chi]XtoDPall", "[", 
        RowBox[{
        "mV_", ",", "\[Epsilon]2_", ",", 
         "\"\<\!\(\*SuperscriptBox[\(\[Rho]\), \(0\)]\)\>\""}], "]"}], ",", 
       RowBox[{"\[Chi]Xtimes\[Chi]XtoDPall", "[", 
        RowBox[{"mV_", ",", "\[Epsilon]2_", ",", "\"\<\[Eta]\>\""}], "]"}], 
       ",", 
       RowBox[{"\[Chi]Xtimes\[Chi]XtoDPall", "[", 
        RowBox[{"mV_", ",", "\[Epsilon]2_", ",", "\"\<\[Eta]'\>\""}], "]"}], 
       ",", 
       RowBox[{"\[Chi]Xtimes\[Chi]XtoDPall", "[", 
        RowBox[{
        "mV_", ",", "\[Epsilon]2_", ",", 
         "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\""}], "]"}], ",", 
       RowBox[{"\[Chi]Xtimes\[Chi]XtoDPall", "[", 
        RowBox[{"mV_", ",", "\[Epsilon]2_", ",", "\"\<Drell-Yan\>\""}], "]"}],
        ",", 
       RowBox[{"\[Chi]Xtimes\[Chi]XtoDPall", "[", 
        RowBox[{"mV_", ",", "\[Epsilon]2_", ",", "\"\<Brem\>\""}], "]"}]}], 
      "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
        "\[Chi]Xprod", "[", 
         "\"\<\!\(\*SuperscriptBox[\(\[Rho]\), \(0\)]\)\>\"", "]"}], "*", 
        RowBox[{"\[Theta]DP\[Rho]02", "[", 
         RowBox[{"mV", ",", "\[Epsilon]2"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"\[Chi]Xprod", "[", "\"\<\[Eta]\>\"", "]"}], "*", 
        RowBox[{"BrDecay", "[", 
         RowBox[{"mV", ",", "\[Epsilon]2", ",", "\"\<\[Eta]\>\""}], "]"}]}], 
       ",", 
       RowBox[{
        RowBox[{"\[Chi]Xprod", "[", "\"\<\[Eta]'\>\"", "]"}], "*", 
        RowBox[{"BrDecay", "[", 
         RowBox[{"mV", ",", "\[Epsilon]2", ",", "\"\<\[Eta]'\>\""}], "]"}]}], 
       ",", 
       RowBox[{
        RowBox[{
        "\[Chi]Xprod", "[", 
         "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", "]"}], "*", 
        RowBox[{"BrDecay", "[", 
         RowBox[{
         "mV", ",", "\[Epsilon]2", ",", 
          "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\""}], "]"}]}], ",", 
       RowBox[{"PDrellYanFacility", "[", 
        RowBox[{
        "mV", ",", "\[Epsilon]2", ",", "AtargetVal", ",", 
         "FacilityGivenExperiment"}], "]"}], ",", 
       RowBox[{"PbremFacility", "[", 
        RowBox[{"mV", ",", "\[Epsilon]2", ",", "FacilityGivenExperiment"}], 
        "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Probability", " ", "to", " ", "produce", " ", "the", " ", "DP", " ", 
      "per", " ", "PoT"}], " ", "-", " ", 
     RowBox[{
     "only", " ", "the", " ", "relevant", " ", "production", " ", 
      "channels"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Chi]Xtimes\[Chi]XtoDP", "[", 
        RowBox[{"mV_", ",", "\[Epsilon]2_", ",", "prod"}], "]"}], "=", 
       RowBox[{"\[Chi]Xtimes\[Chi]XtoDPall", "[", 
        RowBox[{"mV", ",", "\[Epsilon]2", ",", "prod"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mlistDP", "[", "prod", "]"}], "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{
         RowBox[{"DataDistrDP", "[", "prod", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"mDPmin", "[", "prod", "]"}], ",", 
         RowBox[{"mDPmax", "[", "prod", "]"}]}], "}"}], "=", 
       RowBox[{"MinMax", "[", 
        RowBox[{"mlistDP", "[", "prod", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DoubleDistrDP", "[", 
        RowBox[{"mV_", ",", "\[Theta]V_", ",", "EV_", ",", "prod"}], "]"}], 
       "=", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Interpolation", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Log10", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                RowBox[{"Log10", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                RowBox[{"Log10", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
                RowBox[{"Log10", "[", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "4", "]"}], "]"}], "+", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "80"}]]}], "]"}]}], "}"}], "&"}], "/@", 
             RowBox[{"DataDistrDP", "[", "prod", "]"}]}], ",", 
            RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
          RowBox[{
           RowBox[{"Log10", "[", "mV", "]"}], ",", 
           RowBox[{"Log10", "[", "\[Theta]V", "]"}], ",", 
           RowBox[{"Log10", "[", "EV", "]"}]}], "]"}], ")"}]}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"LogLogPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"\[Chi]Xtimes\[Chi]XtoDP", "[", 
         RowBox[{"mV", ",", "1", ",", "prod"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"mV", ",", "0.05", ",", "3"}], "}"}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.05", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox["10", 
           RowBox[{"-", "5"}]], ",", "50"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"Placed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"#", ",", "15"}], "]"}], "&"}], "/@", "ProductionList"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"0.88", ",", "0.76"}], "}"}]}], "]"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(m\), \(V\)]\) [GeV]\>\"", ",", 
        "\"\<\!\(\*SubscriptBox[\(P\), \(pp -> V\)]\)/\!\(\*SuperscriptBox[\(\
\[Epsilon]\), \(2\)]\)\>\""}], "}"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", " ", "22"}], "]"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", " ", 
      RowBox[{"Style", "[", 
       RowBox[{"\"\<BC1\>\"", ",", " ", "20", ",", " ", "Black"}], "]"}]}], 
     ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Thickness", "[", "0.0045", "]"}], ",", "Blue"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Thickness", "[", "0.0045", "]"}], ",", 
          RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Thickness", "[", "0.0045", "]"}], ",", 
          RowBox[{"Darker", "@", 
           RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Thickness", "[", "0.0045", "]"}], ",", 
          RowBox[{"Darker", "@", "Cyan"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Thickness", "[", "0.0045", "]"}], ",", "Magenta"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Thickness", "[", "0.0045", "]"}], ",", "Black"}], "}"}]}], 
       "}"}]}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<Auxiliary data/Dark photons\>\"", ",", "SelectedExperiment", 
        ",", "\"\<Double-Distr-Averaged-DP.m\>\""}], "}"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"mDPmin", "[", "prod", "]"}], "<", "mV", "<", 
            RowBox[{"mDPmax", "[", "prod", "]"}]}], ",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"\[Chi]Xtimes\[Chi]XtoDP", "[", 
             RowBox[{"mV", ",", "1", ",", "prod"}], "]"}], "]"}], ",", "0"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ",", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"mDPmin", "[", "prod", "]"}], "<", "mV", "<", 
              RowBox[{"mDPmax", "[", "prod", "]"}]}], ",", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"\[Chi]Xtimes\[Chi]XtoDP", "[", 
               RowBox[{"mV", ",", "1", ",", "prod"}], "]"}], "]"}], ",", 
             "0"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}]], 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"mDPmin", "[", "prod", "]"}], "<", "mV", "<", 
             RowBox[{"mDPmax", "[", "prod", "]"}]}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{
              RowBox[{"\[Chi]Xtimes\[Chi]XtoDP", "[", 
               RowBox[{"mV", ",", "1", ",", "prod"}], "]"}], "*", 
              RowBox[{"DoubleDistrDP", "[", 
               RowBox[{"mV", ",", "\[Theta]V", ",", "EV", ",", "prod"}], 
               "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}]}]}], "}"}],
      ",", "\"\<MX\>\""}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.892175110512329*^9, 3.892175187706853*^9}, {
   3.892175262677436*^9, 3.89217542245819*^9}, {3.8921754590608096`*^9, 
   3.8921754632859516`*^9}, {3.8921755362226534`*^9, 3.892175552384869*^9}, {
   3.892176052715619*^9, 3.892176054811057*^9}, {3.8921766986049976`*^9, 
   3.892176780057205*^9}, {3.892177011617763*^9, 3.892177128339795*^9}, {
   3.8921771726808753`*^9, 3.8921771941877666`*^9}, {3.892177231182993*^9, 
   3.8921774497314568`*^9}, {3.89217752488566*^9, 3.89217757833836*^9}, 
   3.892177684630415*^9, 3.892178704548239*^9, 3.8921789864543605`*^9, {
   3.8921790672783995`*^9, 3.892179069727179*^9}, {3.892179114510329*^9, 
   3.8921793148284245`*^9}, {3.8921795817634134`*^9, 
   3.8921797716855927`*^9}, {3.892179805150119*^9, 3.8921798964263496`*^9}, {
   3.892179927104117*^9, 3.892179953835002*^9}, {3.892180176263763*^9, 
   3.892180210694174*^9}, {3.8921803243722267`*^9, 3.892180352393804*^9}, {
   3.8921805106510096`*^9, 3.892180519140444*^9}, {3.8921806010546556`*^9, 
   3.892180639074503*^9}, {3.892181248222723*^9, 3.8921813865122576`*^9}, {
   3.892187680319851*^9, 3.8921876806217422`*^9}, {3.8922765048251705`*^9, 
   3.8922765053459935`*^9}, {3.8922841059540906`*^9, 3.892284115944186*^9}, {
   3.892284228045306*^9, 3.892284228521356*^9}, 3.893473823411297*^9, {
   3.8934753001632338`*^9, 3.8934753074207487`*^9}, {3.8934754132851887`*^9, 
   3.8934754159519143`*^9}, 3.89347554049979*^9, {3.8934970353175297`*^9, 
   3.8934971039914875`*^9}, 3.893520967544777*^9, {3.893602084526437*^9, 
   3.893602106478526*^9}, {3.893604980872145*^9, 3.893604987105053*^9}, {
   3.8941790067164764`*^9, 3.894179006990028*^9}, {3.895128855119485*^9, 
   3.895128891315231*^9}, {3.897229313532052*^9, 3.8972293187761*^9}, {
   3.902728092541477*^9, 3.9027281302487693`*^9}, {3.902887828928931*^9, 
   3.902887833256008*^9}, {3.9041238712810163`*^9, 3.9041238793746557`*^9}, {
   3.9041240258546743`*^9, 3.9041240284280605`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"e8ddb45b-231e-400d-974f-\
cb861da64a22"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Determining min/max energies of scalars for the given polar angle. Needed for \
stability of Monte-Carlo integration\
\>", "Subsection",
 CellChangeTimes->{{3.8850217140541673`*^9, 3.8850217339343953`*^9}, {
  3.885449618401306*^9, 3.8854496389805627`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"22ffb09d-98a8-4018-9b26-\
5bfadc5fccbf"],

Cell[CellGroupData[{

Cell["Common definition", "Subsubsection",
 CellChangeTimes->{{3.8851480658530207`*^9, 3.885148069648714*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"b3bb358f-768a-4cd2-936b-\
b61d6286a090"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"EfromXmax", "[", 
   RowBox[{"mass_", ",", "data_", ",", "LogMin_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "distr", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"datt", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"data", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "mass"}], "&"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"EmaxVal", "=", 
      RowBox[{
       RowBox[{"datt", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "3"}], "]"}], "]"}], "//", "Max"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"EminVal", "=", 
      RowBox[{
       RowBox[{"datt", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "3"}], "]"}], "]"}], "//", "Min"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Theta]list", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"x", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "\[Theta]minExp", ",", "\[Theta]maxExp", ",", 
          FractionBox[
           RowBox[{"(", 
            RowBox[{"\[Theta]maxExp", "-", "\[Theta]minExp"}], ")"}], "5"]}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"distr", "[", 
       RowBox[{"\[Theta]fip_", ",", "Efip_"}], "]"}], "=", 
      RowBox[{"Abs", "[", 
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", "3", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "4", "]"}], "]"}], "+", 
                SuperscriptBox["10", 
                 RowBox[{"-", "90"}]]}]}], "}"}], "&"}], "/@", "datt"}], ",", 
           RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
         RowBox[{"\[Theta]fip", ",", "Efip"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DoubleDistrIntList", "[", "i_", "]"}], ":=", 
      RowBox[{
       RowBox[{"Interpolation", "[", 
        RowBox[{
         RowBox[{"ParallelTable", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Efip", ",", 
             RowBox[{"Quiet", "[", 
              RowBox[{"NIntegrate", "[", 
               RowBox[{
                RowBox[{"distr", "[", 
                 RowBox[{"\[Theta]fip", ",", "Efip"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"\[Theta]fip", ",", 
                  RowBox[{"\[Theta]list", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", 
                  RowBox[{"\[Theta]list", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"Method", "\[Rule]", "\"\<AdaptiveMonteCarlo\>\""}]}],
                "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Efip", ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               SuperscriptBox["10", "x"], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{"Log10", "[", 
                  RowBox[{"1.1", "*", "mass"}], "]"}], ",", 
                 RowBox[{"Log10", "[", "EmaxVal", "]"}], ",", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"Log10", "[", "EmaxVal", "]"}], "-", 
                   RowBox[{"Log10", "[", 
                    RowBox[{"1.1", "*", "mass"}], "]"}]}], "50."]}], "}"}]}], 
              "]"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "Efip",
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]fipdistrlist", "[", "Efip_", "]"}], "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"\[Theta]list", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "+", 
            RowBox[{"\[Theta]list", "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "2"], ",", 
          RowBox[{"DoubleDistrIntList", "[", "i", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{
           RowBox[{"Length", "[", "\[Theta]list", "]"}], "-", "1"}], ",", 
          "1"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Theta]EmaxList", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"\[Theta]fipdistrlist", "[", "Efip", "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"SortBy", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Efip", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Theta]fipdistrlist", "[", "Efip", "]"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Efip", ",", "mass", ",", "EmaxVal", ",", "1"}], 
                 "}"}]}], "]"}], ",", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"\[Theta]fipdistrlist", "[", "Efip", "]"}], "]"}], ",", 
          "1"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]EmaxListInt", "[", "\[Theta]fip_", "]"}], "=", 
      RowBox[{
       RowBox[{"Interpolation", "[", 
        RowBox[{"\[Theta]EmaxList", ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
       "\[Theta]fip", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"NormVals", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"\[Theta]fipdistrlist", "[", "Efip", "]"}], "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", 
           SuperscriptBox["10", 
            RowBox[{"-", "90."}]]}], ",", 
          RowBox[{"{", 
           RowBox[{"Efip", ",", "mass", ",", "EmaxVal"}], "}"}], ",", 
          RowBox[{
          "Method", "\[Rule]", "\"\<InterpolationPointsSubdivision\>\""}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"\[Theta]fipdistrlist", "[", "Efip", "]"}], "]"}], ",", 
          "1"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cdf", "[", 
       RowBox[{"es_", ",", "i_"}], "]"}], ":=", 
      RowBox[{"1", "-", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"NormVals", "[", 
          RowBox[{"[", "i", "]"}], "]"}]], 
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"\[Theta]fipdistrlist", "[", "Efip", "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"Efip", ",", "mass", ",", "es"}], "}"}], ",", 
          RowBox[{
          "Method", "\[Rule]", "\"\<InterpolationPointsSubdivision\>\""}]}], 
         "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cdftab", "[", "Efip_", "]"}], "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"\[Theta]fipdistrlist", "[", "Efip", "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"Interpolation", "[", 
            RowBox[{
             RowBox[{"ParallelTable", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"10", "^", "es"}], ",", 
                 RowBox[{"Quiet", "[", 
                  RowBox[{"cdf", "[", 
                   RowBox[{
                    RowBox[{"10", "^", "es"}], ",", "i"}], "]"}], "]"}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"es", ",", 
                 RowBox[{"Log10", "[", "mass", "]"}], ",", 
                 RowBox[{"Log10", "[", "EmaxVal", "]"}], ",", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"Log10", "[", "EmaxVal", "]"}], "-", 
                   RowBox[{"Log10", "[", "mass", "]"}]}], "50"]}], "}"}]}], 
              "]"}], ",", 
             RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
           "Efip", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"\[Theta]fipdistrlist", "[", "Efip", "]"}], "]"}], ",", 
          "1"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"logmin", "[", "\[Theta]fip_", "]"}], "=", "LogMin"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Estart", "[", "\[Theta]fip_", "]"}], "=", 
      RowBox[{"Min", "[", 
       RowBox[{
        RowBox[{"2", "*", 
         RowBox[{"\[Theta]EmaxListInt", "[", "\[Theta]fip", "]"}]}], ",", 
        RowBox[{"0.9", "*", "EmaxVal"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Emaxv", "[", "i_", "]"}], ":=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"NormVals", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "<", 
         SuperscriptBox["10", 
          RowBox[{"-", "15"}]]}], ",", "mass", ",", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"Efip", "/.", 
           RowBox[{"FindRoot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Log10", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"cdftab", "[", 
                  SuperscriptBox["10", "Efip"], "]"}], "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], "\[Equal]", 
              RowBox[{"logmin", "[", 
               RowBox[{
                RowBox[{"\[Theta]EmaxList", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"Efip", ",", 
               RowBox[{"Log10", "[", 
                RowBox[{"Estart", "[", 
                 RowBox[{
                  RowBox[{"\[Theta]EmaxList", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"Log10", "[", 
                RowBox[{
                 RowBox[{"\[Theta]EmaxList", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
               RowBox[{"Log10", "[", "EmaxVal", "]"}]}], "}"}]}], "]"}]}], 
          ")"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tabtemp", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Theta]EmaxList", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"Emaxv", "[", "i", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "\[Theta]EmaxList", "]"}], ",", "1"}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tab", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"\[Theta]minExp", ",", 
           RowBox[{
            RowBox[{"tabtemp", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "}"}], ",", 
        RowBox[{"Drop", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{"tabtemp", ",", "1"}], "]"}], ",", 
          RowBox[{"-", "1"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"\[Theta]maxExp", ",", 
           RowBox[{
            RowBox[{"tabtemp", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"10", "^", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Log10", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
              RowBox[{"Log10", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
           "tab"}], ",", 
          RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
        RowBox[{"Log10", "[", "\[Theta]fip", "]"}], "]"}], ")"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EmaxBlock", "[", 
   RowBox[{"data_", ",", "logmin_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "mlist", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mlist", "=", 
      RowBox[{"Drop", "[", 
       RowBox[{
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"EmaxTemp", "[", 
       RowBox[{"m_", ",", "\[Theta]_"}], "]"}], "=", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"m", ",", 
         RowBox[{"EfromXmax", "[", 
          RowBox[{
           RowBox[{"mlist", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "data", ",", "logmin"}], 
          "]"}], ",", 
         RowBox[{"EfromXmax", "[", 
          RowBox[{
           RowBox[{"mlist", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}], ",", "data", ",", "logmin"}], 
          "]"}]}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{"\[Theta]fip", "\[Rule]", "\[Theta]"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Theta]list1", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"x", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "\[Theta]minExp", ",", "\[Theta]maxExp", ",", 
          FractionBox[
           RowBox[{"(", 
            RowBox[{"\[Theta]maxExp", "-", "\[Theta]minExp"}], ")"}], "10"]}],
          "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"10", "^", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"Log10", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
              RowBox[{"Log10", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"mfip", ",", "\[Theta]fip", ",", 
                 RowBox[{"EmaxTemp", "[", 
                  RowBox[{"mfip", ",", "\[Theta]fip"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"mfip", ",", 
                 RowBox[{"mlist", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"mlist", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"mlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"mlist", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", "10"}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"\[Theta]fip", ",", "\[Theta]list1"}], "}"}]}], "]"}],
              ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ",", 
          RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
        RowBox[{"mfip", ",", 
         RowBox[{"Log10", "[", "\[Theta]fip", "]"}]}], "]"}], ")"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"EDPmax", "[", 
      RowBox[{"mfip_", ",", "\[Theta]fip_", ",", "prod"}], "]"}], "=", 
     RowBox[{"EmaxBlock", "[", 
      RowBox[{
       RowBox[{"DataDistrDP", "[", "prod", "]"}], ",", 
       RowBox[{"-", "7"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"prod", ",", 
      RowBox[{"Select", "[", 
       RowBox[{"ProductionList", ",", 
        RowBox[{
         RowBox[{"#", "\[NotEqual]", "\"\<Brem\>\""}], "&"}]}], "]"}]}], 
     "}"}]}], "]"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"\[Theta]minExp", "<", 
    RowBox[{
    "\[Theta]maxBremFacility", "[", "FacilityGivenExperiment", "]"}]}], ",", 
   RowBox[{
    RowBox[{"EDPmax", "[", 
     RowBox[{"mfip_", ",", "\[Theta]fip_", ",", "\"\<Brem\>\""}], "]"}], "=", 
    RowBox[{
     RowBox[{"Interpolation", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Log10", "[", "\[Theta]fip", "]"}], ",", 
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"zMinBrem", "[", "FacilityGivenExperiment", "]"}], "*", 
              RowBox[{"Ppfacility", "[", "FacilityGivenExperiment", "]"}]}], 
             ",", 
             RowBox[{"Min", "[", 
              RowBox[{
               FractionBox["pTmaxBrem", 
                RowBox[{"Sin", "[", "\[Theta]fip", "]"}]], ",", 
               RowBox[{"zMaxBrem", "*", 
                RowBox[{
                "Ppfacility", "[", "FacilityGivenExperiment", "]"}]}]}], 
              "]"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Theta]fip", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             SuperscriptBox["10", "x"], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"Log10", "[", "\[Theta]minExp", "]"}], ",", 
               RowBox[{"Log10", "[", "\[Theta]maxExp", "]"}], ",", 
               FractionBox[
                RowBox[{
                 RowBox[{"Log10", "[", "\[Theta]maxExp", "]"}], "-", 
                 RowBox[{"Log10", "[", "\[Theta]minExp", "]"}]}], "10."]}], 
              "}"}]}], "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
     RowBox[{"Log10", "[", "\[Theta]fip", "]"}], "]"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"LogLogPlot", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"EDPmax", "[", 
       RowBox[{"0.1", ",", "\[Theta]V", ",", "prod"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Theta]V", ",", "\[Theta]minExp", ",", "\[Theta]maxExp"}], 
    "}"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(V\)]\) [rad]\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(E\), \(V, max\)]\) [GeV]\>\""}], "}"}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
   RowBox[{"FrameStyle", "\[Rule]", 
    RowBox[{"Directive", "[", 
     RowBox[{"Black", ",", " ", "22"}], "]"}]}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"PlotLabel", "\[Rule]", " ", 
    RowBox[{"Style", "[", 
     RowBox[{"\"\<BC1\>\"", ",", " ", "20", ",", " ", "Black"}], "]"}]}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"Placed", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"#", ",", " ", "18"}], "]"}], "&"}], "/@", 
        "ProductionList"}], "}"}], ",", "Right"}], "]"}]}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.0045", "]"}], ",", "Blue"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.0045", "]"}], ",", 
        RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.0045", "]"}], ",", 
        RowBox[{"Darker", "@", 
         RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.0045", "]"}], ",", 
        RowBox[{"Darker", "@", "Cyan"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.0045", "]"}], ",", "Magenta"}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.0045", "]"}], ",", "Black"}], "}"}]}], 
     "}"}]}], ",", 
   RowBox[{"GridLines", "\[Rule]", "Automatic"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.892180437116329*^9, 3.892180448940724*^9}, {
   3.8927056140425315`*^9, 3.892705614364416*^9}, {3.893474227194661*^9, 
   3.893474234046297*^9}, {3.89360114734174*^9, 3.893601242874528*^9}, {
   3.8937482039850693`*^9, 3.893748257885649*^9}, {3.8937486366888*^9, 
   3.8937486430759726`*^9}, {3.8937487667264657`*^9, 3.893748820021937*^9}, 
   3.8937489303926973`*^9, {3.893749023509144*^9, 3.893749039550362*^9}, {
   3.893749081425769*^9, 3.8937490840023003`*^9}, {3.8937491543033047`*^9, 
   3.893749226158144*^9}, {3.893749381272199*^9, 3.893749384430477*^9}, {
   3.8937495085896387`*^9, 3.893749661560362*^9}, {3.893749692026283*^9, 
   3.8937496924853573`*^9}, 3.893749786796824*^9, {3.893749850348592*^9, 
   3.893749866625471*^9}, {3.8937500021671023`*^9, 3.8937500483345733`*^9}, {
   3.897229237872181*^9, 3.8972292390978975`*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[163]:=",ExpressionUUID->"6f1ecfca-b2fe-44c8-9fcb-1de7cdd8ce3f"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Number of events", "Chapter",
 CellChangeTimes->{{3.8935731783578434`*^9, 3.893573180246764*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"0f308b41-d607-4d23-bea6-\
f98cdbbab013"],

Cell[CellGroupData[{

Cell["Definitions", "Section",
 CellChangeTimes->{{3.897198873663946*^9, 3.8971988750678434`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"68daae27-7916-4d9f-a181-\
f066d67e7be0"],

Cell[CellGroupData[{

Cell["\<\
Grids for the initial data with acceptances and distributions\
\>", "Subsection",
 CellChangeTimes->{{3.897198934328184*^9, 3.89719895293719*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"5a85d544-e222-4878-87a8-\
16fd1115b839"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Grid", " ", 
     SubscriptBox["m", "S"]}], ",", " ", 
    SubscriptBox["\[Theta]", "S"], ",", " ", 
    SubscriptBox["E", "S"], ",", " ", 
    RowBox[{
     SubscriptBox["z", "S"], " ", "for", " ", "the", " ", "initial", " ", 
     "acceptance", " ", "data"}], ",", " ", "logarithmized"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"InGridm\[Epsilon]", "=", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"FullAcceptanceData", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InGrid\[Theta]\[Epsilon]", "=", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"FullAcceptanceData", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InGridE\[Epsilon]", "=", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"FullAcceptanceData", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InGridz\[Epsilon]", "=", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"FullAcceptanceData", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Array", " ", "of", " ", "values", " ", "of", " ", "the", " ", "initial",
       " ", "acceptance", " ", "data"}], ",", " ", "reshaped"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Epsilon]vals", "=", 
     RowBox[{"ArrayReshape", "[", 
      RowBox[{
       RowBox[{"FullAcceptanceData", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "5"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Length", "[", "InGridm\[Epsilon]", "]"}], ",", 
         RowBox[{"Length", "[", "InGrid\[Theta]\[Epsilon]", "]"}], ",", 
         RowBox[{"Length", "[", "InGridE\[Epsilon]", "]"}], ",", 
         RowBox[{"Length", "[", "InGridz\[Epsilon]", "]"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Epsilon]azValscomp", "=", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"data", ",", "_Real", ",", "2"}], "}"}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"data", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "5", "]"}], "]"}], "==", "0"}], ",", 
           RowBox[{"-", "90."}], ",", 
           RowBox[{"Log10", "[", 
            RowBox[{
             RowBox[{"data", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "5", "]"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "data", "]"}], ",", "1"}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
       RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Epsilon]azvals", "=", 
     RowBox[{"ArrayReshape", "[", 
      RowBox[{
       RowBox[{"\[Epsilon]azValscomp", "[", "FullAcceptanceData0", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Length", "[", "InGridm\[Epsilon]", "]"}], ",", 
         RowBox[{"Length", "[", "InGrid\[Theta]\[Epsilon]", "]"}], ",", 
         RowBox[{"Length", "[", "InGridE\[Epsilon]", "]"}], ",", 
         RowBox[{"Length", "[", "InGridz\[Epsilon]", "]"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
     "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
     "___", "__"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Grid", " ", 
      SubscriptBox["m", "S"]}], ",", " ", 
     SubscriptBox["\[Theta]", "S"], ",", " ", 
     RowBox[{
      SubscriptBox["E", "S"], " ", "for", " ", "the", " ", "initial", " ", 
      "FIP", " ", "distribution", " ", "data"}], ",", " ", "logarithmized"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"DataLogarithmiedComp", "=", 
    RowBox[{
     RowBox[{"Hold", "@", 
      RowBox[{"Compile", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"data", ",", "_Real", ",", "2"}], "}"}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"data", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "4", "]"}], "]"}], "\[Equal]", "0"}], ",", 
            RowBox[{"-", "90."}], ",", 
            RowBox[{"Log10", "[", 
             RowBox[{
              RowBox[{"data", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "4", "]"}], "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "data", "]"}], ",", "1"}], "}"}]}], "]"}], 
        ",", 
        RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
        RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}]}], "//",
      "ReleaseHold"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockGridsValsDistr", "[", "ProdChannel_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"GridIn", ",", "vals"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"GridIn", "=", 
        RowBox[{
         RowBox[{"Log10", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{
              RowBox[{"DataDistrDP", "[", "ProdChannel", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "#"}], "]"}], "]"}], "]"}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}], "//", "N"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"vals", "=", 
        RowBox[{"ArrayReshape", "[", 
         RowBox[{
          RowBox[{"DataLogarithmiedComp", "[", 
           RowBox[{"DataDistrDP", "[", "ProdChannel", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"GridIn", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
            RowBox[{"Length", "[", 
             RowBox[{"GridIn", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
            RowBox[{"Length", "[", 
             RowBox[{"GridIn", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"GridIn", ",", "vals"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"GridInFinal", "[", "prod", "]"}], ",", 
          RowBox[{"DistrVals", "[", "prod", "]"}]}], "}"}], "=", 
        RowBox[{"BlockGridsValsDistr", "[", "prod", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";"}], "//", 
    "AbsoluteTiming"}]}]}]], "Input",
 CellChangeTimes->{{3.897199659637949*^9, 3.8971996790804834`*^9}, {
   3.897208285005845*^9, 3.8972083314493256`*^9}, 3.89720836608294*^9, {
   3.897229155012*^9, 3.89722915871517*^9}, {3.8972291920059643`*^9, 
   3.8972291927603445`*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[168]:=",ExpressionUUID->"a999801b-4af3-48e9-bd7e-95cbd498c6f8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Grid to be used to calculate the number of events", "Subsection",
 CellChangeTimes->{{3.8971989779703307`*^9, 3.8971989844379535`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"dc4d258a-ca7c-48f8-bc68-\
6be533f45606"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Grid", " ", 
     SubscriptBox["\[Theta]", "S"]}], ",", " ", 
    RowBox[{
     SubscriptBox["z", "S"], " ", "for", " ", "the", " ", "final", " ", 
     "acceptance", " ", "data"}], ",", " ", "logarithmized"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"OutGrid\[Theta]final", "=", 
     RowBox[{"(*", "InGrid\[Theta]\[Epsilon]", "*)"}], 
     RowBox[{"Log10", "[", 
      RowBox[{"Table", "[", 
       RowBox[{"x", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"10", "^", 
           RowBox[{"Min", "[", "InGrid\[Theta]\[Epsilon]", "]"}]}], ",", 
          RowBox[{"10", "^", 
           RowBox[{"Max", "[", "InGrid\[Theta]\[Epsilon]", "]"}]}], ",", 
          FractionBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"10", "^", 
              RowBox[{"Max", "[", "InGrid\[Theta]\[Epsilon]", "]"}]}], "-", 
             RowBox[{"10", "^", 
              RowBox[{"Min", "[", "InGrid\[Theta]\[Epsilon]", "]"}]}]}], 
            ")"}], "30"]}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"OutGridzfinal", "=", 
     RowBox[{"Log10", "[", 
      RowBox[{"Table", "[", 
       RowBox[{"x", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          SuperscriptBox["10", 
           RowBox[{"InGridz\[Epsilon]", "[", 
            RowBox[{"[", "1", "]"}], "]"}]], ",", 
          SuperscriptBox["10", 
           RowBox[{"InGridz\[Epsilon]", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]], ",", 
          RowBox[{"Min", "[", 
           RowBox[{
            FractionBox[
             RowBox[{
              SuperscriptBox["10", 
               RowBox[{"InGridz\[Epsilon]", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}]], "-", 
              SuperscriptBox["10", 
               RowBox[{"InGridz\[Epsilon]", "[", 
                RowBox[{"[", "1", "]"}], "]"}]]}], "5"], ",", 
            RowBox[{"Max", "[", 
             RowBox[{"0.5", ",", 
              FractionBox[
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["10", 
                  RowBox[{"InGridz\[Epsilon]", "[", 
                   RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]], "-", 
                 SuperscriptBox["10", 
                  RowBox[{"InGridz\[Epsilon]", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]]}], ")"}], "30"]}], "]"}]}],
            "]"}]}], "}"}]}], "]"}], "]"}]}], 
    RowBox[{"(*", "InGridz\[Epsilon]", "*)"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalDelta]xVals", "[", "list_", "]"}], ":=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        FractionBox[
         RowBox[{
          RowBox[{"list", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"list", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "2"], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"list", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "-", 
          RowBox[{"list", "[", 
           RowBox[{"[", 
            RowBox[{"i", "-", "1"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"Length", "[", "list", "]"}], ",", "1"}], "}"}]}], "]"}]}],
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalDelta]\[Theta]vals", "=", 
     RowBox[{"\[CapitalDelta]xVals", "[", 
      SuperscriptBox["10", "OutGrid\[Theta]final"], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalDelta]zvals", "=", 
     RowBox[{"\[CapitalDelta]xVals", "[", 
      SuperscriptBox["10", "OutGridzfinal"], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Final", " ", "energy", " ", 
      RowBox[{"grid", ".", " ", "Mass"}]}], "-", " ", 
     RowBox[{"and", " ", "production", " ", "channel"}], "-", "dependent"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"StepEtemp", "[", "Efip_", "]"}], "=", 
     RowBox[{"Piecewise", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.3", ",", 
          RowBox[{"Efip", "\[LessEqual]", "2.5"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.5", ",", 
          RowBox[{"2.5", "<", "Efip", "<", "35"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", 
          RowBox[{"35", "\[LessEqual]", "Efip", "\[LessEqual]", "50"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", 
          RowBox[{"50", "<", "Efip", "<", "160"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5", ",", 
          RowBox[{"160", "\[LessEqual]", "Efip", "<", "300"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"40", ",", 
          RowBox[{"300", "\[LessEqual]", "Efip", "<", "700"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"50", ",", 
          RowBox[{"700", "\[LessEqual]", "Efip", "<", "2000"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"200", ",", 
          RowBox[{"2000", "\[LessEqual]", "Efip", "<", "4000"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"400", ",", 
          RowBox[{"4000", "\[LessEqual]", "Efip", "<", "7000"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"500", ",", 
          RowBox[{"7000", "\[LessEqual]", "Efip", "\[LessEqual]", "50000"}]}],
          "}"}]}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"OutGridEnergy", "[", 
     RowBox[{"m_", ",", "ProdChannel_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"start", "=", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"10", "^", 
               RowBox[{
                RowBox[{
                 RowBox[{"GridInFinal", "[", "ProdChannel", "]"}], "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", 
              RowBox[{"1.01", "m"}]}], "]"}]}], ",", 
           RowBox[{"end", "=", 
            RowBox[{"EDPmax", "[", 
             RowBox[{"m", ",", "\[Theta]minExp", ",", "ProdChannel"}], 
             "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Log10", "[", 
          RowBox[{"NestWhileList", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "+", 
              RowBox[{"StepEtemp", "[", "#", "]"}]}], "&"}], ",", "start", 
            ",", 
            RowBox[{
             RowBox[{"#", "\[LessEqual]", "end"}], "&"}], ",", "1", ",", 
            "\[Infinity]", ",", 
            RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}], "//", "N"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalDelta]xValsTotComp", "=", 
     RowBox[{
      RowBox[{"Hold", "@", 
       RowBox[{"Compile", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[CapitalDelta]\[Theta]vals", ",", "_Real", ",", "1"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[CapitalDelta]Evals", ",", "_Real", ",", "1"}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"\[CapitalDelta]zvals", ",", "_Real", ",", "1"}], "}"}]}],
           "}"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[CapitalDelta]\[Theta]vals", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "*", 
             RowBox[{"\[CapitalDelta]Evals", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "*", 
             RowBox[{"\[CapitalDelta]zvals", "[", 
              RowBox[{"[", "k", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "\[CapitalDelta]\[Theta]vals", "]"}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "\[CapitalDelta]Evals", "]"}]}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", 
             RowBox[{"Length", "[", "\[CapitalDelta]zvals", "]"}]}], "}"}]}], 
          "]"}], ",", 
         RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
         RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}]}], "//",
       "ReleaseHold"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8972023930977507`*^9, 3.8972024003159914`*^9}, {
  3.8972037912719955`*^9, 3.897203794873706*^9}, {3.8972042319753127`*^9, 
  3.8972042376735725`*^9}, {3.8972043473390894`*^9, 3.897204353429783*^9}, {
  3.8972047978657155`*^9, 3.89720480634333*^9}, {3.897208409815923*^9, 
  3.89720841003522*^9}, {3.897229216225009*^9, 3.897229219246179*^9}, {
  3.897229990114852*^9, 3.8972300083249702`*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[178]:=",ExpressionUUID->"6982155e-eb67-495b-9a74-1dfcf048e12e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Code that computes the number of events - using the mapping method \
\>", "Subsection",
 CellChangeTimes->{{3.897199076623907*^9, 3.8971990900052223`*^9}, {
  3.8972009084104066`*^9, 3.897200920680235*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"4bbfd4ad-0dbb-42ad-a426-\
cfa4593e7d57"],

Cell[CellGroupData[{

Cell["Grid for distribution times acceptance", "Subsubsection",
 CellChangeTimes->{{3.8972000893750353`*^9, 3.897200100182712*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"9350f1c3-4778-446f-80c2-\
31578787738f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Block", " ", "that", " ", "computes", " ", "the", " ", "grid", " ", 
     SubscriptBox["\[Theta]", "S"]}], ",", 
    SubscriptBox["E", "S"], ",", 
    SubscriptBox["z", "S"], ",", " ", 
    RowBox[{
     SubscriptBox["\[Epsilon]", "Full"], "\[Times]", 
     SubscriptBox["f", 
      RowBox[{
       SubscriptBox["\[Theta]", "S"], ",", 
       SubscriptBox["E", "S"]}]]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"TableIntegrandDiscret", "[", 
    RowBox[{"m_", ",", "ProdChannel_", ",", "\[Epsilon]DecOp_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"OutGridEfinal", "=", 
       RowBox[{"OutGridEnergy", "[", 
        RowBox[{
         RowBox[{"N", "[", "m", "]"}], ",", "ProdChannel"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalDelta]Evals", "=", 
       RowBox[{"\[CapitalDelta]xVals", "[", 
        SuperscriptBox["10", "OutGridEfinal"], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalDelta]xValsTot", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"\[CapitalDelta]xValsTotComp", "[", 
          RowBox[{
          "\[CapitalDelta]\[Theta]vals", ",", "\[CapitalDelta]Evals", ",", 
           "\[CapitalDelta]zvals"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"OutGridFinal", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Log10", "[", 
            RowBox[{"N", "[", "m", "]"}], "]"}], "}"}], ",", 
          "OutGrid\[Theta]final", ",", "OutGridEfinal", ",", 
          "OutGridzfinal"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"OutGridFinal1", "=", 
       RowBox[{"10", "^", 
        RowBox[{"OutGridFinal", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "3", ",", "4"}], "}"}]}], "]"}], "]"}]}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"g\[Epsilon]", "=", 
       RowBox[{"{", 
        RowBox[{
        "InGridm\[Epsilon]", ",", "InGrid\[Theta]\[Epsilon]", ",", 
         "InGridE\[Epsilon]", ",", "InGridz\[Epsilon]"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xg\[Epsilon]", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Log10", "[", 
           RowBox[{"N", "[", "m", "]"}], "]"}], "}"}], ",", 
         "OutGrid\[Theta]final", ",", "OutGridEfinal", ",", "OutGridzfinal"}],
         "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xig\[Epsilon]", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Interpolation", "[", 
            RowBox[{
             RowBox[{"Transpose", "@", 
              RowBox[{"{", 
               RowBox[{"#", ",", 
                RowBox[{"Range", "@", 
                 RowBox[{"Length", "@", "#"}]}]}], "}"}]}], ",", 
             RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
           "#2", "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"g\[Epsilon]", ",", "xg\[Epsilon]"}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"\[Epsilon]Result", "=", 
       RowBox[{"10", "^", 
        RowBox[{"Flatten", "@", 
         RowBox[{"cf4", "[", 
          RowBox[{
           RowBox[{"Sequence", "@@", "xig\[Epsilon]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"\[Epsilon]DecOp", "==", "\"\<True\>\""}], ",", 
             "\[Epsilon]vals", ",", "\[Epsilon]azvals"}], "]"}]}], 
          "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gDistr", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"GridInFinal", "[", "ProdChannel", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"GridInFinal", "[", "ProdChannel", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"GridInFinal", "[", "ProdChannel", "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xgDistr", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Log10", "[", 
           RowBox[{"N", "[", "m", "]"}], "]"}], "}"}], ",", 
         "OutGrid\[Theta]final", ",", "OutGridEfinal"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xigDistr", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Interpolation", "[", 
            RowBox[{
             RowBox[{"Transpose", "@", 
              RowBox[{"{", 
               RowBox[{"#", ",", 
                RowBox[{"Range", "@", 
                 RowBox[{"Length", "@", "#"}]}]}], "}"}]}], ",", 
             RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
           "#2", "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"gDistr", ",", "xgDistr"}], "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"DistrResult", "=", 
       RowBox[{"10", "^", 
        RowBox[{"Flatten", "@", 
         RowBox[{"cf3", "[", 
          RowBox[{
           RowBox[{"Sequence", "@@", "xigDistr"}], ",", 
           RowBox[{"DistrVals", "[", "ProdChannel", "]"}]}], "]"}]}]}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"TabTemp0", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"OutGridFinal1", ",", 
         RowBox[{"List", "/@", 
          RowBox[{"Flatten", "[", 
           RowBox[{"DistrResult", " ", 
            RowBox[{"Partition", "[", 
             RowBox[{"\[Epsilon]Result", ",", 
              RowBox[{"Length", "[", "OutGridzfinal", "]"}]}], "]"}]}], 
           "]"}]}], ",", "\[CapitalDelta]xValsTot", ",", "2"}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8971994275280633`*^9, 3.897199455815837*^9}, {
  3.897199582357897*^9, 3.897199655914138*^9}, {3.897199710190297*^9, 
  3.8971997629515643`*^9}, {3.8971998392552953`*^9, 3.897199857485531*^9}, {
  3.8971999081472673`*^9, 3.897199913176509*^9}, {3.897200806217702*^9, 
  3.897200808930355*^9}, {3.8972008448098516`*^9, 3.897200868455401*^9}, {
  3.8972021893667536`*^9, 3.897202196806899*^9}, {3.89720660886187*^9, 
  3.8972066089868507`*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[186]:=",ExpressionUUID->"fec2328c-aa8e-45e6-8323-89ae3498b643"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Convoluting acceptances with pre-factor", "Subsubsection",
 CellChangeTimes->{{3.8972001073570213`*^9, 3.8972001113381767`*^9}, {
  3.897200680751539*^9, 3.8972006887621703`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"07e1398b-55a6-4584-9db1-\
8ded1597ad00"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Values", " ", 
     SubscriptBox["f", "FIP"], "\[Times]", 
     SubscriptBox["\[Epsilon]", "FIP"], "\[Times]", 
     FractionBox[
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", 
         SubscriptBox["z", "FIP"]}], "/", 
        RowBox[{"(", 
         RowBox[{"cos", 
          RowBox[{"(", 
           SubscriptBox["\[Theta]", "FIP"], ")"}], 
          SubscriptBox["c\[Tau]", "FIP"], 
          RowBox[{
           SubscriptBox["p", "FIP"], "/", 
           SubscriptBox["m", "FIP"]}]}], ")"}]}], "]"}], 
      RowBox[{"cos", 
       RowBox[{"(", 
        SubscriptBox["\[Theta]", "FIP"], ")"}], 
       SubscriptBox["c\[Tau]", "FIP"], 
       RowBox[{
        SubscriptBox["p", "FIP"], "/", 
        SubscriptBox["m", "FIP"]}]}]], "\[Times]", 
     SubscriptBox["\[Epsilon]", "decay"], 
     SubscriptBox["\[CapitalDelta]z", "FIP"], 
     SubscriptBox["\[CapitalDelta]E", "FIP"], 
     SubscriptBox["\[CapitalDelta]\[Theta]", "FIP"], " ", "for", " ", "the", 
     " ", "grid", " ", "of", " ", "values", " ", 
     SubscriptBox["\[Theta]", "FIP"]}], ",", " ", 
    SubscriptBox["E", "FIP"], ",", " ", 
    RowBox[{
     SubscriptBox["z", "FIP"], " ", "fixed", " ", "values", " ", "of", " ", 
     SubscriptBox["c\[Tau]", "FIP"], " ", "and", " ", 
     SubscriptBox["m", "FIP"]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tableprefac", "=", 
     RowBox[{
      RowBox[{"Hold", "@", 
       RowBox[{"Compile", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"tabb", ",", "_Real", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", "_Real"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c\[Tau]", ",", "_Real"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"decProb", ",", "_Integer"}], "}"}]}], "}"}], ",", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "angles", ",", "energies", ",", "zv", ",", "values", ",", 
             "\[CapitalDelta]s", ",", "prefactor"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"values", "=", 
             RowBox[{"Compile`GetElement", "[", 
              RowBox[{"tabb", ",", "4"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"\[CapitalDelta]s", "=", 
             RowBox[{"Compile`GetElement", "[", 
              RowBox[{"tabb", ",", "5"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"decProb", "==", "1"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"angles", "=", 
                RowBox[{"Compile`GetElement", "[", 
                 RowBox[{"tabb", ",", "1"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"energies", "=", 
                RowBox[{"Compile`GetElement", "[", 
                 RowBox[{"tabb", ",", "2"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"zv", "=", 
                RowBox[{"Compile`GetElement", "[", 
                 RowBox[{"tabb", ",", "3"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"prefactor", "=", 
                FractionBox[
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", "zv"}], "/", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Cos", "[", "angles", "]"}], "*", "c\[Tau]", "*", 
                    FractionBox[
                    SqrtBox[
                    RowBox[{
                    SuperscriptBox["energies", "2"], "-", 
                    SuperscriptBox["m", "2"]}]], "m"]}], ")"}]}], "]"}], 
                 RowBox[{
                  RowBox[{"Cos", "[", "angles", "]"}], "*", "c\[Tau]", "*", 
                  FractionBox[
                   SqrtBox[
                    RowBox[{
                    SuperscriptBox["energies", "2"], "-", 
                    SuperscriptBox["m", "2"]}]], "m"]}]]}]}], ",", 
              RowBox[{"prefactor", "=", "1."}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"prefactor", "*", "\[CapitalDelta]s", "*", "values"}]}]}],
           "]"}], ",", 
         RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
         RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
         RowBox[{"Parallelization", "\[Rule]", "\"\<True\>\""}], ",", 
         RowBox[{"RuntimeAttributes", "\[Rule]", 
          RowBox[{"{", "Listable", "}"}]}]}], "]"}]}], "//", 
      "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Summation", " ", "of", " ", "the", " ", "values", " ", "above"}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sumcompile", "=", 
     RowBox[{
      RowBox[{"Hold", "@", 
       RowBox[{"Compile", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"tabc\[Tau]m", ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
         RowBox[{"Total", "[", "tabc\[Tau]m", "]"}], ",", 
         RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
         RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
         RowBox[{"Parallelization", "\[Rule]", "\"\<True\>\""}]}], "]"}]}], "//",
       "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mmin\[Epsilon]", ",", "mmax\[Epsilon]"}], "}"}], "=", 
    RowBox[{"10", "^", 
     RowBox[{"MinMax", "[", "InGridm\[Epsilon]", "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{
  3.897200675960476*^9, {3.8972040486175427`*^9, 3.897204049008037*^9}, {
   3.897204079641328*^9, 3.8972040859999785`*^9}, {3.8972057591435843`*^9, 
   3.8972057626279507`*^9}, {3.89720886889474*^9, 3.897208869001661*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[187]:=",ExpressionUUID->"58c1c9cd-b2f5-442a-aa55-288aa984498e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Acceptances", "Subsubsection",
 CellChangeTimes->{{3.8972009286929445`*^9, 3.8972009324601674`*^9}, 
   3.897201517674982*^9},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"7abc004f-a596-41a0-9974-\
219f078bc882"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FactorANUBISceiling", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"SelectedExperiment", "==", "\"\<ANUBIS-ceiling\>\""}], ",", "2",
      ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AcceptanceDiscret", "[", 
   RowBox[{
   "m_", ",", "ProdChannel_", ",", "\[Epsilon]decOp_", ",", "decProb_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"NevDiscret", ",", "NpotTimes\[Chi]val"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"mDPmin", "[", "ProdChannel", "]"}], ",", 
          "mmin\[Epsilon]"}], "]"}], "<", "m", "<", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"mDPmax", "[", "ProdChannel", "]"}], ",", 
          "mmax\[Epsilon]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"integrandtab", "=", 
         RowBox[{"TableIntegrandDiscret", "[", 
          RowBox[{"m", ",", "ProdChannel", ",", "\[Epsilon]decOp"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"brvis", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"\[Epsilon]decOp", "==", "1"}], ",", 
           RowBox[{"BrVis", "[", "m", "]"}], ",", "1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Test", " ", "lifetime", " ", "for", " ", "the", " ", "acceptance"}],
          "*)"}], "\[IndentingNewLine]", 
        RowBox[{"c\[Tau]acc", "=", 
         SuperscriptBox["10", "9"]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Prefactor", " ", "for", " ", "the", " ", 
          RowBox[{"acceptance", ".", " ", "If"}], " ", "only", " ", 
          "azimuthal", " ", "and"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"prefacacc", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"decProb", "==", "1"}], ",", "c\[Tau]acc", ",", 
           FractionBox["1", 
            RowBox[{"zmaxExp", "-", "zminExp"}]]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"accdiscret", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"brvis", "!=", "0"}], ",", 
           RowBox[{"FactorANUBISceiling", "*", "brvis", "*", "prefacacc", "*", 
            RowBox[{"sumcompile", "[", 
             RowBox[{"tableprefac", "[", 
              RowBox[{
              "integrandtab", ",", "m", ",", "c\[Tau]acc", ",", "decProb"}], 
              "]"}], "]"}]}], ",", "0"}], "]"}]}]}], ",", 
       RowBox[{"accdiscret", "=", "0"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "accdiscret"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.8972011084712963`*^9, 3.897201128340288*^9}, {
   3.8972011891481795`*^9, 3.89720124049387*^9}, {3.8972012897384634`*^9, 
   3.897201325360157*^9}, {3.897201589075931*^9, 3.8972016624203763`*^9}, {
   3.8972018160050974`*^9, 3.8972018498780518`*^9}, {3.89720191795713*^9, 
   3.8972019346903367`*^9}, {3.8972020225483*^9, 3.8972020975166674`*^9}, {
   3.8972023111284375`*^9, 3.897202311275799*^9}, 3.8972023780567894`*^9, {
   3.897205334073205*^9, 3.8972053351996293`*^9}, {3.897206603491517*^9, 
   3.8972066036108027`*^9}, {3.8972084496286616`*^9, 
   3.8972084523229027`*^9}, {3.8972085258638744`*^9, 
   3.8972085259988823`*^9}, {3.8972088775622473`*^9, 
   3.8972088779176054`*^9}, {3.897229287247379*^9, 3.8972292971530523`*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[190]:=",ExpressionUUID->"8a1d99e1-8129-4e5f-84b9-bd3ff6e17d62"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Acceptances and approximate lower/upper bounds computation", "Section",
 CellChangeTimes->{{3.8972012648879433`*^9, 3.897201267668914*^9}, {
  3.8972059482630224`*^9, 3.8972059524445267`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"7f303373-a91f-430d-bd69-\
5249c59f8cfa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"mlistAcceptance", "[", "prod", "]"}], "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"m", ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", 
           RowBox[{"1.01", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"mDPmin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}], 
             "]"}]}], ",", 
           RowBox[{"0.95", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"mDPmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}], 
             "]"}]}], ",", 
           RowBox[{"Min", "[", 
            RowBox[{
             FractionBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"0.95", 
                 RowBox[{"Min", "[", 
                  RowBox[{
                   RowBox[{"mDPmax", "[", "prod", "]"}], ",", 
                   "mmax\[Epsilon]"}], "]"}]}], "-", 
                RowBox[{"1.01", 
                 RowBox[{"Max", "[", 
                  RowBox[{
                   RowBox[{"mDPmin", "[", "prod", "]"}], ",", 
                   "mmin\[Epsilon]"}], "]"}]}]}], ")"}], "20"], ",", "2"}], 
            "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.99", 
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"mDPmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}], 
          "]"}]}], "}"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"m", ",", 
          RowBox[{"AcceptanceDiscret", "[", 
           RowBox[{"m", ",", "prod", ",", "\"\<False\>\"", ",", "0"}], "]"}], 
          ",", 
          RowBox[{"AcceptanceDiscret", "[", 
           RowBox[{"m", ",", "prod", ",", "\"\<True\>\"", ",", "0"}], "]"}], 
          ",", 
          RowBox[{"AcceptanceDiscret", "[", 
           RowBox[{"m", ",", "prod", ",", "\"\<False\>\"", ",", "1"}], "]"}], 
          ",", 
          RowBox[{"AcceptanceDiscret", "[", 
           RowBox[{"m", ",", "prod", ",", "\"\<True\>\"", ",", "1"}], "]"}]}],
          "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"m", ",", 
          RowBox[{"mlistAcceptance", "[", "prod", "]"}]}], "}"}]}], "]"}]}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlotAcc", "[", "ProdChannel_", "]"}], ":=", 
  RowBox[{"ListLogPlot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "4"}], "}"}]}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "5"}], "}"}]}], "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", " ", "22"}], "]"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Blue"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
         RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
         RowBox[{"Darker", "@", 
          RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Black"}], "}"}]}], 
      "}"}]}], ",", 
    RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"MinMax", "[", 
        RowBox[{
         RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.9", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "5"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}], "]"}]}], ",", 
         RowBox[{"1.1", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}]}], "]"}]}]}], 
        "}"}]}], "}"}]}], ",", 
    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<m [GeV]\>\"", ",", "\"\<Acceptance\>\""}], "}"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", " ", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<From \>\"", ",", "ProdChannel"}], "}"}], "]"}], ",", 
       " ", "20", ",", " ", "Black"}], "]"}]}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"Placed", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"#", ",", " ", "18"}], "]"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{
          "\"\<<\!\(\*SubscriptBox[\(\[Epsilon]\), \(FIP\)]\)>\>\"", ",", 
           "\"\<<\!\(\*SubscriptBox[\(\[Epsilon]\), \
\(FIP\)]\)\!\(\*SubscriptBox[\(\[Epsilon]\), \(decay\)]\)>\>\"", ",", 
           "\"\<c\[Tau]<\!\(\*SubscriptBox[\(\[Epsilon]\), \
\(FIP\)]\)\!\(\*SubscriptBox[\(P\), \(decay\)]\)>\>\"", ",", 
           "\"\<c\[Tau]<\!\(\*SubscriptBox[\(\[Epsilon]\), \
\(FIP\)]\)\!\(\*SubscriptBox[\(P\), \(decay\)]\)\!\(\*SubscriptBox[\(\
\[Epsilon]\), \(decay\)]\)>\>\""}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.75", ",", "0.2"}], "}"}]}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Style", "[", 
   RowBox[{
    RowBox[{"Row", "[", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"PlotAcc", "[", "prod", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "]"}], 
     "]"}], ",", 
    RowBox[{"ImageSizeMultipliers", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"FilenameAcceptance", "[", "prod", "]"}], "=", 
       RowBox[{"ToString", "@", 
        RowBox[{"StringForm", "[", 
         RowBox[{"\"\<Acceptance_DP_at_``_From_``.dat\>\"", ",", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"{", 
            RowBox[{"SelectedExperiment", ",", 
             RowBox[{"ListExport", "[", "prod", "]"}]}], "}"}]}]}], "]"}]}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<Auxiliary data/Dark photons\>\"", ",", "SelectedExperiment", 
           ",", 
           RowBox[{"FilenameAcceptance", "[", "prod", "]"}]}], "}"}], "]"}], 
        ",", 
        RowBox[{
         RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "4", ",", "5"}], "}"}]}], "]"}], 
         "]"}], ",", "\"\<Table\>\""}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AccAveraged", "[", "mV_", "]"}], "=", 
   RowBox[{"NpotGivenExperiment", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"mDPmin", "[", "prod", "]"}], "<", "mV", "<", 
           RowBox[{"mDPmax", "[", "prod", "]"}]}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"\[Chi]Xtimes\[Chi]XtoDP", "[", 
            RowBox[{"mV", ",", "1", ",", "prod"}], "]"}], "]"}], ",", "0"}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ",", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"mDPmin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}], 
            "]"}], "<", "mV", "<", 
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"mDPmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}], 
            "]"}]}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"\[Chi]Xtimes\[Chi]XtoDP", "[", 
             RowBox[{"mV", ",", "1", ",", "prod"}], "]"}], "*", 
            RowBox[{
             RowBox[{"Interpolation", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
               RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
             "mV", "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ",", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"mDPmin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}], 
            "]"}], "<", "mV", "<", 
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"mDPmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}], 
            "]"}]}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"\[Chi]Xtimes\[Chi]XtoDP", "[", 
              RowBox[{"mV", ",", "1", ",", "prod"}], "]"}], "c\[Tau]acc"], 
            "*", 
            RowBox[{
             RowBox[{"Interpolation", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "4"}], "}"}]}], "]"}], "]"}], ",", 
               RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
             "mV", "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ",", 
      RowBox[{"\[Placeholder]", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"mDPmin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}], 
             "]"}], "<", "mV", "<", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"mDPmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}], 
             "]"}]}], ",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{
             FractionBox[
              RowBox[{"\[Chi]Xtimes\[Chi]XtoDP", "[", 
               RowBox[{"mV", ",", "1", ",", "prod"}], "]"}], "c\[Tau]acc"], 
             "*", 
             RowBox[{
              RowBox[{"Interpolation", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "5"}], "}"}]}], "]"}], "]"}], ",", 
                RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
              "mV", "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}]}]}], 
     "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<Auxiliary data/Dark photons\>\"", ",", "SelectedExperiment", ",", 
      "\"\<AcceptanceAveragedDP.m\>\""}], "}"}], "]"}], ",", 
   RowBox[{"AccAveraged", "[", "mV", "]"}], ",", "\"\<MX\>\""}], 
  "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQPUs02DKE862j0ARLexB9MnmzO4i2t3IMAtG7XMyT
QXSKnGA+iJ7wp6UURE+qeFkBoqveb2gC0T/c2ZpBtJfL+gkgum7u7clg8Vnn
boLodd68d0H0iin8d0KBtOKXiAcgOvrItT/xQJqLWeEfiH4v9IwlAUjPyu9i
BdF93a+FQHRFeKQwiJbdpZIAojuE1MD0vRddaz4D6ViO/rUg+jXn5JTtwkD3
K3ZkgOg3Z8qYJETeOk5M2wOm/di8K/SAdOSZAjC9s1S6R1TsreOcRZlg2i54
2lJdIO34YjaYZpfUP3NG8q2jTLDNWRANAEcwhTE=
  "],
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"28070fdc-8c7b-4215-94a0-\
9195dd83b024"],

Cell[CellGroupData[{

Cell["Rough estimates of the upper and lower bounds", "Subsection",
 CellChangeTimes->{{3.8850328066928463`*^9, 3.8850328135228024`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"5adffa0c-150d-49d1-8d5e-\
53caedcf3659"],

Cell[CellGroupData[{

Cell["Definitions", "Subsubsection",
 CellChangeTimes->{{3.877676708463168*^9, 3.877676711193803*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"34e7996e-ffbd-4a92-b3b5-\
708f8d233cc2"],

Cell[BoxData[{
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Epsilon]2minEstimate", "[", 
      RowBox[{"mV_", ",", "prod"}], "]"}], "=", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox[
        RowBox[{"(", 
         RowBox[{"NpotGivenExperiment", "*", 
          RowBox[{"\[Chi]Xtimes\[Chi]XtoDP", "[", 
           RowBox[{"mV", ",", "1", ",", "prod"}], "]"}], "*", 
          RowBox[{
           RowBox[{"Interpolation", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "5"}], "}"}]}], "]"}], "]"}], ",", 
             RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
           "mV", "]"}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{"2.3", 
          RowBox[{"c\[Tau]DP", "[", 
           RowBox[{"mV", ",", "1"}], "]"}]}], ")"}]], ")"}], 
      RowBox[{
       RowBox[{"-", "1"}], "/", "2."}]]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Epsilon]2maxEstimate", "[", 
      RowBox[{"mV_", ",", "prod"}], "]"}], "=", 
     RowBox[{"Re", "[", 
      RowBox[{"Evaluate", "[", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ProductLog", "[", 
            RowBox[{
             RowBox[{"-", "1"}], ",", 
             RowBox[{
              RowBox[{"-", "2.3"}], "*", 
              RowBox[{"(", 
               RowBox[{"b", "/", "a"}], ")"}]}]}], "]"}], "/", "b"}], ")"}]}],
         "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a", "\[Rule]", " ", 
           RowBox[{"NpotGivenExperiment", "*", 
            RowBox[{"\[Chi]Xtimes\[Chi]XtoDP", "[", 
             RowBox[{"mV", ",", "1", ",", "prod"}], "]"}], "*", 
            RowBox[{
             RowBox[{"Interpolation", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
               RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
             "mV", "]"}]}]}], ",", 
          RowBox[{"b", "\[Rule]", 
           RowBox[{"zminExp", "/", 
            RowBox[{"ldecayDP", "[", 
             RowBox[{"mV", ",", "1", ",", 
              RowBox[{"EDPmax", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"mlistDP", "[", "prod", "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", "\[Theta]minExp", ",", 
                "prod"}], "]"}]}], "]"}]}]}]}], "}"}]}], "]"}], "]"}]}]}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"prod", ",", "ProductionList"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Epsilon]estplot", "=", "\"\<Drell-Yan\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogLogPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Epsilon]2minEstimate", "[", 
      RowBox[{"mV", ",", "\[Epsilon]estplot"}], "]"}], ",", 
     RowBox[{"\[Epsilon]2maxEstimate", "[", 
      RowBox[{"mV", ",", "\[Epsilon]estplot"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"mV", ",", 
     RowBox[{"Min", "[", 
      RowBox[{"mlistDP", "[", "\[Epsilon]estplot", "]"}], "]"}], ",", 
     RowBox[{"Max", "[", 
      RowBox[{"mlistDP", "[", "\[Epsilon]estplot", "]"}], "]"}]}], "}"}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"ImageSize", "->", "Large"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8927045521296835`*^9, 3.892704618398532*^9}, {
   3.892704651576499*^9, 3.892704652867281*^9}, 3.8951292466391563`*^9, {
   3.8972064547512426`*^9, 3.8972064548441195`*^9}, {3.8972065272743893`*^9, 
   3.8972065273639555`*^9}, {3.897208556347765*^9, 3.8972085563922853`*^9}, {
   3.8972086426345124`*^9, 3.897208654173244*^9}, {3.8972301868738627`*^9, 
   3.897230202458928*^9}, {3.8972302630721664`*^9, 3.897230271572064*^9}, {
   3.8972303130275044`*^9, 3.8972303219433126`*^9}, 3.8974973255097814`*^9},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[199]:=",ExpressionUUID->"61a3cf61-d225-4195-ab78-5788d51c5fe9"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Number of events", "Section",
 CellChangeTimes->{{3.8972012736109533`*^9, 3.897201275449023*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"1c44fb56-7762-45b2-b4f1-\
3556bfde7421"],

Cell[CellGroupData[{

Cell["Number of events - fast", "Subsection",
 CellChangeTimes->{{3.897206442190997*^9, 3.8972064427846107`*^9}, {
  3.9058407516710014`*^9, 3.9058407547967787`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"e906f49a-dcac-4b39-8dec-\
c71b00fa5f2f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FactorLowerBound", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\"\<ANUBIS-shaft-volume-1\>\"", ",", 
          "\"\<ANUBIS-shaft-volume-2\>\"", ",", 
          "\"\<ANUBIS-shaft-volume-3\>\""}], "}"}], ",", 
        "SelectedExperiment"}], "]"}], "==", "True"}], ",", "0.1", ",", 
     "0.3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NeventsDiscret", "[", 
   RowBox[{"m_", ",", "ProdChannel_", ",", "\[Epsilon]2list_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"NevDiscret", ",", "NpotTimes\[Chi]val"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"mmin\[Epsilon]", ",", 
         RowBox[{"mDPmin", "[", "ProdChannel", "]"}]}], "]"}], "<", "m", "<", 
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"mDPmax", "[", "ProdChannel", "]"}], ",", "mmax\[Epsilon]"}],
         "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"integrandtab", "=", 
        RowBox[{"TableIntegrandDiscret", "[", 
         RowBox[{"m", ",", "ProdChannel", ",", "\"\<True\>\""}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NpotTimes\[Chi]val", "[", "\[Epsilon]2_", "]"}], "=", 
        RowBox[{"FactorANUBISceiling", "*", "NpotGivenExperiment", "*", 
         RowBox[{"\[Chi]Xtimes\[Chi]XtoDP", "[", 
          RowBox[{"m", ",", "\[Epsilon]2", ",", "ProdChannel"}], "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"lowerbound", ",", "upperbound"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Epsilon]2minEstimate", "[", 
           RowBox[{"m", ",", "ProdChannel"}], "]"}], ",", 
          RowBox[{"\[Epsilon]2maxEstimate", "[", 
           RowBox[{"m", ",", "ProdChannel"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"brvis", "=", 
        RowBox[{"BrVis", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NevDiscret", "[", "\[Epsilon]2_", "]"}], ":=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"brvis", "!=", "0"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"FactorLowerBound", "*", "lowerbound"}], "<", 
             "\[Epsilon]2", "<", 
             RowBox[{"2.1", "upperbound"}]}], ",", 
            RowBox[{
             RowBox[{"NpotTimes\[Chi]val", "[", "\[Epsilon]2", "]"}], "*", 
             "brvis", "*", 
             RowBox[{"sumcompile", "[", 
              RowBox[{"tableprefac", "[", 
               RowBox[{"integrandtab", ",", "m", ",", 
                RowBox[{"c\[Tau]DP", "[", 
                 RowBox[{"m", ",", "\[Epsilon]2"}], "]"}], ",", "1"}], "]"}], 
              "]"}]}], ",", "0"}], "]"}], ",", "0"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"m", ",", 
           RowBox[{"\[Epsilon]2list", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"NevDiscret", "[", 
            RowBox[{"\[Epsilon]2list", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "\[Epsilon]2list", "]"}], ",", "1"}], 
          "}"}]}], "]"}]}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"m", ",", 
          RowBox[{"\[Epsilon]2list", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "\[Epsilon]2list", "]"}], ",", "1"}], 
         "}"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.897200964730176*^9, 3.897200965970766*^9}, {
   3.89720118259857*^9, 3.8972011870868115`*^9}, {3.8972012433916793`*^9, 
   3.8972012434804716`*^9}, {3.8972021109080114`*^9, 3.897202111357911*^9}, {
   3.897205130000824*^9, 3.8972051305748835`*^9}, 3.897206599004672*^9, {
   3.8972085445054307`*^9, 3.8972085493226857`*^9}, {3.897208729717713*^9, 
   3.897208782995672*^9}, {3.8972292867323427`*^9, 3.8972292970111017`*^9}, {
   3.89723043678905*^9, 3.8972305059194307`*^9}, 3.897230545910039*^9, {
   3.8972306147913723`*^9, 3.897230624216058*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[202]:=",ExpressionUUID->"8cc8fcdc-3b33-4eb1-986e-54fe01ca34ba"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Number of events - slow (using built-in Mathematica functions Interpolation, \
NIntegrate)\
\>", "Subsection",
 CellChangeTimes->{{3.8972050850842867`*^9, 3.897205097581136*^9}, {
  3.905840757019189*^9, 3.9058407625092545`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"c02af3c5-8f31-400a-82e3-\
8dd1592306bb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Differential", " ", "decay", " ", "probability", " ", 
     RowBox[{"(", 
      RowBox[{"1", "/", "ldecay"}], ")"}], 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "l"}], "/", "ldecay"}], "]"}]}], ",", " ", 
    RowBox[{
    "where", " ", "l", " ", "is", " ", "expressed", " ", "in", " ", "terms", 
     " ", "of", " ", "the", " ", "longitudinal", " ", "displacement", " ", 
     "z", " ", "and", " ", "polar", " ", "angle", " ", "\[Theta]", " ", "as", 
     " ", 
     RowBox[{"z", "/", "cos\[Theta]"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"PdecayDensity", "[", 
      RowBox[{
      "mV_", ",", "\[Epsilon]2_", ",", "\[Theta]V_", ",", "EV_", ",", "zV_"}],
       "]"}], "=", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "zV"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]V", "]"}], "*", 
          RowBox[{"ldecayDP", "[", 
           RowBox[{"mV", ",", "\[Epsilon]2", ",", "EV"}], "]"}]}], ")"}]}], 
       "]"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]V", "]"}], "*", 
        RowBox[{"ldecayDP", "[", 
         RowBox[{"mV", ",", "\[Epsilon]2", ",", "EV"}], "]"}]}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "The", " ", "integrand", " ", "determining", " ", "the", " ", 
     "differential", " ", "rate", " ", "for", " ", "events"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"IntegrandDP", "[", 
        RowBox[{
        "mV_", ",", "\[Epsilon]2_", ",", "\[Theta]V_", ",", "EV_", ",", "zV_",
          ",", "prod"}], "]"}], "=", 
       RowBox[{
        RowBox[{"DoubleDistrDP", "[", 
         RowBox[{"mV", ",", "\[Theta]V", ",", "EV", ",", "prod"}], "]"}], "*", 
        RowBox[{"PdecayDensity", "[", 
         RowBox[{
         "mV", ",", "\[Epsilon]2", ",", "\[Theta]V", ",", "EV", ",", "zV"}], 
         "]"}], "*", 
        RowBox[{"AzimuthalAcceptanceDP", "[", 
         RowBox[{"\[Theta]V", ",", "zV"}], "]"}], "*", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"DecayAcceptanceDP", "[", 
           RowBox[{"mV", ",", "\[Theta]V", ",", "EV", ",", "zV"}], "]"}], ",",
           "1"}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IntegralDP", "[", 
     RowBox[{"mV_", ",", "\[Epsilon]2_", ",", "ProdChannel_"}], "]"}], ":=", 
    RowBox[{"NIntegrate", "[", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"IntegrandDP", "[", 
        RowBox[{
        "mV", ",", "\[Epsilon]2", ",", "\[Theta]V", ",", "EV", ",", "z", ",", 
         "ProdChannel"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]V", ",", "\[Theta]minExp", ",", "\[Theta]maxExp"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"EV", ",", "mV", ",", 
        RowBox[{"EDPmax", "[", 
         RowBox[{"mV", ",", "\[Theta]V", ",", "ProdChannel"}], "]"}]}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", 
        RowBox[{"zmin\[Theta]", "[", "\[Theta]V", "]"}], ",", 
        RowBox[{"zmax\[Theta]", "[", "\[Theta]V", "]"}]}], "}"}], ",", 
      RowBox[{"Method", "\[Rule]", "\"\<AdaptiveMonteCarlo\>\""}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Nevents", "[", 
     RowBox[{"mV_", ",", "\[Epsilon]2_", ",", "ProdChannel_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"mDPmin", "[", "ProdChannel", "]"}], "\[LessEqual]", "mV", 
        "\[LessEqual]", 
        RowBox[{"mDPmax", "[", "ProdChannel", "]"}]}], "&&", 
       RowBox[{
        RowBox[{"BrVis", "[", "mV", "]"}], "!=", "0"}]}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"FactorLowerBound", "*", 
          RowBox[{"\[Epsilon]2minEstimate", "[", 
           RowBox[{"mV", ",", "ProdChannel"}], "]"}]}], "<", "\[Epsilon]2", 
         "<", 
         RowBox[{"2.1", 
          RowBox[{"\[Epsilon]2maxEstimate", "[", 
           RowBox[{"mV", ",", "ProdChannel"}], "]"}]}]}], ",", 
        RowBox[{"NpotGivenExperiment", "*", 
         RowBox[{"\[Chi]Xtimes\[Chi]XtoDP", "[", 
          RowBox[{"mV", ",", "\[Epsilon]2", ",", "ProdChannel"}], "]"}], "*", 
         RowBox[{"IntegralDP", "[", 
          RowBox[{"mV", ",", "\[Epsilon]2", ",", "ProdChannel"}], "]"}]}], 
        ",", "0"}], "]"}], ",", "0"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.897206676519309*^9, 3.8972066766919394`*^9}, {
   3.8972085445134306`*^9, 3.897208556457489*^9}, 3.897208709167758*^9, {
   3.8972087938407507`*^9, 3.897208802487779*^9}, {3.8972292867368436`*^9, 
   3.897229297015228*^9}, 3.8972305311379223`*^9, 3.8972306212632217`*^9},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[204]:=",ExpressionUUID->"94d33319-31fb-4aed-b35e-3114388a6018"],

Cell[CellGroupData[{

Cell["Test", "Subsubsection",
 CellChangeTimes->{{3.8921113169894333`*^9, 3.8921113174761143`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"7c82576d-ab0c-46c5-a37e-\
96b578377518"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "This", " ", "is", " ", "a", " ", "comparison", " ", "between", " ", 
     "the", " ", "slow", " ", "and", " ", "fast", " ", "integration", " ", 
     RowBox[{"methods", ".", " ", "For"}], " ", "the", " ", "selected", " ", 
     "mass", " ", "and", " ", "production", " ", "channel"}], ",", " ", 
    RowBox[{
    "the", " ", "numbers", " ", "of", " ", "events", " ", "obtained", " ", 
     "using", " ", "the", " ", "methods", " ", "should", " ", "agree", " ", 
     "within", " ", "10", "%"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"If", " ", "the", " ", "agreement", " ", "is", " ", "worse"}], 
    ",", " ", 
    RowBox[{
    "there", " ", "may", " ", "be", " ", "a", " ", "few", " ", "reasons"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"1", ")"}], " ", "The", " ", "grid", " ", "for", " ", "the", " ",
      "fast", " ", "method", " ", "is", " ", "not", " ", "dense", " ", 
     RowBox[{"enough", ".", " ", "Try"}], " ", "to", " ", "increase", " ", 
     "the", " ", "grid", " ", "density", " ", 
     RowBox[{"(", 
      RowBox[{
      "OutGrid\[Theta]final", ",", " ", "OutGridEfinal", ",", " ", 
       "OutGridzfinal"}], ")"}], " ", "to", " ", "see", " ", "whether", " ", 
     "the", " ", "agreement", " ", 
     RowBox[{"improves", ".", " ", "Sometimes"}]}], ",", " ", 
    RowBox[{
    "even", " ", "a", " ", "slightly", " ", "denser", " ", "grid", " ", "for",
      " ", 
     RowBox[{"e", ".", "g", ".", " ", "z"}], " ", "may", " ", "lead", " ", 
     "to", " ", "a", " ", "significant", " ", "improvement", " ", "in", " ", 
     "the", " ", "agrement"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"2", ")"}], " ", "The", " ", "Monte"}], "-", 
      RowBox[{
      "Carlo", " ", "integrator", " ", "for", " ", "the", " ", "slow", " ", 
       "method", " ", "fails", " ", "to", " ", "evaluate", " ", 
       "properly"}]}], ";", " ", 
     RowBox[{
     "this", " ", "may", " ", "happen", " ", "if", " ", "the", " ", "range", 
      " ", "of", " ", "the", " ", "integration", " ", "over", " ", "energies",
       " ", "is", " ", "too", " ", "large", " ", "compared", " ", "to", " ", 
      "the", " ", "domain", " ", "where", " ", "most", " ", "of", " ", "the", 
      " ", "events", " ", "actually", " ", "are", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"off", "-", 
         RowBox[{
         "axis", " ", "experiments", " ", "such", " ", "as", " ", "MATHUSLA", 
          " ", "and", " ", "ANUBIS"}]}], ")"}], ".", " ", "Another"}], " ", 
      "symptom", " ", "is", " ", "that", " ", "for", " ", "the", " ", "given",
       " ", "mass", " ", "and", " ", "coupling", " ", "the", " ", "integral", 
      " ", "\"\<jumps\>\""}]}], ",", " ", 
    RowBox[{"i", ".", "e", "."}], ",", " ", 
    RowBox[{
    "returns", " ", "values", " ", "with", " ", "large", " ", "error"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"mtest", "=", "0.9"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "ProdTest", "=", "\"\<\!\(\*SuperscriptBox[\(\[Rho]\), \(0\)]\)\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Epsilon]2list", "=", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["10", 
          RowBox[{"-", "12"}]], ",", 
         RowBox[{"3", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "12"}]]}], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "12"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "11"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "11"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "10"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "10"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "9"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "9"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "8"}]], ",", 
         RowBox[{"2", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "8"}]]}], ",", 
         RowBox[{"4", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "8"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "7"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"6", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"7", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"8", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"9", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "6"}]], ",", 
         RowBox[{"2", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "6"}]]}]}], "}"}], "//", "N"}], "*)"}], 
     RowBox[{"Table", "[", 
      RowBox[{
       SuperscriptBox["10", "x"], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"-", "17."}], ",", 
         RowBox[{"-", "3."}], ",", "0.3"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dat1", "=", 
      RowBox[{"NeventsDiscret", "[", 
       RowBox[{"mtest", ",", "ProdTest", ",", "\[Epsilon]2list"}], "]"}]}], 
     ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dat2", "=", 
      RowBox[{"ParallelTable", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Epsilon]2list", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"c\[Tau]DP", "[", 
           RowBox[{"mtest", ",", 
            RowBox[{"\[Epsilon]2list", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"Nevents", "[", 
           RowBox[{"mtest", ",", 
            RowBox[{"\[Epsilon]2list", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "ProdTest"}], "]"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "\[Epsilon]2list", "]"}], ",", "1"}], 
         "}"}]}], "]"}]}], ";"}], "//", "AbsoluteTiming"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{"dat1", ",", 
      RowBox[{"dat2", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "2"}], "}"}]}], "]"}], "]"}], ",", "2"}], "]"}], "//",
     "TableForm"}]}]}]], "Input",
 CellChangeTimes->{{3.892111330393669*^9, 3.8921113703258653`*^9}, {
   3.8921114855521097`*^9, 3.8921114891326914`*^9}, {3.8921115909252915`*^9, 
   3.89211160107533*^9}, {3.892112023350475*^9, 3.8921120715940514`*^9}, {
   3.8921121043874707`*^9, 3.892112190091645*^9}, {3.892112748834139*^9, 
   3.892112748933666*^9}, {3.8921130465455704`*^9, 3.8921130470314426`*^9}, {
   3.8921131989548674`*^9, 3.8921131992395306`*^9}, {3.892113256325259*^9, 
   3.892113256434625*^9}, {3.892113458241603*^9, 3.8921135323303742`*^9}, {
   3.892116361437076*^9, 3.8921163614848557`*^9}, {3.893257780692194*^9, 
   3.893257792940939*^9}, {3.893260545232792*^9, 3.893260566765787*^9}, {
   3.896953530728937*^9, 3.896953531233162*^9}, {3.896953744363188*^9, 
   3.8969537469343243`*^9}, {3.896953883310589*^9, 3.896953884008139*^9}, {
   3.896971240286153*^9, 3.896971246695673*^9}, {3.8969733757056828`*^9, 
   3.896973378633896*^9}, {3.8969760731711082`*^9, 3.896976348233163*^9}, {
   3.8969763786206193`*^9, 3.896976403680397*^9}, {3.8969764343671703`*^9, 
   3.8969764672032614`*^9}, 3.8972088334478965`*^9, 3.8972305813039556`*^9, {
   3.897497510731538*^9, 3.89749751125323*^9}, {3.902767311298179*^9, 
   3.902767314971142*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[208]:=",ExpressionUUID->"4d36b0fa-dabe-4974-aeae-a552b3a7122e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Differential number of events", "Subsection",
 CellChangeTimes->{{3.892111289211891*^9, 3.892111293865343*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"f4242749-52ce-4980-8f44-\
707005c011e1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "same", " ", "as", " ", "tableprefac", " ", "but", " ", "also",
     " ", "including", " ", "the", " ", "grid"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tableGridPrefac", "=", 
     RowBox[{
      RowBox[{"Hold", "@", 
       RowBox[{"Compile", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"tabb", ",", "_Real", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"mS", ",", "_Real"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c\[Tau]", ",", "_Real"}], "}"}]}], "}"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Cos", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "*", "c\[Tau]", 
                   "*", 
                   FractionBox[
                    SqrtBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "2"], "-", 
                    SuperscriptBox["mS", "2"]}]], "mS"]}], ")"}]}], "]"}], 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "*", "c\[Tau]", "*", 
                FractionBox[
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "2"], "-", 
                   SuperscriptBox["mS", "2"]}]], "mS"]}]], 
              RowBox[{"#", "[", 
               RowBox[{"[", "4", "]"}], "]"}], "*", 
              RowBox[{"#", "[", 
               RowBox[{"[", "5", "]"}], "]"}]}]}], "}"}], "&"}], "/@", 
          "tabb"}], ",", 
         RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
         RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
         RowBox[{"Parallelization", "\[Rule]", "\"\<True\>\""}], ",", 
         RowBox[{"RuntimeAttributes", "\[Rule]", 
          RowBox[{"{", "Listable", "}"}]}]}], "]"}]}], "//", 
      "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Summation", " ", "returning", " ", "the", " ", "differential", " ", 
      "number", " ", "of", " ", "events", " ", "X"}], ",", " ", 
     RowBox[{"df", "/", "dX"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"NdiffCompiled", "=", 
    RowBox[{
     RowBox[{"Hold", "@", 
      RowBox[{"Compile", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"tabNdiff", ",", "_Real", ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"GridQuantity", ",", "_Real", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"LengthPerVariable", ",", "_Integer"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"NPoTtimesPprod", ",", "_Real"}], "}"}]}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"tabNdiff", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"LengthPerVariable", "*", 
                 RowBox[{"(", 
                  RowBox[{"i", "-", "1"}], ")"}]}], "+", "1"}], "]"}], "]"}], 
             "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"NPoTtimesPprod", "*", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"tabNdiff", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"LengthPerVariable", "*", 
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}]}], "+", "j"}], "]"}], 
                 "]"}], "[", 
                RowBox[{"[", "4", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", "LengthPerVariable", ",", "1"}], 
                "}"}]}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "GridQuantity", "]"}], ",", "1"}], "}"}]}],
          "]"}], ",", 
        RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
        RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
        RowBox[{"Parallelization", "\[Rule]", "\"\<True\>\""}]}], "]"}]}], "//",
      "ReleaseHold"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Variable", " ", "=", " ", 
      "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\""}], ",", 
     "\"\<\!\(\*SubscriptBox[\(x\), \(x\)]\)\>\"", ",", 
     RowBox[{
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", ".", " ", "The"}], 
      " ", "number", " ", "belongs", " ", "to", " ", "the", " ", "column", 
      " ", "in", " ", "the", " ", "tabulated", " ", "data"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"iVal", ":=", 
    RowBox[{"Association", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\"", " ", "\[Rule]", "2"}], 
       ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", "\[Rule]", "1"}], 
       ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(x\), \(x\)]\)\>\"", "\[Rule]", "3"}]}], 
      "}"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Differential", " ", "number", " ", "of", " ", "events"}], "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NeventsDifferentialDiscret", "[", 
     RowBox[{
     "m_", ",", "ProdChannel_", ",", "\[Epsilon]2_", ",", "Variable_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "NpotTimes\[Chi]val", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ival", "=", 
        RowBox[{"iVal", "[", "Variable", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"NpotTimes\[Chi]val", "=", 
        RowBox[{"NpotGivenExperiment", "*", 
         RowBox[{"\[Chi]Xtimes\[Chi]XtoDP", "[", 
          RowBox[{"m", ",", "\[Epsilon]2", ",", "ProdChannel"}], "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"tablegrid0", "=", 
        RowBox[{"TableIntegrandDiscret", "[", 
         RowBox[{"m", ",", "ProdChannel", ",", "\"\<True\>\""}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"\[CapitalDelta]xvals", ":=", 
        RowBox[{"Association", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\"", "\[Rule]", 
            "\[CapitalDelta]Evals"}], ",", 
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", "\[Rule]", 
            " ", "\[CapitalDelta]\[Theta]vals"}], ",", 
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(x\), \(X\)]\)\>\"", "\[Rule]", " ", 
            "\[CapitalDelta]zvals"}]}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[CapitalDelta]xval", "=", 
        RowBox[{"\[CapitalDelta]xvals", "[", "Variable", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"c\[Tau]Val", "=", 
        RowBox[{"c\[Tau]DP", "[", 
         RowBox[{"m", ",", "\[Epsilon]2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"brvis", "=", 
        RowBox[{"BrVis", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ilist", "=", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"{", 
          RowBox[{"ival", ",", "1", ",", "2", ",", "3"}], "}"}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"tablegrid1", "=", 
        RowBox[{"SortBy", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"ilist", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"ilist", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"ilist", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "&"}], "/@", 
           RowBox[{"tableGridPrefac", "[", 
            RowBox[{"tablegrid0", ",", "m", ",", "c\[Tau]Val"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"GridQuantity", "=", 
        RowBox[{
         RowBox[{"tablegrid1", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", 
         "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"LengthPerVariable", "=", 
        RowBox[{
         RowBox[{"Length", "[", "tablegrid1", "]"}], "/", 
         RowBox[{"Length", "[", "GridQuantity", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tab1", "=", 
        RowBox[{"NdiffCompiled", "[", 
         RowBox[{
         "tablegrid1", ",", "GridQuantity", ",", "LengthPerVariable", ",", 
          RowBox[{"NpotTimes\[Chi]val", "*", "brvis"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"tab1", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", "1", "}"}]}], "]"}], "]"}], ",", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"tab1", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}], "*", 
            SuperscriptBox["\[CapitalDelta]xval", 
             RowBox[{"-", "1"}]]}], ",", "1"}], "]"}], ",", "2"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mvaltest", "=", "0.3"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Epsilon]2test", "=", 
     SuperscriptBox["10", 
      RowBox[{"-", "15."}]]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"quantity", "=", "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"LegendX", ":=", 
    RowBox[{"Association", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\"", "\[Rule]", 
        "\"\<\!\(\*SubscriptBox[\(E\), \(V\)]\) [GeV]\>\""}], ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", "\[Rule]", 
        "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(V\)]\) [rad]\>\""}], ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(x\), \(X\)]\)\>\"", "\[Rule]", " ", 
        "\"\<\!\(\*SubscriptBox[\(z\), \(V\)]\) [m]\>\""}]}], "}"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"LegendY", ":=", 
    RowBox[{"Association", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\"", "\[Rule]", 
        "\"\<\!\(\*SubscriptBox[\(dN\), \(ev\)]\)/\!\(\*SubscriptBox[\(dE\), \
\(V\)]\) [\!\(\*SuperscriptBox[\(GeV\), \(-1\)]\)]\>\""}], ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", "\[Rule]", 
        "\"\<\!\(\*SubscriptBox[\(dN\), \(ev\)]\)/\!\(\*SubscriptBox[\(d\
\[Theta]\), \(V\)]\) [\!\(\*SuperscriptBox[\(rad\), \(-1\)]\)]\>\""}], ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(x\), \(X\)]\)\>\"", "\[Rule]", " ", 
        "\"\<\!\(\*SubscriptBox[\(dN\), \(ev\)]\)/\!\(\*SubscriptBox[\(dz\), \
\(V\)]\) [\!\(\*SuperscriptBox[\(m\), \(-1\)]\)]\>\""}]}], "}"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"prodlisttemp", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{"mDPmin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}], 
          "]"}], "<", "mvaltest", "<", 
         RowBox[{"Min", "[", 
          RowBox[{"mmax\[Epsilon]", ",", 
           RowBox[{"mDPmax", "[", "prod", "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"prodlisttemp", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"prodlisttemp", ",", 
            RowBox[{"{", "prod", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"NdiffData", "[", "prod", "]"}], "=", 
          RowBox[{"NeventsDifferentialDiscret", "[", 
           RowBox[{
           "mvaltest", ",", "prod", ",", "\[Epsilon]2test", ",", "quantity"}],
            "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"XvalminmaxNdiff", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"NdiffData", "[", "prod", "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ">", 
                SuperscriptBox["10", 
                 RowBox[{"-", "40"}]]}], "&"}]}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "MinMax"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"NdiffInt", "[", 
           RowBox[{"X_", ",", "prod"}], "]"}], "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"XvalminmaxNdiff", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "<", "X", "<", 
             RowBox[{"XvalminmaxNdiff", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"10", "^", 
              RowBox[{
               RowBox[{"Interpolation", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log10", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Log10", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "90"}]]}], "]"}]}], "}"}], "&"}], "/@", 
                  RowBox[{"NdiffData", "[", "prod", "]"}]}], ",", 
                 RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
               RowBox[{"Log10", "[", "X", "]"}], "]"}]}], "]"}], ",", "0"}], 
           "]"}]}]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NdiffInt", "[", 
      RowBox[{"X_", ",", "\"\<Total\>\""}], "]"}], "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"NdiffInt", "[", 
        RowBox[{"X", ",", "prod"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"prod", ",", "prodlisttemp"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LegendList", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", "\"\<Total\>\"", "}"}], ",", "prodlisttemp"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"QuantityMinMax", "=", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"MinMax", "[", 
          RowBox[{
           RowBox[{"NdiffData", "[", "prod", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"prod", ",", "prodlisttemp"}], "}"}]}], "]"}], ",", "1"}], 
      "]"}], "//", "MinMax"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ValueMinMax", "=", 
     RowBox[{"Max", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"NdiffData", "[", "#", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "&"}], "/@", 
       "prodlisttemp"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"LogPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NdiffInt", "[", 
         RowBox[{"X", ",", "prod"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "LegendList"}], "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"X", ",", 
       RowBox[{"QuantityMinMax", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"QuantityMinMax", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox["10", 
           RowBox[{"-", "5"}]], ",", 
          RowBox[{"2", "ValueMinMax"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Black"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Darker", "@", 
           RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Darker", "@", "Cyan"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Magenta"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Blue", ",", 
          RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Darker", "@", "Red"}], ",", 
          RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Darker", "@", 
           RowBox[{"Darker", "@", "Green"}]}], ",", 
          RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"Placed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"#", ",", "18"}], "]"}], "&"}], "/@", "LegendList"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.85", ",", "0.65"}], "}"}]}], "]"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"LegendX", "[", "quantity", "]"}], " ", ",", 
        RowBox[{"LegendY", "[", "quantity", "]"}]}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", " ", "23"}], "]"}]}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{
          "SelectedExperiment", ",", 
           "\"\<. \!\(\*SubscriptBox[\(m\), \(V\)]\) = \>\"", ",", "mvaltest",
            ",", "\"\< GeV, \!\(\*SuperscriptBox[\(\[Epsilon]\), \(2\)]\) = \
\>\"", ",", "\[Epsilon]2test"}], "}"}], "]"}], ",", "20", ",", "Black"}], 
       "]"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8921163996135225`*^9, 3.8921164016036096`*^9}, {
   3.8921164560955544`*^9, 3.892116475031265*^9}, {3.892116516434699*^9, 
   3.8921165782759094`*^9}, {3.8921166461579666`*^9, 
   3.8921166470109124`*^9}, {3.8921167042134895`*^9, 3.892116729930051*^9}, {
   3.8927049818255663`*^9, 3.8927049991222277`*^9}, {3.8929115471019087`*^9, 
   3.892911593659387*^9}, {3.8929721720425777`*^9, 3.892972173350433*^9}, {
   3.8929722208773427`*^9, 3.8929722211847763`*^9}, {3.8932578131000147`*^9, 
   3.893257813645747*^9}, {3.8934746693595037`*^9, 3.893474675301323*^9}, {
   3.8935154039618015`*^9, 3.893515450284458*^9}, {3.893515943430369*^9, 
   3.893515962817915*^9}, 3.893516005738713*^9, {3.893516036174548*^9, 
   3.893516050479193*^9}, {3.893516088577403*^9, 3.893516089018369*^9}, {
   3.893516189974946*^9, 3.8935161902213464`*^9}, {3.8935162352543807`*^9, 
   3.8935162734266047`*^9}, {3.893516595793399*^9, 3.893516611219179*^9}, {
   3.893606026577932*^9, 3.8936060575609436`*^9}, 3.8955578364377675`*^9, {
   3.8969794021337876`*^9, 3.89697940417612*^9}, {3.897206579842867*^9, 
   3.897206594529684*^9}, {3.8972085445254173`*^9, 3.8972085493347607`*^9}, {
   3.897208919899889*^9, 3.897208931547951*^9}, {3.8972292867488394`*^9, 
   3.89722929702377*^9}, {3.8972306661965404`*^9, 3.8972306721050725`*^9}, {
   3.8975308343870435`*^9, 3.897530869153321*^9}, {3.8975310380863085`*^9, 
   3.89753104461861*^9}, {3.897531900362914*^9, 3.897531900595253*^9}, {
   3.9027678930208297`*^9, 3.9027678936528425`*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[214]:=",ExpressionUUID->"578f3ec1-fd7e-4c07-a430-5606f624cb90"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Exporting tabulated number of events", "Title",
 CellChangeTimes->{{3.8850207904521627`*^9, 3.885020796464762*^9}, 
   3.886649940088234*^9},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"a1ac207f-e5a6-41ed-9016-\
23014b2a6c3e"],

Cell[CellGroupData[{

Cell["Definitions", "Chapter",
 CellChangeTimes->{{3.8850542017641125`*^9, 3.885054203349573*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"61d66c6b-87da-4009-946a-\
eb32cc005fd8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DirectoryQ", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<Tabulated Nevents\>\""}], "}"}], "]"}], "]"}], "//", 
       "ToString"}], ")"}], "\[Equal]", "\"\<False\>\""}], ",", 
    RowBox[{"CreateDirectory", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<Tabulated Nevents\>\""}], "}"}], "]"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DirectoryQ", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<Tabulated Nevents/Dark photons\>\""}], "}"}], "]"}], "]"}], "//",
        "ToString"}], ")"}], "\[Equal]", "\"\<False\>\""}], ",", 
    RowBox[{"CreateDirectory", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<Tabulated Nevents/Dark photons\>\""}], "}"}], "]"}], "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DirectoryQ", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<Tabulated Nevents/Dark photons\>\"", ",", 
           "SelectedExperiment"}], "}"}], "]"}], "]"}], "//", "ToString"}], 
      ")"}], "\[Equal]", "\"\<False\>\""}], ",", 
    RowBox[{"CreateDirectory", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<Tabulated Nevents/Dark photons\>\"", ",", "SelectedExperiment"}],
        "}"}], "]"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<Filenames with tabulated \!\(\*SubscriptBox[\(N\), \(events\)]\):\>\"",
   "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"FilenameNevents", "[", "prod", "]"}], "=", 
    RowBox[{"ToString", "@", 
     RowBox[{"StringForm", "[", 
      RowBox[{"\"\<Nevents_DP_at_``_Npot=``_From_``.dat\>\"", ",", 
       RowBox[{"Sequence", "@@", 
        RowBox[{"{", 
         RowBox[{"SelectedExperiment", ",", 
          RowBox[{
           RowBox[{"NpotGivenExperiment", "//", "CForm"}], "//", "ToString"}],
           ",", 
          RowBox[{"ListExport", "[", "prod", "]"}]}], "}"}]}]}], "]"}]}]}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"prod", ",", "ProductionList"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"FilenameNevents", "[", "prod", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "//", 
  "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlistExport", "=", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "0.021", ",", "0.031", ",", "0.051", ",", "0.07", ",", "0.08", ",", 
        "0.09", ",", "0.1", ",", "0.11", ",", "0.12", ",", "0.125", ",", 
        "0.13", ",", "0.14", ",", "0.15", ",", "0.17", ",", "0.2", ",", 
        "0.215", ",", "0.25", ",", "0.3", ",", "0.35", ",", "0.4", ",", 
        "0.45", ",", "0.5", ",", "0.54", ",", "0.55", ",", "0.6", ",", "0.65",
         ",", "0.7", ",", "0.72", ",", "0.73", ",", "0.74", ",", "0.75", ",", 
        "0.76", ",", "0.77", ",", "0.775", ",", "0.78", ",", "0.785", ",", 
        "0.79", ",", "0.795", ",", "0.8", ",", "0.81", ",", "0.82", ",", 
        "0.84", ",", "0.9", ",", "0.95", ",", "0.97", ",", "1", ",", "1.01", 
        ",", "1.015", ",", "1.02", ",", "1.025", ",", "1.03", ",", "1.05", 
        ",", "1.07", ",", "1.09", ",", "1.1", ",", "1.2", ",", "1.3", ",", 
        "1.4", ",", "1.5", ",", "1.6", ",", "1.7", ",", "1.8", ",", "1.9", 
        ",", "2.", ",", "2.1", ",", "2.2", ",", "2.3", ",", "2.4", ",", "2.5",
         ",", "2.6", ",", "2.7", ",", "2.8", ",", "2.9", ",", "3.", ",", 
        "3.05", ",", "3.1", ",", "3.2"}], "}"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{"mV", ",", 
        RowBox[{"{", 
         RowBox[{"mV", ",", "3", ",", 
          RowBox[{"Max", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"mDPmax", "[", "prod", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "]"}], 
          ",", 
          FractionBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"mDPmax", "[", "prod", "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], 
              "]"}], "-", "3"}], ")"}], "10"]}], "}"}]}], "]"}]}], "]"}], "//",
     "N"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Epsilon]2list", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      SuperscriptBox["10", "x"], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"-", "18.8"}], ",", 
        RowBox[{"-", "6"}], ",", "0.05"}], "}"}]}], "]"}], "//", "N"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8850528402073092`*^9, 3.885052964529935*^9}, {
   3.8850529967024455`*^9, 3.88505313318991*^9}, {3.885053172661522*^9, 
   3.885053247354876*^9}, {3.885053717249408*^9, 3.8850537696983976`*^9}, {
   3.885054057416253*^9, 3.88505420740788*^9}, {3.8850542428480587`*^9, 
   3.885054257815028*^9}, {3.885054905514982*^9, 3.885054927992525*^9}, {
   3.88523276755499*^9, 3.885232776819412*^9}, {3.8854556204578223`*^9, 
   3.8854556494874506`*^9}, {3.8854560165278835`*^9, 
   3.8854561921232824`*^9}, {3.8854563516684437`*^9, 
   3.8854563631681647`*^9}, {3.885456439233843*^9, 3.885456605782855*^9}, {
   3.8854567400235205`*^9, 3.885456743964001*^9}, {3.885542660052145*^9, 
   3.8855427304549437`*^9}, {3.8855427881537523`*^9, 3.885542788237467*^9}, {
   3.8855430067620525`*^9, 3.885543013668437*^9}, 3.885966882096207*^9, {
   3.8859669421437807`*^9, 3.8859669421488247`*^9}, {3.885968641323983*^9, 
   3.8859686709916077`*^9}, {3.8859700818035088`*^9, 3.885970116005333*^9}, {
   3.8859726427933483`*^9, 3.8859726621626787`*^9}, {3.8859727076000075`*^9, 
   3.885972770558454*^9}, {3.8860482606809826`*^9, 3.886048270758037*^9}, {
   3.88684029377495*^9, 3.8868404665509343`*^9}, {3.8868414104888535`*^9, 
   3.8868414225159225`*^9}, {3.8890817621378937`*^9, 3.889081762140961*^9}, {
   3.88908460476051*^9, 3.889084604763502*^9}, {3.892188794960414*^9, 
   3.8921888564262486`*^9}, 3.892276504856449*^9, {3.892705877974984*^9, 
   3.8927058964920373`*^9}, {3.89270597977682*^9, 3.892706000159081*^9}, 
   3.892890275686406*^9, 3.892890565684495*^9, {3.8928906683120165`*^9, 
   3.8928906691645193`*^9}, {3.8928921066767316`*^9, 3.892892205794788*^9}, {
   3.8928923091023135`*^9, 3.8928923130853605`*^9}, {3.892893113220736*^9, 
   3.8928931146965623`*^9}, {3.8950540496809034`*^9, 
   3.8950540764821167`*^9}, {3.8950762756864758`*^9, 
   3.8950763083391457`*^9}, {3.895129045455325*^9, 3.895129092773349*^9}, {
   3.896335021554511*^9, 3.896335031114843*^9}, {3.8972293188333693`*^9, 
   3.897229318835312*^9}, {3.904712366400467*^9, 3.9047124185854053`*^9}, {
   3.9047124502939787`*^9, 3.9047124639937067`*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"5ff1e429-21ed-463f-b582-\
04b4f7f4c30e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Exporting", "Chapter",
 CellChangeTimes->{{3.885054212114191*^9, 3.885054213032151*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"3571b874-ffa9-4bf5-a75b-\
14b08106cae0"],

Cell[CellGroupData[{

Cell["Common definition", "Section",
 CellChangeTimes->{{3.8921886043857117`*^9, 3.8921886076155424`*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"6157032c-d8f6-4db5-8885-\
6bf21d753311"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BlockExport", "[", "ProdChannel_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"ProductionList", ",", 
         RowBox[{
          RowBox[{"#", "\[Equal]", "ProdChannel"}], "&"}]}], "]"}], 
       "\[Equal]", 
       RowBox[{"{", "}"}]}], ",", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mlist", "=", "mlistExport"}], ";", "\[IndentingNewLine]", 
       RowBox[{"TabFrom", "=", 
        RowBox[{"Monitor", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"NeventsDiscret", "[", 
             RowBox[{
              RowBox[{"mlist", "[", 
               RowBox[{"[", "k", "]"}], "]"}], ",", "ProdChannel", ",", 
              "\[Epsilon]2list"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", 
              RowBox[{"Length", "[", "mlist", "]"}], ",", "1"}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"Row", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ProgressIndicator", "[", 
               RowBox[{"k", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"Length", "[", "mlist", "]"}]}], "}"}]}], "]"}], 
              ",", "\"\<i = \>\"", ",", "k", ",", "\"\</\>\"", ",", 
              RowBox[{"Length", "[", "mlist", "]"}], ",", "\"\<, m = \>\"", 
              ",", 
              RowBox[{"mlist", "[", 
               RowBox[{"[", "k", "]"}], "]"}], ",", "\"\< GeV\>\""}], "}"}], 
            ",", "\"\< \>\""}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], ",", 
            "\"\<Tabulated Nevents/Dark photons\>\"", ",", 
            "SelectedExperiment", ",", 
            RowBox[{"FilenameNevents", "[", "ProdChannel", "]"}]}], "}"}], 
          "]"}], ",", 
         RowBox[{"Flatten", "[", 
          RowBox[{"TabFrom", ",", "1"}], "]"}], ",", "\"\<Table\>\""}], 
        "]"}]}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8921886102299604`*^9, 3.892188661864987*^9}, {
  3.892188696661598*^9, 3.892188782889353*^9}, {3.8921888713769283`*^9, 
  3.8921888914281387`*^9}, {3.892190937661848*^9, 3.8921909466626697`*^9}, {
  3.8922765048644934`*^9, 3.8922765048725324`*^9}, {3.892705811436641*^9, 
  3.892705819446151*^9}, {3.8927060914745555`*^9, 3.892706101175784*^9}, {
  3.8928905580116014`*^9, 3.8928906317987432`*^9}, {3.8928906742211933`*^9, 
  3.8928907866742725`*^9}, {3.8928910005457926`*^9, 3.8928910006600027`*^9}, {
  3.89289241757715*^9, 3.892892422834627*^9}, {3.8950765046774025`*^9, 
  3.8950765112625575`*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[217]:=",ExpressionUUID->"21d68c5f-eca8-499e-a5b2-08a9c8442c01"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "From ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Rho]", "0"], TraditionalForm]],ExpressionUUID->
  "a10b3ba0-e585-49c1-b0d5-77f53673d841"]
}], "Section",
 CellChangeTimes->{{3.8850542186134644`*^9, 3.8850542291940546`*^9}, {
  3.8850543968830786`*^9, 3.8850543972568283`*^9}, {3.8854566349217353`*^9, 
  3.885456635821289*^9}, {3.885972781535964*^9, 3.8859727816462245`*^9}, {
  3.8868405138462644`*^9, 3.8868405154552355`*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"67c3a9ce-3831-457a-bfdc-\
b3e2a4654e55"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
   "BlockExport", "[", "\"\<\!\(\*SuperscriptBox[\(\[Rho]\), \(0\)]\)\>\"", 
    "]"}], ";"}], "//", "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.885054438676489*^9, 3.8850544565771933`*^9}, {
   3.885232743746546*^9, 3.8852327455696564`*^9}, {3.8854560165334034`*^9, 
   3.885456016535404*^9}, {3.8854561722106504`*^9, 3.8854561810253243`*^9}, {
   3.885456572039451*^9, 3.885456572042471*^9}, 3.8854567168132315`*^9, {
   3.885966882096207*^9, 3.885966882111861*^9}, 3.88596694225861*^9, {
   3.8859686592730427`*^9, 3.8859686592730427`*^9}, 3.8859700818035088`*^9, {
   3.8859711713390193`*^9, 3.8859711713390193`*^9}, 3.885972642809*^9, {
   3.8859727972649345`*^9, 3.8859728174073486`*^9}, {3.8859734351944*^9, 
   3.885973440503255*^9}, 3.8859751994015455`*^9, {3.88684029377495*^9, 
   3.8868403457973137`*^9}, {3.8868404913113995`*^9, 
   3.8868405093728943`*^9}, {3.8921889013373675`*^9, 
   3.8921889088112135`*^9}, {3.8928909608793573`*^9, 3.8928909616041045`*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[218]:=",ExpressionUUID->"ce01b419-cf2c-4c5f-8aad-987fa7f41f9a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "From ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Pi]", "0"], TraditionalForm]],ExpressionUUID->
  "047a85bd-a00b-42c2-82c3-34ec3f393f40"]
}], "Section",
 CellChangeTimes->{{3.8850542186134644`*^9, 3.8850542193674097`*^9}, {
  3.8854566234521356`*^9, 3.8854566261318445`*^9}, {3.8859727833974495`*^9, 
  3.885972784062454*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"95e10647-a125-4457-b20b-\
acc022c5f509"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
   "BlockExport", "[", "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", 
    "]"}], ";"}], "//", "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8850542358688993`*^9, 3.8850542382094545`*^9}, {
   3.885054277631763*^9, 3.885054363431921*^9}, {3.8854560510752897`*^9, 
   3.8854560510763087`*^9}, 3.8854563630285983`*^9, {3.8854565716829195`*^9, 
   3.885456571685834*^9}, {3.885456613051569*^9, 3.885456619872187*^9}, {
   3.8854567159384456`*^9, 3.8854567461856785`*^9}, {3.885966882111861*^9, 
   3.885966882111861*^9}, 3.88596694225861*^9, {3.8859686709916077`*^9, 
   3.8859686709916077`*^9}, 3.8859700984977875`*^9, {3.8859711713390193`*^9, 
   3.8859711713546066`*^9}, 3.885972642809*^9, {3.8859728028497868`*^9, 
   3.8859728172346563`*^9}, {3.8859734318322124`*^9, 3.8859734424226294`*^9}, 
   3.88684029377495*^9, {3.8868403355154448`*^9, 3.8868403457973137`*^9}, {
   3.8868404913113995`*^9, 3.8868405091895466`*^9}, {3.8921889129332795`*^9, 
   3.8921889150814333`*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[219]:=",ExpressionUUID->"4fec21df-68ee-4cf7-ad04-909d4e80d502"]
}, Open  ]],

Cell[CellGroupData[{

Cell["From \[Eta]", "Section",
 CellChangeTimes->{{3.8850542186134644`*^9, 3.8850542262841854`*^9}, {
  3.885456652772599*^9, 3.8854566559423475`*^9}, {3.885972849826418*^9, 
  3.8859728504409485`*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"d5df9731-bc1b-4471-8536-\
fa76f74dac0f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BlockExport", "[", "\"\<\[Eta]\>\"", "]"}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8850542358688993`*^9, 3.8850542382094545`*^9}, {
   3.885054277631763*^9, 3.8850543855153503`*^9}, {3.885456042480401*^9, 
   3.8854560424814262`*^9}, 3.8854561637649994`*^9, {3.88545657204498*^9, 
   3.885456572050495*^9}, {3.885456661477639*^9, 3.885456668992567*^9}, 
   3.8854567150256567`*^9, {3.885456747613888*^9, 3.885456747806327*^9}, {
   3.885966882111861*^9, 3.885966882111861*^9}, 3.88596694225861*^9, {
   3.885968649553114*^9, 3.885968649553114*^9}, 3.88597010984126*^9, {
   3.8859711713546066`*^9, 3.8859711713546066`*^9}, 3.8859726428246174`*^9, {
   3.8859728172346563`*^9, 3.885972835680069*^9}, {3.8859734334967036`*^9, 
   3.8859734464846907`*^9}, 3.886840293790572*^9, {3.8868403355154448`*^9, 
   3.8868403457973137`*^9}, {3.8868404913113995`*^9, 
   3.8868405091940784`*^9}, {3.8921889165620794`*^9, 3.8921889193536544`*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[220]:=",ExpressionUUID->"5a1e6ae7-cc6d-4e39-b940-855e7e35cdad"]
}, Open  ]],

Cell[CellGroupData[{

Cell["From \[Eta]\[CloseCurlyQuote]", "Section",
 CellChangeTimes->{{3.8850542186134644`*^9, 3.88505422780166*^9}, {
  3.8854566729323483`*^9, 3.8854566730023046`*^9}, {3.8854567532255774`*^9, 
  3.8854567544560757`*^9}, {3.885972845923894*^9, 3.8859728471400375`*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"48ddb432-3f82-45a9-8b84-\
e86b62718462"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BlockExport", "[", "\"\<\[Eta]'\>\"", "]"}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8850544007056713`*^9, 3.885054414558234*^9}, {
   3.8854560332901382`*^9, 3.8854560332917004`*^9}, 3.885456351259536*^9, {
   3.885456572052494*^9, 3.8854565720560255`*^9}, {3.8854566760728145`*^9, 
   3.885456710104888*^9}, {3.885456749954727*^9, 3.885456750125414*^9}, {
   3.885966882129011*^9, 3.885966882129011*^9}, 3.8859669422742825`*^9, {
   3.885968641323983*^9, 3.885968641323983*^9}, 3.885970116005333*^9, {
   3.8859711713546066`*^9, 3.8859711713546066`*^9}, 3.8859726428246174`*^9, {
   3.8859728172346563`*^9, 3.88597284134222*^9}, {3.8859733655214477`*^9, 
   3.8859733677543306`*^9}, {3.8859734210983605`*^9, 3.8859734260296836`*^9}, 
   3.886840293790572*^9, {3.8868403355154448`*^9, 3.8868403457973137`*^9}, {
   3.886840491326991*^9, 3.886840509197071*^9}, {3.8921889211231203`*^9, 
   3.892188925261114*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[221]:=",ExpressionUUID->"a2a0d763-995a-4dd4-9fc0-df16bd9e955d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["From brem", "Section",
 CellChangeTimes->{{3.8850542186134644`*^9, 3.88505422780166*^9}, {
  3.8854566729323483`*^9, 3.8854566730023046`*^9}, {3.8854567532255774`*^9, 
  3.8854567544560757`*^9}, {3.885972845923894*^9, 3.8859728471400375`*^9}, {
  3.886840537898929*^9, 3.8868405387356443`*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"1c9fd3fb-1050-4e85-9a0b-\
1fa291d47cd6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BlockExport", "[", "\"\<Brem\>\"", "]"}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8850544007056713`*^9, 3.885054414558234*^9}, {
   3.8854560332901382`*^9, 3.8854560332917004`*^9}, 3.885456351259536*^9, {
   3.885456572052494*^9, 3.8854565720560255`*^9}, {3.8854566760728145`*^9, 
   3.885456710104888*^9}, {3.885456749954727*^9, 3.885456750125414*^9}, {
   3.885966882129011*^9, 3.885966882129011*^9}, 3.8859669422742825`*^9, {
   3.885968641323983*^9, 3.885968641323983*^9}, 3.885970116005333*^9, {
   3.8859711713546066`*^9, 3.8859711713546066`*^9}, 3.8859726428246174`*^9, {
   3.8859728172346563`*^9, 3.88597284134222*^9}, {3.8859733655214477`*^9, 
   3.8859733677543306`*^9}, {3.8859734210983605`*^9, 3.8859734260296836`*^9}, 
   3.886840293790572*^9, {3.8868403355154448`*^9, 3.8868403457973137`*^9}, {
   3.886840491326991*^9, 3.886840509197071*^9}, {3.886840545411461*^9, 
   3.886840549214155*^9}, {3.889081762210126*^9, 3.889081762211681*^9}, {
   3.8890846047694187`*^9, 3.8890846047709637`*^9}, {3.8921889274207916`*^9, 
   3.8921889293474207`*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[222]:=",ExpressionUUID->"9fdd32e4-d27c-49b7-af8c-f818af931c46"]
}, Open  ]],

Cell[CellGroupData[{

Cell["From Drell-Yan", "Section",
 CellChangeTimes->{{3.8850542186134644`*^9, 3.88505422780166*^9}, {
  3.8854566729323483`*^9, 3.8854566730023046`*^9}, {3.8854567532255774`*^9, 
  3.8854567544560757`*^9}, {3.885972845923894*^9, 3.8859728471400375`*^9}, {
  3.8868405405752754`*^9, 3.8868405424509397`*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"04db8acd-a715-451b-b0ae-\
f8b59d430652"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BlockExport", "[", "\"\<Drell-Yan\>\"", "]"}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8850544007056713`*^9, 3.885054414558234*^9}, {
   3.8854560332901382`*^9, 3.8854560332917004`*^9}, 3.885456351259536*^9, {
   3.885456572052494*^9, 3.8854565720560255`*^9}, {3.8854566760728145`*^9, 
   3.885456710104888*^9}, {3.885456749954727*^9, 3.885456750125414*^9}, {
   3.885966882129011*^9, 3.885966882129011*^9}, 3.8859669422742825`*^9, {
   3.885968641323983*^9, 3.885968641323983*^9}, 3.885970116005333*^9, {
   3.8859711713546066`*^9, 3.8859711713546066`*^9}, 3.8859726428246174`*^9, {
   3.8859728172346563`*^9, 3.88597284134222*^9}, {3.8859733655214477`*^9, 
   3.8859733677543306`*^9}, {3.8859734210983605`*^9, 3.8859734260296836`*^9}, 
   3.886840293790572*^9, {3.8868403355154448`*^9, 3.8868403457973137`*^9}, {
   3.886840491326991*^9, 3.886840509197071*^9}, {3.8868405509523153`*^9, 
   3.8868405563659854`*^9}, {3.892188931092238*^9, 3.892188935234996*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[223]:=",ExpressionUUID->"600c6fe1-2ef5-41a1-b16a-f9e9d5dfbea8"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Computing sensitivities", "Title",
 CellChangeTimes->{{3.885020809493571*^9, 3.88502081261261*^9}},
 CellTags->{
  "Sensitivity", 
   "Re-evaluation"},ExpressionUUID->"20138663-2b9a-41fa-8718-2e1c02355f2d"],

Cell[CellGroupData[{

Cell["\<\
Specifying the experiment and interpolating tabulated number of events\
\>", "Chapter",
 CellChangeTimes->{{3.8865657605515084`*^9, 3.886565789800824*^9}, {
  3.8891547325867977`*^9, 3.8891547373469143`*^9}},
 CellTags->{
  "Sensitivity", 
   "Re-evaluation"},ExpressionUUID->"8558a057-a38a-454c-bfce-bde3419e907e"],

Cell[BoxData[{
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"DirectoryQ", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", 
          "\"\<Sensitivity domains\>\""}], "}"}], "]"}], "]"}], "//", 
      "ToString"}], ")"}], "\[Equal]", "\"\<False\>\""}], ",", 
   RowBox[{"CreateDirectory", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", 
       "\"\<Sensitivity domains\>\""}], "}"}], "]"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"DirectoryQ", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", 
          "\"\<Sensitivity domains\>\"", ",", "\"\<Dark photons\>\""}], "}"}],
         "]"}], "]"}], "//", "ToString"}], ")"}], "\[Equal]", 
    "\"\<False\>\""}], ",", 
   RowBox[{"CreateDirectory", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", 
       "\"\<Sensitivity domains\>\"", ",", "\"\<Dark photons\>\""}], "}"}], 
     "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NeventsDirectory", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<Tabulated Nevents\>\"", ",", "\"\<Dark photons\>\""}], "}"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentDirectoriesListNevents", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"FileNames", "[", 
      RowBox[{"\"\<*\>\"", ",", "NeventsDirectory", ",", "1"}], "]"}], ",", 
     "DirectoryQ"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<List of available experiments with tabulated \!\(\*SubscriptBox[\(N\), \
\(events\)]\) for dark photons:\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentsListNevents", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"FileNameTake", "[", 
       RowBox[{
        RowBox[{"ExperimentDirectoriesListNevents", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "ExperimentDirectoriesListNevents", "]"}], ",",
         "1"}], "}"}]}], "]"}], "//", "Sort"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ExperimentsListNevents", "//", "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", "ExperimentsListNevents", "]"}], "\[Equal]", "0"}],
    ",", 
   RowBox[{
   "Print", "[", 
    "\"\<No experiment is available, generate first the acceptance for the \
given experiment using module 1 and the FIP distributions using the module \
2\>\"", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Selected experiment:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", "ExperimentsListNevents", "]"}], "\[NotEqual]", 
    "0"}], ",", 
   RowBox[{"GivenExperimentForSensitivityComputation", "=", 
    RowBox[{"dropdownDialog", "[", 
     RowBox[{
     "ExperimentsListNevents", ",", "\"\<Select the experiment:\>\""}], 
     "]"}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CondANUBIS", "=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<ANUBIS-shaft-volume-1\>\"", ",", "\"\<ANUBIS-shaft-volume-2\>\"", 
       ",", "\"\<ANUBIS-shaft-volume-3\>\""}], "}"}], ",", 
     "GivenExperimentForSensitivityComputation"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"CondANUBIS", "\[Equal]", "True"}], ",", 
   RowBox[{"infoDialog", "[", 
    RowBox[{"Row", "[", 
     RowBox[{
     "{", "\"\<One of the modules of ANUBIS-shaft is chosen. The full \
sensitivity includes three modules. The importing will be over all modules, \
so for all ot the the sensitivity has to be computed\>\"", "}"}], "]"}], 
    "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"CondANUBIS", "\[Equal]", "False"}], ",", 
    RowBox[{"GivenExperimentForSensitivityComputationList", "=", 
     RowBox[{"{", "GivenExperimentForSensitivityComputation", "}"}]}], ",", 
    RowBox[{"GivenExperimentForSensitivityComputationList", "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\<ANUBIS-shaft-volume-1\>\"", ",", "\"\<ANUBIS-shaft-volume-2\>\"", 
       ",", "\"\<ANUBIS-shaft-volume-3\>\""}], "}"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filesNevents", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"filesNevents", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"filesNevents", ",", 
       RowBox[{"FileNames", "[", 
        RowBox[{"\"\<*.dat\>\"", ",", 
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], ",", 
            "\"\<Tabulated Nevents/Dark photons\>\"", ",", "exp"}], "}"}], 
          "]"}]}], "]"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "GivenExperimentForSensitivityComputationList"}], 
     "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<List of production channels:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FilenamesNevents", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Last", "@", 
      RowBox[{"FileNameSplit", "@", 
       RowBox[{"filesNevents", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "filesNevents", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FilenameParameters", "[", "i_", "]"}], ":=", 
  RowBox[{
   RowBox[{"StringCases", "[", 
    RowBox[{
     RowBox[{"FilenamesNevents", "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{
      "\"\<Nevents_DP_at_\>\"", "~~", "experiment__", "~~", "\"\<_Npot=\>\"", 
       "~~", "Npot__", "~~", "\"\<_From_\>\"", "~~", "mother__", "~~", 
       "\"\<.dat\>\""}], ":>", 
      RowBox[{"{", 
       RowBox[{"experiment", ",", "Npot", ",", "mother"}], "}"}]}]}], "]"}], 
   "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductionChannelsList", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"FilenameParameters", "[", "i", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "FilenamesNevents", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Experiment\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(N\), \(PoT\)]\)\>\"", ",", 
       "\"\<Mother\>\""}], "}"}], "}"}], ",", "ProductionChannelsList"}], 
   "]"}], "//", "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NeventsTabulatedList", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{"filesNevents", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<Table\>\""}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "filesNevents", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IfzeroList", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"NeventsTabulatedList", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ">", 
              SuperscriptBox["10", 
               RowBox[{"-", "5"}]]}], "&"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}], "==", "0"}], ",", 
       "0", ",", "1"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "NeventsTabulatedList", "]"}], ",", "1"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NeventsTabulatedList", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"IfzeroList", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "==", "1"}], ",", 
         RowBox[{"NeventsTabulatedList", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "IfzeroList", "]"}], ",", "1"}], "}"}]}], 
      "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"{", "Null", "}"}], ",", "#"}], "]"}], "==", "False"}], 
      "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NpotDefault", "=", 
   RowBox[{
    RowBox[{"Interpreter", "[", "\"\<Number\>\"", "]"}], "[", 
    RowBox[{
     RowBox[{"ProductionChannelsList", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mminmaxTabulated", "[", "i_", "]"}], ":=", 
  RowBox[{"MinMax", "[", 
   RowBox[{
    RowBox[{"NeventsTabulatedList", "[", 
     RowBox[{"[", "i", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Epsilon]2minmaxtabulated", "[", "i_", "]"}], ":=", 
  RowBox[{"MinMax", "[", 
   RowBox[{
    RowBox[{"NeventsTabulatedList", "[", 
     RowBox[{"[", "i", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mminmaxOverall", "=", 
   RowBox[{"MinMax", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"mminmaxTabulated", "[", "i", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "NeventsTabulatedList", "]"}], ",", "1"}], 
        "}"}]}], "]"}], "//", "Flatten"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Epsilon]2minmaxoverall", "=", 
   RowBox[{"MinMax", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"\[Epsilon]2minmaxtabulated", "[", "i", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "NeventsTabulatedList", "]"}], ",", "1"}], 
        "}"}]}], "]"}], "//", "Flatten"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nevint", "[", "i_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"mminmaxTabulated", "[", "i", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", " ", "mV", 
      "\[LessEqual]", 
      RowBox[{
       RowBox[{"mminmaxTabulated", "[", "i", "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "&&", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Epsilon]2minmaxtabulated", "[", "i", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", "\[Epsilon]2", 
      "\[LessEqual]", 
      RowBox[{
       RowBox[{"\[Epsilon]2minmaxtabulated", "[", "i", "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
    RowBox[{"Evaluate", "[", 
     RowBox[{"10", "^", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Log10", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
              RowBox[{"Log10", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
              RowBox[{"Log10", "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "+", 
                SuperscriptBox["10", 
                 RowBox[{"-", "90"}]]}], "]"}]}], "}"}], "&"}], "/@", 
           RowBox[{"NeventsTabulatedList", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
        RowBox[{
         RowBox[{"Log10", "[", "mV", "]"}], ",", 
         RowBox[{"Log10", "[", "\[Epsilon]2", "]"}]}], "]"}], ")"}]}], "]"}], 
    ",", "0"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NevIntList", "[", 
    RowBox[{"mV_", ",", "\[Epsilon]2_"}], "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Nevint", "[", "i", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "NeventsTabulatedList", "]"}], ",", "1"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NevTot", "[", 
    RowBox[{"mV_", ",", "\[Epsilon]2_"}], "]"}], "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NevIntList", "[", 
       RowBox[{"mV", ",", "\[Epsilon]2"}], "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"NevIntList", "[", 
         RowBox[{"mV", ",", "\[Epsilon]2"}], "]"}], "]"}], ",", "1"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentFolder", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"CondANUBIS", "\[Equal]", "True"}], ",", "\"\<ANUBIS\>\"", ",", 
     "GivenExperimentForSensitivityComputation"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"DirectoryQ", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", 
          "\"\<Sensitivity domains\>\"", ",", "\"\<Dark photons\>\"", ",", 
          "ExperimentFolder"}], "}"}], "]"}], "]"}], "//", "ToString"}], 
     ")"}], "\[Equal]", "\"\<False\>\""}], ",", 
   RowBox[{"CreateDirectory", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", 
       "\"\<Sensitivity domains\>\"", ",", "\"\<Dark photons\>\"", ",", 
       "ExperimentFolder"}], "}"}], "]"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.886840860661646*^9, 3.886840860664637*^9}, 
   3.8890817880618696`*^9, {3.8891547447151575`*^9, 3.8891549444728413`*^9}, {
   3.8891555762544374`*^9, 3.8891555856760416`*^9}, {3.8932345510125337`*^9, 
   3.89323456368647*^9}, {3.89357120648059*^9, 3.8935714592585745`*^9}, {
   3.893571545207655*^9, 3.8935715786721*^9}, {3.8935716945595617`*^9, 
   3.8935717354831114`*^9}, {3.893572484980073*^9, 3.8935725300692596`*^9}, {
   3.895054024169799*^9, 3.8950540417214823`*^9}, 3.89684678645724*^9, 
   3.89919325721731*^9, {3.905403972343326*^9, 3.9054039725337305`*^9}},
 CellTags->{
  "Sensitivity", 
   "Re-evaluation"},ExpressionUUID->"c04809c2-412f-4207-902a-ca107db71530"],

Cell[CellGroupData[{

Cell["Events density plot", "Section",
 CellChangeTimes->{{3.8928925129732084`*^9, 3.8928925141322923`*^9}, {
  3.892910359615284*^9, 3.892910363538608*^9}},
 CellTags->{
  "Sensitivity", 
   "Re-evaluation"},ExpressionUUID->"a59ae6cb-9828-417c-bdd1-fff95cb38e4f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Nevmax", "=", 
   RowBox[{"Max", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Max", "[", 
       RowBox[{"NeventsTabulatedList", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "NeventsTabulatedList", "]"}], ",", "1"}], 
       "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"plot", "=", 
  RowBox[{"DensityPlot", "[", 
   RowBox[{
    RowBox[{"Evaluate", "[", 
     RowBox[{"Log10", "[", 
      RowBox[{"NevTot", "[", 
       RowBox[{"mV", ",", "\[Epsilon]2"}], "]"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"mV", ",", 
      RowBox[{"mminmaxOverall", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"mminmaxOverall", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Epsilon]2", ",", 
      RowBox[{"\[Epsilon]2minmaxoverall", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"\[Epsilon]2minmaxoverall", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"ScalingFunctions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Log\>\"", ",", "\"\<Log\>\""}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "0.78"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"All", ",", "All", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log10", "[", "2.3", "]"}], ",", 
         RowBox[{"Log10", "[", "Nevmax", "]"}]}], "}"}]}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(m\), \(V\)]\) [GeV]\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[Epsilon]\), \(2\)]\)\>\""}], "}"}]}], 
    ",", " ", 
    RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", " ", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", " ", "25"}], "]"}]}], ",", 
    RowBox[{"PlotPoints", "\[Rule]", "100"}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"Placed", "[", 
      RowBox[{
       RowBox[{"BarLegend", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Automatic", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Log10", "[", "2.3", "]"}], ",", 
             RowBox[{"Log10", "[", "Nevmax", "]"}]}], "}"}]}], "}"}], ",", 
         RowBox[{"LegendMarkerSize", "\[Rule]", "340"}], ",", 
         RowBox[{"LegendLabel", "\[Rule]", 
          RowBox[{"Placed", "[", 
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(Log\), \
\(10\)]\)[\!\(\*SubscriptBox[\(N\), \(ev\)]\)]\>\"", ",", "Bottom"}], "]"}]}],
          ",", 
         RowBox[{"LabelStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"FontSize", "\[Rule]", "22"}], "}"}]}], ",", 
         RowBox[{"Method", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
            RowBox[{"AxesStyle", "\[Rule]", "None"}], ",", 
            RowBox[{"TicksStyle", "\[Rule]", "Black"}]}], "}"}]}]}], "]"}], 
       ",", "Right"}], "]"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{"{", "ExperimentFolder", "}"}], "]"}], ",", "20", ",", 
       "Black"}], "]"}]}]}], 
   RowBox[{"(*", 
    RowBox[{",", 
     RowBox[{"FrameTicks", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Automatic", ",", "Automatic"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"TicksPlotx", ",", "None"}], "}"}]}], "}"}]}]}], "*)"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<plots/SensCalc/NeventsDensityPlotExample.pdf\>\""}], "}"}], "]"}], 
   ",", "plot", ",", 
   RowBox[{"\"\<AllowRasterization\>\"", "->", "False"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8929096922410564`*^9, 3.892909806303069*^9}, {
   3.8929100920281754`*^9, 3.8929100955435038`*^9}, {3.8929101335841722`*^9, 
   3.892910162228066*^9}, {3.8929101949082084`*^9, 3.8929101952618375`*^9}, {
   3.893481779378194*^9, 3.893481781603961*^9}, {3.8935713726623445`*^9, 
   3.8935713726663337`*^9}, 3.893571593533576*^9, {3.893600462416499*^9, 
   3.893600464823284*^9}, {3.8936007175747695`*^9, 3.8936007273021555`*^9}, {
   3.8936008794615602`*^9, 3.8936008816425495`*^9}, {3.893605565414917*^9, 
   3.8936055685099897`*^9}, {3.894552167897132*^9, 3.894552190947688*^9}},
 CellTags->{"Sensitivity", "Re-evaluation"},
 CellLabel->
  "In[256]:=",ExpressionUUID->"dfa47edf-f1da-4b2e-b4e4-0bdbee1c1674"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Computing sensitivities", "Chapter",
 CellChangeTimes->{{3.8865657683592186`*^9, 3.8865657710012517`*^9}},
 CellTags->{
  "Sensitivity", 
   "Re-evaluation"},ExpressionUUID->"9c16447c-2de4-4d99-8ecb-12fee2a44330"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SensitivityBlock", "[", 
   RowBox[{"Nev_", ",", "Npot_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RegSens", "=", 
      RowBox[{"RegionPlot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          FractionBox["Npot", "NpotDefault"], 
          RowBox[{"NevTot", "[", 
           RowBox[{
            SuperscriptBox["10", "mV"], ",", 
            SuperscriptBox["10", "\[Epsilon]2"]}], "]"}]}], "\[GreaterEqual]",
          "Nev"}], ",", 
        RowBox[{"{", 
         RowBox[{"mV", ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"mminmaxOverall", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"mminmaxOverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Epsilon]2", ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"\[Epsilon]2minmaxoverall", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"\[Epsilon]2minmaxoverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotPoints", "->", "200"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SensTemp", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"Normal", "@", "RegSens"}], ",", 
        RowBox[{
         RowBox[{"Line", "[", "x_", "]"}], "\[RuleDelayed]", "x"}], ",", 
        "Infinity"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Sens", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"10", "^", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"10", "^", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], "&"}], "/@", 
         RowBox[{"SensTemp", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "SensTemp", "]"}], ",", "1"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", 
          "\"\<Sensitivity domains\>\"", ",", "\"\<Dark photons\>\"", ",", 
          "ExperimentFolder", ",", 
          RowBox[{"ToString", "@", 
           RowBox[{"StringForm", "[", 
            RowBox[{"\"\<Sensitivity_DP_at_``_Nev=``_Npot=``.xls\>\"", ",", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"{", 
               RowBox[{"ExperimentFolder", ",", 
                RowBox[{"Nev", "//", "ToString"}], ",", 
                RowBox[{
                 RowBox[{"Npot", "//", "CForm"}], "//", "ToString"}]}], 
               "}"}]}]}], "]"}]}]}], "}"}], "]"}], ",", "Sens"}], "]"}], ";", 
     "\[IndentingNewLine]", "Sens"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BC1bounds", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<contours/BC1/BC1-excluded.txt\>\""}], "}"}], "]"}], ",", 
     "\"\<Table\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<The number of proton collisions:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"NpotDefault", "=", 
  RowBox[{
   RowBox[{"DialogInput", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"br", "=", "NpotDefault"}], "}"}], ",", 
     RowBox[{"Column", "[", 
      RowBox[{"{", 
       RowBox[{"\"\<Enter the number of proton collisions\>\"", ",", 
        RowBox[{"InputField", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "br", "]"}], ",", "Expression"}], "]"}], 
        ",", 
        RowBox[{"Button", "[", 
         RowBox[{"\"\<Proceed\>\"", ",", 
          RowBox[{"DialogReturn", "[", "br", "]"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Automatic"}]}], "]"}]}], "}"}], 
      "]"}]}], "]"}], "//", "N"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<The minimal number of events \!\(\*SubscriptBox[\(N\), \(events, \
min\)]\) for which the sensitivity will be computed:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"NevMinVal", "=", 
  RowBox[{
   RowBox[{"DialogInput", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nev", "=", "2.3"}], "}"}], ",", 
     RowBox[{"Column", "[", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Enter the value of \!\(\*SubscriptBox[\(N\), \(events, min\)]\) \
for which the sensitivity will be computed:\>\"", ",", 
        RowBox[{"InputField", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "nev", "]"}], ",", "Expression"}], "]"}], 
        ",", 
        RowBox[{"Button", "[", 
         RowBox[{"\"\<Proceed\>\"", ",", 
          RowBox[{"DialogReturn", "[", "nev", "]"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Automatic"}]}], "]"}]}], "}"}], 
      "]"}]}], "]"}], "//", "N"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sens", "=", 
   RowBox[{"SensitivityBlock", "[", 
    RowBox[{"NevMinVal", ",", "NpotDefault"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListLogLogPlot", "[", 
    RowBox[{
     RowBox[{"Cases", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"sens", ",", "BC1bounds"}], "}"}], ",", 
       RowBox[{"_", "?", "MatrixQ"}], ",", "All"}], "]"}], ",", 
     RowBox[{"Joined", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"True", ",", "True", ",", "True", ",", "True"}], "}"}]}], ",", 
     " ", 
     RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(m\), \(V\)]\) [GeV]\>\"", " ", ",", " ", 
        "\"\<\!\(\*SuperscriptBox[\(\[Epsilon]\), \(2\)]\)\>\""}], "}"}]}], 
     ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", " ", "23"}], "]"}]}], ",", 
     RowBox[{"PlotStyle", "->", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ConstantArray", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MatrixQ", "[", "sens", "]"}], ",", "1", ",", 
              RowBox[{"Length", "@", "sens"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Thick", ",", "Gray"}], "}"}], ",", "1"}], "]"}]}], 
         "}"}], ",", "1"}], "]"}]}], ",", 
     RowBox[{"Filling", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "sens", "]"}], "+", "1"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Top", ",", 
          RowBox[{"Directive", "[", 
           RowBox[{"Gray", ",", 
            RowBox[{"Opacity", "[", "0.3", "]"}]}], "]"}]}], "}"}]}], "}"}]}],
      ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1.01", 
           RowBox[{"mminmaxOverall", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"1.1", 
           RowBox[{"mminmaxOverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Epsilon]2minmaxoverall", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"0.99", 
           RowBox[{"\[Epsilon]2minmaxoverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{
          "\"\<\!\(\*SubscriptBox[\(N\), \(events\)]\) \[GreaterEqual] \>\"", 
           ",", "NevMinVal"}], "}"}], "]"}], ",", "18", ",", "Black"}], 
       "]"}]}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"Placed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"#", ",", "15"}], "]"}], "&"}], "/@", 
         RowBox[{"{", "GivenExperimentForSensitivityComputation", "}"}]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"0.2", ",", "0.15"}], "}"}]}], "]"}]}]}], "]"}], 
   RowBox[{"(*", 
    RowBox[{",", 
     RowBox[{"LogLogPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", 
         SuperscriptBox["x", "2"], ",", 
         SuperscriptBox["x", "3"], ",", 
         SuperscriptBox["x", "4"], ",", 
         SuperscriptBox["x", "5"], ",", 
         SuperscriptBox["x", "6"]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0.05", ",", "62.49"}], "}"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.006", "]"}], ",", "Blue"}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.006", "]"}], ",", 
            RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.006", "]"}], ",", 
            RowBox[{"Darker", "@", "Red"}], ",", 
            RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.006", "]"}], ",", "Black"}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.01", "]"}], ",", 
            RowBox[{"Darker", "@", "Cyan"}], ",", 
            RowBox[{"Dashing", "[", "0.007", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", 
             RowBox[{"Darker", "@", "Green"}]}], ",", 
            RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", "Red"}]}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"#", ",", "15"}], "]"}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{
            "\"\<SHiP\>\"", ",", 
             "\"\<\!\(\*SubscriptBox[\(SHADOWS\), \(specified\\\ in\\\ LoI\)]\
\)\>\"", ",", 
             "\"\<\!\(\*SubscriptBox[\(SHADOWS\), \(specified\\\ by\\\ \
Gaia\)]\)\>\"", ",", " ", 
             "\"\<\!\(\*SubscriptBox[\(SHADOWS\), \(collab\\\ estimate\)]\)\>\
\""}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"0.26", ",", "0.15"}], "}"}]}], "]"}]}]}], "]"}]}], "*)"}],
    ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{"Text", "[", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"\"\<Excluded\>\"", ",", "24", ",", "Black"}], "]"}], ",", 
       RowBox[{"Scaled", "[", 
        RowBox[{"{", 
         RowBox[{"0.25", ",", "0.4"}], "}"}], "]"}]}], "]"}], "}"}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8891549915062704`*^9, 3.889154993345764*^9}, {
   3.8891550726092916`*^9, 3.8891550770006027`*^9}, {3.889155121639572*^9, 
   3.8891551652523565`*^9}, {3.8891552062371397`*^9, 3.889155265897581*^9}, {
   3.889155479601365*^9, 3.8891554816320353`*^9}, {3.893571372676326*^9, 
   3.8935713726903877`*^9}, {3.893571601881855*^9, 3.893571615039663*^9}, {
   3.895053897017438*^9, 3.895053913667447*^9}, {3.8950539675027623`*^9, 
   3.895053982046572*^9}, {3.8950547143224044`*^9, 3.8950547266846137`*^9}, {
   3.8950767393111925`*^9, 3.8950767394248295`*^9}, 3.8950767893304987`*^9, {
   3.895124505321786*^9, 3.89512453121947*^9}, {3.8956553541843185`*^9, 
   3.8956554026141047`*^9}, {3.8961546653491325`*^9, 
   3.8961546658914757`*^9}, {3.896155101225853*^9, 3.89615510727777*^9}, {
   3.8963350116975923`*^9, 3.896335014109411*^9}, 3.9061946955346165`*^9},
 CellTags->{
  "Sensitivity", 
   "Re-evaluation"},ExpressionUUID->"140a9c48-3c60-400f-bb3d-41932b0b01fa"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Deleting generated cells", "Title",
 CellChangeTimes->{{3.9025559465149946`*^9, 3.9025559494966087`*^9}},
 CellTags->{
  "Sensitivity", 
   "Re-evaluation"},ExpressionUUID->"ffb96111-011a-40fa-9682-858963d62183"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"relaunch", "=", 
  RowBox[{"dropdownDialog", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\"\<Yes\>\"", ",", "\"\<No\>\""}], "}"}], ",", 
    RowBox[{"Row", "[", 
     RowBox[{
     "{", "\"\<Would you like to re-launch the sensitivity calculation for \
another experiment after the given computation?\>\"", "}"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"relaunch", "==", "\"\<Yes\>\""}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nb", "=", 
     RowBox[{"EvaluationNotebook", "[", "]"}]}], ";", "\n", 
    RowBox[{"NotebookFind", "[", 
     RowBox[{
     "nb", ",", "\"\<Re-evaluation\>\"", ",", "All", ",", "CellTags"}], "]"}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"relaunch", "==", "\"\<No\>\""}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"deletecellsopt", "=", 
     RowBox[{"dropdownDialog", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<Yes\>\"", ",", "\"\<No\>\""}], "}"}], ",", 
       RowBox[{"Row", "[", 
        RowBox[{
        "{", "\"\<Would you like to remove all the generated output \
cells?\>\"", "}"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"deletecellsopt", "==", "\"\<Yes\>\""}], ",", 
      RowBox[{
      "FrontEndTokenExecute", "[", "\"\<DeleteGeneratedCells\>\"", "]"}]}], 
     "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.9025559062888603`*^9, 3.9025559062888603`*^9}, {
   3.902555964086707*^9, 3.902555989355214*^9}, 3.9027635395877576`*^9, {
   3.902767344895295*^9, 3.9027673476276693`*^9}, {3.902889573287343*^9, 
   3.902889583599063*^9}, 3.9039719548816566`*^9},
 CellTags->{"Sensitivity", "Re-evaluation"},
 CellLabel->
  "In[233]:=",ExpressionUUID->"f52ba2e2-b5c4-48a5-92ca-6113d843928f"]
}, Open  ]]
},
WindowSize->{1016.4, 570.9},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
ShowCellTags->True,
Magnification:>0.7 Inherited,
FrontEndVersion->"13.2 for Microsoft Windows (64-bit) (November 18, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"83359829-682c-4d24-a2db-c528ca8bf717"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Number-of-events"->{
  Cell[5612, 156, 303, 6, 60, "Title",ExpressionUUID->"294691d8-aa8b-4eec-b72c-7eddbed8edd7",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[5940, 166, 234, 5, 58, "Chapter",ExpressionUUID->"cf63fabc-7a3b-4498-8bf8-f69a301f20dc",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[6177, 173, 5581, 158, 421, "Input",ExpressionUUID->"2c1cafc9-37d9-434e-bd2d-c0787bc6f55b",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[11795, 336, 314, 6, 58, "Chapter",ExpressionUUID->"bfd36837-c4ed-4fec-ab58-b1be4facaa6c",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[12134, 346, 200, 4, 57, "Section",ExpressionUUID->"04c8f572-467e-4c76-8fac-f5585da995c8",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[12337, 352, 3106, 79, 175, "Input",ExpressionUUID->"bfe2aed5-8f0a-4cad-a1aa-1740c3919a79",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[15480, 436, 322, 6, 57, "Section",ExpressionUUID->"2c3557ed-dc43-425a-be83-789280bbdf3c",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[15827, 446, 215, 4, 47, "Subsection",ExpressionUUID->"34cdd10a-d410-4f6f-bbdd-1d6a49f550a0",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[16067, 454, 291, 5, 41, "Subsubsection",ExpressionUUID->"0b267ea5-8acf-426c-a2cd-fec2eaa31b1c",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[16361, 461, 8014, 202, 269, "Input",ExpressionUUID->"70094ca6-e1b1-4123-80be-219218a54741",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[24412, 668, 228, 4, 39, "Subsubsection",ExpressionUUID->"47c3ab2a-08a9-4007-8ead-36f50d19083d",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[24643, 674, 22212, 553, 864, "Input",ExpressionUUID->"c1395d61-d1ed-44b4-bbe7-2f9e2a4dd415",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[46904, 1233, 277, 6, 46, "Subsection",ExpressionUUID->"4b291a99-120b-4b0b-a595-06d4e5a109b7",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[47184, 1241, 6148, 167, 203, "Input",ExpressionUUID->"fb6fcf97-f707-4a92-8ec2-ca831fac76d4",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[53369, 1413, 208, 4, 46, "Subsection",ExpressionUUID->"dbb5e9a1-011b-4ae3-aff9-607e768d7cdb",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[53580, 1419, 5789, 141, 215, "Input",ExpressionUUID->"ffe4bd1e-17f5-479f-b654-d839b1f344d7",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[59430, 1567, 265, 6, 58, "Chapter",ExpressionUUID->"0fddb25a-a632-4751-8775-41d96137bd6d",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[59720, 1577, 259, 5, 47, "Subsection",ExpressionUUID->"a880651e-1eca-4b4f-b7f3-77b0def9580f",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[59982, 1584, 7671, 183, 204, "Input",ExpressionUUID->"c206a552-6f39-4b30-8dc8-af7ceee53d27",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[67690, 1772, 260, 5, 47, "Subsection",ExpressionUUID->"aaabee25-6353-4c34-9850-c513e840a7f9",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[67953, 1779, 7524, 181, 204, "Input",ExpressionUUID->"d62d583a-710d-4b99-ab03-5766ac554b05",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[75538, 1967, 221, 4, 60, "Title",ExpressionUUID->"6bf41310-9786-4a2d-9c45-da72c297facc",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[75762, 1973, 6545, 169, 310, "Input",ExpressionUUID->"14cf246a-dfe6-4f84-bced-6779a027f776",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[82332, 2146, 224, 4, 58, "Chapter",ExpressionUUID->"bf5cb1ca-586b-421c-9b8f-bcdda79a4c7d",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[82559, 2152, 1931, 47, 217, "Input",ExpressionUUID->"8ccbe0c0-5799-4a13-b89d-58d5d3aa1550",
   CellTags->{"Number-of-events", "Acceptance"}]},
 "Acceptance"->{
  Cell[5612, 156, 303, 6, 60, "Title",ExpressionUUID->"294691d8-aa8b-4eec-b72c-7eddbed8edd7",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[5940, 166, 234, 5, 58, "Chapter",ExpressionUUID->"cf63fabc-7a3b-4498-8bf8-f69a301f20dc",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[6177, 173, 5581, 158, 421, "Input",ExpressionUUID->"2c1cafc9-37d9-434e-bd2d-c0787bc6f55b",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[11795, 336, 314, 6, 58, "Chapter",ExpressionUUID->"bfd36837-c4ed-4fec-ab58-b1be4facaa6c",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[12134, 346, 200, 4, 57, "Section",ExpressionUUID->"04c8f572-467e-4c76-8fac-f5585da995c8",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[12337, 352, 3106, 79, 175, "Input",ExpressionUUID->"bfe2aed5-8f0a-4cad-a1aa-1740c3919a79",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[15480, 436, 322, 6, 57, "Section",ExpressionUUID->"2c3557ed-dc43-425a-be83-789280bbdf3c",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[15827, 446, 215, 4, 47, "Subsection",ExpressionUUID->"34cdd10a-d410-4f6f-bbdd-1d6a49f550a0",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[16067, 454, 291, 5, 41, "Subsubsection",ExpressionUUID->"0b267ea5-8acf-426c-a2cd-fec2eaa31b1c",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[16361, 461, 8014, 202, 269, "Input",ExpressionUUID->"70094ca6-e1b1-4123-80be-219218a54741",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[24412, 668, 228, 4, 39, "Subsubsection",ExpressionUUID->"47c3ab2a-08a9-4007-8ead-36f50d19083d",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[24643, 674, 22212, 553, 864, "Input",ExpressionUUID->"c1395d61-d1ed-44b4-bbe7-2f9e2a4dd415",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[46904, 1233, 277, 6, 46, "Subsection",ExpressionUUID->"4b291a99-120b-4b0b-a595-06d4e5a109b7",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[47184, 1241, 6148, 167, 203, "Input",ExpressionUUID->"fb6fcf97-f707-4a92-8ec2-ca831fac76d4",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[53369, 1413, 208, 4, 46, "Subsection",ExpressionUUID->"dbb5e9a1-011b-4ae3-aff9-607e768d7cdb",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[53580, 1419, 5789, 141, 215, "Input",ExpressionUUID->"ffe4bd1e-17f5-479f-b654-d839b1f344d7",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[59430, 1567, 265, 6, 58, "Chapter",ExpressionUUID->"0fddb25a-a632-4751-8775-41d96137bd6d",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[59720, 1577, 259, 5, 47, "Subsection",ExpressionUUID->"a880651e-1eca-4b4f-b7f3-77b0def9580f",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[59982, 1584, 7671, 183, 204, "Input",ExpressionUUID->"c206a552-6f39-4b30-8dc8-af7ceee53d27",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[67690, 1772, 260, 5, 47, "Subsection",ExpressionUUID->"aaabee25-6353-4c34-9850-c513e840a7f9",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[67953, 1779, 7524, 181, 204, "Input",ExpressionUUID->"d62d583a-710d-4b99-ab03-5766ac554b05",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[75538, 1967, 221, 4, 60, "Title",ExpressionUUID->"6bf41310-9786-4a2d-9c45-da72c297facc",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[75762, 1973, 6545, 169, 310, "Input",ExpressionUUID->"14cf246a-dfe6-4f84-bced-6779a027f776",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[82332, 2146, 224, 4, 58, "Chapter",ExpressionUUID->"bf5cb1ca-586b-421c-9b8f-bcdda79a4c7d",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[82559, 2152, 1931, 47, 217, "Input",ExpressionUUID->"8ccbe0c0-5799-4a13-b89d-58d5d3aa1550",
   CellTags->{"Number-of-events", "Acceptance"}]},
 "Number-of-events-computation"->{
  Cell[84539, 2205, 204, 4, 60, "Title",ExpressionUUID->"ec7d1ed4-b833-4ca9-b86b-68ef0bdfdc5e",
   CellTags->"Number-of-events-computation"],
  Cell[84768, 2213, 318, 6, 58, "Chapter",ExpressionUUID->"ddc91657-c605-432a-9fc4-3dde27689d78",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[85089, 2221, 19683, 540, 627, "Input",ExpressionUUID->"c815bc21-895a-435e-aff8-c368c51a223c",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[104809, 2766, 529, 10, 58, "Chapter",ExpressionUUID->"2ed58b5e-8fa1-4a99-b81c-130884bcdd21",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[105363, 2780, 366, 7, 57, "Section",ExpressionUUID->"55cf97a8-2660-4bce-8ec9-801bafbdf76d",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[105732, 2789, 3914, 84, 190, "Input",ExpressionUUID->"af91a4df-a2ec-4b76-bfe7-3122355d5590",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[109671, 2877, 248, 5, 47, "Subsection",ExpressionUUID->"3b43ff78-6b27-4d93-8d69-7457f7f8823d",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[109922, 2884, 17069, 411, 535, "Input",ExpressionUUID->"e8ddb45b-231e-400d-974f-cb861da64a22",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[127028, 3300, 402, 9, 47, "Subsection",ExpressionUUID->"22ffb09d-98a8-4018-9b26-5bfadc5fccbf",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[127455, 3313, 245, 5, 41, "Subsubsection",ExpressionUUID->"b3bb358f-768a-4cd2-936b-b61d6286a090",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[127703, 3320, 23149, 591, 790, "Input",ExpressionUUID->"6f1ecfca-b2fe-44c8-9fcb-1de7cdd8ce3f",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[150925, 3919, 206, 4, 58, "Chapter",ExpressionUUID->"0f308b41-d607-4d23-bea6-f98cdbbab013",
   CellTags->"Number-of-events-computation"],
  Cell[151156, 3927, 233, 5, 57, "Section",ExpressionUUID->"68daae27-7916-4d9f-a181-f066d67e7be0",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[151414, 3936, 291, 7, 47, "Subsection",ExpressionUUID->"5a85d544-e222-4878-87a8-16fd1115b839",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[151708, 3945, 7967, 205, 270, "Input",ExpressionUUID->"a999801b-4af3-48e9-bd7e-95cbd498c6f8",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[159712, 4155, 276, 5, 47, "Subsection",ExpressionUUID->"dc4d258a-ca7c-48f8-bc68-6be533f45606",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[159991, 4162, 9278, 236, 302, "Input",ExpressionUUID->"6982155e-eb67-495b-9a74-1dfcf048e12e",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[169306, 4403, 351, 8, 47, "Subsection",ExpressionUUID->"4bbfd4ad-0dbb-42ad-a426-cfa4593e7d57",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[169682, 4415, 266, 5, 41, "Subsubsection",ExpressionUUID->"9350f1c3-4778-446f-80c2-31578787738f",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[169951, 4422, 6614, 164, 250, "Input",ExpressionUUID->"fec2328c-aa8e-45e6-8323-89ae3498b643",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[176602, 4591, 320, 6, 41, "Subsubsection",ExpressionUUID->"07e1398b-55a6-4584-9db1-8ded1597ad00",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[176925, 4599, 6067, 143, 269, "Input",ExpressionUUID->"58c1c9cd-b2f5-442a-aa55-288aa984498e",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[183029, 4747, 267, 6, 41, "Subsubsection",ExpressionUUID->"7abc004f-a596-41a0-9974-219f078bc882",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[183299, 4755, 3686, 82, 218, "Input",ExpressionUUID->"8a1d99e1-8129-4e5f-84b9-bd3ff6e17d62",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[187046, 4844, 333, 6, 57, "Section",ExpressionUUID->"7f303373-a91f-430d-bd69-5249c59f8cfa",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[187382, 4852, 14585, 385, 413, "Input",ExpressionUUID->"28070fdc-8c7b-4215-94a0-9195dd83b024",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[201992, 5241, 272, 5, 47, "Subsection",ExpressionUUID->"5adffa0c-150d-49d1-8d5e-53caedcf3659",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[202289, 5250, 237, 5, 41, "Subsubsection",ExpressionUUID->"34e7996e-ffbd-4a92-b3b5-708f8d233cc2",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[202529, 5257, 4360, 108, 149, "Input",ExpressionUUID->"61a3cf61-d225-4195-ab78-5788d51c5fe9",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[206950, 5372, 238, 5, 57, "Section",ExpressionUUID->"1c44fb56-7762-45b2-b4f1-3556bfde7421",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[207213, 5381, 301, 6, 47, "Subsection",ExpressionUUID->"e906f49a-dcac-4b39-8dec-c71b00fa5f2f",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[207517, 5389, 4706, 110, 150, "Input",ExpressionUUID->"8cc8fcdc-3b33-4eb1-986e-54fe01ca34ba",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[212260, 5504, 374, 9, 47, "Subsection",ExpressionUUID->"c02af3c5-8f31-400a-82e3-8dd1592306bb",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[212637, 5515, 5086, 127, 152, "Input",ExpressionUUID->"94d33319-31fb-4aed-b35e-3114388a6018",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[217748, 5646, 234, 5, 41, "Subsubsection",ExpressionUUID->"7c82576d-ab0c-46c5-a37e-96b578377518",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[217985, 5653, 8234, 199, 206, "Input",ExpressionUUID->"4d36b0fa-dabe-4974-aeae-a552b3a7122e",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[226268, 5858, 252, 5, 46, "Subsection",ExpressionUUID->"f4242749-52ce-4980-8f44-707005c011e1",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[226523, 5865, 22004, 539, 746, "Input",ExpressionUUID->"578f3ec1-fd7e-4c07-a430-5606f624cb90",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[248600, 6412, 250, 5, 60, "Title",ExpressionUUID->"a1ac207f-e5a6-41ed-9016-23014b2a6c3e",
   CellTags->"Number-of-events-computation"],
  Cell[248875, 6421, 201, 4, 58, "Chapter",ExpressionUUID->"61d66c6b-87da-4009-946a-eb32cc005fd8",
   CellTags->"Number-of-events-computation"],
  Cell[249079, 6427, 7783, 177, 241, "Input",ExpressionUUID->"5ff1e429-21ed-463f-b582-04b4f7f4c30e",
   CellTags->"Number-of-events-computation"],
  Cell[256899, 6609, 197, 4, 58, "Chapter",ExpressionUUID->"3571b874-ffa9-4bf5-a75b-14b08106cae0",
   CellTags->"Number-of-events-computation"],
  Cell[257121, 6617, 209, 4, 57, "Section",ExpressionUUID->"6157032c-d8f6-4db5-8885-6bf21d753311",
   CellTags->"Number-of-events-computation"],
  Cell[257333, 6623, 3086, 70, 110, "Input",ExpressionUUID->"21d68c5f-eca8-499e-a5b2-08a9c8442c01",
   CellTags->"Number-of-events-computation"],
  Cell[260456, 6698, 555, 13, 56, "Section",ExpressionUUID->"67c3a9ce-3831-457a-bfdc-b3e2a4654e55",
   CellTags->"Number-of-events-computation"],
  Cell[261014, 6713, 1156, 20, 31, "Input",ExpressionUUID->"ce01b419-cf2c-4c5f-8aad-987fa7f41f9a",
   CellTags->"Number-of-events-computation"],
  Cell[262207, 6738, 453, 12, 56, "Section",ExpressionUUID->"95e10647-a125-4457-b20b-acc022c5f509",
   CellTags->"Number-of-events-computation"],
  Cell[262663, 6752, 1161, 20, 31, "Input",ExpressionUUID->"4fec21df-68ee-4cf7-ad04-909d4e80d502",
   CellTags->"Number-of-events-computation"],
  Cell[263861, 6777, 305, 6, 56, "Section",ExpressionUUID->"d5df9731-bc1b-4471-8536-fa76f74dac0f",
   CellTags->"Number-of-events-computation"],
  Cell[264169, 6785, 1135, 19, 30, "Input",ExpressionUUID->"5a1e6ae7-cc6d-4e39-b940-855e7e35cdad",
   CellTags->"Number-of-events-computation"],
  Cell[265341, 6809, 372, 6, 56, "Section",ExpressionUUID->"48ddb432-3f82-45a9-8b84-e86b62718462",
   CellTags->"Number-of-events-computation"],
  Cell[265716, 6817, 1114, 19, 30, "Input",ExpressionUUID->"a2a0d763-995a-4dd4-9fc0-df16bd9e955d",
   CellTags->"Number-of-events-computation"],
  Cell[266867, 6841, 403, 7, 56, "Section",ExpressionUUID->"1c9fd3fb-1050-4e85-9a0b-1fa291d47cd6",
   CellTags->"Number-of-events-computation"],
  Cell[267273, 6850, 1263, 21, 30, "Input",ExpressionUUID->"9fdd32e4-d27c-49b7-af8c-f818af931c46",
   CellTags->"Number-of-events-computation"],
  Cell[268573, 6876, 410, 7, 56, "Section",ExpressionUUID->"04db8acd-a715-451b-b0ae-f8b59d430652",
   CellTags->"Number-of-events-computation"],
  Cell[268986, 6885, 1164, 19, 30, "Input",ExpressionUUID->"600c6fe1-2ef5-41a1-b16a-f9e9d5dfbea8",
   CellTags->"Number-of-events-computation"]},
 "Acceptance-computation"->{
  Cell[84768, 2213, 318, 6, 58, "Chapter",ExpressionUUID->"ddc91657-c605-432a-9fc4-3dde27689d78",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[85089, 2221, 19683, 540, 627, "Input",ExpressionUUID->"c815bc21-895a-435e-aff8-c368c51a223c",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[104809, 2766, 529, 10, 58, "Chapter",ExpressionUUID->"2ed58b5e-8fa1-4a99-b81c-130884bcdd21",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[105363, 2780, 366, 7, 57, "Section",ExpressionUUID->"55cf97a8-2660-4bce-8ec9-801bafbdf76d",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[105732, 2789, 3914, 84, 190, "Input",ExpressionUUID->"af91a4df-a2ec-4b76-bfe7-3122355d5590",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[109671, 2877, 248, 5, 47, "Subsection",ExpressionUUID->"3b43ff78-6b27-4d93-8d69-7457f7f8823d",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[109922, 2884, 17069, 411, 535, "Input",ExpressionUUID->"e8ddb45b-231e-400d-974f-cb861da64a22",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[127028, 3300, 402, 9, 47, "Subsection",ExpressionUUID->"22ffb09d-98a8-4018-9b26-5bfadc5fccbf",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[127455, 3313, 245, 5, 41, "Subsubsection",ExpressionUUID->"b3bb358f-768a-4cd2-936b-b61d6286a090",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[127703, 3320, 23149, 591, 790, "Input",ExpressionUUID->"6f1ecfca-b2fe-44c8-9fcb-1de7cdd8ce3f",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[151156, 3927, 233, 5, 57, "Section",ExpressionUUID->"68daae27-7916-4d9f-a181-f066d67e7be0",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[151414, 3936, 291, 7, 47, "Subsection",ExpressionUUID->"5a85d544-e222-4878-87a8-16fd1115b839",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[151708, 3945, 7967, 205, 270, "Input",ExpressionUUID->"a999801b-4af3-48e9-bd7e-95cbd498c6f8",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[159712, 4155, 276, 5, 47, "Subsection",ExpressionUUID->"dc4d258a-ca7c-48f8-bc68-6be533f45606",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[159991, 4162, 9278, 236, 302, "Input",ExpressionUUID->"6982155e-eb67-495b-9a74-1dfcf048e12e",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[169306, 4403, 351, 8, 47, "Subsection",ExpressionUUID->"4bbfd4ad-0dbb-42ad-a426-cfa4593e7d57",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[169682, 4415, 266, 5, 41, "Subsubsection",ExpressionUUID->"9350f1c3-4778-446f-80c2-31578787738f",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[169951, 4422, 6614, 164, 250, "Input",ExpressionUUID->"fec2328c-aa8e-45e6-8323-89ae3498b643",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[176602, 4591, 320, 6, 41, "Subsubsection",ExpressionUUID->"07e1398b-55a6-4584-9db1-8ded1597ad00",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[176925, 4599, 6067, 143, 269, "Input",ExpressionUUID->"58c1c9cd-b2f5-442a-aa55-288aa984498e",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[183029, 4747, 267, 6, 41, "Subsubsection",ExpressionUUID->"7abc004f-a596-41a0-9974-219f078bc882",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[183299, 4755, 3686, 82, 218, "Input",ExpressionUUID->"8a1d99e1-8129-4e5f-84b9-bd3ff6e17d62",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[187046, 4844, 333, 6, 57, "Section",ExpressionUUID->"7f303373-a91f-430d-bd69-5249c59f8cfa",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[187382, 4852, 14585, 385, 413, "Input",ExpressionUUID->"28070fdc-8c7b-4215-94a0-9195dd83b024",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[201992, 5241, 272, 5, 47, "Subsection",ExpressionUUID->"5adffa0c-150d-49d1-8d5e-53caedcf3659",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[202289, 5250, 237, 5, 41, "Subsubsection",ExpressionUUID->"34e7996e-ffbd-4a92-b3b5-708f8d233cc2",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[202529, 5257, 4360, 108, 149, "Input",ExpressionUUID->"61a3cf61-d225-4195-ab78-5788d51c5fe9",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[206950, 5372, 238, 5, 57, "Section",ExpressionUUID->"1c44fb56-7762-45b2-b4f1-3556bfde7421",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[207213, 5381, 301, 6, 47, "Subsection",ExpressionUUID->"e906f49a-dcac-4b39-8dec-c71b00fa5f2f",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[207517, 5389, 4706, 110, 150, "Input",ExpressionUUID->"8cc8fcdc-3b33-4eb1-986e-54fe01ca34ba",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[212260, 5504, 374, 9, 47, "Subsection",ExpressionUUID->"c02af3c5-8f31-400a-82e3-8dd1592306bb",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[212637, 5515, 5086, 127, 152, "Input",ExpressionUUID->"94d33319-31fb-4aed-b35e-3114388a6018",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[217748, 5646, 234, 5, 41, "Subsubsection",ExpressionUUID->"7c82576d-ab0c-46c5-a37e-96b578377518",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[217985, 5653, 8234, 199, 206, "Input",ExpressionUUID->"4d36b0fa-dabe-4974-aeae-a552b3a7122e",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[226268, 5858, 252, 5, 46, "Subsection",ExpressionUUID->"f4242749-52ce-4980-8f44-707005c011e1",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[226523, 5865, 22004, 539, 746, "Input",ExpressionUUID->"578f3ec1-fd7e-4c07-a430-5606f624cb90",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}]},
 "Sensitivity"->{
  Cell[270211, 6911, 212, 4, 60, "Title",ExpressionUUID->"20138663-2b9a-41fa-8718-2e1c02355f2d",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[270448, 6919, 325, 7, 58, "Chapter",ExpressionUUID->"8558a057-a38a-454c-bfce-bde3419e907e",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[270776, 6928, 16127, 438, 609, "Input",ExpressionUUID->"c04809c2-412f-4207-902a-ca107db71530",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[286928, 7370, 264, 5, 57, "Section",ExpressionUUID->"a59ae6cb-9828-417c-bdd1-fff95cb38e4f",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[287195, 7377, 4802, 118, 130, "Input",ExpressionUUID->"dfa47edf-f1da-4b2e-b4e4-0bdbee1c1674",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[292046, 7501, 219, 4, 58, "Chapter",ExpressionUUID->"9c16447c-2de4-4d99-8ecb-12fee2a44330",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[292268, 7507, 12520, 322, 437, "Input",ExpressionUUID->"140a9c48-3c60-400f-bb3d-41932b0b01fa",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[304837, 7835, 218, 4, 77, "Title",ExpressionUUID->"ffb96111-011a-40fa-9682-858963d62183",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[305058, 7841, 2633, 66, 163, "Input",ExpressionUUID->"f52ba2e2-b5c4-48a5-92ca-6113d843928f",
   CellTags->{"Sensitivity", "Re-evaluation"}]},
 "Re-evaluation"->{
  Cell[270211, 6911, 212, 4, 60, "Title",ExpressionUUID->"20138663-2b9a-41fa-8718-2e1c02355f2d",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[270448, 6919, 325, 7, 58, "Chapter",ExpressionUUID->"8558a057-a38a-454c-bfce-bde3419e907e",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[270776, 6928, 16127, 438, 609, "Input",ExpressionUUID->"c04809c2-412f-4207-902a-ca107db71530",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[286928, 7370, 264, 5, 57, "Section",ExpressionUUID->"a59ae6cb-9828-417c-bdd1-fff95cb38e4f",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[287195, 7377, 4802, 118, 130, "Input",ExpressionUUID->"dfa47edf-f1da-4b2e-b4e4-0bdbee1c1674",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[292046, 7501, 219, 4, 58, "Chapter",ExpressionUUID->"9c16447c-2de4-4d99-8ecb-12fee2a44330",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[292268, 7507, 12520, 322, 437, "Input",ExpressionUUID->"140a9c48-3c60-400f-bb3d-41932b0b01fa",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[304837, 7835, 218, 4, 77, "Title",ExpressionUUID->"ffb96111-011a-40fa-9682-858963d62183",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[305058, 7841, 2633, 66, 163, "Input",ExpressionUUID->"f52ba2e2-b5c4-48a5-92ca-6113d843928f",
   CellTags->{"Sensitivity", "Re-evaluation"}]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Number-of-events", 308120, 7923},
 {"Acceptance", 311865, 7974},
 {"Number-of-events-computation", 315628, 8025},
 {"Acceptance-computation", 324881, 8138},
 {"Sensitivity", 331223, 8211},
 {"Re-evaluation", 332572, 8230}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 207, 3, 68, "Title",ExpressionUUID->"cc091cd5-168d-44d1-9a83-ebb576c10ceb"],
Cell[790, 27, 4785, 124, 273, "Input",ExpressionUUID->"c8a7c6bd-754e-4c81-b344-1b6f8cd06de4"]
}, Closed]],
Cell[CellGroupData[{
Cell[5612, 156, 303, 6, 60, "Title",ExpressionUUID->"294691d8-aa8b-4eec-b72c-7eddbed8edd7",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[CellGroupData[{
Cell[5940, 166, 234, 5, 58, "Chapter",ExpressionUUID->"cf63fabc-7a3b-4498-8bf8-f69a301f20dc",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[6177, 173, 5581, 158, 421, "Input",ExpressionUUID->"2c1cafc9-37d9-434e-bd2d-c0787bc6f55b",
 CellTags->{"Number-of-events", "Acceptance"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[11795, 336, 314, 6, 58, "Chapter",ExpressionUUID->"bfd36837-c4ed-4fec-ab58-b1be4facaa6c",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[CellGroupData[{
Cell[12134, 346, 200, 4, 57, "Section",ExpressionUUID->"04c8f572-467e-4c76-8fac-f5585da995c8",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[12337, 352, 3106, 79, 175, "Input",ExpressionUUID->"bfe2aed5-8f0a-4cad-a1aa-1740c3919a79",
 CellTags->{"Number-of-events", "Acceptance"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[15480, 436, 322, 6, 57, "Section",ExpressionUUID->"2c3557ed-dc43-425a-be83-789280bbdf3c",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[CellGroupData[{
Cell[15827, 446, 215, 4, 47, "Subsection",ExpressionUUID->"34cdd10a-d410-4f6f-bbdd-1d6a49f550a0",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[CellGroupData[{
Cell[16067, 454, 291, 5, 41, "Subsubsection",ExpressionUUID->"0b267ea5-8acf-426c-a2cd-fec2eaa31b1c",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[16361, 461, 8014, 202, 269, "Input",ExpressionUUID->"70094ca6-e1b1-4123-80be-219218a54741",
 CellTags->{"Number-of-events", "Acceptance"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[24412, 668, 228, 4, 39, "Subsubsection",ExpressionUUID->"47c3ab2a-08a9-4007-8ead-36f50d19083d",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[24643, 674, 22212, 553, 864, "Input",ExpressionUUID->"c1395d61-d1ed-44b4-bbe7-2f9e2a4dd415",
 CellTags->{"Number-of-events", "Acceptance"}]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[46904, 1233, 277, 6, 46, "Subsection",ExpressionUUID->"4b291a99-120b-4b0b-a595-06d4e5a109b7",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[47184, 1241, 6148, 167, 203, "Input",ExpressionUUID->"fb6fcf97-f707-4a92-8ec2-ca831fac76d4",
 CellTags->{"Number-of-events", "Acceptance"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[53369, 1413, 208, 4, 46, "Subsection",ExpressionUUID->"dbb5e9a1-011b-4ae3-aff9-607e768d7cdb",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[53580, 1419, 5789, 141, 215, "Input",ExpressionUUID->"ffe4bd1e-17f5-479f-b654-d839b1f344d7",
 CellTags->{"Number-of-events", "Acceptance"}]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[59430, 1567, 265, 6, 58, "Chapter",ExpressionUUID->"0fddb25a-a632-4751-8775-41d96137bd6d",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[CellGroupData[{
Cell[59720, 1577, 259, 5, 47, "Subsection",ExpressionUUID->"a880651e-1eca-4b4f-b7f3-77b0def9580f",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[59982, 1584, 7671, 183, 204, "Input",ExpressionUUID->"c206a552-6f39-4b30-8dc8-af7ceee53d27",
 CellTags->{"Number-of-events", "Acceptance"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[67690, 1772, 260, 5, 47, "Subsection",ExpressionUUID->"aaabee25-6353-4c34-9850-c513e840a7f9",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[67953, 1779, 7524, 181, 204, "Input",ExpressionUUID->"d62d583a-710d-4b99-ab03-5766ac554b05",
 CellTags->{"Number-of-events", "Acceptance"}]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[75538, 1967, 221, 4, 60, "Title",ExpressionUUID->"6bf41310-9786-4a2d-9c45-da72c297facc",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[75762, 1973, 6545, 169, 310, "Input",ExpressionUUID->"14cf246a-dfe6-4f84-bced-6779a027f776",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[CellGroupData[{
Cell[82332, 2146, 224, 4, 58, "Chapter",ExpressionUUID->"bf5cb1ca-586b-421c-9b8f-bcdda79a4c7d",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[82559, 2152, 1931, 47, 217, "Input",ExpressionUUID->"8ccbe0c0-5799-4a13-b89d-58d5d3aa1550",
 CellTags->{"Number-of-events", "Acceptance"}]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[84539, 2205, 204, 4, 60, "Title",ExpressionUUID->"ec7d1ed4-b833-4ca9-b86b-68ef0bdfdc5e",
 CellTags->"Number-of-events-computation"],
Cell[CellGroupData[{
Cell[84768, 2213, 318, 6, 58, "Chapter",ExpressionUUID->"ddc91657-c605-432a-9fc4-3dde27689d78",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[85089, 2221, 19683, 540, 627, "Input",ExpressionUUID->"c815bc21-895a-435e-aff8-c368c51a223c",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[104809, 2766, 529, 10, 58, "Chapter",ExpressionUUID->"2ed58b5e-8fa1-4a99-b81c-130884bcdd21",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[105363, 2780, 366, 7, 57, "Section",ExpressionUUID->"55cf97a8-2660-4bce-8ec9-801bafbdf76d",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[105732, 2789, 3914, 84, 190, "Input",ExpressionUUID->"af91a4df-a2ec-4b76-bfe7-3122355d5590",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[109671, 2877, 248, 5, 47, "Subsection",ExpressionUUID->"3b43ff78-6b27-4d93-8d69-7457f7f8823d",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[109922, 2884, 17069, 411, 535, "Input",ExpressionUUID->"e8ddb45b-231e-400d-974f-cb861da64a22",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[127028, 3300, 402, 9, 47, "Subsection",ExpressionUUID->"22ffb09d-98a8-4018-9b26-5bfadc5fccbf",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[127455, 3313, 245, 5, 41, "Subsubsection",ExpressionUUID->"b3bb358f-768a-4cd2-936b-b61d6286a090",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[127703, 3320, 23149, 591, 790, "Input",ExpressionUUID->"6f1ecfca-b2fe-44c8-9fcb-1de7cdd8ce3f",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[150925, 3919, 206, 4, 58, "Chapter",ExpressionUUID->"0f308b41-d607-4d23-bea6-f98cdbbab013",
 CellTags->"Number-of-events-computation"],
Cell[CellGroupData[{
Cell[151156, 3927, 233, 5, 57, "Section",ExpressionUUID->"68daae27-7916-4d9f-a181-f066d67e7be0",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[151414, 3936, 291, 7, 47, "Subsection",ExpressionUUID->"5a85d544-e222-4878-87a8-16fd1115b839",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[151708, 3945, 7967, 205, 270, "Input",ExpressionUUID->"a999801b-4af3-48e9-bd7e-95cbd498c6f8",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[159712, 4155, 276, 5, 47, "Subsection",ExpressionUUID->"dc4d258a-ca7c-48f8-bc68-6be533f45606",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[159991, 4162, 9278, 236, 302, "Input",ExpressionUUID->"6982155e-eb67-495b-9a74-1dfcf048e12e",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[169306, 4403, 351, 8, 47, "Subsection",ExpressionUUID->"4bbfd4ad-0dbb-42ad-a426-cfa4593e7d57",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[169682, 4415, 266, 5, 41, "Subsubsection",ExpressionUUID->"9350f1c3-4778-446f-80c2-31578787738f",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[169951, 4422, 6614, 164, 250, "Input",ExpressionUUID->"fec2328c-aa8e-45e6-8323-89ae3498b643",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[176602, 4591, 320, 6, 41, "Subsubsection",ExpressionUUID->"07e1398b-55a6-4584-9db1-8ded1597ad00",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[176925, 4599, 6067, 143, 269, "Input",ExpressionUUID->"58c1c9cd-b2f5-442a-aa55-288aa984498e",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[183029, 4747, 267, 6, 41, "Subsubsection",ExpressionUUID->"7abc004f-a596-41a0-9974-219f078bc882",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[183299, 4755, 3686, 82, 218, "Input",ExpressionUUID->"8a1d99e1-8129-4e5f-84b9-bd3ff6e17d62",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[187046, 4844, 333, 6, 57, "Section",ExpressionUUID->"7f303373-a91f-430d-bd69-5249c59f8cfa",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[187382, 4852, 14585, 385, 413, "Input",ExpressionUUID->"28070fdc-8c7b-4215-94a0-9195dd83b024",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[201992, 5241, 272, 5, 47, "Subsection",ExpressionUUID->"5adffa0c-150d-49d1-8d5e-53caedcf3659",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[202289, 5250, 237, 5, 41, "Subsubsection",ExpressionUUID->"34e7996e-ffbd-4a92-b3b5-708f8d233cc2",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[202529, 5257, 4360, 108, 149, "Input",ExpressionUUID->"61a3cf61-d225-4195-ab78-5788d51c5fe9",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[206950, 5372, 238, 5, 57, "Section",ExpressionUUID->"1c44fb56-7762-45b2-b4f1-3556bfde7421",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[207213, 5381, 301, 6, 47, "Subsection",ExpressionUUID->"e906f49a-dcac-4b39-8dec-c71b00fa5f2f",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[207517, 5389, 4706, 110, 150, "Input",ExpressionUUID->"8cc8fcdc-3b33-4eb1-986e-54fe01ca34ba",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[212260, 5504, 374, 9, 47, "Subsection",ExpressionUUID->"c02af3c5-8f31-400a-82e3-8dd1592306bb",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[212637, 5515, 5086, 127, 152, "Input",ExpressionUUID->"94d33319-31fb-4aed-b35e-3114388a6018",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[217748, 5646, 234, 5, 41, "Subsubsection",ExpressionUUID->"7c82576d-ab0c-46c5-a37e-96b578377518",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[217985, 5653, 8234, 199, 206, "Input",ExpressionUUID->"4d36b0fa-dabe-4974-aeae-a552b3a7122e",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[226268, 5858, 252, 5, 46, "Subsection",ExpressionUUID->"f4242749-52ce-4980-8f44-707005c011e1",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[226523, 5865, 22004, 539, 746, "Input",ExpressionUUID->"578f3ec1-fd7e-4c07-a430-5606f624cb90",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[248600, 6412, 250, 5, 60, "Title",ExpressionUUID->"a1ac207f-e5a6-41ed-9016-23014b2a6c3e",
 CellTags->"Number-of-events-computation"],
Cell[CellGroupData[{
Cell[248875, 6421, 201, 4, 58, "Chapter",ExpressionUUID->"61d66c6b-87da-4009-946a-eb32cc005fd8",
 CellTags->"Number-of-events-computation"],
Cell[249079, 6427, 7783, 177, 241, "Input",ExpressionUUID->"5ff1e429-21ed-463f-b582-04b4f7f4c30e",
 CellTags->"Number-of-events-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[256899, 6609, 197, 4, 58, "Chapter",ExpressionUUID->"3571b874-ffa9-4bf5-a75b-14b08106cae0",
 CellTags->"Number-of-events-computation"],
Cell[CellGroupData[{
Cell[257121, 6617, 209, 4, 57, "Section",ExpressionUUID->"6157032c-d8f6-4db5-8885-6bf21d753311",
 CellTags->"Number-of-events-computation"],
Cell[257333, 6623, 3086, 70, 110, "Input",ExpressionUUID->"21d68c5f-eca8-499e-a5b2-08a9c8442c01",
 CellTags->"Number-of-events-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[260456, 6698, 555, 13, 56, "Section",ExpressionUUID->"67c3a9ce-3831-457a-bfdc-b3e2a4654e55",
 CellTags->"Number-of-events-computation"],
Cell[261014, 6713, 1156, 20, 31, "Input",ExpressionUUID->"ce01b419-cf2c-4c5f-8aad-987fa7f41f9a",
 CellTags->"Number-of-events-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[262207, 6738, 453, 12, 56, "Section",ExpressionUUID->"95e10647-a125-4457-b20b-acc022c5f509",
 CellTags->"Number-of-events-computation"],
Cell[262663, 6752, 1161, 20, 31, "Input",ExpressionUUID->"4fec21df-68ee-4cf7-ad04-909d4e80d502",
 CellTags->"Number-of-events-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[263861, 6777, 305, 6, 56, "Section",ExpressionUUID->"d5df9731-bc1b-4471-8536-fa76f74dac0f",
 CellTags->"Number-of-events-computation"],
Cell[264169, 6785, 1135, 19, 30, "Input",ExpressionUUID->"5a1e6ae7-cc6d-4e39-b940-855e7e35cdad",
 CellTags->"Number-of-events-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[265341, 6809, 372, 6, 56, "Section",ExpressionUUID->"48ddb432-3f82-45a9-8b84-e86b62718462",
 CellTags->"Number-of-events-computation"],
Cell[265716, 6817, 1114, 19, 30, "Input",ExpressionUUID->"a2a0d763-995a-4dd4-9fc0-df16bd9e955d",
 CellTags->"Number-of-events-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[266867, 6841, 403, 7, 56, "Section",ExpressionUUID->"1c9fd3fb-1050-4e85-9a0b-1fa291d47cd6",
 CellTags->"Number-of-events-computation"],
Cell[267273, 6850, 1263, 21, 30, "Input",ExpressionUUID->"9fdd32e4-d27c-49b7-af8c-f818af931c46",
 CellTags->"Number-of-events-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[268573, 6876, 410, 7, 56, "Section",ExpressionUUID->"04db8acd-a715-451b-b0ae-f8b59d430652",
 CellTags->"Number-of-events-computation"],
Cell[268986, 6885, 1164, 19, 30, "Input",ExpressionUUID->"600c6fe1-2ef5-41a1-b16a-f9e9d5dfbea8",
 CellTags->"Number-of-events-computation"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[270211, 6911, 212, 4, 60, "Title",ExpressionUUID->"20138663-2b9a-41fa-8718-2e1c02355f2d",
 CellTags->{"Sensitivity", "Re-evaluation"}],
Cell[CellGroupData[{
Cell[270448, 6919, 325, 7, 58, "Chapter",ExpressionUUID->"8558a057-a38a-454c-bfce-bde3419e907e",
 CellTags->{"Sensitivity", "Re-evaluation"}],
Cell[270776, 6928, 16127, 438, 609, "Input",ExpressionUUID->"c04809c2-412f-4207-902a-ca107db71530",
 CellTags->{"Sensitivity", "Re-evaluation"}],
Cell[CellGroupData[{
Cell[286928, 7370, 264, 5, 57, "Section",ExpressionUUID->"a59ae6cb-9828-417c-bdd1-fff95cb38e4f",
 CellTags->{"Sensitivity", "Re-evaluation"}],
Cell[287195, 7377, 4802, 118, 130, "Input",ExpressionUUID->"dfa47edf-f1da-4b2e-b4e4-0bdbee1c1674",
 CellTags->{"Sensitivity", "Re-evaluation"}]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[292046, 7501, 219, 4, 58, "Chapter",ExpressionUUID->"9c16447c-2de4-4d99-8ecb-12fee2a44330",
 CellTags->{"Sensitivity", "Re-evaluation"}],
Cell[292268, 7507, 12520, 322, 437, "Input",ExpressionUUID->"140a9c48-3c60-400f-bb3d-41932b0b01fa",
 CellTags->{"Sensitivity", "Re-evaluation"}]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[304837, 7835, 218, 4, 77, "Title",ExpressionUUID->"ffb96111-011a-40fa-9682-858963d62183",
 CellTags->{"Sensitivity", "Re-evaluation"}],
Cell[305058, 7841, 2633, 66, 163, "Input",ExpressionUUID->"f52ba2e2-b5c4-48a5-92ca-6113d843928f",
 CellTags->{"Sensitivity", "Re-evaluation"}]
}, Open  ]]
}
]
*)

