(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    376398,       9151]
NotebookOptionsPosition[    329529,       8429]
NotebookOutlinePosition[    358535,       8819]
CellTagsIndexPosition[    358265,       8809]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Just launch the code below to run the notebook (shift+enter)", "Title",
 CellChangeTimes->{{3.8934376452895875`*^9, 
  3.8934376644509068`*^9}},ExpressionUUID->"81e378d2-3dbb-467e-88a3-\
3d73d3bd8f3c"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BlockEvaluation", "[", "tag_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nb", "=", 
      RowBox[{"EvaluationNotebook", "[", "]"}]}], ";", "\n", 
     RowBox[{"NotebookFind", "[", 
      RowBox[{"nb", ",", "tag", ",", "All", ",", "CellTags"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"infoDialog", "[", "phrase_", "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<Proceed\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DirectoryQ", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<Auxiliary data\>\""}], "}"}], "]"}], "]"}], "//", 
       "ToString"}], ")"}], "\[Equal]", "\"\<False\>\""}], ",", 
    RowBox[{"CreateDirectory", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<Auxiliary data\>\""}], "}"}], "]"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DirectoryQ", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<Auxiliary data/Scalars\>\""}], "}"}], "]"}], "]"}], "//", 
       "ToString"}], ")"}], "\[Equal]", "\"\<False\>\""}], ",", 
    RowBox[{"CreateDirectory", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<Auxiliary data/Scalars\>\""}], "}"}], "]"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"choiceslist", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<Acceptance\>\"", ",", "\"\<Tabulated number of events\>\"", ",", 
     "\"\<Sensitivity\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"taglist", "[", "\"\<Acceptance\>\"", "]"}], "=", 
   "\"\<Acceptance\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"taglist", "[", "\"\<Tabulated number of events\>\"", "]"}], "=", 
   "\"\<Number-of-events\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"taglist", "[", "\"\<Sensitivity\>\"", "]"}], "=", 
   "\"\<Sensitivity\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"computationchoice", "=", 
   RowBox[{"dropdownDialog", "[", 
    RowBox[{
    "choiceslist", ",", 
     "\"\<Do you want to compute acceptance, tabulated number of events, or \
sensitivity (if the tabulated number of events has been already \
produced)?\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"tagselected", "=", 
  RowBox[{"taglist", "[", "computationchoice", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"BlockEvaluation", "[", "tagselected", "]"}]}], "Input",
 CellChangeTimes->{{3.893437585709897*^9, 3.8934375895369635`*^9}, {
   3.8934376329497385`*^9, 3.893437658846809*^9}, {3.8935727521376963`*^9, 
   3.893572934736693*^9}, {3.893572994500379*^9, 3.8935729949911523`*^9}, {
   3.893665375102826*^9, 3.893665376076692*^9}, {3.8950545750556335`*^9, 
   3.895054575228654*^9}, {3.895127153564183*^9, 3.895127164693226*^9}, {
   3.897018713087062*^9, 3.8970187140160637`*^9}, 3.9025631680253534`*^9, 
   3.9027295491093626`*^9, {3.902973838262621*^9, 3.9029738915629826`*^9}, {
   3.902975133619383*^9, 3.902975143436801*^9}, {3.90302115808084*^9, 
   3.9030211591531773`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"b0400bb0-bd38-4283-9a8f-ce5e9e655d1b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Preliminary definitions", "Title",
 CellChangeTimes->{{3.7552434949579296`*^9, 3.755243495237189*^9}, {
  3.88501652694691*^9, 3.885016532955313*^9}, {3.8850204805201235`*^9, 
  3.885020485584347*^9}, {3.8934405078912735`*^9, 3.893440508511178*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"c7fbc496-1765-4913-bda1-eb19f9d14ec4"],

Cell[CellGroupData[{

Cell["Parameters and various functions", "Chapter",
 CellChangeTimes->{{3.8846619009140606`*^9, 3.884661902476644*^9}, {
  3.885017296053095*^9, 3.8850172996856313`*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"97514d5d-099d-448e-a17b-84a2592457d1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"infoDialog", "[", "phrase_", "]"}], ":=", 
   RowBox[{"DialogInput", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
     RowBox[{"Column", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
        RowBox[{"Button", "[", 
         RowBox[{"\"\<Proceed\>\"", ",", 
          RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
      "]"}]}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", "chbar", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"chbar", "=", " ", 
    RowBox[{"6.6", "*", 
     SuperscriptBox["10", 
      RowBox[{"-", "25"}]], "*", "3", "*", 
     SuperscriptBox["10", "8"]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Masses", " ", "of", " ", "various", " ", "SM", " ", "particles"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mB", "=", "5.3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mK", "=", "0.495"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m\[Pi]", "=", "0.14"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mh", "=", "125"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mBs", "=", "5.366"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fragmentation", " ", "fractions", " ", "at", " ", "the", " ", "LHC"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fbtob0LHC", "=", 
   RowBox[{"fbtobplusLHC", "=", "0.324"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fbtobsLHC", "=", "0.09"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fstoK0L", "=", 
   FractionBox["1", "4"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fstoKcharged", "=", 
    FractionBox["1", "2"]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fragmentation", " ", "fractions", " ", "at", " ", "SPS"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fbtobsSPS", "=", "0.11"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fbtob0SPS", "=", 
   RowBox[{"fbtobplusSPS", "=", "0.411"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fstokplusSPS", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Fraction", " ", "of", " ", 
      SuperscriptBox["K", 
       RowBox[{"+", 
        RowBox[{"/", "-"}]}]], " ", "decaying", " ", "in"}], "-", "flight"}], 
    ",", " ", 
    RowBox[{
     RowBox[{"from", " ", 
      RowBox[{"https", ":"}]}], "//", 
     RowBox[{
      RowBox[{
       RowBox[{"arxiv", ".", "org"}], "/", "pdf"}], "/", 
      RowBox[{"2004.07974", ".", "pdf"}]}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fractionDecayInFlightKplusKminus", "=", 
    RowBox[{"(", 
     RowBox[{"0.29", "+", "0.07"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fragmentation", " ", "fractions", " ", "at", " ", 
    RowBox[{"FermilabBD", ".", " ", "Assumed"}], " ", "to", " ", "be", " ", 
    "the", " ", "same", " ", "as", " ", "at", " ", "SPS"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fbtobsFermilabBD", "=", "0.11"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fbtob0FermilabBD", "=", 
   RowBox[{"fbtobplusFermilabBD", "=", "0.411"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.884661904994011*^9, 3.884661921540403*^9}, {
   3.8850164522887964`*^9, 3.8850165245568185`*^9}, {3.885016628097911*^9, 
   3.8850166282886553`*^9}, 3.885016710182028*^9, {3.8850167568987885`*^9, 
   3.885016762395402*^9}, {3.885016799450395*^9, 3.8850170557864246`*^9}, {
   3.88501712653312*^9, 3.885017216885895*^9}, {3.8850173024453783`*^9, 
   3.8850173372383676`*^9}, {3.885017399572728*^9, 3.88501741270778*^9}, {
   3.8850174625354366`*^9, 3.885017462658634*^9}, {3.8850175591211877`*^9, 
   3.8850175593408356`*^9}, {3.8850182535473127`*^9, 
   3.8850182538962827`*^9}, {3.885018314394388*^9, 3.885018333197164*^9}, {
   3.8850189741121674`*^9, 3.885018974433589*^9}, 3.8850190966970725`*^9, {
   3.885019721482507*^9, 3.8850197654258046`*^9}, {3.885019828534438*^9, 
   3.8850198661946564`*^9}, {3.88501995528426*^9, 3.8850201480526233`*^9}, {
   3.885020185062007*^9, 3.8850201894992275`*^9}, {3.885020291896063*^9, 
   3.8850203335305076`*^9}, {3.885020432284384*^9, 3.8850204475138783`*^9}, {
   3.8850205949824495`*^9, 3.885020600587699*^9}, {3.8850212843213625`*^9, 
   3.88502132833275*^9}, {3.885032891250867*^9, 3.8850329826946216`*^9}, {
   3.885033159126209*^9, 3.885033161690289*^9}, {3.8850331946913424`*^9, 
   3.8850331954065113`*^9}, {3.8850336204217644`*^9, 
   3.8850336226032686`*^9}, {3.8850342557191987`*^9, 
   3.8850344920061417`*^9}, {3.8850345924696712`*^9, 3.885034596199212*^9}, {
   3.885137383509305*^9, 3.8851374066552467`*^9}, {3.8851374685027866`*^9, 
   3.8851376554160604`*^9}, {3.885137692569293*^9, 3.885137784659045*^9}, {
   3.8851378255007744`*^9, 3.885137825675703*^9}, {3.8851383907242584`*^9, 
   3.885138392478346*^9}, {3.88513944801902*^9, 3.8851394797221875`*^9}, {
   3.885139512250944*^9, 3.8851395456971464`*^9}, {3.8851395939313083`*^9, 
   3.885139596117799*^9}, {3.8859764206391745`*^9, 3.885976438621937*^9}, {
   3.8881384662949567`*^9, 3.8881385011782107`*^9}, {3.8881385497266254`*^9, 
   3.8881385892982264`*^9}, 3.888162759745373*^9, {3.888430724859106*^9, 
   3.888430733451372*^9}, {3.888510049921257*^9, 3.8885100500603347`*^9}, {
   3.888637625428524*^9, 3.888637643603036*^9}, {3.8886376979831305`*^9, 
   3.888637705729134*^9}, {3.88863784662792*^9, 3.888637912746587*^9}, 
   3.8886379501603055`*^9, {3.888637987395543*^9, 3.8886380916687765`*^9}, {
   3.8902769434872622`*^9, 3.8902769611893024`*^9}, {3.8935210002811346`*^9, 
   3.8935210002955985`*^9}, {3.895646311702941*^9, 3.8956463123999825`*^9}, {
   3.8991936135192137`*^9, 3.8991936147267494`*^9}, {3.899198002579852*^9, 
   3.8991980027216363`*^9}},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->"In[14]:=",ExpressionUUID->"a1657428-e7cb-44c0-bafb-5a2d37d2b79c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Scalar phenomenology", "Chapter",
 CellChangeTimes->{{3.8851378652235947`*^9, 3.885137868355297*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"8348c717-8fb9-4ff9-be33-c78045c51d6d"],

Cell[CellGroupData[{

Cell["Proton bremsstrahlung probability", "Section",
 CellChangeTimes->{{3.8939478984441977`*^9, 3.8939479043443727`*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"cc2312ac-4e04-4612-9e6b-593fe31948b9"],

Cell[CellGroupData[{

Cell["Various parameters", "Subsection",
 CellChangeTimes->{{3.893948024186832*^9, 3.8939480267447023`*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"346ee184-7723-44c1-b589-5bb27d0a63ef"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MP", "=", "0.938"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Scalar", "-", 
    RowBox[{"nucleon", " ", "low"}], "-", 
    RowBox[{"energy", " ", "coupling"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GSNN", "=", 
    RowBox[{"1.2", "*", 
     SuperscriptBox["10", 
      RowBox[{"-", "3"}]]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Fit", " ", "for", " ", "the", " ", "pp", " ", "total", " ", "cross"}], 
    "-", 
    RowBox[{
    "section", " ", "in", " ", "mb", " ", "in", " ", "terms", " ", "of", " ", 
     "invariant", " ", "mass", " ", "s"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Zfit", "=", "35.45"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Bfit", "=", "0.308"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Y1fit", "=", "42.53"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Y2fit", "=", "33.34"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s0fit", "=", 
   SuperscriptBox["5.38", "2"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1fit", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Eta]1fit", "=", "0.458"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Eta]2fit", "=", "0.545"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S", "[", 
    RowBox[{"Pp_", ",", "mp_"}], "]"}], "=", 
   RowBox[{"2", "*", "Pp", "*", "mp"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sprime", "[", 
    RowBox[{"Pp_", ",", "mp_", ",", "z_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"2", "*", "mp", "*", "Pp", 
     RowBox[{"(", 
      RowBox[{"1", "-", "z"}], ")"}]}], "+", 
    RowBox[{"2", "*", 
     SuperscriptBox["mp", "2"]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"sigmapp", "[", "s_", "]"}], "=", 
    RowBox[{"Zfit", "+", 
     RowBox[{"Bfit", "*", 
      SuperscriptBox[
       RowBox[{"Log", "[", 
        RowBox[{"s", "/", "s0fit"}], "]"}], "2"]}], "+", 
     RowBox[{"Y1fit", "*", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"s1fit", "/", "s"}], ")"}], "\[Eta]1fit"]}], "-", 
     RowBox[{"Y2fit", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"s1fit", "/", "s"}], ")"}], "\[Eta]2fit"]}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Kinematics", " ", "of", " ", "the", " ", "1"}], " ", "\[Rule]", 
    " ", 
    RowBox[{
     RowBox[{"2", " ", "process", " ", "p"}], " ", "\[Rule]", " ", 
     RowBox[{"p", " ", "+", " ", 
      RowBox[{
      "S", " ", "within", " ", "the", " ", "WW", " ", "approximation"}]}]}]}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EPbrem", "=", 
   RowBox[{"Pp", "+", 
    FractionBox[
     SuperscriptBox["mp", "2"], 
     RowBox[{"2", "*", "Pp"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EpprimeBrem", "=", 
   RowBox[{
    RowBox[{"Pp", "*", 
     RowBox[{"(", 
      RowBox[{"1", "-", "z"}], ")"}]}], "+", 
    FractionBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["mp", "2"], "+", 
       SuperscriptBox["pT", "2"]}], ")"}], 
     RowBox[{"2", "*", "Pp", 
      RowBox[{"(", 
       RowBox[{"1", "-", "z"}], ")"}]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ppprimeBrem", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "z"}], ")"}], "*", "Pp"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ESbrem", "=", 
   RowBox[{
    RowBox[{"Pp", "*", "z"}], "+", 
    FractionBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["pT", "2"], "+", 
       SuperscriptBox["mS", "2"]}], ")"}], 
     RowBox[{"2", "*", "Pp", "*", "z"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pSbrem", "=", 
   RowBox[{"pp", "-", "ppprimeBrem"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Applicability parameter (must be << 1):\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ApplicabilityParameter", "[", 
    RowBox[{"Pp_", ",", "z_", ",", "pT_", ",", "mX_", ",", "mp_"}], "]"}], 
   "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Simplify", "[", 
      FractionBox[
       RowBox[{"(", 
        RowBox[{"EpprimeBrem", "+", "ESbrem", "-", "EPbrem"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"EpprimeBrem", "-", "ESbrem", "+", "EPbrem"}], ")"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"pT", "\[Rule]", "0"}], ",", 
           RowBox[{"mp", "\[Rule]", "0"}], ",", 
           RowBox[{"mX", "\[Rule]", "0"}]}], "}"}]}], ")"}]], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{"mS", "\[Rule]", "mX"}], "}"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["mX", "2"], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["Pp", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"z", "-", "1"}], ")"}], " ", "z"}]}], "\[Rule]", 
      RowBox[{"4", 
       SuperscriptBox["Pp", "2"], "z", 
       RowBox[{"(", 
        RowBox[{"z", "-", "1"}], ")"}]}]}], "}"}]}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Momenta", " ", "of", " ", "the", " ", "protons", " ", "at", " ", 
    "various", " ", "facilities"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Ppfacility", "[", "\"\<SPS\>\"", "]"}], ",", 
      RowBox[{"Ppfacility", "[", "\"\<LHC\>\"", "]"}], ",", 
      RowBox[{"Ppfacility", "[", "\"\<FCC-hh\>\"", "]"}], ",", 
      RowBox[{"Ppfacility", "[", "\"\<FermilabBD\>\"", "]"}]}], "}"}], "=", 
    RowBox[{"{", 
     RowBox[{"400.", ",", "7000.", ",", "50000.", ",", "120."}], "}"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "minimal", " ", "allowed", " ", "fraction", " ", "of", " ", 
    "energy", " ", 
    RowBox[{
     SubscriptBox["E", "S"], "/", 
     SubscriptBox["E", "p"]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"zMinBrem", "[", "\"\<FermilabBD\>\"", "]"}], ",", 
      RowBox[{"zMinBrem", "[", "\"\<SPS\>\"", "]"}], ",", 
      RowBox[{"zMinBrem", "[", "\"\<LHC\>\"", "]"}], ",", 
      RowBox[{"zMinBrem", "[", "\"\<FCC-hh\>\"", "]"}]}], "}"}], "=", 
    RowBox[{"{", 
     RowBox[{"0.1", ",", "0.1", ",", "0.005", ",", "0.0001"}], "}"}]}], ";"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "maximal", " ", "allowed", " ", "fraction", " ", "of", " ", 
    "energy"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zMaxBrem", "=", "0.9"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Elastic", " ", "SNN", " ", "form"}], "-", "factor"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BremFormFactorSquared", "[", "mS_", "]"}], "=", 
   RowBox[{
    RowBox[{"Interpolation", "[", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<phenomenology/Scalar/branching \
ratios/proton-timelike-form-factor-scalar.txt\>\""}], "}"}], "]"}], ",", 
        "\"\<Table\>\""}], "]"}], ",", 
      RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", "mS", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.893948147851899*^9, 3.893948216706112*^9}, {
  3.89395058466586*^9, 3.893950620528405*^9}, {3.8939511202016788`*^9, 
  3.893951147576815*^9}, {3.893951208147995*^9, 3.8939512325535116`*^9}, {
  3.8939532953288584`*^9, 3.8939533032600737`*^9}, {3.8939536066961417`*^9, 
  3.893953611335486*^9}},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->"In[32]:=",ExpressionUUID->"fbde88eb-bc2d-4ac9-a0dd-e946ef2c3168"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Distribution", "Subsection",
 CellChangeTimes->{{3.893948232036254*^9, 3.8939482350024104`*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"a89a4f3a-558d-4ceb-b9ff-7c0da374ee49"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"<<", "FeynCalc`"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Matrix", " ", "element", " ", "corresponding", " ", "to", " ", "the", 
      " ", "sub"}], "-", 
     RowBox[{"process", " ", "p"}]}], " ", "\[Rule]", " ", 
    RowBox[{"p", " ", "+", " ", "S"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MscalarBrem", "=", 
   RowBox[{"gSNN", " ", 
    RowBox[{
     RowBox[{"SpinorUBar", "[", 
      RowBox[{"p1", ",", "mp"}], "]"}], ".", 
     RowBox[{"SpinorU", "[", 
      RowBox[{"k1", ",", "mp"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MscalarBremStar", "=", 
    RowBox[{"ComplexConjugate", "[", "MscalarBrem", "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Squared", " ", "matrix", " ", "element"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MScalarBremSquared", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"FermionSpinSum", "[", 
           RowBox[{"MscalarBrem", " ", "MscalarBremStar"}], "]"}]}], "/.", 
         RowBox[{"DiracTrace", "\[Rule]", "TR"}]}], "//", "Contract"}], "//", 
       "Simplify"}], ")"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ScalarProduct", "[", 
        RowBox[{"k1", ",", "p1"}], "]"}], "\[Rule]", " ", 
       RowBox[{
        RowBox[{"Pp", "*", "EpprimeBrem"}], "-", 
        RowBox[{"Pp", "*", "ppprimeBrem"}]}]}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Differential", " ", "splitting", " ", "probability"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DifferentialSplittingProbability", "[", 
    RowBox[{
    "mp_", ",", "mS_", ",", "pT_", ",", "z_", ",", "gSNN_", ",", "Pp_"}], 
    "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"16", "*", 
          SuperscriptBox["Pi", "2"], "*", "z"}]], 
        FractionBox["1", 
         RowBox[{"4", "*", "Pp", "*", "EpprimeBrem"}]], "*", 
        FractionBox["MScalarBremSquared", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"EpprimeBrem", "+", "ESbrem", "-", "Pp"}], ")"}], "2"]]}], 
       ")"}], "]"}], "/.", 
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["mp", "2"], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["Pp", "2"]}]}], ")"}], " ", "\[Rule]", 
       RowBox[{"2", "*", 
        SuperscriptBox["Pp", "2"]}]}], "}"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["mp", "2"], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["Pp", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"z", "-", "1"}], ")"}], "2"]}], "+", 
       SuperscriptBox["pT", "2"]}], "\[Rule]", 
      RowBox[{"2", "*", 
       SuperscriptBox["Pp", "2"], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"z", "-", "1"}], ")"}], "2"]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pTmaxBrem", "=", 
    RowBox[{
     RowBox[{"DialogInput", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"br", "=", "\"\<\>\""}], "}"}], ",", 
       RowBox[{"Column", "[", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Enter the maximal \!\(\*SubscriptBox[\(p\), \(T\)]\) (in GeV) \
for the bremsstrahlung channel (typical value is 1 GeV):\>\"", ",", 
          RowBox[{"InputField", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", "br", "]"}], ",", "Number"}], "]"}], ",", 
          RowBox[{"Button", "[", 
           RowBox[{"\"\<Proceed\>\"", ",", 
            RowBox[{"DialogReturn", "[", "br", "]"}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "Automatic"}]}], "]"}]}], "}"}], 
        "]"}]}], "]"}], "//", "N"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Double", " ", "distribution", " ", "in", " ", "\[Theta]", " ", "and", " ",
     "E"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DistrBremInpTz", "[", 
    RowBox[{"mS_", ",", "pT_", ",", "z_", ",", "Pp_", ",", "zmin_"}], "]"}], 
   "=", 
   RowBox[{
    RowBox[{"DifferentialSplittingProbability", "[", 
     RowBox[{"MP", ",", "mS", ",", "pT", ",", "z", ",", "GSNN", ",", "Pp"}], 
     "]"}], "*", "2", "*", "pT", "*", 
    FractionBox[
     RowBox[{"sigmapp", "[", 
      RowBox[{"Sprime", "[", 
       RowBox[{"Pp", ",", "MP", ",", "z"}], "]"}], "]"}], 
     RowBox[{"sigmapp", "[", 
      RowBox[{"S", "[", 
       RowBox[{"Pp", ",", "MP"}], "]"}], "]"}]], 
    RowBox[{"UnitStep", "[", 
     RowBox[{"pTmaxBrem", "-", "pT"}], "]"}], "*", 
    RowBox[{"UnitStep", "[", 
     RowBox[{"z", "-", "zmin"}], "]"}], 
    RowBox[{"UnitStep", "[", 
     RowBox[{"zMaxBrem", "-", "z"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pTin\[Theta]E", "[", 
    RowBox[{"\[Theta]S_", ",", "ES_", ",", "mS_"}], "]"}], "=", 
   RowBox[{
    SqrtBox[
     RowBox[{
      SuperscriptBox["ES", "2"], "-", 
      SuperscriptBox["mS", "2"]}]], 
    RowBox[{"Sin", "[", "\[Theta]S", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zIn\[Theta]E", "[", 
    RowBox[{"ES_", ",", "Pp_"}], "]"}], "=", 
   FractionBox["ES", "Pp"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"JacobianpTzToES\[Theta]S", "[", 
    RowBox[{"\[Theta]S_", ",", "ES_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"pTin\[Theta]E", "[", 
       RowBox[{"\[Theta]S", ",", "ES", ",", "mS"}], "]"}], ",", "\[Theta]S"}],
      "]"}], "*", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"zIn\[Theta]E", "[", 
       RowBox[{"ES", ",", "Pp"}], "]"}], ",", "ES"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DistrBrem\[Theta]EscalarNoFormFactorTemp", "[", 
    RowBox[{"mS_", ",", "\[Theta]S_", ",", "ES_", ",", "Pp_", ",", "zmin_"}], 
    "]"}], "=", 
   RowBox[{
    RowBox[{"DistrBremInpTz", "[", 
     RowBox[{"mS", ",", 
      RowBox[{"pTin\[Theta]E", "[", 
       RowBox[{"\[Theta]S", ",", "ES", ",", "mS"}], "]"}], ",", 
      RowBox[{"zIn\[Theta]E", "[", 
       RowBox[{"ES", ",", "Pp"}], "]"}], ",", "Pp", ",", "zmin"}], "]"}], "*", 
    RowBox[{"JacobianpTzToES\[Theta]S", "[", 
     RowBox[{"\[Theta]S", ",", "ES"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"mSminFromBrem", ",", "mSmaxFromBrem"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"0.02", ",", "2.5"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ESmaxBremBeam", "[", 
    RowBox[{"Facility_", ",", "\[Theta]S_"}], "]"}], ":=", 
   RowBox[{"Min", "[", 
    RowBox[{
     RowBox[{"zMaxBrem", "*", 
      RowBox[{"Ppfacility", "[", "Facility", "]"}]}], ",", 
     FractionBox["pTmaxBrem", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]S", "]"}], "+", 
       SuperscriptBox["10", 
        RowBox[{"-", "7"}]]}]]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]maxBremTemp", "[", "Facility_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[Theta]S", "/.", 
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"zMinBrem", "[", "Facility", "]"}], "*", 
           RowBox[{"Ppfacility", "[", "Facility", "]"}]}], "\[Equal]", 
          FractionBox["pTmaxBrem", 
           RowBox[{"Sin", "[", "\[Theta]S", "]"}]]}], ",", "\[Theta]S"}], 
        "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       TemplateBox[{"1"},
        "C"], "\[Rule]", "0"}], "}"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]maxBremFacility", "[", "\"\<FermilabBD\>\"", "]"}], ",", 
     RowBox[{"\[Theta]maxBremFacility", "[", "\"\<SPS\>\"", "]"}], ",", 
     RowBox[{"\[Theta]maxBremFacility", "[", "\"\<LHC\>\"", "]"}], ",", 
     RowBox[{"\[Theta]maxBremFacility", "[", "\"\<FCC-hh\>\"", "]"}]}], "}"}],
    "=", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]maxBremTemp", "[", "#", "]"}], "&"}], "/@", 
    RowBox[{"{", 
     RowBox[{
     "\"\<FermilabBD\>\"", ",", "\"\<SPS\>\"", ",", "\"\<LHC\>\"", ",", 
      "\"\<FCC-hh\>\""}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NormalizationBremNoFormFactorTemp", "[", "Facility_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "zmin", ",", "ESmaxfrombrem", ",", "pbeam", ",", "\[Theta]maxbrem"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"pbeam", "=", 
      RowBox[{"Ppfacility", "[", "Facility", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"zmin", "=", 
      RowBox[{"zMinBrem", "[", "Facility", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ESmaxfrombrem", "[", "\[Theta]S_", "]"}], "=", 
      RowBox[{"ESmaxBremBeam", "[", 
       RowBox[{"Facility", ",", "\[Theta]S"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Theta]maxbrem", "=", 
      RowBox[{"\[Theta]maxBremFacility", "[", "Facility", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Interpolation", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"mS", ",", 
            RowBox[{"NIntegrate", "[", 
             RowBox[{
              RowBox[{"DistrBrem\[Theta]EscalarNoFormFactorTemp", "[", 
               RowBox[{
               "mS", ",", "\[Theta]S", ",", "ES", ",", "pbeam", ",", "zmin"}],
                "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Theta]S", ",", "0", ",", "\[Theta]maxbrem"}], "}"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"ES", ",", 
                RowBox[{"zmin", "*", "pbeam"}], ",", 
                RowBox[{"Max", "[", 
                 RowBox[{
                  RowBox[{"zmin", "*", "pbeam"}], ",", 
                  RowBox[{"ESmaxfrombrem", "[", "\[Theta]S", "]"}]}], "]"}]}],
                "}"}], ",", 
              RowBox[{"Method", "\[Rule]", "\"\<AdaptiveMonteCarlo\>\""}]}], 
             "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"mS", ",", "mSminFromBrem", ",", "mSmaxFromBrem", ",", 
            FractionBox[
             RowBox[{"(", 
              RowBox[{"mSmaxFromBrem", "-", "mSminFromBrem"}], ")"}], "20"]}],
            "}"}]}], "]"}], ",", 
        RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "mS", 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"NormalizationBremNoFormFactor", "[", 
        RowBox[{"mS_", ",", "Facility"}], "]"}], "=", 
       RowBox[{"NormalizationBremNoFormFactorTemp", "[", "Facility", "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DoubleDistrScalarfromBremFacility", "[", 
        RowBox[{"mS_", ",", "\[Theta]S_", ",", "ES_", ",", "Facility"}], 
        "]"}], "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
         "mSminFromBrem", "\[LessEqual]", "mS", "\[LessEqual]", 
          "mSmaxFromBrem"}], ",", 
         RowBox[{"Evaluate", "[", 
          RowBox[{
           FractionBox["1", 
            RowBox[{"NormalizationBremNoFormFactor", "[", 
             RowBox[{"mS", ",", "Facility"}], "]"}]], "*", 
           RowBox[{"DistrBrem\[Theta]EscalarNoFormFactorTemp", "[", 
            RowBox[{"mS", ",", "\[Theta]S", ",", "ES", ",", 
             RowBox[{"Ppfacility", "[", "Facility", "]"}], ",", 
             RowBox[{"zMinBrem", "[", "Facility", "]"}]}], "]"}]}], "]"}], 
         ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PbremFacility", "[", 
        RowBox[{"mS_", ",", "\[Theta]2_", ",", "Facility"}], "]"}], "=", 
       RowBox[{"\[Theta]2", "*", 
        RowBox[{"BremFormFactorSquared", "[", "mS", "]"}], "*", 
        RowBox[{"NormalizationBremNoFormFactor", "[", 
         RowBox[{"mS", ",", "Facility"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ESmaxFromBrem", "[", 
        RowBox[{"mS_", ",", "\[Theta]S_", ",", "Facility"}], "]"}], "=", 
       RowBox[{"ESmaxBremBeam", "[", 
        RowBox[{"Facility", ",", "\[Theta]S"}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"Facility", ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<FermilabBD\>\"", ",", "\"\<SPS\>\"", ",", "\"\<LHC\>\"", ",", 
         "\"\<FCC-hh\>\""}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Tabulated", " ", "distribution", " ", "to", " ", "be", " ", "used", " ", 
    "in", " ", "next", " ", "sections"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TableBremDistr", "[", 
   RowBox[{"\[Theta]minExp_", ",", "\[Theta]maxExp_", ",", "Facility_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "eminbrem", ",", "\[Theta]Slistbrem", ",", "EslistBremTemp", ",", 
      "EslistBrem"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"eminbrem", "=", 
      RowBox[{
       RowBox[{"Ppfacility", "[", "Facility", "]"}], "*", 
       RowBox[{"zMinBrem", "[", "Facility", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Theta]Slistbrem", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"\[Theta]V", ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]V", ",", 
          RowBox[{"0.99", "\[Theta]minExp"}], ",", 
          RowBox[{"1.01", "\[Theta]maxExp"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"1.01", "\[Theta]maxExp"}], "-", 
             RowBox[{"0.99", "\[Theta]minExp"}]}], ")"}], "/", "50"}]}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"EslistBremTemp", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{"x", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "0.02", ",", "eminbrem", ",", "1"}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"10", "^", "x"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"Log10", "[", 
             RowBox[{"1.02", "*", "eminbrem"}], "]"}], ",", 
            RowBox[{"Log10", "[", 
             RowBox[{"Ppfacility", "[", "Facility", "]"}], "]"}], ",", 
            FractionBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Log10", "[", 
                RowBox[{"Ppfacility", "[", "Facility", "]"}], "]"}], "-", 
               RowBox[{"Log10", "[", 
                RowBox[{"1.02", "*", "eminbrem"}], "]"}]}], ")"}], "50"]}], 
           "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"EslistBrem", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{"EslistBremTemp", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"ESmaxBremBeam", "[", 
             RowBox[{"Facility", ",", "#"}], "]"}], "&"}], "/@", 
           "\[Theta]Slistbrem"}]}], "]"}], "//", "Sort"}], "//", 
       "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"mS", ",", "\[Theta]S", ",", "ES", ",", 
           RowBox[{
            RowBox[{"DoubleDistrScalarfromBremFacility", "[", 
             RowBox[{"mS", ",", "\[Theta]S", ",", "ES", ",", "Facility"}], 
             "]"}], "+", 
            SuperscriptBox["10", 
             RowBox[{"-", "90"}]]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"mS", ",", "mSminFromBrem", ",", 
           RowBox[{"mSmaxFromBrem", "//", "N"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"mSmaxFromBrem", "//", "N"}], ")"}], "-", 
              "mSminFromBrem"}], ")"}], "/", "10"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Theta]S", ",", "\[Theta]Slistbrem"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"ES", ",", "EslistBrem"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.8939484080734434`*^9, 3.8939484538161745`*^9}, {
   3.8939484861391087`*^9, 3.893948534832832*^9}, {3.8939486030159535`*^9, 
   3.893948663753356*^9}, {3.8939488365768833`*^9, 3.893948859694697*^9}, {
   3.8939494403154354`*^9, 3.893949486345255*^9}, {3.8939497048768377`*^9, 
   3.893949706298651*^9}, {3.893949851994735*^9, 3.893949860112007*^9}, {
   3.8939499630096517`*^9, 3.893950066645373*^9}, {3.893950278076965*^9, 
   3.8939503012711926`*^9}, {3.89395040816138*^9, 3.893950442116067*^9}, {
   3.8939505792984533`*^9, 3.893950579675583*^9}, {3.893950629501483*^9, 
   3.893950876592148*^9}, {3.89395091650343*^9, 3.8939509311867995`*^9}, {
   3.893951023957723*^9, 3.893951041435152*^9}, {3.8939511149315023`*^9, 
   3.8939511154946237`*^9}, {3.893951154167527*^9, 3.8939511846024313`*^9}, {
   3.893951239898074*^9, 3.8939512509371386`*^9}, {3.893953287875718*^9, 
   3.893953292346974*^9}, {3.8939535237076707`*^9, 3.893953531766016*^9}, {
   3.8939556503511896`*^9, 3.8939556504453187`*^9}, 3.8939558892076707`*^9},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->"In[56]:=",ExpressionUUID->"f36dd757-b278-4c42-b71d-5e3be5cf0c5c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Production probabilities from decays", "Section",
 CellChangeTimes->{{3.826713169183443*^9, 3.8267131698544655`*^9}, {
  3.885138658855132*^9, 3.8851386649516826`*^9}, {3.8939478777292466`*^9, 
  3.8939478818105855`*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"156e6e8c-0ae4-4a31-8d56-64751523cf6c"],

Cell[CellGroupData[{

Cell["From decays", "Subsection",
 CellChangeTimes->{{3.8056312614145575`*^9, 3.805631266961115*^9}, 
   3.8100509495373964`*^9, {3.8851383572222505`*^9, 3.8851383583115234`*^9}, {
   3.8851386723528523`*^9, 3.885138676594013*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"318d803b-d3a7-4103-8363-93d1bb5e975d"],

Cell[CellGroupData[{

Cell["Br ratios", "Subsubsection",
 CellChangeTimes->{{3.805631274447618*^9, 3.8056312769672656`*^9}, {
   3.8100523131373615`*^9, 3.8100523142155437`*^9}, {3.826713172848985*^9, 
   3.8267131738418784`*^9}, 3.885138678312326*^9},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"3269a735-5538-4ab5-8576-41d62670317b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Branching", " ", "ratios", " ", "of", " ", "the", " ", "scalar", " ", 
     "production", " ", "from", " ", "B", " ", "and", " ", "K", " ", "mesons",
      " ", "through", " ", "the", " ", "mixing", " ", "\[Theta]", " ", "at", 
     " ", "\[Theta]"}], " ", "=", " ", "1"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BrBplusToXsS", "[", "mS_", "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"mS", "<", 
      RowBox[{"mB", "-", "m\[Pi]"}]}], ",", 
     RowBox[{"Evaluate", "[", 
      RowBox[{
       RowBox[{"Interpolation", "[", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"NotebookDirectory", "[", "]"}], ",", 
              "\"\<phenomenology/Scalar/branching \
ratios/BtoXsStotal.dat\>\""}], "}"}], "]"}], ",", "\"\<Table\>\""}], "]"}], 
         ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "mS", 
       "]"}], "]"}], ",", "0"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BrBplusToXsSinclusive", "[", "mS_", "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"mS", "<", 
      RowBox[{"mB", "-", "m\[Pi]"}]}], ",", 
     RowBox[{"Evaluate", "[", 
      RowBox[{
       RowBox[{"Interpolation", "[", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"NotebookDirectory", "[", "]"}], ",", 
              "\"\<phenomenology/Scalar/branching \
ratios/BtoXsSinclusive.dat\>\""}], "}"}], "]"}], ",", "\"\<Table\>\""}], 
          "]"}], ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "mS", 
       "]"}], "]"}], ",", "0"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BrK0LToS", "[", "mS_", "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"mS", "<", 
      RowBox[{"mK", "-", "m\[Pi]"}]}], ",", 
     RowBox[{"Evaluate", "[", 
      RowBox[{
       RowBox[{"Interpolation", "[", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"NotebookDirectory", "[", "]"}], ",", 
              "\"\<phenomenology/Scalar/branching ratios/K0LtoPiS.dat\>\""}], 
             "}"}], "]"}], ",", "\"\<Table\>\""}], "]"}], ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "mS", 
       "]"}], "]"}], ",", "0"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BrKplusToS", "[", "mS_", "]"}], "=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"mS", "<", 
       RowBox[{"mK", "-", "m\[Pi]"}]}], ",", 
      RowBox[{"Evaluate", "[", 
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{
          RowBox[{"Import", "[", 
           RowBox[{
            RowBox[{"FileNameJoin", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"NotebookDirectory", "[", "]"}], ",", 
               "\"\<phenomenology/Scalar/branching \
ratios/KplustoPiS.dat\>\""}], "}"}], "]"}], ",", "\"\<Table\>\""}], "]"}], 
          ",", 
          RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "mS", 
        "]"}], "]"}], ",", "0"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Branching", " ", "ratios", " ", "of", " ", "the", " ", "scalar", " ", 
     "production", " ", "from", " ", "B", " ", "mesons", " ", "and", " ", 
     "Higgses", " ", "through", " ", "quartic", " ", "coupling", " ", 
     FractionBox["\[Alpha]", 
      RowBox[{"2", "v"}]], "SSHH", " ", "at", " ", "\[Alpha]"}], " ", "=", 
    " ", 
    RowBox[{"1", " ", "GeV"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BrBplustoXsSS", "[", "mS_", "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"mS", "<", 
      FractionBox[
       RowBox[{"mB", "-", "m\[Pi]"}], "2"]}], ",", 
     RowBox[{"Evaluate", "[", 
      RowBox[{
       RowBox[{"Interpolation", "[", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"NotebookDirectory", "[", "]"}], ",", 
              "\"\<phenomenology/Scalar/branching ratios/BplustoXsSStotal.dat\
\>\""}], "}"}], "]"}], ",", "\"\<Table\>\""}], "]"}], ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "mS", 
       "]"}], "]"}], ",", "0"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BrBstoSS", "[", "mS_", "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"mS", "<", 
      FractionBox["mBs", "2"]}], ",", 
     RowBox[{"Evaluate", "[", 
      RowBox[{
       RowBox[{"Interpolation", "[", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"NotebookDirectory", "[", "]"}], ",", 
              "\"\<phenomenology/Scalar/branching ratios/BstoSS.dat\>\""}], 
             "}"}], "]"}], ",", "\"\<Table\>\""}], "]"}], ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "mS", 
       "]"}], "]"}], ",", "0"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BrhtoSS", "[", 
     RowBox[{"mS_", ",", "\[Alpha]_"}], "]"}], "=", 
    RowBox[{"2", "*", 
     SuperscriptBox["10", 
      RowBox[{"-", "2"}]], "*", 
     SuperscriptBox["\[Alpha]", "2"], 
     SqrtBox[
      RowBox[{"1", "-", 
       RowBox[{"4", "*", 
        FractionBox[
         SuperscriptBox["mS", "2"], 
         SuperscriptBox["125", "2"]]}]}]]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Value", " ", "of", " ", "\[Alpha]", " ", "corresponding", " ", "to", " ",
      "Br", 
     RowBox[{"(", 
      RowBox[{"h", "\[Rule]", "SS"}], ")"}]}], "=", "0.01"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Alpha]valBrhToSS", "[", "BrhToSS_", "]"}], "=", 
   RowBox[{"\[Alpha]", "/.", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"BrhtoSS", "[", 
         RowBox[{"0", ",", "\[Alpha]"}], "]"}], "\[Equal]", "BrhToSS"}], ",", 
       "\[Alpha]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]val001", "=", 
   RowBox[{"\[Alpha]", "/.", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"BrhtoSS", "[", 
         RowBox[{"0", ",", "\[Alpha]"}], "]"}], "\[Equal]", "0.01"}], ",", 
       "\[Alpha]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<Values of the Br ratios at \!\(\*SubscriptBox[\(m\), \(S\)]\) = 0 (\
\[Alpha] = 1 GeV, \[Theta] = 1):\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\"\<Process\>\"", ",", 
      "\"\<\!\(\*SuperscriptBox[\(K\), \(+\)]\)\[Rule]\[Pi]+S\>\"", ",", 
      "\"\<\!\(\*SuperscriptBox[\(K\), \(0\)]\)\[Rule]\[Pi]+S\>\"", ",", 
      "\"\<\!\(\*SuperscriptBox[\(B\), \
\(+\)]\)\[Rule]\!\(\*SubscriptBox[\(X\), \(s\)]\)+S\>\"", ",", 
      "\"\<\!\(\*SuperscriptBox[\(B\), \
\(+\)]\)\[Rule]\!\(\*SubscriptBox[\(X\), \(s\)]\) + S + S\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(B\), \(s\)]\) \[Rule] S + S\>\"", ",", 
      "\"\<h \[Rule] S + S\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<Value\>\"", ",", 
      RowBox[{"BrKplusToS", "[", "0", "]"}], ",", 
      RowBox[{"BrK0LToS", "[", "0", "]"}], ",", " ", 
      RowBox[{"BrBplusToXsS", "[", "0", "]"}], ",", 
      RowBox[{"BrBplustoXsSS", "[", "0", "]"}], ",", 
      RowBox[{"BrBstoSS", "[", "0", "]"}], ",", 
      RowBox[{"BrhtoSS", "[", 
       RowBox[{"0", ",", "1"}], "]"}]}], "}"}]}], "}"}], "//", 
  "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"SelectedBrChoice", "=", 
  RowBox[{"dropdownDialog", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\"\<Exclusive\>\"", ",", "\"\<Inclusive\>\""}], "}"}], ",", 
    "\"\<Select the description of the scalar's production by decays of B via \
mixing (see 1904.10447):\>\""}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BrBtoSX", "[", "mS_", "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"SelectedBrChoice", "\[Equal]", "\"\<Exclusive\>\""}], ",", 
     RowBox[{"BrBplusToXsS", "[", "mS", "]"}], ",", 
     RowBox[{"BrBplusToXsSinclusive", "[", "mS", "]"}]}], 
    RowBox[{"(*", 
     RowBox[{"Max", "[", 
      RowBox[{
       RowBox[{"BrBplusToXsSinclusive", "[", 
        RowBox[{
         FractionBox["4.7", "5.3"], "mS"}], "]"}], ",", 
       RowBox[{"BrBplusToXsS", "[", "mS", "]"}]}], "]"}], "*)"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7725133258234296`*^9, 3.7725133603193274`*^9}, {
   3.7725134007381763`*^9, 3.7725138615184145`*^9}, {3.7725138972581463`*^9, 
   3.7725141982645097`*^9}, {3.77251428480374*^9, 3.77251432219127*^9}, {
   3.772514578847186*^9, 3.7725145796994543`*^9}, {3.7725146136640425`*^9, 
   3.7725146161853514`*^9}, {3.772514655528286*^9, 3.7725146745035105`*^9}, {
   3.772514709307837*^9, 3.772514714432558*^9}, {3.805631174087533*^9, 
   3.8056312301053467`*^9}, {3.826713188668157*^9, 3.8267132341104794`*^9}, {
   3.8267133312283993`*^9, 3.8267133312779336`*^9}, {3.8851378838522544`*^9, 
   3.885138072898774*^9}, {3.8851382574195457`*^9, 3.885138316690009*^9}, {
   3.8851383677033176`*^9, 3.8851385155787315`*^9}, {3.885452510967987*^9, 
   3.88545256310821*^9}, {3.8884633809907703`*^9, 3.8884633844071493`*^9}, 
   3.888463417087783*^9, 3.893483891434638*^9, {3.8934839246206865`*^9, 
   3.893484005280735*^9}, {3.894602286307747*^9, 3.8946022880982604`*^9}, {
   3.894612476037318*^9, 3.8946124792690673`*^9}, {3.8946125721915445`*^9, 
   3.894612573335254*^9}, {3.8966908070791044`*^9, 3.8966908210175443`*^9}, {
   3.900729636901665*^9, 3.9007296507420816`*^9}, {3.9007297413994102`*^9, 
   3.9007297456571236`*^9}, {3.9007528465215*^9, 3.900752851717307*^9}},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->"In[74]:=",ExpressionUUID->"bb154e48-5da4-4c5d-8396-58bfaff60823"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["\[Sum]", "B"], 
   RowBox[{
    SubscriptBox["f", 
     RowBox[{"b", "\[Rule]", "B"}]], 
    SubscriptBox["Br", 
     RowBox[{"B", "\[Rule]", 
      RowBox[{"X", "+", "S"}]}]]}]}], 
  TraditionalForm]], \
"Subsection",ExpressionUUID->"47a92ce1-fece-4bd7-a864-8b8cbc4b749a"]], \
"Subsubsection",
 CellChangeTimes->{3.885138112470281*^9},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"692a653d-bf39-454a-9e4d-4777b8af9f82"],

Cell[CellGroupData[{

Cell["SPS", "Item",
 CellChangeTimes->{{3.8100522957677712`*^9, 3.8100522964855533`*^9}, {
  3.8851381176546483`*^9, 3.8851381180721626`*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"b99fd440-5006-420b-9f87-f03108051217"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PbbbarToS\[Theta]SPS", "[", 
    RowBox[{"mS_", ",", "\[Theta]2_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"fbtobplusSPS", "+", "fbtob0SPS"}], ")"}], "*", 
    RowBox[{"BrBtoSX", "[", "mS", "]"}], "*", "\[Theta]2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PssbarToS\[Theta]SPS", "[", 
    RowBox[{"mS_", ",", "\[Theta]2_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"fstoKcharged", "*", 
       RowBox[{"BrKplusToS", "[", "mS", "]"}]}], "+", 
      RowBox[{"fstoK0L", "*", 
       RowBox[{"BrK0LToS", "[", "mS", "]"}]}]}], ")"}], "*", "\[Theta]2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PssbarToSSPS", "[", 
     RowBox[{"mS_", ",", "\[Theta]2_"}], "]"}], "=", 
    RowBox[{"fstokplusSPS", "*", 
     RowBox[{"BrKplusToS", "[", "mS", "]"}], "\[Theta]2"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"A", " ", "factor", " ", "of", " ", "2"}], " ", "-", " ", 
    RowBox[{"a", " ", "pair", " ", "of", " ", "scalars"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PbbbarToSSXsSPS", "[", 
    RowBox[{"mS_", ",", "\[Alpha]_"}], "]"}], " ", "=", 
   RowBox[{"2", "*", 
    SuperscriptBox["\[Alpha]", "2"], "*", 
    RowBox[{"(", 
     RowBox[{"fbtobplusSPS", "+", "fbtob0SPS"}], ")"}], "*", 
    RowBox[{"BrBplustoXsSS", "[", "mS", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PbbbarToSSSPS", "[", 
    RowBox[{"mS_", ",", "\[Alpha]_"}], "]"}], " ", "=", 
   RowBox[{"2", "*", 
    SuperscriptBox["\[Alpha]", "2"], "*", "fbtobsSPS", "*", 
    RowBox[{"BrBstoSS", "[", "mS", "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQBGIQfaduhpRk8htHKe8VYNrHP/P8qqY3jrO4csF0x9vd
4Q+A9BsNqyQQvag/b3XIpjeONe+vrwPRWbIXtoDoeYWB20D0GxNzntUPgfqS
I8F0i7PCzOxHbxzFPu+ZDaI9oq6dA9F7vn+8BKJTji+8BaLfrT4AptcwiZ5b
9OSNY9vX7PMgmmlaxxUQ3fLs2HUQLfXH9TGI1rSc/ARErwv8Lhnw6Y1jGPcZ
RRBdo3DEG0SfWiYQAqK/svLOAdFqXv9WgGj11C5xzh9vHPV0JKRA9N3KDYog
ukb8piqINvobdmo5kLaZx3oGRFfYRijL/nnjeEXCRxVE97Xt0wLRXf8/g+mk
l2lz8xjeOjr7M80D0SJPmpWLgHTKt7tgOu3jD6dKIH3nw0ZnEK0Z16tXDaSn
9W7RB9O8jbbWTG8dT5X+BdMAYArVNw==
  "],
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->"In[89]:=",ExpressionUUID->"13d8020f-9e3c-410e-acb1-3fe31d3a0b2e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["LHC", "Item",
 CellChangeTimes->{{3.810052298394516*^9, 3.810052301058775*^9}, {
  3.885138198034688*^9, 3.8851381985714064`*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"206f97cf-3e69-46f9-a968-ede524828d13"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PbbbarToS\[Theta]LHC", "[", 
    RowBox[{"mS_", ",", "\[Theta]2_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"fbtobplusLHC", "+", "fbtob0LHC"}], ")"}], "*", 
    RowBox[{"BrBtoSX", "[", "mS", "]"}], "*", "\[Theta]2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PbbbarToSSXsLHC", "[", 
    RowBox[{"mS_", ",", "\[Alpha]_"}], "]"}], " ", "=", 
   RowBox[{"2", "*", 
    SuperscriptBox["\[Alpha]", "2"], "*", 
    RowBox[{"(", 
     RowBox[{"fbtobplusLHC", "+", "fbtob0LHC"}], ")"}], "*", 
    RowBox[{"BrBplustoXsSS", "[", "mS", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PbbbarToSSLHC", "[", 
    RowBox[{"mS_", ",", "\[Alpha]_"}], "]"}], " ", "=", 
   RowBox[{"2", "*", 
    SuperscriptBox["\[Alpha]", "2"], "*", "fbtobsLHC", "*", 
    RowBox[{"BrBstoSS", "[", "mS", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PhtoSLHC", "[", 
    RowBox[{"mS_", ",", "\[Alpha]_"}], "]"}], "=", 
   RowBox[{"BrhtoSS", "[", 
    RowBox[{"mS", ",", "\[Alpha]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.810052294209831*^9, 3.8100523109758782`*^9}, 
   3.8100524006874595`*^9, {3.8515930870384912`*^9, 3.851593112934782*^9}, {
   3.851593145468582*^9, 3.8515931508862467`*^9}, {3.8779675897555895`*^9, 
   3.87796759009387*^9}, {3.8779676422115345`*^9, 3.8779676422145796`*^9}, {
   3.885138150525429*^9, 3.8851381608739853`*^9}, {3.8851382068607235`*^9, 
   3.88513824168721*^9}, {3.8851385738935757`*^9, 3.8851385806462655`*^9}, {
   3.8851391119204016`*^9, 3.885139131316947*^9}, {3.8851392788237295`*^9, 
   3.8851392932822123`*^9}, 3.888463471964263*^9, {3.8902766644267397`*^9, 
   3.8902766693470583`*^9}, {3.89255528871345*^9, 3.8925552911613865`*^9}, {
   3.8926129658959618`*^9, 3.892612975363531*^9}, {3.8932180602761526`*^9, 
   3.893218069918256*^9}, {3.893224129098814*^9, 3.893224131535355*^9}, {
   3.893484020082793*^9, 3.8934840232827296`*^9}},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->"In[94]:=",ExpressionUUID->"bf0bd48d-3852-4b66-a42e-da6ee29cda7e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["FCC-hh", "Item",
 CellChangeTimes->{{3.8886381303388643`*^9, 3.888638131226077*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"ae44c387-69ab-4380-9525-2ecd652eece3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PbbbarToS\[Theta]FCChh", "[", 
    RowBox[{"mS_", ",", "\[Theta]2_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"fbtobplusLHC", "+", "fbtob0LHC"}], ")"}], "*", 
    RowBox[{"BrBtoSX", "[", "mS", "]"}], "*", "\[Theta]2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PbbbarToSSXsFCChh", "[", 
    RowBox[{"mS_", ",", "\[Alpha]_"}], "]"}], " ", "=", 
   RowBox[{"2", "*", 
    SuperscriptBox["\[Alpha]", "2"], "*", 
    RowBox[{"(", 
     RowBox[{"fbtobplusLHC", "+", "fbtob0LHC"}], ")"}], "*", 
    RowBox[{"BrBplustoXsSS", "[", "mS", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PbbbarToSSFCChh", "[", 
    RowBox[{"mS_", ",", "\[Alpha]_"}], "]"}], " ", "=", 
   RowBox[{"2", "*", 
    SuperscriptBox["\[Alpha]", "2"], "*", "fbtobsLHC", "*", 
    RowBox[{"BrBstoSS", "[", "mS", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PhtoSFCChh", "[", 
    RowBox[{"mS_", ",", "\[Alpha]_"}], "]"}], "=", 
   RowBox[{"BrhtoSS", "[", 
    RowBox[{"mS", ",", "\[Alpha]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.810052294209831*^9, 3.8100523109758782`*^9}, 
   3.8100524006874595`*^9, {3.8515930870384912`*^9, 3.851593112934782*^9}, {
   3.851593145468582*^9, 3.8515931508862467`*^9}, {3.8779675897555895`*^9, 
   3.87796759009387*^9}, {3.8779676422115345`*^9, 3.8779676422145796`*^9}, {
   3.885138150525429*^9, 3.8851381608739853`*^9}, {3.8851382068607235`*^9, 
   3.88513824168721*^9}, {3.8851385738935757`*^9, 3.8851385806462655`*^9}, {
   3.8851391119204016`*^9, 3.885139131316947*^9}, {3.8851392788237295`*^9, 
   3.8851392932822123`*^9}, 3.888463471964263*^9, {3.8886381098602257`*^9, 
   3.8886381266860485`*^9}, {3.8902766553694725`*^9, 3.890276678443387*^9}, 
   3.8925552952583337`*^9, 3.893484028970976*^9},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->"In[98]:=",ExpressionUUID->"5a8fa276-17cc-4ed8-a75f-64da8b65dd6d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["FermilabBD", "Item",
 CellChangeTimes->{{3.885138200415028*^9, 3.8851382010641785`*^9}, {
   3.885138328013221*^9, 3.8851383283467255`*^9}, 3.8935210003634195`*^9},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"f3ca9641-f067-41b4-89aa-290e1d8fe457"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PbbbarToS\[Theta]FermilabBD", "[", 
    RowBox[{"mS_", ",", "\[Theta]2_"}], "]"}], "=", 
   RowBox[{"PbbbarToS\[Theta]SPS", "[", 
    RowBox[{"mS", ",", "\[Theta]2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PssbarToS\[Theta]FermilabBD", "[", 
    RowBox[{"mS_", ",", "\[Theta]2_"}], "]"}], "=", 
   RowBox[{"PssbarToS\[Theta]SPS", "[", 
    RowBox[{"mS", ",", "\[Theta]2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PbbbarToSSXsFermilabBD", "[", 
    RowBox[{"mS_", ",", "\[Alpha]_"}], "]"}], " ", "=", 
   RowBox[{"2", "*", 
    SuperscriptBox["\[Alpha]", "2"], "*", 
    RowBox[{"(", 
     RowBox[{"fbtobplusFermilabBD", "+", "fbtob0FermilabBD"}], ")"}], "*", 
    RowBox[{"BrBplustoXsSS", "[", "mS", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PbbbarToSSFermilabBD", "[", 
    RowBox[{"mS_", ",", "\[Alpha]_"}], "]"}], " ", "=", 
   RowBox[{"2", "*", 
    SuperscriptBox["\[Alpha]", "2"], "*", "fbtobsFermilabBD", "*", 
    RowBox[{"BrBstoSS", "[", "mS", "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.885138601881614*^9, 3.885138612670734*^9}, {
   3.8851397810137777`*^9, 3.8851397993943925`*^9}, {3.890276680632747*^9, 
   3.89027668207563*^9}, 3.893484031937849*^9, {3.8935210003893538`*^9, 
   3.8935210003978443`*^9}},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->
  "In[102]:=",ExpressionUUID->"9b723e21-edd1-41ab-a08d-4034810a4f82"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Common function", "Subsection",
 CellChangeTimes->{{3.885138924687282*^9, 3.885138929239553*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"85fa5653-a042-4525-a914-bfefd11eaf67"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Chi]MotherToS", "[", 
        RowBox[{
        "mS_", ",", "\[Theta]2_", ",", "BrhToSS_", ",", "\"\<Bmixing\>\"", 
         ",", "\"\<SPS\>\""}], "]"}], ",", 
       RowBox[{"\[Chi]MotherToS", "[", 
        RowBox[{
        "mS_", ",", "\[Theta]2_", ",", "BrhToSS_", ",", "\"\<Bmixing\>\"", 
         ",", "\"\<FermilabBD\>\""}], "]"}], ",", 
       RowBox[{"\[Chi]MotherToS", "[", 
        RowBox[{
        "mS_", ",", "\[Theta]2_", ",", "BrhToSS_", ",", "\"\<Bmixing\>\"", 
         ",", "\"\<LHC\>\""}], "]"}], ",", 
       RowBox[{"\[Chi]MotherToS", "[", 
        RowBox[{
        "mS_", ",", "\[Theta]2_", ",", "BrhToSS_", ",", "\"\<Bmixing\>\"", 
         ",", "\"\<FCC-hh\>\""}], "]"}]}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PbbbarToS\[Theta]SPS", "[", 
        RowBox[{"mS", ",", "\[Theta]2"}], "]"}], ",", 
       RowBox[{"PbbbarToS\[Theta]FermilabBD", "[", 
        RowBox[{"mS", ",", "\[Theta]2"}], "]"}], ",", 
       RowBox[{"PbbbarToS\[Theta]LHC", "[", 
        RowBox[{"mS", ",", "\[Theta]2"}], "]"}], ",", 
       RowBox[{"PbbbarToS\[Theta]FCChh", "[", 
        RowBox[{"mS", ",", "\[Theta]2"}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Chi]MotherToS", "[", 
        RowBox[{
        "mS_", ",", "\[Theta]2_", ",", "BrhToSS_", ",", "\"\<Bquartic\>\"", 
         ",", "\"\<SPS\>\""}], "]"}], ",", 
       RowBox[{"\[Chi]MotherToS", "[", 
        RowBox[{
        "mS_", ",", "\[Theta]2_", ",", "BrhToSS_", ",", "\"\<Bquartic\>\"", 
         ",", "\"\<FermilabBD\>\""}], "]"}], ",", 
       RowBox[{"\[Chi]MotherToS", "[", 
        RowBox[{
        "mS_", ",", "\[Theta]2_", ",", "BrhToSS_", ",", "\"\<Bquartic\>\"", 
         ",", "\"\<LHC\>\""}], "]"}], ",", 
       RowBox[{"\[Chi]MotherToS", "[", 
        RowBox[{
        "mS_", ",", "\[Theta]2_", ",", "BrhToSS_", ",", "\"\<Bquartic\>\"", 
         ",", "\"\<FCC-hh\>\""}], "]"}]}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PbbbarToSSXsSPS", "[", 
        RowBox[{"mS", ",", 
         RowBox[{"\[Alpha]valBrhToSS", "[", "BrhToSS", "]"}]}], "]"}], ",", 
       RowBox[{"PbbbarToSSXsFermilabBD", "[", 
        RowBox[{"mS", ",", 
         RowBox[{"\[Alpha]valBrhToSS", "[", "BrhToSS", "]"}]}], "]"}], ",", 
       RowBox[{"PbbbarToSSXsLHC", "[", 
        RowBox[{"mS", ",", 
         RowBox[{"\[Alpha]valBrhToSS", "[", "BrhToSS", "]"}]}], "]"}], ",", 
       RowBox[{"PbbbarToSSXsFCChh", "[", 
        RowBox[{"mS", ",", 
         RowBox[{"\[Alpha]valBrhToSS", "[", "BrhToSS", "]"}]}], "]"}]}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Chi]MotherToS", "[", 
        RowBox[{
        "mS_", ",", "\[Theta]2_", ",", "BrhToSS_", ",", "\"\<BsQuartic\>\"", 
         ",", "\"\<SPS\>\""}], "]"}], ",", 
       RowBox[{"\[Chi]MotherToS", "[", 
        RowBox[{
        "mS_", ",", "\[Theta]2_", ",", "BrhToSS_", ",", "\"\<BsQuartic\>\"", 
         ",", "\"\<FermilabBD\>\""}], "]"}], ",", 
       RowBox[{"\[Chi]MotherToS", "[", 
        RowBox[{
        "mS_", ",", "\[Theta]2_", ",", "BrhToSS_", ",", "\"\<BsQuartic\>\"", 
         ",", "\"\<LHC\>\""}], "]"}], ",", 
       RowBox[{"\[Chi]MotherToS", "[", 
        RowBox[{
        "mS_", ",", "\[Theta]2_", ",", "BrhToSS_", ",", "\"\<BsQuartic\>\"", 
         ",", "\"\<FCC-hh\>\""}], "]"}]}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PbbbarToSSSPS", "[", 
        RowBox[{"mS", ",", 
         RowBox[{"\[Alpha]valBrhToSS", "[", "BrhToSS", "]"}]}], "]"}], ",", 
       RowBox[{"PbbbarToSSFermilabBD", "[", 
        RowBox[{"mS", ",", 
         RowBox[{"\[Alpha]valBrhToSS", "[", "BrhToSS", "]"}]}], "]"}], ",", 
       RowBox[{"PbbbarToSSLHC", "[", 
        RowBox[{"mS", ",", 
         RowBox[{"\[Alpha]valBrhToSS", "[", "BrhToSS", "]"}]}], "]"}], ",", 
       RowBox[{"PbbbarToSSFCChh", "[", 
        RowBox[{"mS", ",", 
         RowBox[{"\[Alpha]valBrhToSS", "[", "BrhToSS", "]"}]}], "]"}]}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Chi]MotherToS", "[", 
        RowBox[{
        "mS_", ",", "\[Theta]2_", ",", "BrhToSS_", ",", "\"\<hQuartic\>\"", 
         ",", "\"\<SPS\>\""}], "]"}], ",", 
       RowBox[{"\[Chi]MotherToS", "[", 
        RowBox[{
        "mS_", ",", "\[Theta]2_", ",", "BrhToSS_", ",", "\"\<hQuartic\>\"", 
         ",", "\"\<FermilabBD\>\""}], "]"}], ",", 
       RowBox[{"\[Chi]MotherToS", "[", 
        RowBox[{
        "mS_", ",", "\[Theta]2_", ",", "BrhToSS_", ",", "\"\<hQuartic\>\"", 
         ",", "\"\<LHC\>\""}], "]"}], ",", 
       RowBox[{"\[Chi]MotherToS", "[", 
        RowBox[{
        "mS_", ",", "\[Theta]2_", ",", "BrhToSS_", ",", "\"\<hQuartic\>\"", 
         ",", "\"\<FCC-hh\>\""}], "]"}]}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "BrhToSS", ",", "BrhToSS"}], "}"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8922845437649636`*^9, 3.892284842838256*^9}, {
  3.893521000626264*^9, 3.893521000636236*^9}},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->
  "In[106]:=",ExpressionUUID->"82d15d9f-173e-444e-897d-79df057d5549"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Scalar lifetime and branching ratios", "Section",
 CellChangeTimes->{{3.7725113836218624`*^9, 3.7725113869263587`*^9}, {
  3.826651830998455*^9, 3.826651834218698*^9}, {3.8267130444352474`*^9, 
  3.8267130466742153`*^9}, {3.885139954002949*^9, 3.8851399560519075`*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"990662f6-15c3-4f39-ae61-2c8fc1bd4b2e"],

Cell[CellGroupData[{

Cell["Lifetimes", "Subsection",
 CellChangeTimes->{{3.826651853928807*^9, 3.8266518561959257`*^9}, {
   3.877248260034466*^9, 3.8772482610102777`*^9}, 3.8851399575347958`*^9},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"3dd7b844-8e27-44cd-bb8b-37dac39065de"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Decay", " ", "length", " ", "of", " ", "the", " ", "scalar"}], 
    " ", "-", " ", 
    RowBox[{"following", " ", "Winkler"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"c\[Tau]Scalar", "[", 
      RowBox[{"mS_", ",", "\[Theta]2_"}], "]"}], "=", 
     RowBox[{
      FractionBox["1", "\[Theta]2"], 
      RowBox[{
       RowBox[{"Interpolation", "[", 
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"Import", "[", 
            RowBox[{
             RowBox[{"FileNameJoin", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"NotebookDirectory", "[", "]"}], ",", 
                "\"\<phenomenology/Scalar/decay widths/ctaus.dat\>\""}], 
               "}"}], "]"}], ",", "\"\<Table\>\""}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", "2."}], "&"}]}], 
          "]"}], ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "mS", 
       "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ldecayScalar", "[", 
      RowBox[{"mS_", ",", "\[Theta]2_", ",", "ES_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"c\[Tau]Scalar", "[", 
       RowBox[{"mS", ",", "\[Theta]2"}], "]"}], "*", 
      FractionBox[
       SqrtBox[
        RowBox[{
         SuperscriptBox["ES", "2"], "-", 
         SuperscriptBox["mS", "2"]}]], "mS"]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.772511330414253*^9, 3.772511332354311*^9}, {
   3.772514779363783*^9, 3.7725148170387526`*^9}, {3.77251708054782*^9, 
   3.7725171526046114`*^9}, {3.772517594245166*^9, 3.7725176071347294`*^9}, {
   3.7725177896742334`*^9, 3.7725177907603273`*^9}, {3.8093354843222218`*^9, 
   3.8093355901834927`*^9}, {3.8093356295396957`*^9, 
   3.8093356468961353`*^9}, {3.809335677246994*^9, 3.809335823873495*^9}, {
   3.809335858797107*^9, 3.8093360243295956`*^9}, {3.8093362449839096`*^9, 
   3.809336281446844*^9}, {3.809336314077528*^9, 3.809336323651199*^9}, {
   3.8093363629191656`*^9, 3.809336481558123*^9}, {3.8093365619921303`*^9, 
   3.8093365646011376`*^9}, {3.8093366614104457`*^9, 3.809336745960641*^9}, {
   3.809336785629715*^9, 3.8093368421186905`*^9}, 3.809336878739168*^9, {
   3.809336977625927*^9, 3.809337275539356*^9}, {3.8097998779360805`*^9, 
   3.8097998781868014`*^9}, {3.8200390228054857`*^9, 3.820039037105734*^9}, {
   3.8768058741237946`*^9, 3.8768059830377493`*^9}, {3.87724818706712*^9, 
   3.877248289772291*^9}, {3.87724846538826*^9, 3.877248465695002*^9}, {
   3.8772485378602467`*^9, 3.8772485590050945`*^9}, 3.877248589513381*^9, {
   3.885138135119937*^9, 3.8851381747948804`*^9}, {3.8851388671980467`*^9, 
   3.8851388674088764`*^9}, {3.8851398514495583`*^9, 3.885139940272375*^9}, 
   3.8851399947034616`*^9, {3.8854391939281354`*^9, 3.885439194093272*^9}, 
   3.8884633522036705`*^9, {3.88976941075095*^9, 3.8897694333175917`*^9}, {
   3.892285880564712*^9, 3.892285888957165*^9}, {3.904986694732464*^9, 
   3.90498669489589*^9}},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->
  "In[110]:=",ExpressionUUID->"df1f536d-e756-4790-b2f0-98d1a0089063"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Compilable interpolation function mapping one grid into another\
\>", "Chapter",
 CellChangeTimes->{3.8927117344949155`*^9},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"2068836a-be65-499b-87d8-817d26bdc7f3"],

Cell[CellGroupData[{

Cell["3D to 3D", "Section",
 CellChangeTimes->{{3.890732625178977*^9, 3.890732634660539*^9}, 
   3.8927117366160936`*^9},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"9d0f2e70-ad2a-42a8-ac40-01538efcac90"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nd", "=", "3"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"cf3", "=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"xgvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<xg\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"igvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<ig\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"tgvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<tg\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"ivars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<i\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"svars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<s\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"tvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<t\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"jvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<j\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}]}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Inactivate", "[", 
         RowBox[{
          RowBox[{"Compile", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"seq", "@", 
               RowBox[{"{", 
                RowBox[{"xgvars", ",", "_Real", ",", "1"}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", "_Real", ",", "nd"}], "}"}]}], "}"}], ",", 
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"seq", "@", "igvars"}], ",", 
                RowBox[{"seq", "@", "tgvars"}], ",", 
                RowBox[{"seq", "@", "ivars"}], ",", 
                RowBox[{"seq", "@", "svars"}], ",", 
                RowBox[{"seq", "@", "tvars"}]}], "}"}], ",", 
              RowBox[{
               RowBox[{"seq", "[", 
                RowBox[{"igvars", "=", 
                 RowBox[{
                  RowBox[{"Floor", "[", "xgvars", "]"}], "-", 
                  RowBox[{"UnitStep", "[", 
                   RowBox[{"xgvars", "-", 
                    RowBox[{"indexed", "@", 
                    RowBox[{"Dimensions", "@", "y"}]}]}], "]"}]}]}], "]"}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"seq", "[", 
                RowBox[{"tgvars", "=", 
                 RowBox[{"xgvars", "-", "igvars"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"seq", "[", 
                   RowBox[{"tvars", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"tgvars", ",", "jvars"}], "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"seq", "[", 
                   RowBox[{"ivars", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"igvars", ",", "jvars"}], "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"seq", "[", 
                   RowBox[{"svars", "=", 
                    RowBox[{"1.", "-", "tvars"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"eval", "@", 
                   RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Times", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], " ", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], "]"}]}], 
                    "&"}], "/@", 
                    RowBox[{"Tuples", "@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"svars", ",", "ivars"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"tvars", ",", 
                    RowBox[{"ivars", "+", "1"}]}], "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}]}]}], 
                    "]"}]}]}], ",", 
                 RowBox[{"seq", "@", 
                  RowBox[{"{", 
                   RowBox[{"jvars", ",", 
                    RowBox[{"Length", "@", "igvars"}]}], "}"}]}]}], "]"}]}]}],
              "]"}], ",", 
            RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
            RowBox[{"RuntimeAttributes", "\[Rule]", 
             RowBox[{"{", "Listable", "}"}]}], ",", 
            RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
            RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}], 
          ",", 
          RowBox[{"Except", "[", 
           RowBox[{"seq", "|", "eval", "|", "indexed"}], "]"}]}], "]"}], "/.", 
        RowBox[{
         RowBox[{"seq", "[", "expr_", "]"}], "\[RuleDelayed]", 
         RowBox[{"RuleCondition", "@", 
          RowBox[{"(", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Inactivate", "[", 
                RowBox[{"expr", ",", 
                 RowBox[{"Except", "[", 
                  RowBox[{"slist", "|", "indexed"}], "]"}]}], "]"}], "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"l_slist", "\[RuleDelayed]", 
                  RowBox[{"l", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"indexed", "[", "l_", "]"}], "\[RuleDelayed]", 
                  RowBox[{
                   RowBox[{"Inactive", "[", "Compile`GetElement", "]"}], "[", 
                   RowBox[{"l", ",", "i"}], "]"}]}]}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "nd"}], "}"}]}], "]"}]}], ")"}]}]}]}], "/.", 
       RowBox[{
        RowBox[{"eval", "@", "expr_"}], "\[RuleDelayed]", 
        RowBox[{"RuleCondition", "[", 
         RowBox[{"Activate", "[", 
          RowBox[{"expr", "/.", 
           RowBox[{"slist", "\[Rule]", "List"}]}], "]"}], "]"}]}]}]}], "]"}], 
    "//", "Activate"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.890711783488103*^9, 3.89071178348964*^9}, {
  3.8907121412539587`*^9, 3.8907121413711557`*^9}, {3.890712694841427*^9, 
  3.8907126950000925`*^9}, {3.890712790376151*^9, 3.8907128219919777`*^9}, {
  3.891018553068019*^9, 3.8910185548862777`*^9}, {3.8927120653090277`*^9, 
  3.8927120675685673`*^9}},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->
  "In[112]:=",ExpressionUUID->"ee81d875-13fe-4cd5-807d-efd34a267332"]
}, Open  ]],

Cell[CellGroupData[{

Cell["4D to 4D", "Section",
 CellChangeTimes->{{3.890732625178977*^9, 3.890732634660539*^9}, {
  3.8927117366160936`*^9, 3.8927117442965827`*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"c4fcee20-6a9c-4132-be0d-3e72cbd0356f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nd", "=", "4"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"cf4", "=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"xgvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<xg\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"igvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<ig\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"tgvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<tg\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"ivars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<i\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"svars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<s\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"tvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<t\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"jvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<j\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}]}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Inactivate", "[", 
         RowBox[{
          RowBox[{"Compile", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"seq", "@", 
               RowBox[{"{", 
                RowBox[{"xgvars", ",", "_Real", ",", "1"}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", "_Real", ",", "nd"}], "}"}]}], "}"}], ",", 
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"seq", "@", "igvars"}], ",", 
                RowBox[{"seq", "@", "tgvars"}], ",", 
                RowBox[{"seq", "@", "ivars"}], ",", 
                RowBox[{"seq", "@", "svars"}], ",", 
                RowBox[{"seq", "@", "tvars"}]}], "}"}], ",", 
              RowBox[{
               RowBox[{"seq", "[", 
                RowBox[{"igvars", "=", 
                 RowBox[{
                  RowBox[{"Floor", "[", "xgvars", "]"}], "-", 
                  RowBox[{"UnitStep", "[", 
                   RowBox[{"xgvars", "-", 
                    RowBox[{"indexed", "@", 
                    RowBox[{"Dimensions", "@", "y"}]}]}], "]"}]}]}], "]"}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"seq", "[", 
                RowBox[{"tgvars", "=", 
                 RowBox[{"xgvars", "-", "igvars"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"seq", "[", 
                   RowBox[{"tvars", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"tgvars", ",", "jvars"}], "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"seq", "[", 
                   RowBox[{"ivars", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"igvars", ",", "jvars"}], "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"seq", "[", 
                   RowBox[{"svars", "=", 
                    RowBox[{"1.", "-", "tvars"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"eval", "@", 
                   RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Times", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], " ", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], "]"}]}], 
                    "&"}], "/@", 
                    RowBox[{"Tuples", "@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"svars", ",", "ivars"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"tvars", ",", 
                    RowBox[{"ivars", "+", "1"}]}], "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}]}]}], 
                    "]"}]}]}], ",", 
                 RowBox[{"seq", "@", 
                  RowBox[{"{", 
                   RowBox[{"jvars", ",", 
                    RowBox[{"Length", "@", "igvars"}]}], "}"}]}]}], "]"}]}]}],
              "]"}], ",", 
            RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
            RowBox[{"RuntimeAttributes", "\[Rule]", 
             RowBox[{"{", "Listable", "}"}]}], ",", 
            RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
            RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}], 
          ",", 
          RowBox[{"Except", "[", 
           RowBox[{"seq", "|", "eval", "|", "indexed"}], "]"}]}], "]"}], "/.", 
        RowBox[{
         RowBox[{"seq", "[", "expr_", "]"}], "\[RuleDelayed]", 
         RowBox[{"RuleCondition", "@", 
          RowBox[{"(", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Inactivate", "[", 
                RowBox[{"expr", ",", 
                 RowBox[{"Except", "[", 
                  RowBox[{"slist", "|", "indexed"}], "]"}]}], "]"}], "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"l_slist", "\[RuleDelayed]", 
                  RowBox[{"l", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"indexed", "[", "l_", "]"}], "\[RuleDelayed]", 
                  RowBox[{
                   RowBox[{"Inactive", "[", "Compile`GetElement", "]"}], "[", 
                   RowBox[{"l", ",", "i"}], "]"}]}]}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "nd"}], "}"}]}], "]"}]}], ")"}]}]}]}], "/.", 
       RowBox[{
        RowBox[{"eval", "@", "expr_"}], "\[RuleDelayed]", 
        RowBox[{"RuleCondition", "[", 
         RowBox[{"Activate", "[", 
          RowBox[{"expr", "/.", 
           RowBox[{"slist", "\[Rule]", "List"}]}], "]"}], "]"}]}]}]}], "]"}], 
    "//", "Activate"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8907148978688216`*^9, 3.890714898931299*^9}, {
   3.8910185630697727`*^9, 3.8910185650759544`*^9}, 3.892712062758332*^9},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->
  "In[114]:=",ExpressionUUID->"495b47a0-a9b5-457b-9626-81bf5883ffbc"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Specifying the experiment", "Title",
 CellChangeTimes->{{3.8876178747397523`*^9, 3.8876178773785458`*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"4849bc3c-f2c5-4bec-8c48-2c597d5d139d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Parent", " ", "directory"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NotebookDirectory", "[", "]"}], "//", "ParentDirectory"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AcceptanceDirectory", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Acceptances\>\""}], 
     "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExperimentDirectoriesList", "=", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"FileNames", "[", 
       RowBox[{"\"\<*\>\"", ",", "AcceptanceDirectory", ",", "1"}], "]"}], 
      ",", "DirectoryQ"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"List", " ", "of", " ", "available", " ", "experiments", " ", 
    RowBox[{"(", 
     RowBox[{
     "for", " ", "which", " ", "the", " ", "geometry", " ", "has", " ", 
      "been", " ", "implemented"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentsListTemp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"FileNameTake", "[", 
      RowBox[{
       RowBox[{"ExperimentDirectoriesList", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"-", "1"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "ExperimentDirectoriesList", "]"}], ",", "1"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentsListTemp2", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Partition", "[", 
      RowBox[{"ExperimentsListTemp", ",", "1"}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"TrueQ", "@", 
         RowBox[{"FileExistsQ", "@", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"NotebookDirectory", "[", "]"}], ",", 
             "\"\<Acceptances\>\"", ",", 
             RowBox[{"ExperimentsListTemp", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"ToString", "@", 
              RowBox[{"StringForm", "[", 
               RowBox[{"\"\<Acceptance_``_for_Scalar.m\>\"", ",", 
                RowBox[{"ExperimentsListTemp", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], "}"}], 
           "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "ExperimentsListTemp", "]"}]}], "}"}]}], 
      "]"}], ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<List of available experiments:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ExperimentsList", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{"ExperimentsListTemp2", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "True"}], "&"}]}], "]"}],
     "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", 
   "Sort"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", "ExperimentsList", "]"}], "\[Equal]", "0"}], ",", 
   RowBox[{
   "Print", "[", 
    "\"\<No experiment is available, generate first the acceptance for the \
given experiment using module 1\>\"", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Selected experiments:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"selectionDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", 
      RowBox[{"{", "}"}]}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{
        "{", "\"\<Select the experiments for which the number of events will \
be computed:\>\"", "}"}], "]"}], ",", 
       RowBox[{"Pane", "[", 
        RowBox[{
         RowBox[{"TogglerBar", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list", ",", 
           RowBox[{"Appearance", "->", 
            RowBox[{"\"\<Vertical\>\"", "->", 
             RowBox[{"{", 
              RowBox[{"Automatic", ",", "5"}], "}"}]}]}]}], "]"}], ",", 
         RowBox[{"ImageSize", "->", 
          RowBox[{"{", 
           RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], ",", 
         RowBox[{"Scrollbars", "->", 
          RowBox[{"{", 
           RowBox[{"False", ",", "True"}], "}"}]}]}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"SelectedExperimentList", "=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "ExperimentsList", "]"}], "\[NotEqual]", "0"}], 
    ",", 
    RowBox[{"selectionDialog", "[", 
     RowBox[{"ExperimentsList", ",", "\"\<Select the experiments:\>\""}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"icounter", "=", "1"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8851403254718485`*^9, 3.8851403429411273`*^9}, {
   3.8854395484478483`*^9, 3.885439559226637*^9}, {3.8854397351242537`*^9, 
   3.885439739219259*^9}, {3.8858794196350574`*^9, 3.885879423032172*^9}, {
   3.8865840272667904`*^9, 3.8865840338661537`*^9}, {3.886607744879512*^9, 
   3.886607745774307*^9}, {3.8872732396769423`*^9, 3.887273255436386*^9}, {
   3.887276631938718*^9, 3.887276634618329*^9}, {3.887276937792802*^9, 
   3.8872769418915215`*^9}, {3.887278937383339*^9, 3.887278940392472*^9}, {
   3.887616450031478*^9, 3.887616452738494*^9}, {3.8876165118788147`*^9, 
   3.887616536357917*^9}, {3.887616583272811*^9, 3.887616613175548*^9}, {
   3.887620318755148*^9, 3.8876203205821953`*^9}, {3.8876324144338245`*^9, 
   3.887632416400697*^9}, {3.887772846060255*^9, 3.8877729560180535`*^9}, {
   3.888377893669921*^9, 3.8883779148425026`*^9}, {3.888380182047347*^9, 
   3.888380266214329*^9}, {3.8892622911432314`*^9, 3.8892622916750484`*^9}, {
   3.8922835930044155`*^9, 3.8922836165540304`*^9}, {3.8932346328784227`*^9, 
   3.893234635004322*^9}, {3.8932347150748158`*^9, 3.8932347228556705`*^9}, 
   3.902763628158878*^9, {3.902975358880166*^9, 3.9029753591313515`*^9}},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->
  "In[116]:=",ExpressionUUID->"a9dc099a-58c7-4b4a-87b0-fae273cf5733"],

Cell[CellGroupData[{

Cell["Running block for next sections", "Chapter",
 CellChangeTimes->{{3.902729140157612*^9, 3.90272914444062*^9}},
 CellTags->{
  "Number-of-events", 
   "Acceptance"},ExpressionUUID->"a74112cd-0181-43f7-98cb-cf9ca35460f9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BlockEvaluation", "[", "tag_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nb", "=", 
      RowBox[{"EvaluationNotebook", "[", "]"}]}], ";", "\n", 
     RowBox[{"NotebookFind", "[", 
      RowBox[{"nb", ",", "tag", ",", "All", ",", "CellTags"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"tagselected", "==", "\"\<Number-of-events\>\""}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
      "BlockEvaluation", "[", "\"\<Number-of-events-computation\>\"", "]"}], 
      ";"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"icounter", ",", "1", ",", 
       RowBox[{"Length", "[", "SelectedExperimentList", "]"}], ",", "1"}], 
      "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"tagselected", "==", "\"\<Acceptance\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
        "BlockEvaluation", "[", "\"\<Acceptance-computation\>\"", "]"}], 
        ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"icounter", ",", "1", ",", 
         RowBox[{"Length", "[", "SelectedExperimentList", "]"}], ",", "1"}], 
        "}"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.9027291581950865`*^9, 3.902729215695462*^9}, {
  3.902761777481885*^9, 3.902761802513644*^9}, {3.9029753543924875`*^9, 
  3.902975356561885*^9}},
 CellTags->{"Number-of-events", "Acceptance"},
 CellLabel->
  "In[130]:=",ExpressionUUID->"188a1091-0abe-4645-9955-08d60cc3dc98"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Number of events", "Title",
 CellChangeTimes->{{3.885140281753849*^9, 3.8851402836781845`*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"128d78c3-8bd2-4cc0-aade-\
f5ea999c5498"],

Cell[CellGroupData[{

Cell["Cross-sections, acceptances", "Chapter",
 CellChangeTimes->{{3.885020695565913*^9, 3.885020698644303*^9}, {
   3.8866052332485933`*^9, 3.8866052373066683`*^9}, 3.887617904598539*^9, {
   3.8946364579474945`*^9, 3.8946364660788918`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"cae25615-bc01-481f-b6ea-\
4be09eb8d2a0"],

Cell[CellGroupData[{

Cell["Cross-sections, acceptances", "Section",
 CellChangeTimes->{{3.896951487357441*^9, 3.8969514978868237`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"5a2b7762-40d4-4411-b7b6-\
8f75b4fff483"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SelectedExperiment", "=", 
   RowBox[{"SelectedExperimentList", "[", 
    RowBox[{"[", 
     RowBox[{"icounter", "++"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dataAcceptances", "=", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<Acceptances\>\"", ",", "SelectedExperiment", ",", 
           RowBox[{"ToString", "@", 
            RowBox[{"StringForm", "[", 
             RowBox[{
             "\"\<Acceptance_``_for_Scalar.m\>\"", ",", 
              "SelectedExperiment"}], "]"}]}]}], "}"}], "]"}], "}"}], "]"}], 
      ",", "\"\<MX\>\""}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FacilityGivenExperiment", "=", 
   RowBox[{"dataAcceptances", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ECALoption", "=", 
   RowBox[{"dataAcceptances", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullAcceptanceData0", "=", 
   RowBox[{"dataAcceptances", "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BrVisTemp", "[", "mFIP_", "]"}], "=", 
   RowBox[{"dataAcceptances", "[", 
    RowBox[{"[", "5", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlistBr", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{"m", ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "0.02", ",", "5.1", ",", "0.001"}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"Table", "[", 
      RowBox[{"m", ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "5.12", ",", "13.12", ",", "0.01"}], "}"}]}], "]"}],
      ",", 
     RowBox[{"Table", "[", 
      RowBox[{"m", ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "13.2", ",", "62.5", ",", "0.1"}], "}"}]}], "]"}]}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BrVis", "[", "mFIP_", "]"}], "=", 
    RowBox[{
     RowBox[{"Interpolation", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"mFIP", ",", 
           RowBox[{"BrVisTemp", "[", "mFIP", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"mFIP", ",", "mlistBr"}], "}"}]}], "]"}], ",", 
       RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", "mFIP", 
     "]"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{"LogLogPlot", "[", 
  RowBox[{
   RowBox[{"BrVis", "[", "mFIP", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"mFIP", ",", "0.02", ",", "62.5"}], "}"}], ",", 
   RowBox[{"Frame", "->", "True"}], ",", 
   RowBox[{"ImageSize", "->", "Large"}], ",", 
   RowBox[{"FrameStyle", "\[Rule]", 
    RowBox[{"Directive", "[", 
     RowBox[{"Black", ",", " ", "22"}], "]"}]}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Blue"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
        RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
        RowBox[{"Darker", "@", 
         RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Black"}], "}"}]}], 
     "}"}]}], ",", 
   RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"MinMax", "[", "mlistBr", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.01", ",", "1.2"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<m [GeV]\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(Br\), \(vis\)]\)\>\""}], "}"}]}], ",", 
   RowBox[{"PlotLabel", "\[Rule]", " ", 
    RowBox[{"Style", "[", 
     RowBox[{
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<For \>\"", ",", "SelectedExperiment"}], "}"}], "]"}], 
      ",", " ", "20", ",", " ", "Black"}], "]"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Theta]minExpAll", ",", "\[Theta]maxExpAll"}], "}"}], "=", 
   RowBox[{"MinMax", "[", 
    RowBox[{"FullAcceptanceData0", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Theta]minExp", ",", "\[Theta]maxExp"}], "}"}], "=", 
   RowBox[{"MinMax", "[", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"FullAcceptanceData0", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "6", "]"}], "]"}], "\[NotEqual]", "0"}], "&"}]}], 
      "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"zminExp", ",", "zmaxExp"}], "}"}], "=", 
   RowBox[{"MinMax", "[", 
    RowBox[{"FullAcceptanceData0", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AzimuthalAcceptanceData", "=", 
    RowBox[{
     RowBox[{"DeleteDuplicatesBy", "[", 
      RowBox[{"FullAcceptanceData0", ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "&"}]}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "4", ",", "5"}], "}"}]}], "]"}], "]"}]}], ";"}], "//",
   "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]Grid", "=", 
   RowBox[{"DeleteDuplicates", "[", 
    RowBox[{"AzimuthalAcceptanceData", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zminmax\[Theta]data", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"MinMax", "[", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"AzimuthalAcceptanceData", ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "==", 
            RowBox[{"\[Theta]Grid", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "&&", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "\[NotEqual]", "0"}]}], "&"}]}], 
        "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "\[Theta]Grid", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zmin\[Theta]", "[", "\[Theta]S_", "]"}], "=", 
   RowBox[{
    RowBox[{"Interpolation", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{"\[Theta]Grid", ",", "1"}], "]"}], ",", 
        RowBox[{"zminmax\[Theta]data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", "1", "}"}]}], "]"}], "]"}], ",", "2"}], "]"}], ",", 
      RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
    "\[Theta]S", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zmax\[Theta]", "[", "\[Theta]S_", "]"}], "=", 
   RowBox[{
    RowBox[{"Interpolation", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{"\[Theta]Grid", ",", "1"}], "]"}], ",", 
        RowBox[{"zminmax\[Theta]data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}], "]"}], ",", "2"}], "]"}], ",", 
      RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
    "\[Theta]S", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AzimuthalAcceptanceScalar", "[", 
    RowBox[{"\[Theta]S_", ",", "zS_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Interpolation", "[", 
     RowBox[{"AzimuthalAcceptanceData", ",", 
      RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
    RowBox[{"\[Theta]S", ",", "zS"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DecAccDataLogarithmizedComp", "=", 
   RowBox[{
    RowBox[{"Hold", "@", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"FullAcceptanceData", ",", "_Real", ",", "2"}], "}"}], "}"}],
        ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Log10", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"Log10", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "4", "]"}], "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "6", "]"}], "]"}], "\[NotEqual]", "0"}], ",", 
             RowBox[{"Log10", "[", 
              RowBox[{"#", "[", 
               RowBox[{"[", "6", "]"}], "]"}], "]"}], ",", 
             RowBox[{"-", "90."}]}], "]"}]}], "}"}], "&"}], "/@", 
        "FullAcceptanceData"}]}], "]"}]}], "//", "ReleaseHold"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"DecayAcceptanceScalar", "[", 
      RowBox[{"mS_", ",", "\[Theta]S_", ",", "ES_", ",", "zS_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"BrVis", "[", "mS", "]"}], "*", 
      RowBox[{"10", "^", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{
           RowBox[{
           "DecAccDataLogarithmizedComp", "[", "FullAcceptanceData0", "]"}], 
           ",", 
           RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
         RowBox[{
          RowBox[{"Log10", "[", "mS", "]"}], ",", "\[Theta]S", ",", 
          RowBox[{"Log10", "[", "ES", "]"}], ",", "zS"}], "]"}], ")"}]}]}]}], 
    ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Interpolation", " ", "for", " ", "the", " ", "full", " ", "acceptance"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"acccomp", "=", 
    RowBox[{
     RowBox[{"Hold", "@", 
      RowBox[{"Compile", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"data", ",", "_Real", ",", "2"}], "}"}], "}"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Log10", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
            RowBox[{"Log10", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
            RowBox[{"Log10", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
            RowBox[{"Log10", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "4", "]"}], "]"}], "]"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "5", "]"}], "]"}], "*", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "6", "]"}], "]"}]}], "\[Equal]", "0"}], ",", 
              RowBox[{"-", "90"}], ",", 
              RowBox[{"Log10", "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "5", "]"}], "]"}], "*", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "6", "]"}], "]"}]}], "]"}]}], "]"}]}], "}"}], 
          "&"}], "/@", 
         RowBox[{"SortBy", "[", 
          RowBox[{"data", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "&"}]}], "]"}]}]}], 
       "]"}]}], "//", "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Interpolation", " ", "for", " ", "the", " ", "full", " ", "acceptance"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FullAcceptanceData", "=", 
    RowBox[{"acccomp", "[", "FullAcceptanceData0", "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FullAcceptanceScalar", "[", 
     RowBox[{"mS_", ",", "\[Theta]S_", ",", "ES_", ",", "zS_"}], "]"}], "=", 
    RowBox[{"10", "^", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Interpolation", "[", 
        RowBox[{"FullAcceptanceData", ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
       RowBox[{
        RowBox[{"Log10", "[", "mS", "]"}], ",", 
        RowBox[{"Log10", "[", "\[Theta]S", "]"}], ",", 
        RowBox[{"Log10", "[", "ES", "]"}], ",", 
        RowBox[{"Log10", "[", "zS", "]"}]}], "]"}], ")"}]}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dataCrossSections", "=", 
   RowBox[{
    RowBox[{"dataAcceptances", "[", 
     RowBox[{"[", "4", "]"}], "]"}], "//", "Transpose"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NpotGivenExperiment", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"dataCrossSections", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<Npot\>\""}], 
          "&"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], "//", "N"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"infoDialog", "[", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{
      "\"\<The number of proton collisions is \>\"", ",", " ", 
       "NpotGivenExperiment", ",", 
       "\"\<. You may change it at the stage of computing the sensitivities\>\
\""}], "}"}], "]"}], "]"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Total", " ", "number", " ", "of", " ", "b", " ", 
    OverscriptBox["b", "_"], " ", "and", " ", "h"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Chi]Prod", "[", "\"\<Bmixing\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"\[Chi]Prod", "[", "\"\<Bquartic\>\"", "]"}], "=", 
    RowBox[{
     RowBox[{"\[Chi]Prod", "[", "\"\<BsQuartic\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"dataCrossSections", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<Pb\>\""}], 
          "&"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Chi]Prod", "[", "\"\<hQuartic\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"dataCrossSections", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<Ph\>\""}], "&"}]}],
       "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(\[Chi]\), \(b\\\ or\\\ \*OverscriptBox[\(b\), \
\(_\)]\)]\)\>\"", ",", "\"\<\!\(\*SubscriptBox[\(\[Chi]\), \(h\)]\)\>\""}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Chi]Prod", "[", "\"\<Bmixing\>\"", "]"}], ",", 
      RowBox[{"\[Chi]Prod", "[", "\"\<hQuartic\>\"", "]"}]}], "}"}]}], "}"}], 
  "//", "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{
   "\"\<Search for scalars at \>\"", ",", " ", "SelectedExperiment", ",", 
    " ", "\"\< located at \>\"", ",", "FacilityGivenExperiment", ",", 
    "\"\<. \!\(\*SubscriptBox[\(N\), \(collisions\)]\) = \>\"", ",", 
    "NpotGivenExperiment"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\"\<Quantity\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(min\)]\), rad\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(max\)]\), rad\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(min\)]\)(\!\(\*SubscriptBox[\(\
\[Epsilon]\), \(dec\)]\)), rad\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(max\)]\)(\!\(\*SubscriptBox[\(\
\[Epsilon]\), \(dec\)]\)), rad\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(z\), \(min\)]\), m\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(z\), \(max\)]\), m\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Description\>\"", ",", "\"\<Min angle covered by experiment\>\"", 
      ",", "\"\<Max angle covered by experiment\>\"", ",", 
      "\"\<Min angle where \!\(\*SubscriptBox[\(\[Epsilon]\), \(decay\)]\)\
\[NotEqual]0\>\"", ",", 
      "\"\<Max angle where \!\(\*SubscriptBox[\(\[Epsilon]\), \(decay\)]\)\
\[NotEqual]0\>\"", ",", "\"\<Min long. displacement of the decay volume\>\"", 
      ",", "\"\<Max long. displacement of the decay volume\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Value\>\"", ",", "\[Theta]minExpAll", ",", "\[Theta]maxExpAll", ",",
       "\[Theta]minExp", ",", "\[Theta]maxExp", ",", "zminExp", ",", 
      "zmaxExp"}], "}"}]}], "}"}], "//", "TableForm"}]}], "Input",
 CellChangeTimes->{{3.887616632812935*^9, 3.8876168497686005`*^9}, {
   3.888251530196273*^9, 3.8882515340160594`*^9}, 3.8882534456879063`*^9, {
   3.8884784564935985`*^9, 3.888478513515301*^9}, {3.889769450733754*^9, 
   3.8897695160785046`*^9}, {3.890276444268669*^9, 3.8902765197982826`*^9}, {
   3.8902769753320246`*^9, 3.890277063848443*^9}, {3.89029301158574*^9, 
   3.8902930326548223`*^9}, {3.890450545303482*^9, 3.8904505545644875`*^9}, {
   3.8906407235353084`*^9, 3.8906407314124126`*^9}, {3.8906408349101224`*^9, 
   3.8906408684018974`*^9}, {3.890640931765955*^9, 3.8906411157907934`*^9}, {
   3.8906413239966087`*^9, 3.890641351146014*^9}, {3.8906416293135357`*^9, 
   3.8906417006238556`*^9}, 3.890649737845924*^9, {3.8907327710594864`*^9, 
   3.8907328244291196`*^9}, {3.890841045817673*^9, 3.8908410473572907`*^9}, {
   3.8908411795939927`*^9, 3.8908412559394007`*^9}, {3.8908816406962395`*^9, 
   3.8908816414138947`*^9}, {3.8910185044000244`*^9, 
   3.8910185055215836`*^9}, {3.891018598736998*^9, 3.8910186531034822`*^9}, {
   3.8910187603916593`*^9, 3.8910188102489433`*^9}, {3.8910189914791217`*^9, 
   3.8910190052678776`*^9}, {3.8910190582236977`*^9, 
   3.8910190891531334`*^9}, {3.8910191525376396`*^9, 
   3.8910191962576494`*^9}, {3.8910192415536337`*^9, 3.891019242051064*^9}, {
   3.891019278738369*^9, 3.891019289551962*^9}, {3.8922836313067636`*^9, 
   3.892283672257635*^9}, {3.8922839861466465`*^9, 3.892284023704517*^9}, {
   3.8922848675053596`*^9, 3.8922848910145073`*^9}, {3.892286670688157*^9, 
   3.892286670906936*^9}, {3.8925415783035374`*^9, 3.892541579018721*^9}, {
   3.892910981609494*^9, 3.8929109821176815`*^9}, {3.8931718223536196`*^9, 
   3.8931718380115795`*^9}, {3.89322450856604*^9, 3.893224512604451*^9}, {
   3.8946364771706233`*^9, 3.894636590020763*^9}, {3.8946366257009597`*^9, 
   3.894636704342059*^9}, {3.894637111414814*^9, 3.894637139145834*^9}, {
   3.895054585436878*^9, 3.895054597657593*^9}, {3.897208167605433*^9, 
   3.8972081790966396`*^9}, 3.8972082634740195`*^9, {3.899198048024173*^9, 
   3.899198070580115*^9}, {3.9026481259639745`*^9, 3.902648129112234*^9}, {
   3.9027636496644955`*^9, 3.902763650168706*^9}, {3.904889793908601*^9, 
   3.9048897953457546`*^9}, {3.904898805074805*^9, 3.904898805137748*^9}, {
   3.9048989514118404`*^9, 3.9048990615643806`*^9}, {3.9049020270890265`*^9, 
   3.9049020378968315`*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[132]:=",ExpressionUUID->"7b50f7c1-8794-4b1c-9865-2720540ddacb"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["FIP angle-energy distributions for the given experiment", "Chapter",
 CellChangeTimes->{{3.885020702966837*^9, 3.885020711525731*^9}, {
  3.8850216924759345`*^9, 3.8850216984444695`*^9}, {3.8851404110391607`*^9, 
  3.8851404117847*^9}, {3.887617886112608*^9, 3.8876178892728467`*^9}, {
  3.8937319703346663`*^9, 3.893731971979699*^9}, {3.897229058985351*^9, 
  3.8972290631420875`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"775c9f90-cfc2-4104-a914-\
805ee6203cb5"],

Cell[CellGroupData[{

Cell["Checking whether all distributions are present", "Section",
 CellChangeTimes->{{3.8850207275443482`*^9, 3.885020730624566*^9}, 
   3.8850217020674453`*^9, {3.8851404135605536`*^9, 3.8851404142703238`*^9}, {
   3.8934405687679453`*^9, 3.893440576256995*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"156da2f8-c95e-4643-9f69-\
1214d81706da"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ScalarDistributionFileNames", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ToString", "@", 
        RowBox[{"StringForm", "[", 
         RowBox[{"\"\<DoubleDistr-Scalars-From-B-mixing-``.dat\>\"", ",", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"{", "FacilityGivenExperiment", "}"}]}]}], "]"}]}], ",", 
       RowBox[{"ToString", "@", 
        RowBox[{"StringForm", "[", 
         RowBox[{"\"\<DoubleDistr-Scalars-From-B-quartic-``.dat\>\"", ",", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"{", "FacilityGivenExperiment", "}"}]}]}], "]"}]}], ",", 
       RowBox[{"ToString", "@", 
        RowBox[{"StringForm", "[", 
         RowBox[{"\"\<DoubleDistr-Scalars-From-Bs-quartic-``.dat\>\"", ",", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"{", "FacilityGivenExperiment", "}"}]}]}], "]"}]}]}], 
      "}"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"FacilityGivenExperiment", "==", "\"\<LHC\>\""}], "||", 
        RowBox[{"FacilityGivenExperiment", "==", "\"\<FCC-hh\>\""}]}], ",", 
       RowBox[{"{", 
        RowBox[{"ToString", "@", 
         RowBox[{"StringForm", "[", 
          RowBox[{"\"\<DoubleDistr-Scalars-From-h-quartic-``.dat\>\"", ",", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"{", "FacilityGivenExperiment", "}"}]}]}], "]"}]}], "}"}],
        ",", 
       RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"!", 
      RowBox[{"TrueQ", "@", 
       RowBox[{"FileExistsQ", "@", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<spectra/New physics particles spectra/Scalars/\>\"", ",", 
           RowBox[{"ScalarDistributionFileNames", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "}"}], "]"}]}]}]}], ",", 
     RowBox[{"Print", "[", 
      RowBox[{
       RowBox[{"ScalarDistributionFileNames", "[", 
        RowBox[{"[", "j", "]"}], "]"}], ",", 
       "\"\< does not exist. Generate it using module 2!\>\""}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "1", ",", 
     RowBox[{"Length", "[", "ScalarDistributionFileNames", "]"}], ",", "1"}], 
    "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<Production channels list:\>\"", "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Production", " ", "from", " ", "Higgses", " ", "only"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductionListNoBrem", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<Bmixing\>\"", ",", "\"\<Bquartic\>\"", ",", "\"\<BsQuartic\>\""}], 
      "}"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"FacilityGivenExperiment", "==", "\"\<LHC\>\""}], "||", 
        RowBox[{"FacilityGivenExperiment", "==", "\"\<FCC-hh\>\""}]}], ",", 
       RowBox[{"{", "\"\<hQuartic\>\"", "}"}], ",", 
       RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ProductionList", "=", 
  RowBox[{"Join", "[", 
   RowBox[{"ProductionListNoBrem", ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"FacilityGivenExperiment", "==", "\"\<FermilabBD\>\""}], "&&", 
       RowBox[{"\[Theta]minExp", "<", 
        RowBox[{
        "\[Theta]maxBremFacility", "[", "FacilityGivenExperiment", "]"}]}]}], 
      ",", 
      RowBox[{"{", "\"\<Brem\>\"", "}"}], ",", 
      RowBox[{"{", "}"}]}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.892283740756733*^9, 3.8922838504759393`*^9}, {
   3.8922838863696365`*^9, 3.8922839221243725`*^9}, {3.893951469917242*^9, 
   3.8939515107103047`*^9}, {3.893951568461548*^9, 3.893951595510791*^9}, {
   3.893951773198496*^9, 3.8939517742606277`*^9}, {3.893952025635991*^9, 
   3.8939520283035836`*^9}, {3.89395206385442*^9, 3.8939520669454994`*^9}, 
   3.896713623387891*^9, {3.8968452081039066`*^9, 3.896845208914568*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[162]:=",ExpressionUUID->"ec7c31f0-2c3d-491e-ad87-31a9562869f5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Importing and interpolating", "Section",
 CellChangeTimes->{{3.8850207275443482`*^9, 3.885020730624566*^9}, 
   3.8850217020674453`*^9, {3.8851404135605536`*^9, 3.8851404142703238`*^9}, {
   3.8934405687679453`*^9, 3.8934405864094877`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"59663584-f04d-4861-9888-\
759394628663"],

Cell[CellGroupData[{

Cell["Importing distributions", "Subsection",
 CellChangeTimes->{{3.885021707174692*^9, 3.8850217096287813`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"e5eaebc3-b32f-410a-bd0f-\
d31d7689e52c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dataDistr", "[", "filename_", "]"}], ":=", 
  RowBox[{"Import", "[", 
   RowBox[{
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", 
       "\"\<spectra/New physics particles spectra/Scalars/\>\"", ",", 
       "filename"}], "}"}], "]"}], ",", "\"\<Table\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{"(*", 
    RowBox[{
    "Data", " ", "with", " ", "the", " ", "tabulated", " ", "distribution"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"DataDistrScalar", "[", 
       RowBox[{"ProductionList", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}], "=", 
      RowBox[{"dataDistr", "[", 
       RowBox[{"ScalarDistributionFileNames", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Its", " ", "interpolation"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DoubleDistrScalar", "[", 
       RowBox[{"mS_", ",", "\[Theta]S_", ",", "ES_", ",", 
        RowBox[{"ProductionList", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "=", 
      RowBox[{"10", "^", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Log10", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
               RowBox[{"Log10", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
               RowBox[{"Log10", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
               RowBox[{"Log10", "[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "4", "]"}], "]"}], "+", 
                 SuperscriptBox["10", 
                  RowBox[{"-", "90"}]]}], "]"}]}], "}"}], "&"}], "/@", 
            RowBox[{"DataDistrScalar", "[", 
             RowBox[{"ProductionList", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
         RowBox[{
          RowBox[{"Log10", "[", "mS", "]"}], ",", 
          RowBox[{"Log10", "[", "\[Theta]S", "]"}], ",", 
          RowBox[{"Log10", "[", "ES", "]"}]}], "]"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Min", "/", "mass"}], " ", "mass", " ", "of", " ", "the", " ", 
       "FIP", " ", "from", " ", "the", " ", "data"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mlistScalar", "[", 
       RowBox[{"ProductionList", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}], "=", 
      RowBox[{"DeleteDuplicates", "[", 
       RowBox[{
        RowBox[{"DataDistrScalar", "[", 
         RowBox[{"ProductionList", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"mSmin", "[", 
         RowBox[{"ProductionList", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
        RowBox[{"mSmax", "[", 
         RowBox[{"ProductionList", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}], "=", 
      RowBox[{"MinMax", "[", 
       RowBox[{"mlistScalar", "[", 
        RowBox[{"ProductionList", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Probability", " ", "to", " ", "produce", " ", "the", " ", "scalar", 
       " ", "per", " ", "PoT"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Chi]Xtimes\[Chi]XtoScalar", "[", 
       RowBox[{"mS_", ",", "\[Theta]2_", ",", "BrhToSS_", ",", 
        RowBox[{"ProductionList", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "=", 
      RowBox[{
       RowBox[{"\[Chi]Prod", "[", 
        RowBox[{"ProductionList", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], "*", 
       RowBox[{"\[Chi]MotherToS", "[", 
        RowBox[{"mS", ",", "\[Theta]2", ",", "BrhToSS", ",", 
         RowBox[{"ProductionList", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", "FacilityGivenExperiment"}], 
        "]"}]}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "ProductionListNoBrem", "]"}], ",", "1"}], 
     "}"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"For", " ", "brem"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"FacilityGivenExperiment", "==", "\"\<FermilabBD\>\""}], "&&", 
    RowBox[{"\[Theta]minExp", "<", 
     RowBox[{
     "\[Theta]maxBremFacility", "[", "FacilityGivenExperiment", "]"}]}]}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DataDistrScalar", "[", "\"\<Brem\>\"", "]"}], "=", 
     RowBox[{"TableBremDistr", "[", 
      RowBox[{
      "\[Theta]minExp", ",", "\[Theta]maxExp", ",", 
       "FacilityGivenExperiment"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DoubleDistrScalar", "[", 
      RowBox[{"mS_", ",", "\[Theta]S_", ",", "ES_", ",", "\"\<Brem\>\""}], 
      "]"}], "=", 
     RowBox[{"10", "^", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Log10", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
              RowBox[{"Log10", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
              RowBox[{"Log10", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
              RowBox[{"Log10", "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "4", "]"}], "]"}], "+", 
                SuperscriptBox["10", 
                 RowBox[{"-", "90"}]]}], "]"}]}], "}"}], "&"}], "/@", 
           RowBox[{"DataDistrScalar", "[", "\"\<Brem\>\"", "]"}]}], ",", 
          RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
        RowBox[{
         RowBox[{"Log10", "[", "mS", "]"}], ",", 
         RowBox[{"Log10", "[", "\[Theta]S", "]"}], ",", 
         RowBox[{"Log10", "[", "ES", "]"}]}], "]"}], ")"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mlistScalar", "[", "\"\<Brem\>\"", "]"}], "=", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{
       RowBox[{"DataDistrScalar", "[", "\"\<Brem\>\"", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"mSmin", "[", "\"\<Brem\>\"", "]"}], ",", 
       RowBox[{"mSmax", "[", "\"\<Brem\>\"", "]"}]}], "}"}], "=", 
     RowBox[{"MinMax", "[", 
      RowBox[{"mlistScalar", "[", "\"\<Brem\>\"", "]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Chi]Xtimes\[Chi]XtoScalar", "[", 
      RowBox[{
      "mS_", ",", "\[Theta]2_", ",", "BrhToSS_", ",", "\"\<Brem\>\""}], "]"}],
      "=", 
     RowBox[{"PbremFacility", "[", 
      RowBox[{"mS", ",", "\[Theta]2", ",", "FacilityGivenExperiment"}], 
      "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DirectoryQ", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<Auxiliary data/Scalars\>\"", ",", "SelectedExperiment"}], 
          "}"}], "]"}], "]"}], "//", "ToString"}], ")"}], "\[Equal]", 
     "\"\<False\>\""}], ",", 
    RowBox[{"CreateDirectory", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<Auxiliary data/Scalars\>\"", ",", "SelectedExperiment"}], "}"}], 
      "]"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<Auxiliary data/Scalars\>\"", ",", "SelectedExperiment", ",", 
      "\"\<Double-Distr-Averaged-Scalars.m\>\""}], "}"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"mSmin", "[", "prod", "]"}], "<", "mS", "<", 
          RowBox[{"mSmax", "[", "prod", "]"}]}], ",", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"\[Chi]Xtimes\[Chi]XtoScalar", "[", 
           RowBox[{"mS", ",", "\[Theta]2", ",", "BrhToSS", ",", "prod"}], 
           "]"}], "]"}], ",", "0"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ",", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"mSmin", "[", "prod", "]"}], "<", "mS", "<", 
            RowBox[{"mSmax", "[", "prod", "]"}]}], ",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"\[Chi]Xtimes\[Chi]XtoScalar", "[", 
             RowBox[{"mS", ",", "\[Theta]2", ",", "BrhToSS", ",", "prod"}], 
             "]"}], "]"}], ",", "0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}]], 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"mSmin", "[", "prod", "]"}], "<", "mS", "<", 
           RowBox[{"mSmax", "[", "prod", "]"}]}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"\[Chi]Xtimes\[Chi]XtoScalar", "[", 
             RowBox[{"mS", ",", "\[Theta]2", ",", "BrhToSS", ",", "prod"}], 
             "]"}], "*", 
            RowBox[{"DoubleDistrScalar", "[", 
             RowBox[{"mS", ",", "\[Theta]S", ",", "ES", ",", "prod"}], 
             "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}]}]}], "}"}], 
   ",", "\"\<MX\>\""}], "]"}]}], "Input",
 CellChangeTimes->{{3.885439467061742*^9, 3.885439478554178*^9}, {
   3.8854395866810803`*^9, 3.885439721624913*^9}, {3.885439773115856*^9, 
   3.8854397786227837`*^9}, {3.885439884692011*^9, 3.88544004900488*^9}, {
   3.885449061634671*^9, 3.885449079115692*^9}, {3.88544918407437*^9, 
   3.885449194723466*^9}, {3.8854505516411715`*^9, 3.8854505530614524`*^9}, {
   3.885452711851215*^9, 3.88545272923171*^9}, {3.8854527922834806`*^9, 
   3.885452792400185*^9}, 3.885548406217807*^9, {3.885972154091359*^9, 
   3.8859721564984846`*^9}, {3.886585249825025*^9, 3.886585266948341*^9}, {
   3.8865854466521883`*^9, 3.8865854496398144`*^9}, {3.888138671218892*^9, 
   3.8881387468895817`*^9}, {3.8881387839254723`*^9, 3.888138784119217*^9}, {
   3.888384416967936*^9, 3.8883844469836826`*^9}, {3.888384493695078*^9, 
   3.888384508052363*^9}, {3.888384593592638*^9, 3.8883845967693973`*^9}, {
   3.8884212576018724`*^9, 3.8884212582163525`*^9}, {3.8886382878760624`*^9, 
   3.8886382878760624`*^9}, {3.8902768085054264`*^9, 3.89027680851344*^9}, {
   3.8902770840847588`*^9, 3.890277146773518*^9}, {3.8906417393167086`*^9, 
   3.890641739426749*^9}, {3.89084140108252*^9, 3.8908414918376117`*^9}, 
   3.890841824089222*^9, {3.890902083951818*^9, 3.8909020954893856`*^9}, {
   3.89101930997631*^9, 3.8910193819836884`*^9}, {3.891071372078229*^9, 
   3.8910714155318174`*^9}, {3.8910721345422764`*^9, 
   3.8910721347021112`*^9}, {3.892283937775045*^9, 3.8922839437523723`*^9}, {
   3.8922842461445265`*^9, 3.8922843991752644`*^9}, {3.8922844354849987`*^9, 
   3.892284440124961*^9}, 3.8922848598084927`*^9, {3.8922849084281664`*^9, 
   3.8922849334978*^9}, {3.892285021865942*^9, 3.8922850361556883`*^9}, {
   3.8922851798161974`*^9, 3.892285180387221*^9}, {3.8922853177443666`*^9, 
   3.8922853230844746`*^9}, {3.892545929202096*^9, 3.8925459353680096`*^9}, {
   3.8939515541398945`*^9, 3.8939515587057486`*^9}, {3.8939516166598845`*^9, 
   3.8939516968581824`*^9}, {3.89395173140051*^9, 3.893951732718298*^9}, {
   3.8939517791695995`*^9, 3.893951830594865*^9}, {3.8939520097713947`*^9, 
   3.893952016440461*^9}, 3.893952075562456*^9, {3.8939560443460665`*^9, 
   3.893956044503422*^9}, {3.894127612026785*^9, 3.8941276334979515`*^9}, {
   3.8972084676037226`*^9, 3.8972084829175*^9}, {3.9027282115935183`*^9, 
   3.9027282676900635`*^9}, {3.902887886717127*^9, 3.902887889643217*^9}, {
   3.9050189557070894`*^9, 3.9050189628786516`*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[167]:=",ExpressionUUID->"76f4913e-254e-43a7-9a51-c2b0b48d43a8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Determining min/max energies of scalars for the given polar angle. Needed for \
better stability of Monte-Carlo integration\
\>", "Subsection",
 CellChangeTimes->{{3.8850217140541673`*^9, 3.8850217339343953`*^9}, {
  3.885449618401306*^9, 3.8854496389805627`*^9}, {3.89323960141442*^9, 
  3.893239602262422*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"e4c3cc8c-3bd7-4b50-8c99-\
3abaa32f3378"],

Cell[CellGroupData[{

Cell["Common definition", "Subsubsection",
 CellChangeTimes->{{3.8851480658530207`*^9, 3.885148069648714*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"7f24cf1e-7678-4346-8ebd-\
675da6011508"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EfromXmax", "[", 
   RowBox[{"mass_", ",", "data_", ",", "LogMin_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "distr", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"datt", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"data", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "mass"}], "&"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"EmaxVal", "=", 
      RowBox[{
       RowBox[{"datt", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "3"}], "]"}], "]"}], "//", "Max"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Theta]list", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"x", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "\[Theta]minExp", ",", "\[Theta]maxExp", ",", 
          FractionBox[
           RowBox[{"(", 
            RowBox[{"\[Theta]maxExp", "-", "\[Theta]minExp"}], ")"}], "5"]}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"distr", "[", 
       RowBox[{"\[Theta]fip_", ",", "Efip_"}], "]"}], "=", 
      RowBox[{"Abs", "[", 
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", "3", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "4", "]"}], "]"}], "+", 
                SuperscriptBox["10", 
                 RowBox[{"-", "90"}]]}]}], "}"}], "&"}], "/@", "datt"}], ",", 
           RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
         RowBox[{"\[Theta]fip", ",", "Efip"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DoubleDistrIntList", "[", "i_", "]"}], ":=", 
      RowBox[{
       RowBox[{"Interpolation", "[", 
        RowBox[{
         RowBox[{"ParallelTable", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Efip", ",", 
             RowBox[{"Quiet", "[", 
              RowBox[{"NIntegrate", "[", 
               RowBox[{
                RowBox[{"distr", "[", 
                 RowBox[{"\[Theta]fip", ",", "Efip"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"\[Theta]fip", ",", 
                  RowBox[{"\[Theta]list", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", 
                  RowBox[{"\[Theta]list", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"Method", "\[Rule]", "\"\<AdaptiveMonteCarlo\>\""}]}],
                "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Efip", ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               SuperscriptBox["10", "x"], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{"Log10", "[", 
                  RowBox[{"1.1", "*", "mass"}], "]"}], ",", 
                 RowBox[{"Log10", "[", "EmaxVal", "]"}], ",", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"Log10", "[", "EmaxVal", "]"}], "-", 
                   RowBox[{"Log10", "[", 
                    RowBox[{"1.1", "*", "mass"}], "]"}]}], "50."]}], "}"}]}], 
              "]"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "Efip",
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]fipdistrlist", "[", "Efip_", "]"}], "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"\[Theta]list", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "+", 
            RowBox[{"\[Theta]list", "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "2"], ",", 
          RowBox[{"DoubleDistrIntList", "[", "i", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{
           RowBox[{"Length", "[", "\[Theta]list", "]"}], "-", "1"}], ",", 
          "1"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Theta]EmaxList", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"\[Theta]fipdistrlist", "[", "Efip", "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"SortBy", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Efip", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Theta]fipdistrlist", "[", "Efip", "]"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Efip", ",", "mass", ",", "EmaxVal", ",", "1"}], 
                 "}"}]}], "]"}], ",", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"\[Theta]fipdistrlist", "[", "Efip", "]"}], "]"}], ",", 
          "1"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]EmaxListInt", "[", "\[Theta]fip_", "]"}], "=", 
      RowBox[{
       RowBox[{"Interpolation", "[", 
        RowBox[{"\[Theta]EmaxList", ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
       "\[Theta]fip", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"NormVals", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"\[Theta]fipdistrlist", "[", "Efip", "]"}], "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", 
           SuperscriptBox["10", 
            RowBox[{"-", "90."}]]}], ",", 
          RowBox[{"{", 
           RowBox[{"Efip", ",", "mass", ",", "EmaxVal"}], "}"}], ",", 
          RowBox[{
          "Method", "\[Rule]", "\"\<InterpolationPointsSubdivision\>\""}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"\[Theta]fipdistrlist", "[", "Efip", "]"}], "]"}], ",", 
          "1"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cdf", "[", 
       RowBox[{"es_", ",", "i_"}], "]"}], ":=", 
      RowBox[{"1", "-", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"NormVals", "[", 
          RowBox[{"[", "i", "]"}], "]"}]], 
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"\[Theta]fipdistrlist", "[", "Efip", "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"Efip", ",", "mass", ",", "es"}], "}"}], ",", 
          RowBox[{
          "Method", "\[Rule]", "\"\<InterpolationPointsSubdivision\>\""}]}], 
         "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cdftab", "[", "Efip_", "]"}], "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"\[Theta]fipdistrlist", "[", "Efip", "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"Interpolation", "[", 
            RowBox[{
             RowBox[{"ParallelTable", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"10", "^", "es"}], ",", 
                 RowBox[{"Quiet", "[", 
                  RowBox[{"cdf", "[", 
                   RowBox[{
                    RowBox[{"10", "^", "es"}], ",", "i"}], "]"}], "]"}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"es", ",", 
                 RowBox[{"Log10", "[", "mass", "]"}], ",", 
                 RowBox[{"Log10", "[", "EmaxVal", "]"}], ",", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"Log10", "[", "EmaxVal", "]"}], "-", 
                   RowBox[{"Log10", "[", "mass", "]"}]}], "50"]}], "}"}]}], 
              "]"}], ",", 
             RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
           "Efip", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"\[Theta]fipdistrlist", "[", "Efip", "]"}], "]"}], ",", 
          "1"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"logmin", "[", "\[Theta]fip_", "]"}], "=", "LogMin"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Estart", "[", "\[Theta]fip_", "]"}], "=", 
      RowBox[{"Min", "[", 
       RowBox[{
        RowBox[{"2", "*", 
         RowBox[{"\[Theta]EmaxListInt", "[", "\[Theta]fip", "]"}]}], ",", 
        RowBox[{"0.9", "*", "EmaxVal"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Emaxv", "[", "i_", "]"}], ":=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"NormVals", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "<", 
         SuperscriptBox["10", 
          RowBox[{"-", "15"}]]}], ",", "mass", ",", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"Efip", "/.", 
           RowBox[{"FindRoot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Log10", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"cdftab", "[", 
                  SuperscriptBox["10", "Efip"], "]"}], "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], "\[Equal]", 
              RowBox[{"logmin", "[", 
               RowBox[{
                RowBox[{"\[Theta]EmaxList", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"Efip", ",", 
               RowBox[{"Log10", "[", 
                RowBox[{"Estart", "[", 
                 RowBox[{
                  RowBox[{"\[Theta]EmaxList", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"Log10", "[", 
                RowBox[{
                 RowBox[{"\[Theta]EmaxList", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
               RowBox[{"Log10", "[", "EmaxVal", "]"}]}], "}"}]}], "]"}]}], 
          ")"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tabtemp", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Theta]EmaxList", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"Emaxv", "[", "i", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "\[Theta]EmaxList", "]"}], ",", "1"}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tab", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"\[Theta]minExp", ",", 
           RowBox[{
            RowBox[{"tabtemp", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "}"}], ",", 
        RowBox[{"Drop", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{"tabtemp", ",", "1"}], "]"}], ",", 
          RowBox[{"-", "1"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"\[Theta]maxExp", ",", 
           RowBox[{
            RowBox[{"tabtemp", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"10", "^", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Log10", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
              RowBox[{"Log10", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
           "tab"}], ",", 
          RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
        RowBox[{"Log10", "[", "\[Theta]fip", "]"}], "]"}], ")"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.885148084467116*^9, 3.885148248479889*^9}, {
   3.8851482989957933`*^9, 3.8851483493083973`*^9}, {3.8851484063554387`*^9, 
   3.8851484068571916`*^9}, {3.8852228484402695`*^9, 
   3.8852228841962533`*^9}, {3.885224401910403*^9, 3.8852244120061765`*^9}, {
   3.885224885137532*^9, 3.885224944143616*^9}, {3.8852249849251437`*^9, 
   3.88522503277181*^9}, {3.8852250820240493`*^9, 3.8852250833651195`*^9}, {
   3.8852255247123723`*^9, 3.8852255362799845`*^9}, {3.8852261807199936`*^9, 
   3.885226182942499*^9}, {3.8852271814880905`*^9, 3.885227195878027*^9}, {
   3.8853542861804843`*^9, 3.885354416029894*^9}, {3.8853544784296722`*^9, 
   3.885354483251371*^9}, {3.885354517144206*^9, 3.885354538902566*^9}, {
   3.885354903942062*^9, 3.8853549049320507`*^9}, {3.8853790449621615`*^9, 
   3.885379047122514*^9}, {3.88537908973895*^9, 3.88537909078761*^9}, {
   3.8853791272449913`*^9, 3.8853791320747995`*^9}, {3.885379220617199*^9, 
   3.8853792208975644`*^9}, {3.885379600558668*^9, 3.885379606494396*^9}, {
   3.8853798728114595`*^9, 3.885379890399393*^9}, {3.8853803814172516`*^9, 
   3.885380383398796*^9}, {3.8853805048204*^9, 3.8853805131399064`*^9}, {
   3.88544831672608*^9, 3.8854484887165213`*^9}, {3.885448535946783*^9, 
   3.8854485812517896`*^9}, {3.885448619241871*^9, 3.885448637306032*^9}, {
   3.885448697726526*^9, 3.885448709541115*^9}, {3.8854487438125606`*^9, 
   3.885448765875434*^9}, {3.885448925652766*^9, 3.8854489264414215`*^9}, {
   3.885449048506912*^9, 3.885449074318219*^9}, {3.885449213197753*^9, 
   3.8854492178649426`*^9}, {3.885449253485854*^9, 3.885449280106469*^9}, {
   3.8854494883928027`*^9, 3.8854494889095163`*^9}, {3.8854497564476986`*^9, 
   3.88544975668421*^9}, {3.885972184590538*^9, 3.88597218902063*^9}, {
   3.8866058250390825`*^9, 3.886605825878443*^9}, {3.8881388042631445`*^9, 
   3.888138852333555*^9}, {3.8883849210320835`*^9, 3.8883849293530245`*^9}, {
   3.8883849698107133`*^9, 3.8883849752419343`*^9}, {3.8884212609348097`*^9, 
   3.8884212615897083`*^9}, {3.888638286713406*^9, 3.8886382867290273`*^9}, {
   3.8902771735803995`*^9, 3.890277176708183*^9}, {3.8908148985891404`*^9, 
   3.8908149285226326`*^9}, {3.890814964295787*^9, 3.8908151741178017`*^9}, {
   3.890815212722772*^9, 3.8908152701824555`*^9}, {3.8908155001108885`*^9, 
   3.8908155002550893`*^9}, {3.8908156022496805`*^9, 3.89081560246863*^9}, {
   3.890815658428111*^9, 3.8908156606435423`*^9}, {3.890815699338393*^9, 
   3.8908157221500397`*^9}, {3.8908415299231205`*^9, 3.8908415558123226`*^9}, 
   3.892284967124219*^9},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[172]:=",ExpressionUUID->"0500f499-02b1-452e-baee-ce09bd9cdbae"]
}, Open  ]],

Cell[CellGroupData[{

Cell["For particular production channels", "Subsubsection",
 CellChangeTimes->{{3.8851480751189785`*^9, 3.8851480807147017`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"4509a151-6691-4920-ad03-\
10e67cdac0ed"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"EmaxBlock", "[", 
   RowBox[{"data_", ",", "logmin_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "mlist", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mlist", "=", 
      RowBox[{"Drop", "[", 
       RowBox[{
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"EmaxTemp", "[", 
       RowBox[{"m_", ",", "\[Theta]_"}], "]"}], "=", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"m", ",", 
         RowBox[{"EfromXmax", "[", 
          RowBox[{
           RowBox[{"mlist", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "data", ",", "logmin"}], 
          "]"}], ",", 
         RowBox[{"EfromXmax", "[", 
          RowBox[{
           RowBox[{"mlist", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}], ",", "data", ",", "logmin"}], 
          "]"}]}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{"\[Theta]fip", "\[Rule]", "\[Theta]"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Theta]list", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"x", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "\[Theta]minExp", ",", "\[Theta]maxExp", ",", 
          FractionBox[
           RowBox[{"(", 
            RowBox[{"\[Theta]maxExp", "-", "\[Theta]minExp"}], ")"}], "10"]}],
          "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"10", "^", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"Log10", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
              RowBox[{"Log10", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"mfip", ",", "\[Theta]fip", ",", 
                 RowBox[{"EmaxTemp", "[", 
                  RowBox[{"mfip", ",", "\[Theta]fip"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"mfip", ",", 
                 RowBox[{"mlist", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"mlist", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"mlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"mlist", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", "10"}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"\[Theta]fip", ",", "\[Theta]list"}], "}"}]}], "]"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ",", 
          RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
        RowBox[{"mfip", ",", 
         RowBox[{"Log10", "[", "\[Theta]fip", "]"}]}], "]"}], ")"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ESmax", "[", 
      RowBox[{"mfip_", ",", "\[Theta]fip_", ",", "prod"}], "]"}], "=", 
     RowBox[{"EmaxBlock", "[", 
      RowBox[{
       RowBox[{"DataDistrScalar", "[", "prod", "]"}], ",", 
       RowBox[{"-", "7"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"prod", ",", "ProductionListNoBrem"}], "}"}]}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"FacilityGivenExperiment", "==", "\"\<FermilabBD\>\""}], "&&", 
    RowBox[{"\[Theta]minExp", "<", 
     RowBox[{
     "\[Theta]maxBremFacility", "[", "FacilityGivenExperiment", "]"}]}]}], 
   ",", 
   RowBox[{
    RowBox[{
     RowBox[{"ESmax", "[", 
      RowBox[{"mfip_", ",", "\[Theta]fip_", ",", "\"\<Brem\>\""}], "]"}], "=", 
     RowBox[{"ESmaxFromBrem", "[", 
      RowBox[{"mfip", ",", "\[Theta]fip", ",", "FacilityGivenExperiment"}], 
      "]"}]}], ";"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"LogLogPlot", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"ESmax", "[", 
       RowBox[{"0.1", ",", "\[Theta]S", ",", "prod"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Theta]S", ",", "\[Theta]minExp", ",", "\[Theta]maxExp"}], 
    "}"}], ",", 
   RowBox[{"Frame", "->", "True"}], ",", 
   RowBox[{"ImageSize", "->", "Large"}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"Placed", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"#", ",", "15"}], "]"}], "&"}], "/@", "ProductionList"}], 
      ",", "Right"}], "]"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.890815329493989*^9, 3.8908155774100304`*^9}, {
  3.8908158154435062`*^9, 3.8908158845380774`*^9}, {3.890841585915182*^9, 
  3.8908415899651947`*^9}, {3.8922849816959057`*^9, 3.8922850000707664`*^9}, {
  3.8922850528370934`*^9, 3.8922850566967363`*^9}, {3.892285087566329*^9, 
  3.892285089359682*^9}, {3.893952118129818*^9, 3.893952182533944*^9}, {
  3.8939538978882256`*^9, 3.893953899520415*^9}, {3.8941275443537674`*^9, 
  3.894127561084694*^9}, {3.8941276005558386`*^9, 3.894127600977059*^9}, {
  3.8972083911429152`*^9, 3.897208392197482*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[173]:=",ExpressionUUID->"dd40248e-824b-4836-88cd-6a0df7372bf8"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Number of events", "Chapter",
 CellChangeTimes->{{3.8935731783578434`*^9, 3.893573180246764*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"2d9780fa-5ba1-4c6e-a530-\
4a9fc49461e6"],

Cell[CellGroupData[{

Cell["Definitions", "Section",
 CellChangeTimes->{{3.897198873663946*^9, 3.8971988750678434`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"a6bc5251-4158-4ee3-9df9-\
c1e86c762dea"],

Cell[CellGroupData[{

Cell["\<\
Grids for the initial data with acceptances and distributions\
\>", "Subsection",
 CellChangeTimes->{{3.897198934328184*^9, 3.89719895293719*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"03c068b3-d3a7-459f-8c1e-\
ec3d3e376262"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Grid", " ", 
     SubscriptBox["m", "S"]}], ",", " ", 
    SubscriptBox["\[Theta]", "S"], ",", " ", 
    SubscriptBox["E", "S"], ",", " ", 
    RowBox[{
     SubscriptBox["z", "S"], " ", "for", " ", "the", " ", "initial", " ", 
     "acceptance", " ", "data"}], ",", " ", "logarithmized"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"InGridm\[Epsilon]", "=", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"FullAcceptanceData", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InGrid\[Theta]\[Epsilon]", "=", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"FullAcceptanceData", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InGridE\[Epsilon]", "=", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"FullAcceptanceData", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InGridz\[Epsilon]", "=", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"FullAcceptanceData", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Array", " ", "of", " ", "values", " ", "of", " ", "the", " ", "initial",
       " ", "acceptance", " ", "data"}], ",", " ", "reshaped"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Epsilon]vals", "=", 
     RowBox[{"ArrayReshape", "[", 
      RowBox[{
       RowBox[{"FullAcceptanceData", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "5"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Length", "[", "InGridm\[Epsilon]", "]"}], ",", 
         RowBox[{"Length", "[", "InGrid\[Theta]\[Epsilon]", "]"}], ",", 
         RowBox[{"Length", "[", "InGridE\[Epsilon]", "]"}], ",", 
         RowBox[{"Length", "[", "InGridz\[Epsilon]", "]"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Epsilon]azValscomp", "=", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"data", ",", "_Real", ",", "2"}], "}"}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"data", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "5", "]"}], "]"}], "==", "0"}], ",", 
           RowBox[{"-", "90."}], ",", 
           RowBox[{"Log10", "[", 
            RowBox[{
             RowBox[{"data", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "5", "]"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "data", "]"}], ",", "1"}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
       RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Epsilon]azvals", "=", 
     RowBox[{"ArrayReshape", "[", 
      RowBox[{
       RowBox[{"\[Epsilon]azValscomp", "[", "FullAcceptanceData0", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Length", "[", "InGridm\[Epsilon]", "]"}], ",", 
         RowBox[{"Length", "[", "InGrid\[Theta]\[Epsilon]", "]"}], ",", 
         RowBox[{"Length", "[", "InGridE\[Epsilon]", "]"}], ",", 
         RowBox[{"Length", "[", "InGridz\[Epsilon]", "]"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
     "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
     "___", "__"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Grid", " ", 
      SubscriptBox["m", "S"]}], ",", " ", 
     SubscriptBox["\[Theta]", "S"], ",", " ", 
     RowBox[{
      SubscriptBox["E", "S"], " ", "for", " ", "the", " ", "initial", " ", 
      "FIP", " ", "distribution", " ", "data"}], ",", " ", "logarithmized"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"DataLogarithmiedComp", "=", 
    RowBox[{
     RowBox[{"Hold", "@", 
      RowBox[{"Compile", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"data", ",", "_Real", ",", "2"}], "}"}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"data", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "4", "]"}], "]"}], "\[Equal]", "0"}], ",", 
            RowBox[{"-", "90."}], ",", 
            RowBox[{"Log10", "[", 
             RowBox[{
              RowBox[{"data", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "4", "]"}], "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "data", "]"}], ",", "1"}], "}"}]}], "]"}], 
        ",", 
        RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
        RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}]}], "//",
      "ReleaseHold"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockGridsValsDistr", "[", "ProdChannel_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"GridIn", ",", "vals"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"GridIn", "=", 
        RowBox[{"Log10", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{
             RowBox[{"DataDistrScalar", "[", "ProdChannel", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "#"}], "]"}], "]"}], "]"}], "&"}], "/@", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"vals", "=", 
        RowBox[{"ArrayReshape", "[", 
         RowBox[{
          RowBox[{"DataLogarithmiedComp", "[", 
           RowBox[{"DataDistrScalar", "[", "ProdChannel", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"GridIn", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
            RowBox[{"Length", "[", 
             RowBox[{"GridIn", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
            RowBox[{"Length", "[", 
             RowBox[{"GridIn", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"GridIn", ",", "vals"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"GridInFinal", "[", "prod", "]"}], ",", 
          RowBox[{"DistrVals", "[", "prod", "]"}]}], "}"}], "=", 
        RowBox[{"BlockGridsValsDistr", "[", "prod", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";"}], "//", 
    "AbsoluteTiming"}]}]}]], "Input",
 CellChangeTimes->{{3.897199659637949*^9, 3.8971996790804834`*^9}, {
   3.897208285005845*^9, 3.8972083314493256`*^9}, 3.89720836608294*^9},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[177]:=",ExpressionUUID->"9e239ef8-b3f5-433f-b061-de53501dd105"],

Cell[BoxData[
 RowBox[{"Select", "[", 
  RowBox[{
   RowBox[{"10", "^", 
    RowBox[{
     RowBox[{"GridInFinal", "[", "\"\<Bmixing\>\"", "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{
    "\[Theta]minExpAll", "<=", "#", "\[LessEqual]", "\[Theta]maxExpAll"}], 
    "&"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9051032982547803`*^9, 3.9051033778357105`*^9}},
 CellLabel->
  "In[270]:=",ExpressionUUID->"38476b7b-e95d-4f4f-947e-9630b4cde7ef"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Grid to be used to calculate the number of events", "Subsection",
 CellChangeTimes->{{3.8971989779703307`*^9, 3.8971989844379535`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"9e11135a-cfd0-4132-86ba-\
54d8f1000608"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Grid", " ", 
     SubscriptBox["\[Theta]", "S"]}], ",", " ", 
    RowBox[{
     SubscriptBox["z", "S"], " ", "for", " ", "the", " ", "final", " ", 
     "acceptance", " ", "data"}], ",", " ", "logarithmized"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"OutGrid\[Theta]finalTemp", "=", 
     RowBox[{"(*", "InGrid\[Theta]\[Epsilon]", "*)"}], 
     RowBox[{"Table", "[", 
      RowBox[{"x", ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"10", "^", 
          RowBox[{"Min", "[", "InGrid\[Theta]\[Epsilon]", "]"}]}], ",", 
         RowBox[{"10", "^", 
          RowBox[{"Max", "[", "InGrid\[Theta]\[Epsilon]", "]"}]}], ",", 
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"10", "^", 
             RowBox[{"Max", "[", "InGrid\[Theta]\[Epsilon]", "]"}]}], "-", 
            RowBox[{"10", "^", 
             RowBox[{"Min", "[", "InGrid\[Theta]\[Epsilon]", "]"}]}]}], ")"}],
           "30"]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["10", 
         RowBox[{"-", "4"}]], "<", 
        RowBox[{"OutGrid\[Theta]finalTemp", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "<", 
        SuperscriptBox["10", 
         RowBox[{"-", "2"}]]}], "&&", 
       RowBox[{
        RowBox[{"OutGrid\[Theta]finalTemp", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], ">", "0.1"}]}], ",", 
      RowBox[{"OutGrid\[Theta]final", "=", 
       RowBox[{
        RowBox[{"Log10", "[", 
         RowBox[{"Join", "[", 
          RowBox[{"OutGrid\[Theta]finalTemp", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"2", 
              RowBox[{"OutGrid\[Theta]finalTemp", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"4", 
              RowBox[{"OutGrid\[Theta]finalTemp", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"6", 
              RowBox[{"OutGrid\[Theta]finalTemp", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}], "]"}], "]"}], "//",
         "Sort"}]}], ",", 
      RowBox[{"OutGrid\[Theta]final", "=", 
       RowBox[{"Log10", "[", "OutGrid\[Theta]finalTemp", "]"}]}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"OutGridzfinal", "=", 
     RowBox[{"Log10", "[", 
      RowBox[{"Table", "[", 
       RowBox[{"x", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          SuperscriptBox["10", 
           RowBox[{"InGridz\[Epsilon]", "[", 
            RowBox[{"[", "1", "]"}], "]"}]], ",", 
          SuperscriptBox["10", 
           RowBox[{"InGridz\[Epsilon]", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]], ",", 
          RowBox[{"Min", "[", 
           RowBox[{
            FractionBox[
             RowBox[{
              SuperscriptBox["10", 
               RowBox[{"InGridz\[Epsilon]", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}]], "-", 
              SuperscriptBox["10", 
               RowBox[{"InGridz\[Epsilon]", "[", 
                RowBox[{"[", "1", "]"}], "]"}]]}], "5"], ",", 
            RowBox[{"Max", "[", 
             RowBox[{"0.5", ",", 
              FractionBox[
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["10", 
                  RowBox[{"InGridz\[Epsilon]", "[", 
                   RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]], "-", 
                 SuperscriptBox["10", 
                  RowBox[{"InGridz\[Epsilon]", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]]}], ")"}], "30"]}], "]"}]}],
            "]"}]}], "}"}]}], "]"}], "]"}]}], 
    RowBox[{"(*", "InGridz\[Epsilon]", "*)"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalDelta]xVals", "[", "list_", "]"}], ":=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        FractionBox[
         RowBox[{
          RowBox[{"list", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"list", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "2"], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"list", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "-", 
          RowBox[{"list", "[", 
           RowBox[{"[", 
            RowBox[{"i", "-", "1"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"Length", "[", "list", "]"}], ",", "1"}], "}"}]}], "]"}]}],
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalDelta]\[Theta]vals", "=", 
     RowBox[{"\[CapitalDelta]xVals", "[", 
      SuperscriptBox["10", "OutGrid\[Theta]final"], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalDelta]zvals", "=", 
     RowBox[{"\[CapitalDelta]xVals", "[", 
      SuperscriptBox["10", "OutGridzfinal"], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Final", " ", "energy", " ", 
      RowBox[{"grid", ".", " ", "Mass"}]}], "-", " ", 
     RowBox[{"and", " ", "production", " ", "channel"}], "-", "dependent"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"StepEtemp", "[", "Efip_", "]"}], "=", 
     RowBox[{"Piecewise", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.3", ",", 
          RowBox[{"Efip", "\[LessEqual]", "2.5"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.5", ",", 
          RowBox[{"2.5", "<", "Efip", "<", "35"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", 
          RowBox[{"35", "\[LessEqual]", "Efip", "\[LessEqual]", "50"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", 
          RowBox[{"50", "<", "Efip", "<", "160"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5", ",", 
          RowBox[{"160", "\[LessEqual]", "Efip", "<", "300"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"40", ",", 
          RowBox[{"300", "\[LessEqual]", "Efip", "<", "700"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"50", ",", 
          RowBox[{"700", "\[LessEqual]", "Efip", "<", "2000"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"200", ",", 
          RowBox[{"2000", "\[LessEqual]", "Efip", "<", "4000"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"400", ",", 
          RowBox[{"4000", "\[LessEqual]", "Efip", "<", "7000"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"500", ",", 
          RowBox[{"7000", "\[LessEqual]", "Efip", "\[LessEqual]", "50000"}]}],
          "}"}]}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"OutGridEnergy", "[", 
     RowBox[{"m_", ",", "ProdChannel_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"start", "=", 
            RowBox[{"1.01", "m"}]}], ",", 
           RowBox[{"end", "=", 
            RowBox[{"ESmax", "[", 
             RowBox[{"m", ",", "\[Theta]minExp", ",", "ProdChannel"}], 
             "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Log10", "[", 
          RowBox[{"NestWhileList", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "+", 
              RowBox[{"StepEtemp", "[", "#", "]"}]}], "&"}], ",", "start", 
            ",", 
            RowBox[{
             RowBox[{"#", "\[LessEqual]", "end"}], "&"}], ",", "1", ",", 
            "\[Infinity]", ",", 
            RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}], "//", "N"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalDelta]xValsTotComp", "=", 
     RowBox[{
      RowBox[{"Hold", "@", 
       RowBox[{"Compile", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[CapitalDelta]\[Theta]vals", ",", "_Real", ",", "1"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[CapitalDelta]Evals", ",", "_Real", ",", "1"}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"\[CapitalDelta]zvals", ",", "_Real", ",", "1"}], "}"}]}],
           "}"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[CapitalDelta]\[Theta]vals", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "*", 
             RowBox[{"\[CapitalDelta]Evals", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "*", 
             RowBox[{"\[CapitalDelta]zvals", "[", 
              RowBox[{"[", "k", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "\[CapitalDelta]\[Theta]vals", "]"}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "\[CapitalDelta]Evals", "]"}]}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", 
             RowBox[{"Length", "[", "\[CapitalDelta]zvals", "]"}]}], "}"}]}], 
          "]"}], ",", 
         RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
         RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}]}], "//",
       "ReleaseHold"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8972023930977507`*^9, 3.8972024003159914`*^9}, {
  3.8972037912719955`*^9, 3.897203794873706*^9}, {3.8972042319753127`*^9, 
  3.8972042376735725`*^9}, {3.8972043473390894`*^9, 3.897204353429783*^9}, {
  3.8972047978657155`*^9, 3.89720480634333*^9}, {3.897208409815923*^9, 
  3.89720841003522*^9}, {3.89758171566333*^9, 3.897581818984338*^9}, {
  3.8975821025069475`*^9, 3.897582102660977*^9}, {3.8975822068541183`*^9, 
  3.8975822425003085`*^9}, {3.8975832376549206`*^9, 3.8975832400171833`*^9}, {
  3.8975833699893227`*^9, 3.897583370165251*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[187]:=",ExpressionUUID->"d53c9063-f042-4883-b156-b39b68e1926b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Code that computes the number of events - using the mapping method \
\>", "Subsection",
 CellChangeTimes->{{3.897199076623907*^9, 3.8971990900052223`*^9}, {
  3.8972009084104066`*^9, 3.897200920680235*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"cba3bac0-0ffd-40dd-9cf4-\
91a7fb47b456"],

Cell[CellGroupData[{

Cell["Grid for distribution times acceptance", "Subsubsection",
 CellChangeTimes->{{3.8972000893750353`*^9, 3.897200100182712*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"ce37e5bd-2e84-4698-ac4a-\
91cabbcfc5a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Block", " ", "that", " ", "computes", " ", "the", " ", "grid", " ", 
     SubscriptBox["\[Theta]", "S"]}], ",", 
    SubscriptBox["E", "S"], ",", 
    SubscriptBox["z", "S"], ",", " ", 
    RowBox[{
     SubscriptBox["\[Epsilon]", "Full"], "\[Times]", 
     SubscriptBox["f", 
      RowBox[{
       SubscriptBox["\[Theta]", "S"], ",", 
       SubscriptBox["E", "S"]}]]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"TableIntegrandDiscret", "[", 
    RowBox[{"m_", ",", "ProdChannel_", ",", "\[Epsilon]DecOp_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"OutGridEfinal", "=", 
       RowBox[{"OutGridEnergy", "[", 
        RowBox[{
         RowBox[{"N", "[", "m", "]"}], ",", "ProdChannel"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalDelta]Evals", "=", 
       RowBox[{"\[CapitalDelta]xVals", "[", 
        SuperscriptBox["10", "OutGridEfinal"], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalDelta]xValsTot", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"\[CapitalDelta]xValsTotComp", "[", 
          RowBox[{
          "\[CapitalDelta]\[Theta]vals", ",", "\[CapitalDelta]Evals", ",", 
           "\[CapitalDelta]zvals"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"OutGridFinal", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Log10", "[", 
            RowBox[{"N", "[", "m", "]"}], "]"}], "}"}], ",", 
          "OutGrid\[Theta]final", ",", "OutGridEfinal", ",", 
          "OutGridzfinal"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"OutGridFinal1", "=", 
       RowBox[{"10", "^", 
        RowBox[{"OutGridFinal", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "3", ",", "4"}], "}"}]}], "]"}], "]"}]}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"g\[Epsilon]", "=", 
       RowBox[{"{", 
        RowBox[{
        "InGridm\[Epsilon]", ",", "InGrid\[Theta]\[Epsilon]", ",", 
         "InGridE\[Epsilon]", ",", "InGridz\[Epsilon]"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xg\[Epsilon]", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Log10", "[", 
           RowBox[{"N", "[", "m", "]"}], "]"}], "}"}], ",", 
         "OutGrid\[Theta]final", ",", "OutGridEfinal", ",", "OutGridzfinal"}],
         "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xig\[Epsilon]", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Interpolation", "[", 
            RowBox[{
             RowBox[{"Transpose", "@", 
              RowBox[{"{", 
               RowBox[{"#", ",", 
                RowBox[{"Range", "@", 
                 RowBox[{"Length", "@", "#"}]}]}], "}"}]}], ",", 
             RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
           "#2", "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"g\[Epsilon]", ",", "xg\[Epsilon]"}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"\[Epsilon]Result", "=", 
       RowBox[{"10", "^", 
        RowBox[{"Flatten", "@", 
         RowBox[{"cf4", "[", 
          RowBox[{
           RowBox[{"Sequence", "@@", "xig\[Epsilon]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"\[Epsilon]DecOp", "==", "\"\<True\>\""}], ",", 
             "\[Epsilon]vals", ",", "\[Epsilon]azvals"}], "]"}]}], 
          "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gDistr", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"GridInFinal", "[", "ProdChannel", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"GridInFinal", "[", "ProdChannel", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"GridInFinal", "[", "ProdChannel", "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xgDistr", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Log10", "[", 
           RowBox[{"N", "[", "m", "]"}], "]"}], "}"}], ",", 
         "OutGrid\[Theta]final", ",", "OutGridEfinal"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xigDistr", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Interpolation", "[", 
            RowBox[{
             RowBox[{"Transpose", "@", 
              RowBox[{"{", 
               RowBox[{"#", ",", 
                RowBox[{"Range", "@", 
                 RowBox[{"Length", "@", "#"}]}]}], "}"}]}], ",", 
             RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
           "#2", "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"gDistr", ",", "xgDistr"}], "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"DistrResult", "=", 
       RowBox[{"10", "^", 
        RowBox[{"Flatten", "@", 
         RowBox[{"cf3", "[", 
          RowBox[{
           RowBox[{"Sequence", "@@", "xigDistr"}], ",", 
           RowBox[{"DistrVals", "[", "ProdChannel", "]"}]}], "]"}]}]}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"TabTemp0", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"OutGridFinal1", ",", 
         RowBox[{"List", "/@", 
          RowBox[{"Flatten", "[", 
           RowBox[{"DistrResult", " ", 
            RowBox[{"Partition", "[", 
             RowBox[{"\[Epsilon]Result", ",", 
              RowBox[{"Length", "[", "OutGridzfinal", "]"}]}], "]"}]}], 
           "]"}]}], ",", "\[CapitalDelta]xValsTot", ",", "2"}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8971994275280633`*^9, 3.897199455815837*^9}, {
  3.897199582357897*^9, 3.897199655914138*^9}, {3.897199710190297*^9, 
  3.8971997629515643`*^9}, {3.8971998392552953`*^9, 3.897199857485531*^9}, {
  3.8971999081472673`*^9, 3.897199913176509*^9}, {3.897200806217702*^9, 
  3.897200808930355*^9}, {3.8972008448098516`*^9, 3.897200868455401*^9}, {
  3.8972021893667536`*^9, 3.897202196806899*^9}, {3.89720660886187*^9, 
  3.8972066089868507`*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[196]:=",ExpressionUUID->"19a29f23-39cd-40bd-9967-ae06d9a417c4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Convoluting acceptances with pre-factor", "Subsubsection",
 CellChangeTimes->{{3.8972001073570213`*^9, 3.8972001113381767`*^9}, {
  3.897200680751539*^9, 3.8972006887621703`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"da0c7b9b-89c0-463c-ac01-\
97600e7a30ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Values", " ", 
     SubscriptBox["f", "FIP"], "\[Times]", 
     SubscriptBox["\[Epsilon]", "FIP"], "\[Times]", 
     FractionBox[
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", 
         SubscriptBox["z", "FIP"]}], "/", 
        RowBox[{"(", 
         RowBox[{"cos", 
          RowBox[{"(", 
           SubscriptBox["\[Theta]", "FIP"], ")"}], 
          SubscriptBox["c\[Tau]", "FIP"], 
          RowBox[{
           SubscriptBox["p", "FIP"], "/", 
           SubscriptBox["m", "FIP"]}]}], ")"}]}], "]"}], 
      RowBox[{"cos", 
       RowBox[{"(", 
        SubscriptBox["\[Theta]", "FIP"], ")"}], 
       SubscriptBox["c\[Tau]", "FIP"], 
       RowBox[{
        SubscriptBox["p", "FIP"], "/", 
        SubscriptBox["m", "FIP"]}]}]], "\[Times]", 
     SubscriptBox["\[Epsilon]", "decay"], 
     SubscriptBox["\[CapitalDelta]z", "FIP"], 
     SubscriptBox["\[CapitalDelta]E", "FIP"], 
     SubscriptBox["\[CapitalDelta]\[Theta]", "FIP"], " ", "for", " ", "the", 
     " ", "grid", " ", "of", " ", "values", " ", 
     SubscriptBox["\[Theta]", "FIP"]}], ",", " ", 
    SubscriptBox["E", "FIP"], ",", " ", 
    RowBox[{
     SubscriptBox["z", "FIP"], " ", "fixed", " ", "values", " ", "of", " ", 
     SubscriptBox["c\[Tau]", "FIP"], " ", "and", " ", 
     SubscriptBox["m", "FIP"]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tableprefac", "=", 
     RowBox[{
      RowBox[{"Hold", "@", 
       RowBox[{"Compile", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"tabb", ",", "_Real", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", "_Real"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c\[Tau]", ",", "_Real"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"decProb", ",", "_Integer"}], "}"}]}], "}"}], ",", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "angles", ",", "energies", ",", "zv", ",", "values", ",", 
             "\[CapitalDelta]s", ",", "prefactor"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"values", "=", 
             RowBox[{"Compile`GetElement", "[", 
              RowBox[{"tabb", ",", "4"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"\[CapitalDelta]s", "=", 
             RowBox[{"Compile`GetElement", "[", 
              RowBox[{"tabb", ",", "5"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"decProb", "==", "1"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"angles", "=", 
                RowBox[{"Compile`GetElement", "[", 
                 RowBox[{"tabb", ",", "1"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"energies", "=", 
                RowBox[{"Compile`GetElement", "[", 
                 RowBox[{"tabb", ",", "2"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"zv", "=", 
                RowBox[{"Compile`GetElement", "[", 
                 RowBox[{"tabb", ",", "3"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"prefactor", "=", 
                FractionBox[
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", "zv"}], "/", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Cos", "[", "angles", "]"}], "*", "c\[Tau]", "*", 
                    FractionBox[
                    SqrtBox[
                    RowBox[{
                    SuperscriptBox["energies", "2"], "-", 
                    SuperscriptBox["m", "2"]}]], "m"]}], ")"}]}], "]"}], 
                 RowBox[{
                  RowBox[{"Cos", "[", "angles", "]"}], "*", "c\[Tau]", "*", 
                  FractionBox[
                   SqrtBox[
                    RowBox[{
                    SuperscriptBox["energies", "2"], "-", 
                    SuperscriptBox["m", "2"]}]], "m"]}]]}]}], ",", 
              RowBox[{"prefactor", "=", "1."}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"prefactor", "*", "\[CapitalDelta]s", "*", "values"}]}]}],
           "]"}], ",", 
         RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
         RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
         RowBox[{"Parallelization", "\[Rule]", "\"\<True\>\""}], ",", 
         RowBox[{"RuntimeAttributes", "\[Rule]", 
          RowBox[{"{", "Listable", "}"}]}]}], "]"}]}], "//", 
      "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Summation", " ", "of", " ", "the", " ", "values", " ", "above"}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sumcompile", "=", 
     RowBox[{
      RowBox[{"Hold", "@", 
       RowBox[{"Compile", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"tabc\[Tau]m", ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
         RowBox[{"Total", "[", "tabc\[Tau]m", "]"}], ",", 
         RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
         RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
         RowBox[{"Parallelization", "\[Rule]", "\"\<True\>\""}]}], "]"}]}], "//",
       "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mmin\[Epsilon]", ",", "mmax\[Epsilon]"}], "}"}], "=", 
    RowBox[{"10", "^", 
     RowBox[{"MinMax", "[", "InGridm\[Epsilon]", "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{
  3.897200675960476*^9, {3.8972040486175427`*^9, 3.897204049008037*^9}, {
   3.897204079641328*^9, 3.8972040859999785`*^9}, {3.8972057591435843`*^9, 
   3.8972057626279507`*^9}, {3.89720886889474*^9, 3.897208869001661*^9}, {
   3.897582245904173*^9, 3.897582246438655*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[197]:=",ExpressionUUID->"bdcbf344-384a-4ed7-97e2-d89957d2b071"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Acceptances", "Subsubsection",
 CellChangeTimes->{{3.8972009286929445`*^9, 3.8972009324601674`*^9}, 
   3.897201517674982*^9},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"000bc51d-351f-4076-866f-\
75cabfdef1e1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FactorANUBISceiling", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"SelectedExperiment", "==", "\"\<ANUBIS-ceiling\>\""}], ",", "2",
      ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AcceptanceDiscret", "[", 
   RowBox[{
   "m_", ",", "ProdChannel_", ",", "\[Epsilon]decOp_", ",", "decProb_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"NevDiscret", ",", "NpotTimes\[Chi]val"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"mSmin", "[", "ProdChannel", "]"}], ",", "mmin\[Epsilon]"}],
          "]"}], "<", "m", "<", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"mSmax", "[", "ProdChannel", "]"}], ",", "mmax\[Epsilon]"}],
          "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"integrandtab", "=", 
         RowBox[{"TableIntegrandDiscret", "[", 
          RowBox[{"m", ",", "ProdChannel", ",", "\[Epsilon]decOp"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"brvis", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"\[Epsilon]decOp", "==", "1"}], ",", 
           RowBox[{"BrVis", "[", "m", "]"}], ",", "1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Test", " ", "lifetime", " ", "for", " ", "the", " ", "acceptance"}],
          "*)"}], "\[IndentingNewLine]", 
        RowBox[{"c\[Tau]acc", "=", 
         SuperscriptBox["10", "9"]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Prefactor", " ", "for", " ", "the", " ", 
          RowBox[{"acceptance", ".", " ", "If"}], " ", "only", " ", 
          "azimuthal", " ", "and"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"prefacacc", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"decProb", "==", "1"}], ",", "c\[Tau]acc", ",", 
           FractionBox["1", 
            RowBox[{"zmaxExp", "-", "zminExp"}]]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"accdiscret", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"brvis", "!=", "0"}], ",", 
           RowBox[{"FactorANUBISceiling", "*", "brvis", "*", "prefacacc", "*", 
            RowBox[{"sumcompile", "[", 
             RowBox[{"tableprefac", "[", 
              RowBox[{
              "integrandtab", ",", "m", ",", "c\[Tau]acc", ",", "decProb"}], 
              "]"}], "]"}]}], ",", "0"}], "]"}]}]}], ",", 
       RowBox[{"accdiscret", "=", "0"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "accdiscret"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.8972011084712963`*^9, 3.897201128340288*^9}, {
   3.8972011891481795`*^9, 3.89720124049387*^9}, {3.8972012897384634`*^9, 
   3.897201325360157*^9}, {3.897201589075931*^9, 3.8972016624203763`*^9}, {
   3.8972018160050974`*^9, 3.8972018498780518`*^9}, {3.89720191795713*^9, 
   3.8972019346903367`*^9}, {3.8972020225483*^9, 3.8972020975166674`*^9}, {
   3.8972023111284375`*^9, 3.897202311275799*^9}, 3.8972023780567894`*^9, {
   3.897205334073205*^9, 3.8972053351996293`*^9}, {3.897206603491517*^9, 
   3.8972066036108027`*^9}, {3.8972084496286616`*^9, 
   3.8972084523229027`*^9}, {3.8972085258638744`*^9, 
   3.8972085259988823`*^9}, {3.8972088775622473`*^9, 3.8972088779176054`*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[200]:=",ExpressionUUID->"3f1c5327-4ad9-45e7-8425-dab3a49925fe"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Acceptances and approximate lower/upper bounds computation", "Section",
 CellChangeTimes->{{3.8972012648879433`*^9, 3.897201267668914*^9}, {
  3.8972059482630224`*^9, 3.8972059524445267`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"4838b61a-27bf-4158-bec2-\
c9aa7466caed"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"mlistAcceptance", "[", "prod", "]"}], "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"m", ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", 
           RowBox[{"1.01", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"mSmin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}], 
             "]"}]}], ",", 
           RowBox[{"0.95", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"mSmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}], 
             "]"}]}], ",", 
           RowBox[{"Min", "[", 
            RowBox[{
             FractionBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"0.95", 
                 RowBox[{"Min", "[", 
                  RowBox[{
                   RowBox[{"mSmax", "[", "prod", "]"}], ",", 
                   "mmax\[Epsilon]"}], "]"}]}], "-", 
                RowBox[{"1.01", 
                 RowBox[{"Max", "[", 
                  RowBox[{
                   RowBox[{"mSmin", "[", "prod", "]"}], ",", 
                   "mmin\[Epsilon]"}], "]"}]}]}], ")"}], "20"], ",", "2"}], 
            "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.99", 
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"mSmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}], 
          "]"}]}], "}"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"m", ",", 
          RowBox[{"AcceptanceDiscret", "[", 
           RowBox[{"m", ",", "prod", ",", "\"\<False\>\"", ",", "0"}], "]"}], 
          ",", 
          RowBox[{"AcceptanceDiscret", "[", 
           RowBox[{"m", ",", "prod", ",", "\"\<True\>\"", ",", "0"}], "]"}], 
          ",", 
          RowBox[{"AcceptanceDiscret", "[", 
           RowBox[{"m", ",", "prod", ",", "\"\<False\>\"", ",", "1"}], "]"}], 
          ",", 
          RowBox[{"AcceptanceDiscret", "[", 
           RowBox[{"m", ",", "prod", ",", "\"\<True\>\"", ",", "1"}], "]"}]}],
          "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"m", ",", 
          RowBox[{"mlistAcceptance", "[", "prod", "]"}]}], "}"}]}], "]"}]}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlotAcc", "[", "ProdChannel_", "]"}], ":=", 
  RowBox[{"ListLogPlot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "4"}], "}"}]}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "5"}], "}"}]}], "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", " ", "22"}], "]"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Blue"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
         RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
         RowBox[{"Darker", "@", 
          RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Black"}], "}"}]}], 
      "}"}]}], ",", 
    RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"MinMax", "[", 
        RowBox[{
         RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.9", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}], "]"}]}], ",", 
         RowBox[{"1.1", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}]}], "]"}]}]}], 
        "}"}]}], "}"}]}], ",", 
    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<m [GeV]\>\"", ",", "\"\<Acceptance\>\""}], "}"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", " ", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<From \>\"", ",", "ProdChannel"}], "}"}], "]"}], ",", 
       " ", "20", ",", " ", "Black"}], "]"}]}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"Placed", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"#", ",", " ", "18"}], "]"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{
          "\"\<<\!\(\*SubscriptBox[\(\[Epsilon]\), \(FIP\)]\)>\>\"", ",", 
           "\"\<<\!\(\*SubscriptBox[\(\[Epsilon]\), \
\(FIP\)]\)\!\(\*SubscriptBox[\(\[Epsilon]\), \(decay\)]\)>\>\"", ",", 
           "\"\<c\[Tau]<\!\(\*SubscriptBox[\(\[Epsilon]\), \
\(FIP\)]\)\!\(\*SubscriptBox[\(P\), \(decay\)]\)>\>\"", ",", 
           "\"\<c\[Tau]<\!\(\*SubscriptBox[\(\[Epsilon]\), \
\(FIP\)]\)\!\(\*SubscriptBox[\(P\), \(decay\)]\)\!\(\*SubscriptBox[\(\
\[Epsilon]\), \(decay\)]\)>\>\""}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.75", ",", "0.2"}], "}"}]}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Style", "[", 
   RowBox[{
    RowBox[{"Row", "[", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"PlotAcc", "[", "prod", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "]"}], 
     "]"}], ",", 
    RowBox[{"ImageSizeMultipliers", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"FilenameAcceptance", "[", "prod", "]"}], "=", 
       RowBox[{"ToString", "@", 
        RowBox[{"StringForm", "[", 
         RowBox[{"\"\<Acceptance_Scalar_at_``_From_``.dat\>\"", ",", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"{", 
            RowBox[{"SelectedExperiment", ",", "prod"}], "}"}]}]}], "]"}]}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<Auxiliary data/Scalars\>\"", ",", "SelectedExperiment", ",", 
           RowBox[{"FilenameAcceptance", "[", "prod", "]"}]}], "}"}], "]"}], 
        ",", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            FractionBox[
             RowBox[{"#", "[", 
              RowBox[{"[", "4", "]"}], "]"}], "c\[Tau]acc"], ",", 
            FractionBox[
             RowBox[{"#", "[", 
              RowBox[{"[", "5", "]"}], "]"}], "c\[Tau]acc"]}], "}"}], "&"}], "/@", 
         RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}]}], ",", 
        "\"\<Table\>\""}], "]"}]}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AccAveraged", "[", 
    RowBox[{"mS_", ",", "\[Theta]2_", ",", "BrhToSS_"}], "]"}], "=", 
   RowBox[{"NpotGivenExperiment", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"mSmin", "[", "prod", "]"}], "<", "mS", "<", 
           RowBox[{"mSmax", "[", "prod", "]"}]}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"\[Chi]Xtimes\[Chi]XtoScalar", "[", 
            RowBox[{"mS", ",", "\[Theta]2", ",", "BrhToSS", ",", "prod"}], 
            "]"}], "]"}], ",", "0"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ",", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"mSmin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}], 
            "]"}], "<", "mS", "<", 
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"mSmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}], 
            "]"}]}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"\[Chi]Xtimes\[Chi]XtoScalar", "[", 
             RowBox[{"mS", ",", "\[Theta]2", ",", "BrhToSS", ",", "prod"}], 
             "]"}], "*", 
            RowBox[{
             RowBox[{"Interpolation", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
               RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
             "mS", "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ",", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"mSmin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}], 
            "]"}], "<", "mS", "<", 
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"mSmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}], 
            "]"}]}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"\[Chi]Xtimes\[Chi]XtoScalar", "[", 
              RowBox[{"mS", ",", "\[Theta]2", ",", "BrhToSS", ",", "prod"}], 
              "]"}], "c\[Tau]acc"], "*", 
            RowBox[{
             RowBox[{"Interpolation", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "4"}], "}"}]}], "]"}], "]"}], ",", 
               RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
             "mS", "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ",", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"mSmin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}], 
            "]"}], "<", "mS", "<", 
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"mSmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}], 
            "]"}]}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"\[Chi]Xtimes\[Chi]XtoScalar", "[", 
              RowBox[{"mS", ",", "\[Theta]2", ",", "BrhToSS", ",", "prod"}], 
              "]"}], "c\[Tau]acc"], "*", 
            RowBox[{
             RowBox[{"Interpolation", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "5"}], "}"}]}], "]"}], "]"}], ",", 
               RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
             "mS", "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}]}], "}"}]}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<Auxiliary data/Scalars\>\"", ",", "SelectedExperiment", ",", 
      "\"\<AcceptanceAveragedScalar.m\>\""}], "}"}], "]"}], ",", 
   RowBox[{"AccAveraged", "[", 
    RowBox[{"mS", ",", "\[Theta]2", ",", "BrhToSS"}], "]"}], ",", 
   "\"\<MX\>\""}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.897205194596387*^9, 3.8972052417988367`*^9}, {
   3.897205309605931*^9, 3.89720539403836*^9}, {3.8972055297271395`*^9, 
   3.89720562453496*^9}, {3.8972056761558304`*^9, 3.897205703295968*^9}, {
   3.897205781529233*^9, 3.8972057841962852`*^9}, {3.897205893477086*^9, 
   3.897205918862975*^9}, {3.897206478456417*^9, 3.8972065044154882`*^9}, {
   3.8972085444868965`*^9, 3.897208578779801*^9}, {3.8975816288399653`*^9, 
   3.8975816315439167`*^9}, 3.8975820453640733`*^9, {3.9026483429886446`*^9, 
   3.9026483602850103`*^9}, {3.902649244624518*^9, 3.9026492535454993`*^9}, {
   3.9026492947495823`*^9, 3.90264932668254*^9}, {3.9026494013553915`*^9, 
   3.9026494063602457`*^9}, {3.9026494748790827`*^9, 
   3.9026495738773756`*^9}, {3.9026496183470154`*^9, 3.902649622660833*^9}, {
   3.903892795071659*^9, 3.9038927983184557`*^9}, {3.903942036651329*^9, 
   3.903942036946164*^9}, {3.905839526684552*^9, 3.905839528575652*^9}, {
   3.9058395660821075`*^9, 3.905839584576269*^9}, {3.9058396515967236`*^9, 
   3.9058396535837545`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"f33ce8f2-6b47-4b9c-90b0-\
a1f9d7830d52"],

Cell[CellGroupData[{

Cell["Rough estimates of the upper and lower bounds", "Subsection",
 CellChangeTimes->{{3.8850328066928463`*^9, 3.8850328135228024`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"db85dc12-ab27-49c3-9df5-\
ed5473b6f74b"],

Cell[CellGroupData[{

Cell["Definitions", "Subsubsection",
 CellChangeTimes->{{3.877676708463168*^9, 3.877676711193803*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"048f95d8-648b-4c4f-934d-\
2ec725318fc0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BrhToSSreference", "=", "0.15"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"factorBounds", "[", "\"\<Bmixing\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"factorBounds", "[", "\"\<Brem\>\"", "]"}], "=", "1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"factorBounds", "[", "\"\<Bquartic\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"factorBounds", "[", "\"\<BsQuartic\>\"", "]"}], "=", 
    RowBox[{
     RowBox[{"factorBounds", "[", "\"\<hQuartic\>\"", "]"}], "=", "2"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]2minEstimate", "[", 
      RowBox[{"mS_", ",", "prod"}], "]"}], "=", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"2.3", 
          RowBox[{"c\[Tau]Scalar", "[", 
           RowBox[{"mS", ",", "1"}], "]"}]}]], 
        RowBox[{"NpotGivenExperiment", "*", 
         RowBox[{"\[Chi]Xtimes\[Chi]XtoScalar", "[", 
          RowBox[{"mS", ",", "1", ",", "BrhToSSreference", ",", "prod"}], 
          "]"}], "*", 
         RowBox[{
          RowBox[{"Interpolation", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "5"}], "}"}]}], "]"}], "]"}], ",", 
            RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
          "mS", "]"}]}]}], ")"}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], 
       RowBox[{"factorBounds", "[", "prod", "]"}]}]]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Theta]2maxEstimate", "[", 
      RowBox[{"mS_", ",", "prod"}], "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"prod", "\[Equal]", "\"\<Bmixing\>\""}], ",", 
       RowBox[{"Re", "[", 
        RowBox[{"Evaluate", "[", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"ProductLog", "[", 
             RowBox[{
              RowBox[{"-", "1"}], ",", 
              RowBox[{
               RowBox[{"-", "2.3"}], "*", 
               FractionBox["b", "a"]}]}], "]"}], "b"]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"a", "\[Rule]", " ", 
             RowBox[{"NpotGivenExperiment", "*", 
              RowBox[{"\[Chi]Xtimes\[Chi]XtoScalar", "[", 
               RowBox[{"mS", ",", "1", ",", "BrhToSSreference", ",", "prod"}],
                "]"}], "*", 
              RowBox[{
               RowBox[{"Interpolation", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
                 RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[",
                "mS", "]"}]}]}], ",", 
            RowBox[{"b", "\[Rule]", 
             FractionBox["zminExp", 
              RowBox[{"ldecayScalar", "[", 
               RowBox[{"mS", ",", "1", ",", 
                RowBox[{"ESmax", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"mlistScalar", "[", "prod", "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", "\[Theta]minExp", ",",
                   "prod"}], "]"}]}], "]"}]]}]}], "}"}]}], "]"}], "]"}], ",", 
       RowBox[{
        FractionBox[
         RowBox[{"ldecayScalar", "[", 
          RowBox[{"mS", ",", "1", ",", 
           RowBox[{"ESmax", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"mlistScalar", "[", "prod", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "\[Theta]minExp", ",", 
             "prod"}], "]"}]}], "]"}], "zminExp"], 
        RowBox[{"Log", "[", 
         RowBox[{
          FractionBox["1", "2.3"], " ", 
          RowBox[{"NpotGivenExperiment", "*", 
           RowBox[{"\[Chi]Xtimes\[Chi]XtoScalar", "[", 
            RowBox[{"mS", ",", "1", ",", "BrhToSSreference", ",", "prod"}], 
            "]"}], "*", 
           RowBox[{
            RowBox[{"Interpolation", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
              RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
            "mS", "]"}]}]}], "]"}]}]}], "]"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"prod", ",", "ProductionList"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Epsilon]estplot", "=", "\"\<Bmixing\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogLogPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]2minEstimate", "[", 
      RowBox[{"mS", ",", "\[Epsilon]estplot"}], "]"}], ",", 
     RowBox[{"\[Theta]2maxEstimate", "[", 
      RowBox[{"mS", ",", "\[Epsilon]estplot"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"mS", ",", 
     RowBox[{"Min", "[", 
      RowBox[{"mlistScalar", "[", "\[Epsilon]estplot", "]"}], "]"}], ",", 
     RowBox[{"Max", "[", 
      RowBox[{"mlistScalar", "[", "\[Epsilon]estplot", "]"}], "]"}]}], "}"}], 
   ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8927045521296835`*^9, 3.892704618398532*^9}, {
   3.892704651576499*^9, 3.892704652867281*^9}, 3.8951292466391563`*^9, {
   3.8972064547512426`*^9, 3.8972064548441195`*^9}, {3.8972065272743893`*^9, 
   3.8972065273639555`*^9}, {3.897208556347765*^9, 3.8972085563922853`*^9}, {
   3.8972086426345124`*^9, 3.897208654173244*^9}, {3.8975834053329897`*^9, 
   3.897583405869802*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[209]:=",ExpressionUUID->"c0708df4-febd-4a1b-b0f1-77be69c738dd"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Number of events", "Section",
 CellChangeTimes->{{3.8972012736109533`*^9, 3.897201275449023*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"52dc766a-fc2d-4e27-b20c-\
a2032825a0cb"],

Cell[CellGroupData[{

Cell["Number of events - fast", "Subsection",
 CellChangeTimes->{{3.897206442190997*^9, 3.8972064427846107`*^9}, 
   3.905840215846016*^9},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"fd841a0f-44af-405f-899f-\
a884e0e2be9b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FactorLowerBound", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\"\<ANUBIS-shaft-volume-1\>\"", ",", 
          "\"\<ANUBIS-shaft-volume-2\>\"", ",", 
          "\"\<ANUBIS-shaft-volume-3\>\""}], "}"}], ",", 
        "SelectedExperiment"}], "]"}], "==", "True"}], ",", "0.1", ",", 
     "0.3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NeventsDiscret", "[", 
   RowBox[{
   "m_", ",", "ProdChannel_", ",", "BrhToSS_", ",", "\[Theta]2list_"}], "]"}],
   ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"NevDiscret", ",", "NpotTimes\[Chi]val"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"mmin\[Epsilon]", ",", 
         RowBox[{"mSmin", "[", "ProdChannel", "]"}]}], "]"}], "<", "m", "<", 
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"mSmax", "[", "ProdChannel", "]"}], ",", "mmax\[Epsilon]"}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"integrandtab", "=", 
        RowBox[{"TableIntegrandDiscret", "[", 
         RowBox[{"m", ",", "ProdChannel", ",", "\"\<True\>\""}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NpotTimes\[Chi]val", "[", "\[Theta]2_", "]"}], "=", 
        RowBox[{"FactorANUBISceiling", "*", "NpotGivenExperiment", "*", 
         RowBox[{"\[Chi]Xtimes\[Chi]XtoScalar", "[", 
          RowBox[{"m", ",", "\[Theta]2", ",", "BrhToSS", ",", "ProdChannel"}],
           "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"lowerbound", ",", "upperbound"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Theta]2minEstimate", "[", 
           RowBox[{"m", ",", "ProdChannel"}], "]"}], ",", 
          RowBox[{"\[Theta]2maxEstimate", "[", 
           RowBox[{"m", ",", "ProdChannel"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"brvis", "=", 
        RowBox[{"BrVis", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NevDiscret", "[", "\[Theta]2_", "]"}], ":=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"brvis", "!=", "0"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"FactorLowerBound", "*", "lowerbound"}], "<", 
             "\[Theta]2", "<", 
             RowBox[{"1.5", "upperbound"}]}], ",", 
            RowBox[{
             RowBox[{"NpotTimes\[Chi]val", "[", "\[Theta]2", "]"}], "*", 
             "brvis", "*", 
             RowBox[{"sumcompile", "[", 
              RowBox[{"tableprefac", "[", 
               RowBox[{"integrandtab", ",", "m", ",", 
                RowBox[{"c\[Tau]Scalar", "[", 
                 RowBox[{"m", ",", "\[Theta]2"}], "]"}], ",", "1"}], "]"}], 
              "]"}]}], ",", "0"}], "]"}], ",", "0"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"m", ",", 
           RowBox[{"\[Theta]2list", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"NevDiscret", "[", 
            RowBox[{"\[Theta]2list", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "\[Theta]2list", "]"}], ",", "1"}], "}"}]}],
         "]"}]}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"m", ",", 
          RowBox[{"\[Theta]2list", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "\[Theta]2list", "]"}], ",", "1"}], "}"}]}], 
       "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.897200964730176*^9, 3.897200965970766*^9}, {
   3.89720118259857*^9, 3.8972011870868115`*^9}, {3.8972012433916793`*^9, 
   3.8972012434804716`*^9}, {3.8972021109080114`*^9, 3.897202111357911*^9}, {
   3.897205130000824*^9, 3.8972051305748835`*^9}, 3.897206599004672*^9, {
   3.8972085445054307`*^9, 3.8972085493226857`*^9}, {3.897208729717713*^9, 
   3.897208782995672*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[215]:=",ExpressionUUID->"facfaf6c-5b2c-4970-9090-924ba89b8fd1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Number of events - slow (using built-in Mathematica functions Interpolation, \
NIntegrate)\
\>", "Subsection",
 CellChangeTimes->{{3.8972050850842867`*^9, 3.897205097581136*^9}, {
  3.905840218497635*^9, 3.9058402222864003`*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"7d6df444-00ef-4bb9-8404-\
36ef90d39d84"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Differential", " ", "decay", " ", "probability", " ", 
     FractionBox["1", "ldecay"], 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "l"}], "/", "ldecay"}], "]"}]}], ",", " ", 
    RowBox[{
    "where", " ", "l", " ", "is", " ", "expressed", " ", "in", " ", "terms", 
     " ", "of", " ", "the", " ", "longitudinal", " ", "displacement", " ", 
     "z", " ", "and", " ", "polar", " ", "angle", " ", "\[Theta]", " ", "as", 
     " ", 
     RowBox[{"z", "/", "cos\[Theta]"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"PdecayDensity", "[", 
      RowBox[{
      "mS_", ",", "\[Theta]2_", ",", "\[Theta]S_", ",", "ES_", ",", "zS_"}], 
      "]"}], "=", 
     FractionBox[
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "zS"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]S", "]"}], "*", 
          RowBox[{"ldecayScalar", "[", 
           RowBox[{"mS", ",", "\[Theta]2", ",", "ES"}], "]"}]}], ")"}]}], 
       "]"}], 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]S", "]"}], "*", 
       RowBox[{"ldecayScalar", "[", 
        RowBox[{"mS", ",", "\[Theta]2", ",", "ES"}], "]"}]}]]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "The", " ", "integrand", " ", "determining", " ", "the", " ", 
     "differential", " ", "rate", " ", "for", " ", "events"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"IntegrandScalar", "[", 
        RowBox[{
        "mS_", ",", "\[Theta]2_", ",", "\[Theta]S_", ",", "ES_", ",", "zS_", 
         ",", "prod"}], "]"}], "=", 
       RowBox[{"FactorANUBISceiling", "*", 
        RowBox[{"DoubleDistrScalar", "[", 
         RowBox[{"mS", ",", "\[Theta]S", ",", "ES", ",", "prod"}], "]"}], "*", 
        RowBox[{"PdecayDensity", "[", 
         RowBox[{
         "mS", ",", "\[Theta]2", ",", "\[Theta]S", ",", "ES", ",", "zS"}], 
         "]"}], "*", 
        RowBox[{"AzimuthalAcceptanceScalar", "[", 
         RowBox[{"\[Theta]S", ",", "zS"}], "]"}], "*", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"DecayAcceptanceScalar", "[", 
           RowBox[{"mS", ",", "\[Theta]S", ",", "ES", ",", "zS"}], "]"}], ",",
           "1"}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IntegralScalar", "[", 
     RowBox[{"mS_", ",", "\[Theta]2_", ",", "ProdChannel_"}], "]"}], ":=", 
    RowBox[{"NIntegrate", "[", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"IntegrandScalar", "[", 
        RowBox[{
        "mS", ",", "\[Theta]2", ",", "\[Theta]S", ",", "ES", ",", "z", ",", 
         "ProdChannel"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]S", ",", "\[Theta]minExp", ",", "\[Theta]maxExp"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ES", ",", "mS", ",", 
        RowBox[{"ESmax", "[", 
         RowBox[{"mS", ",", "\[Theta]S", ",", "ProdChannel"}], "]"}]}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", 
        RowBox[{"zmin\[Theta]", "[", "\[Theta]S", "]"}], ",", 
        RowBox[{"zmax\[Theta]", "[", "\[Theta]S", "]"}]}], "}"}], ",", 
      RowBox[{"Method", "\[Rule]", "\"\<AdaptiveMonteCarlo\>\""}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]2vall", "=", 
     SuperscriptBox["10", 
      RowBox[{"-", "10"}]]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"factorlower", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<ANUBIS-shaft-volume-1\>\"", ",", 
            "\"\<ANUBIS-shaft-volume-2\>\"", ",", 
            "\"\<ANUBIS-shaft-volume-3\>\""}], "}"}], ",", 
          "SelectedExperiment"}], "]"}], "==", "True"}], ",", "0.1", ",", 
       "0.3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Nevents", "[", 
     RowBox[{"mS_", ",", "\[Theta]2_", ",", "BrhToSS_", ",", "ProdChannel_"}],
      "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"mSmin", "[", "ProdChannel", "]"}], "\[LessEqual]", "mS", 
        "\[LessEqual]", 
        RowBox[{"mSmax", "[", "ProdChannel", "]"}]}], "&&", 
       RowBox[{
        RowBox[{"BrVis", "[", "mS", "]"}], "!=", "0"}]}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"FactorLowerBound", "*", 
          RowBox[{"\[Theta]2minEstimate", "[", 
           RowBox[{"mS", ",", "ProdChannel"}], "]"}]}], "<", "\[Theta]2", "<", 
         RowBox[{"1.8", 
          RowBox[{"\[Theta]2maxEstimate", "[", 
           RowBox[{"mS", ",", "ProdChannel"}], "]"}]}]}], ",", 
        RowBox[{"NpotGivenExperiment", "*", 
         RowBox[{"\[Chi]Xtimes\[Chi]XtoScalar", "[", 
          RowBox[{
          "mS", ",", "\[Theta]2", ",", "BrhToSS", ",", "ProdChannel"}], "]"}],
          "*", 
         RowBox[{"IntegralScalar", "[", 
          RowBox[{"mS", ",", "\[Theta]2", ",", "ProdChannel"}], "]"}]}], ",", 
        "0"}], "]"}], ",", "0"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.897206676519309*^9, 3.8972066766919394`*^9}, {
   3.8972085445134306`*^9, 3.897208556457489*^9}, 3.897208709167758*^9, {
   3.8972087938407507`*^9, 3.897208802487779*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[217]:=",ExpressionUUID->"a31edd84-e884-4b6d-8e20-3f3ccc88322e"],

Cell[CellGroupData[{

Cell["Test", "Subsubsection",
 CellChangeTimes->{{3.8921113169894333`*^9, 3.8921113174761143`*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"9d74e0ef-3c74-473f-808f-\
090f08b0cc6f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "This", " ", "is", " ", "a", " ", "comparison", " ", "between", " ", 
     "the", " ", "slow", " ", "and", " ", "fast", " ", "integration", " ", 
     RowBox[{"methods", ".", " ", "For"}], " ", "the", " ", "selected", " ", 
     "mass", " ", "and", " ", "production", " ", "channel"}], ",", " ", 
    RowBox[{
    "the", " ", "numbers", " ", "of", " ", "events", " ", "obtained", " ", 
     "using", " ", "the", " ", "methods", " ", "should", " ", "agree", " ", 
     "within", " ", "10", "%"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"If", " ", "the", " ", "agreement", " ", "is", " ", "worse"}], 
    ",", " ", 
    RowBox[{
    "there", " ", "may", " ", "be", " ", "a", " ", "few", " ", "reasons"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"1", ")"}], " ", "The", " ", "grid", " ", "for", " ", "the", " ",
      "fast", " ", "method", " ", "is", " ", "not", " ", "dense", " ", 
     RowBox[{"enough", ".", " ", "Try"}], " ", "to", " ", "increase", " ", 
     "the", " ", "grid", " ", "density", " ", 
     RowBox[{"(", 
      RowBox[{
      "OutGrid\[Theta]final", ",", " ", "OutGridEfinal", ",", " ", 
       "OutGridzfinal"}], ")"}], " ", "to", " ", "see", " ", "whether", " ", 
     "the", " ", "agreement", " ", 
     RowBox[{"improves", ".", " ", "Sometimes"}]}], ",", " ", 
    RowBox[{
    "even", " ", "a", " ", "slightly", " ", "denser", " ", "grid", " ", "for",
      " ", 
     RowBox[{"e", ".", "g", ".", " ", "z"}], " ", "may", " ", "lead", " ", 
     "to", " ", "a", " ", "significant", " ", "improvement", " ", "in", " ", 
     "the", " ", "agrement"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"2", ")"}], " ", "The", " ", "Monte"}], "-", 
      RowBox[{
      "Carlo", " ", "integrator", " ", "for", " ", "the", " ", "slow", " ", 
       "method", " ", "fails", " ", "to", " ", "evaluate", " ", 
       "properly"}]}], ";", " ", 
     RowBox[{
     "this", " ", "may", " ", "happen", " ", "if", " ", "the", " ", "range", 
      " ", "of", " ", "the", " ", "integration", " ", "over", " ", "energies",
       " ", "is", " ", "too", " ", "large", " ", "compared", " ", "to", " ", 
      "the", " ", "domain", " ", "where", " ", "most", " ", "of", " ", "the", 
      " ", "events", " ", "actually", " ", "are", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"off", "-", 
         RowBox[{
         "axis", " ", "experiments", " ", "such", " ", "as", " ", "MATHUSLA", 
          " ", "and", " ", "ANUBIS"}]}], ")"}], ".", " ", "Another"}], " ", 
      "symptom", " ", "is", " ", "that", " ", "for", " ", "the", " ", "given",
       " ", "mass", " ", "and", " ", "coupling", " ", "the", " ", "integral", 
      " ", "\"\<jumps\>\""}]}], ",", " ", 
    RowBox[{"i", ".", "e", "."}], ",", " ", 
    RowBox[{
    "returns", " ", "values", " ", "with", " ", "large", " ", "error"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"mtest", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<LHC\>\"", ",", "\"\<FCC-hh\>\""}], "}"}], ",", 
          "FacilityGivenExperiment"}], "]"}], "==", "True"}], ",", "5", ",", 
       "0.5"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ProdTest", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<LHC\>\"", ",", "\"\<FCC-hh\>\""}], "}"}], ",", 
          "FacilityGivenExperiment"}], "]"}], "==", "True"}], ",", 
       "\"\<hQuartic\>\"", ",", "\"\<Bmixing\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]2list", "=", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["10", 
          RowBox[{"-", "12"}]], ",", 
         RowBox[{"3", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "12"}]]}], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "12"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "11"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "11"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "10"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "10"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "9"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "9"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "8"}]], ",", 
         RowBox[{"2", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "8"}]]}], ",", 
         RowBox[{"4", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "8"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "7"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"6", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"7", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"8", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"9", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "6"}]], ",", 
         RowBox[{"2", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "6"}]]}]}], "}"}], "//", "N"}], "*)"}], 
     RowBox[{"Table", "[", 
      RowBox[{
       SuperscriptBox["10", "x"], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"-", "17."}], ",", 
         RowBox[{"-", "3."}], ",", "0.3"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dat1", "=", 
      RowBox[{"NeventsDiscret", "[", 
       RowBox[{
       "mtest", ",", "ProdTest", ",", "BrhToSSreference", ",", 
        "\[Theta]2list"}], "]"}]}], ";"}], "//", "AbsoluteTiming"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dat2", "=", 
      RowBox[{"ParallelTable", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Theta]2list", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"c\[Tau]Scalar", "[", 
           RowBox[{"mtest", ",", 
            RowBox[{"\[Theta]2list", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"Nevents", "[", 
           RowBox[{"mtest", ",", 
            RowBox[{"\[Theta]2list", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "BrhToSSreference", ",", 
            "ProdTest"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "\[Theta]2list", "]"}], ",", "1"}], "}"}]}], 
       "]"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{"dat1", ",", 
      RowBox[{"dat2", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "2"}], "}"}]}], "]"}], "]"}], ",", "2"}], "]"}], "//",
     "TableForm"}]}]}]], "Input",
 CellChangeTimes->{{3.892111330393669*^9, 3.8921113703258653`*^9}, {
   3.8921114855521097`*^9, 3.8921114891326914`*^9}, {3.8921115909252915`*^9, 
   3.89211160107533*^9}, {3.892112023350475*^9, 3.8921120715940514`*^9}, {
   3.8921121043874707`*^9, 3.892112190091645*^9}, {3.892112748834139*^9, 
   3.892112748933666*^9}, {3.8921130465455704`*^9, 3.8921130470314426`*^9}, {
   3.8921131989548674`*^9, 3.8921131992395306`*^9}, {3.892113256325259*^9, 
   3.892113256434625*^9}, {3.892113458241603*^9, 3.8921135323303742`*^9}, {
   3.892116361437076*^9, 3.8921163614848557`*^9}, {3.893257780692194*^9, 
   3.893257792940939*^9}, {3.893260545232792*^9, 3.893260566765787*^9}, {
   3.896953530728937*^9, 3.896953531233162*^9}, {3.896953744363188*^9, 
   3.8969537469343243`*^9}, {3.896953883310589*^9, 3.896953884008139*^9}, {
   3.896971240286153*^9, 3.896971246695673*^9}, {3.8969733757056828`*^9, 
   3.896973378633896*^9}, {3.8969760731711082`*^9, 3.896976348233163*^9}, {
   3.8969763786206193`*^9, 3.896976403680397*^9}, {3.8969764343671703`*^9, 
   3.8969764672032614`*^9}, 3.8972088334478965`*^9, {3.897583304212637*^9, 
   3.8975833265755286`*^9}, {3.897583585283407*^9, 3.897583587625018*^9}, {
   3.8989321141823177`*^9, 3.898932145124889*^9}, {3.9054012126778092`*^9, 
   3.905401239605732*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[223]:=",ExpressionUUID->"456e176c-83e5-4b97-a68f-f8608e598b87"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Differential number of events", "Subsection",
 CellChangeTimes->{{3.892111289211891*^9, 3.892111293865343*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"f1d5b5a4-4a7a-4215-92e6-\
b433834a1702"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "same", " ", "as", " ", "tableprefac", " ", "but", " ", "also",
     " ", "including", " ", "the", " ", "grid"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tableGridPrefac", "=", 
     RowBox[{
      RowBox[{"Hold", "@", 
       RowBox[{"Compile", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"tabb", ",", "_Real", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"mS", ",", "_Real"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c\[Tau]", ",", "_Real"}], "}"}]}], "}"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Cos", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "*", "c\[Tau]", 
                   "*", 
                   FractionBox[
                    SqrtBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "2"], "-", 
                    SuperscriptBox["mS", "2"]}]], "mS"]}], ")"}]}], "]"}], 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "*", "c\[Tau]", "*", 
                FractionBox[
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "2"], "-", 
                   SuperscriptBox["mS", "2"]}]], "mS"]}]], 
              RowBox[{"#", "[", 
               RowBox[{"[", "4", "]"}], "]"}], "*", 
              RowBox[{"#", "[", 
               RowBox[{"[", "5", "]"}], "]"}]}]}], "}"}], "&"}], "/@", 
          "tabb"}], ",", 
         RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
         RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
         RowBox[{"Parallelization", "\[Rule]", "\"\<True\>\""}], ",", 
         RowBox[{"RuntimeAttributes", "\[Rule]", 
          RowBox[{"{", "Listable", "}"}]}]}], "]"}]}], "//", 
      "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Summation", " ", "returning", " ", "the", " ", "differential", " ", 
      "number", " ", "of", " ", "events", " ", "X"}], ",", " ", 
     RowBox[{"df", "/", "dX"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"NdiffCompiled", "=", 
    RowBox[{
     RowBox[{"Hold", "@", 
      RowBox[{"Compile", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"tabNdiff", ",", "_Real", ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"GridQuantity", ",", "_Real", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"LengthPerVariable", ",", "_Integer"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"NPoTtimesPprod", ",", "_Real"}], "}"}]}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"tabNdiff", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"LengthPerVariable", "*", 
                 RowBox[{"(", 
                  RowBox[{"i", "-", "1"}], ")"}]}], "+", "1"}], "]"}], "]"}], 
             "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"NPoTtimesPprod", "*", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"tabNdiff", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"LengthPerVariable", "*", 
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}]}], "+", "j"}], "]"}], 
                 "]"}], "[", 
                RowBox[{"[", "4", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", "LengthPerVariable", ",", "1"}], 
                "}"}]}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "GridQuantity", "]"}], ",", "1"}], "}"}]}],
          "]"}], ",", 
        RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
        RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
        RowBox[{"Parallelization", "\[Rule]", "\"\<True\>\""}]}], "]"}]}], "//",
      "ReleaseHold"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Variable", " ", "=", " ", 
      "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\""}], ",", 
     "\"\<\!\(\*SubscriptBox[\(x\), \(x\)]\)\>\"", ",", 
     RowBox[{
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", ".", " ", "The"}], 
      " ", "number", " ", "belongs", " ", "to", " ", "the", " ", "column", 
      " ", "in", " ", "the", " ", "tabulated", " ", "data"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"iVal", ":=", 
    RowBox[{"Association", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\"", " ", "\[Rule]", "2"}], 
       ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", "\[Rule]", "1"}], 
       ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(x\), \(x\)]\)\>\"", "\[Rule]", "3"}]}], 
      "}"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Differential", " ", "number", " ", "of", " ", "events"}], "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NeventsDifferentialDiscret", "[", 
     RowBox[{
     "m_", ",", "ProdChannel_", ",", "\[Theta]2_", ",", "BrhToSS_", ",", 
      "Variable_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "NpotTimes\[Chi]val", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ival", "=", 
        RowBox[{"iVal", "[", "Variable", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"NpotTimes\[Chi]val", "=", 
        RowBox[{"NpotGivenExperiment", "*", 
         RowBox[{"\[Chi]Xtimes\[Chi]XtoScalar", "[", 
          RowBox[{"m", ",", "\[Theta]2", ",", "BrhToSS", ",", "ProdChannel"}],
           "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tablegrid0", "=", 
        RowBox[{"TableIntegrandDiscret", "[", 
         RowBox[{"m", ",", "ProdChannel", ",", "\"\<True\>\""}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"\[CapitalDelta]xvals", ":=", 
        RowBox[{"Association", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\"", "\[Rule]", 
            "\[CapitalDelta]Evals"}], ",", 
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", "\[Rule]", 
            " ", "\[CapitalDelta]\[Theta]vals"}], ",", 
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(x\), \(X\)]\)\>\"", "\[Rule]", " ", 
            "\[CapitalDelta]zvals"}]}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[CapitalDelta]xval", "=", 
        RowBox[{"\[CapitalDelta]xvals", "[", "Variable", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"c\[Tau]Val", "=", 
        RowBox[{"c\[Tau]Scalar", "[", 
         RowBox[{"m", ",", "\[Theta]2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"brvis", "=", 
        RowBox[{"BrVis", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ilist", "=", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"{", 
          RowBox[{"ival", ",", "1", ",", "2", ",", "3"}], "}"}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"tablegrid1", "=", 
        RowBox[{"SortBy", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"ilist", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"ilist", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"ilist", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "&"}], "/@", 
           RowBox[{"tableGridPrefac", "[", 
            RowBox[{"tablegrid0", ",", "m", ",", "c\[Tau]Val"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"GridQuantity", "=", 
        RowBox[{
         RowBox[{"tablegrid1", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", 
         "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"LengthPerVariable", "=", 
        RowBox[{
         RowBox[{"Length", "[", "tablegrid1", "]"}], "/", 
         RowBox[{"Length", "[", "GridQuantity", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tab1", "=", 
        RowBox[{"NdiffCompiled", "[", 
         RowBox[{
         "tablegrid1", ",", "GridQuantity", ",", "LengthPerVariable", ",", 
          RowBox[{"NpotTimes\[Chi]val", "*", "brvis"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"tab1", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", "1", "}"}]}], "]"}], "]"}], ",", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"tab1", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}], "*", 
            SuperscriptBox["\[CapitalDelta]xval", 
             RowBox[{"-", "1"}]]}], ",", "1"}], "]"}], ",", "2"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mvaltest", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]2test", "=", 
     SuperscriptBox["10", 
      RowBox[{"-", "10."}]]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BrhToSStest", "=", "0.01"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"quantity", "=", "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"LegendX", ":=", 
    RowBox[{"Association", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\"", "\[Rule]", 
        "\"\<\!\(\*SubscriptBox[\(E\), \(S\)]\) [GeV]\>\""}], ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", "\[Rule]", 
        "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(S\)]\) [rad]\>\""}], ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(x\), \(X\)]\)\>\"", "\[Rule]", " ", 
        "\"\<\!\(\*SubscriptBox[\(z\), \(S\)]\) [m]\>\""}]}], "}"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"LegendY", ":=", 
    RowBox[{"Association", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\"", "\[Rule]", 
        "\"\<\!\(\*SubscriptBox[\(dN\), \(ev\)]\)/\!\(\*SubscriptBox[\(dE\), \
\(S\)]\) [\!\(\*SuperscriptBox[\(GeV\), \(-1\)]\)]\>\""}], ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", "\[Rule]", 
        "\"\<\!\(\*SubscriptBox[\(dN\), \(ev\)]\)/\!\(\*SubscriptBox[\(d\
\[Theta]\), \(S\)]\) [\!\(\*SuperscriptBox[\(rad\), \(-1\)]\)]\>\""}], ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(x\), \(X\)]\)\>\"", "\[Rule]", " ", 
        "\"\<\!\(\*SubscriptBox[\(dN\), \(ev\)]\)/\!\(\*SubscriptBox[\(dz\), \
\(S\)]\) [\!\(\*SuperscriptBox[\(m\), \(-1\)]\)]\>\""}]}], "}"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"prodlisttemp", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Max", "[", 
          RowBox[{"mmin\[Epsilon]", ",", 
           RowBox[{"mSmin", "[", "prod", "]"}]}], "]"}], "<", "mvaltest", "<", 
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"mSmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"prodlisttemp", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"prodlisttemp", ",", 
            RowBox[{"{", "prod", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"NdiffData", "[", "prod", "]"}], "=", 
          RowBox[{"NeventsDifferentialDiscret", "[", 
           RowBox[{
           "mvaltest", ",", "prod", ",", "\[Theta]2test", ",", "BrhToSStest", 
            ",", "quantity"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"XvalminmaxNdiff", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"NdiffData", "[", "prod", "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ">", 
                SuperscriptBox["10", 
                 RowBox[{"-", "40"}]]}], "&"}]}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "MinMax"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"NdiffInt", "[", 
           RowBox[{"X_", ",", "prod"}], "]"}], "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"XvalminmaxNdiff", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "<", "X", "<", 
             RowBox[{"XvalminmaxNdiff", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"10", "^", 
              RowBox[{
               RowBox[{"Interpolation", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log10", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Log10", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "90"}]]}], "]"}]}], "}"}], "&"}], "/@", 
                  RowBox[{"NdiffData", "[", "prod", "]"}]}], ",", 
                 RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
               RowBox[{"Log10", "[", "X", "]"}], "]"}]}], "]"}], ",", "0"}], 
           "]"}]}]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NdiffInt", "[", 
      RowBox[{"X_", ",", "\"\<Total\>\""}], "]"}], "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"NdiffInt", "[", 
        RowBox[{"X", ",", "prod"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"prod", ",", "prodlisttemp"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LegendList", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", "\"\<Total\>\"", "}"}], ",", "prodlisttemp"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"QuantityMinMax", "=", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"MinMax", "[", 
          RowBox[{
           RowBox[{"NdiffData", "[", "prod", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"prod", ",", "prodlisttemp"}], "}"}]}], "]"}], ",", "1"}], 
      "]"}], "//", "MinMax"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ValueMinMax", "=", 
     RowBox[{"Max", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"NdiffData", "[", "#", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "&"}], "/@", 
       "prodlisttemp"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"LogLogPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NdiffInt", "[", 
         RowBox[{"X", ",", "prod"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "LegendList"}], "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"X", ",", 
       RowBox[{"QuantityMinMax", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"QuantityMinMax", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox["10", 
           RowBox[{"-", "5"}]], ",", 
          RowBox[{"2", "ValueMinMax"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Black"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Darker", "@", 
           RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Darker", "@", "Cyan"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Magenta"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Blue", ",", 
          RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Darker", "@", "Red"}], ",", 
          RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Darker", "@", 
           RowBox[{"Darker", "@", "Green"}]}], ",", 
          RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"Placed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"#", ",", "20"}], "]"}], "&"}], "/@", "LegendList"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.85", ",", "0.7"}], "}"}]}], "]"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"LegendX", "[", "quantity", "]"}], " ", ",", 
        RowBox[{"LegendY", "[", "quantity", "]"}]}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", " ", "23"}], "]"}]}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{
          "SelectedExperiment", ",", 
           "\"\<. \!\(\*SubscriptBox[\(m\), \(S\)]\) = \>\"", ",", "mvaltest",
            ",", "\"\< GeV, \!\(\*SuperscriptBox[\(\[Theta]\), \(2\)]\) = \
\>\"", ",", 
           RowBox[{"(", 
            RowBox[{"\[Theta]2test", "//", "N"}], ")"}]}], "}"}], "]"}], ",", 
        "20", ",", "Black"}], "]"}]}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"tt", "=", 
      RowBox[{"NeventsDifferentialDiscret", "[", 
       RowBox[{"0.5", ",", "\"\<Bmixing\>\"", ",", 
        SuperscriptBox["10", 
         RowBox[{"-", "11"}]], ",", "0.15", ",", 
        "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ListLogLogPlot", "[", 
       RowBox[{"tt", ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"All", ",", 
           RowBox[{"{", 
            RowBox[{
             SuperscriptBox["10", 
              RowBox[{"-", "9"}]], ",", "100"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}], "\[IndentingNewLine]", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"tt", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "*", 
         RowBox[{"\[CapitalDelta]xval", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "tt", "]"}], ",", "1"}], "}"}]}], "]"}]}]}], 
    "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.8921163996135225`*^9, 3.8921164016036096`*^9}, {
   3.8921164560955544`*^9, 3.892116475031265*^9}, {3.892116516434699*^9, 
   3.8921165782759094`*^9}, {3.8921166461579666`*^9, 
   3.8921166470109124`*^9}, {3.8921167042134895`*^9, 3.892116729930051*^9}, {
   3.8927049818255663`*^9, 3.8927049991222277`*^9}, {3.8929115471019087`*^9, 
   3.892911593659387*^9}, {3.8929721720425777`*^9, 3.892972173350433*^9}, {
   3.8929722208773427`*^9, 3.8929722211847763`*^9}, {3.8932578131000147`*^9, 
   3.893257813645747*^9}, {3.8934746693595037`*^9, 3.893474675301323*^9}, {
   3.8935154039618015`*^9, 3.893515450284458*^9}, {3.893515943430369*^9, 
   3.893515962817915*^9}, 3.893516005738713*^9, {3.893516036174548*^9, 
   3.893516050479193*^9}, {3.893516088577403*^9, 3.893516089018369*^9}, {
   3.893516189974946*^9, 3.8935161902213464`*^9}, {3.8935162352543807`*^9, 
   3.8935162734266047`*^9}, {3.893516595793399*^9, 3.893516611219179*^9}, {
   3.893606026577932*^9, 3.8936060575609436`*^9}, 3.8955578364377675`*^9, {
   3.8969794021337876`*^9, 3.89697940417612*^9}, {3.897206579842867*^9, 
   3.897206594529684*^9}, {3.8972085445254173`*^9, 3.8972085493347607`*^9}, {
   3.897208919899889*^9, 3.897208931547951*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[229]:=",ExpressionUUID->"527d8baf-1a2d-4dd5-9da1-2d533b666b85"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Exporting tabulated number of events", "Title",
 CellChangeTimes->{{3.8850207904521627`*^9, 3.885020796464762*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"f5136f97-573d-41ec-bafe-\
cbcb903e581e"],

Cell[CellGroupData[{

Cell["Definitions", "Chapter",
 CellChangeTimes->{{3.8850542017641125`*^9, 3.885054203349573*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"75cf786b-3cae-4471-be7d-\
a8f2b6c6b657"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DirectoryQ", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<Tabulated Nevents\>\""}], "}"}], "]"}], "]"}], "//", 
       "ToString"}], ")"}], "\[Equal]", "\"\<False\>\""}], ",", 
    RowBox[{"CreateDirectory", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<Tabulated Nevents\>\""}], "}"}], "]"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DirectoryQ", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<Tabulated Nevents/Scalars\>\""}], "}"}], "]"}], "]"}], "//", 
       "ToString"}], ")"}], "\[Equal]", "\"\<False\>\""}], ",", 
    RowBox[{"CreateDirectory", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<Tabulated Nevents/Scalars\>\""}], "}"}], "]"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DirectoryQ", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<Tabulated Nevents/Scalars\>\"", ",", "SelectedExperiment"}], 
          "}"}], "]"}], "]"}], "//", "ToString"}], ")"}], "\[Equal]", 
     "\"\<False\>\""}], ",", 
    RowBox[{"CreateDirectory", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<Tabulated Nevents/Scalars\>\"", ",", "SelectedExperiment"}], 
       "}"}], "]"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<Filenames with tabulated \!\(\*SubscriptBox[\(N\), \(events\)]\):\>\"",
   "]"}], "\[IndentingNewLine]", 
 RowBox[{"ListExport1", ":=", 
  RowBox[{"Association", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<Bmixing\>\"", "->", "\"\<mixing\>\""}], ",", 
     RowBox[{"\"\<Bquartic\>\"", "->", "\"\<quartic\>\""}], ",", 
     RowBox[{"\"\<BsQuartic\>\"", "->", "\"\<quartic\>\""}], ",", 
     RowBox[{"\"\<hQuartic\>\"", "->", "\"\<quartic\>\""}], ",", 
     RowBox[{"\"\<Brem\>\"", "->", "\"\<mixing\>\""}]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ListExport2", ":=", 
  RowBox[{"Association", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<Bmixing\>\"", "->", "\"\<B\>\""}], ",", 
     RowBox[{"\"\<Bquartic\>\"", "->", "\"\<B\>\""}], ",", 
     RowBox[{"\"\<BsQuartic\>\"", "->", "\"\<Bs\>\""}], ",", 
     RowBox[{"\"\<hQuartic\>\"", "->", "\"\<h\>\""}], ",", 
     RowBox[{"\"\<Brem\>\"", "->", "\"\<Brem\>\""}]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"FilenameNevents", "[", "prod", "]"}], "=", 
    RowBox[{"ToString", "@", 
     RowBox[{"StringForm", "[", 
      RowBox[{"\"\<Nevents_Scalar_``_at_``_Npot=``_From_``.dat\>\"", ",", 
       RowBox[{"Sequence", "@@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ListExport1", "[", "prod", "]"}], ",", 
          "SelectedExperiment", ",", 
          RowBox[{
           RowBox[{"NpotGivenExperiment", "//", "CForm"}], "//", "ToString"}],
           ",", 
          RowBox[{"ListExport2", "[", "prod", "]"}]}], "}"}]}]}], "]"}]}]}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"prod", ",", "ProductionList"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"FilenameNevents", "[", "prod", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "//", 
  "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mlistScalarExport", "[", "\"\<Brem\>\"", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
    "0.021", ",", "0.051", ",", "0.1", ",", "0.13", ",", "0.15", ",", "0.2", 
     ",", "0.21", ",", "0.215", ",", "0.22", ",", "0.23", ",", "0.24", ",", 
     "0.25", ",", "0.26", ",", "0.27", ",", "0.28", ",", "0.289", ",", "0.3", 
     ",", "0.35", ",", "0.4", ",", "0.45", ",", "0.5", ",", "0.6", ",", "0.7",
      ",", "0.8", ",", "0.85", ",", "0.9", ",", "0.95", ",", "0.99", ",", 
     "1.02", ",", "1.05", ",", "1.1", ",", "1.3", ",", "1.5", ",", "1.8", ",",
      "1.9", ",", "1.99", ",", "2.1", ",", "2.2", ",", "2.3", ",", "2.4", ",",
      "2.5"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mlistScalarExport", "[", "\"\<Bquartic\>\"", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
    "0.021", ",", "0.051", ",", "0.1", ",", "0.13", ",", "0.15", ",", "0.2", 
     ",", "0.21", ",", "0.215", ",", "0.22", ",", "0.23", ",", "0.24", ",", 
     "0.25", ",", "0.26", ",", "0.27", ",", "0.28", ",", "0.289", ",", "0.3", 
     ",", "0.35", ",", "0.4", ",", "0.45", ",", "0.5", ",", "0.6", ",", "0.7",
      ",", "0.8", ",", "0.85", ",", "0.9", ",", "0.95", ",", "0.99", ",", 
     "1.02", ",", "1.05", ",", "1.1", ",", "1.3", ",", "1.5", ",", "1.8", ",",
      "1.9", ",", "1.99", ",", "2.05", ",", "2.1", ",", "2.2", ",", "2.3", 
     ",", "2.4", ",", "2.5", ",", "2.55"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mlistScalarExport", "[", "\"\<Bmixing\>\"", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
    "0.021", ",", "0.051", ",", "0.1", ",", "0.13", ",", "0.15", ",", "0.17", 
     ",", "0.2", ",", "0.21", ",", "0.215", ",", "0.22", ",", "0.23", ",", 
     "0.24", ",", "0.25", ",", "0.26", ",", "0.27", ",", "0.28", ",", "0.289",
      ",", "0.3", ",", "0.35", ",", "0.4", ",", "0.45", ",", "0.5", ",", 
     "0.6", ",", "0.7", ",", "0.8", ",", "0.85", ",", "0.9", ",", "0.95", ",",
      "0.99", ",", "1.02", ",", "1.05", ",", "1.1", ",", "1.3", ",", "1.5", 
     ",", "1.8", ",", "1.9", ",", "1.99", ",", "2.1", ",", "2.3", ",", "2.4", 
     ",", "2.5", ",", "2.6", ",", "2.7", ",", "2.8", ",", "2.9", ",", "3", 
     ",", "3.1", ",", "3.2", ",", "3.3", ",", "3.5", ",", "3.6", ",", "3.7", 
     ",", "3.8", ",", "3.9", ",", "4", ",", "4.1", ",", "4.2", ",", "4.3", 
     ",", "4.4", ",", "4.5", ",", "4.6", ",", "4.7", ",", "4.8", ",", "4.9", 
     ",", "5", ",", "5.1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mlistScalarExport", "[", "\"\<BsQuartic\>\"", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
    "0.021", ",", "0.051", ",", "0.1", ",", "0.13", ",", "0.15", ",", "0.17", 
     ",", "0.2", ",", "0.21", ",", "0.215", ",", "0.22", ",", "0.23", ",", 
     "0.25", ",", "0.26", ",", "0.28", ",", "0.289", ",", "0.3", ",", "0.35", 
     ",", "0.5", ",", "0.6", ",", "0.7", ",", "0.8", ",", "0.85", ",", "0.9", 
     ",", "0.95", ",", "0.99", ",", "1.02", ",", "1.05", ",", "1.1", ",", 
     "1.3", ",", "1.5", ",", "1.8", ",", "1.9", ",", "1.99", ",", "2.05", ",",
      "2.1", ",", "2.2", ",", "2.3", ",", "2.4", ",", "2.5", ",", "2.55", ",",
      "2.6", ",", "2.65"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mlistScalarExport", "[", "\"\<hQuartic\>\"", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
    "0.021", ",", "0.051", ",", "0.1", ",", "0.13", ",", "0.15", ",", "0.17", 
     ",", "0.2", ",", "0.21", ",", "0.215", ",", "0.22", ",", "0.23", ",", 
     "0.24", ",", "0.25", ",", "0.26", ",", "0.27", ",", "0.28", ",", "0.289",
      ",", "0.3", ",", "0.35", ",", "0.4", ",", "0.45", ",", "0.5", ",", 
     "0.6", ",", "0.7", ",", "0.8", ",", "0.85", ",", "0.9", ",", "0.95", ",",
      "0.99", ",", "1.02", ",", "1.05", ",", "1.1", ",", "1.3", ",", "1.5", 
     ",", "1.8", ",", "1.9", ",", "1.99", ",", "2.1", ",", "2.3", ",", "2.4", 
     ",", "2.5", ",", "2.6", ",", "2.7", ",", "2.8", ",", "2.9", ",", "3", 
     ",", "3.2", ",", "3.3", ",", "3.4", ",", "3.5", ",", "3.6", ",", "3.7", 
     ",", "3.8", ",", "3.9", ",", "4", ",", "4.1", ",", "4.2", ",", "4.3", 
     ",", "4.4", ",", "4.5", ",", "4.6", ",", "4.7", ",", "4.8", ",", "4.9", 
     ",", "5", ",", "5.1", ",", "7.", ",", "10.", ",", "10.6", ",", "12.", 
     ",", "15.", ",", "20.", ",", "30.", ",", "40.", ",", "45.", ",", "50.", 
     ",", "55.", ",", "60.", ",", "61.", ",", "62.", ",", "62.49"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]2list", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      SuperscriptBox["10", "x"], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"-", "20"}], ",", 
        RowBox[{"-", "3"}], ",", "0.02"}], "}"}]}], "]"}], "//", "N"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxNxVtIU3EAB+BTki8xCNYYReDW3MmyaBasObrsT2ERWSkj0uFmE2Wsy2LQ
xc3JGmOFD8MtLMYqpGSjlBIpMzUJs0VqDz0oGj2Mmsuxc8RtbQ6b1fmdpx4+
PqnRUtu8nqKoMg4+/rj4Gp1miDrb6cYW2707eEwYCmBFedcjLNclw5j+Hf6O
q+qUCZyu2SPYwV0vYEvwKZmuFA9uVtN41Ka4gSfG/7Zi23jqTDt3t2prDbaH
vJIk977A3lJ8KbapFi+likw41pS14+CFZgfusf/0YFrwJoifv3P24S3zf/h3
997qFmUYEveefoo7ku5+rA3c5h81zk3h2aZX0/hYJiMW5RniCldLcIco6DRz
P2x44sKzhm871/5bpuw8gM0ex0GsaRgw4F0+XyOObLx/Fc9VjFmxxFQvy60y
ZED7Qo6zxqhfWmDI9Zm2u5hebU3I1xjS5/Pxmz9PvL1CsSTfo/uATzj8n7Ay
cfkLnjmrdVq4/fGTbpw/+rVNto4l3unX7VilPzRfUsSSwUV9FB+uDEWl3CuL
Of5IuTCBGxfK+Aui1H71BpZYTVYldp+jequ4VdstQ3hqm/CHnnvJ3JLGirqW
Fbz8YLmAf2mODBmKWXJTM8n/zFPRHxOzpHLh4kucqzYMY1ukawRnxeffx7kn
Q66P+B/lmV5i
  "],
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[246]:=",ExpressionUUID->"7723a626-82c5-4cfa-9029-8486e71b92ea"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Exporting", "Chapter",
 CellChangeTimes->{{3.885054212114191*^9, 3.885054213032151*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"e9258198-581c-4466-81fa-\
c2dce211dd65"],

Cell[CellGroupData[{

Cell["Common definition", "Section",
 CellChangeTimes->{{3.8921886043857117`*^9, 3.8921886076155424`*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"d35060f3-1238-4e37-aaf7-\
587414385513"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BlockExport", "[", "ProdChannel_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"ProductionList", ",", 
         RowBox[{
          RowBox[{"#", "\[Equal]", "ProdChannel"}], "&"}]}], "]"}], 
       "\[Equal]", 
       RowBox[{"{", "}"}]}], ",", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mlist", "=", 
        RowBox[{"mlistScalarExport", "[", "ProdChannel", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"TabFrom", "=", 
        RowBox[{"Monitor", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"NeventsDiscret", "[", 
             RowBox[{
              RowBox[{"mlist", "[", 
               RowBox[{"[", "k", "]"}], "]"}], ",", "ProdChannel", ",", 
              "BrhToSSreference", ",", "\[Theta]2list"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", 
              RowBox[{"Length", "[", "mlist", "]"}], ",", "1"}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"Row", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ProgressIndicator", "[", 
               RowBox[{"k", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"Length", "[", "mlist", "]"}]}], "}"}]}], "]"}], 
              ",", "\"\<i = \>\"", ",", "k", ",", "\"\</\>\"", ",", 
              RowBox[{"Length", "[", "mlist", "]"}], ",", "\"\<, m = \>\"", 
              ",", 
              RowBox[{"mlist", "[", 
               RowBox[{"[", "k", "]"}], "]"}], ",", "\"\< GeV\>\""}], "}"}], 
            ",", "\"\< \>\""}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], ",", 
            "\"\<Tabulated Nevents/Scalars\>\"", ",", "SelectedExperiment", 
            ",", 
            RowBox[{"FilenameNevents", "[", "ProdChannel", "]"}]}], "}"}], 
          "]"}], ",", 
         RowBox[{"Flatten", "[", 
          RowBox[{"TabFrom", ",", "1"}], "]"}], ",", "\"\<Table\>\""}], 
        "]"}]}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8921886102299604`*^9, 3.892188661864987*^9}, {
  3.892188696661598*^9, 3.892188782889353*^9}, {3.8921888713769283`*^9, 
  3.8921888914281387`*^9}, {3.892190937661848*^9, 3.8921909466626697`*^9}, {
  3.8922765048644934`*^9, 3.8922765048725324`*^9}, {3.892541051864915*^9, 
  3.8925411081031237`*^9}, {3.8925422299627275`*^9, 3.8925422591259813`*^9}, {
  3.892542627960807*^9, 3.8925426356350746`*^9}, {3.8939562182259045`*^9, 
  3.8939562188380885`*^9}, {3.89412815552805*^9, 3.8941281747081137`*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[261]:=",ExpressionUUID->"4373bb38-5ade-4168-a342-6cca5c2ca723"]
}, Open  ]],

Cell[CellGroupData[{

Cell["From B - mixing", "Section",
 CellChangeTimes->{{3.8850542186134644`*^9, 3.8850542291940546`*^9}, {
  3.8850543968830786`*^9, 3.8850543972568283`*^9}, {3.8854566349217353`*^9, 
  3.885456635821289*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"ea35df86-1f74-459c-b50f-\
d9e15ebea561"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BlockExport", "[", "\"\<Bmixing\>\"", "]"}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.885054438676489*^9, 3.8850544565771933`*^9}, {
   3.885232743746546*^9, 3.8852327455696564`*^9}, {3.8854560165334034`*^9, 
   3.885456016535404*^9}, {3.8854561722106504`*^9, 3.8854561810253243`*^9}, {
   3.885456572039451*^9, 3.885456572042471*^9}, 3.8854567168132315`*^9, {
   3.888431495206427*^9, 3.888431497824603*^9}, 3.890472106680231*^9, {
   3.890818922828018*^9, 3.890818938883238*^9}, {3.890820210564623*^9, 
   3.89082022206966*^9}, {3.890842110056125*^9, 3.890842127776891*^9}, {
   3.8908426142780185`*^9, 3.8908426152558317`*^9}, 3.892540833511501*^9, 
   3.89254106705661*^9, {3.8925411331937513`*^9, 3.892541143614643*^9}, {
   3.892542568067643*^9, 3.892542574027015*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[262]:=",ExpressionUUID->"8a8a9ffb-2c26-4fa7-ab09-097069ace5ee"]
}, Open  ]],

Cell[CellGroupData[{

Cell["From B - quartic", "Section",
 CellChangeTimes->{{3.8850542186134644`*^9, 3.8850542193674097`*^9}, {
  3.8854566234521356`*^9, 3.8854566261318445`*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"8c40accd-0a6a-412a-b047-\
73e5a007e9c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BlockExport", "[", "\"\<Bquartic\>\"", "]"}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8850542358688993`*^9, 3.8850542382094545`*^9}, {
   3.885054277631763*^9, 3.885054363431921*^9}, {3.8854560510752897`*^9, 
   3.8854560510763087`*^9}, 3.8854563630285983`*^9, {3.8854565716829195`*^9, 
   3.885456571685834*^9}, {3.885456613051569*^9, 3.885456619872187*^9}, {
   3.8854567159384456`*^9, 3.8854567461856785`*^9}, {3.888431488591481*^9, 
   3.8884314919900117`*^9}, 3.8904721151645985`*^9, {3.8908190417855015`*^9, 
   3.8908190737865143`*^9}, {3.890820226108536*^9, 3.8908202713612375`*^9}, {
   3.890842619858616*^9, 3.8908426306022778`*^9}, 3.8925410670607824`*^9, {
   3.892541148254505*^9, 3.892541152959505*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[263]:=",ExpressionUUID->"251a96a0-7c49-47ab-9730-fff488f299a7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "From ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["B", "s"], TraditionalForm]],ExpressionUUID->
  "eee78e6a-f0a5-4d58-87a6-b5eacf20a3b9"],
 " - quartic"
}], "Section",
 CellChangeTimes->{{3.8850542186134644`*^9, 3.8850542262841854`*^9}, {
  3.885456652772599*^9, 3.8854566559423475`*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"5e1d1941-ec23-4b2c-9214-\
a8a714e4ebf1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BlockExport", "[", "\"\<BsQuartic\>\"", "]"}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8850542358688993`*^9, 3.8850542382094545`*^9}, {
   3.885054277631763*^9, 3.8850543855153503`*^9}, {3.885456042480401*^9, 
   3.8854560424814262`*^9}, 3.8854561637649994`*^9, {3.88545657204498*^9, 
   3.885456572050495*^9}, {3.885456661477639*^9, 3.885456668992567*^9}, 
   3.8854567150256567`*^9, {3.885456747613888*^9, 3.885456747806327*^9}, {
   3.8884315113521614`*^9, 3.8884315152724876`*^9}, 3.890472127050679*^9, {
   3.890819066926276*^9, 3.8908190940297956`*^9}, {3.890820274636649*^9, 
   3.890820289738728*^9}, {3.890820326588763*^9, 3.8908203271108007`*^9}, {
   3.890842624929758*^9, 3.890842632767597*^9}, 3.8925410670654435`*^9, {
   3.8925550453057995`*^9, 3.8925550492265425`*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[264]:=",ExpressionUUID->"e9f8c662-0678-4db9-abde-7b46d97dbdd9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["From h - quartic", "Section",
 CellChangeTimes->{{3.8850542186134644`*^9, 3.88505422780166*^9}, {
  3.8854566729323483`*^9, 3.8854566730023046`*^9}, {3.8854567532255774`*^9, 
  3.8854567544560757`*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"ca48eaac-b3bc-4d9f-b92f-\
8df4efb016c7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BlockExport", "[", "\"\<hQuartic\>\"", "]"}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8850544007056713`*^9, 3.885054414558234*^9}, {
   3.8854560332901382`*^9, 3.8854560332917004`*^9}, 3.885456351259536*^9, {
   3.885456572052494*^9, 3.8854565720560255`*^9}, {3.8854566760728145`*^9, 
   3.885456710104888*^9}, {3.885456749954727*^9, 3.885456750125414*^9}, {
   3.8884315185121903`*^9, 3.888431521558514*^9}, 3.8886382869017344`*^9, 
   3.8904721349997463`*^9, {3.890819085358663*^9, 3.8908190921218295`*^9}, {
   3.890820303109606*^9, 3.8908203451139245`*^9}, 3.890842634338107*^9, 
   3.892541067070799*^9, {3.892555052537258*^9, 3.8925550541450057`*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[265]:=",ExpressionUUID->"fe590329-9d73-4c45-8f2f-e9dd63752e16"]
}, Open  ]],

Cell[CellGroupData[{

Cell["From bremsstrahlung", "Section",
 CellChangeTimes->{{3.8850542186134644`*^9, 3.88505422780166*^9}, {
  3.8854566729323483`*^9, 3.8854566730023046`*^9}, {3.8854567532255774`*^9, 
  3.8854567544560757`*^9}, {3.8939522686485577`*^9, 3.8939522721646404`*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"3e342d3f-9bfe-469b-ad5d-\
081929859f69"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BlockExport", "[", "\"\<Brem\>\"", "]"}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8850544007056713`*^9, 3.885054414558234*^9}, {
   3.8854560332901382`*^9, 3.8854560332917004`*^9}, 3.885456351259536*^9, {
   3.885456572052494*^9, 3.8854565720560255`*^9}, {3.8854566760728145`*^9, 
   3.885456710104888*^9}, {3.885456749954727*^9, 3.885456750125414*^9}, {
   3.8884315185121903`*^9, 3.888431521558514*^9}, 3.8886382869017344`*^9, 
   3.8904721349997463`*^9, {3.890819085358663*^9, 3.8908190921218295`*^9}, {
   3.890820303109606*^9, 3.8908203451139245`*^9}, 3.890842634338107*^9, 
   3.892541067070799*^9, {3.892555052537258*^9, 3.8925550541450057`*^9}, {
   3.8939522754607687`*^9, 3.893952276609346*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[266]:=",ExpressionUUID->"7570cf2f-ddac-4312-a71e-fab82c49fc4f"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Computing sensitivities", "Title",
 CellChangeTimes->{{3.885020809493571*^9, 3.88502081261261*^9}},
 CellTags->{
  "Sensitivity", 
   "Re-evaluation"},ExpressionUUID->"2ce189e8-ece2-4e74-afba-65f86fa4e6b1"],

Cell[CellGroupData[{

Cell["Importing data and interpolations", "Chapter",
 CellChangeTimes->{{3.888640230459095*^9, 3.8886402340383005`*^9}},
 CellTags->{
  "Sensitivity", 
   "Re-evaluation"},ExpressionUUID->"07b3dd6c-5bc5-4374-ad95-caec94e93ed0"],

Cell[BoxData[{
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"DirectoryQ", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", 
          "\"\<Sensitivity domains\>\""}], "}"}], "]"}], "]"}], "//", 
      "ToString"}], ")"}], "\[Equal]", "\"\<False\>\""}], ",", 
   RowBox[{"CreateDirectory", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", 
       "\"\<Sensitivity domains\>\""}], "}"}], "]"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"DirectoryQ", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", 
          "\"\<Sensitivity domains\>\"", ",", "\"\<Scalars\>\""}], "}"}], 
        "]"}], "]"}], "//", "ToString"}], ")"}], "\[Equal]", 
    "\"\<False\>\""}], ",", 
   RowBox[{"CreateDirectory", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", 
       "\"\<Sensitivity domains\>\"", ",", "\"\<Scalars\>\""}], "}"}], "]"}], 
    "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NeventsDirectory", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<Tabulated Nevents\>\"", ",", "\"\<Scalars\>\""}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentDirectoriesListNevents", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"FileNames", "[", 
      RowBox[{"\"\<*\>\"", ",", "NeventsDirectory", ",", "1"}], "]"}], ",", 
     "DirectoryQ"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<List of available experiments with tabulated \!\(\*SubscriptBox[\(N\), \
\(events\)]\) for Scalars:\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentsListNevents", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"FileNameTake", "[", 
       RowBox[{
        RowBox[{"ExperimentDirectoriesListNevents", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "ExperimentDirectoriesListNevents", "]"}], ",",
         "1"}], "}"}]}], "]"}], "//", "Sort"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ExperimentsListNevents", "//", "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", "ExperimentsListNevents", "]"}], "\[Equal]", "0"}],
    ",", 
   RowBox[{
   "Print", "[", 
    "\"\<No experiment is available, generate first the acceptance for the \
given experiment using module 1\>\"", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Selected experiment:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", "ExperimentsListNevents", "]"}], "\[NotEqual]", 
    "0"}], ",", 
   RowBox[{"GivenExperimentForSensitivityComputation", "=", 
    RowBox[{"dropdownDialog", "[", 
     RowBox[{
     "ExperimentsListNevents", ",", "\"\<Select the experiment:\>\""}], 
     "]"}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CondANUBIS", "=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<ANUBIS-shaft-volume-1\>\"", ",", "\"\<ANUBIS-shaft-volume-2\>\"", 
       ",", "\"\<ANUBIS-shaft-volume-3\>\""}], "}"}], ",", 
     "GivenExperimentForSensitivityComputation"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"CondANUBIS", "\[Equal]", "True"}], ",", 
   RowBox[{"infoDialog", "[", 
    RowBox[{"Row", "[", 
     RowBox[{
     "{", "\"\<One of the modules of ANUBIS-shaft is chosen. The full \
sensitivity includes three modules. The importing will be over all modules, \
so for all ot the the sensitivity has to be computed\>\"", "}"}], "]"}], 
    "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"CondANUBIS", "\[Equal]", "False"}], ",", 
    RowBox[{"GivenExperimentForSensitivityComputationList", "=", 
     RowBox[{"{", "GivenExperimentForSensitivityComputation", "}"}]}], ",", 
    RowBox[{"GivenExperimentForSensitivityComputationList", "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\<ANUBIS-shaft-volume-1\>\"", ",", "\"\<ANUBIS-shaft-volume-2\>\"", 
       ",", "\"\<ANUBIS-shaft-volume-3\>\""}], "}"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filesNevents", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{"filesNevents", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"filesNevents", ",", 
        RowBox[{"FileNames", "[", 
         RowBox[{"\"\<*.dat\>\"", ",", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"NotebookDirectory", "[", "]"}], ",", 
             "\"\<Tabulated Nevents/Scalars\>\"", ",", "exp"}], "}"}], 
           "]"}]}], "]"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "GivenExperimentForSensitivityComputationList"}], 
      "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Filenames", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"StringReplace", "[", 
         RowBox[{
          RowBox[{"Last", "@", 
           RowBox[{"FileNameSplit", "@", 
            RowBox[{"files", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<e+0\>\"", "\[RuleDelayed]", "\"\<*^\>\""}], ",", 
            RowBox[{"\"\<e-0\>\"", "\[RuleDelayed]", "\"\<*^-\>\""}]}], 
           "}"}]}], "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "files", "]"}], ",", "1"}], "}"}]}], "]"}]}], 
    ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<List of production channels:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FilenamesNevents", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Last", "@", 
      RowBox[{"FileNameSplit", "@", 
       RowBox[{"filesNevents", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "filesNevents", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FilenameParameters", "[", "i_", "]"}], ":=", 
  RowBox[{
   RowBox[{"StringCases", "[", 
    RowBox[{
     RowBox[{"FilenamesNevents", "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{
      "\"\<Nevents_Scalar_\>\"", "~~", "coupling__", "~~", "\"\<_at_\>\"", "~~",
        "experiment__", "~~", "\"\<_Npot=\>\"", "~~", "Npot__", "~~", 
       "\"\<_From_\>\"", "~~", "mother__", "~~", "\"\<.dat\>\""}], ":>", 
      RowBox[{"{", 
       RowBox[{"coupling", ",", "experiment", ",", "Npot", ",", "mother"}], 
       "}"}]}]}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductionChannelsList", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"FilenameParameters", "[", "i", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "FilenamesNevents", "]"}], ",", "1"}], 
        "}"}]}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "1", ",", "3", ",", "4"}], "}"}]}], "]"}], "]"}], "//",
     "DeleteDuplicates"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
      "\"\<coupling type\>\"", ",", "\"\<Experiment\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(N\), \(PoT\)]\)\>\"", ",", 
       "\"\<Mother particle\>\""}], "}"}], "}"}], ",", 
    "ProductionChannelsList"}], "]"}], "//", 
  "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NpotDefault", "=", 
   RowBox[{
    RowBox[{"Interpreter", "[", "\"\<Number\>\"", "]"}], "[", 
    RowBox[{
     RowBox[{"ProductionChannelsList", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NeventsTabulatedList", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{"filesNevents", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<Table\>\""}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "filesNevents", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IfzeroList", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"NeventsTabulatedList", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ">", 
              SuperscriptBox["10", 
               RowBox[{"-", "5"}]]}], "&"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}], "==", "0"}], ",", 
       "0", ",", "1"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "NeventsTabulatedList", "]"}], ",", "1"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NeventsTabulatedList", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"IfzeroList", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "==", "1"}], ",", 
         RowBox[{"NeventsTabulatedList", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "IfzeroList", "]"}], ",", "1"}], "}"}]}], 
      "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"{", "Null", "}"}], ",", "#"}], "]"}], "==", "False"}], 
      "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mSminmaxTabulated", "[", "i_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"IfzeroList", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "==", "1"}], ",", 
    RowBox[{"MinMax", "[", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"NeventsTabulatedList", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ">", 
          SuperscriptBox["10", 
           RowBox[{"-", "30"}]]}], "&"}]}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]2minmaxTabulated", "[", "i_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"IfzeroList", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "==", "1"}], ",", 
    RowBox[{"MinMax", "[", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"NeventsTabulatedList", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ">", 
          SuperscriptBox["10", 
           RowBox[{"-", "30"}]]}], "&"}]}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mSminmaxOverall", "=", 
   RowBox[{"MinMax", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"mSminmaxTabulated", "[", "i", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "NeventsTabulatedList", "]"}], ",", "1"}], 
        "}"}]}], "]"}], "//", "Flatten"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]2minmaxOverall", "=", 
   RowBox[{"MinMax", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"\[Theta]2minmaxTabulated", "[", "i", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "NeventsTabulatedList", "]"}], ",", "1"}], 
        "}"}]}], "]"}], "//", "Flatten"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NevintMixing", "[", "i_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"mSminmaxTabulated", "[", "i", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", " ", "mS", 
      "\[LessEqual]", 
      RowBox[{
       RowBox[{"mSminmaxTabulated", "[", "i", "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "&&", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Theta]2minmaxTabulated", "[", "i", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", "\[Theta]2", 
      "\[LessEqual]", " ", 
      RowBox[{
       RowBox[{"\[Theta]2minmaxTabulated", "[", "i", "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
    RowBox[{"Evaluate", "[", 
     RowBox[{"10", "^", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Log10", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
              RowBox[{"Log10", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
              RowBox[{"Log10", "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "+", 
                SuperscriptBox["10", 
                 RowBox[{"-", "90"}]]}], "]"}]}], "}"}], "&"}], "/@", 
           RowBox[{"NeventsTabulatedList", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
        RowBox[{
         RowBox[{"Log10", "[", "mS", "]"}], ",", 
         RowBox[{"Log10", "[", "\[Theta]2", "]"}]}], "]"}], ")"}]}], "]"}], 
    ",", "0"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BrhToSSreference", "=", "0.15"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NevintQuartic", "[", "i_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"mSminmaxTabulated", "[", "i", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", " ", "mS", 
      "\[LessEqual]", 
      RowBox[{
       RowBox[{"mSminmaxTabulated", "[", "i", "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "&&", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Theta]2minmaxTabulated", "[", "i", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", "\[Theta]2", 
      "\[LessEqual]", " ", 
      RowBox[{
       RowBox[{"\[Theta]2minmaxTabulated", "[", "i", "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
    RowBox[{"Evaluate", "[", 
     RowBox[{
      FractionBox["BrhToSS", "BrhToSSreference"], 
      RowBox[{"10", "^", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Log10", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
               RowBox[{"Log10", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
               RowBox[{"Log10", "[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "+", 
                 SuperscriptBox["10", 
                  RowBox[{"-", "90"}]]}], "]"}]}], "}"}], "&"}], "/@", 
            RowBox[{"NeventsTabulatedList", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
         RowBox[{
          RowBox[{"Log10", "[", "mS", "]"}], ",", 
          RowBox[{"Log10", "[", "\[Theta]2", "]"}]}], "]"}], ")"}]}]}], "]"}],
     ",", "0"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NevIntList", "[", 
    RowBox[{"mS_", ",", "\[Theta]2_", ",", "BrhToSS_"}], "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"ProductionChannelsList", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "\"\<mixing\>\""}], ",", 
       RowBox[{"NevintMixing", "[", "i", "]"}], ",", 
       RowBox[{"NevintQuartic", "[", "i", "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "NeventsTabulatedList", "]"}], ",", "1"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NevTot", "[", 
    RowBox[{"mS_", ",", "\[Theta]2_", ",", "BrhToSS_"}], "]"}], "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NevIntList", "[", 
       RowBox[{"mS", ",", "\[Theta]2", ",", "BrhToSS"}], "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"NevIntList", "[", 
         RowBox[{"mS", ",", "\[Theta]2", ",", "BrhToSS"}], "]"}], "]"}], ",", 
       "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentFolder", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"CondANUBIS", "\[Equal]", "True"}], ",", "\"\<ANUBIS-shaft\>\"", 
     ",", "GivenExperimentForSensitivityComputation"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"DirectoryQ", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", 
          "\"\<Sensitivity domains\>\"", ",", "\"\<Scalars\>\"", ",", 
          "ExperimentFolder"}], "}"}], "]"}], "]"}], "//", "ToString"}], 
     ")"}], "\[Equal]", "\"\<False\>\""}], ",", 
   RowBox[{"CreateDirectory", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", 
       "\"\<Sensitivity domains\>\"", ",", "\"\<Scalars\>\"", ",", 
       "ExperimentFolder"}], "}"}], "]"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdxUsow3EAB/CZLAfvXeZg5VETdkDCQn6s5f1K84xaIzKb/C8iJWqHNeSC
pZZHXrsYrRymTCF5RaS/OBAx7B+hJe//93f49InUGCqahAKBIIKHbT9zSb8f
HnLHLNHLw3zUWNkmrMHjbkkrft+PbMcHIZNLOI1ROnCsQmw3fXqIKn90GZ9+
XTCvfx6ysnZJ70wyVEf7cMRrf6nDu3nnLVhZ/0jfPO7u2eCPN2h6sTpdFNUs
5EiubViGs6ymeGzWGeU4JigmGRdJz1VYoS0sxINsFX3yaWcQV76d0NtWg+f3
+KX+YnptVmmqwo8j9oeiTFyynWJV8Q8nDtGdEe/ORhFH5E/fLuzOsazH+XNk
u9/qwtMNq1t4YeCKvm50JGj5mZFwOW7vu/Wd5R8dy/XDZ67De2kgR9iyOjdO
YHUqr4Qjd/qjYqzvYipwxvO1FrOynVZcL1HocGjNTAfWyhfpjimxBRdEnU1g
kzlgFmffhND/AZ5+5w8=
  "],
 CellTags->{"Sensitivity", "Re-evaluation"},
 CellLabel->
  "In[267]:=",ExpressionUUID->"01ff1478-030e-432f-be11-c30e96d2eaaa"],

Cell[CellGroupData[{

Cell["Density plot for number of events", "Section",
 CellChangeTimes->{{3.8929107346824093`*^9, 3.8929107391764154`*^9}},
 CellTags->{
  "Sensitivity", 
   "Re-evaluation"},ExpressionUUID->"774c689c-d8e1-4948-b114-3e9e9146e0d5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Nevmax", "=", 
   RowBox[{"Max", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{"NeventsTabulatedList", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "NeventsTabulatedList", "]"}], ",", "1"}], 
       "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BrhToSSval", "=", "0.01"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "If", " ", "the", " ", "plot", " ", "is", " ", "not", " ", "as", " ", 
     "smooth", " ", "as", " ", "it", " ", "is", " ", "desired"}], ",", " ", 
    RowBox[{
    "increase", " ", "the", " ", "value", " ", "of", " ", "PlotPoints", " ", 
     "option"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plot", "=", 
   RowBox[{"DensityPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{"Log10", "[", 
       RowBox[{"NevTot", "[", 
        RowBox[{"mS", ",", "\[Theta]2", ",", "BrhToSSval"}], "]"}], "]"}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"mS", ",", 
       RowBox[{"mSminmaxOverall", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"mSminmaxOverall", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]2", ",", 
       RowBox[{"\[Theta]2minmaxOverall", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"\[Theta]2minmaxOverall", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"ScalingFunctions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Log\>\"", ",", "\"\<Log\>\""}], "}"}]}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", "0.78"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"All", ",", "All", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Log10", "[", "2.3", "]"}], ",", 
          RowBox[{"Log10", "[", "Nevmax", "]"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(m\), \(S\)]\) [GeV]\>\"", ",", 
        "\"\<\!\(\*SuperscriptBox[\(\[Theta]\), \(2\)]\)\>\""}], "}"}]}], ",",
      " ", 
     RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", " ", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", " ", "25"}], "]"}]}], ",", 
     RowBox[{"PlotPoints", "\[Rule]", "100"}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"Placed", "[", 
       RowBox[{
        RowBox[{"BarLegend", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Automatic", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Log10", "[", "2.3", "]"}], ",", 
              RowBox[{"Log10", "[", "Nevmax", "]"}]}], "}"}]}], "}"}], ",", 
          RowBox[{"LegendMarkerSize", "\[Rule]", "340"}], ",", 
          RowBox[{"LegendLabel", "\[Rule]", 
           RowBox[{"Placed", "[", 
            RowBox[{
            "\"\<\!\(\*SubscriptBox[\(Log\), \(10\)]\)[\!\(\*SubscriptBox[\(N\
\), \(ev\)]\)]\>\"", ",", "Bottom"}], "]"}]}], ",", 
          RowBox[{"LabelStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"FontSize", "\[Rule]", "22"}], "}"}]}], ",", 
          RowBox[{"Method", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
             RowBox[{"AxesStyle", "\[Rule]", "None"}], ",", 
             RowBox[{"TicksStyle", "\[Rule]", "Black"}]}], "}"}]}]}], "]"}], 
        ",", "Right"}], "]"}]}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{
          "ExperimentFolder", ",", "\"\<, Br(h\[Rule]SS) = \>\"", ",", 
           "BrhToSSval"}], "}"}], "]"}], ",", "20", ",", "Black"}], "]"}]}]}], 
    RowBox[{"(*", 
     RowBox[{",", 
      RowBox[{"FrameTicks", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Automatic", ",", "Automatic"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"TicksPlotx", ",", "None"}], "}"}]}], "}"}]}]}], "*)"}], 
    "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Exporting", ".", " ", "\"\<AllowRasterization\>\""}], "->", 
     RowBox[{
     "False", " ", "option", " ", "reduces", " ", "the", " ", "size", " ", 
      "of", " ", "the", " ", 
      RowBox[{"output", ".", " ", "Without"}], " ", "this", " ", "option"}]}],
     ",", " ", 
    RowBox[{
    "the", " ", "file", " ", "may", " ", "be", " ", "very", " ", "large"}], 
    ",", " ", 
    RowBox[{
    "depending", " ", "on", " ", "the", " ", "value", " ", "of", " ", 
     "PlotPoints"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<NeventsDensityPlotExample.pdf\>\""}], "}"}], "]"}], ",", "plot", 
     ",", 
     RowBox[{"\"\<AllowRasterization\>\"", "->", "False"}]}], "]"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.8929107497085266`*^9, 3.8929107744261785`*^9}, {
   3.892910861445203*^9, 3.8929109001869607`*^9}, {3.892910943526046*^9, 
   3.8929109465202713`*^9}, {3.893224729770398*^9, 3.8932247313824215`*^9}, {
   3.893572155852467*^9, 3.8935721598179455`*^9}, {3.8937454038713837`*^9, 
   3.8937454070652494`*^9}, 3.8956463351379347`*^9, 3.89564644289021*^9, {
   3.895647551533736*^9, 3.895647634039733*^9}, {3.895655834660489*^9, 
   3.8956558350038366`*^9}},
 CellTags->{"Sensitivity", "Re-evaluation"},
 CellLabel->
  "In[303]:=",ExpressionUUID->"fae948ac-5c53-425d-8842-e6b4ca896596"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Sensitivity computation", "Chapter",
 CellChangeTimes->{{3.888640440992809*^9, 3.888640444396226*^9}},
 CellTags->{
  "Sensitivity", 
   "Re-evaluation"},ExpressionUUID->"0d834004-01d7-412b-b48e-402cf64fc469"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SensitivityBlock", "[", 
   RowBox[{"Nev_", ",", "BrhToSSval_", ",", "Npot_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RegSens", "=", 
      RowBox[{"RegionPlot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          FractionBox["Npot", "NpotDefault"], 
          RowBox[{"NevTot", "[", 
           RowBox[{
            SuperscriptBox["10", "mS"], ",", 
            SuperscriptBox["10", "\[Theta]2"], ",", "BrhToSSval"}], "]"}]}], 
         "\[GreaterEqual]", "Nev"}], ",", 
        RowBox[{"{", 
         RowBox[{"mS", ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"mSminmaxOverall", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"mSminmaxOverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]2", ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"\[Theta]2minmaxOverall", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"\[Theta]2minmaxOverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotPoints", "->", "100"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Sens", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"10", "^", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"10", "^", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], "&"}], "/@", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"Normal", "@", "RegSens"}], ",", 
              RowBox[{
               RowBox[{"Line", "[", "x_", "]"}], "\[RuleDelayed]", "x"}], ",",
               "Infinity"}], "]"}], "]"}], ",", "2"}], "]"}]}]}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"SensTemp", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"Normal", "@", "RegSens"}], ",", 
        RowBox[{
         RowBox[{"Line", "[", "x_", "]"}], "\[RuleDelayed]", "x"}], ",", 
        "Infinity"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Sens", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"10", "^", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"10", "^", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], "&"}], "/@", 
         RowBox[{"SensTemp", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "SensTemp", "]"}], ",", "1"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", 
          "\"\<Sensitivity domains\>\"", ",", "\"\<Scalars\>\"", ",", 
          "ExperimentFolder", ",", 
          RowBox[{"ToString", "@", 
           RowBox[{"StringForm", "[", 
            RowBox[{
            "\"\<Sensitivity_Scalar_at_``_BrhToSS=``_Nev=``_Npot=``.xls\>\"", 
             ",", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"{", 
               RowBox[{"ExperimentFolder", ",", 
                RowBox[{"BrhToSSval", "//", "ToString"}], ",", 
                RowBox[{"Nev", "//", "ToString"}], ",", 
                RowBox[{
                 RowBox[{"Npot", "//", "CForm"}], "//", "ToString"}]}], 
               "}"}]}]}], "]"}]}]}], "}"}], "]"}], ",", "Sens"}], "]"}], ";", 
     "\[IndentingNewLine]", "Sens"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<The value of Br(h->SS) for which the sensitivity will be \
computed:\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"BrhToSSval", "=", 
  RowBox[{
   RowBox[{"DialogInput", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"br", "=", "\"\<\>\""}], "}"}], ",", 
     RowBox[{"Column", "[", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Enter the value of Br(h->SS) for which the sensitivity will be \
computed (0 corresponds to the BC4 model):\>\"", ",", 
        RowBox[{"InputField", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "br", "]"}], ",", "Number"}], "]"}], ",", 
        RowBox[{"Button", "[", 
         RowBox[{"\"\<Proceed\>\"", ",", 
          RowBox[{"DialogReturn", "[", "br", "]"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Automatic"}]}], "]"}]}], "}"}], 
      "]"}]}], "]"}], "//", "N"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<The number of proton collisions:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"NpotDefault", "=", 
  RowBox[{
   RowBox[{"DialogInput", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"br", "=", "NpotDefault"}], "}"}], ",", 
     RowBox[{"Column", "[", 
      RowBox[{"{", 
       RowBox[{"\"\<Enter the number of proton collisions\>\"", ",", 
        RowBox[{"InputField", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "br", "]"}], ",", "Expression"}], "]"}], 
        ",", 
        RowBox[{"Button", "[", 
         RowBox[{"\"\<Proceed\>\"", ",", 
          RowBox[{"DialogReturn", "[", "br", "]"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Automatic"}]}], "]"}]}], "}"}], 
      "]"}]}], "]"}], "//", "N"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<The minimal number of events \!\(\*SubscriptBox[\(N\), \(events, \
min\)]\) for which the sensitivity will be computed:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"NevMinVal", "=", 
  RowBox[{
   RowBox[{"DialogInput", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nev", "=", "2.3"}], "}"}], ",", 
     RowBox[{"Column", "[", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Enter the value of \!\(\*SubscriptBox[\(N\), \(events, min\)]\) \
for which the sensitivity will be computed:\>\"", ",", 
        RowBox[{"InputField", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "nev", "]"}], ",", "Expression"}], "]"}], 
        ",", 
        RowBox[{"Button", "[", 
         RowBox[{"\"\<Proceed\>\"", ",", 
          RowBox[{"DialogReturn", "[", "nev", "]"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Automatic"}]}], "]"}]}], "}"}], 
      "]"}]}], "]"}], "//", "N"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BC4excluded", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<contours/Scalar/scalar-all-experiments.txt\>\""}], "}"}], "]"}], 
     ",", "\"\<Table\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sens", "=", 
   RowBox[{"SensitivityBlock", "[", 
    RowBox[{"NevMinVal", ",", "BrhToSSval", ",", "NpotDefault"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListLogLogPlot", "[", 
    RowBox[{
     RowBox[{"Cases", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"sens", ",", "BC4excluded"}], "}"}], ",", 
       RowBox[{"_", "?", "MatrixQ"}], ",", "All"}], "]"}], ",", 
     RowBox[{"Joined", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"True", ",", "True", ",", "True", ",", "True"}], "}"}]}], ",", 
     " ", 
     RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(m\), \(S\)]\) [GeV]\>\"", " ", ",", " ", 
        "\"\<\!\(\*SuperscriptBox[\(\[Theta]\), \(2\)]\)\>\""}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", " ", "23"}], "]"}]}], ",", 
     RowBox[{"PlotStyle", "->", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ConstantArray", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MatrixQ", "[", "sens", "]"}], ",", "1", ",", 
              RowBox[{"Length", "@", "sens"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Thick", ",", "Gray"}], "}"}], ",", "1"}], "]"}]}], 
         "}"}], ",", "1"}], "]"}]}], ",", 
     RowBox[{"Filling", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "sens", "]"}], "+", "1"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Top", ",", 
          RowBox[{"Directive", "[", 
           RowBox[{"Gray", ",", 
            RowBox[{"Opacity", "[", "0.3", "]"}]}], "]"}]}], "}"}]}], "}"}]}],
      ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1.01", 
           RowBox[{"mSminmaxOverall", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"1.1", 
           RowBox[{"mSminmaxOverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"0.3", "*", 
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"sens", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ",", 
          RowBox[{"0.99", 
           RowBox[{"\[Theta]2minmaxOverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{
          "\"\<\!\(\*SubscriptBox[\(N\), \(events\)]\) \[GreaterEqual] \>\"", 
           ",", "NevMinVal", ",", "\"\<, Br(h\[Rule]SS) = \>\"", ",", 
           "BrhToSSval"}], "}"}], "]"}], ",", "18", ",", "Black"}], "]"}]}], 
     ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"Placed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"#", ",", "15"}], "]"}], "&"}], "/@", 
         RowBox[{"{", "ExperimentFolder", "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"0.2", ",", "0.15"}], "}"}]}], "]"}]}]}], "]"}], ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{"Text", "[", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"\"\<Excluded\>\"", ",", "24", ",", "Black"}], "]"}], ",", 
       RowBox[{"Scaled", "[", 
        RowBox[{"{", 
         RowBox[{"0.2", ",", "0.9"}], "}"}], "]"}]}], "]"}], "}"}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8886404491464033`*^9, 3.8886404510930166`*^9}, {
   3.888640628876172*^9, 3.8886406463821764`*^9}, {3.8886406837495556`*^9, 
   3.8886406843144956`*^9}, {3.8886410684305754`*^9, 
   3.8886413056057186`*^9}, {3.888641471390818*^9, 3.8886415338395844`*^9}, {
   3.8896724053195105`*^9, 3.889672405439672*^9}, {3.8902858684120636`*^9, 
   3.8902858886879153`*^9}, {3.8910647994035606`*^9, 3.891064802710083*^9}, {
   3.8922863669128327`*^9, 3.8922863669228373`*^9}, {3.8925470759384756`*^9, 
   3.8925470764903564`*^9}, {3.892566669885436*^9, 3.8925666702753496`*^9}, {
   3.892910802053583*^9, 3.8929108020615845`*^9}, {3.893228691501322*^9, 
   3.893228691622405*^9}, {3.893572166996152*^9, 3.893572172347583*^9}, {
   3.894612840035421*^9, 3.8946128439239035`*^9}, {3.895054609165634*^9, 
   3.895054641711184*^9}, {3.895054739583967*^9, 3.89505473972333*^9}, {
   3.895054840823753*^9, 3.895054842946886*^9}, 3.895079856519951*^9, {
   3.895080408543869*^9, 3.895080408681652*^9}, {3.8956476597671003`*^9, 
   3.895647711784693*^9}, 3.8956480109510765`*^9, {3.89564815235528*^9, 
   3.895648153613762*^9}, {3.895648197346319*^9, 3.8956482206462717`*^9}, {
   3.8956490945070057`*^9, 3.895649110966339*^9}, {3.8956495001549854`*^9, 
   3.895649519825077*^9}, {3.895649753175002*^9, 3.8956497562363443`*^9}, {
   3.8961545900577*^9, 3.896154590772591*^9}, {3.896521614438037*^9, 
   3.896521616204466*^9}, {3.8965958972291527`*^9, 3.896595900321556*^9}, {
   3.8967083833693357`*^9, 3.8967083935808964`*^9}, {3.897492615765958*^9, 
   3.897492618552369*^9}, 3.89755259402772*^9, {3.906194745273999*^9, 
   3.9061947577645397`*^9}},
 CellTags->{
  "Sensitivity", 
   "Re-evaluation"},ExpressionUUID->"393530ae-64d6-4ec8-b59b-3746dc54333d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Deleting generated cells", "Title",
 CellChangeTimes->{{3.9025559465149946`*^9, 3.9025559494966087`*^9}},
 CellTags->{
  "Sensitivity", 
   "Re-evaluation"},ExpressionUUID->"203fe031-a989-4ae2-bab2-d9be6c6a10c7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"relaunch", "=", 
  RowBox[{"dropdownDialog", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\"\<Yes\>\"", ",", "\"\<No\>\""}], "}"}], ",", 
    RowBox[{"Row", "[", 
     RowBox[{
     "{", "\"\<Would you like to re-launch the sensitivity calculation for \
another experiment after the given computation?\>\"", "}"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"relaunch", "==", "\"\<Yes\>\""}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nb", "=", 
     RowBox[{"EvaluationNotebook", "[", "]"}]}], ";", "\n", 
    RowBox[{"NotebookFind", "[", 
     RowBox[{
     "nb", ",", "\"\<Re-evaluation\>\"", ",", "All", ",", "CellTags"}], "]"}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"relaunch", "==", "\"\<No\>\""}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"deletecellsopt", "=", 
     RowBox[{"dropdownDialog", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<Yes\>\"", ",", "\"\<No\>\""}], "}"}], ",", 
       RowBox[{"Row", "[", 
        RowBox[{
        "{", "\"\<Would you like to remove all the generated output \
cells?\>\"", "}"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"deletecellsopt", "==", "\"\<Yes\>\""}], ",", 
      RowBox[{
      "FrontEndTokenExecute", "[", "\"\<DeleteGeneratedCells\>\"", "]"}]}], 
     "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.9025559062888603`*^9, 3.9025559062888603`*^9}, {
   3.902555964086707*^9, 3.902555989355214*^9}, 3.902763734669232*^9, {
   3.9028879544685755`*^9, 3.9028879657921314`*^9}, 3.90397199508119*^9},
 CellTags->{"Sensitivity", "Re-evaluation"},
 CellLabel->
  "In[226]:=",ExpressionUUID->"6fde9864-29b5-4d88-a600-c5fcba685bf9"]
}, Open  ]]
},
WindowSize->{1027.5, 570.9},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
ShowCellTags->True,
Magnification:>0.8 Inherited,
FrontEndVersion->"13.2 for Microsoft Windows (64-bit) (November 18, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"1d04da36-d6b0-45f9-bfb2-de5e59e6aa12"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Number-of-events"->{
  Cell[5761, 157, 364, 6, 69, "Title",ExpressionUUID->"c7fbc496-1765-4913-bda1-eb19f9d14ec4",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[6150, 167, 279, 5, 66, "Chapter",ExpressionUUID->"97514d5d-099d-448e-a17b-84a2592457d1",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[6432, 174, 6753, 151, 419, "Input",ExpressionUUID->"a1657428-e7cb-44c0-bafb-5a2d37d2b79c",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[13222, 330, 216, 4, 66, "Chapter",ExpressionUUID->"8348c717-8fb9-4ff9-be33-c78045c51d6d",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[13463, 338, 231, 4, 66, "Section",ExpressionUUID->"cc2312ac-4e04-4612-9e6b-593fe31948b9",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[13719, 346, 217, 4, 54, "Subsection",ExpressionUUID->"346ee184-7723-44c1-b589-5bb27d0a63ef",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[13939, 352, 7859, 226, 632, "Input",ExpressionUUID->"fbde88eb-bc2d-4ac9-a0dd-e946ef2c3168",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[21835, 583, 211, 4, 54, "Subsection",ExpressionUUID->"a89a4f3a-558d-4ceb-b9ff-7c0da374ee49",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[22049, 589, 17790, 465, 1027, "Input",ExpressionUUID->"f36dd757-b278-4c42-b71d-5e3be5cf0c5c",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[39888, 1060, 336, 6, 66, "Section",ExpressionUUID->"156e6e8c-0ae4-4a31-8d56-64751523cf6c",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[40249, 1070, 340, 6, 54, "Subsection",ExpressionUUID->"318d803b-d3a7-4103-8363-93d1bb5e975d",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[40614, 1080, 339, 6, 47, "Subsubsection",ExpressionUUID->"3269a735-5538-4ab5-8576-41d62670317b",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[40956, 1088, 11268, 286, 691, "Input",ExpressionUUID->"bb154e48-5da4-4c5d-8396-58bfaff60823",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[52261, 1379, 511, 16, 47, "Subsubsection",ExpressionUUID->"692a653d-bf39-454a-9e4d-4777b8af9f82",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[52797, 1399, 251, 5, 36, "Item",ExpressionUUID->"b99fd440-5006-420b-9f87-f03108051217",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[53051, 1406, 2393, 63, 113, "Input",ExpressionUUID->"13d8020f-9e3c-410e-acb1-3fe31d3a0b2e",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[55481, 1474, 245, 5, 36, "Item",ExpressionUUID->"206f97cf-3e69-46f9-a968-ede524828d13",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[55729, 1481, 2135, 46, 82, "Input",ExpressionUUID->"bf0bd48d-3852-4b66-a42e-da6ee29cda7e",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[57901, 1532, 199, 4, 36, "Item",ExpressionUUID->"ae44c387-69ab-4380-9525-2ecd652eece3",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[58103, 1538, 1992, 44, 82, "Input",ExpressionUUID->"5a8fa276-17cc-4ed8-a75f-64da8b65dd6d",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[60132, 1587, 279, 5, 36, "Item",ExpressionUUID->"f3ca9641-f067-41b4-89aa-290e1d8fe457",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[60414, 1594, 1509, 36, 82, "Input",ExpressionUUID->"9b723e21-edd1-41ab-a08d-4034810a4f82",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[61984, 1637, 212, 4, 54, "Subsection",ExpressionUUID->"85fa5653-a042-4525-a914-bfefd11eaf67",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[62199, 1643, 5388, 131, 221, "Input",ExpressionUUID->"82d15d9f-173e-444e-897d-79df057d5549",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[67636, 1780, 384, 6, 66, "Section",ExpressionUUID->"990662f6-15c3-4f39-ae61-2c8fc1bd4b2e",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[68045, 1790, 284, 5, 54, "Subsection",ExpressionUUID->"3dd7b844-8e27-44cd-bb8b-37dac39065de",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[68332, 1797, 3293, 70, 133, "Input",ExpressionUUID->"df1f536d-e756-4790-b2f0-98d1a0089063",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[71686, 1874, 243, 6, 66, "Chapter",ExpressionUUID->"2068836a-be65-499b-87d8-817d26bdc7f3",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[71954, 1884, 230, 5, 66, "Section",ExpressionUUID->"9d0f2e70-ad2a-42a8-ac40-01538efcac90",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[72187, 1891, 7728, 185, 281, "Input",ExpressionUUID->"ee81d875-13fe-4cd5-807d-efd34a267332",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[79952, 2081, 255, 5, 66, "Section",ExpressionUUID->"c4fcee20-6a9c-4132-be0d-3e72cbd0356f",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[80210, 2088, 7551, 182, 281, "Input",ExpressionUUID->"495b47a0-a9b5-457b-9626-81bf5883ffbc",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[87822, 2277, 221, 4, 69, "Title",ExpressionUUID->"4849bc3c-f2c5-4bec-8c48-2c597d5d139d",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[88046, 2283, 7264, 180, 371, "Input",ExpressionUUID->"a9dc099a-58c7-4b4a-87b0-fae273cf5733",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[95335, 2467, 224, 4, 66, "Chapter",ExpressionUUID->"a74112cd-0181-43f7-98cb-cf9ca35460f9",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[95562, 2473, 1935, 48, 248, "Input",ExpressionUUID->"188a1091-0abe-4645-9955-08d60cc3dc98",
   CellTags->{"Number-of-events", "Acceptance"}]},
 "Acceptance"->{
  Cell[5761, 157, 364, 6, 69, "Title",ExpressionUUID->"c7fbc496-1765-4913-bda1-eb19f9d14ec4",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[6150, 167, 279, 5, 66, "Chapter",ExpressionUUID->"97514d5d-099d-448e-a17b-84a2592457d1",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[6432, 174, 6753, 151, 419, "Input",ExpressionUUID->"a1657428-e7cb-44c0-bafb-5a2d37d2b79c",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[13222, 330, 216, 4, 66, "Chapter",ExpressionUUID->"8348c717-8fb9-4ff9-be33-c78045c51d6d",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[13463, 338, 231, 4, 66, "Section",ExpressionUUID->"cc2312ac-4e04-4612-9e6b-593fe31948b9",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[13719, 346, 217, 4, 54, "Subsection",ExpressionUUID->"346ee184-7723-44c1-b589-5bb27d0a63ef",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[13939, 352, 7859, 226, 632, "Input",ExpressionUUID->"fbde88eb-bc2d-4ac9-a0dd-e946ef2c3168",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[21835, 583, 211, 4, 54, "Subsection",ExpressionUUID->"a89a4f3a-558d-4ceb-b9ff-7c0da374ee49",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[22049, 589, 17790, 465, 1027, "Input",ExpressionUUID->"f36dd757-b278-4c42-b71d-5e3be5cf0c5c",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[39888, 1060, 336, 6, 66, "Section",ExpressionUUID->"156e6e8c-0ae4-4a31-8d56-64751523cf6c",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[40249, 1070, 340, 6, 54, "Subsection",ExpressionUUID->"318d803b-d3a7-4103-8363-93d1bb5e975d",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[40614, 1080, 339, 6, 47, "Subsubsection",ExpressionUUID->"3269a735-5538-4ab5-8576-41d62670317b",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[40956, 1088, 11268, 286, 691, "Input",ExpressionUUID->"bb154e48-5da4-4c5d-8396-58bfaff60823",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[52261, 1379, 511, 16, 47, "Subsubsection",ExpressionUUID->"692a653d-bf39-454a-9e4d-4777b8af9f82",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[52797, 1399, 251, 5, 36, "Item",ExpressionUUID->"b99fd440-5006-420b-9f87-f03108051217",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[53051, 1406, 2393, 63, 113, "Input",ExpressionUUID->"13d8020f-9e3c-410e-acb1-3fe31d3a0b2e",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[55481, 1474, 245, 5, 36, "Item",ExpressionUUID->"206f97cf-3e69-46f9-a968-ede524828d13",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[55729, 1481, 2135, 46, 82, "Input",ExpressionUUID->"bf0bd48d-3852-4b66-a42e-da6ee29cda7e",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[57901, 1532, 199, 4, 36, "Item",ExpressionUUID->"ae44c387-69ab-4380-9525-2ecd652eece3",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[58103, 1538, 1992, 44, 82, "Input",ExpressionUUID->"5a8fa276-17cc-4ed8-a75f-64da8b65dd6d",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[60132, 1587, 279, 5, 36, "Item",ExpressionUUID->"f3ca9641-f067-41b4-89aa-290e1d8fe457",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[60414, 1594, 1509, 36, 82, "Input",ExpressionUUID->"9b723e21-edd1-41ab-a08d-4034810a4f82",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[61984, 1637, 212, 4, 54, "Subsection",ExpressionUUID->"85fa5653-a042-4525-a914-bfefd11eaf67",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[62199, 1643, 5388, 131, 221, "Input",ExpressionUUID->"82d15d9f-173e-444e-897d-79df057d5549",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[67636, 1780, 384, 6, 66, "Section",ExpressionUUID->"990662f6-15c3-4f39-ae61-2c8fc1bd4b2e",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[68045, 1790, 284, 5, 54, "Subsection",ExpressionUUID->"3dd7b844-8e27-44cd-bb8b-37dac39065de",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[68332, 1797, 3293, 70, 133, "Input",ExpressionUUID->"df1f536d-e756-4790-b2f0-98d1a0089063",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[71686, 1874, 243, 6, 66, "Chapter",ExpressionUUID->"2068836a-be65-499b-87d8-817d26bdc7f3",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[71954, 1884, 230, 5, 66, "Section",ExpressionUUID->"9d0f2e70-ad2a-42a8-ac40-01538efcac90",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[72187, 1891, 7728, 185, 281, "Input",ExpressionUUID->"ee81d875-13fe-4cd5-807d-efd34a267332",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[79952, 2081, 255, 5, 66, "Section",ExpressionUUID->"c4fcee20-6a9c-4132-be0d-3e72cbd0356f",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[80210, 2088, 7551, 182, 281, "Input",ExpressionUUID->"495b47a0-a9b5-457b-9626-81bf5883ffbc",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[87822, 2277, 221, 4, 69, "Title",ExpressionUUID->"4849bc3c-f2c5-4bec-8c48-2c597d5d139d",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[88046, 2283, 7264, 180, 371, "Input",ExpressionUUID->"a9dc099a-58c7-4b4a-87b0-fae273cf5733",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[95335, 2467, 224, 4, 66, "Chapter",ExpressionUUID->"a74112cd-0181-43f7-98cb-cf9ca35460f9",
   CellTags->{"Number-of-events", "Acceptance"}],
  Cell[95562, 2473, 1935, 48, 248, "Input",ExpressionUUID->"188a1091-0abe-4645-9955-08d60cc3dc98",
   CellTags->{"Number-of-events", "Acceptance"}]},
 "Number-of-events-computation"->{
  Cell[97546, 2527, 204, 4, 69, "Title",ExpressionUUID->"128d78c3-8bd2-4cc0-aade-f5ea999c5498",
   CellTags->"Number-of-events-computation"],
  Cell[97775, 2535, 377, 7, 66, "Chapter",ExpressionUUID->"cae25615-bc01-481f-b6ea-4be09eb8d2a0",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[98177, 2546, 249, 5, 66, "Section",ExpressionUUID->"5a2b7762-40d4-4411-b7b6-8f75b4fff483",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[98429, 2553, 20928, 545, 796, "Input",ExpressionUUID->"7b50f7c1-8794-4b1c-9865-2720540ddacb",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[119406, 3104, 527, 9, 66, "Chapter",ExpressionUUID->"775c9f90-cfc2-4104-a914-805ee6203cb5",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[119958, 3117, 398, 7, 66, "Section",ExpressionUUID->"156da2f8-c95e-4643-9f69-1214d81706da",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[120359, 3126, 4309, 102, 217, "Input",ExpressionUUID->"ec7c31f0-2c3d-491e-ad87-31a9562869f5",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[124705, 3233, 381, 7, 66, "Section",ExpressionUUID->"59663584-f04d-4861-9888-759394628663",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[125111, 3244, 248, 5, 54, "Subsection",ExpressionUUID->"e5eaebc3-b32f-410a-bd0f-d31d7689e52c",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[125362, 3251, 13231, 308, 557, "Input",ExpressionUUID->"76f4913e-254e-43a7-9a51-c2b0b48d43a8",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[138630, 3564, 457, 10, 54, "Subsection",ExpressionUUID->"e4c3cc8c-3bd7-4b50-8c99-3abaa32f3378",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[139112, 3578, 245, 5, 47, "Subsubsection",ExpressionUUID->"7f24cf1e-7678-4346-8ebd-675da6011508",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[139360, 3585, 16361, 389, 615, "Input",ExpressionUUID->"0500f499-02b1-452e-baee-ce09bd9cdbae",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[155758, 3979, 264, 5, 47, "Subsubsection",ExpressionUUID->"4509a151-6691-4920-ad03-10e67cdac0ed",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[156025, 3986, 6059, 154, 265, "Input",ExpressionUUID->"dd40248e-824b-4836-88cd-6a0df7372bf8",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[162157, 4148, 206, 4, 66, "Chapter",ExpressionUUID->"2d9780fa-5ba1-4c6e-a530-4a9fc49461e6",
   CellTags->"Number-of-events-computation"],
  Cell[162388, 4156, 233, 5, 66, "Section",ExpressionUUID->"a6bc5251-4158-4ee3-9df9-c1e86c762dea",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[162646, 4165, 291, 7, 54, "Subsection",ExpressionUUID->"03c068b3-d3a7-459f-8c1e-ec3d3e376262",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[162940, 4174, 7835, 202, 340, "Input",ExpressionUUID->"9e239ef8-b3f5-433f-b061-de53501dd105",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[171294, 4396, 276, 5, 54, "Subsection",ExpressionUUID->"9e11135a-cfd0-4132-86ba-54d8f1000608",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[171573, 4403, 10354, 263, 393, "Input",ExpressionUUID->"d53c9063-f042-4883-b156-b39b68e1926b",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[181964, 4671, 351, 8, 54, "Subsection",ExpressionUUID->"cba3bac0-0ffd-40dd-9cf4-91a7fb47b456",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[182340, 4683, 266, 5, 47, "Subsubsection",ExpressionUUID->"ce37e5bd-2e84-4698-ac4a-91cabbcfc5a1",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[182609, 4690, 6614, 164, 287, "Input",ExpressionUUID->"19a29f23-39cd-40bd-9967-ae06d9a417c4",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[189260, 4859, 320, 6, 47, "Subsubsection",ExpressionUUID->"da0c7b9b-89c0-463c-ac01-97600e7a30ba",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[189583, 4867, 6117, 144, 300, "Input",ExpressionUUID->"bdcbf344-384a-4ed7-97e2-d89957d2b071",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[195737, 5016, 267, 6, 47, "Subsubsection",ExpressionUUID->"000bc51d-351f-4076-866f-75cabfdef1e1",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[196007, 5024, 3630, 81, 247, "Input",ExpressionUUID->"3f1c5327-4ad9-45e7-8425-dab3a49925fe",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[199698, 5112, 333, 6, 66, "Section",ExpressionUUID->"4838b61a-27bf-4158-bec2-c9aa7466caed",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[200034, 5120, 15717, 401, 598, "Input",ExpressionUUID->"f33ce8f2-6b47-4b9c-90b0-a1f9d7830d52",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[215776, 5525, 272, 5, 54, "Subsection",ExpressionUUID->"db85dc12-ab27-49c3-9df5-ed5473b6f74b",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[216073, 5534, 237, 5, 47, "Subsubsection",ExpressionUUID->"048f95d8-648b-4c4f-934d-2ec725318fc0",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[216313, 5541, 6151, 154, 468, "Input",ExpressionUUID->"c0708df4-febd-4a1b-b0f1-77be69c738dd",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[222525, 5702, 206, 4, 66, "Section",ExpressionUUID->"52dc766a-fc2d-4e27-b20c-a2032825a0cb",
   CellTags->"Number-of-events-computation"],
  Cell[222756, 5710, 242, 5, 54, "Subsection",ExpressionUUID->"fd841a0f-44af-405f-899f-a884e0e2be9b",
   CellTags->"Number-of-events-computation"],
  Cell[223001, 5717, 4520, 110, 203, "Input",ExpressionUUID->"facfaf6c-5b2c-4970-9090-924ba89b8fd1",
   CellTags->"Number-of-events-computation"],
  Cell[227558, 5832, 342, 8, 54, "Subsection",ExpressionUUID->"7d6df444-00ef-4bb9-8404-36ef90d39d84",
   CellTags->"Number-of-events-computation"],
  Cell[227903, 5842, 5607, 144, 231, "Input",ExpressionUUID->"a31edd84-e884-4b6d-8e20-3f3ccc88322e",
   CellTags->"Number-of-events-computation"],
  Cell[233535, 5990, 202, 4, 47, "Subsubsection",ExpressionUUID->"9d74e0ef-3c74-473f-808f-090f08b0cc6f",
   CellTags->"Number-of-events-computation"],
  Cell[233740, 5996, 8910, 218, 282, "Input",ExpressionUUID->"456e176c-83e5-4b97-a68f-f8608e598b87",
   CellTags->"Number-of-events-computation"],
  Cell[242699, 6220, 220, 4, 53, "Subsection",ExpressionUUID->"f1d5b5a4-4a7a-4215-92e6-b433834a1702",
   CellTags->"Number-of-events-computation"],
  Cell[242922, 6226, 23081, 570, 932, "Input",ExpressionUUID->"527d8baf-1a2d-4dd5-9da1-2d533b666b85",
   CellTags->"Number-of-events-computation"],
  Cell[266076, 6804, 224, 4, 69, "Title",ExpressionUUID->"f5136f97-573d-41ec-bafe-cbcb903e581e",
   CellTags->"Number-of-events-computation"],
  Cell[266325, 6812, 201, 4, 66, "Chapter",ExpressionUUID->"75cf786b-3cae-4471-be7d-a8f2b6c6b657",
   CellTags->"Number-of-events-computation"],
  Cell[266529, 6818, 9730, 216, 432, "Input",ExpressionUUID->"7723a626-82c5-4cfa-9029-8486e71b92ea",
   CellTags->"Number-of-events-computation"],
  Cell[276296, 7039, 197, 4, 65, "Chapter",ExpressionUUID->"e9258198-581c-4466-81fa-c2dce211dd65",
   CellTags->"Number-of-events-computation"],
  Cell[276518, 7047, 209, 4, 64, "Section",ExpressionUUID->"d35060f3-1238-4e37-aaf7-587414385513",
   CellTags->"Number-of-events-computation"],
  Cell[276730, 7053, 3059, 70, 126, "Input",ExpressionUUID->"4373bb38-5ade-4168-a342-6cca5c2ca723",
   CellTags->"Number-of-events-computation"],
  Cell[279826, 7128, 311, 6, 64, "Section",ExpressionUUID->"ea35df86-1f74-459c-b50f-d9e15ebea561",
   CellTags->"Number-of-events-computation"],
  Cell[280140, 7136, 975, 17, 32, "Input",ExpressionUUID->"8a8a9ffb-2c26-4fa7-ab09-097069ace5ee",
   CellTags->"Number-of-events-computation"],
  Cell[281152, 7158, 261, 5, 64, "Section",ExpressionUUID->"8c40accd-0a6a-412a-b047-73e5a007e9c0",
   CellTags->"Number-of-events-computation"],
  Cell[281416, 7165, 918, 16, 32, "Input",ExpressionUUID->"251a96a0-7c49-47ab-9730-fff488f299a7",
   CellTags->"Number-of-events-computation"],
  Cell[282371, 7186, 409, 12, 64, "Section",ExpressionUUID->"5e1d1941-ec23-4b2c-9214-a8a714e4ebf1",
   CellTags->"Number-of-events-computation"],
  Cell[282783, 7200, 986, 17, 34, "Input",ExpressionUUID->"e9f8c662-0678-4db9-abde-7b46d97dbdd9",
   CellTags->"Number-of-events-computation"],
  Cell[283806, 7222, 311, 6, 64, "Section",ExpressionUUID->"ca48eaac-b3bc-4d9f-b92f-8df4efb016c7",
   CellTags->"Number-of-events-computation"],
  Cell[284120, 7230, 858, 15, 34, "Input",ExpressionUUID->"fe590329-9d73-4c45-8f2f-e9dd63752e16",
   CellTags->"Number-of-events-computation"],
  Cell[285015, 7250, 364, 6, 64, "Section",ExpressionUUID->"3e342d3f-9bfe-469b-ad5d-081929859f69",
   CellTags->"Number-of-events-computation"],
  Cell[285382, 7258, 906, 16, 32, "Input",ExpressionUUID->"7570cf2f-ddac-4312-a71e-fab82c49fc4f",
   CellTags->"Number-of-events-computation"]},
 "Acceptance-computation"->{
  Cell[97775, 2535, 377, 7, 66, "Chapter",ExpressionUUID->"cae25615-bc01-481f-b6ea-4be09eb8d2a0",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[98177, 2546, 249, 5, 66, "Section",ExpressionUUID->"5a2b7762-40d4-4411-b7b6-8f75b4fff483",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[98429, 2553, 20928, 545, 796, "Input",ExpressionUUID->"7b50f7c1-8794-4b1c-9865-2720540ddacb",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[119406, 3104, 527, 9, 66, "Chapter",ExpressionUUID->"775c9f90-cfc2-4104-a914-805ee6203cb5",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[119958, 3117, 398, 7, 66, "Section",ExpressionUUID->"156da2f8-c95e-4643-9f69-1214d81706da",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[120359, 3126, 4309, 102, 217, "Input",ExpressionUUID->"ec7c31f0-2c3d-491e-ad87-31a9562869f5",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[124705, 3233, 381, 7, 66, "Section",ExpressionUUID->"59663584-f04d-4861-9888-759394628663",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[125111, 3244, 248, 5, 54, "Subsection",ExpressionUUID->"e5eaebc3-b32f-410a-bd0f-d31d7689e52c",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[125362, 3251, 13231, 308, 557, "Input",ExpressionUUID->"76f4913e-254e-43a7-9a51-c2b0b48d43a8",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[138630, 3564, 457, 10, 54, "Subsection",ExpressionUUID->"e4c3cc8c-3bd7-4b50-8c99-3abaa32f3378",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[139112, 3578, 245, 5, 47, "Subsubsection",ExpressionUUID->"7f24cf1e-7678-4346-8ebd-675da6011508",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[139360, 3585, 16361, 389, 615, "Input",ExpressionUUID->"0500f499-02b1-452e-baee-ce09bd9cdbae",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[155758, 3979, 264, 5, 47, "Subsubsection",ExpressionUUID->"4509a151-6691-4920-ad03-10e67cdac0ed",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[156025, 3986, 6059, 154, 265, "Input",ExpressionUUID->"dd40248e-824b-4836-88cd-6a0df7372bf8",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[162388, 4156, 233, 5, 66, "Section",ExpressionUUID->"a6bc5251-4158-4ee3-9df9-c1e86c762dea",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[162646, 4165, 291, 7, 54, "Subsection",ExpressionUUID->"03c068b3-d3a7-459f-8c1e-ec3d3e376262",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[162940, 4174, 7835, 202, 340, "Input",ExpressionUUID->"9e239ef8-b3f5-433f-b061-de53501dd105",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[171294, 4396, 276, 5, 54, "Subsection",ExpressionUUID->"9e11135a-cfd0-4132-86ba-54d8f1000608",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[171573, 4403, 10354, 263, 393, "Input",ExpressionUUID->"d53c9063-f042-4883-b156-b39b68e1926b",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[181964, 4671, 351, 8, 54, "Subsection",ExpressionUUID->"cba3bac0-0ffd-40dd-9cf4-91a7fb47b456",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[182340, 4683, 266, 5, 47, "Subsubsection",ExpressionUUID->"ce37e5bd-2e84-4698-ac4a-91cabbcfc5a1",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[182609, 4690, 6614, 164, 287, "Input",ExpressionUUID->"19a29f23-39cd-40bd-9967-ae06d9a417c4",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[189260, 4859, 320, 6, 47, "Subsubsection",ExpressionUUID->"da0c7b9b-89c0-463c-ac01-97600e7a30ba",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[189583, 4867, 6117, 144, 300, "Input",ExpressionUUID->"bdcbf344-384a-4ed7-97e2-d89957d2b071",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[195737, 5016, 267, 6, 47, "Subsubsection",ExpressionUUID->"000bc51d-351f-4076-866f-75cabfdef1e1",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[196007, 5024, 3630, 81, 247, "Input",ExpressionUUID->"3f1c5327-4ad9-45e7-8425-dab3a49925fe",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[199698, 5112, 333, 6, 66, "Section",ExpressionUUID->"4838b61a-27bf-4158-bec2-c9aa7466caed",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[200034, 5120, 15717, 401, 598, "Input",ExpressionUUID->"f33ce8f2-6b47-4b9c-90b0-a1f9d7830d52",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[215776, 5525, 272, 5, 54, "Subsection",ExpressionUUID->"db85dc12-ab27-49c3-9df5-ed5473b6f74b",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[216073, 5534, 237, 5, 47, "Subsubsection",ExpressionUUID->"048f95d8-648b-4c4f-934d-2ec725318fc0",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[216313, 5541, 6151, 154, 468, "Input",ExpressionUUID->"c0708df4-febd-4a1b-b0f1-77be69c738dd",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}]},
 "Sensitivity"->{
  Cell[286349, 7281, 212, 4, 69, "Title",ExpressionUUID->"2ce189e8-ece2-4e74-afba-65f86fa4e6b1",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[286586, 7289, 227, 4, 66, "Chapter",ExpressionUUID->"07b3dd6c-5bc5-4374-ad95-caec94e93ed0",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[286816, 7295, 20392, 560, 862, "Input",ExpressionUUID->"01ff1478-030e-432f-be11-c30e96d2eaaa",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[307233, 7859, 229, 4, 66, "Section",ExpressionUUID->"774c689c-d8e1-4948-b114-3e9e9146e0d5",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[307465, 7865, 6015, 152, 208, "Input",ExpressionUUID->"fae948ac-5c53-425d-8842-e6b4ca896596",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[313529, 8023, 215, 4, 66, "Chapter",ExpressionUUID->"0d834004-01d7-412b-b48e-402cf64fc469",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[313747, 8029, 12916, 320, 544, "Input",ExpressionUUID->"393530ae-64d6-4ec8-b59b-3746dc54333d",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[326712, 8355, 218, 4, 89, "Title",ExpressionUUID->"203fe031-a989-4ae2-bab2-d9be6c6a10c7",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[326933, 8361, 2580, 65, 187, "Input",ExpressionUUID->"6fde9864-29b5-4d88-a600-c5fcba685bf9",
   CellTags->{"Sensitivity", "Re-evaluation"}]},
 "Re-evaluation"->{
  Cell[286349, 7281, 212, 4, 69, "Title",ExpressionUUID->"2ce189e8-ece2-4e74-afba-65f86fa4e6b1",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[286586, 7289, 227, 4, 66, "Chapter",ExpressionUUID->"07b3dd6c-5bc5-4374-ad95-caec94e93ed0",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[286816, 7295, 20392, 560, 862, "Input",ExpressionUUID->"01ff1478-030e-432f-be11-c30e96d2eaaa",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[307233, 7859, 229, 4, 66, "Section",ExpressionUUID->"774c689c-d8e1-4948-b114-3e9e9146e0d5",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[307465, 7865, 6015, 152, 208, "Input",ExpressionUUID->"fae948ac-5c53-425d-8842-e6b4ca896596",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[313529, 8023, 215, 4, 66, "Chapter",ExpressionUUID->"0d834004-01d7-412b-b48e-402cf64fc469",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[313747, 8029, 12916, 320, 544, "Input",ExpressionUUID->"393530ae-64d6-4ec8-b59b-3746dc54333d",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[326712, 8355, 218, 4, 89, "Title",ExpressionUUID->"203fe031-a989-4ae2-bab2-d9be6c6a10c7",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[326933, 8361, 2580, 65, 187, "Input",ExpressionUUID->"6fde9864-29b5-4d88-a600-c5fcba685bf9",
   CellTags->{"Sensitivity", "Re-evaluation"}]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Number-of-events", 329942, 8442},
 {"Acceptance", 335310, 8515},
 {"Number-of-events-computation", 340696, 8588},
 {"Acceptance-computation", 350102, 8705},
 {"Sensitivity", 355564, 8768},
 {"Re-evaluation", 356913, 8787}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 207, 3, 78, "Title",ExpressionUUID->"81e378d2-3dbb-467e-88a3-3d73d3bd8f3c"],
Cell[790, 27, 4934, 125, 329, "Input",ExpressionUUID->"b0400bb0-bd38-4283-9a8f-ce5e9e655d1b"]
}, Closed]],
Cell[CellGroupData[{
Cell[5761, 157, 364, 6, 69, "Title",ExpressionUUID->"c7fbc496-1765-4913-bda1-eb19f9d14ec4",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[CellGroupData[{
Cell[6150, 167, 279, 5, 66, "Chapter",ExpressionUUID->"97514d5d-099d-448e-a17b-84a2592457d1",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[6432, 174, 6753, 151, 419, "Input",ExpressionUUID->"a1657428-e7cb-44c0-bafb-5a2d37d2b79c",
 CellTags->{"Number-of-events", "Acceptance"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[13222, 330, 216, 4, 66, "Chapter",ExpressionUUID->"8348c717-8fb9-4ff9-be33-c78045c51d6d",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[CellGroupData[{
Cell[13463, 338, 231, 4, 66, "Section",ExpressionUUID->"cc2312ac-4e04-4612-9e6b-593fe31948b9",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[CellGroupData[{
Cell[13719, 346, 217, 4, 54, "Subsection",ExpressionUUID->"346ee184-7723-44c1-b589-5bb27d0a63ef",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[13939, 352, 7859, 226, 632, "Input",ExpressionUUID->"fbde88eb-bc2d-4ac9-a0dd-e946ef2c3168",
 CellTags->{"Number-of-events", "Acceptance"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[21835, 583, 211, 4, 54, "Subsection",ExpressionUUID->"a89a4f3a-558d-4ceb-b9ff-7c0da374ee49",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[22049, 589, 17790, 465, 1027, "Input",ExpressionUUID->"f36dd757-b278-4c42-b71d-5e3be5cf0c5c",
 CellTags->{"Number-of-events", "Acceptance"}]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[39888, 1060, 336, 6, 66, "Section",ExpressionUUID->"156e6e8c-0ae4-4a31-8d56-64751523cf6c",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[CellGroupData[{
Cell[40249, 1070, 340, 6, 54, "Subsection",ExpressionUUID->"318d803b-d3a7-4103-8363-93d1bb5e975d",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[CellGroupData[{
Cell[40614, 1080, 339, 6, 47, "Subsubsection",ExpressionUUID->"3269a735-5538-4ab5-8576-41d62670317b",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[40956, 1088, 11268, 286, 691, "Input",ExpressionUUID->"bb154e48-5da4-4c5d-8396-58bfaff60823",
 CellTags->{"Number-of-events", "Acceptance"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[52261, 1379, 511, 16, 47, "Subsubsection",ExpressionUUID->"692a653d-bf39-454a-9e4d-4777b8af9f82",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[CellGroupData[{
Cell[52797, 1399, 251, 5, 36, "Item",ExpressionUUID->"b99fd440-5006-420b-9f87-f03108051217",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[53051, 1406, 2393, 63, 113, "Input",ExpressionUUID->"13d8020f-9e3c-410e-acb1-3fe31d3a0b2e",
 CellTags->{"Number-of-events", "Acceptance"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[55481, 1474, 245, 5, 36, "Item",ExpressionUUID->"206f97cf-3e69-46f9-a968-ede524828d13",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[55729, 1481, 2135, 46, 82, "Input",ExpressionUUID->"bf0bd48d-3852-4b66-a42e-da6ee29cda7e",
 CellTags->{"Number-of-events", "Acceptance"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[57901, 1532, 199, 4, 36, "Item",ExpressionUUID->"ae44c387-69ab-4380-9525-2ecd652eece3",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[58103, 1538, 1992, 44, 82, "Input",ExpressionUUID->"5a8fa276-17cc-4ed8-a75f-64da8b65dd6d",
 CellTags->{"Number-of-events", "Acceptance"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[60132, 1587, 279, 5, 36, "Item",ExpressionUUID->"f3ca9641-f067-41b4-89aa-290e1d8fe457",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[60414, 1594, 1509, 36, 82, "Input",ExpressionUUID->"9b723e21-edd1-41ab-a08d-4034810a4f82",
 CellTags->{"Number-of-events", "Acceptance"}]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[61984, 1637, 212, 4, 54, "Subsection",ExpressionUUID->"85fa5653-a042-4525-a914-bfefd11eaf67",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[62199, 1643, 5388, 131, 221, "Input",ExpressionUUID->"82d15d9f-173e-444e-897d-79df057d5549",
 CellTags->{"Number-of-events", "Acceptance"}]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[67636, 1780, 384, 6, 66, "Section",ExpressionUUID->"990662f6-15c3-4f39-ae61-2c8fc1bd4b2e",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[CellGroupData[{
Cell[68045, 1790, 284, 5, 54, "Subsection",ExpressionUUID->"3dd7b844-8e27-44cd-bb8b-37dac39065de",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[68332, 1797, 3293, 70, 133, "Input",ExpressionUUID->"df1f536d-e756-4790-b2f0-98d1a0089063",
 CellTags->{"Number-of-events", "Acceptance"}]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[71686, 1874, 243, 6, 66, "Chapter",ExpressionUUID->"2068836a-be65-499b-87d8-817d26bdc7f3",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[CellGroupData[{
Cell[71954, 1884, 230, 5, 66, "Section",ExpressionUUID->"9d0f2e70-ad2a-42a8-ac40-01538efcac90",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[72187, 1891, 7728, 185, 281, "Input",ExpressionUUID->"ee81d875-13fe-4cd5-807d-efd34a267332",
 CellTags->{"Number-of-events", "Acceptance"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[79952, 2081, 255, 5, 66, "Section",ExpressionUUID->"c4fcee20-6a9c-4132-be0d-3e72cbd0356f",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[80210, 2088, 7551, 182, 281, "Input",ExpressionUUID->"495b47a0-a9b5-457b-9626-81bf5883ffbc",
 CellTags->{"Number-of-events", "Acceptance"}]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[87822, 2277, 221, 4, 69, "Title",ExpressionUUID->"4849bc3c-f2c5-4bec-8c48-2c597d5d139d",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[88046, 2283, 7264, 180, 371, "Input",ExpressionUUID->"a9dc099a-58c7-4b4a-87b0-fae273cf5733",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[CellGroupData[{
Cell[95335, 2467, 224, 4, 66, "Chapter",ExpressionUUID->"a74112cd-0181-43f7-98cb-cf9ca35460f9",
 CellTags->{"Number-of-events", "Acceptance"}],
Cell[95562, 2473, 1935, 48, 248, "Input",ExpressionUUID->"188a1091-0abe-4645-9955-08d60cc3dc98",
 CellTags->{"Number-of-events", "Acceptance"}]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[97546, 2527, 204, 4, 69, "Title",ExpressionUUID->"128d78c3-8bd2-4cc0-aade-f5ea999c5498",
 CellTags->"Number-of-events-computation"],
Cell[CellGroupData[{
Cell[97775, 2535, 377, 7, 66, "Chapter",ExpressionUUID->"cae25615-bc01-481f-b6ea-4be09eb8d2a0",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[98177, 2546, 249, 5, 66, "Section",ExpressionUUID->"5a2b7762-40d4-4411-b7b6-8f75b4fff483",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[98429, 2553, 20928, 545, 796, "Input",ExpressionUUID->"7b50f7c1-8794-4b1c-9865-2720540ddacb",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[119406, 3104, 527, 9, 66, "Chapter",ExpressionUUID->"775c9f90-cfc2-4104-a914-805ee6203cb5",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[119958, 3117, 398, 7, 66, "Section",ExpressionUUID->"156da2f8-c95e-4643-9f69-1214d81706da",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[120359, 3126, 4309, 102, 217, "Input",ExpressionUUID->"ec7c31f0-2c3d-491e-ad87-31a9562869f5",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[124705, 3233, 381, 7, 66, "Section",ExpressionUUID->"59663584-f04d-4861-9888-759394628663",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[125111, 3244, 248, 5, 54, "Subsection",ExpressionUUID->"e5eaebc3-b32f-410a-bd0f-d31d7689e52c",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[125362, 3251, 13231, 308, 557, "Input",ExpressionUUID->"76f4913e-254e-43a7-9a51-c2b0b48d43a8",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[138630, 3564, 457, 10, 54, "Subsection",ExpressionUUID->"e4c3cc8c-3bd7-4b50-8c99-3abaa32f3378",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[139112, 3578, 245, 5, 47, "Subsubsection",ExpressionUUID->"7f24cf1e-7678-4346-8ebd-675da6011508",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[139360, 3585, 16361, 389, 615, "Input",ExpressionUUID->"0500f499-02b1-452e-baee-ce09bd9cdbae",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[155758, 3979, 264, 5, 47, "Subsubsection",ExpressionUUID->"4509a151-6691-4920-ad03-10e67cdac0ed",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[156025, 3986, 6059, 154, 265, "Input",ExpressionUUID->"dd40248e-824b-4836-88cd-6a0df7372bf8",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[162157, 4148, 206, 4, 66, "Chapter",ExpressionUUID->"2d9780fa-5ba1-4c6e-a530-4a9fc49461e6",
 CellTags->"Number-of-events-computation"],
Cell[CellGroupData[{
Cell[162388, 4156, 233, 5, 66, "Section",ExpressionUUID->"a6bc5251-4158-4ee3-9df9-c1e86c762dea",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[162646, 4165, 291, 7, 54, "Subsection",ExpressionUUID->"03c068b3-d3a7-459f-8c1e-ec3d3e376262",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[162940, 4174, 7835, 202, 340, "Input",ExpressionUUID->"9e239ef8-b3f5-433f-b061-de53501dd105",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[170778, 4378, 479, 13, 22, "Input",ExpressionUUID->"38476b7b-e95d-4f4f-947e-9630b4cde7ef"]
}, Open  ]],
Cell[CellGroupData[{
Cell[171294, 4396, 276, 5, 54, "Subsection",ExpressionUUID->"9e11135a-cfd0-4132-86ba-54d8f1000608",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[171573, 4403, 10354, 263, 393, "Input",ExpressionUUID->"d53c9063-f042-4883-b156-b39b68e1926b",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[181964, 4671, 351, 8, 54, "Subsection",ExpressionUUID->"cba3bac0-0ffd-40dd-9cf4-91a7fb47b456",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[182340, 4683, 266, 5, 47, "Subsubsection",ExpressionUUID->"ce37e5bd-2e84-4698-ac4a-91cabbcfc5a1",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[182609, 4690, 6614, 164, 287, "Input",ExpressionUUID->"19a29f23-39cd-40bd-9967-ae06d9a417c4",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[189260, 4859, 320, 6, 47, "Subsubsection",ExpressionUUID->"da0c7b9b-89c0-463c-ac01-97600e7a30ba",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[189583, 4867, 6117, 144, 300, "Input",ExpressionUUID->"bdcbf344-384a-4ed7-97e2-d89957d2b071",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[195737, 5016, 267, 6, 47, "Subsubsection",ExpressionUUID->"000bc51d-351f-4076-866f-75cabfdef1e1",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[196007, 5024, 3630, 81, 247, "Input",ExpressionUUID->"3f1c5327-4ad9-45e7-8425-dab3a49925fe",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[199698, 5112, 333, 6, 66, "Section",ExpressionUUID->"4838b61a-27bf-4158-bec2-c9aa7466caed",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[200034, 5120, 15717, 401, 598, "Input",ExpressionUUID->"f33ce8f2-6b47-4b9c-90b0-a1f9d7830d52",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[215776, 5525, 272, 5, 54, "Subsection",ExpressionUUID->"db85dc12-ab27-49c3-9df5-ed5473b6f74b",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[216073, 5534, 237, 5, 47, "Subsubsection",ExpressionUUID->"048f95d8-648b-4c4f-934d-2ec725318fc0",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[216313, 5541, 6151, 154, 468, "Input",ExpressionUUID->"c0708df4-febd-4a1b-b0f1-77be69c738dd",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[222525, 5702, 206, 4, 66, "Section",ExpressionUUID->"52dc766a-fc2d-4e27-b20c-a2032825a0cb",
 CellTags->"Number-of-events-computation"],
Cell[CellGroupData[{
Cell[222756, 5710, 242, 5, 54, "Subsection",ExpressionUUID->"fd841a0f-44af-405f-899f-a884e0e2be9b",
 CellTags->"Number-of-events-computation"],
Cell[223001, 5717, 4520, 110, 203, "Input",ExpressionUUID->"facfaf6c-5b2c-4970-9090-924ba89b8fd1",
 CellTags->"Number-of-events-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[227558, 5832, 342, 8, 54, "Subsection",ExpressionUUID->"7d6df444-00ef-4bb9-8404-36ef90d39d84",
 CellTags->"Number-of-events-computation"],
Cell[227903, 5842, 5607, 144, 231, "Input",ExpressionUUID->"a31edd84-e884-4b6d-8e20-3f3ccc88322e",
 CellTags->"Number-of-events-computation"],
Cell[CellGroupData[{
Cell[233535, 5990, 202, 4, 47, "Subsubsection",ExpressionUUID->"9d74e0ef-3c74-473f-808f-090f08b0cc6f",
 CellTags->"Number-of-events-computation"],
Cell[233740, 5996, 8910, 218, 282, "Input",ExpressionUUID->"456e176c-83e5-4b97-a68f-f8608e598b87",
 CellTags->"Number-of-events-computation"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[242699, 6220, 220, 4, 53, "Subsection",ExpressionUUID->"f1d5b5a4-4a7a-4215-92e6-b433834a1702",
 CellTags->"Number-of-events-computation"],
Cell[242922, 6226, 23081, 570, 932, "Input",ExpressionUUID->"527d8baf-1a2d-4dd5-9da1-2d533b666b85",
 CellTags->"Number-of-events-computation"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[266076, 6804, 224, 4, 69, "Title",ExpressionUUID->"f5136f97-573d-41ec-bafe-cbcb903e581e",
 CellTags->"Number-of-events-computation"],
Cell[CellGroupData[{
Cell[266325, 6812, 201, 4, 66, "Chapter",ExpressionUUID->"75cf786b-3cae-4471-be7d-a8f2b6c6b657",
 CellTags->"Number-of-events-computation"],
Cell[266529, 6818, 9730, 216, 432, "Input",ExpressionUUID->"7723a626-82c5-4cfa-9029-8486e71b92ea",
 CellTags->"Number-of-events-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[276296, 7039, 197, 4, 65, "Chapter",ExpressionUUID->"e9258198-581c-4466-81fa-c2dce211dd65",
 CellTags->"Number-of-events-computation"],
Cell[CellGroupData[{
Cell[276518, 7047, 209, 4, 64, "Section",ExpressionUUID->"d35060f3-1238-4e37-aaf7-587414385513",
 CellTags->"Number-of-events-computation"],
Cell[276730, 7053, 3059, 70, 126, "Input",ExpressionUUID->"4373bb38-5ade-4168-a342-6cca5c2ca723",
 CellTags->"Number-of-events-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[279826, 7128, 311, 6, 64, "Section",ExpressionUUID->"ea35df86-1f74-459c-b50f-d9e15ebea561",
 CellTags->"Number-of-events-computation"],
Cell[280140, 7136, 975, 17, 32, "Input",ExpressionUUID->"8a8a9ffb-2c26-4fa7-ab09-097069ace5ee",
 CellTags->"Number-of-events-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[281152, 7158, 261, 5, 64, "Section",ExpressionUUID->"8c40accd-0a6a-412a-b047-73e5a007e9c0",
 CellTags->"Number-of-events-computation"],
Cell[281416, 7165, 918, 16, 32, "Input",ExpressionUUID->"251a96a0-7c49-47ab-9730-fff488f299a7",
 CellTags->"Number-of-events-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[282371, 7186, 409, 12, 64, "Section",ExpressionUUID->"5e1d1941-ec23-4b2c-9214-a8a714e4ebf1",
 CellTags->"Number-of-events-computation"],
Cell[282783, 7200, 986, 17, 34, "Input",ExpressionUUID->"e9f8c662-0678-4db9-abde-7b46d97dbdd9",
 CellTags->"Number-of-events-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[283806, 7222, 311, 6, 64, "Section",ExpressionUUID->"ca48eaac-b3bc-4d9f-b92f-8df4efb016c7",
 CellTags->"Number-of-events-computation"],
Cell[284120, 7230, 858, 15, 34, "Input",ExpressionUUID->"fe590329-9d73-4c45-8f2f-e9dd63752e16",
 CellTags->"Number-of-events-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[285015, 7250, 364, 6, 64, "Section",ExpressionUUID->"3e342d3f-9bfe-469b-ad5d-081929859f69",
 CellTags->"Number-of-events-computation"],
Cell[285382, 7258, 906, 16, 32, "Input",ExpressionUUID->"7570cf2f-ddac-4312-a71e-fab82c49fc4f",
 CellTags->"Number-of-events-computation"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[286349, 7281, 212, 4, 69, "Title",ExpressionUUID->"2ce189e8-ece2-4e74-afba-65f86fa4e6b1",
 CellTags->{"Sensitivity", "Re-evaluation"}],
Cell[CellGroupData[{
Cell[286586, 7289, 227, 4, 66, "Chapter",ExpressionUUID->"07b3dd6c-5bc5-4374-ad95-caec94e93ed0",
 CellTags->{"Sensitivity", "Re-evaluation"}],
Cell[286816, 7295, 20392, 560, 862, "Input",ExpressionUUID->"01ff1478-030e-432f-be11-c30e96d2eaaa",
 CellTags->{"Sensitivity", "Re-evaluation"}],
Cell[CellGroupData[{
Cell[307233, 7859, 229, 4, 66, "Section",ExpressionUUID->"774c689c-d8e1-4948-b114-3e9e9146e0d5",
 CellTags->{"Sensitivity", "Re-evaluation"}],
Cell[307465, 7865, 6015, 152, 208, "Input",ExpressionUUID->"fae948ac-5c53-425d-8842-e6b4ca896596",
 CellTags->{"Sensitivity", "Re-evaluation"}]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[313529, 8023, 215, 4, 66, "Chapter",ExpressionUUID->"0d834004-01d7-412b-b48e-402cf64fc469",
 CellTags->{"Sensitivity", "Re-evaluation"}],
Cell[313747, 8029, 12916, 320, 544, "Input",ExpressionUUID->"393530ae-64d6-4ec8-b59b-3746dc54333d",
 CellTags->{"Sensitivity", "Re-evaluation"}]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[326712, 8355, 218, 4, 89, "Title",ExpressionUUID->"203fe031-a989-4ae2-bab2-d9be6c6a10c7",
 CellTags->{"Sensitivity", "Re-evaluation"}],
Cell[326933, 8361, 2580, 65, 187, "Input",ExpressionUUID->"6fde9864-29b5-4d88-a600-c5fcba685bf9",
 CellTags->{"Sensitivity", "Re-evaluation"}]
}, Open  ]]
}
]
*)

