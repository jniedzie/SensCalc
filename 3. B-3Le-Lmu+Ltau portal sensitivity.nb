(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    345245,       8454]
NotebookOptionsPosition[    309732,       7887]
NotebookOutlinePosition[    330193,       8169]
CellTagsIndexPosition[    329954,       8160]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Just launch the code below to run the notebook (shift+enter)", "Title",
 CellChangeTimes->{{3.8934376452895875`*^9, 
  3.8934376644509068`*^9}},ExpressionUUID->"f98d21ab-2805-4064-81d3-\
17ebb7a0a0ef"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BlockEvaluation", "[", "tag_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nb", "=", 
      RowBox[{"EvaluationNotebook", "[", "]"}]}], ";", "\n", 
     RowBox[{"NotebookFind", "[", 
      RowBox[{"nb", ",", "tag", ",", "All", ",", "CellTags"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"infoDialog", "[", "phrase_", "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<Proceed\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DirectoryQ", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<Auxiliary data\>\""}], "}"}], "]"}], "]"}], "//", 
       "ToString"}], ")"}], "\[Equal]", "\"\<False\>\""}], ",", 
    RowBox[{"CreateDirectory", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<Auxiliary data\>\""}], "}"}], "]"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DirectoryQ", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<Auxiliary data/B-3Le-Lmu+Ltau\>\""}], "}"}], "]"}], "]"}], "//",
        "ToString"}], ")"}], "\[Equal]", "\"\<False\>\""}], ",", 
    RowBox[{"CreateDirectory", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<Auxiliary data/B-3Le-Lmu+Ltau\>\""}], "}"}], "]"}], "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"choiceslist", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<Acceptance\>\"", ",", "\"\<Tabulated number of events\>\"", ",", 
     "\"\<Sensitivity\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"taglist", "[", "\"\<Acceptance\>\"", "]"}], "=", 
   "\"\<Acceptance\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"taglist", "[", "\"\<Tabulated number of events\>\"", "]"}], "=", 
   "\"\<Number-of-events\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"taglist", "[", "\"\<Sensitivity\>\"", "]"}], "=", 
   "\"\<Sensitivity\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"computationchoice", "=", 
   RowBox[{"dropdownDialog", "[", 
    RowBox[{
    "choiceslist", ",", 
     "\"\<Do you want to compute the tabulated number of events and then \
sensitivity, or just sensitivity (if the tabulated number of events has been \
already produced)?\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"tagselected", "=", 
  RowBox[{"taglist", "[", "computationchoice", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"BlockEvaluation", "[", "tagselected", "]"}]}], "Input",
 CellChangeTimes->{{3.893437585709897*^9, 3.8934375895369635`*^9}, {
   3.8934376329497385`*^9, 3.893437658846809*^9}, 3.893573113541499*^9, {
   3.89366535580302*^9, 3.8936653565596275`*^9}, {3.8950533245899706`*^9, 
   3.895053324798867*^9}, 3.895053859186413*^9, {3.8951270448753014`*^9, 
   3.895127055134303*^9}, {3.8951339328705807`*^9, 3.8951339334559956`*^9}, {
   3.8963341494565334`*^9, 3.896334158007512*^9}, 3.9025627617424593`*^9, 
   3.9027295110424414`*^9, {3.903892151349045*^9, 
   3.903892170840095*^9}},ExpressionUUID->"f63b9531-20f4-416c-88e5-\
4505a63d238e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Definitions", "Title",
 CellChangeTimes->{{3.8765025649423122`*^9, 3.876502598054132*^9}, {
  3.876502741347786*^9, 3.876502742695223*^9}, {3.876503237989088*^9, 
  3.876503241621973*^9}},
 CellTags->
  "Number-of-events",ExpressionUUID->"eeccabcd-0c15-4514-9558-c56b32930132"],

Cell[CellGroupData[{

Cell["Parameters", "Chapter",
 CellChangeTimes->{{3.8765032665997076`*^9, 3.876503268324252*^9}, 
   3.8867405532570024`*^9},
 CellTags->
  "Number-of-events",ExpressionUUID->"b0daed8d-c809-4422-9ee4-6612c9305a11"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"infoDialog", "[", "phrase_", "]"}], ":=", 
   RowBox[{"DialogInput", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
     RowBox[{"Column", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
        RowBox[{"Button", "[", 
         RowBox[{"\"\<Proceed\>\"", ",", 
          RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
      "]"}]}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"pp", " ", "cross"}], "-", 
    RowBox[{
    "section", " ", "in", " ", "mb", " ", "in", " ", "terms", " ", "of", " ", 
     "invariant", " ", "mass", " ", "s"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Z", "=", "35.45"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", "=", "0.308"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Y1", "=", "42.53"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Y2", "=", "33.34"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s0", "=", 
   SuperscriptBox["5.38", "2"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Eta]1", "=", "0.458"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Eta]2", "=", "0.545"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MP", "=", "0.938"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S", "[", 
    RowBox[{"Pp_", ",", "mp_"}], "]"}], "=", 
   RowBox[{"2", "*", "Pp", "*", "mp"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sigmapp", "[", "s_", "]"}], "=", 
   RowBox[{"Z", "+", 
    RowBox[{"B", "*", 
     SuperscriptBox[
      RowBox[{"Log", "[", 
       RowBox[{"s", "/", "s0"}], "]"}], "2"]}], "+", 
    RowBox[{"Y1", "*", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"s1", "/", "s"}], ")"}], "\[Eta]1"]}], "-", 
    RowBox[{"Y2", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"s1", "/", "s"}], ")"}], "\[Eta]2"]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]pNucleonInpb", "[", "Atarget_", "]"}], "=", 
   RowBox[{"51", "*", 
    SuperscriptBox["Atarget", 
     RowBox[{"-", "0.29"}]], "*", 
    SuperscriptBox["10", "9"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]ppLHC", "=", 
    RowBox[{"72", "*", 
     SuperscriptBox["10", "9"]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Invariant", " ", "mass", " ", "of", " ", "two", " ", "protons", " ", "in",
     " ", "lab", " ", "frame", " ", "of", " ", "one", " ", "proton"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SPP", "[", "Eplab_", "]"}], "=", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"Eplab", "+", "1"}], ")"}], "2"], "-", 
    SuperscriptBox["Eplab", "2"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S", "[", 
    RowBox[{"Pp_", ",", "mp_"}], "]"}], "=", 
   RowBox[{"2", "*", "Pp", "*", "mp"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Sprime", "[", 
     RowBox[{"mp_", ",", "Pp_", ",", "PV_"}], "]"}], "=", 
    RowBox[{"2", "*", "mp", "*", 
     RowBox[{"(", 
      RowBox[{"Pp", "-", "PV"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Conversion", " ", "units"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GeVMinusOneTom", "=", 
   RowBox[{"2", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "16"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"chbarval", "=", 
    RowBox[{"3", "*", 
     SuperscriptBox["10", "8"], "*", "6.58", "*", 
     SuperscriptBox["10", 
      RowBox[{"-", "25"}]]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"EM", " ", "coupling"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Alpha]EM", "=", 
    RowBox[{"1", "/", "137"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Mesons", " ", "masses"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m\[Rho]0", "=", "0.775"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m\[Pi]0", "=", "0.135"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m\[Eta]", "=", "0.547"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m\[Eta]pr", "=", "0.958"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8765034442681623`*^9, 3.876503447941355*^9}, {
  3.8765056818454757`*^9, 3.876505692008336*^9}, {3.886740560903683*^9, 
  3.886740593214046*^9}, {3.8867409496067395`*^9, 3.8867409590034056`*^9}, {
  3.886741579426521*^9, 3.8867415813945484`*^9}, {3.8867443210389347`*^9, 
  3.8867444446667986`*^9}, {3.8867444939210668`*^9, 3.8867445002484865`*^9}, {
  3.8867446034829063`*^9, 3.886744614182158*^9}, {3.8867446619399247`*^9, 
  3.8867446661114883`*^9}, {3.886759107154976*^9, 3.8867591125856485`*^9}, {
  3.88675933269215*^9, 3.8867593536685715`*^9}, {3.886759730890151*^9, 
  3.8867597309616537`*^9}, {3.8867612812222157`*^9, 3.8867613066588397`*^9}, {
  3.8902876705002975`*^9, 3.890287670628288*^9}, {3.8934965789994254`*^9, 
  3.8934966825801153`*^9}, {3.893497171424407*^9, 3.8934971952092705`*^9}, {
  3.8937474086028423`*^9, 3.893747409855379*^9}, {3.8951339459121637`*^9, 
  3.895133946508248*^9}},
 CellTags->"Number-of-events",
 CellLabel->"In[12]:=",ExpressionUUID->"50979767-da80-48f9-b503-a276bde193fb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["B-L phenomenology", "Chapter",
 CellChangeTimes->{{3.876502665052594*^9, 3.8765026657521577`*^9}, 
   3.8765032389371314`*^9, 3.8867405737216787`*^9, {3.886821364395908*^9, 
   3.886821366824774*^9}, {3.894102946582965*^9, 3.8941029471834335`*^9}},
 CellTags->
  "Number-of-events",ExpressionUUID->"059f5520-6181-4a09-92d4-f731378eccca"],

Cell[CellGroupData[{

Cell["Decays", "Section",
 CellChangeTimes->{{3.877584114519929*^9, 3.877584115297123*^9}},
 CellTags->
  "Number-of-events",ExpressionUUID->"25c60688-e782-46f3-9845-f0ddefe385dd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Decay", " ", "width", " ", "in", " ", "GeV"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalGamma]BL", "[", 
      RowBox[{"mV_", ",", "\[Alpha]B_"}], "]"}], "=", 
     RowBox[{"\[Alpha]B", "*", 
      RowBox[{"10", "^", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Log10", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
               RowBox[{"Log10", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
            RowBox[{"Import", "[", 
             RowBox[{
              RowBox[{"FileNameJoin", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"NotebookDirectory", "[", "]"}], ",", 
                 "\"\<phenomenology/B-3Le-Lmu+Ltau/decay \
widths/GammaTotBL.txt\>\""}], "}"}], "]"}], ",", "\"\<Table\>\""}], "]"}]}], 
           ",", 
           RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
         RowBox[{"Log10", "[", "mV", "]"}], "]"}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"LogLogPlot", "[", 
    RowBox[{
     RowBox[{"\[CapitalGamma]BL", "[", 
      RowBox[{"mV", ",", "1"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"mV", ",", "0.05", ",", "5"}], "}"}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Decay", " ", "length"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"c\[Tau]BL", "[", 
      RowBox[{"mV_", ",", "\[Alpha]B_"}], "]"}], "=", 
     FractionBox["chbarval", 
      RowBox[{"\[CapitalGamma]BL", "[", 
       RowBox[{"mV", ",", "\[Alpha]B"}], "]"}]]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ldecayBL", "[", 
      RowBox[{"mV_", ",", "\[Alpha]B_", ",", "EV_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"c\[Tau]BL", "[", 
       RowBox[{"mV", ",", "\[Alpha]B"}], "]"}], "*", 
      FractionBox[
       SqrtBox[
        RowBox[{
         SuperscriptBox["EV", "2"], "-", 
         SuperscriptBox["mV", "2"]}]], "mV"]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BrRatiosBLtable", "=", 
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", 
          "\"\<phenomenology/B-3Le-Lmu+Ltau/decay widths/BrRatiosBL.m\>\""}], 
         "}"}], "]"}], ",", "\"\<MX\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"BrRatiosBLtable", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BrRatioBL", "[", 
      RowBox[{"mV_", ",", "i_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Interpolation", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Drop", "[", 
          RowBox[{"BrRatiosBLtable", ",", "1"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "i"}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "mV", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BrRatioBLtoee", "[", "mV_", "]"}], "=", 
     RowBox[{"BrRatioBL", "[", 
      RowBox[{"mV", ",", "3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BrRatioBLto\[Mu]\[Mu]", "[", "mV_", "]"}], "=", 
     RowBox[{"BrRatioBL", "[", 
      RowBox[{"mV", ",", "4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BrRatioBLto\[Tau]\[Tau]", "[", "mV_", "]"}], "=", 
     RowBox[{"BrRatioBL", "[", 
      RowBox[{"mV", ",", "5"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BrRatioBLto\[Pi]0\[Gamma]", "[", "mV_", "]"}], "=", 
     RowBox[{"BrRatioBL", "[", 
      RowBox[{"mV", ",", "6"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BrRatioBLto3\[Pi]", "[", "mV_", "]"}], "=", 
     RowBox[{"BrRatioBL", "[", 
      RowBox[{"mV", ",", "7"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BrRatioBLtoKK", "[", "mV_", "]"}], "=", 
     RowBox[{"BrRatioBL", "[", 
      RowBox[{"mV", ",", "8"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BrRatioBLtoJets", "[", "mV_", "]"}], "=", 
     RowBox[{"BrRatioBL", "[", 
      RowBox[{"mV", ",", "9"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BrVisChargedAndNeutral", "[", "mV_", "]"}], "=", 
     RowBox[{
      RowBox[{"BrRatioBLtoee", "[", "mV", "]"}], "+", 
      RowBox[{"BrRatioBLto\[Mu]\[Mu]", "[", "mV", "]"}], "+", 
      RowBox[{"BrRatioBLto\[Tau]\[Tau]", "[", "mV", "]"}], "+", 
      RowBox[{"BrRatioBLto\[Pi]0\[Gamma]", "[", "mV", "]"}], "+", 
      RowBox[{"BrRatioBLto3\[Pi]", "[", "mV", "]"}], "+", 
      RowBox[{"BrRatioBLtoKK", "[", "mV", "]"}], "+", 
      RowBox[{"BrRatioBLtoJets", "[", "mV", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BrVisChargedOnly", "[", "mV_", "]"}], "=", 
     RowBox[{
      RowBox[{"BrRatioBLtoee", "[", "mV", "]"}], "+", 
      RowBox[{"BrRatioBLto\[Mu]\[Mu]", "[", "mV", "]"}], "+", 
      RowBox[{"BrRatioBLto\[Tau]\[Tau]", "[", "mV", "]"}], "+", 
      RowBox[{"BrRatioBLto3\[Pi]", "[", "mV", "]"}], "+", 
      RowBox[{"BrRatioBLtoKK", "[", "mV", "]"}], "+", 
      RowBox[{"BrRatioBLtoJets", "[", "mV", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BrVisible", "[", 
     RowBox[{"mV_", ",", "ECALoption_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Association", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"mV", ",", "\"\<True\>\""}], "}"}], "->", 
         RowBox[{"BrVisChargedAndNeutral", "[", "mV", "]"}]}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"mV", ",", "\"\<False\>\""}], "}"}], "->", 
         RowBox[{"BrVisChargedOnly", "[", "mV", "]"}]}]}], "}"}], "]"}], "[", 
     RowBox[{"{", 
      RowBox[{"mV", ",", "ECALoption"}], "}"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"LogLogPlot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"BrVisChargedAndNeutral", "[", "mV", "]"}], ",", 
        RowBox[{"BrVisChargedOnly", "[", "mV", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"mV", ",", "0.02", ",", "5"}], "}"}], ",", 
      RowBox[{"PlotRange", "->", "All"}], ",", 
      RowBox[{"Frame", "->", "True"}], ",", 
      RowBox[{"ImageSize", "->", "Large"}]}], "]"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.8765027030040936`*^9, 3.876502712230002*^9}, {
   3.8765056490712585`*^9, 3.8765056684143023`*^9}, {3.8775935816940823`*^9, 
   3.877593651036413*^9}, {3.8775936851602736`*^9, 3.877593693594926*^9}, {
   3.8867405804606123`*^9, 3.886740855468573*^9}, {3.886740927115221*^9, 
   3.8867410004506335`*^9}, {3.8867589177998257`*^9, 3.886758933299265*^9}, 
   3.8868371903483343`*^9, {3.892180950096738*^9, 3.892180969099872*^9}, {
   3.8928884714154296`*^9, 3.892888477362914*^9}, {3.8941029549632397`*^9, 
   3.8941030011128693`*^9}, {3.8941030479873776`*^9, 3.894103049192934*^9}, {
   3.8941031460770063`*^9, 3.8941031973329277`*^9}, {3.8941032282630696`*^9, 
   3.894103359199234*^9}, {3.894118486351783*^9, 3.894118488703549*^9}, {
   3.896328658811122*^9, 3.8963286704470444`*^9}, 3.896328927885854*^9},
 CellTags->"Number-of-events",
 CellLabel->"In[37]:=",ExpressionUUID->"7f5d8f66-2da9-4671-940a-c53ba14987fb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Production probabilities", "Section",
 CellChangeTimes->{{3.877584122615653*^9, 3.8775841289684377`*^9}, {
  3.886741240873562*^9, 3.886741242690644*^9}, {3.8868213989059453`*^9, 
  3.8868214008628902`*^9}},
 CellTags->
  "Number-of-events",ExpressionUUID->"758fdb70-8fc0-4950-9280-a0db48e98f7d"],

Cell[CellGroupData[{

Cell["Bremsstrahlung", "Subsection",
 CellChangeTimes->{{3.8867412669050264`*^9, 3.8867412688103676`*^9}},
 CellTags->
  "Number-of-events",ExpressionUUID->"7a963466-3bc9-4e72-90f4-e32dd6169f27"],

Cell[CellGroupData[{

Cell["Proton form-factor in timelike region ", "Subsubsection",
 CellChangeTimes->{{3.886741274972128*^9, 3.8867412800960164`*^9}, {
  3.886759221990326*^9, 3.8867592476574197`*^9}},
 CellTags->
  "Number-of-events",ExpressionUUID->"c956b9b9-02cf-4bba-b3b1-70f5c90d674b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"The", " ", "form"}], "-", 
      RowBox[{
      "factor", " ", "is", " ", "derived", " ", "assuming", " ", "the", " ", 
       "mixing", " ", "of", " ", "BLs", " ", "with", " ", "3", " ", "\[Rho]", 
       " ", "and", " ", "3", " ", "\[Omega]", " ", "resonances"}]}], ",", 
     RowBox[{
      RowBox[{
      "with", " ", "the", " ", "6", " ", "couplings", " ", "fixed", " ", 
       "from", " ", "experiment", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"lowest", " ", "\[Rho]"}], ",", 
         RowBox[{"\[Omega]", " ", "resonances"}]}], ")"}]}], " ", "+", 
      RowBox[{"boundary", " ", "conditions"}]}]}], ")"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Masses", " ", "and", " ", "other", " ", "parameters"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"f\[Omega]BL", "=", "1.011"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f\[Rho]BL", "=", "0.616"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"M\[Omega]780", ",", "M\[Omega]1420", ",", "M\[Omega]1650"}], 
      "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"0.78", ",", "1.42", ",", "1.65"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Gamma\[Omega]780", ",", "Gamma\[Omega]1420", ",", 
       "Gamma\[Omega]1650"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"0.0084", ",", "0.29", ",", "0.315"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Qel", "=", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"2", "/", "3"}], ",", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"1", "/", "3"}], ")"}]}], ",", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"1", "/", "3"}], ")"}]}]}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"T\[Omega]", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "2"}], ")"}], 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "0"}], "}"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"T\[Phi]", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"\[Sqrt]", "2"}], ")"}]}], ")"}], 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f\[Omega]N", "=", "17.2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"g\[Omega]", "=", 
     RowBox[{"17.1", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", "3"}], ")"}], 
          RowBox[{"Tr", "[", "T\[Omega]", "]"}]}], ")"}], "/", 
        RowBox[{"Tr", "[", 
         RowBox[{"Qel", ".", "T\[Omega]"}], "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"G\[Omega]", "=", 
     RowBox[{"4", 
      RowBox[{"(", 
       RowBox[{"f\[Omega]N", "/", "g\[Omega]"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FVectorMeson", "[", 
      RowBox[{"q2_", ",", "mV_", ",", "\[CapitalGamma]V_"}], "]"}], "=", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["mV", "2"], "/", 
        RowBox[{"(", 
         RowBox[{"q2", "-", 
          SuperscriptBox["mV", "2"], "+", 
          RowBox[{"I", "*", "\[CapitalGamma]V", "*", "mV"}]}], ")"}]}], 
       ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FormFactorBremBL3\[Omega]Temp", "[", 
     RowBox[{
     "q2_", ",", "m\[Omega]780_", ",", "m\[Omega]1420_", ",", 
      "m\[Omega]1650_", ",", "\[CapitalGamma]\[Omega]780_", ",", 
      "\[CapitalGamma]\[Omega]1420_", ",", "\[CapitalGamma]\[Omega]1650_"}], 
     "]"}], "=", 
    RowBox[{
     RowBox[{"G\[Omega]", "*", 
      RowBox[{"FVectorMeson", "[", 
       RowBox[{"q2", ",", "m\[Omega]780", ",", "\[CapitalGamma]\[Omega]780"}],
        "]"}]}], "+", 
     RowBox[{"G\[Omega]1420", "*", 
      RowBox[{"FVectorMeson", "[", 
       RowBox[{
       "q2", ",", "m\[Omega]1420", ",", "\[CapitalGamma]\[Omega]1420"}], 
       "]"}]}], "+", 
     RowBox[{"G\[Omega]1650", "*", 
      RowBox[{"FVectorMeson", "[", 
       RowBox[{
       "q2", ",", "m\[Omega]1650", ",", "\[CapitalGamma]\[Omega]1650"}], 
       "]"}]}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EquationsBL3\[Omega]", "[", 
     RowBox[{"m\[Omega]780_", ",", "m\[Omega]1420_", ",", "m\[Omega]1650_"}], 
     "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Limit", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"FormFactorBremBL3\[Omega]Temp", "[", 
            RowBox[{
             RowBox[{"-", "q2"}], ",", "m\[Omega]780", ",", "m\[Omega]1420", 
             ",", "m\[Omega]1650", ",", "Gamma\[Omega]780", ",", 
             "Gamma\[Omega]1420", ",", "Gamma\[Omega]1650"}], "]"}], "q2"}], 
          ",", 
          RowBox[{"q2", "\[Rule]", "Infinity"}]}], "]"}], ")"}], "\[Equal]", 
       "0"}], "&&", 
      RowBox[{
       RowBox[{"FormFactorBremBL3\[Omega]Temp", "[", 
        RowBox[{
        "0", ",", "m\[Omega]780", ",", "m\[Omega]1420", ",", "m\[Omega]1650", 
         ",", "Gamma\[Omega]780", ",", "Gamma\[Omega]1420", ",", 
         "Gamma\[Omega]1650"}], "]"}], "\[Equal]", "1"}]}], "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"solFormBL3\[Omega]", "=", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"EquationsBL3\[Omega]", "[", 
        RowBox[{"M\[Omega]780", ",", "M\[Omega]1420", ",", "M\[Omega]1650"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"G\[Omega]1420", ",", "G\[Omega]1650"}], "}"}]}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FormFactorBremBL", "[", "q_", "]"}], "=", 
     RowBox[{"Abs", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"FormFactorBremBL3\[Omega]Temp", "[", 
         RowBox[{
          SuperscriptBox["q", "2"], ",", "M\[Omega]780", ",", "M\[Omega]1420",
           ",", "M\[Omega]1650", ",", "Gamma\[Omega]780", ",", 
          "Gamma\[Omega]1420", ",", "Gamma\[Omega]1650"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{"G\[Omega]1420", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"G\[Omega]1420", "/.", "solFormBL3\[Omega]"}], ")"}]}], 
         "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"G\[Omega]1650", "\[Rule]", 
         RowBox[{"(", 
          RowBox[{"G\[Omega]1650", "/.", "solFormBL3\[Omega]"}], ")"}]}], 
        "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"LogPlot", "[", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"FormFactorBremBL", "[", "mV", "]"}], "2"], ",", 
     RowBox[{"{", 
      RowBox[{"mV", ",", "0.0", ",", "5"}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.822472937377986*^9, 3.822472958787899*^9}, {
   3.822473164264882*^9, 3.8224732169513645`*^9}, {3.8224732650870314`*^9, 
   3.82247340649076*^9}, {3.8224739149924173`*^9, 3.8224739215133142`*^9}, {
   3.8224739584042616`*^9, 3.8224739701273427`*^9}, 3.822474249386196*^9, {
   3.822474485929841*^9, 3.822474542582522*^9}, {3.8224748380407495`*^9, 
   3.8224748464105816`*^9}, {3.8765031553789*^9, 3.8765031570765734`*^9}, {
   3.8867410352643704`*^9, 3.886741035534209*^9}, {3.8867410760390997`*^9, 
   3.8867410783231735`*^9}, {3.886741117233474*^9, 3.886741208713107*^9}, {
   3.886759249554492*^9, 3.8867592836208363`*^9}, {3.88675937342173*^9, 
   3.8867594003906803`*^9}, {3.886759559571762*^9, 3.8867596483855095`*^9}, {
   3.894103048007128*^9, 3.8941030480980215`*^9}, {3.894103532068018*^9, 
   3.894103556143052*^9}, {3.8941036819022293`*^9, 3.8941037438129063`*^9}},
 CellTags->"Number-of-events",
 CellLabel->"In[54]:=",ExpressionUUID->"4edbb780-206f-46e2-a0d6-f6e3f1acde51"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bremsstrahlung probability", "Subsubsection",
 CellChangeTimes->{{3.886741352659154*^9, 3.8867413608643293`*^9}},
 CellTags->
  "Number-of-events",ExpressionUUID->"c4747bba-72ee-43ee-8fc9-5627f0d94a94"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Double", " ", "differential", " ", "cross"}], "-", 
     RowBox[{"section", " ", 
      FractionBox[
       RowBox[{
        SuperscriptBox["d", "2"], 
        SubscriptBox["\[Sigma]", "brem"]}], 
       RowBox[{
        SubscriptBox["dp", "T"], "dz"}]]}]}], ",", " ", 
    RowBox[{
     RowBox[{"where", " ", 
      SubscriptBox["p", "T"], " ", "is", " ", "the", " ", 
      RowBox[{"BL", "'"}], "s", " ", "transverse", " ", "momentum", " ", 
      "and", " ", "z"}], " ", "=", " ", 
     RowBox[{
      SubscriptBox["E", "BL"], "/", 
      SubscriptBox["p", "beam"]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"H1", "[", 
      RowBox[{"z_", ",", "pT_", ",", "mp_", ",", "mV_"}], "]"}], "=", 
     RowBox[{
      SuperscriptBox["pT", "2"], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "z"}], ")"}], "*", 
       SuperscriptBox["mV", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["z", "2"], "*", 
       SuperscriptBox["mp", "2"]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"d2NdpTdz", "[", 
      RowBox[{
      "mp_", ",", "z_", ",", "pT_", ",", "Pp_", ",", "mV_", ",", 
       "\[Alpha]B_"}], "]"}], "=", 
     RowBox[{
      FractionBox[
       RowBox[{"2", "*", "pT", "*", "\[Alpha]B"}], 
       RowBox[{"2", "*", "Pi", "*", 
        RowBox[{"H1", "[", 
         RowBox[{"z", ",", "pT", ",", "mp", ",", "mV"}], "]"}]}]], "*", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "-", "z"}], ")"}], "2"]}], ")"}], "z"], "-", 
        RowBox[{"2", "*", "z", "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", "z"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "*", 
               SuperscriptBox["mp", "2"]}], "+", 
              SuperscriptBox["mV", "2"]}], ")"}], 
            RowBox[{"H1", "[", 
             RowBox[{"z", ",", "pT", ",", "mp", ",", "mV"}], "]"}]], "-", 
           FractionBox[
            RowBox[{
             SuperscriptBox["z", "2"], "*", "2", "*", 
             SuperscriptBox["mp", "4"]}], 
            SuperscriptBox[
             RowBox[{"H1", "[", 
              RowBox[{"z", ",", "pT", ",", "mp", ",", "mV"}], "]"}], "2"]]}], 
          ")"}]}], "+", 
        FractionBox[
         RowBox[{"2", "*", "z", "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", "z"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"z", "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "-", "z"}], ")"}], "2"]}], ")"}], "*", 
          SuperscriptBox["mp", "2"], "*", 
          SuperscriptBox["mV", "2"]}], 
         SuperscriptBox[
          RowBox[{"H1", "[", 
           RowBox[{"z", ",", "pT", ",", "mp", ",", "mV"}], "]"}], "2"]], "+", 
        FractionBox[
         RowBox[{"2", "*", "z", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "z"}], ")"}], "2"], 
          SuperscriptBox["mV", "4"]}], 
         SuperscriptBox[
          RowBox[{"H1", "[", 
           RowBox[{"z", ",", "pT", ",", "mp", ",", "mV"}], "]"}], "2"]]}], 
       ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     SubscriptBox["p", "T"], ",", 
     RowBox[{"z", " ", "\[Rule]", " ", 
      SubscriptBox["\[Theta]", "V"]}], ",", 
     SubscriptBox["E", "V"]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pTv", "[", 
      RowBox[{"EV_", ",", "\[Theta]_"}], "]"}], "=", 
     RowBox[{"EV", "*", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"zvp", "[", 
      RowBox[{"EV_", ",", "pBeam_"}], "]"}], "=", 
     FractionBox["EV", "pBeam"]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"JacobianpTzToEV\[Theta]", "[", 
      RowBox[{"EV_", ",", "pBeam_", ",", "\[Theta]_"}], "]"}], "=", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"pTv", "[", 
            RowBox[{"EV", ",", "\[Theta]"}], "]"}], ",", "EV"}], "]"}], "*", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"zvp", "[", 
            RowBox[{"EV", ",", "pBeam"}], "]"}], ",", "\[Theta]"}], "]"}]}], 
        "-", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"pTv", "[", 
            RowBox[{"EV", ",", "\[Theta]"}], "]"}], ",", "\[Theta]"}], "]"}], 
         "*", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"zvp", "[", 
            RowBox[{"EV", ",", "pBeam"}], "]"}], ",", "EV"}], "]"}]}]}], 
       ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Limitations", " ", "of", " ", "applicability", " ", "of", " ", "the", 
     " ", "approximation", " ", "used", " ", "to", " ", "derive", " ", "the", 
     " ", "bremsstrahlung", " ", "probability"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pTmaxBrem", "=", 
     RowBox[{
      RowBox[{"DialogInput", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"cut", "=", "\"\<\>\""}], "}"}], ",", 
        RowBox[{"Column", "[", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Enter the maximal \!\(\*SubscriptBox[\(p\), \(T\)]\) of B-L \
mediator (in GeV) for bremsstrahlung. Typical value is 1 GeV\>\"", ",", 
           RowBox[{"InputField", "[", 
            RowBox[{
             RowBox[{"Dynamic", "[", "cut", "]"}], ",", "Number"}], "]"}], 
           ",", 
           RowBox[{"Button", "[", 
            RowBox[{"\"\<Proceed\>\"", ",", 
             RowBox[{"DialogReturn", "[", "cut", "]"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "Automatic"}]}], "]"}]}], "}"}], 
         "]"}]}], "]"}], "//", "N"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Ppfacility", "[", "\"\<SPS\>\"", "]"}], ",", 
       RowBox[{"Ppfacility", "[", "\"\<LHC\>\"", "]"}], ",", 
       RowBox[{"Ppfacility", "[", "\"\<FCC-hh\>\"", "]"}], ",", 
       RowBox[{"Ppfacility", "[", "\"\<FermilabBD\>\"", "]"}]}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"400.", ",", "7000.", ",", "50000.", ",", "120."}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"zMinBrem", "[", "\"\<FermilabBD\>\"", "]"}], ",", 
       RowBox[{"zMinBrem", "[", "\"\<SPS\>\"", "]"}], ",", 
       RowBox[{"zMinBrem", "[", "\"\<LHC\>\"", "]"}], ",", 
       RowBox[{"zMinBrem", "[", "\"\<FCC-hh\>\"", "]"}]}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"0.1", ",", "0.1", ",", "0.005", ",", "0.0001"}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"zMaxBrem", "=", "0.9"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ApplicabilityParameter", "[", 
      RowBox[{"z_", ",", "pT_", ",", "mV_", ",", "Pp_", ",", "mX_"}], "]"}], 
     "=", 
     FractionBox[
      RowBox[{
       RowBox[{
        SuperscriptBox["mV", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"z", "-", "1"}], ")"}]}], ")"}]}], "+", 
       SuperscriptBox["pT", "2"], "+", 
       RowBox[{
        SuperscriptBox["mX", "2"], " ", 
        SuperscriptBox["z", "2"]}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"z", "-", "1"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["mV", "2"], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["Pp", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"z", "-", "1"}], ")"}], " ", "z"}]}], ")"}]}]]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DistrBrem\[Theta]EBLnoFormFactorTemp", "[", 
      RowBox[{
      "mV_", ",", "\[Theta]V_", ",", "EV_", ",", "pBeam_", ",", "zmin_"}], 
      "]"}], "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"JacobianpTzToEV\[Theta]", "[", 
        RowBox[{"EV", ",", "pBeam", ",", "\[Theta]V"}], "]"}], "*", 
       RowBox[{"d2NdpTdz", "[", 
        RowBox[{"MP", ",", 
         RowBox[{"zvp", "[", 
          RowBox[{"EV", ",", "pBeam"}], "]"}], ",", 
         RowBox[{"pTv", "[", 
          RowBox[{"EV", ",", "\[Theta]V"}], "]"}], ",", "pBeam", ",", "mV", 
         ",", "1"}], "]"}], 
       RowBox[{"(*", 
        RowBox[{"*", 
         RowBox[{"UnitStep", "[", 
          RowBox[{"0.1", "-", 
           RowBox[{"ApplicabilityParameter", "[", 
            RowBox[{
             RowBox[{"zvp", "[", 
              RowBox[{"EV", ",", "pBeam"}], "]"}], ",", 
             RowBox[{"pTv", "[", 
              RowBox[{"EV", ",", "\[Theta]V"}], "]"}], ",", "mV", ",", 
             "pBeam", ",", "MP"}], "]"}]}], "]"}]}], "*)"}], "*", 
       RowBox[{"UnitStep", "[", 
        RowBox[{"EV", "-", 
         RowBox[{"zmin", "*", "pBeam"}]}], "]"}], "*", 
       RowBox[{"UnitStep", "[", 
        RowBox[{"pTmaxBrem", "-", 
         RowBox[{"pTv", "[", 
          RowBox[{"EV", ",", "\[Theta]V"}], "]"}]}], "]"}]}], ")"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mVminFromBrem", ",", "mVmaxFromBrem"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"0.02", ",", "4"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"EVmaxBremBeam", "[", 
      RowBox[{"Facility_", ",", "\[Theta]V_"}], "]"}], ":=", 
     RowBox[{"Min", "[", 
      RowBox[{
       RowBox[{"zMaxBrem", "*", 
        RowBox[{"Ppfacility", "[", "Facility", "]"}]}], ",", 
       FractionBox["pTmaxBrem", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"pTv", "[", 
           RowBox[{"1", ",", "\[Theta]V"}], "]"}], "]"}], "+", 
         SuperscriptBox["10", 
          RowBox[{"-", "7"}]]}]]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]maxBremTemp", "[", "Facility_", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Theta]V", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"zMinBrem", "[", "Facility", "]"}], "*", 
             RowBox[{"Ppfacility", "[", "Facility", "]"}]}], "\[Equal]", 
            FractionBox["pTmaxBrem", 
             RowBox[{"Sin", "[", "\[Theta]V", "]"}]]}], ",", "\[Theta]V"}], 
          "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         TemplateBox[{"1"},
          "C"], "\[Rule]", "0"}], "}"}]}], ")"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Theta]maxBremFacility", "[", "\"\<FermilabBD\>\"", "]"}], 
       ",", 
       RowBox[{"\[Theta]maxBremFacility", "[", "\"\<SPS\>\"", "]"}], ",", 
       RowBox[{"\[Theta]maxBremFacility", "[", "\"\<LHC\>\"", "]"}], ",", 
       RowBox[{"\[Theta]maxBremFacility", "[", "\"\<FCC-hh\>\"", "]"}]}], 
      "}"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Theta]maxBremTemp", "[", "#", "]"}], "&"}], "/@", 
      RowBox[{"{", 
       RowBox[{
       "\"\<FermilabBD\>\"", ",", "\"\<SPS\>\"", ",", "\"\<LHC\>\"", ",", 
        "\"\<FCC-hh\>\""}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NormalizationBremNoFormFactorTemp", "[", "Facility_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"zmin", ",", "EVmaxfrombrem", ",", "pbeam"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pbeam", "=", 
        RowBox[{"Ppfacility", "[", "Facility", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"zmin", "=", 
        RowBox[{"zMinBrem", "[", "Facility", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"EVmaxfrombrem", "[", "\[Theta]V_", "]"}], "=", 
        RowBox[{"EVmaxBremBeam", "[", 
         RowBox[{"Facility", ",", "\[Theta]V"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Theta]maxbrem", "=", 
        RowBox[{"\[Theta]maxBremFacility", "[", "Facility", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"mV", ",", 
              RowBox[{"NIntegrate", "[", 
               RowBox[{
                RowBox[{"DistrBrem\[Theta]EBLnoFormFactorTemp", "[", 
                 RowBox[{
                 "mV", ",", "\[Theta]V", ",", "EV", ",", "pbeam", ",", 
                  "zmin"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"\[Theta]V", ",", "0", ",", "\[Theta]maxbrem"}], 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"EV", ",", 
                  RowBox[{"zmin", "*", "pbeam"}], ",", 
                  RowBox[{"Max", "[", 
                   RowBox[{
                    RowBox[{"zmin", "*", "pbeam"}], ",", 
                    RowBox[{"EVmaxfrombrem", "[", "\[Theta]V", "]"}]}], 
                   "]"}]}], "}"}], ",", 
                RowBox[{"Method", "\[Rule]", "\"\<AdaptiveMonteCarlo\>\""}]}],
                "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"mV", ",", "mVminFromBrem", ",", "mVmaxFromBrem", ",", 
              FractionBox[
               RowBox[{"(", 
                RowBox[{"mVmaxFromBrem", "-", "mVminFromBrem"}], ")"}], 
               "20"]}], "}"}]}], "]"}], ",", 
          RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "mV", 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"NormalizationBremNoFormFactor", "[", 
         RowBox[{"mV_", ",", "Facility"}], "]"}], "=", 
        RowBox[{"NormalizationBremNoFormFactorTemp", "[", "Facility", "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DoubleDistrBLfromBremFacility", "[", 
         RowBox[{"mV_", ",", "\[Theta]V_", ",", "EV_", ",", "Facility"}], 
         "]"}], "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
          "mVminFromBrem", "\[LessEqual]", "mV", "\[LessEqual]", 
           "mVmaxFromBrem"}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            FractionBox["1", 
             RowBox[{"NormalizationBremNoFormFactor", "[", 
              RowBox[{"mV", ",", "Facility"}], "]"}]], "*", 
            RowBox[{"DistrBrem\[Theta]EBLnoFormFactorTemp", "[", 
             RowBox[{"mV", ",", "\[Theta]V", ",", "EV", ",", 
              RowBox[{"Ppfacility", "[", "Facility", "]"}], ",", 
              RowBox[{"zMinBrem", "[", "Facility", "]"}]}], "]"}]}], "]"}], 
          ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"PbremFacility", "[", 
         RowBox[{"mV_", ",", "\[Alpha]B_", ",", "Facility"}], "]"}], "=", 
        RowBox[{"\[Alpha]B", "*", 
         SuperscriptBox[
          RowBox[{"FormFactorBremBL", "[", "mV", "]"}], "2"], "*", 
         RowBox[{"NormalizationBremNoFormFactor", "[", 
          RowBox[{"mV", ",", "Facility"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"EVmaxFromBrem", "[", 
         RowBox[{"mV_", ",", "\[Theta]V_", ",", "Facility"}], "]"}], "=", 
        RowBox[{"EVmaxBremBeam", "[", 
         RowBox[{"Facility", ",", "\[Theta]V"}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"Facility", ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<FermilabBD\>\"", ",", "\"\<SPS\>\"", ",", "\"\<LHC\>\"", ",", 
          "\"\<FCC-hh\>\""}], "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Tabulated", " ", "distribution", " ", "to", " ", "be", " ", "used", " ", 
     "in", " ", "next", " ", "sections"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TableBremDistr", "[", 
     RowBox[{"\[Theta]minExp_", ",", "\[Theta]maxExp_", ",", "Facility_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "eminbrem", ",", "\[Theta]Vlistbrem", ",", "EvlistBremTemp", ",", 
        "EvlistBrem"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eminbrem", "=", 
        RowBox[{
         RowBox[{"Ppfacility", "[", "Facility", "]"}], "*", 
         RowBox[{"zMinBrem", "[", "Facility", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Theta]Vlistbrem", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"\[Theta]V", ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]V", ",", 
            RowBox[{"0.99", "\[Theta]minExp"}], ",", 
            RowBox[{"1.01", "\[Theta]maxExp"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"1.01", "\[Theta]maxExp"}], "-", 
               RowBox[{"0.99", "\[Theta]minExp"}]}], ")"}], "/", "50"}]}], 
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"EvlistBremTemp", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"x", ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0.02", ",", "eminbrem", ",", "1"}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"10", "^", "x"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"Log10", "[", 
               RowBox[{"1.02", "*", "eminbrem"}], "]"}], ",", 
              RowBox[{"Log10", "[", 
               RowBox[{"Ppfacility", "[", "Facility", "]"}], "]"}], ",", 
              FractionBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Log10", "[", 
                  RowBox[{"Ppfacility", "[", "Facility", "]"}], "]"}], "-", 
                 RowBox[{"Log10", "[", 
                  RowBox[{"1.02", "*", "eminbrem"}], "]"}]}], ")"}], "50"]}], 
             "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"EvlistBrem", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"EvlistBremTemp", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"EVmaxBremBeam", "[", 
               RowBox[{"Facility", ",", "#"}], "]"}], "&"}], "/@", 
             "\[Theta]Vlistbrem"}]}], "]"}], "//", "Sort"}], "//", 
         "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"mV", ",", "\[Theta]V", ",", "EV", ",", 
             RowBox[{
              RowBox[{"DoubleDistrBLfromBremFacility", "[", 
               RowBox[{"mV", ",", "\[Theta]V", ",", "EV", ",", "Facility"}], 
               "]"}], "+", 
              SuperscriptBox["10", 
               RowBox[{"-", "90"}]]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"mV", ",", "mVminFromBrem", ",", 
             RowBox[{"mVmaxFromBrem", "//", "N"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"mVmaxFromBrem", "//", "N"}], ")"}], "-", 
                "mVminFromBrem"}], ")"}], "/", "10"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Theta]V", ",", "\[Theta]Vlistbrem"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"EV", ",", "EvlistBrem"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8867413870113516`*^9, 3.886741540701558*^9}, {
   3.8867416150085926`*^9, 3.8867416858917875`*^9}, {3.886741763910581*^9, 
   3.886741873463111*^9}, {3.8867431693622923`*^9, 3.88674317047512*^9}, {
   3.88675912650349*^9, 3.886759206087909*^9}, {3.8867597043528013`*^9, 
   3.886759755586966*^9}, {3.8867603578143253`*^9, 3.8867604196106296`*^9}, {
   3.886760617244815*^9, 3.886760865322702*^9}, {3.8867611750575757`*^9, 
   3.88676119071132*^9}, {3.886822306577469*^9, 3.886822316571784*^9}, {
   3.886832736983899*^9, 3.8868328526588106`*^9}, {3.8868376225654526`*^9, 
   3.8868376275089264`*^9}, {3.8868377047500257`*^9, 
   3.8868377500423417`*^9}, {3.8868391692356443`*^9, 
   3.8868391981720943`*^9}, {3.8921752130780435`*^9, 
   3.8921752473571453`*^9}, {3.892175350303725*^9, 3.892175351846941*^9}, {
   3.892175521630472*^9, 3.8921755238840203`*^9}, {3.8921756208211412`*^9, 
   3.892175674689103*^9}, {3.89217595151208*^9, 3.8921759832833643`*^9}, {
   3.8921761179182405`*^9, 3.8921761298085823`*^9}, {3.8921763172151895`*^9, 
   3.892176651308589*^9}, {3.8921768037891006`*^9, 3.8921769939727063`*^9}, {
   3.893471786674537*^9, 3.893471944190617*^9}, {3.8934719923316636`*^9, 
   3.893472120538704*^9}, {3.893472172040388*^9, 3.893472237278451*^9}, {
   3.8934724280610037`*^9, 3.8934724478702726`*^9}, {3.8934724906214085`*^9, 
   3.8934726100231547`*^9}, {3.8934726965780334`*^9, 3.893472719078771*^9}, 
   3.893472814711776*^9, {3.8934728976727943`*^9, 3.8934730876325455`*^9}, {
   3.8934731519633265`*^9, 3.893473184555513*^9}, 3.8934733383368425`*^9, {
   3.8934743664461913`*^9, 3.8934743955646086`*^9}, {3.89347444304001*^9, 
   3.893474491803772*^9}, {3.893520967114831*^9, 3.8935209671303005`*^9}, {
   3.8936004209704275`*^9, 3.893600421656349*^9}, {3.8936018530142164`*^9, 
   3.8936018531888504`*^9}, 3.8936019581529026`*^9, {3.893602164820368*^9, 
   3.8936021993678665`*^9}, {3.8936041500444*^9, 3.893604150255808*^9}, {
   3.8936049169399033`*^9, 3.893604967103578*^9}, {3.8939498042442403`*^9, 
   3.8939498280077534`*^9}, {3.8941029904738607`*^9, 3.894102990500143*^9}, {
   3.894103048104176*^9, 3.8941030481343546`*^9}, {3.89410358969438*^9, 
   3.8941036636342015`*^9}, {3.8941037247521696`*^9, 3.894103759798315*^9}},
 CellTags->"Number-of-events",
 CellLabel->"In[70]:=",ExpressionUUID->"396a3a98-4364-49a7-b52d-e1e8f4a5d79e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Via decays of mesons and mixing: br ratios and meson multiplicities \
\>", "Subsection",
 CellChangeTimes->{{3.8867412989661756`*^9, 3.8867413212030272`*^9}},
 CellTags->
  "Number-of-events",ExpressionUUID->"02e50908-da43-47aa-a1ba-caa52cc8b93c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Br\[Pi]To\[Gamma]\[Gamma]", "=", "0.98799"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Br\[Eta]To\[Gamma]\[Gamma]", "=", "0.3931181"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Br\[Omega]To\[Pi]\[Gamma]", "=", "0.0834941"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Br\[Eta]prTo\[Gamma]\[Gamma]", "=", "0.0219297"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]em", "=", 
   RowBox[{"1", "/", "137."}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Br\[Pi]0ToV", "[", "mV_", "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"mV", "<", "m\[Pi]0"}], ",", 
     RowBox[{
      FractionBox["1", "\[Alpha]em"], 
      RowBox[{"Evaluate", "[", 
       RowBox[{"2", "*", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{
            SuperscriptBox["mV", "2"], "/", 
            SuperscriptBox["m\[Pi]0", "2"]}]}], ")"}], "3"], "*", 
        "Br\[Pi]To\[Gamma]\[Gamma]"}], "]"}]}], ",", "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Br\[Eta]ToV", "[", "mV_", "]"}], "=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"mV", "<", "m\[Eta]"}], ",", 
      RowBox[{
       FractionBox["1", "\[Alpha]em"], 
       RowBox[{"Evaluate", "[", 
        RowBox[{"2", "*", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{
             SuperscriptBox["mV", "2"], "/", 
             SuperscriptBox["m\[Eta]", "2"]}]}], ")"}], "3"], "*", 
         "Br\[Eta]To\[Gamma]\[Gamma]"}], "]"}]}], ",", "0"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Br\[Omega]ToV", "[", "mV_", "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"mV", "<", 
        RowBox[{"m\[Omega]", "-", "m\[Pi]0"}]}], ",", 
       RowBox[{"Br\[Omega]To\[Pi]\[Gamma]", "*", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["m\[Omega]", "2"], "-", 
           SuperscriptBox["mV", "2"], "-", 
           SuperscriptBox["m\[Pi]0", "2"]}], ")"}], "2"], "*", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["m\[Omega]", "2"], "-", 
              SuperscriptBox["mV", "2"], "+", 
              SuperscriptBox["m\[Pi]0", "2"]}], ")"}], "2"], "-", 
           RowBox[{"4", "*", 
            SuperscriptBox["m\[Omega]", "2"], "*", 
            SuperscriptBox["m\[Pi]0", "2"]}]}], "]"}], "/", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["m\[Omega]", "2"], "-", 
            SuperscriptBox["mV", "2"]}], ")"}], "3"]}]}], ",", "0"}], "]"}]}],
     ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Br\[Eta]prToV", "[", "mV_", "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"mV", "<", "m\[Eta]pr"}], ",", 
     RowBox[{
      FractionBox["1", "\[Alpha]em"], 
      RowBox[{"Evaluate", "[", 
       RowBox[{"2", "*", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{
            SuperscriptBox["mV", "2"], "/", 
            SuperscriptBox["m\[Eta]pr", "2"]}]}], ")"}], "3"], "*", 
        "Br\[Eta]prTo\[Gamma]\[Gamma]"}], "]"}]}], ",", "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BrDecay", "[", 
    RowBox[{"mV_", ",", "\[Alpha]B_", ",", "meson_"}], "]"}], ":=", 
   RowBox[{"\[Alpha]B", "*", 
    RowBox[{
     RowBox[{"Association", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "mV", ",", "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\""}], 
          "}"}], "\[Rule]", 
         RowBox[{"Br\[Pi]0ToV", "[", "mV", "]"}]}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"mV", ",", "\"\<\[Eta]\>\""}], "}"}], "\[Rule]", 
         RowBox[{"Br\[Eta]ToV", "[", "mV", "]"}]}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"mV", ",", "\"\<\[Eta]'\>\""}], "}"}], "\[Rule]", 
         RowBox[{"Br\[Eta]prToV", "[", "mV", "]"}]}]}], "}"}], "]"}], "[", 
     RowBox[{"{", 
      RowBox[{"mV", ",", "meson"}], "}"}], "]"}]}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Mixing", " ", "angle", " ", 
      SuperscriptBox["\[Omega]", "0"]}], "-", 
     RowBox[{
      RowBox[{"BL", ".", " ", "Following"}], " ", 
      RowBox[{"https", ":"}]}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{"arxiv", ".", "org"}], "/", "pdf"}], "/", 
     RowBox[{"1810.01879", ".", "pdf"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]BL\[Omega]2", "[", 
    RowBox[{"mV_", ",", "\[Alpha]B_"}], "]"}], "=", 
   RowBox[{
    FractionBox[
     RowBox[{"4", "Pi", "*", "\[Alpha]B"}], "g\[Omega]"], "*", 
    FractionBox[
     SuperscriptBox["M\[Omega]780", "4"], 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["mV", "2"], "-", 
         SuperscriptBox["M\[Omega]780", "2"]}], ")"}], "2"], "+", 
      RowBox[{
       SuperscriptBox["Gamma\[Omega]780", "2"], "*", 
       SuperscriptBox["M\[Omega]780", "2"]}]}]]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.886741324632948*^9, 3.88674133750587*^9}, {
   3.886743349704631*^9, 3.886743469951105*^9}, {3.8867435208363976`*^9, 
   3.886743559442109*^9}, {3.8867436030673923`*^9, 3.8867436380024014`*^9}, {
   3.886743677147029*^9, 3.886743791056388*^9}, {3.886759023397938*^9, 
   3.886759051632529*^9}, {3.886759084894906*^9, 3.886759102806116*^9}, {
   3.886759322833825*^9, 3.886759324091713*^9}, {3.8867597957163935`*^9, 
   3.886760018253701*^9}, {3.8867600560403585`*^9, 3.8867601972064524`*^9}, {
   3.8867608717265434`*^9, 3.886760928433196*^9}, {3.8902877382139034`*^9, 
   3.8902877885168395`*^9}, {3.890287908819491*^9, 3.8902879384574685`*^9}, 
   3.890287972630889*^9, {3.892180139844576*^9, 3.8921801533898745`*^9}, {
   3.89410299054401*^9, 3.8941029905531034`*^9}, {3.8941030481438913`*^9, 
   3.8941030481438913`*^9}, {3.8941031136384697`*^9, 3.894103125682778*^9}, {
   3.894103845394406*^9, 3.894103848935071*^9}, {3.8941185159932137`*^9, 
   3.894118529321699*^9}, {3.8941187659099855`*^9, 3.8941187829707375`*^9}, {
   3.894119099735388*^9, 3.8941191205379004`*^9}, {3.8941191751609745`*^9, 
   3.894119175307535*^9}, {3.8951347498744535`*^9, 3.8951348182645855`*^9}},
 CellTags->"Number-of-events",
 CellLabel->"In[88]:=",ExpressionUUID->"8d814f01-b0dd-4f8a-9760-73e57faaeabe"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Drell-Yan", "Subsection",
 CellChangeTimes->{{3.886743986990315*^9, 3.8867439898240757`*^9}},
 CellTags->
  "Number-of-events",ExpressionUUID->"19f885f5-e34f-4c81-b419-80a9a356d56c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]DrellYanData", "[", "file_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dat", "=", 
      RowBox[{"Import", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<phenomenology/B-L/branching ratios\>\"", ",", "file"}], "}"}],
          "]"}], ",", "\"\<Table\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"MinMaxMassesDrellYan", "=", 
      RowBox[{"MinMax", "[", 
       RowBox[{"dat", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"MinMaxMassesDrellYan", ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MinMaxMassesDrellYan", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", " ", "mV", 
          "\[LessEqual]", 
          RowBox[{"MinMaxMassesDrellYan", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Interpolation", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Log10", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                   RowBox[{"Log10", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "90"}]]}], "]"}]}], "}"}], "&"}], "/@", 
                "dat"}], ",", 
               RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
             RowBox[{"Log10", "[", "mV", "]"}], "]"}], ")"}]}], "]"}], ",", 
         "0"}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mDrellYanMinLHC", ",", "mDrellYanMaxLHC"}], "}"}], ",", 
     RowBox[{"\[Sigma]DrellYanpbLHCatLO", "[", "mV_", "]"}]}], "}"}], "=", 
   RowBox[{
   "\[Sigma]DrellYanData", "[", "\"\<sigma-Drell-Yan-B-L-LHC.txt\>\"", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mDrellYanMinSPS", ",", "mDrellYanMaxSPS"}], "}"}], ",", 
     RowBox[{"\[Sigma]DrellYanpbSPSatLO", "[", "mV_", "]"}]}], "}"}], "=", 
   RowBox[{
   "\[Sigma]DrellYanData", "[", "\"\<sigma-Drell-Yan-B-L-SPS.txt\>\"", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mDrellYanMinFermilabBD", ",", "mDrellYanMaxFermilabBD"}], 
      "}"}], ",", 
     RowBox[{"\[Sigma]DrellYanpbFermilabBDatLO", "[", "mV_", "]"}]}], "}"}], 
   "=", 
   RowBox[{
   "\[Sigma]DrellYanData", "[", "\"\<sigma-Drell-Yan-B-L-FermilabBD.txt\>\"", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"PDrellYanFacility", "[", 
     RowBox[{
     "mV_", ",", "\[Alpha]B_", ",", "Atarget_", ",", "\"\<FermilabBD\>\""}], 
     "]"}], ",", 
    RowBox[{"PDrellYanFacility", "[", 
     RowBox[{"mV_", ",", "\[Alpha]B_", ",", "Atarget_", ",", "\"\<SPS\>\""}], 
     "]"}], ",", 
    RowBox[{"PDrellYanFacility", "[", 
     RowBox[{"mV_", ",", "\[Alpha]B_", ",", "Atarget_", ",", "\"\<LHC\>\""}], 
     "]"}], ",", 
    RowBox[{"PDrellYanFacility", "[", 
     RowBox[{"mV_", ",", "\[Alpha]B_", ",", "A_", ",", "\"\<FCC-hh\>\""}], 
     "]"}]}], "}"}], "=", 
  RowBox[{"\[Alpha]B", "*", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"\[Sigma]DrellYanpbFermilabBDatLO", "[", "mV", "]"}], 
      RowBox[{"\[Sigma]pNucleonInpb", "[", "Atarget", "]"}]], ",", 
     FractionBox[
      RowBox[{"\[Sigma]DrellYanpbSPSatLO", "[", "mV", "]"}], 
      RowBox[{"\[Sigma]pNucleonInpb", "[", "Atarget", "]"}]], ",", 
     FractionBox[
      RowBox[{"\[Sigma]DrellYanpbLHCatLO", "[", "mV", "]"}], "\[Sigma]ppLHC"],
      ",", "0"}], "}"}]}]}]}], "Input",
 CellChangeTimes->{{3.8867439953320885`*^9, 3.8867443056738534`*^9}, {
  3.886744688505722*^9, 3.8867448017690363`*^9}, {3.8867602172841234`*^9, 
  3.8867602450458765`*^9}, {3.886760302636557*^9, 3.8867603337848253`*^9}, {
  3.8867605369307594`*^9, 3.8867606025869236`*^9}, {3.886760945508157*^9, 
  3.8867609651142406`*^9}, {3.8867611207481756`*^9, 3.886761162865342*^9}, {
  3.8868400708860817`*^9, 3.8868400727457695`*^9}, {3.8921793389157085`*^9, 
  3.892179366020566*^9}, {3.89349660534874*^9, 3.8934966761100206`*^9}, {
  3.893496755609863*^9, 3.8934968237352333`*^9}, {3.893496865517758*^9, 
  3.8934970127124376`*^9}, {3.8935209673073406`*^9, 3.8935209673163195`*^9}, {
  3.8941029905571527`*^9, 3.8941029905731463`*^9}, {3.894103048152993*^9, 
  3.894103048152993*^9}, {3.8941030900921803`*^9, 3.894103090672176*^9}, {
  3.89438335112968*^9, 3.8943833783515835`*^9}},
 CellTags->"Number-of-events",
 CellLabel->"In[97]:=",ExpressionUUID->"5c368474-a50e-4442-ac88-0d8dba43c47f"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Compilable interpolation function mapping one grid into another\
\>", "Chapter",
 CellChangeTimes->{{3.891315426588935*^9, 3.891315432542842*^9}},
 CellTags->
  "Number-of-events",ExpressionUUID->"1b378212-4ed2-4d4c-8d36-a259eabd1c69"],

Cell[CellGroupData[{

Cell["3D to 3D", "Subsection",
 CellChangeTimes->{{3.8906627216475997`*^9, 3.8906627248020773`*^9}, {
  3.8907326559924955`*^9, 3.89073265766968*^9}},
 CellTags->
  "Number-of-events",ExpressionUUID->"0a03eb70-f700-40ba-bcf8-ed45270cc911"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nd", "=", "3"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"cf3", "=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"xgvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<xg\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"igvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<ig\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"tgvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<tg\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"ivars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<i\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"svars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<s\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"tvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<t\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"jvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<j\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}]}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Inactivate", "[", 
         RowBox[{
          RowBox[{"Compile", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"seq", "@", 
               RowBox[{"{", 
                RowBox[{"xgvars", ",", "_Real", ",", "1"}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", "_Real", ",", "nd"}], "}"}]}], "}"}], ",", 
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"seq", "@", "igvars"}], ",", 
                RowBox[{"seq", "@", "tgvars"}], ",", 
                RowBox[{"seq", "@", "ivars"}], ",", 
                RowBox[{"seq", "@", "svars"}], ",", 
                RowBox[{"seq", "@", "tvars"}]}], "}"}], ",", 
              RowBox[{
               RowBox[{"seq", "[", 
                RowBox[{"igvars", "=", 
                 RowBox[{
                  RowBox[{"Floor", "[", "xgvars", "]"}], "-", 
                  RowBox[{"UnitStep", "[", 
                   RowBox[{"xgvars", "-", 
                    RowBox[{"indexed", "@", 
                    RowBox[{"Dimensions", "@", "y"}]}]}], "]"}]}]}], "]"}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"seq", "[", 
                RowBox[{"tgvars", "=", 
                 RowBox[{"xgvars", "-", "igvars"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"seq", "[", 
                   RowBox[{"tvars", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"tgvars", ",", "jvars"}], "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"seq", "[", 
                   RowBox[{"ivars", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"igvars", ",", "jvars"}], "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"seq", "[", 
                   RowBox[{"svars", "=", 
                    RowBox[{"1.", "-", "tvars"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"eval", "@", 
                   RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Times", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], " ", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], "]"}]}], 
                    "&"}], "/@", 
                    RowBox[{"Tuples", "@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"svars", ",", "ivars"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"tvars", ",", 
                    RowBox[{"ivars", "+", "1"}]}], "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}]}]}], 
                    "]"}]}]}], ",", 
                 RowBox[{"seq", "@", 
                  RowBox[{"{", 
                   RowBox[{"jvars", ",", 
                    RowBox[{"Length", "@", "igvars"}]}], "}"}]}]}], "]"}]}]}],
              "]"}], ",", 
            RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
            RowBox[{"RuntimeAttributes", "\[Rule]", 
             RowBox[{"{", "Listable", "}"}]}], ",", 
            RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
            RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}], 
          ",", 
          RowBox[{"Except", "[", 
           RowBox[{"seq", "|", "eval", "|", "indexed"}], "]"}]}], "]"}], "/.", 
        RowBox[{
         RowBox[{"seq", "[", "expr_", "]"}], "\[RuleDelayed]", 
         RowBox[{"RuleCondition", "@", 
          RowBox[{"(", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Inactivate", "[", 
                RowBox[{"expr", ",", 
                 RowBox[{"Except", "[", 
                  RowBox[{"slist", "|", "indexed"}], "]"}]}], "]"}], "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"l_slist", "\[RuleDelayed]", 
                  RowBox[{"l", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"indexed", "[", "l_", "]"}], "\[RuleDelayed]", 
                  RowBox[{
                   RowBox[{"Inactive", "[", "Compile`GetElement", "]"}], "[", 
                   RowBox[{"l", ",", "i"}], "]"}]}]}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "nd"}], "}"}]}], "]"}]}], ")"}]}]}]}], "/.", 
       RowBox[{
        RowBox[{"eval", "@", "expr_"}], "\[RuleDelayed]", 
        RowBox[{"RuleCondition", "[", 
         RowBox[{"Activate", "[", 
          RowBox[{"expr", "/.", 
           RowBox[{"slist", "\[Rule]", "List"}]}], "]"}], "]"}]}]}]}], "]"}], 
    "//", "Activate"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.890711783488103*^9, 3.89071178348964*^9}, {
  3.8907121412539587`*^9, 3.8907121413711557`*^9}, {3.890712694841427*^9, 
  3.8907126950000925`*^9}, {3.890712790376151*^9, 3.8907128219919777`*^9}, {
  3.891018553068019*^9, 3.8910185548862777`*^9}},
 CellTags->"Number-of-events",
 CellLabel->
  "In[102]:=",ExpressionUUID->"af307eea-4f87-4f93-bef6-910257d2885a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["4D to 4D", "Subsection",
 CellChangeTimes->{{3.8906627216475997`*^9, 3.8906627248020773`*^9}, {
  3.8907326559924955`*^9, 3.890732670187893*^9}},
 CellTags->
  "Number-of-events",ExpressionUUID->"8d9498ec-3be6-4cde-a641-d92e2914033a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nd", "=", "4"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"cf4", "=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"xgvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<xg\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"igvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<ig\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"tgvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<tg\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"ivars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<i\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"svars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<s\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"tvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<t\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"jvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<j\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}]}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Inactivate", "[", 
         RowBox[{
          RowBox[{"Compile", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"seq", "@", 
               RowBox[{"{", 
                RowBox[{"xgvars", ",", "_Real", ",", "1"}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", "_Real", ",", "nd"}], "}"}]}], "}"}], ",", 
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"seq", "@", "igvars"}], ",", 
                RowBox[{"seq", "@", "tgvars"}], ",", 
                RowBox[{"seq", "@", "ivars"}], ",", 
                RowBox[{"seq", "@", "svars"}], ",", 
                RowBox[{"seq", "@", "tvars"}]}], "}"}], ",", 
              RowBox[{
               RowBox[{"seq", "[", 
                RowBox[{"igvars", "=", 
                 RowBox[{
                  RowBox[{"Floor", "[", "xgvars", "]"}], "-", 
                  RowBox[{"UnitStep", "[", 
                   RowBox[{"xgvars", "-", 
                    RowBox[{"indexed", "@", 
                    RowBox[{"Dimensions", "@", "y"}]}]}], "]"}]}]}], "]"}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"seq", "[", 
                RowBox[{"tgvars", "=", 
                 RowBox[{"xgvars", "-", "igvars"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"seq", "[", 
                   RowBox[{"tvars", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"tgvars", ",", "jvars"}], "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"seq", "[", 
                   RowBox[{"ivars", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"igvars", ",", "jvars"}], "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"seq", "[", 
                   RowBox[{"svars", "=", 
                    RowBox[{"1.", "-", "tvars"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"eval", "@", 
                   RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Times", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], " ", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], "]"}]}], 
                    "&"}], "/@", 
                    RowBox[{"Tuples", "@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"svars", ",", "ivars"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"tvars", ",", 
                    RowBox[{"ivars", "+", "1"}]}], "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}]}]}], 
                    "]"}]}]}], ",", 
                 RowBox[{"seq", "@", 
                  RowBox[{"{", 
                   RowBox[{"jvars", ",", 
                    RowBox[{"Length", "@", "igvars"}]}], "}"}]}]}], "]"}]}]}],
              "]"}], ",", 
            RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
            RowBox[{"RuntimeAttributes", "\[Rule]", 
             RowBox[{"{", "Listable", "}"}]}], ",", 
            RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
            RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}], 
          ",", 
          RowBox[{"Except", "[", 
           RowBox[{"seq", "|", "eval", "|", "indexed"}], "]"}]}], "]"}], "/.", 
        RowBox[{
         RowBox[{"seq", "[", "expr_", "]"}], "\[RuleDelayed]", 
         RowBox[{"RuleCondition", "@", 
          RowBox[{"(", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Inactivate", "[", 
                RowBox[{"expr", ",", 
                 RowBox[{"Except", "[", 
                  RowBox[{"slist", "|", "indexed"}], "]"}]}], "]"}], "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"l_slist", "\[RuleDelayed]", 
                  RowBox[{"l", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"indexed", "[", "l_", "]"}], "\[RuleDelayed]", 
                  RowBox[{
                   RowBox[{"Inactive", "[", "Compile`GetElement", "]"}], "[", 
                   RowBox[{"l", ",", "i"}], "]"}]}]}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "nd"}], "}"}]}], "]"}]}], ")"}]}]}]}], "/.", 
       RowBox[{
        RowBox[{"eval", "@", "expr_"}], "\[RuleDelayed]", 
        RowBox[{"RuleCondition", "[", 
         RowBox[{"Activate", "[", 
          RowBox[{"expr", "/.", 
           RowBox[{"slist", "\[Rule]", "List"}]}], "]"}], "]"}]}]}]}], "]"}], 
    "//", "Activate"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8907148978688216`*^9, 3.890714898931299*^9}, {
  3.8910185630697727`*^9, 3.8910185650759544`*^9}},
 CellTags->"Number-of-events",
 CellLabel->
  "In[104]:=",ExpressionUUID->"8aae74ab-0b98-486f-b29e-af2b72cca351"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Specifying the experiment", "Title",
 CellChangeTimes->{{3.8876177939846563`*^9, 3.8876177965376587`*^9}},
 CellTags->
  "Number-of-events",ExpressionUUID->"968fa4f0-ff0e-49b5-9961-c8c532a97325"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Parent", " ", "directory"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NotebookDirectory", "[", "]"}], "//", "ParentDirectory"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AcceptanceDirectory", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Acceptances\>\""}], 
     "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExperimentDirectoriesList", "=", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"FileNames", "[", 
       RowBox[{"\"\<*\>\"", ",", "AcceptanceDirectory", ",", "1"}], "]"}], 
      ",", "DirectoryQ"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"List", " ", "of", " ", "available", " ", "experiments", " ", 
    RowBox[{"(", 
     RowBox[{
     "for", " ", "which", " ", "the", " ", "geometry", " ", "has", " ", 
      "been", " ", "implemented"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentsListTemp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"FileNameTake", "[", 
      RowBox[{
       RowBox[{"ExperimentDirectoriesList", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"-", "1"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "ExperimentDirectoriesList", "]"}], ",", "1"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentsListTemp2", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Partition", "[", 
      RowBox[{"ExperimentsListTemp", ",", "1"}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"TrueQ", "@", 
         RowBox[{"FileExistsQ", "@", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"NotebookDirectory", "[", "]"}], ",", 
             "\"\<Acceptances\>\"", ",", 
             RowBox[{"ExperimentsListTemp", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"ToString", "@", 
              RowBox[{"StringForm", "[", 
               RowBox[{"\"\<Acceptance_``_for_B-3Le-Lmu+Ltau.m\>\"", ",", 
                RowBox[{"ExperimentsListTemp", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], "}"}], 
           "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "ExperimentsListTemp", "]"}]}], "}"}]}], 
      "]"}], ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ExperimentsList", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{"ExperimentsListTemp2", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "True"}], "&"}]}], "]"}],
     "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", 
   "Sort"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", "ExperimentsList", "]"}], "\[Equal]", "0"}], ",", 
   RowBox[{
   "Print", "[", 
    "\"\<No experiment is available, generate first the acceptance for the \
given experiment using module 1\>\"", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Selected experiment:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"selectionDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", 
      RowBox[{"{", "}"}]}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{
        "{", "\"\<Select the experiments for which the number of events will \
be computed:\>\"", "}"}], "]"}], ",", 
       RowBox[{"Pane", "[", 
        RowBox[{
         RowBox[{"TogglerBar", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list", ",", 
           RowBox[{"Appearance", "->", 
            RowBox[{"\"\<Vertical\>\"", "->", 
             RowBox[{"{", 
              RowBox[{"Automatic", ",", "5"}], "}"}]}]}]}], "]"}], ",", 
         RowBox[{"ImageSize", "->", 
          RowBox[{"{", 
           RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], ",", 
         RowBox[{"Scrollbars", "->", 
          RowBox[{"{", 
           RowBox[{"False", ",", "True"}], "}"}]}]}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"SelectedExperimentList", "=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "ExperimentsList", "]"}], "\[NotEqual]", "0"}], 
    ",", 
    RowBox[{"selectionDialog", "[", 
     RowBox[{"ExperimentsList", ",", "\"\<Select the experiments:\>\""}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"icounter", "=", "1"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8851403254718485`*^9, 3.8851403429411273`*^9}, {
   3.8854395484478483`*^9, 3.885439559226637*^9}, {3.8854397351242537`*^9, 
   3.885439739219259*^9}, {3.8858794196350574`*^9, 3.885879423032172*^9}, 
   3.886141121558817*^9, {3.886821665769628*^9, 3.8868216684602585`*^9}, {
   3.887617086304534*^9, 3.8876170990910044`*^9}, 3.889080211074895*^9, {
   3.890287800311657*^9, 3.890287802587648*^9}, {3.892189472726385*^9, 
   3.8921895121150846`*^9}, 3.892705546310735*^9, 3.8932345108531446`*^9, {
   3.894103048164015*^9, 3.894103075922846*^9}, {3.8963286883948097`*^9, 
   3.8963286919534035`*^9}, {3.9027629956666827`*^9, 3.902763001867505*^9}, {
   3.9038921824100084`*^9, 3.9038921826591916`*^9}},
 CellTags->
  "Number-of-events",ExpressionUUID->"c8579664-56cf-4aa3-a66d-4bb791136bbc"],

Cell[CellGroupData[{

Cell["Running block for next sections", "Chapter",
 CellChangeTimes->{{3.902729140157612*^9, 3.90272914444062*^9}},
 CellTags->
  "Number-of-events",ExpressionUUID->"fe521a3b-3582-49b1-81f8-e7d0eb93e787"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BlockEvaluation", "[", "tag_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nb", "=", 
      RowBox[{"EvaluationNotebook", "[", "]"}]}], ";", "\n", 
     RowBox[{"NotebookFind", "[", 
      RowBox[{"nb", ",", "tag", ",", "All", ",", "CellTags"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"tagselected", "==", "\"\<Number-of-events\>\""}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
      "BlockEvaluation", "[", "\"\<Number-of-events-computation\>\"", "]"}], 
      ";"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"icounter", ",", "1", ",", 
       RowBox[{"Length", "[", "SelectedExperimentList", "]"}], ",", "1"}], 
      "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"tagselected", "==", "\"\<Acceptance\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
        "BlockEvaluation", "[", "\"\<Acceptance-computation\>\"", "]"}], 
        ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"icounter", ",", "1", ",", 
         RowBox[{"Length", "[", "SelectedExperimentList", "]"}], ",", "1"}], 
        "}"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.9027291581950865`*^9, 3.902729215695462*^9}, {
  3.902761777481885*^9, 3.902761802513644*^9}, {3.9038921804262767`*^9, 
  3.903892210643779*^9}},
 CellTags->
  "Number-of-events",ExpressionUUID->"5523c656-a023-44f0-81eb-5c9ec9f88388"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Number of events", "Title",
 CellChangeTimes->{{3.885140281753849*^9, 3.8851402836781845`*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"ce2dc008-ba4c-4a1a-8777-\
34a2b932d2e7"],

Cell[CellGroupData[{

Cell["Cross-sections, acceptances", "Chapter",
 CellChangeTimes->{{3.885020695565913*^9, 3.885020698644303*^9}, 
   3.887617827187765*^9, {3.894637256053878*^9, 3.8946372599194975`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"3bf68ab5-5da5-4e0e-a052-\
8e2595821946"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SelectedExperiment", "=", 
   RowBox[{"SelectedExperimentList", "[", 
    RowBox[{"[", 
     RowBox[{"icounter", "++"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dataAcceptances", "=", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<Acceptances\>\"", ",", "SelectedExperiment", ",", 
           RowBox[{"ToString", "@", 
            RowBox[{"StringForm", "[", 
             RowBox[{
             "\"\<Acceptance_``_for_B-3Le-Lmu+Ltau.m\>\"", ",", 
              "SelectedExperiment"}], "]"}]}]}], "}"}], "]"}], "}"}], "]"}], 
      ",", "\"\<MX\>\""}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FacilityGivenExperiment", "=", 
   RowBox[{"dataAcceptances", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ECALoption", "=", 
   RowBox[{"dataAcceptances", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BrVis", "[", "mV_", "]"}], "=", 
   RowBox[{"BrVisible", "[", 
    RowBox[{"mV", ",", "ECALoption"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullAcceptanceData0", "=", 
   RowBox[{"dataAcceptances", "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Theta]minExpAll", ",", "\[Theta]maxExpAll"}], "}"}], "=", 
   RowBox[{"MinMax", "[", 
    RowBox[{"FullAcceptanceData0", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Theta]minExp", ",", "\[Theta]maxExp"}], "}"}], "=", 
   RowBox[{"MinMax", "[", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"FullAcceptanceData0", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "6", "]"}], "]"}], "\[NotEqual]", "0"}], "&"}]}], 
      "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"zminExp", ",", "zmaxExp"}], "}"}], "=", 
   RowBox[{"MinMax", "[", 
    RowBox[{"FullAcceptanceData0", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AzimuthalAcceptanceData", "=", 
    RowBox[{
     RowBox[{"DeleteDuplicatesBy", "[", 
      RowBox[{"FullAcceptanceData0", ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "&"}]}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "4", ",", "5"}], "}"}]}], "]"}], "]"}]}], ";"}], "//",
   "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]Grid", "=", 
   RowBox[{"DeleteDuplicates", "[", 
    RowBox[{"AzimuthalAcceptanceData", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zminmax\[Theta]data", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"MinMax", "[", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"AzimuthalAcceptanceData", ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "==", 
            RowBox[{"\[Theta]Grid", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "&&", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "\[NotEqual]", "0"}]}], "&"}]}], 
        "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "\[Theta]Grid", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zmin\[Theta]", "[", "\[Theta]V_", "]"}], "=", 
   RowBox[{
    RowBox[{"Interpolation", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{"\[Theta]Grid", ",", "1"}], "]"}], ",", 
        RowBox[{"zminmax\[Theta]data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", "1", "}"}]}], "]"}], "]"}], ",", "2"}], "]"}], ",", 
      RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
    "\[Theta]V", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zmax\[Theta]", "[", "\[Theta]V_", "]"}], "=", 
   RowBox[{
    RowBox[{"Interpolation", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{"\[Theta]Grid", ",", "1"}], "]"}], ",", 
        RowBox[{"zminmax\[Theta]data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}], "]"}], ",", "2"}], "]"}], ",", 
      RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
    "\[Theta]V", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AzimuthalAcceptanceBL", "[", 
    RowBox[{"\[Theta]V_", ",", "zV_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Interpolation", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}], "/@", 
       "AzimuthalAcceptanceData"}], ",", 
      RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
    RowBox[{"\[Theta]V", ",", "zV"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DecAccDataLogarithmizedComp", "=", 
   RowBox[{
    RowBox[{"Hold", "@", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"FullAcceptanceData", ",", "_Real", ",", "2"}], "}"}], "}"}],
        ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Log10", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
           RowBox[{"Log10", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
           RowBox[{"Log10", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
           RowBox[{"Log10", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "]"}], ",", 
           RowBox[{"Log10", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "6", "]"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
        "FullAcceptanceData"}]}], "]"}]}], "//", "ReleaseHold"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"DecayAcceptanceBL", "[", 
      RowBox[{"mV_", ",", "\[Theta]V_", ",", "EV_", ",", "zV_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"BrVis", "[", "mV", "]"}], "*", 
      RowBox[{"10", "^", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{
           RowBox[{
           "DecAccDataLogarithmizedComp", "[", "FullAcceptanceData0", "]"}], 
           ",", 
           RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
         RowBox[{
          RowBox[{"Log10", "[", "mV", "]"}], ",", 
          RowBox[{"Log10", "[", "\[Theta]V", "]"}], ",", 
          RowBox[{"Log10", "[", "EV", "]"}], ",", 
          RowBox[{"Log10", "[", "zV", "]"}]}], "]"}], ")"}]}]}]}], ";"}], "//",
    "AbsoluteTiming"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Interpolation", " ", "for", " ", "the", " ", "full", " ", "acceptance"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"acccomp", "=", 
    RowBox[{
     RowBox[{"Hold", "@", 
      RowBox[{"Compile", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"data", ",", "_Real", ",", "2"}], "}"}], "}"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Log10", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
            RowBox[{"Log10", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
            RowBox[{"Log10", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
            RowBox[{"Log10", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "4", "]"}], "]"}], "]"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "5", "]"}], "]"}], "*", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "6", "]"}], "]"}]}], "\[Equal]", "0"}], ",", 
              RowBox[{"-", "90"}], ",", 
              RowBox[{"Log10", "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "5", "]"}], "]"}], "*", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "6", "]"}], "]"}]}], "]"}]}], "]"}]}], "}"}], 
          "&"}], "/@", 
         RowBox[{"SortBy", "[", 
          RowBox[{"data", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "&"}]}], "]"}]}]}], 
       "]"}]}], "//", "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Interpolation", " ", "for", " ", "the", " ", "full", " ", "acceptance"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FullAcceptanceData", "=", 
    RowBox[{"acccomp", "[", "FullAcceptanceData0", "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FullAcceptanceBL", "[", 
     RowBox[{"mV_", ",", "\[Theta]V_", ",", "EV_", ",", "zV_"}], "]"}], "=", 
    RowBox[{"10", "^", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Interpolation", "[", 
        RowBox[{"FullAcceptanceData", ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
       RowBox[{
        RowBox[{"Log10", "[", "mV", "]"}], ",", 
        RowBox[{"Log10", "[", "\[Theta]V", "]"}], ",", 
        RowBox[{"Log10", "[", "EV", "]"}], ",", 
        RowBox[{"Log10", "[", "zV", "]"}]}], "]"}], ")"}]}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CrossSectionsData", "=", 
   RowBox[{
    RowBox[{"dataAcceptances", "[", 
     RowBox[{"[", "4", "]"}], "]"}], "//", "Transpose"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NpotGivenExperiment", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"CrossSectionsData", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<Npot\>\""}], 
         "&"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "//", "N"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "\[Chi]Xprod", "[", "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", 
    "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"CrossSectionsData", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<PPi0\>\""}], 
        "&"}]}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Chi]Xprod", "[", "\"\<\[Eta]\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"CrossSectionsData", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<PEta\>\""}], 
        "&"}]}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Chi]Xprod", "[", "\"\<\[Eta]'\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"CrossSectionsData", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<PEtapr\>\""}], 
        "&"}]}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Chi]Xprod", "[", "\"\<\[Omega]\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"CrossSectionsData", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<POmega\>\""}], 
        "&"}]}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AtargetVal", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"CrossSectionsData", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<Atarget\>\""}], 
         "&"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"infoDialog", "[", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{
      "\"\<The number of proton collisions is \>\"", ",", " ", 
       "NpotGivenExperiment", ",", 
       "\"\<. You may change it at the stage of computing the sensitivities\>\
\""}], "}"}], "]"}], "]"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{
   "\"\<Search for B-3\!\(\*SubscriptBox[\(L\), \
\(e\)]\)-\!\(\*SubscriptBox[\(L\), \(\[Mu]\)]\)+\!\(\*SubscriptBox[\(L\), \(\
\[Tau]\)]\) mediator at \>\"", ",", " ", "SelectedExperiment", ",", " ", 
    "\"\< located at \>\"", ",", "FacilityGivenExperiment", ",", 
    "\"\<. \!\(\*SubscriptBox[\(N\), \(collisions\)]\) = \>\"", ",", 
    "NpotGivenExperiment"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\"\<Quantity\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(min\)]\), rad\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(max\)]\), rad\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(min\)]\)(\!\(\*SubscriptBox[\(\
\[Epsilon]\), \(dec\)]\)), rad\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(max\)]\)(\!\(\*SubscriptBox[\(\
\[Epsilon]\), \(dec\)]\)), rad\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(z\), \(min\)]\), m\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(z\), \(max\)]\), m\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Description\>\"", ",", "\"\<Min angle covered by experiment\>\"", 
      ",", "\"\<Max angle covered by experiment\>\"", ",", 
      "\"\<Min angle where \!\(\*SubscriptBox[\(\[Epsilon]\), \(decay\)]\)\
\[NotEqual]0\>\"", ",", 
      "\"\<Max angle where \!\(\*SubscriptBox[\(\[Epsilon]\), \(decay\)]\)\
\[NotEqual]0\>\"", ",", "\"\<Min long. displacement of the decay volume\>\"", 
      ",", "\"\<Max long. displacement of the decay volume\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Value\>\"", ",", "\[Theta]minExpAll", ",", "\[Theta]maxExpAll", ",",
       "\[Theta]minExp", ",", "\[Theta]maxExp", ",", "zminExp", ",", 
      "zmaxExp"}], "}"}]}], "}"}], "//", "TableForm"}]}], "Input",
 CellChangeTimes->{{3.8921748442124033`*^9, 3.892174924863473*^9}, {
   3.892888493615114*^9, 3.892888495922745*^9}, {3.8941030481731443`*^9, 
   3.894103048184267*^9}, {3.894119531018094*^9, 3.894119534181525*^9}, 
   3.8941196371455216`*^9, {3.8941197761341114`*^9, 3.894119783152837*^9}, {
   3.8941789550624056`*^9, 3.894178955416995*^9}, 3.894382666818864*^9, {
   3.8946372527025576`*^9, 3.8946372530649595`*^9}, {3.895053351968834*^9, 
   3.8950533577221875`*^9}, 3.8963287015115595`*^9, {3.8972313886151175`*^9, 
   3.897231395713668*^9}, {3.8991983951610465`*^9, 3.8991984166956882`*^9}, {
   3.9027630065608997`*^9, 3.9027630388173304`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"3a5a6575-80ee-4cc7-9603-\
1ec1f7d2d73e"]
}, Closed]],

Cell[CellGroupData[{

Cell["FIP angle-energy distributions and  for the given experiment", "Chapter",
 CellChangeTimes->{{3.885020702966837*^9, 3.885020711525731*^9}, {
   3.8850216924759345`*^9, 3.8850216984444695`*^9}, {3.8851404110391607`*^9, 
   3.8851404117847*^9}, 3.8859669420079484`*^9, {3.887617811213402*^9, 
   3.88761781429661*^9}, {3.8972314053369617`*^9, 3.8972314058376513`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"2b0c5ecf-637e-42d4-8c72-\
c549a93b78a3"],

Cell[CellGroupData[{

Cell["BL distributions", "Section",
 CellChangeTimes->{{3.8850207275443482`*^9, 3.885020730624566*^9}, 
   3.8850217020674453`*^9, {3.8851404135605536`*^9, 3.8851404142703238`*^9}, 
   3.885966942012986*^9, 3.8868216621554785`*^9, 3.8941030481927843`*^9},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"94820fe4-9ed1-49db-9902-\
baab0aff5d85"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Check", " ", "if", " ", "all", " ", "distributions", " ", "generated", 
    " ", "by", " ", "Module", " ", "2", " ", "are", " ", "present"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"BLDistributionFileNames", ":=", 
    RowBox[{"Association", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<DoubleDistr-B-L-from-omega-FermilabBD.dat\>\"", ",", 
          "\"\<DoubleDistr-B-Ls-From-Eta-FermilabBD.dat\>\"", ",", 
          "\"\<DoubleDistr-B-Ls-From-Etapr-FermilabBD.dat\>\"", ",", 
          "\"\<DoubleDistr-B-Ls-From-pi0-FermilabBD.dat\>\""}], "}"}]}], ",", 
       RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<DoubleDistr-B-L-from-omega-FCC-hh.dat\>\"", ",", 
          "\"\<DoubleDistr-B-Ls-From-Eta-FCC-hh.dat\>\"", ",", 
          "\"\<DoubleDistr-B-Ls-From-Etapr-FCC-hh.dat\>\"", ",", 
          "\"\<DoubleDistr-B-Ls-From-pi0-FCC-hh.dat\>\""}], "}"}]}], ",", 
       RowBox[{"\"\<LHC\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<DoubleDistr-B-L-from-omega-LHC.dat\>\"", ",", 
          "\"\<DoubleDistr-B-Ls-From-Eta-LHC.dat\>\"", ",", 
          "\"\<DoubleDistr-B-Ls-From-Etapr-LHC.dat\>\"", ",", 
          "\"\<DoubleDistr-B-Ls-From-pi0-LHC.dat\>\""}], "}"}]}], ",", 
       RowBox[{"\"\<SPS\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<DoubleDistr-B-L-from-omega-SPS.dat\>\"", ",", 
          "\"\<DoubleDistr-B-Ls-From-Eta-SPS.dat\>\"", ",", 
          "\"\<DoubleDistr-B-Ls-From-Etapr-SPS.dat\>\"", ",", 
          "\"\<DoubleDistr-B-Ls-From-pi0-SPS.dat\>\""}], "}"}]}]}], "}"}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BLDistributionFileNamesGivenExp", "=", 
     RowBox[{
     "BLDistributionFileNames", "[", "FacilityGivenExperiment", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"TrueQ", "@", 
         RowBox[{"FileExistsQ", "@", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"NotebookDirectory", "[", "]"}], ",", 
             "\"\<spectra/New physics particles spectra/B-L/\>\"", ",", 
             RowBox[{"BLDistributionFileNamesGivenExp", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], "}"}], "]"}]}]}]}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
         RowBox[{"BLDistributionFileNamesGivenExp", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ",", 
         "\"\< does not exist Generate it using module 2!\>\""}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", "BLDistributionFileNamesGivenExp", "]"}], ",", 
       "1"}], "}"}]}], "]"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{
  3.88502354836834*^9, {3.8850295938036337`*^9, 3.885029595916194*^9}, {
   3.8851404366578946`*^9, 3.8851404845456142`*^9}, {3.885438338435359*^9, 
   3.8854384585798616`*^9}, 3.8855484092677927`*^9, {3.8859669420224924`*^9, 
   3.885966942043624*^9}, {3.885967092081048*^9, 3.8859671770851784`*^9}, {
   3.886761322142398*^9, 3.8867613222054567`*^9}, {3.8867613568657713`*^9, 
   3.8867614253781595`*^9}, {3.886761460228565*^9, 3.886761478517923*^9}, {
   3.886821662166826*^9, 3.886821662171852*^9}, {3.887617836095932*^9, 
   3.887617844975481*^9}, {3.8922841186539793`*^9, 3.8922841611745014`*^9}, {
   3.8922842075951023`*^9, 3.8922842229448953`*^9}, {3.893520967515341*^9, 
   3.893520967523321*^9}, {3.8941030482037544`*^9, 3.894103048237294*^9}, {
   3.8941195683630495`*^9, 3.89411963016094*^9}, {3.8941196636192646`*^9, 
   3.8941196900770884`*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[146]:=",ExpressionUUID->"326b39eb-4dc5-4af4-9b14-cae30fe2ccc8"],

Cell[CellGroupData[{

Cell["Importing distributions", "Subsection",
 CellChangeTimes->{{3.885021707174692*^9, 3.8850217096287813`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"242c9d2b-8dc7-4cea-b5e4-\
45807660d765"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Relevant", " ", "production", " ", "channels"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ProductionList", "=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\"\<\[Omega]\>\"", ",", "\"\<\[Eta]\>\"", ",", "\"\<\[Eta]'\>\"", 
        ",", "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\""}], "}"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FacilityGivenExperiment", "\[NotEqual]", "\"\<FCC-hh\>\""}], 
        ",", 
        RowBox[{"{", "\"\<Drell-Yan\>\"", "}"}], ",", 
        RowBox[{"{", "}"}]}], "]"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"\[Theta]minExp", "<", 
         RowBox[{
         "\[Theta]maxBremFacility", "[", "FacilityGivenExperiment", "]"}]}], 
        ",", 
        RowBox[{"{", "\"\<Brem\>\"", "}"}], ",", 
        RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"ListExport", ":=", 
    RowBox[{"Association", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<\[Omega]\>\"", "->", "\"\<Omega\>\""}], ",", 
       RowBox[{"\"\<\[Eta]\>\"", "->", "\"\<Eta\>\""}], ",", 
       RowBox[{
       "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", "->", 
        "\"\<Pi0\>\""}], ",", 
       RowBox[{"\"\<\[Eta]'\>\"", "->", "\"\<Etapr\>\""}], ",", 
       RowBox[{"\"\<Drell-Yan\>\"", "->", "\"\<DrellYan\>\""}], ",", 
       RowBox[{"\"\<Brem\>\"", "->", "\"\<Brem\>\""}]}], "}"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DoubleDistrBLfromBremDat", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"\[Theta]minExp", "<", 
        RowBox[{
        "\[Theta]maxBremFacility", "[", "FacilityGivenExperiment", "]"}]}], 
       ",", 
       RowBox[{"TableBremDistr", "[", 
        RowBox[{
        "\[Theta]minExp", ",", "\[Theta]maxExp", ",", 
         "FacilityGivenExperiment"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dataDistr", "[", "filename_", "]"}], ":=", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], ",", 
         "\"\<spectra/New physics particles spectra/B-L/\>\"", ",", 
         "filename"}], "}"}], "]"}], ",", "\"\<Table\>\""}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"DataDistrBL", "[", "\"\<\[Omega]\>\"", "]"}], ",", 
       RowBox[{"DataDistrBL", "[", "\"\<\[Eta]\>\"", "]"}], ",", 
       RowBox[{"DataDistrBL", "[", "\"\<\[Eta]'\>\"", "]"}], ",", 
       RowBox[{
       "DataDistrBL", "[", "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"",
         "]"}], ",", 
       RowBox[{"DataDistrBL", "[", "\"\<Drell-Yan\>\"", "]"}], ",", 
       RowBox[{"DataDistrBL", "[", "\"\<Brem\>\"", "]"}]}], "}"}], "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"dataDistr", "[", 
          RowBox[{"BLDistributionFileNamesGivenExp", "[", 
           RowBox[{"[", "#", "]"}], "]"}], "]"}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
           "FacilityGivenExperiment", "\[NotEqual]", "\"\<FCC-hh\>\""}], ",", 
           RowBox[{"Import", "[", 
            RowBox[{
             RowBox[{"FileNameJoin", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"NotebookDirectory", "[", "]"}], ",", 
                "\"\<spectra/New physics particles \
spectra/B-L/Pregenerated/\>\"", ",", 
                RowBox[{"ToString", "@", 
                 RowBox[{"StringForm", "[", 
                  RowBox[{"\"\<DoubleDistrB-LDrellYan-``.txt\>\"", ",", 
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"{", "FacilityGivenExperiment", "}"}]}]}], "]"}]}]
                 }], "}"}], "]"}], ",", "\"\<Table\>\""}], "]"}]}], "]"}], 
         ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"\[Theta]minExp", "<", 
            RowBox[{
            "\[Theta]maxBremFacility", "[", "FacilityGivenExperiment", 
             "]"}]}], ",", "DoubleDistrBLfromBremDat"}], "]"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Probability", " ", "to", " ", "produce", " ", "the", " ", "BL", " ", 
     "per", " ", "PoT", " ", "at", " ", "the", " ", "given", " ", 
     "facility"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Chi]Xtimes\[Chi]XtoBLall", "[", 
        RowBox[{"mV_", ",", "\[Alpha]B_", ",", "\"\<\[Omega]\>\""}], "]"}], 
       ",", 
       RowBox[{"\[Chi]Xtimes\[Chi]XtoBLall", "[", 
        RowBox[{"mV_", ",", "\[Alpha]B_", ",", "\"\<\[Eta]\>\""}], "]"}], ",", 
       RowBox[{"\[Chi]Xtimes\[Chi]XtoBLall", "[", 
        RowBox[{"mV_", ",", "\[Alpha]B_", ",", "\"\<\[Eta]'\>\""}], "]"}], 
       ",", 
       RowBox[{"\[Chi]Xtimes\[Chi]XtoBLall", "[", 
        RowBox[{
        "mV_", ",", "\[Alpha]B_", ",", 
         "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\""}], "]"}], ",", 
       RowBox[{"\[Chi]Xtimes\[Chi]XtoBLall", "[", 
        RowBox[{"mV_", ",", "\[Alpha]B_", ",", "\"\<Drell-Yan\>\""}], "]"}], 
       ",", 
       RowBox[{"\[Chi]Xtimes\[Chi]XtoBLall", "[", 
        RowBox[{"mV_", ",", "\[Alpha]B_", ",", "\"\<Brem\>\""}], "]"}]}], 
      "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Chi]Xprod", "[", "\"\<\[Omega]\>\"", "]"}], "*", 
        RowBox[{"\[Theta]BL\[Omega]2", "[", 
         RowBox[{"mV", ",", "\[Alpha]B"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"\[Chi]Xprod", "[", "\"\<\[Eta]\>\"", "]"}], "*", 
        RowBox[{"BrDecay", "[", 
         RowBox[{"mV", ",", "\[Alpha]B", ",", "\"\<\[Eta]\>\""}], "]"}]}], 
       ",", 
       RowBox[{
        RowBox[{"\[Chi]Xprod", "[", "\"\<\[Eta]'\>\"", "]"}], "*", 
        RowBox[{"BrDecay", "[", 
         RowBox[{"mV", ",", "\[Alpha]B", ",", "\"\<\[Eta]'\>\""}], "]"}]}], 
       ",", 
       RowBox[{
        RowBox[{
        "\[Chi]Xprod", "[", 
         "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", "]"}], "*", 
        RowBox[{"BrDecay", "[", 
         RowBox[{
         "mV", ",", "\[Alpha]B", ",", 
          "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\""}], "]"}]}], ",", 
       RowBox[{"PDrellYanFacility", "[", 
        RowBox[{
        "mV", ",", "\[Alpha]B", ",", "AtargetVal", ",", 
         "FacilityGivenExperiment"}], "]"}], ",", 
       RowBox[{"PbremFacility", "[", 
        RowBox[{"mV", ",", "\[Alpha]B", ",", "FacilityGivenExperiment"}], 
        "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Probability", " ", "to", " ", "produce", " ", "the", " ", "BL", " ", 
      "per", " ", "PoT"}], " ", "-", " ", 
     RowBox[{
     "only", " ", "the", " ", "relevant", " ", "production", " ", 
      "channels"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Chi]Xtimes\[Chi]XtoBL", "[", 
        RowBox[{"mV_", ",", "\[Alpha]B_", ",", "prod"}], "]"}], "=", 
       RowBox[{"\[Chi]Xtimes\[Chi]XtoBLall", "[", 
        RowBox[{"mV", ",", "\[Alpha]B", ",", "prod"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mlistBL", "[", "prod", "]"}], "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{
         RowBox[{"DataDistrBL", "[", "prod", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"mBLmin", "[", "prod", "]"}], ",", 
         RowBox[{"mBLmax", "[", "prod", "]"}]}], "}"}], "=", 
       RowBox[{"MinMax", "[", 
        RowBox[{"mlistBL", "[", "prod", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DoubleDistrBL", "[", 
        RowBox[{"mV_", ",", "\[Theta]V_", ",", "EV_", ",", "prod"}], "]"}], 
       "=", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Interpolation", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Log10", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                RowBox[{"Log10", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                RowBox[{"Log10", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
                RowBox[{"Log10", "[", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "4", "]"}], "]"}], "+", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "80"}]]}], "]"}]}], "}"}], "&"}], "/@", 
             RowBox[{"DataDistrBL", "[", "prod", "]"}]}], ",", 
            RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
          RowBox[{
           RowBox[{"Log10", "[", "mV", "]"}], ",", 
           RowBox[{"Log10", "[", "\[Theta]V", "]"}], ",", 
           RowBox[{"Log10", "[", "EV", "]"}]}], "]"}], ")"}]}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"LogLogPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"\[Chi]Xtimes\[Chi]XtoBL", "[", 
         RowBox[{"mV", ",", "1", ",", "prod"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"mV", ",", "0.05", ",", "3"}], "}"}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox["10", 
           RowBox[{"-", "5"}]], ",", 
          SuperscriptBox["10", "6"]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"Placed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"#", ",", "15"}], "]"}], "&"}], "/@", "ProductionList"}], 
        ",", "Right"}], "]"}]}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<Auxiliary data/B-3Le-Lmu+Ltau\>\"", ",", "SelectedExperiment", 
        ",", "\"\<Double-Distr-Averaged-B-3Le-Lmu+Ltau.m\>\""}], "}"}], "]"}],
      ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"mBLmin", "[", "prod", "]"}], "<", "mV", "<", 
            RowBox[{"mBLmax", "[", "prod", "]"}]}], ",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"\[Chi]Xtimes\[Chi]XtoBL", "[", 
             RowBox[{"mV", ",", "1", ",", "prod"}], "]"}], "]"}], ",", "0"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ",", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"mBLmin", "[", "prod", "]"}], "<", "mV", "<", 
              RowBox[{"mBLmax", "[", "prod", "]"}]}], ",", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"\[Chi]Xtimes\[Chi]XtoBL", "[", 
               RowBox[{"mV", ",", "1", ",", "prod"}], "]"}], "]"}], ",", 
             "0"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}]], 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"mBLmin", "[", "prod", "]"}], "<", "mV", "<", 
             RowBox[{"mBLmax", "[", "prod", "]"}]}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{
              RowBox[{"\[Chi]Xtimes\[Chi]XtoBL", "[", 
               RowBox[{"mV", ",", "1", ",", "prod"}], "]"}], "*", 
              RowBox[{"DoubleDistrBL", "[", 
               RowBox[{"mV", ",", "\[Theta]V", ",", "EV", ",", "prod"}], 
               "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}]}]}], "}"}],
      ",", "\"\<MX\>\""}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.892175110512329*^9, 3.892175187706853*^9}, {
   3.892175262677436*^9, 3.89217542245819*^9}, {3.8921754590608096`*^9, 
   3.8921754632859516`*^9}, {3.8921755362226534`*^9, 3.892175552384869*^9}, {
   3.892176052715619*^9, 3.892176054811057*^9}, {3.8921766986049976`*^9, 
   3.892176780057205*^9}, {3.892177011617763*^9, 3.892177128339795*^9}, {
   3.8921771726808753`*^9, 3.8921771941877666`*^9}, {3.892177231182993*^9, 
   3.8921774497314568`*^9}, {3.89217752488566*^9, 3.89217757833836*^9}, 
   3.892177684630415*^9, 3.892178704548239*^9, 3.8921789864543605`*^9, {
   3.8921790672783995`*^9, 3.892179069727179*^9}, {3.892179114510329*^9, 
   3.8921793148284245`*^9}, {3.8921795817634134`*^9, 
   3.8921797716855927`*^9}, {3.892179805150119*^9, 3.8921798964263496`*^9}, {
   3.892179927104117*^9, 3.892179953835002*^9}, {3.892180176263763*^9, 
   3.892180210694174*^9}, {3.8921803243722267`*^9, 3.892180352393804*^9}, {
   3.8921805106510096`*^9, 3.892180519140444*^9}, {3.8921806010546556`*^9, 
   3.892180639074503*^9}, {3.892181248222723*^9, 3.8921813865122576`*^9}, {
   3.892187680319851*^9, 3.8921876806217422`*^9}, {3.8922765048251705`*^9, 
   3.8922765053459935`*^9}, {3.8922841059540906`*^9, 3.892284115944186*^9}, {
   3.892284228045306*^9, 3.892284228521356*^9}, 3.893473823411297*^9, {
   3.8934753001632338`*^9, 3.8934753074207487`*^9}, {3.8934754132851887`*^9, 
   3.8934754159519143`*^9}, 3.89347554049979*^9, {3.8934970353175297`*^9, 
   3.8934971039914875`*^9}, 3.893520967544777*^9, {3.893602084526437*^9, 
   3.893602106478526*^9}, {3.893604980872145*^9, 3.893604987105053*^9}, {
   3.8941029906265383`*^9, 3.894102990689848*^9}, {3.8941030482458115`*^9, 
   3.894103048352297*^9}, 3.894119120555811*^9, {3.8941196264768553`*^9, 
   3.8941196264828405`*^9}, {3.89411969787547*^9, 3.894119707141576*^9}, {
   3.894124983980919*^9, 3.894124984437088*^9}, {3.8941250316068296`*^9, 
   3.8941250319991283`*^9}, {3.8941789734602256`*^9, 
   3.8941789738628817`*^9}, {3.8951284968407307`*^9, 3.895128546442171*^9}, 
   3.895128739966262*^9, {3.8972312827670393`*^9, 3.8972312904184003`*^9}, {
   3.90272785996622*^9, 3.902727886644924*^9}, {3.9027279304971423`*^9, 
   3.902727966612608*^9}, {3.902887741464586*^9, 3.9028877447413497`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"c68655f5-4ba7-45b7-a70e-\
eb18f7ab3776"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8955573468100166`*^9, 3.895557444604183*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[157]:=",ExpressionUUID->"2ea69e6b-61be-4500-8f1b-6304499ba3b9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Determining min/max energies of scalars for the given polar angle. Needed for \
stability of Monte-Carlo integration\
\>", "Subsection",
 CellChangeTimes->{{3.8850217140541673`*^9, 3.8850217339343953`*^9}, {
  3.885449618401306*^9, 3.8854496389805627`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"14a3864a-8923-4412-bbcd-\
65b446371328"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"EfromXmax", "[", 
   RowBox[{"mass_", ",", "data_", ",", "LogMin_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "distr", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"datt", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"data", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "mass"}], "&"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"EmaxVal", "=", 
      RowBox[{
       RowBox[{"datt", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "3"}], "]"}], "]"}], "//", "Max"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"EminVal", "=", 
      RowBox[{
       RowBox[{"datt", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "3"}], "]"}], "]"}], "//", "Min"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Theta]list", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"x", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "\[Theta]minExp", ",", "\[Theta]maxExp", ",", 
          FractionBox[
           RowBox[{"(", 
            RowBox[{"\[Theta]maxExp", "-", "\[Theta]minExp"}], ")"}], "5"]}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"distr", "[", 
       RowBox[{"\[Theta]fip_", ",", "Efip_"}], "]"}], "=", 
      RowBox[{"Abs", "[", 
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", "3", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "4", "]"}], "]"}], "+", 
                SuperscriptBox["10", 
                 RowBox[{"-", "90"}]]}]}], "}"}], "&"}], "/@", "datt"}], ",", 
           RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
         RowBox[{"\[Theta]fip", ",", "Efip"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DoubleDistrIntList", "[", "i_", "]"}], ":=", 
      RowBox[{
       RowBox[{"Interpolation", "[", 
        RowBox[{
         RowBox[{"ParallelTable", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Efip", ",", 
             RowBox[{"Quiet", "[", 
              RowBox[{"NIntegrate", "[", 
               RowBox[{
                RowBox[{"distr", "[", 
                 RowBox[{"\[Theta]fip", ",", "Efip"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"\[Theta]fip", ",", 
                  RowBox[{"\[Theta]list", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", 
                  RowBox[{"\[Theta]list", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"Method", "\[Rule]", "\"\<AdaptiveMonteCarlo\>\""}]}],
                "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Efip", ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               SuperscriptBox["10", "x"], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{"Log10", "[", 
                  RowBox[{"1.1", "*", "mass"}], "]"}], ",", 
                 RowBox[{"Log10", "[", "EmaxVal", "]"}], ",", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"Log10", "[", "EmaxVal", "]"}], "-", 
                   RowBox[{"Log10", "[", 
                    RowBox[{"1.1", "*", "mass"}], "]"}]}], "50."]}], "}"}]}], 
              "]"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "Efip",
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]fipdistrlist", "[", "Efip_", "]"}], "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"\[Theta]list", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "+", 
            RowBox[{"\[Theta]list", "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "2"], ",", 
          RowBox[{"DoubleDistrIntList", "[", "i", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{
           RowBox[{"Length", "[", "\[Theta]list", "]"}], "-", "1"}], ",", 
          "1"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Theta]EmaxList", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"\[Theta]fipdistrlist", "[", "Efip", "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"SortBy", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Efip", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Theta]fipdistrlist", "[", "Efip", "]"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Efip", ",", "mass", ",", "EmaxVal", ",", "1"}], 
                 "}"}]}], "]"}], ",", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"\[Theta]fipdistrlist", "[", "Efip", "]"}], "]"}], ",", 
          "1"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]EmaxListInt", "[", "\[Theta]fip_", "]"}], "=", 
      RowBox[{
       RowBox[{"Interpolation", "[", 
        RowBox[{"\[Theta]EmaxList", ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
       "\[Theta]fip", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"NormVals", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"\[Theta]fipdistrlist", "[", "Efip", "]"}], "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", 
           SuperscriptBox["10", 
            RowBox[{"-", "90."}]]}], ",", 
          RowBox[{"{", 
           RowBox[{"Efip", ",", "mass", ",", "EmaxVal"}], "}"}], ",", 
          RowBox[{
          "Method", "\[Rule]", "\"\<InterpolationPointsSubdivision\>\""}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"\[Theta]fipdistrlist", "[", "Efip", "]"}], "]"}], ",", 
          "1"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cdf", "[", 
       RowBox[{"es_", ",", "i_"}], "]"}], ":=", 
      RowBox[{"1", "-", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"NormVals", "[", 
          RowBox[{"[", "i", "]"}], "]"}]], 
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"\[Theta]fipdistrlist", "[", "Efip", "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"Efip", ",", "mass", ",", "es"}], "}"}], ",", 
          RowBox[{
          "Method", "\[Rule]", "\"\<InterpolationPointsSubdivision\>\""}]}], 
         "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cdftab", "[", "Efip_", "]"}], "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"\[Theta]fipdistrlist", "[", "Efip", "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"Interpolation", "[", 
            RowBox[{
             RowBox[{"ParallelTable", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"10", "^", "es"}], ",", 
                 RowBox[{"Quiet", "[", 
                  RowBox[{"cdf", "[", 
                   RowBox[{
                    RowBox[{"10", "^", "es"}], ",", "i"}], "]"}], "]"}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"es", ",", 
                 RowBox[{"Log10", "[", "mass", "]"}], ",", 
                 RowBox[{"Log10", "[", "EmaxVal", "]"}], ",", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"Log10", "[", "EmaxVal", "]"}], "-", 
                   RowBox[{"Log10", "[", "mass", "]"}]}], "50"]}], "}"}]}], 
              "]"}], ",", 
             RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
           "Efip", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"\[Theta]fipdistrlist", "[", "Efip", "]"}], "]"}], ",", 
          "1"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"logmin", "[", "\[Theta]fip_", "]"}], "=", "LogMin"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Estart", "[", "\[Theta]fip_", "]"}], "=", 
      RowBox[{"Min", "[", 
       RowBox[{
        RowBox[{"2", "*", 
         RowBox[{"\[Theta]EmaxListInt", "[", "\[Theta]fip", "]"}]}], ",", 
        RowBox[{"0.9", "*", "EmaxVal"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Emaxv", "[", "i_", "]"}], ":=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"NormVals", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "<", 
         SuperscriptBox["10", 
          RowBox[{"-", "15"}]]}], ",", "mass", ",", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"Efip", "/.", 
           RowBox[{"FindRoot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Log10", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"cdftab", "[", 
                  SuperscriptBox["10", "Efip"], "]"}], "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], "\[Equal]", 
              RowBox[{"logmin", "[", 
               RowBox[{
                RowBox[{"\[Theta]EmaxList", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"Efip", ",", 
               RowBox[{"Log10", "[", 
                RowBox[{"Estart", "[", 
                 RowBox[{
                  RowBox[{"\[Theta]EmaxList", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"Log10", "[", 
                RowBox[{
                 RowBox[{"\[Theta]EmaxList", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
               RowBox[{"Log10", "[", "EmaxVal", "]"}]}], "}"}]}], "]"}]}], 
          ")"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tabtemp", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Theta]EmaxList", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"Emaxv", "[", "i", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "\[Theta]EmaxList", "]"}], ",", "1"}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tab", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"\[Theta]minExp", ",", 
           RowBox[{
            RowBox[{"tabtemp", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "}"}], ",", 
        RowBox[{"Drop", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{"tabtemp", ",", "1"}], "]"}], ",", 
          RowBox[{"-", "1"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"\[Theta]maxExp", ",", 
           RowBox[{
            RowBox[{"tabtemp", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"10", "^", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Log10", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
              RowBox[{"Log10", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
           "tab"}], ",", 
          RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
        RowBox[{"Log10", "[", "\[Theta]fip", "]"}], "]"}], ")"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EmaxBlock", "[", 
   RowBox[{"data_", ",", "logmin_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "mlist", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mlist", "=", 
      RowBox[{"Drop", "[", 
       RowBox[{
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"EmaxTemp", "[", 
       RowBox[{"m_", ",", "\[Theta]_"}], "]"}], "=", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"m", ",", 
         RowBox[{"EfromXmax", "[", 
          RowBox[{
           RowBox[{"mlist", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "data", ",", "logmin"}], 
          "]"}], ",", 
         RowBox[{"EfromXmax", "[", 
          RowBox[{
           RowBox[{"mlist", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}], ",", "data", ",", "logmin"}], 
          "]"}]}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{"\[Theta]fip", "\[Rule]", "\[Theta]"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Theta]list1", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"x", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "\[Theta]minExp", ",", "\[Theta]maxExp", ",", 
          FractionBox[
           RowBox[{"(", 
            RowBox[{"\[Theta]maxExp", "-", "\[Theta]minExp"}], ")"}], "10"]}],
          "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"10", "^", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"Log10", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
              RowBox[{"Log10", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"mfip", ",", "\[Theta]fip", ",", 
                 RowBox[{"EmaxTemp", "[", 
                  RowBox[{"mfip", ",", "\[Theta]fip"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"mfip", ",", 
                 RowBox[{"mlist", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"mlist", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"mlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"mlist", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", "10"}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"\[Theta]fip", ",", "\[Theta]list1"}], "}"}]}], "]"}],
              ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ",", 
          RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
        RowBox[{"mfip", ",", 
         RowBox[{"Log10", "[", "\[Theta]fip", "]"}]}], "]"}], ")"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"EBLmax", "[", 
      RowBox[{"mfip_", ",", "\[Theta]fip_", ",", "prod"}], "]"}], "=", 
     RowBox[{"EmaxBlock", "[", 
      RowBox[{
       RowBox[{"DataDistrBL", "[", "prod", "]"}], ",", 
       RowBox[{"-", "7"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"prod", ",", 
      RowBox[{"Select", "[", 
       RowBox[{"ProductionList", ",", 
        RowBox[{
         RowBox[{"#", "\[NotEqual]", "\"\<Brem\>\""}], "&"}]}], "]"}]}], 
     "}"}]}], "]"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"\[Theta]minExp", "<", 
    RowBox[{
    "\[Theta]maxBremFacility", "[", "FacilityGivenExperiment", "]"}]}], ",", 
   RowBox[{
    RowBox[{"EBLmax", "[", 
     RowBox[{"mfip_", ",", "\[Theta]fip_", ",", "\"\<Brem\>\""}], "]"}], "=", 
    RowBox[{
     RowBox[{"Interpolation", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Log10", "[", "\[Theta]fip", "]"}], ",", 
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"zMinBrem", "[", "FacilityGivenExperiment", "]"}], "*", 
              RowBox[{"Ppfacility", "[", "FacilityGivenExperiment", "]"}]}], 
             ",", 
             RowBox[{"Min", "[", 
              RowBox[{
               FractionBox["pTmaxBrem", 
                RowBox[{"Sin", "[", "\[Theta]fip", "]"}]], ",", 
               RowBox[{"zMaxBrem", "*", 
                RowBox[{
                "Ppfacility", "[", "FacilityGivenExperiment", "]"}]}]}], 
              "]"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Theta]fip", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             SuperscriptBox["10", "x"], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"Log10", "[", "\[Theta]minExp", "]"}], ",", 
               RowBox[{"Log10", "[", "\[Theta]maxExp", "]"}], ",", 
               FractionBox[
                RowBox[{
                 RowBox[{"Log10", "[", "\[Theta]maxExp", "]"}], "-", 
                 RowBox[{"Log10", "[", "\[Theta]minExp", "]"}]}], "10."]}], 
              "}"}]}], "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
     RowBox[{"Log10", "[", "\[Theta]fip", "]"}], "]"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"LogLogPlot", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"EBLmax", "[", 
       RowBox[{"0.1", ",", "\[Theta]V", ",", "prod"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Theta]V", ",", "\[Theta]minExp", ",", "\[Theta]maxExp"}], 
    "}"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(V\)]\) [rad]\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(E\), \(V, max\)]\) [GeV]\>\""}], "}"}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
   RowBox[{"FrameStyle", "\[Rule]", 
    RowBox[{"Directive", "[", 
     RowBox[{"Black", ",", " ", "22"}], "]"}]}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"PlotLabel", "\[Rule]", " ", 
    RowBox[{"Style", "[", 
     RowBox[{
     "\"\<B-3\!\(\*SubscriptBox[\(L\), \(e\)]\)-\!\(\*SubscriptBox[\(L\), \(\
\[Mu]\)]\)+\!\(\*SubscriptBox[\(L\), \(\[Tau]\)]\)\>\"", ",", " ", "20", ",", 
      " ", "Black"}], "]"}]}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"Placed", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"#", ",", " ", "18"}], "]"}], "&"}], "/@", 
        "ProductionList"}], "}"}], ",", "Right"}], "]"}]}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.0045", "]"}], ",", "Blue"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.0045", "]"}], ",", 
        RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.0045", "]"}], ",", 
        RowBox[{"Darker", "@", 
         RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.0045", "]"}], ",", 
        RowBox[{"Darker", "@", "Cyan"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.0045", "]"}], ",", "Magenta"}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.0045", "]"}], ",", "Black"}], "}"}]}], 
     "}"}]}], ",", 
   RowBox[{"GridLines", "\[Rule]", "Automatic"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.892180437116329*^9, 3.892180448940724*^9}, {
   3.8927056140425315`*^9, 3.892705614364416*^9}, {3.893474227194661*^9, 
   3.893474234046297*^9}, {3.89360114734174*^9, 3.893601242874528*^9}, {
   3.8937482039850693`*^9, 3.893748257885649*^9}, {3.8937486366888*^9, 
   3.8937486430759726`*^9}, {3.8937487667264657`*^9, 3.893748820021937*^9}, 
   3.8937489303926973`*^9, {3.893749023509144*^9, 3.893749039550362*^9}, {
   3.893749081425769*^9, 3.8937490840023003`*^9}, {3.8937491543033047`*^9, 
   3.893749226158144*^9}, {3.893749381272199*^9, 3.893749384430477*^9}, {
   3.8937495085896387`*^9, 3.893749661560362*^9}, {3.893749692026283*^9, 
   3.8937496924853573`*^9}, 3.893749786796824*^9, {3.893749850348592*^9, 
   3.893749866625471*^9}, {3.8937500021671023`*^9, 3.8937500483345733`*^9}, {
   3.8941030483577967`*^9, 3.894103048362805*^9}, {3.8963339711925063`*^9, 
   3.896333978642987*^9}, {3.897231301726222*^9, 3.897231301927331*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[158]:=",ExpressionUUID->"efd77778-60aa-478f-b3d8-cf711a70f74f"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Number of events", "Chapter",
 CellChangeTimes->{{3.8935731783578434`*^9, 3.893573180246764*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"3fad0b29-bda7-4b7e-8f8e-\
8517f7262dd1"],

Cell[CellGroupData[{

Cell["Definitions", "Section",
 CellChangeTimes->{{3.897198873663946*^9, 3.8971988750678434`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"418b0952-2e9a-456b-a8ef-\
78547bcc5f0b"],

Cell[CellGroupData[{

Cell["\<\
Grids for the initial data with acceptances and distributions\
\>", "Subsection",
 CellChangeTimes->{{3.897198934328184*^9, 3.89719895293719*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"db5e4d17-f371-4aa3-8311-\
31007c7c1c41"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Grid", " ", 
     SubscriptBox["m", "S"]}], ",", " ", 
    SubscriptBox["\[Theta]", "S"], ",", " ", 
    SubscriptBox["E", "S"], ",", " ", 
    RowBox[{
     SubscriptBox["z", "S"], " ", "for", " ", "the", " ", "initial", " ", 
     "acceptance", " ", "data"}], ",", " ", "logarithmized"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"InGridm\[Epsilon]", "=", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"FullAcceptanceData", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InGrid\[Theta]\[Epsilon]", "=", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"FullAcceptanceData", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InGridE\[Epsilon]", "=", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"FullAcceptanceData", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InGridz\[Epsilon]", "=", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"FullAcceptanceData", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Array", " ", "of", " ", "values", " ", "of", " ", "the", " ", "initial",
       " ", "acceptance", " ", "data"}], ",", " ", "reshaped"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Epsilon]vals", "=", 
     RowBox[{"ArrayReshape", "[", 
      RowBox[{
       RowBox[{"FullAcceptanceData", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "5"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Length", "[", "InGridm\[Epsilon]", "]"}], ",", 
         RowBox[{"Length", "[", "InGrid\[Theta]\[Epsilon]", "]"}], ",", 
         RowBox[{"Length", "[", "InGridE\[Epsilon]", "]"}], ",", 
         RowBox[{"Length", "[", "InGridz\[Epsilon]", "]"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Epsilon]azValscomp", "=", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"data", ",", "_Real", ",", "2"}], "}"}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"data", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "5", "]"}], "]"}], "==", "0"}], ",", 
           RowBox[{"-", "90."}], ",", 
           RowBox[{"Log10", "[", 
            RowBox[{
             RowBox[{"data", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "5", "]"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "data", "]"}], ",", "1"}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
       RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Epsilon]azvals", "=", 
     RowBox[{"ArrayReshape", "[", 
      RowBox[{
       RowBox[{"\[Epsilon]azValscomp", "[", "FullAcceptanceData0", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Length", "[", "InGridm\[Epsilon]", "]"}], ",", 
         RowBox[{"Length", "[", "InGrid\[Theta]\[Epsilon]", "]"}], ",", 
         RowBox[{"Length", "[", "InGridE\[Epsilon]", "]"}], ",", 
         RowBox[{"Length", "[", "InGridz\[Epsilon]", "]"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
     "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
     "___", "__"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Grid", " ", 
      SubscriptBox["m", "S"]}], ",", " ", 
     SubscriptBox["\[Theta]", "S"], ",", " ", 
     RowBox[{
      SubscriptBox["E", "S"], " ", "for", " ", "the", " ", "initial", " ", 
      "FIP", " ", "distribution", " ", "data"}], ",", " ", "logarithmized"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"DataLogarithmiedComp", "=", 
    RowBox[{
     RowBox[{"Hold", "@", 
      RowBox[{"Compile", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"data", ",", "_Real", ",", "2"}], "}"}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"data", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "4", "]"}], "]"}], "\[Equal]", "0"}], ",", 
            RowBox[{"-", "90."}], ",", 
            RowBox[{"Log10", "[", 
             RowBox[{
              RowBox[{"data", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "4", "]"}], "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "data", "]"}], ",", "1"}], "}"}]}], "]"}], 
        ",", 
        RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
        RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}]}], "//",
      "ReleaseHold"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockGridsValsDistr", "[", "ProdChannel_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"GridIn", ",", "vals"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"GridIn", "=", 
        RowBox[{
         RowBox[{"Log10", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{
              RowBox[{"DataDistrBL", "[", "ProdChannel", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "#"}], "]"}], "]"}], "]"}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}], "//", "N"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"vals", "=", 
        RowBox[{"ArrayReshape", "[", 
         RowBox[{
          RowBox[{"DataLogarithmiedComp", "[", 
           RowBox[{"DataDistrBL", "[", "ProdChannel", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"GridIn", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
            RowBox[{"Length", "[", 
             RowBox[{"GridIn", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
            RowBox[{"Length", "[", 
             RowBox[{"GridIn", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"GridIn", ",", "vals"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"GridInFinal", "[", "prod", "]"}], ",", 
          RowBox[{"DistrVals", "[", "prod", "]"}]}], "}"}], "=", 
        RowBox[{"BlockGridsValsDistr", "[", "prod", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";"}], "//", 
    "AbsoluteTiming"}]}]}]], "Input",
 CellChangeTimes->{{3.897199659637949*^9, 3.8971996790804834`*^9}, {
   3.897208285005845*^9, 3.8972083314493256`*^9}, 3.89720836608294*^9, {
   3.897229155012*^9, 3.89722915871517*^9}, {3.8972291920059643`*^9, 
   3.8972291927603445`*^9}, {3.8972308406696515`*^9, 3.8972308411108437`*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[163]:=",ExpressionUUID->"2f3d25d9-523e-4ee7-93f7-08039734efda"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Grid to be used to calculate the number of events", "Subsection",
 CellChangeTimes->{{3.8971989779703307`*^9, 3.8971989844379535`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"1b7a61a8-6485-4f40-a96e-\
fbb6bbf90301"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Grid", " ", 
     SubscriptBox["\[Theta]", "S"]}], ",", " ", 
    RowBox[{
     SubscriptBox["z", "S"], " ", "for", " ", "the", " ", "final", " ", 
     "acceptance", " ", "data"}], ",", " ", "logarithmized"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"OutGrid\[Theta]final", "=", 
     RowBox[{"(*", "InGrid\[Theta]\[Epsilon]", "*)"}], 
     RowBox[{"Log10", "[", 
      RowBox[{"Table", "[", 
       RowBox[{"x", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"10", "^", 
           RowBox[{"Min", "[", "InGrid\[Theta]\[Epsilon]", "]"}]}], ",", 
          RowBox[{"10", "^", 
           RowBox[{"Max", "[", "InGrid\[Theta]\[Epsilon]", "]"}]}], ",", 
          FractionBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"10", "^", 
              RowBox[{"Max", "[", "InGrid\[Theta]\[Epsilon]", "]"}]}], "-", 
             RowBox[{"10", "^", 
              RowBox[{"Min", "[", "InGrid\[Theta]\[Epsilon]", "]"}]}]}], 
            ")"}], "30"]}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"OutGridzfinal", "=", 
     RowBox[{"Log10", "[", 
      RowBox[{"Table", "[", 
       RowBox[{"x", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          SuperscriptBox["10", 
           RowBox[{"InGridz\[Epsilon]", "[", 
            RowBox[{"[", "1", "]"}], "]"}]], ",", 
          SuperscriptBox["10", 
           RowBox[{"InGridz\[Epsilon]", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]], ",", 
          RowBox[{"Min", "[", 
           RowBox[{
            FractionBox[
             RowBox[{
              SuperscriptBox["10", 
               RowBox[{"InGridz\[Epsilon]", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}]], "-", 
              SuperscriptBox["10", 
               RowBox[{"InGridz\[Epsilon]", "[", 
                RowBox[{"[", "1", "]"}], "]"}]]}], "5"], ",", 
            RowBox[{"Max", "[", 
             RowBox[{"0.5", ",", 
              FractionBox[
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["10", 
                  RowBox[{"InGridz\[Epsilon]", "[", 
                   RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]], "-", 
                 SuperscriptBox["10", 
                  RowBox[{"InGridz\[Epsilon]", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]]}], ")"}], "30"]}], "]"}]}],
            "]"}]}], "}"}]}], "]"}], "]"}]}], 
    RowBox[{"(*", "InGridz\[Epsilon]", "*)"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalDelta]xVals", "[", "list_", "]"}], ":=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        FractionBox[
         RowBox[{
          RowBox[{"list", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"list", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "2"], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"list", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "-", 
          RowBox[{"list", "[", 
           RowBox[{"[", 
            RowBox[{"i", "-", "1"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"Length", "[", "list", "]"}], ",", "1"}], "}"}]}], "]"}]}],
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalDelta]\[Theta]vals", "=", 
     RowBox[{"\[CapitalDelta]xVals", "[", 
      SuperscriptBox["10", "OutGrid\[Theta]final"], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalDelta]zvals", "=", 
     RowBox[{"\[CapitalDelta]xVals", "[", 
      SuperscriptBox["10", "OutGridzfinal"], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Final", " ", "energy", " ", 
      RowBox[{"grid", ".", " ", "Mass"}]}], "-", " ", 
     RowBox[{"and", " ", "production", " ", "channel"}], "-", "dependent"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"StepEtemp", "[", "Efip_", "]"}], "=", 
     RowBox[{"Piecewise", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.3", ",", 
          RowBox[{"Efip", "\[LessEqual]", "2.5"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.5", ",", 
          RowBox[{"2.5", "<", "Efip", "<", "35"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", 
          RowBox[{"35", "\[LessEqual]", "Efip", "\[LessEqual]", "50"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", 
          RowBox[{"50", "<", "Efip", "<", "160"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5", ",", 
          RowBox[{"160", "\[LessEqual]", "Efip", "<", "300"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"40", ",", 
          RowBox[{"300", "\[LessEqual]", "Efip", "<", "700"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"50", ",", 
          RowBox[{"700", "\[LessEqual]", "Efip", "<", "2000"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"200", ",", 
          RowBox[{"2000", "\[LessEqual]", "Efip", "<", "4000"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"400", ",", 
          RowBox[{"4000", "\[LessEqual]", "Efip", "<", "7000"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"500", ",", 
          RowBox[{"7000", "\[LessEqual]", "Efip", "\[LessEqual]", "50000"}]}],
          "}"}]}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"OutGridEnergy", "[", 
     RowBox[{"m_", ",", "ProdChannel_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"start", "=", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"10", "^", 
               RowBox[{
                RowBox[{
                 RowBox[{"GridInFinal", "[", "ProdChannel", "]"}], "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", 
              RowBox[{"1.01", "m"}]}], "]"}]}], ",", 
           RowBox[{"end", "=", 
            RowBox[{"EBLmax", "[", 
             RowBox[{"m", ",", "\[Theta]minExp", ",", "ProdChannel"}], 
             "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Log10", "[", 
          RowBox[{"NestWhileList", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "+", 
              RowBox[{"StepEtemp", "[", "#", "]"}]}], "&"}], ",", "start", 
            ",", 
            RowBox[{
             RowBox[{"#", "\[LessEqual]", "end"}], "&"}], ",", "1", ",", 
            "\[Infinity]", ",", 
            RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}], "//", "N"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalDelta]xValsTotComp", "=", 
     RowBox[{
      RowBox[{"Hold", "@", 
       RowBox[{"Compile", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[CapitalDelta]\[Theta]vals", ",", "_Real", ",", "1"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[CapitalDelta]Evals", ",", "_Real", ",", "1"}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"\[CapitalDelta]zvals", ",", "_Real", ",", "1"}], "}"}]}],
           "}"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[CapitalDelta]\[Theta]vals", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "*", 
             RowBox[{"\[CapitalDelta]Evals", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "*", 
             RowBox[{"\[CapitalDelta]zvals", "[", 
              RowBox[{"[", "k", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "\[CapitalDelta]\[Theta]vals", "]"}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "\[CapitalDelta]Evals", "]"}]}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", 
             RowBox[{"Length", "[", "\[CapitalDelta]zvals", "]"}]}], "}"}]}], 
          "]"}], ",", 
         RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
         RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}]}], "//",
       "ReleaseHold"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8972023930977507`*^9, 3.8972024003159914`*^9}, {
   3.8972037912719955`*^9, 3.897203794873706*^9}, {3.8972042319753127`*^9, 
   3.8972042376735725`*^9}, {3.8972043473390894`*^9, 3.897204353429783*^9}, {
   3.8972047978657155`*^9, 3.89720480634333*^9}, {3.897208409815923*^9, 
   3.89720841003522*^9}, {3.897229216225009*^9, 3.897229219246179*^9}, {
   3.897229990114852*^9, 3.8972300083249702`*^9}, 3.8972308575471125`*^9},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[173]:=",ExpressionUUID->"565a3fe4-60a3-4b63-bfc4-6e9b716a7fca"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Code that computes the number of events - using the mapping method \
\>", "Subsection",
 CellChangeTimes->{{3.897199076623907*^9, 3.8971990900052223`*^9}, {
  3.8972009084104066`*^9, 3.897200920680235*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"847d1c02-0635-4180-9069-\
8105322cce45"],

Cell[CellGroupData[{

Cell["Grid for distribution times acceptance", "Subsubsection",
 CellChangeTimes->{{3.8972000893750353`*^9, 3.897200100182712*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"4c4d35f9-dd2c-4ef6-a8e7-\
31ec43e57227"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Block", " ", "that", " ", "computes", " ", "the", " ", "grid", " ", 
     SubscriptBox["\[Theta]", "S"]}], ",", 
    SubscriptBox["E", "S"], ",", 
    SubscriptBox["z", "S"], ",", " ", 
    RowBox[{
     SubscriptBox["\[Epsilon]", "Full"], "\[Times]", 
     SubscriptBox["f", 
      RowBox[{
       SubscriptBox["\[Theta]", "S"], ",", 
       SubscriptBox["E", "S"]}]]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"TableIntegrandDiscret", "[", 
    RowBox[{"m_", ",", "ProdChannel_", ",", "\[Epsilon]DecOp_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"OutGridEfinal", "=", 
       RowBox[{"OutGridEnergy", "[", 
        RowBox[{
         RowBox[{"N", "[", "m", "]"}], ",", "ProdChannel"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalDelta]Evals", "=", 
       RowBox[{"\[CapitalDelta]xVals", "[", 
        SuperscriptBox["10", "OutGridEfinal"], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalDelta]xValsTot", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"\[CapitalDelta]xValsTotComp", "[", 
          RowBox[{
          "\[CapitalDelta]\[Theta]vals", ",", "\[CapitalDelta]Evals", ",", 
           "\[CapitalDelta]zvals"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"OutGridFinal", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Log10", "[", 
            RowBox[{"N", "[", "m", "]"}], "]"}], "}"}], ",", 
          "OutGrid\[Theta]final", ",", "OutGridEfinal", ",", 
          "OutGridzfinal"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"OutGridFinal1", "=", 
       RowBox[{"10", "^", 
        RowBox[{"OutGridFinal", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "3", ",", "4"}], "}"}]}], "]"}], "]"}]}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"g\[Epsilon]", "=", 
       RowBox[{"{", 
        RowBox[{
        "InGridm\[Epsilon]", ",", "InGrid\[Theta]\[Epsilon]", ",", 
         "InGridE\[Epsilon]", ",", "InGridz\[Epsilon]"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xg\[Epsilon]", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Log10", "[", 
           RowBox[{"N", "[", "m", "]"}], "]"}], "}"}], ",", 
         "OutGrid\[Theta]final", ",", "OutGridEfinal", ",", "OutGridzfinal"}],
         "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xig\[Epsilon]", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Interpolation", "[", 
            RowBox[{
             RowBox[{"Transpose", "@", 
              RowBox[{"{", 
               RowBox[{"#", ",", 
                RowBox[{"Range", "@", 
                 RowBox[{"Length", "@", "#"}]}]}], "}"}]}], ",", 
             RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
           "#2", "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"g\[Epsilon]", ",", "xg\[Epsilon]"}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"\[Epsilon]Result", "=", 
       RowBox[{"10", "^", 
        RowBox[{"Flatten", "@", 
         RowBox[{"cf4", "[", 
          RowBox[{
           RowBox[{"Sequence", "@@", "xig\[Epsilon]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"\[Epsilon]DecOp", "==", "\"\<True\>\""}], ",", 
             "\[Epsilon]vals", ",", "\[Epsilon]azvals"}], "]"}]}], 
          "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gDistr", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"GridInFinal", "[", "ProdChannel", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"GridInFinal", "[", "ProdChannel", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"GridInFinal", "[", "ProdChannel", "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xgDistr", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Log10", "[", 
           RowBox[{"N", "[", "m", "]"}], "]"}], "}"}], ",", 
         "OutGrid\[Theta]final", ",", "OutGridEfinal"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xigDistr", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Interpolation", "[", 
            RowBox[{
             RowBox[{"Transpose", "@", 
              RowBox[{"{", 
               RowBox[{"#", ",", 
                RowBox[{"Range", "@", 
                 RowBox[{"Length", "@", "#"}]}]}], "}"}]}], ",", 
             RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
           "#2", "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"gDistr", ",", "xgDistr"}], "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"DistrResult", "=", 
       RowBox[{"10", "^", 
        RowBox[{"Flatten", "@", 
         RowBox[{"cf3", "[", 
          RowBox[{
           RowBox[{"Sequence", "@@", "xigDistr"}], ",", 
           RowBox[{"DistrVals", "[", "ProdChannel", "]"}]}], "]"}]}]}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"TabTemp0", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"OutGridFinal1", ",", 
         RowBox[{"List", "/@", 
          RowBox[{"Flatten", "[", 
           RowBox[{"DistrResult", " ", 
            RowBox[{"Partition", "[", 
             RowBox[{"\[Epsilon]Result", ",", 
              RowBox[{"Length", "[", "OutGridzfinal", "]"}]}], "]"}]}], 
           "]"}]}], ",", "\[CapitalDelta]xValsTot", ",", "2"}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8971994275280633`*^9, 3.897199455815837*^9}, {
  3.897199582357897*^9, 3.897199655914138*^9}, {3.897199710190297*^9, 
  3.8971997629515643`*^9}, {3.8971998392552953`*^9, 3.897199857485531*^9}, {
  3.8971999081472673`*^9, 3.897199913176509*^9}, {3.897200806217702*^9, 
  3.897200808930355*^9}, {3.8972008448098516`*^9, 3.897200868455401*^9}, {
  3.8972021893667536`*^9, 3.897202196806899*^9}, {3.89720660886187*^9, 
  3.8972066089868507`*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[181]:=",ExpressionUUID->"1eaf7d72-f752-41c9-9222-5542316adcef"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Convoluting acceptances with pre-factor", "Subsubsection",
 CellChangeTimes->{{3.8972001073570213`*^9, 3.8972001113381767`*^9}, {
  3.897200680751539*^9, 3.8972006887621703`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"75be5dca-64c8-4035-a075-\
babcc12d6bf0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Values", " ", 
     SubscriptBox["f", "FIP"], "\[Times]", 
     SubscriptBox["\[Epsilon]", "FIP"], "\[Times]", 
     FractionBox[
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", 
         SubscriptBox["z", "FIP"]}], "/", 
        RowBox[{"(", 
         RowBox[{"cos", 
          RowBox[{"(", 
           SubscriptBox["\[Theta]", "FIP"], ")"}], 
          SubscriptBox["c\[Tau]", "FIP"], 
          RowBox[{
           SubscriptBox["p", "FIP"], "/", 
           SubscriptBox["m", "FIP"]}]}], ")"}]}], "]"}], 
      RowBox[{"cos", 
       RowBox[{"(", 
        SubscriptBox["\[Theta]", "FIP"], ")"}], 
       SubscriptBox["c\[Tau]", "FIP"], 
       RowBox[{
        SubscriptBox["p", "FIP"], "/", 
        SubscriptBox["m", "FIP"]}]}]], "\[Times]", 
     SubscriptBox["\[Epsilon]", "decay"], 
     SubscriptBox["\[CapitalDelta]z", "FIP"], 
     SubscriptBox["\[CapitalDelta]E", "FIP"], 
     SubscriptBox["\[CapitalDelta]\[Theta]", "FIP"], " ", "for", " ", "the", 
     " ", "grid", " ", "of", " ", "values", " ", 
     SubscriptBox["\[Theta]", "FIP"]}], ",", " ", 
    SubscriptBox["E", "FIP"], ",", " ", 
    RowBox[{
     SubscriptBox["z", "FIP"], " ", "fixed", " ", "values", " ", "of", " ", 
     SubscriptBox["c\[Tau]", "FIP"], " ", "and", " ", 
     SubscriptBox["m", "FIP"]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tableprefac", "=", 
     RowBox[{
      RowBox[{"Hold", "@", 
       RowBox[{"Compile", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"tabb", ",", "_Real", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", "_Real"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c\[Tau]", ",", "_Real"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"decProb", ",", "_Integer"}], "}"}]}], "}"}], ",", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "angles", ",", "energies", ",", "zv", ",", "values", ",", 
             "\[CapitalDelta]s", ",", "prefactor"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"values", "=", 
             RowBox[{"Compile`GetElement", "[", 
              RowBox[{"tabb", ",", "4"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"\[CapitalDelta]s", "=", 
             RowBox[{"Compile`GetElement", "[", 
              RowBox[{"tabb", ",", "5"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"decProb", "==", "1"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"angles", "=", 
                RowBox[{"Compile`GetElement", "[", 
                 RowBox[{"tabb", ",", "1"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"energies", "=", 
                RowBox[{"Compile`GetElement", "[", 
                 RowBox[{"tabb", ",", "2"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"zv", "=", 
                RowBox[{"Compile`GetElement", "[", 
                 RowBox[{"tabb", ",", "3"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"prefactor", "=", 
                FractionBox[
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", "zv"}], "/", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Cos", "[", "angles", "]"}], "*", "c\[Tau]", "*", 
                    FractionBox[
                    SqrtBox[
                    RowBox[{
                    SuperscriptBox["energies", "2"], "-", 
                    SuperscriptBox["m", "2"]}]], "m"]}], ")"}]}], "]"}], 
                 RowBox[{
                  RowBox[{"Cos", "[", "angles", "]"}], "*", "c\[Tau]", "*", 
                  FractionBox[
                   SqrtBox[
                    RowBox[{
                    SuperscriptBox["energies", "2"], "-", 
                    SuperscriptBox["m", "2"]}]], "m"]}]]}]}], ",", 
              RowBox[{"prefactor", "=", "1."}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"prefactor", "*", "\[CapitalDelta]s", "*", "values"}]}]}],
           "]"}], ",", 
         RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
         RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
         RowBox[{"Parallelization", "\[Rule]", "\"\<True\>\""}], ",", 
         RowBox[{"RuntimeAttributes", "\[Rule]", 
          RowBox[{"{", "Listable", "}"}]}]}], "]"}]}], "//", 
      "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Summation", " ", "of", " ", "the", " ", "values", " ", "above"}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sumcompile", "=", 
     RowBox[{
      RowBox[{"Hold", "@", 
       RowBox[{"Compile", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"tabc\[Tau]m", ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
         RowBox[{"Total", "[", "tabc\[Tau]m", "]"}], ",", 
         RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
         RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
         RowBox[{"Parallelization", "\[Rule]", "\"\<True\>\""}]}], "]"}]}], "//",
       "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mmin\[Epsilon]", ",", "mmax\[Epsilon]"}], "}"}], "=", 
    RowBox[{"10", "^", 
     RowBox[{"MinMax", "[", "InGridm\[Epsilon]", "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{
  3.897200675960476*^9, {3.8972040486175427`*^9, 3.897204049008037*^9}, {
   3.897204079641328*^9, 3.8972040859999785`*^9}, {3.8972057591435843`*^9, 
   3.8972057626279507`*^9}, {3.89720886889474*^9, 3.897208869001661*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[182]:=",ExpressionUUID->"ef90f43e-a66a-49d5-8cc7-9e859d3b6b45"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Acceptances", "Subsubsection",
 CellChangeTimes->{{3.8972009286929445`*^9, 3.8972009324601674`*^9}, 
   3.897201517674982*^9},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"d7b4ef26-0c39-4d8c-a90d-\
581ad642651d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FactorANUBISceiling", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"SelectedExperiment", "==", "\"\<ANUBIS-ceiling\>\""}], ",", "2",
      ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AcceptanceDiscret", "[", 
   RowBox[{
   "m_", ",", "ProdChannel_", ",", "\[Epsilon]decOp_", ",", "decProb_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"NevDiscret", ",", "NpotTimes\[Chi]val"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"mBLmin", "[", "ProdChannel", "]"}], ",", 
          "mmin\[Epsilon]"}], "]"}], "<", "m", "<", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"mBLmax", "[", "ProdChannel", "]"}], ",", 
          "mmax\[Epsilon]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"integrandtab", "=", 
         RowBox[{"TableIntegrandDiscret", "[", 
          RowBox[{"m", ",", "ProdChannel", ",", "\[Epsilon]decOp"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"brvis", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"\[Epsilon]decOp", "==", "1"}], ",", 
           RowBox[{"BrVis", "[", "m", "]"}], ",", "1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Test", " ", "lifetime", " ", "for", " ", "the", " ", "acceptance"}],
          "*)"}], "\[IndentingNewLine]", 
        RowBox[{"c\[Tau]acc", "=", 
         SuperscriptBox["10", "9"]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Prefactor", " ", "for", " ", "the", " ", 
          RowBox[{"acceptance", ".", " ", "If"}], " ", "only", " ", 
          "azimuthal", " ", "and"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"prefacacc", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"decProb", "==", "1"}], ",", "c\[Tau]acc", ",", 
           FractionBox["1", 
            RowBox[{"zmaxExp", "-", "zminExp"}]]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"accdiscret", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"brvis", "!=", "0"}], ",", 
           RowBox[{"FactorANUBISceiling", "*", "brvis", "*", "prefacacc", "*", 
            RowBox[{"sumcompile", "[", 
             RowBox[{"tableprefac", "[", 
              RowBox[{
              "integrandtab", ",", "m", ",", "c\[Tau]acc", ",", "decProb"}], 
              "]"}], "]"}]}], ",", "0"}], "]"}]}]}], ",", 
       RowBox[{"accdiscret", "=", "0"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "accdiscret"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.8972011084712963`*^9, 3.897201128340288*^9}, {
   3.8972011891481795`*^9, 3.89720124049387*^9}, {3.8972012897384634`*^9, 
   3.897201325360157*^9}, {3.897201589075931*^9, 3.8972016624203763`*^9}, {
   3.8972018160050974`*^9, 3.8972018498780518`*^9}, {3.89720191795713*^9, 
   3.8972019346903367`*^9}, {3.8972020225483*^9, 3.8972020975166674`*^9}, {
   3.8972023111284375`*^9, 3.897202311275799*^9}, 3.8972023780567894`*^9, {
   3.897205334073205*^9, 3.8972053351996293`*^9}, {3.897206603491517*^9, 
   3.8972066036108027`*^9}, {3.8972084496286616`*^9, 
   3.8972084523229027`*^9}, {3.8972085258638744`*^9, 
   3.8972085259988823`*^9}, {3.8972088775622473`*^9, 
   3.8972088779176054`*^9}, {3.897229287247379*^9, 3.8972292971530523`*^9}, {
   3.8972308817930126`*^9, 3.8972308867259245`*^9}},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[185]:=",ExpressionUUID->"0454e6e6-ecf7-490a-b55d-33c2c8a9a71c"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Acceptances and approximate lower/upper bounds computation", "Section",
 CellChangeTimes->{{3.8972012648879433`*^9, 3.897201267668914*^9}, {
  3.8972059482630224`*^9, 3.8972059524445267`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"b70d3573-fb66-4ce2-b91a-\
09b310ff32c9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"mlistAcceptance", "[", "prod", "]"}], "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"m", ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", 
           RowBox[{"1.01", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"mBLmin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}], 
             "]"}]}], ",", 
           RowBox[{"0.95", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"mBLmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}], 
             "]"}]}], ",", 
           RowBox[{"Min", "[", 
            RowBox[{
             FractionBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"0.95", 
                 RowBox[{"Min", "[", 
                  RowBox[{
                   RowBox[{"mBLmax", "[", "prod", "]"}], ",", 
                   "mmax\[Epsilon]"}], "]"}]}], "-", 
                RowBox[{"1.01", 
                 RowBox[{"Max", "[", 
                  RowBox[{
                   RowBox[{"mBLmin", "[", "prod", "]"}], ",", 
                   "mmin\[Epsilon]"}], "]"}]}]}], ")"}], "20"], ",", "2"}], 
            "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.99", 
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"mBLmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}], 
          "]"}]}], "}"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"m", ",", 
          RowBox[{"AcceptanceDiscret", "[", 
           RowBox[{"m", ",", "prod", ",", "\"\<False\>\"", ",", "0"}], "]"}], 
          ",", 
          RowBox[{"AcceptanceDiscret", "[", 
           RowBox[{"m", ",", "prod", ",", "\"\<True\>\"", ",", "0"}], "]"}], 
          ",", 
          RowBox[{"AcceptanceDiscret", "[", 
           RowBox[{"m", ",", "prod", ",", "\"\<False\>\"", ",", "1"}], "]"}], 
          ",", 
          RowBox[{"AcceptanceDiscret", "[", 
           RowBox[{"m", ",", "prod", ",", "\"\<True\>\"", ",", "1"}], "]"}]}],
          "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"m", ",", 
          RowBox[{"mlistAcceptance", "[", "prod", "]"}]}], "}"}]}], "]"}]}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlotAcc", "[", "ProdChannel_", "]"}], ":=", 
  RowBox[{"ListLogPlot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "4"}], "}"}]}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "5"}], "}"}]}], "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", " ", "22"}], "]"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Blue"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
         RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
         RowBox[{"Darker", "@", 
          RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Black"}], "}"}]}], 
      "}"}]}], ",", 
    RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"MinMax", "[", 
        RowBox[{
         RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.9", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "5"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}], "]"}]}], ",", 
         RowBox[{"1.1", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}]}], "]"}]}]}], 
        "}"}]}], "}"}]}], ",", 
    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<m [GeV]\>\"", ",", "\"\<Acceptance\>\""}], "}"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", " ", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<From \>\"", ",", "ProdChannel"}], "}"}], "]"}], ",", 
       " ", "20", ",", " ", "Black"}], "]"}]}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"Placed", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"#", ",", " ", "18"}], "]"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{
          "\"\<<\!\(\*SubscriptBox[\(\[Epsilon]\), \(FIP\)]\)>\>\"", ",", 
           "\"\<<\!\(\*SubscriptBox[\(\[Epsilon]\), \
\(FIP\)]\)\!\(\*SubscriptBox[\(\[Epsilon]\), \(decay\)]\)>\>\"", ",", 
           "\"\<c\[Tau]<\!\(\*SubscriptBox[\(\[Epsilon]\), \
\(FIP\)]\)\!\(\*SubscriptBox[\(P\), \(decay\)]\)>\>\"", ",", 
           "\"\<c\[Tau]<\!\(\*SubscriptBox[\(\[Epsilon]\), \
\(FIP\)]\)\!\(\*SubscriptBox[\(P\), \(decay\)]\)\!\(\*SubscriptBox[\(\
\[Epsilon]\), \(decay\)]\)>\>\""}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.75", ",", "0.2"}], "}"}]}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Style", "[", 
  RowBox[{
   RowBox[{"Row", "[", 
    RowBox[{"Evaluate", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"PlotAcc", "[", "prod", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "]"}], "]"}],
    ",", 
   RowBox[{"ImageSizeMultipliers", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FilenameAcceptance", "[", "prod", "]"}], "=", 
     RowBox[{"ToString", "@", 
      RowBox[{"StringForm", "[", 
       RowBox[{"\"\<Acceptance_B-3Le-Lmu+Ltau_at_``_From_``.dat\>\"", ",", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"{", 
          RowBox[{"SelectedExperiment", ",", 
           RowBox[{"ListExport", "[", "prod", "]"}]}], "}"}]}]}], "]"}]}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], ",", 
         "\"\<Auxiliary data/B-3Le-Lmu+Ltau\>\"", ",", "SelectedExperiment", 
         ",", 
         RowBox[{"FilenameAcceptance", "[", "prod", "]"}]}], "}"}], "]"}], 
      ",", 
      RowBox[{
       RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "4", ",", "5"}], "}"}]}], "]"}], "]"}], 
      ",", "\"\<Table\>\""}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"prod", ",", "ProductionList"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AccAveraged", "[", "mV_", "]"}], "=", 
   RowBox[{"NpotGivenExperiment", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"mBLmin", "[", "prod", "]"}], "<", "mV", "<", 
           RowBox[{"mBLmax", "[", "prod", "]"}]}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"\[Chi]Xtimes\[Chi]XtoBL", "[", 
            RowBox[{"mV", ",", "1", ",", "prod"}], "]"}], "]"}], ",", "0"}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ",", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"mBLmin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}], 
            "]"}], "<", "mV", "<", 
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"mBLmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}], 
            "]"}]}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"\[Chi]Xtimes\[Chi]XtoBL", "[", 
             RowBox[{"mV", ",", "1", ",", "prod"}], "]"}], "*", 
            RowBox[{
             RowBox[{"Interpolation", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
               RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
             "mV", "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ",", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"mBLmin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}], 
            "]"}], "<", "mV", "<", 
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"mBLmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}], 
            "]"}]}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"\[Chi]Xtimes\[Chi]XtoBL", "[", 
             RowBox[{"mV", ",", "1", ",", "prod"}], "]"}], "*", 
            RowBox[{
             RowBox[{"Interpolation", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "4"}], "}"}]}], "]"}], "]"}], ",", 
               RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
             "mV", "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ",", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"mBLmin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}], 
            "]"}], "<", "mV", "<", 
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"mBLmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}], 
            "]"}]}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"\[Chi]Xtimes\[Chi]XtoBL", "[", 
             RowBox[{"mV", ",", "1", ",", "prod"}], "]"}], "*", 
            RowBox[{
             RowBox[{"Interpolation", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "5"}], "}"}]}], "]"}], "]"}], ",", 
               RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
             "mV", "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}]}], "}"}]}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<Auxiliary data/B-3Le-Lmu+Ltau\>\"", ",", "SelectedExperiment", 
      ",", "\"\<AcceptanceAveragedB-3Le-Lmu+Ltau.m\>\""}], "}"}], "]"}], ",", 
   RowBox[{"AccAveraged", "[", "mV", "]"}], ",", "\"\<MX\>\""}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.897205194596387*^9, 3.8972052417988367`*^9}, {
   3.897205309605931*^9, 3.89720539403836*^9}, {3.8972055297271395`*^9, 
   3.89720562453496*^9}, {3.8972056761558304`*^9, 3.897205703295968*^9}, {
   3.897205781529233*^9, 3.8972057841962852`*^9}, {3.897205893477086*^9, 
   3.897205918862975*^9}, {3.897206478456417*^9, 3.8972065044154882`*^9}, {
   3.8972085444868965`*^9, 3.897208578779801*^9}, {3.897229286711469*^9, 
   3.897229297000371*^9}, {3.897229351189811*^9, 3.897229356326123*^9}, {
   3.8972294633607855`*^9, 3.8972294667919273`*^9}, {3.897230081147719*^9, 
   3.897230081189762*^9}, {3.8972308816221185`*^9, 3.897230904280447*^9}, {
   3.8972313217379694`*^9, 3.897231331200429*^9}, {3.8975324729597387`*^9, 
   3.8975324764753804`*^9}, {3.902650984436943*^9, 3.902651070205699*^9}, 
   3.9028951811032343`*^9, 3.9038921473398714`*^9, {3.9039418380981865`*^9, 
   3.9039418389569273`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"9aa543f6-150b-4691-842b-\
5745bb235721"],

Cell[CellGroupData[{

Cell["Rough estimates of the upper and lower bounds", "Subsection",
 CellChangeTimes->{{3.8850328066928463`*^9, 3.8850328135228024`*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"67b88b6c-892c-46ab-8d4a-\
4354be07db4e"],

Cell[CellGroupData[{

Cell["Definitions", "Subsubsection",
 CellChangeTimes->{{3.877676708463168*^9, 3.877676711193803*^9}},
 CellTags->{
  "Number-of-events-computation", 
   "Acceptance-computation"},ExpressionUUID->"132302de-53b0-4056-aa25-\
a58f622fce52"],

Cell[BoxData[{
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Alpha]BminEstimate", "[", 
      RowBox[{"mV_", ",", "prod"}], "]"}], "=", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"NpotGivenExperiment", "*", 
          RowBox[{"\[Chi]Xtimes\[Chi]XtoBL", "[", 
           RowBox[{"mV", ",", "1", ",", "prod"}], "]"}], "*", 
          RowBox[{
           RowBox[{"Interpolation", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "4"}], "}"}]}], "]"}], "]"}], ",", 
             RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
           "mV", "]"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"2.3", 
          RowBox[{"ldecayBL", "[", 
           RowBox[{"mV", ",", "1", ",", "EV"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{"mV", "/", 
            RowBox[{"(", 
             RowBox[{"\[Sqrt]", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["EV", "2"], "-", 
                SuperscriptBox["mV", "2"]}], ")"}]}], ")"}]}], ")"}]}], 
         ")"}]}], ")"}], 
      RowBox[{
       RowBox[{"-", "1"}], "/", "2."}]]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Alpha]BmaxEstimate", "[", 
      RowBox[{"mV_", ",", "prod"}], "]"}], "=", 
     RowBox[{"Re", "[", 
      RowBox[{"Evaluate", "[", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ProductLog", "[", 
            RowBox[{
             RowBox[{"-", "1"}], ",", 
             RowBox[{
              RowBox[{"-", "2.3"}], "*", 
              RowBox[{"(", 
               RowBox[{"b", "/", "a"}], ")"}]}]}], "]"}], "/", "b"}], ")"}]}],
         "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a", "\[Rule]", " ", 
           RowBox[{"NpotGivenExperiment", "*", 
            RowBox[{"\[Chi]Xtimes\[Chi]XtoBL", "[", 
             RowBox[{"mV", ",", "1", ",", "prod"}], "]"}], "*", 
            RowBox[{
             RowBox[{"Interpolation", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
               RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
             "mV", "]"}]}]}], ",", 
          RowBox[{"b", "\[Rule]", 
           RowBox[{"zminExp", "/", 
            RowBox[{"ldecayBL", "[", 
             RowBox[{"mV", ",", "1", ",", 
              RowBox[{"EBLmax", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"mlistBL", "[", "prod", "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", "\[Theta]minExp", ",", 
                "prod"}], "]"}]}], "]"}]}]}]}], "}"}]}], "]"}], "]"}]}]}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"prod", ",", "ProductionList"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Epsilon]estplot", "=", "\"\<\[Eta]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogLogPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Alpha]BminEstimate", "[", 
      RowBox[{"mV", ",", "\[Epsilon]estplot"}], "]"}], ",", 
     RowBox[{"\[Alpha]BmaxEstimate", "[", 
      RowBox[{"mV", ",", "\[Epsilon]estplot"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"mV", ",", 
     RowBox[{"Min", "[", 
      RowBox[{"mlistBL", "[", "\[Epsilon]estplot", "]"}], "]"}], ",", 
     RowBox[{"Max", "[", 
      RowBox[{"mlistBL", "[", "\[Epsilon]estplot", "]"}], "]"}]}], "}"}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"ImageSize", "->", "Large"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8927045521296835`*^9, 3.892704618398532*^9}, {
   3.892704651576499*^9, 3.892704652867281*^9}, 3.8951292466391563`*^9, {
   3.8972064547512426`*^9, 3.8972064548441195`*^9}, {3.8972065272743893`*^9, 
   3.8972065273639555`*^9}, {3.897208556347765*^9, 3.8972085563922853`*^9}, {
   3.8972086426345124`*^9, 3.897208654173244*^9}, {3.8972301868738627`*^9, 
   3.897230202458928*^9}, {3.8972302630721664`*^9, 3.897230271572064*^9}, {
   3.8972303130275044`*^9, 3.8972303219433126`*^9}, 3.8972308573803167`*^9, 
   3.897230966365088*^9},
 CellTags->{"Number-of-events-computation", "Acceptance-computation"},
 CellLabel->
  "In[192]:=",ExpressionUUID->"09cc2475-50a1-4ddb-aa78-137d9bf9521a"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Number of events", "Section",
 CellChangeTimes->{{3.8972012736109533`*^9, 3.897201275449023*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"73f205b8-f71d-465d-9625-\
478487a24f75"],

Cell[CellGroupData[{

Cell["Fast", "Subsection",
 CellChangeTimes->{{3.897206442190997*^9, 3.8972064427846107`*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"e4770abc-19fe-4cf6-825a-\
246b07470464"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FactorLowerBound", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\"\<ANUBIS-shaft-volume-1\>\"", ",", 
          "\"\<ANUBIS-shaft-volume-2\>\"", ",", 
          "\"\<ANUBIS-shaft-volume-3\>\""}], "}"}], ",", 
        "SelectedExperiment"}], "]"}], "==", "True"}], ",", "0.1", ",", 
     "0.3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NeventsDiscret", "[", 
   RowBox[{"m_", ",", "ProdChannel_", ",", "\[Alpha]Blist_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"NevDiscret", ",", "NpotTimes\[Chi]val"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"mmin\[Epsilon]", ",", 
         RowBox[{"mBLmin", "[", "ProdChannel", "]"}]}], "]"}], "<", "m", "<", 
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"mBLmax", "[", "ProdChannel", "]"}], ",", "mmax\[Epsilon]"}],
         "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"integrandtab", "=", 
        RowBox[{"TableIntegrandDiscret", "[", 
         RowBox[{"m", ",", "ProdChannel", ",", "\"\<True\>\""}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NpotTimes\[Chi]val", "[", "\[Alpha]B_", "]"}], "=", 
        RowBox[{"FactorANUBISceiling", "*", "NpotGivenExperiment", "*", 
         RowBox[{"\[Chi]Xtimes\[Chi]XtoBL", "[", 
          RowBox[{"m", ",", "\[Alpha]B", ",", "ProdChannel"}], "]"}]}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"lowerbound", ",", "upperbound"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Alpha]BminEstimate", "[", 
           RowBox[{"m", ",", "ProdChannel"}], "]"}], ",", 
          RowBox[{"\[Alpha]BmaxEstimate", "[", 
           RowBox[{"m", ",", "ProdChannel"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"brvis", "=", 
        RowBox[{"BrVis", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NevDiscret", "[", "\[Alpha]B_", "]"}], ":=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"brvis", "!=", "0"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"FactorLowerBound", "*", "lowerbound"}], "<", 
             "\[Alpha]B", "<", 
             RowBox[{"2.1", "upperbound"}]}], ",", 
            RowBox[{
             RowBox[{"NpotTimes\[Chi]val", "[", "\[Alpha]B", "]"}], "*", 
             "brvis", "*", 
             RowBox[{"sumcompile", "[", 
              RowBox[{"tableprefac", "[", 
               RowBox[{"integrandtab", ",", "m", ",", 
                RowBox[{"c\[Tau]BL", "[", 
                 RowBox[{"m", ",", "\[Alpha]B"}], "]"}], ",", "1"}], "]"}], 
              "]"}]}], ",", "0"}], "]"}], ",", "0"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"m", ",", 
           RowBox[{"\[Alpha]Blist", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"NevDiscret", "[", 
            RowBox[{"\[Alpha]Blist", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "\[Alpha]Blist", "]"}], ",", "1"}], "}"}]}],
         "]"}]}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"m", ",", 
          RowBox[{"\[Alpha]Blist", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "\[Alpha]Blist", "]"}], ",", "1"}], "}"}]}], 
       "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.897200964730176*^9, 3.897200965970766*^9}, {
   3.89720118259857*^9, 3.8972011870868115`*^9}, {3.8972012433916793`*^9, 
   3.8972012434804716`*^9}, {3.8972021109080114`*^9, 3.897202111357911*^9}, {
   3.897205130000824*^9, 3.8972051305748835`*^9}, 3.897206599004672*^9, {
   3.8972085445054307`*^9, 3.8972085493226857`*^9}, {3.897208729717713*^9, 
   3.897208782995672*^9}, {3.8972292867323427`*^9, 3.8972292970111017`*^9}, {
   3.89723043678905*^9, 3.8972305059194307`*^9}, 3.897230545910039*^9, {
   3.8972306147913723`*^9, 3.897230624216058*^9}, {3.897230881646726*^9, 
   3.897230886743475*^9}, {3.8972309811503005`*^9, 3.897231008142254*^9}, {
   3.897231089021559*^9, 3.897231089353731*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[195]:=",ExpressionUUID->"e6e962c0-2232-405b-b3c7-28d2dc549e27"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Slow, using built-in Mathematica functions Interpolation, NIntegrate\
\>", "Subsection",
 CellChangeTimes->{{3.8972050850842867`*^9, 3.897205097581136*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"050324e4-707f-48bd-b9d9-\
3866d31d4b7b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Differential", " ", "decay", " ", "probability", " ", 
     RowBox[{"(", 
      RowBox[{"1", "/", "ldecay"}], ")"}], 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "l"}], "/", "ldecay"}], "]"}]}], ",", " ", 
    RowBox[{
    "where", " ", "l", " ", "is", " ", "expressed", " ", "in", " ", "terms", 
     " ", "of", " ", "the", " ", "longitudinal", " ", "displacement", " ", 
     "z", " ", "and", " ", "polar", " ", "angle", " ", "\[Theta]", " ", "as", 
     " ", 
     RowBox[{"z", "/", "cos\[Theta]"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"PdecayDensity", "[", 
      RowBox[{
      "mV_", ",", "\[Alpha]B_", ",", "\[Theta]V_", ",", "EV_", ",", "zV_"}], 
      "]"}], "=", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "zV"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]V", "]"}], "*", 
          RowBox[{"ldecayBL", "[", 
           RowBox[{"mV", ",", "\[Alpha]B", ",", "EV"}], "]"}]}], ")"}]}], 
       "]"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]V", "]"}], "*", 
        RowBox[{"ldecayBL", "[", 
         RowBox[{"mV", ",", "\[Alpha]B", ",", "EV"}], "]"}]}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "The", " ", "integrand", " ", "determining", " ", "the", " ", 
     "differential", " ", "rate", " ", "for", " ", "events"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"IntegrandBL", "[", 
        RowBox[{
        "mV_", ",", "\[Alpha]B_", ",", "\[Theta]V_", ",", "EV_", ",", "zV_", 
         ",", "prod"}], "]"}], "=", 
       RowBox[{
        RowBox[{"DoubleDistrBL", "[", 
         RowBox[{"mV", ",", "\[Theta]V", ",", "EV", ",", "prod"}], "]"}], "*", 
        RowBox[{"PdecayDensity", "[", 
         RowBox[{
         "mV", ",", "\[Alpha]B", ",", "\[Theta]V", ",", "EV", ",", "zV"}], 
         "]"}], "*", 
        RowBox[{"AzimuthalAcceptanceBL", "[", 
         RowBox[{"\[Theta]V", ",", "zV"}], "]"}], "*", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"DecayAcceptanceBL", "[", 
           RowBox[{"mV", ",", "\[Theta]V", ",", "EV", ",", "zV"}], "]"}], ",",
           "1"}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IntegralBL", "[", 
     RowBox[{"mV_", ",", "\[Alpha]B_", ",", "ProdChannel_"}], "]"}], ":=", 
    RowBox[{"NIntegrate", "[", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"IntegrandBL", "[", 
        RowBox[{
        "mV", ",", "\[Alpha]B", ",", "\[Theta]V", ",", "EV", ",", "z", ",", 
         "ProdChannel"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]V", ",", "\[Theta]minExp", ",", "\[Theta]maxExp"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"EV", ",", "mV", ",", 
        RowBox[{"EBLmax", "[", 
         RowBox[{"mV", ",", "\[Theta]V", ",", "ProdChannel"}], "]"}]}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", 
        RowBox[{"zmin\[Theta]", "[", "\[Theta]V", "]"}], ",", 
        RowBox[{"zmax\[Theta]", "[", "\[Theta]V", "]"}]}], "}"}], ",", 
      RowBox[{"Method", "\[Rule]", "\"\<AdaptiveMonteCarlo\>\""}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Nevents", "[", 
     RowBox[{"mV_", ",", "\[Alpha]B_", ",", "ProdChannel_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"mBLmin", "[", "ProdChannel", "]"}], "\[LessEqual]", "mV", 
        "\[LessEqual]", 
        RowBox[{"mBLmax", "[", "ProdChannel", "]"}]}], "&&", 
       RowBox[{
        RowBox[{"BrVis", "[", "mV", "]"}], "!=", "0"}]}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"0.1", "*", 
          RowBox[{"\[Alpha]BminEstimate", "[", 
           RowBox[{"mV", ",", "ProdChannel"}], "]"}]}], "<", "\[Alpha]B", "<", 
         RowBox[{"2.1", 
          RowBox[{"\[Alpha]BmaxEstimate", "[", 
           RowBox[{"mV", ",", "ProdChannel"}], "]"}]}]}], ",", 
        RowBox[{"NpotGivenExperiment", "*", 
         RowBox[{"\[Chi]Xtimes\[Chi]XtoBL", "[", 
          RowBox[{"mV", ",", "\[Alpha]B", ",", "ProdChannel"}], "]"}], "*", 
         RowBox[{"IntegralBL", "[", 
          RowBox[{"mV", ",", "\[Alpha]B", ",", "ProdChannel"}], "]"}]}], ",", 
        "0"}], "]"}], ",", "0"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.897206676519309*^9, 3.8972066766919394`*^9}, {
   3.8972085445134306`*^9, 3.897208556457489*^9}, 3.897208709167758*^9, {
   3.8972087938407507`*^9, 3.897208802487779*^9}, {3.8972292867368436`*^9, 
   3.897229297015228*^9}, 3.8972305311379223`*^9, 3.8972306212632217`*^9, {
   3.897230857389686*^9, 3.8972308867470446`*^9}, {3.8972309810124955`*^9, 
   3.89723100075139*^9}, 3.8972310454337935`*^9},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[197]:=",ExpressionUUID->"c6c0066d-7176-4c92-8c9d-56b5e6e223d9"],

Cell[CellGroupData[{

Cell["Test", "Subsubsection",
 CellChangeTimes->{{3.8921113169894333`*^9, 3.8921113174761143`*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"dc966617-dbbe-4e9b-933e-\
15e892d12356"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "This", " ", "is", " ", "a", " ", "comparison", " ", "between", " ", 
     "the", " ", "slow", " ", "and", " ", "fast", " ", "integration", " ", 
     RowBox[{"methods", ".", " ", "For"}], " ", "the", " ", "selected", " ", 
     "mass", " ", "and", " ", "production", " ", "channel"}], ",", " ", 
    RowBox[{
    "the", " ", "numbers", " ", "of", " ", "events", " ", "obtained", " ", 
     "using", " ", "the", " ", "methods", " ", "should", " ", "agree", " ", 
     "within", " ", "10", "%"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"If", " ", "the", " ", "agreement", " ", "is", " ", "worse"}], 
    ",", " ", 
    RowBox[{
    "there", " ", "may", " ", "be", " ", "a", " ", "few", " ", "reasons"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"1", ")"}], " ", "The", " ", "grid", " ", "for", " ", "the", " ",
      "fast", " ", "method", " ", "is", " ", "not", " ", "dense", " ", 
     RowBox[{"enough", ".", " ", "Try"}], " ", "to", " ", "increase", " ", 
     "the", " ", "grid", " ", "density", " ", 
     RowBox[{"(", 
      RowBox[{
      "OutGrid\[Theta]final", ",", " ", "OutGridEfinal", ",", " ", 
       "OutGridzfinal"}], ")"}], " ", "to", " ", "see", " ", "whether", " ", 
     "the", " ", "agreement", " ", 
     RowBox[{"improves", ".", " ", "Sometimes"}]}], ",", " ", 
    RowBox[{
    "even", " ", "a", " ", "slightly", " ", "denser", " ", "grid", " ", "for",
      " ", 
     RowBox[{"e", ".", "g", ".", " ", "z"}], " ", "may", " ", "lead", " ", 
     "to", " ", "a", " ", "significant", " ", "improvement", " ", "in", " ", 
     "the", " ", "agrement"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"2", ")"}], " ", "The", " ", "Monte"}], "-", 
      RowBox[{
      "Carlo", " ", "integrator", " ", "for", " ", "the", " ", "slow", " ", 
       "method", " ", "fails", " ", "to", " ", "evaluate", " ", 
       "properly"}]}], ";", " ", 
     RowBox[{
     "this", " ", "may", " ", "happen", " ", "if", " ", "the", " ", "range", 
      " ", "of", " ", "the", " ", "integration", " ", "over", " ", "energies",
       " ", "is", " ", "too", " ", "large", " ", "compared", " ", "to", " ", 
      "the", " ", "domain", " ", "where", " ", "most", " ", "of", " ", "the", 
      " ", "events", " ", "actually", " ", "are", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"off", "-", 
         RowBox[{
         "axis", " ", "experiments", " ", "such", " ", "as", " ", "MATHUSLA", 
          " ", "and", " ", "ANUBIS"}]}], ")"}], ".", " ", "Another"}], " ", 
      "symptom", " ", "is", " ", "that", " ", "for", " ", "the", " ", "given",
       " ", "mass", " ", "and", " ", "coupling", " ", "the", " ", "integral", 
      " ", "\"\<jumps\>\""}]}], ",", " ", 
    RowBox[{"i", ".", "e", "."}], ",", " ", 
    RowBox[{
    "returns", " ", "values", " ", "with", " ", "large", " ", "error"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"mtest", "=", "0.05"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "ProdTest", "=", "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Alpha]Blist", "=", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["10", 
          RowBox[{"-", "12"}]], ",", 
         RowBox[{"3", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "12"}]]}], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "12"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "11"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "11"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "10"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "10"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "9"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "9"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "8"}]], ",", 
         RowBox[{"2", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "8"}]]}], ",", 
         RowBox[{"4", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "8"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "7"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"6", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"7", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"8", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"9", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "6"}]], ",", 
         RowBox[{"2", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "6"}]]}]}], "}"}], "//", "N"}], "*)"}], 
     RowBox[{"Table", "[", 
      RowBox[{
       SuperscriptBox["10", "x"], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"-", "17."}], ",", 
         RowBox[{"-", "3."}], ",", "0.3"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dat1", "=", 
      RowBox[{"NeventsDiscret", "[", 
       RowBox[{"mtest", ",", "ProdTest", ",", "\[Alpha]Blist"}], "]"}]}], 
     ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dat2", "=", 
      RowBox[{"ParallelTable", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Alpha]Blist", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"c\[Tau]BL", "[", 
           RowBox[{"mtest", ",", 
            RowBox[{"\[Alpha]Blist", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"Nevents", "[", 
           RowBox[{"mtest", ",", 
            RowBox[{"\[Alpha]Blist", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "ProdTest"}], "]"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "\[Alpha]Blist", "]"}], ",", "1"}], "}"}]}], 
       "]"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{"dat1", ",", 
      RowBox[{"dat2", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "2"}], "}"}]}], "]"}], "]"}], ",", "2"}], "]"}], "//",
     "TableForm"}]}]}]], "Input",
 CellChangeTimes->{{3.892111330393669*^9, 3.8921113703258653`*^9}, {
   3.8921114855521097`*^9, 3.8921114891326914`*^9}, {3.8921115909252915`*^9, 
   3.89211160107533*^9}, {3.892112023350475*^9, 3.8921120715940514`*^9}, {
   3.8921121043874707`*^9, 3.892112190091645*^9}, {3.892112748834139*^9, 
   3.892112748933666*^9}, {3.8921130465455704`*^9, 3.8921130470314426`*^9}, {
   3.8921131989548674`*^9, 3.8921131992395306`*^9}, {3.892113256325259*^9, 
   3.892113256434625*^9}, {3.892113458241603*^9, 3.8921135323303742`*^9}, {
   3.892116361437076*^9, 3.8921163614848557`*^9}, {3.893257780692194*^9, 
   3.893257792940939*^9}, {3.893260545232792*^9, 3.893260566765787*^9}, {
   3.896953530728937*^9, 3.896953531233162*^9}, {3.896953744363188*^9, 
   3.8969537469343243`*^9}, {3.896953883310589*^9, 3.896953884008139*^9}, {
   3.896971240286153*^9, 3.896971246695673*^9}, {3.8969733757056828`*^9, 
   3.896973378633896*^9}, {3.8969760731711082`*^9, 3.896976348233163*^9}, {
   3.8969763786206193`*^9, 3.896976403680397*^9}, {3.8969764343671703`*^9, 
   3.8969764672032614`*^9}, 3.8972088334478965`*^9, 3.8972305813039556`*^9, {
   3.897231000755061*^9, 3.8972310007681828`*^9}, 3.8972310680220823`*^9},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[201]:=",ExpressionUUID->"4293c3a7-1543-42f2-9c2b-e9669e08df1c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Differential number of events", "Subsection",
 CellChangeTimes->{{3.892111289211891*^9, 3.892111293865343*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"7c6afd69-2676-4e30-bbef-\
f9e1c59327e2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "same", " ", "as", " ", "tableprefac", " ", "but", " ", "also",
     " ", "including", " ", "the", " ", "grid"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tableGridPrefac", "=", 
     RowBox[{
      RowBox[{"Hold", "@", 
       RowBox[{"Compile", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"tabb", ",", "_Real", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"mS", ",", "_Real"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c\[Tau]", ",", "_Real"}], "}"}]}], "}"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Cos", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "*", "c\[Tau]", 
                   "*", 
                   FractionBox[
                    SqrtBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "2"], "-", 
                    SuperscriptBox["mS", "2"]}]], "mS"]}], ")"}]}], "]"}], 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "*", "c\[Tau]", "*", 
                FractionBox[
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "2"], "-", 
                   SuperscriptBox["mS", "2"]}]], "mS"]}]], 
              RowBox[{"#", "[", 
               RowBox[{"[", "4", "]"}], "]"}], "*", 
              RowBox[{"#", "[", 
               RowBox[{"[", "5", "]"}], "]"}]}]}], "}"}], "&"}], "/@", 
          "tabb"}], ",", 
         RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
         RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
         RowBox[{"Parallelization", "\[Rule]", "\"\<True\>\""}], ",", 
         RowBox[{"RuntimeAttributes", "\[Rule]", 
          RowBox[{"{", "Listable", "}"}]}]}], "]"}]}], "//", 
      "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Summation", " ", "returning", " ", "the", " ", "differential", " ", 
      "number", " ", "of", " ", "events", " ", "X"}], ",", " ", 
     RowBox[{"df", "/", "dX"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"NdiffCompiled", "=", 
    RowBox[{
     RowBox[{"Hold", "@", 
      RowBox[{"Compile", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"tabNdiff", ",", "_Real", ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"GridQuantity", ",", "_Real", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"LengthPerVariable", ",", "_Integer"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"NPoTtimesPprod", ",", "_Real"}], "}"}]}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"tabNdiff", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"LengthPerVariable", "*", 
                 RowBox[{"(", 
                  RowBox[{"i", "-", "1"}], ")"}]}], "+", "1"}], "]"}], "]"}], 
             "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"NPoTtimesPprod", "*", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"tabNdiff", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"LengthPerVariable", "*", 
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}]}], "+", "j"}], "]"}], 
                 "]"}], "[", 
                RowBox[{"[", "4", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", "LengthPerVariable", ",", "1"}], 
                "}"}]}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "GridQuantity", "]"}], ",", "1"}], "}"}]}],
          "]"}], ",", 
        RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
        RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
        RowBox[{"Parallelization", "\[Rule]", "\"\<True\>\""}]}], "]"}]}], "//",
      "ReleaseHold"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Variable", " ", "=", " ", 
      "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\""}], ",", 
     "\"\<\!\(\*SubscriptBox[\(x\), \(x\)]\)\>\"", ",", 
     RowBox[{
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", ".", " ", "The"}], 
      " ", "number", " ", "belongs", " ", "to", " ", "the", " ", "column", 
      " ", "in", " ", "the", " ", "tabulated", " ", "data"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"iVal", ":=", 
    RowBox[{"Association", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\"", " ", "\[Rule]", "2"}], 
       ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", "\[Rule]", "1"}], 
       ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(x\), \(x\)]\)\>\"", "\[Rule]", "3"}]}], 
      "}"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Differential", " ", "number", " ", "of", " ", "events"}], "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NeventsDifferentialDiscret", "[", 
     RowBox[{"m_", ",", "ProdChannel_", ",", "\[Alpha]B_", ",", "Variable_"}],
      "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "NpotTimes\[Chi]val", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ival", "=", 
        RowBox[{"iVal", "[", "Variable", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"NpotTimes\[Chi]val", "=", 
        RowBox[{"NpotGivenExperiment", "*", 
         RowBox[{"\[Chi]Xtimes\[Chi]XtoBL", "[", 
          RowBox[{"m", ",", "\[Alpha]B", ",", "ProdChannel"}], "]"}]}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"tablegrid0", "=", 
        RowBox[{"TableIntegrandDiscret", "[", 
         RowBox[{"m", ",", "ProdChannel", ",", "\"\<True\>\""}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"\[CapitalDelta]xvals", ":=", 
        RowBox[{"Association", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\"", "\[Rule]", 
            "\[CapitalDelta]Evals"}], ",", 
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", "\[Rule]", 
            " ", "\[CapitalDelta]\[Theta]vals"}], ",", 
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(x\), \(X\)]\)\>\"", "\[Rule]", " ", 
            "\[CapitalDelta]zvals"}]}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[CapitalDelta]xval", "=", 
        RowBox[{"\[CapitalDelta]xvals", "[", "Variable", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"c\[Tau]Val", "=", 
        RowBox[{"c\[Tau]BL", "[", 
         RowBox[{"m", ",", "\[Alpha]B"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"brvis", "=", 
        RowBox[{"BrVis", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ilist", "=", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"{", 
          RowBox[{"ival", ",", "1", ",", "2", ",", "3"}], "}"}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"tablegrid1", "=", 
        RowBox[{"SortBy", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"ilist", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"ilist", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"ilist", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "&"}], "/@", 
           RowBox[{"tableGridPrefac", "[", 
            RowBox[{"tablegrid0", ",", "m", ",", "c\[Tau]Val"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"GridQuantity", "=", 
        RowBox[{
         RowBox[{"tablegrid1", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", 
         "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"LengthPerVariable", "=", 
        RowBox[{
         RowBox[{"Length", "[", "tablegrid1", "]"}], "/", 
         RowBox[{"Length", "[", "GridQuantity", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tab1", "=", 
        RowBox[{"NdiffCompiled", "[", 
         RowBox[{
         "tablegrid1", ",", "GridQuantity", ",", "LengthPerVariable", ",", 
          RowBox[{"NpotTimes\[Chi]val", "*", "brvis"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"tab1", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", "1", "}"}]}], "]"}], "]"}], ",", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"tab1", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}], "*", 
            SuperscriptBox["\[CapitalDelta]xval", 
             RowBox[{"-", "1"}]]}], ",", "1"}], "]"}], ",", "2"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mvaltest", "=", "0.021"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"\[Alpha]Btest", "=", 
    SuperscriptBox["10", 
     RowBox[{"-", "13."}]]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"quantity", "=", "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"LegendX", ":=", 
    RowBox[{"Association", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\"", "\[Rule]", 
        "\"\<\!\(\*SubscriptBox[\(E\), \(V\)]\) [GeV]\>\""}], ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", "\[Rule]", 
        "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(V\)]\) [rad]\>\""}], ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(x\), \(X\)]\)\>\"", "\[Rule]", " ", 
        "\"\<\!\(\*SubscriptBox[\(z\), \(V\)]\) [m]\>\""}]}], "}"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"LegendY", ":=", 
    RowBox[{"Association", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\"", "\[Rule]", 
        "\"\<\!\(\*SubscriptBox[\(dN\), \(ev\)]\)/\!\(\*SubscriptBox[\(dE\), \
\(V\)]\) [\!\(\*SuperscriptBox[\(GeV\), \(-1\)]\)]\>\""}], ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", "\[Rule]", 
        "\"\<\!\(\*SubscriptBox[\(dN\), \(ev\)]\)/\!\(\*SubscriptBox[\(d\
\[Theta]\), \(V\)]\) [\!\(\*SuperscriptBox[\(rad\), \(-1\)]\)]\>\""}], ",", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(x\), \(X\)]\)\>\"", "\[Rule]", " ", 
        "\"\<\!\(\*SubscriptBox[\(dN\), \(ev\)]\)/\!\(\*SubscriptBox[\(dz\), \
\(V\)]\) [\!\(\*SuperscriptBox[\(m\), \(-1\)]\)]\>\""}]}], "}"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"prodlisttemp", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{"mBLmin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}], 
          "]"}], "<", "mvaltest", "<", 
         RowBox[{"Min", "[", 
          RowBox[{"mmax\[Epsilon]", ",", 
           RowBox[{"mBLmax", "[", "prod", "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"prodlisttemp", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"prodlisttemp", ",", 
            RowBox[{"{", "prod", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"NdiffData", "[", "prod", "]"}], "=", 
          RowBox[{"NeventsDifferentialDiscret", "[", 
           RowBox[{
           "mvaltest", ",", "prod", ",", "\[Alpha]Btest", ",", "quantity"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"XvalminmaxNdiff", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"NdiffData", "[", "prod", "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ">", 
                SuperscriptBox["10", 
                 RowBox[{"-", "40"}]]}], "&"}]}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "MinMax"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"NdiffInt", "[", 
           RowBox[{"X_", ",", "prod"}], "]"}], "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"XvalminmaxNdiff", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "<", "X", "<", 
             RowBox[{"XvalminmaxNdiff", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"10", "^", 
              RowBox[{
               RowBox[{"Interpolation", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log10", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Log10", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "90"}]]}], "]"}]}], "}"}], "&"}], "/@", 
                  RowBox[{"NdiffData", "[", "prod", "]"}]}], ",", 
                 RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
               RowBox[{"Log10", "[", "X", "]"}], "]"}]}], "]"}], ",", "0"}], 
           "]"}]}]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NdiffInt", "[", 
      RowBox[{"X_", ",", "\"\<Total\>\""}], "]"}], "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"NdiffInt", "[", 
        RowBox[{"X", ",", "prod"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"prod", ",", "prodlisttemp"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LegendList", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", "\"\<Total\>\"", "}"}], ",", "prodlisttemp"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"QuantityMinMax", "=", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"MinMax", "[", 
          RowBox[{
           RowBox[{"NdiffData", "[", "prod", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"prod", ",", "prodlisttemp"}], "}"}]}], "]"}], ",", "1"}], 
      "]"}], "//", "MinMax"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ValueMinMax", "=", 
     RowBox[{"Max", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"NdiffData", "[", "#", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "&"}], "/@", 
       "prodlisttemp"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"LogPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NdiffInt", "[", 
         RowBox[{"X", ",", "prod"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "LegendList"}], "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"X", ",", 
       RowBox[{"QuantityMinMax", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"QuantityMinMax", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox["10", 
           RowBox[{"-", "5"}]], ",", 
          RowBox[{"2", "ValueMinMax"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Black"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Darker", "@", 
           RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Darker", "@", "Cyan"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Magenta"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Blue", ",", 
          RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Darker", "@", "Red"}], ",", 
          RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Darker", "@", 
           RowBox[{"Darker", "@", "Green"}]}], ",", 
          RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"Placed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"#", ",", "18"}], "]"}], "&"}], "/@", "LegendList"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.85", ",", "0.65"}], "}"}]}], "]"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"LegendX", "[", "quantity", "]"}], " ", ",", 
        RowBox[{"LegendY", "[", "quantity", "]"}]}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", " ", "23"}], "]"}]}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{
          "SelectedExperiment", ",", 
           "\"\<. \!\(\*SubscriptBox[\(m\), \(V\)]\) = \>\"", ",", "mvaltest",
            ",", "\"\< GeV, \[Alpha]B = \>\"", ",", "\[Alpha]Btest"}], "}"}], 
         "]"}], ",", "20", ",", "Black"}], "]"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8921163996135225`*^9, 3.8921164016036096`*^9}, {
   3.8921164560955544`*^9, 3.892116475031265*^9}, {3.892116516434699*^9, 
   3.8921165782759094`*^9}, {3.8921166461579666`*^9, 
   3.8921166470109124`*^9}, {3.8921167042134895`*^9, 3.892116729930051*^9}, {
   3.8927049818255663`*^9, 3.8927049991222277`*^9}, {3.8929115471019087`*^9, 
   3.892911593659387*^9}, {3.8929721720425777`*^9, 3.892972173350433*^9}, {
   3.8929722208773427`*^9, 3.8929722211847763`*^9}, {3.8932578131000147`*^9, 
   3.893257813645747*^9}, {3.8934746693595037`*^9, 3.893474675301323*^9}, {
   3.8935154039618015`*^9, 3.893515450284458*^9}, {3.893515943430369*^9, 
   3.893515962817915*^9}, 3.893516005738713*^9, {3.893516036174548*^9, 
   3.893516050479193*^9}, {3.893516088577403*^9, 3.893516089018369*^9}, {
   3.893516189974946*^9, 3.8935161902213464`*^9}, {3.8935162352543807`*^9, 
   3.8935162734266047`*^9}, {3.893516595793399*^9, 3.893516611219179*^9}, {
   3.893606026577932*^9, 3.8936060575609436`*^9}, 3.8955578364377675`*^9, {
   3.8969794021337876`*^9, 3.89697940417612*^9}, {3.897206579842867*^9, 
   3.897206594529684*^9}, {3.8972085445254173`*^9, 3.8972085493347607`*^9}, {
   3.897208919899889*^9, 3.897208931547951*^9}, {3.8972292867488394`*^9, 
   3.89722929702377*^9}, {3.8972306661965404`*^9, 3.8972306721050725`*^9}, {
   3.8972308816622453`*^9, 3.8972308867551355`*^9}, {3.897230981021118*^9, 
   3.8972310008076277`*^9}, {3.897231189574147*^9, 3.897231198411462*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[207]:=",ExpressionUUID->"8fdfedd9-98d6-4880-a73b-5685858a03c6"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Exporting tabulated number of events", "Title",
 CellChangeTimes->{{3.8850207904521627`*^9, 3.885020796464762*^9}, 
   3.886649940088234*^9},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"e88c37c1-5672-42b0-a672-\
f37f37980725"],

Cell[CellGroupData[{

Cell["Definitions", "Chapter",
 CellChangeTimes->{{3.8850542017641125`*^9, 3.885054203349573*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"467731da-736f-4990-a383-\
f7a9634caf34"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DirectoryQ", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<Tabulated Nevents\>\""}], "}"}], "]"}], "]"}], "//", 
       "ToString"}], ")"}], "\[Equal]", "\"\<False\>\""}], ",", 
    RowBox[{"CreateDirectory", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<Tabulated Nevents\>\""}], "}"}], "]"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DirectoryQ", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<Tabulated Nevents/B-3Le-Lmu+Ltau\>\""}], "}"}], "]"}], "]"}], 
       "//", "ToString"}], ")"}], "\[Equal]", "\"\<False\>\""}], ",", 
    RowBox[{"CreateDirectory", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<Tabulated Nevents/B-3Le-Lmu+Ltau\>\""}], "}"}], "]"}], "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DirectoryQ", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<Tabulated Nevents/B-3Le-Lmu+Ltau\>\"", ",", 
           "SelectedExperiment"}], "}"}], "]"}], "]"}], "//", "ToString"}], 
      ")"}], "\[Equal]", "\"\<False\>\""}], ",", 
    RowBox[{"CreateDirectory", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<Tabulated Nevents/B-3Le-Lmu+Ltau\>\"", ",", 
        "SelectedExperiment"}], "}"}], "]"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<Filenames with tabulated \!\(\*SubscriptBox[\(N\), \(events\)]\):\>\"",
   "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"FilenameNevents", "[", "prod", "]"}], "=", 
    RowBox[{"ToString", "@", 
     RowBox[{"StringForm", "[", 
      RowBox[{"\"\<Nevents_B-3Le-Lmu+Ltau_at_``_Npot=``_From_``.dat\>\"", ",", 
       RowBox[{"Sequence", "@@", 
        RowBox[{"{", 
         RowBox[{"SelectedExperiment", ",", 
          RowBox[{
           RowBox[{"NpotGivenExperiment", "//", "CForm"}], "//", "ToString"}],
           ",", 
          RowBox[{"ListExport", "[", "prod", "]"}]}], "}"}]}]}], "]"}]}]}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"prod", ",", "ProductionList"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"FilenameNevents", "[", "prod", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "//", 
  "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlistExport", "=", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "0.021", ",", "0.031", ",", "0.051", ",", "0.07", ",", "0.08", ",", 
        "0.09", ",", "0.1", ",", "0.11", ",", "0.12", ",", "0.125", ",", 
        "0.13", ",", "0.15", ",", "0.17", ",", "0.21", ",", "0.23", ",", 
        "0.25", ",", "0.3", ",", "0.35", ",", "0.4", ",", "0.45", ",", "0.5", 
        ",", "0.55", ",", "0.6", ",", "0.65", ",", "0.7", ",", "0.72", ",", 
        "0.73", ",", "0.74", ",", "0.75", ",", "0.76", ",", "0.77", ",", 
        "0.775", ",", "0.78", ",", "0.785", ",", "0.79", ",", "0.795", ",", 
        "0.8", ",", "0.81", ",", "0.82", ",", "0.84", ",", "0.9", ",", "0.95",
         ",", "1", ",", "1.1", ",", "1.2", ",", "1.3", ",", "1.4", ",", "1.5",
         ",", "1.6", ",", "1.7", ",", "1.8", ",", "1.9", ",", "2.", ",", 
        "2.1", ",", "2.2", ",", "2.3", ",", "2.4", ",", "2.5", ",", "2.6", 
        ",", "2.7", ",", "2.8", ",", "2.9"}], "}"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{"mV", ",", 
        RowBox[{"{", 
         RowBox[{"mV", ",", "3", ",", 
          RowBox[{"Max", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"mBLmax", "[", "prod", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "]"}], 
          ",", 
          FractionBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"mBLmax", "[", "prod", "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], 
              "]"}], "-", "3"}], ")"}], "10"]}], "}"}]}], "]"}]}], "]"}], "//",
     "N"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]Blist", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      SuperscriptBox["10", "x"], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"-", "20.8"}], ",", 
        RowBox[{"-", "6"}], ",", "0.05"}], "}"}]}], "]"}], "//", "N"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8850528402073092`*^9, 3.885052964529935*^9}, {
   3.8850529967024455`*^9, 3.88505313318991*^9}, {3.885053172661522*^9, 
   3.885053247354876*^9}, {3.885053717249408*^9, 3.8850537696983976`*^9}, {
   3.885054057416253*^9, 3.88505420740788*^9}, {3.8850542428480587`*^9, 
   3.885054257815028*^9}, {3.885054905514982*^9, 3.885054927992525*^9}, {
   3.88523276755499*^9, 3.885232776819412*^9}, {3.8854556204578223`*^9, 
   3.8854556494874506`*^9}, {3.8854560165278835`*^9, 
   3.8854561921232824`*^9}, {3.8854563516684437`*^9, 
   3.8854563631681647`*^9}, {3.885456439233843*^9, 3.885456605782855*^9}, {
   3.8854567400235205`*^9, 3.885456743964001*^9}, {3.885542660052145*^9, 
   3.8855427304549437`*^9}, {3.8855427881537523`*^9, 3.885542788237467*^9}, {
   3.8855430067620525`*^9, 3.885543013668437*^9}, 3.885966882096207*^9, {
   3.8859669421437807`*^9, 3.8859669421488247`*^9}, {3.885968641323983*^9, 
   3.8859686709916077`*^9}, {3.8859700818035088`*^9, 3.885970116005333*^9}, {
   3.8859726427933483`*^9, 3.8859726621626787`*^9}, {3.8859727076000075`*^9, 
   3.885972770558454*^9}, {3.8860482606809826`*^9, 3.886048270758037*^9}, {
   3.88684029377495*^9, 3.8868404665509343`*^9}, {3.8868414104888535`*^9, 
   3.8868414225159225`*^9}, {3.8890817621378937`*^9, 3.889081762140961*^9}, {
   3.88908460476051*^9, 3.889084604763502*^9}, {3.892188794960414*^9, 
   3.8921888564262486`*^9}, 3.892276504856449*^9, {3.892705877974984*^9, 
   3.8927058964920373`*^9}, {3.89270597977682*^9, 3.892706000159081*^9}, 
   3.892890275686406*^9, 3.892890565684495*^9, {3.8928906683120165`*^9, 
   3.8928906691645193`*^9}, {3.8928921066767316`*^9, 3.892892205794788*^9}, {
   3.8928923091023135`*^9, 3.8928923130853605`*^9}, {3.892893113220736*^9, 
   3.8928931146965623`*^9}, 3.894102992835754*^9, {3.894103048542028*^9, 
   3.894103048553049*^9}, {3.894119546680724*^9, 3.894119551777257*^9}, {
   3.894119628558914*^9, 3.8941196285728793`*^9}, {3.894383718978174*^9, 
   3.894383724497221*^9}, {3.895053675229704*^9, 3.895053699155879*^9}, {
   3.8950543723988295`*^9, 3.8950543729039392`*^9}, {3.8950754500539494`*^9, 
   3.895075454511196*^9}, 3.895075720150195*^9, {3.895076101110735*^9, 
   3.895076104956934*^9}, {3.895076217547658*^9, 3.8950762221766434`*^9}, {
   3.8951286657148056`*^9, 3.895128711091617*^9}, {3.895128773120426*^9, 
   3.8951287732463627`*^9}, 3.896328780612984*^9, {3.8963335976756763`*^9, 
   3.8963336111343164`*^9}, {3.89633387517167*^9, 3.8963338858646145`*^9}, {
   3.896334050959136*^9, 3.896334051795125*^9}, {3.8972312902710857`*^9, 
   3.8972312902735853`*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[223]:=",ExpressionUUID->"174ebf85-9857-4386-8470-e65a5626569a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Exporting", "Chapter",
 CellChangeTimes->{{3.885054212114191*^9, 3.885054213032151*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"5f5b828d-8b4c-4810-b7e1-\
40220dc731f8"],

Cell[CellGroupData[{

Cell["Common definition", "Section",
 CellChangeTimes->{{3.8921886043857117`*^9, 3.8921886076155424`*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"44858871-cd0c-4847-b635-\
72be80b9d716"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BlockExport", "[", "ProdChannel_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"ProductionList", ",", 
         RowBox[{
          RowBox[{"#", "\[Equal]", "ProdChannel"}], "&"}]}], "]"}], 
       "\[Equal]", 
       RowBox[{"{", "}"}]}], ",", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mlist", "=", "mlistExport"}], ";", "\[IndentingNewLine]", 
       RowBox[{"TabFrom", "=", 
        RowBox[{"Monitor", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"NeventsDiscret", "[", 
             RowBox[{
              RowBox[{"mlist", "[", 
               RowBox[{"[", "k", "]"}], "]"}], ",", "ProdChannel", ",", 
              "\[Alpha]Blist"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", 
              RowBox[{"Length", "[", "mlist", "]"}], ",", "1"}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"Row", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ProgressIndicator", "[", 
               RowBox[{"k", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"Length", "[", "mlist", "]"}]}], "}"}]}], "]"}], 
              ",", "\"\<i = \>\"", ",", "k", ",", "\"\</\>\"", ",", 
              RowBox[{"Length", "[", "mlist", "]"}], ",", "\"\<, m = \>\"", 
              ",", 
              RowBox[{"mlist", "[", 
               RowBox[{"[", "k", "]"}], "]"}], ",", "\"\< GeV\>\""}], "}"}], 
            ",", "\"\< \>\""}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], ",", 
            "\"\<Tabulated Nevents/B-3Le-Lmu+Ltau\>\"", ",", 
            "SelectedExperiment", ",", 
            RowBox[{"FilenameNevents", "[", "ProdChannel", "]"}]}], "}"}], 
          "]"}], ",", 
         RowBox[{"Flatten", "[", 
          RowBox[{"TabFrom", ",", "1"}], "]"}], ",", "\"\<Table\>\""}], 
        "]"}]}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8921886102299604`*^9, 3.892188661864987*^9}, {
   3.892188696661598*^9, 3.892188782889353*^9}, {3.8921888713769283`*^9, 
   3.8921888914281387`*^9}, {3.892190937661848*^9, 3.8921909466626697`*^9}, {
   3.8922765048644934`*^9, 3.8922765048725324`*^9}, {3.892705811436641*^9, 
   3.892705819446151*^9}, {3.8927060914745555`*^9, 3.892706101175784*^9}, {
   3.8928905580116014`*^9, 3.8928906317987432`*^9}, {3.8928906742211933`*^9, 
   3.8928907866742725`*^9}, {3.8928910005457926`*^9, 
   3.8928910006600027`*^9}, {3.89289241757715*^9, 3.892892422834627*^9}, 
   3.8941029928440056`*^9, 3.8941196285780835`*^9, {3.8950754385450172`*^9, 
   3.8950754440529957`*^9}, {3.896333620591139*^9, 3.8963336256644173`*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[231]:=",ExpressionUUID->"424f3dc4-256b-4d2e-b60e-346e465a221e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["From \[Omega]", "Section",
 CellChangeTimes->{{3.8850542186134644`*^9, 3.8850542291940546`*^9}, {
  3.8850543968830786`*^9, 3.8850543972568283`*^9}, {3.8854566349217353`*^9, 
  3.885456635821289*^9}, {3.885972781535964*^9, 3.8859727816462245`*^9}, {
  3.8868405138462644`*^9, 3.8868405154552355`*^9}, {3.8963406845993557`*^9, 
  3.8963406850078325`*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"2f9a7d64-af54-475f-aa75-\
4450513f3b90"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BlockExport", "[", "\"\<\[Omega]\>\"", "]"}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.885054438676489*^9, 3.8850544565771933`*^9}, {
   3.885232743746546*^9, 3.8852327455696564`*^9}, {3.8854560165334034`*^9, 
   3.885456016535404*^9}, {3.8854561722106504`*^9, 3.8854561810253243`*^9}, {
   3.885456572039451*^9, 3.885456572042471*^9}, 3.8854567168132315`*^9, {
   3.885966882096207*^9, 3.885966882111861*^9}, 3.88596694225861*^9, {
   3.8859686592730427`*^9, 3.8859686592730427`*^9}, 3.8859700818035088`*^9, {
   3.8859711713390193`*^9, 3.8859711713390193`*^9}, 3.885972642809*^9, {
   3.8859727972649345`*^9, 3.8859728174073486`*^9}, {3.8859734351944*^9, 
   3.885973440503255*^9}, 3.8859751994015455`*^9, {3.88684029377495*^9, 
   3.8868403457973137`*^9}, {3.8868404913113995`*^9, 
   3.8868405093728943`*^9}, {3.8921889013373675`*^9, 
   3.8921889088112135`*^9}, {3.8928909608793573`*^9, 
   3.8928909616041045`*^9}, {3.8941214563105764`*^9, 3.8941214564779606`*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[232]:=",ExpressionUUID->"c77110e8-a24e-4c88-ad89-111bc65c6742"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "From ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Pi]", "0"], TraditionalForm]],ExpressionUUID->
  "2d1fac7e-862c-4ace-be0e-7ba4ddfecfe5"]
}], "Section",
 CellChangeTimes->{{3.8850542186134644`*^9, 3.8850542193674097`*^9}, {
  3.8854566234521356`*^9, 3.8854566261318445`*^9}, {3.8859727833974495`*^9, 
  3.885972784062454*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"a041b4eb-6c23-4e7e-acf2-\
26da09bed5bd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
   "BlockExport", "[", "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", 
    "]"}], ";"}], "//", "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8850542358688993`*^9, 3.8850542382094545`*^9}, {
   3.885054277631763*^9, 3.885054363431921*^9}, {3.8854560510752897`*^9, 
   3.8854560510763087`*^9}, 3.8854563630285983`*^9, {3.8854565716829195`*^9, 
   3.885456571685834*^9}, {3.885456613051569*^9, 3.885456619872187*^9}, {
   3.8854567159384456`*^9, 3.8854567461856785`*^9}, {3.885966882111861*^9, 
   3.885966882111861*^9}, 3.88596694225861*^9, {3.8859686709916077`*^9, 
   3.8859686709916077`*^9}, 3.8859700984977875`*^9, {3.8859711713390193`*^9, 
   3.8859711713546066`*^9}, 3.885972642809*^9, {3.8859728028497868`*^9, 
   3.8859728172346563`*^9}, {3.8859734318322124`*^9, 3.8859734424226294`*^9}, 
   3.88684029377495*^9, {3.8868403355154448`*^9, 3.8868403457973137`*^9}, {
   3.8868404913113995`*^9, 3.8868405091895466`*^9}, {3.8921889129332795`*^9, 
   3.8921889150814333`*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[233]:=",ExpressionUUID->"63096b32-8586-4512-b56f-3c17a6bf2970"]
}, Open  ]],

Cell[CellGroupData[{

Cell["From \[Eta]", "Section",
 CellChangeTimes->{{3.8850542186134644`*^9, 3.8850542262841854`*^9}, {
  3.885456652772599*^9, 3.8854566559423475`*^9}, {3.885972849826418*^9, 
  3.8859728504409485`*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"e5d55d54-2ef1-4ca0-8c57-\
a5bf7891d57a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BlockExport", "[", "\"\<\[Eta]\>\"", "]"}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8850542358688993`*^9, 3.8850542382094545`*^9}, {
   3.885054277631763*^9, 3.8850543855153503`*^9}, {3.885456042480401*^9, 
   3.8854560424814262`*^9}, 3.8854561637649994`*^9, {3.88545657204498*^9, 
   3.885456572050495*^9}, {3.885456661477639*^9, 3.885456668992567*^9}, 
   3.8854567150256567`*^9, {3.885456747613888*^9, 3.885456747806327*^9}, {
   3.885966882111861*^9, 3.885966882111861*^9}, 3.88596694225861*^9, {
   3.885968649553114*^9, 3.885968649553114*^9}, 3.88597010984126*^9, {
   3.8859711713546066`*^9, 3.8859711713546066`*^9}, 3.8859726428246174`*^9, {
   3.8859728172346563`*^9, 3.885972835680069*^9}, {3.8859734334967036`*^9, 
   3.8859734464846907`*^9}, 3.886840293790572*^9, {3.8868403355154448`*^9, 
   3.8868403457973137`*^9}, {3.8868404913113995`*^9, 
   3.8868405091940784`*^9}, {3.8921889165620794`*^9, 3.8921889193536544`*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[234]:=",ExpressionUUID->"599da06f-0910-49a0-b917-1e643ca8f020"]
}, Open  ]],

Cell[CellGroupData[{

Cell["From \[Eta]\[CloseCurlyQuote]", "Section",
 CellChangeTimes->{{3.8850542186134644`*^9, 3.88505422780166*^9}, {
  3.8854566729323483`*^9, 3.8854566730023046`*^9}, {3.8854567532255774`*^9, 
  3.8854567544560757`*^9}, {3.885972845923894*^9, 3.8859728471400375`*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"460821e0-fe26-4568-9a11-\
ecfd96998e58"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BlockExport", "[", "\"\<\[Eta]'\>\"", "]"}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8850544007056713`*^9, 3.885054414558234*^9}, {
   3.8854560332901382`*^9, 3.8854560332917004`*^9}, 3.885456351259536*^9, {
   3.885456572052494*^9, 3.8854565720560255`*^9}, {3.8854566760728145`*^9, 
   3.885456710104888*^9}, {3.885456749954727*^9, 3.885456750125414*^9}, {
   3.885966882129011*^9, 3.885966882129011*^9}, 3.8859669422742825`*^9, {
   3.885968641323983*^9, 3.885968641323983*^9}, 3.885970116005333*^9, {
   3.8859711713546066`*^9, 3.8859711713546066`*^9}, 3.8859726428246174`*^9, {
   3.8859728172346563`*^9, 3.88597284134222*^9}, {3.8859733655214477`*^9, 
   3.8859733677543306`*^9}, {3.8859734210983605`*^9, 3.8859734260296836`*^9}, 
   3.886840293790572*^9, {3.8868403355154448`*^9, 3.8868403457973137`*^9}, {
   3.886840491326991*^9, 3.886840509197071*^9}, {3.8921889211231203`*^9, 
   3.892188925261114*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[235]:=",ExpressionUUID->"493c5b24-1484-45e7-a56d-461c1340dbc7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["From brem", "Section",
 CellChangeTimes->{{3.8850542186134644`*^9, 3.88505422780166*^9}, {
  3.8854566729323483`*^9, 3.8854566730023046`*^9}, {3.8854567532255774`*^9, 
  3.8854567544560757`*^9}, {3.885972845923894*^9, 3.8859728471400375`*^9}, {
  3.886840537898929*^9, 3.8868405387356443`*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"61e408ed-b1d0-40c3-920b-\
811b280dd11b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BlockExport", "[", "\"\<Brem\>\"", "]"}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8850544007056713`*^9, 3.885054414558234*^9}, {
   3.8854560332901382`*^9, 3.8854560332917004`*^9}, 3.885456351259536*^9, {
   3.885456572052494*^9, 3.8854565720560255`*^9}, {3.8854566760728145`*^9, 
   3.885456710104888*^9}, {3.885456749954727*^9, 3.885456750125414*^9}, {
   3.885966882129011*^9, 3.885966882129011*^9}, 3.8859669422742825`*^9, {
   3.885968641323983*^9, 3.885968641323983*^9}, 3.885970116005333*^9, {
   3.8859711713546066`*^9, 3.8859711713546066`*^9}, 3.8859726428246174`*^9, {
   3.8859728172346563`*^9, 3.88597284134222*^9}, {3.8859733655214477`*^9, 
   3.8859733677543306`*^9}, {3.8859734210983605`*^9, 3.8859734260296836`*^9}, 
   3.886840293790572*^9, {3.8868403355154448`*^9, 3.8868403457973137`*^9}, {
   3.886840491326991*^9, 3.886840509197071*^9}, {3.886840545411461*^9, 
   3.886840549214155*^9}, {3.889081762210126*^9, 3.889081762211681*^9}, {
   3.8890846047694187`*^9, 3.8890846047709637`*^9}, {3.8921889274207916`*^9, 
   3.8921889293474207`*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[236]:=",ExpressionUUID->"200de915-86bb-4415-8b82-8f9668a26856"]
}, Open  ]],

Cell[CellGroupData[{

Cell["From Drell-Yan", "Section",
 CellChangeTimes->{{3.8850542186134644`*^9, 3.88505422780166*^9}, {
  3.8854566729323483`*^9, 3.8854566730023046`*^9}, {3.8854567532255774`*^9, 
  3.8854567544560757`*^9}, {3.885972845923894*^9, 3.8859728471400375`*^9}, {
  3.8868405405752754`*^9, 3.8868405424509397`*^9}},
 CellTags->
  "Number-of-events-computation",ExpressionUUID->"3896d254-eb64-406f-b10e-\
f44b00c42fd6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BlockExport", "[", "\"\<Drell-Yan\>\"", "]"}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8850544007056713`*^9, 3.885054414558234*^9}, {
   3.8854560332901382`*^9, 3.8854560332917004`*^9}, 3.885456351259536*^9, {
   3.885456572052494*^9, 3.8854565720560255`*^9}, {3.8854566760728145`*^9, 
   3.885456710104888*^9}, {3.885456749954727*^9, 3.885456750125414*^9}, {
   3.885966882129011*^9, 3.885966882129011*^9}, 3.8859669422742825`*^9, {
   3.885968641323983*^9, 3.885968641323983*^9}, 3.885970116005333*^9, {
   3.8859711713546066`*^9, 3.8859711713546066`*^9}, 3.8859726428246174`*^9, {
   3.8859728172346563`*^9, 3.88597284134222*^9}, {3.8859733655214477`*^9, 
   3.8859733677543306`*^9}, {3.8859734210983605`*^9, 3.8859734260296836`*^9}, 
   3.886840293790572*^9, {3.8868403355154448`*^9, 3.8868403457973137`*^9}, {
   3.886840491326991*^9, 3.886840509197071*^9}, {3.8868405509523153`*^9, 
   3.8868405563659854`*^9}, {3.892188931092238*^9, 3.892188935234996*^9}},
 CellTags->"Number-of-events-computation",
 CellLabel->
  "In[237]:=",ExpressionUUID->"d3f683e3-6a2f-4fcd-a632-06bfa20799c6"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Computing sensitivities", "Title",
 CellChangeTimes->{{3.885020809493571*^9, 3.88502081261261*^9}},
 CellTags->{
  "Sensitivity", 
   "Re-evaluation"},ExpressionUUID->"b325d0e7-8149-4766-b60a-f8bf01de77e1"],

Cell[CellGroupData[{

Cell["\<\
Specifying the experiment and interpolating tabulated number of events\
\>", "Chapter",
 CellChangeTimes->{{3.8865657605515084`*^9, 3.886565789800824*^9}, {
  3.8891547325867977`*^9, 3.8891547373469143`*^9}},
 CellTags->{
  "Sensitivity", 
   "Re-evaluation"},ExpressionUUID->"45591364-b684-40cc-bddc-205fa3d2c3f1"],

Cell[BoxData[{
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"DirectoryQ", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", 
          "\"\<Sensitivity domains\>\""}], "}"}], "]"}], "]"}], "//", 
      "ToString"}], ")"}], "\[Equal]", "\"\<False\>\""}], ",", 
   RowBox[{"CreateDirectory", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", 
       "\"\<Sensitivity domains\>\""}], "}"}], "]"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"DirectoryQ", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", 
          "\"\<Sensitivity domains\>\"", ",", "\"\<B-3Le-Lmu+Ltau\>\""}], 
         "}"}], "]"}], "]"}], "//", "ToString"}], ")"}], "\[Equal]", 
    "\"\<False\>\""}], ",", 
   RowBox[{"CreateDirectory", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", 
       "\"\<Sensitivity domains\>\"", ",", "\"\<B-3Le-Lmu+Ltau\>\""}], "}"}], 
     "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NeventsDirectory", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<Tabulated Nevents\>\"", ",", "\"\<B-3Le-Lmu+Ltau\>\""}], "}"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentDirectoriesListNevents", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"FileNames", "[", 
      RowBox[{"\"\<*\>\"", ",", "NeventsDirectory", ",", "1"}], "]"}], ",", 
     "DirectoryQ"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<List of available experiments with tabulated \!\(\*SubscriptBox[\(N\), \
\(events\)]\) for dark photons:\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentsListNevents", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"FileNameTake", "[", 
       RowBox[{
        RowBox[{"ExperimentDirectoriesListNevents", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "ExperimentDirectoriesListNevents", "]"}], ",",
         "1"}], "}"}]}], "]"}], "//", "Sort"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ExperimentsListNevents", "//", "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", "ExperimentsListNevents", "]"}], "\[Equal]", "0"}],
    ",", 
   RowBox[{
   "Print", "[", 
    "\"\<No experiment is available, generate first the acceptance for the \
given experiment using module 1 and the FIP distributions using the module \
2\>\"", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Selected experiment:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", "ExperimentsListNevents", "]"}], "\[NotEqual]", 
    "0"}], ",", 
   RowBox[{"GivenExperimentForSensitivityComputation", "=", 
    RowBox[{"dropdownDialog", "[", 
     RowBox[{
     "ExperimentsListNevents", ",", "\"\<Select the experiment:\>\""}], 
     "]"}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CondANUBIS", "=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<ANUBIS-shaft-volume-1\>\"", ",", "\"\<ANUBIS-shaft-volume-2\>\"", 
       ",", "\"\<ANUBIS-shaft-volume-3\>\""}], "}"}], ",", 
     "GivenExperimentForSensitivityComputation"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"CondANUBIS", "\[Equal]", "True"}], ",", 
   RowBox[{"infoDialog", "[", 
    RowBox[{"Row", "[", 
     RowBox[{
     "{", "\"\<One of the modules of ANUBIS-shaft is chosen. The full \
sensitivity includes three modules. The importing will be over all modules, \
so for all ot the the sensitivity has to be computed\>\"", "}"}], "]"}], 
    "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"CondANUBIS", "\[Equal]", "False"}], ",", 
    RowBox[{"GivenExperimentForSensitivityComputationList", "=", 
     RowBox[{"{", "GivenExperimentForSensitivityComputation", "}"}]}], ",", 
    RowBox[{"GivenExperimentForSensitivityComputationList", "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\<ANUBIS-shaft-volume-1\>\"", ",", "\"\<ANUBIS-shaft-volume-2\>\"", 
       ",", "\"\<ANUBIS-shaft-volume-3\>\""}], "}"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filesNevents", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"filesNevents", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"filesNevents", ",", 
       RowBox[{"FileNames", "[", 
        RowBox[{"\"\<*.dat\>\"", ",", 
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], ",", 
            "\"\<Tabulated Nevents/B-3Le-Lmu+Ltau\>\"", ",", "exp"}], "}"}], 
          "]"}]}], "]"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "GivenExperimentForSensitivityComputationList"}], 
     "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<List of production channels:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FilenamesNevents", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Last", "@", 
      RowBox[{"FileNameSplit", "@", 
       RowBox[{"filesNevents", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "filesNevents", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FilenameParameters", "[", "i_", "]"}], ":=", 
  RowBox[{
   RowBox[{"StringCases", "[", 
    RowBox[{
     RowBox[{"FilenamesNevents", "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{
      "\"\<Nevents_B-3Le-Lmu+Ltau_at_\>\"", "~~", "experiment__", "~~", 
       "\"\<_Npot=\>\"", "~~", "Npot__", "~~", "\"\<_From_\>\"", "~~", 
       "mother__", "~~", "\"\<.dat\>\""}], ":>", 
      RowBox[{"{", 
       RowBox[{"experiment", ",", "Npot", ",", "mother"}], "}"}]}]}], "]"}], 
   "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductionChannelsList", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"FilenameParameters", "[", "i", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "FilenamesNevents", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Experiment\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(N\), \(PoT\)]\)\>\"", ",", 
       "\"\<Mother\>\""}], "}"}], "}"}], ",", "ProductionChannelsList"}], 
   "]"}], "//", "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NeventsTabulatedList", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{"filesNevents", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<Table\>\""}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "filesNevents", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NpotDefault", "=", 
   RowBox[{
    RowBox[{"Interpreter", "[", "\"\<Number\>\"", "]"}], "[", 
    RowBox[{
     RowBox[{"ProductionChannelsList", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mminmaxTabulated", "[", "i_", "]"}], ":=", 
  RowBox[{"MinMax", "[", 
   RowBox[{
    RowBox[{"NeventsTabulatedList", "[", 
     RowBox[{"[", "i", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]Bminmaxtabulated", "[", "i_", "]"}], ":=", 
  RowBox[{"MinMax", "[", 
   RowBox[{
    RowBox[{"NeventsTabulatedList", "[", 
     RowBox[{"[", "i", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mminmaxOverall", "=", 
   RowBox[{"MinMax", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"mminmaxTabulated", "[", "i", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "NeventsTabulatedList", "]"}], ",", "1"}], 
        "}"}]}], "]"}], "//", "Flatten"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]Bminmaxoverall", "=", 
   RowBox[{"MinMax", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"\[Alpha]Bminmaxtabulated", "[", "i", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "NeventsTabulatedList", "]"}], ",", "1"}], 
        "}"}]}], "]"}], "//", "Flatten"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nevint", "[", "i_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"mminmaxTabulated", "[", "i", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", " ", "mV", 
      "\[LessEqual]", 
      RowBox[{
       RowBox[{"mminmaxTabulated", "[", "i", "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "&&", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Alpha]Bminmaxtabulated", "[", "i", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", "\[Alpha]B", 
      "\[LessEqual]", 
      RowBox[{
       RowBox[{"\[Alpha]Bminmaxtabulated", "[", "i", "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
    RowBox[{"Evaluate", "[", 
     RowBox[{"10", "^", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Log10", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
              RowBox[{"Log10", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
              RowBox[{"Log10", "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "+", 
                SuperscriptBox["10", 
                 RowBox[{"-", "90"}]]}], "]"}]}], "}"}], "&"}], "/@", 
           RowBox[{"NeventsTabulatedList", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
        RowBox[{
         RowBox[{"Log10", "[", "mV", "]"}], ",", 
         RowBox[{"Log10", "[", "\[Alpha]B", "]"}]}], "]"}], ")"}]}], "]"}], 
    ",", "0"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NevIntList", "[", 
    RowBox[{"mV_", ",", "\[Alpha]B_"}], "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Nevint", "[", "i", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "NeventsTabulatedList", "]"}], ",", "1"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NevTot", "[", 
    RowBox[{"mV_", ",", "\[Alpha]B_"}], "]"}], "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NevIntList", "[", 
       RowBox[{"mV", ",", "\[Alpha]B"}], "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"NevIntList", "[", 
         RowBox[{"mV", ",", "\[Alpha]B"}], "]"}], "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentFolder", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"CondANUBIS", "\[Equal]", "True"}], ",", "\"\<ANUBIS-shaft\>\"", 
     ",", "GivenExperimentForSensitivityComputation"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"DirectoryQ", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", 
          "\"\<Sensitivity domains\>\"", ",", "\"\<B-3Le-Lmu+Ltau\>\"", ",", 
          "ExperimentFolder"}], "}"}], "]"}], "]"}], "//", "ToString"}], 
     ")"}], "\[Equal]", "\"\<False\>\""}], ",", 
   RowBox[{"CreateDirectory", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", 
       "\"\<Sensitivity domains\>\"", ",", "\"\<B-3Le-Lmu+Ltau\>\"", ",", 
       "ExperimentFolder"}], "}"}], "]"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.886840860661646*^9, 3.886840860664637*^9}, 
   3.8890817880618696`*^9, {3.8891547447151575`*^9, 3.8891549444728413`*^9}, {
   3.8891555762544374`*^9, 3.8891555856760416`*^9}, {3.8932345510125337`*^9, 
   3.89323456368647*^9}, {3.89357120648059*^9, 3.8935714592585745`*^9}, {
   3.893571545207655*^9, 3.8935715786721*^9}, {3.8935716945595617`*^9, 
   3.8935717354831114`*^9}, {3.893572484980073*^9, 3.8935725300692596`*^9}, {
   3.894102992903054*^9, 3.8941029929322805`*^9}, 3.894103048598019*^9, {
   3.8941196286717653`*^9, 3.8941196286962852`*^9}, 3.89412146555618*^9, {
   3.895053708153989*^9, 3.895053743648246*^9}, {3.895054322114892*^9, 
   3.895054324779189*^9}, {3.896328714144388*^9, 3.8963287281646676`*^9}, 
   3.8963287730291877`*^9, {3.8968466448954763`*^9, 3.896846648542315*^9}, 
   3.8991933708202333`*^9},
 CellTags->{"Sensitivity", "Re-evaluation"},
 CellLabel->"In[6]:=",ExpressionUUID->"df4d9c4d-9d21-44e6-a82d-5888c4707675"],

Cell[CellGroupData[{

Cell["Events density plot", "Section",
 CellChangeTimes->{{3.8928925129732084`*^9, 3.8928925141322923`*^9}, {
  3.892910359615284*^9, 3.892910363538608*^9}},
 CellTags->{
  "Sensitivity", 
   "Re-evaluation"},ExpressionUUID->"266e00eb-c0b0-4e4d-b15a-43e3f24ebbdf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Nevmax", "=", 
   RowBox[{"Max", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Max", "[", 
       RowBox[{"NeventsTabulatedList", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "NeventsTabulatedList", "]"}], ",", "1"}], 
       "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"plot", "=", 
  RowBox[{"DensityPlot", "[", 
   RowBox[{
    RowBox[{"Evaluate", "[", 
     RowBox[{"Log10", "[", 
      RowBox[{"NevTot", "[", 
       RowBox[{"mV", ",", "\[Alpha]B"}], "]"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"mV", ",", 
      RowBox[{"mminmaxOverall", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"mminmaxOverall", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Alpha]B", ",", 
      RowBox[{"\[Alpha]Bminmaxoverall", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"\[Alpha]Bminmaxoverall", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"ScalingFunctions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Log\>\"", ",", "\"\<Log\>\""}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "0.78"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"All", ",", "All", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log10", "[", "2.3", "]"}], ",", 
         RowBox[{"Log10", "[", "Nevmax", "]"}]}], "}"}]}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(m\), \(V\)]\) [GeV]\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(\[Alpha]\), \(B\)]\)\>\""}], "}"}]}], ",", 
    " ", 
    RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", " ", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", " ", "25"}], "]"}]}], ",", 
    RowBox[{"PlotPoints", "\[Rule]", "100"}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"Placed", "[", 
      RowBox[{
       RowBox[{"BarLegend", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Automatic", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Log10", "[", "2.3", "]"}], ",", 
             RowBox[{"Log10", "[", "Nevmax", "]"}]}], "}"}]}], "}"}], ",", 
         RowBox[{"LegendMarkerSize", "\[Rule]", "340"}], ",", 
         RowBox[{"LegendLabel", "\[Rule]", 
          RowBox[{"Placed", "[", 
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(Log\), \
\(10\)]\)[\!\(\*SubscriptBox[\(N\), \(ev\)]\)]\>\"", ",", "Bottom"}], "]"}]}],
          ",", 
         RowBox[{"LabelStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"FontSize", "\[Rule]", "22"}], "}"}]}], ",", 
         RowBox[{"Method", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
            RowBox[{"AxesStyle", "\[Rule]", "None"}], ",", 
            RowBox[{"TicksStyle", "\[Rule]", "Black"}]}], "}"}]}]}], "]"}], 
       ",", "Right"}], "]"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{"{", "ExperimentFolder", "}"}], "]"}], ",", "20", ",", 
       "Black"}], "]"}]}]}], 
   RowBox[{"(*", 
    RowBox[{",", 
     RowBox[{"FrameTicks", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Automatic", ",", "Automatic"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"TicksPlotx", ",", "None"}], "}"}]}], "}"}]}]}], "*)"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<NeventsDensityPlotExample.pdf\>\""}], "}"}], "]"}], ",", 
     "plot"}], "]"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.8929096922410564`*^9, 3.892909806303069*^9}, {
   3.8929100920281754`*^9, 3.8929100955435038`*^9}, {3.8929101335841722`*^9, 
   3.892910162228066*^9}, {3.8929101949082084`*^9, 3.8929101952618375`*^9}, {
   3.893481779378194*^9, 3.893481781603961*^9}, {3.8935713726623445`*^9, 
   3.8935713726663337`*^9}, 3.893571593533576*^9, {3.893600462416499*^9, 
   3.893600464823284*^9}, {3.8936007175747695`*^9, 3.8936007273021555`*^9}, {
   3.8936008794615602`*^9, 3.8936008816425495`*^9}, {3.893605565414917*^9, 
   3.8936055685099897`*^9}, {3.8941029929340925`*^9, 3.894102992943181*^9}, {
   3.894383732910619*^9, 3.8943837352369757`*^9}},
 CellTags->{"Sensitivity", "Re-evaluation"},
 CellLabel->"In[38]:=",ExpressionUUID->"f973800a-aeba-4984-a6dc-1e86d5e8f2bd"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Computing sensitivities", "Chapter",
 CellChangeTimes->{{3.8865657683592186`*^9, 3.8865657710012517`*^9}},
 CellTags->{
  "Sensitivity", 
   "Re-evaluation"},ExpressionUUID->"259adc86-d81a-4351-8fcc-3f984b19bc2e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SensitivityBlock", "[", 
    RowBox[{"Nev_", ",", "Npot_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RegSens", "=", 
       RowBox[{"RegionPlot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox["Npot", "NpotDefault"], 
           RowBox[{"NevTot", "[", 
            RowBox[{
             SuperscriptBox["10", "mV"], ",", 
             SuperscriptBox["10", "\[Alpha]B"]}], "]"}]}], "\[GreaterEqual]", 
          "Nev"}], ",", 
         RowBox[{"{", 
          RowBox[{"mV", ",", 
           RowBox[{"Log10", "[", 
            RowBox[{"mminmaxOverall", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
           RowBox[{"Log10", "[", 
            RowBox[{"mminmaxOverall", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Alpha]B", ",", 
           RowBox[{"Log10", "[", 
            RowBox[{"\[Alpha]Bminmaxoverall", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
           RowBox[{"Log10", "[", 
            RowBox[{"\[Alpha]Bminmaxoverall", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"PlotPoints", "->", "200"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SensTemp", "=", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"Normal", "@", "RegSens"}], ",", 
         RowBox[{
          RowBox[{"Line", "[", "x_", "]"}], "\[RuleDelayed]", "x"}], ",", 
         "Infinity"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Sens", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"10", "^", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"10", "^", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], "&"}], "/@", 
          RowBox[{"SensTemp", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "SensTemp", "]"}], ",", "1"}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<Sensitivity domains\>\"", ",", "\"\<B-3Le-Lmu+Ltau\>\"", ",", 
           "ExperimentFolder", ",", 
           RowBox[{"ToString", "@", 
            RowBox[{"StringForm", "[", 
             RowBox[{
             "\"\<Sensitivity_B-3Le-Lmu+Ltau_at_``_Nev=``_Npot=``.xls\>\"", 
              ",", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"{", 
                RowBox[{"ExperimentFolder", ",", 
                 RowBox[{"Nev", "//", "ToString"}], ",", 
                 RowBox[{
                  RowBox[{"Npot", "//", "CForm"}], "//", "ToString"}]}], 
                "}"}]}]}], "]"}]}]}], "}"}], "]"}], ",", "Sens"}], "]"}], ";",
       "\[IndentingNewLine]", "Sens"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"BC1bounds", "=", 
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", 
          "\"\<contours/B-L/B-L-excluded.txt\>\""}], "}"}], "]"}], ",", 
       "\"\<Table\>\""}], "]"}]}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"choiceNPoT", "=", 
   RowBox[{"dropdownDialog", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<Yes\>\"", ",", "\"\<No\>\""}], "}"}], ",", 
     RowBox[{"Row", "[", 
      RowBox[{"{", 
       RowBox[{
       "\"\<The number of proton collisions is \>\"", ",", " ", "NpotDefault",
         ",", "\"\<. Would you like to change it?\>\""}], "}"}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<The number of proton collisions for which the sensitivity will be \
calculated:\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"choiceNPoT", "==", "\"\<Yes\>\""}], ",", 
   RowBox[{"NpotSelected", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"DialogInput", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"br", "=", "\"\<\>\""}], "}"}], ",", 
        RowBox[{"Column", "[", 
         RowBox[{"{", 
          RowBox[{"\"\<Enter the number of proton collisions\>\"", ",", 
           RowBox[{"InputField", "[", 
            RowBox[{
             RowBox[{"Dynamic", "[", "br", "]"}], ",", "String"}], "]"}], ",", 
           RowBox[{"Button", "[", 
            RowBox[{"\"\<Proceed\>\"", ",", 
             RowBox[{"DialogReturn", "[", "br", "]"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "Automatic"}]}], "]"}]}], "}"}], 
         "]"}]}], "]"}], "//", "ToExpression"}], "//", "N"}]}], ",", 
   RowBox[{"NpotSelected", "=", "NpotDefault"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<The minimal value of \!\(\*SubscriptBox[\(N\), \(events\)]\) for which \
the sensitivity will be computed:\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"NevMinVal", "=", 
  RowBox[{
   RowBox[{"DialogInput", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nev", "=", "\"\<\>\""}], "}"}], ",", 
     RowBox[{"Column", "[", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Enter the value of \!\(\*SubscriptBox[\(N\), \(events\)]\) for \
which the sensitivity will be computed:\>\"", ",", 
        RowBox[{"InputField", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "nev", "]"}], ",", "Number"}], "]"}], ",", 
        RowBox[{"Button", "[", 
         RowBox[{"\"\<Proceed\>\"", ",", 
          RowBox[{"DialogReturn", "[", "nev", "]"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Automatic"}]}], "]"}]}], "}"}], 
      "]"}]}], "]"}], "//", "N"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sens", "=", 
   RowBox[{"SensitivityBlock", "[", 
    RowBox[{"NevMinVal", ",", "NpotSelected"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListLogLogPlot", "[", 
    RowBox[{
     RowBox[{"Cases", "[", 
      RowBox[{
       RowBox[{"{", "sens", 
        RowBox[{"(*", 
         RowBox[{",", "BC1bounds"}], "*)"}], "}"}], ",", 
       RowBox[{"_", "?", "MatrixQ"}], ",", "All"}], "]"}], ",", 
     RowBox[{"Joined", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"True", ",", "True", ",", "True", ",", "True"}], "}"}]}], ",", 
     " ", 
     RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(m\), \(V\)]\) [GeV]\>\"", " ", ",", " ", 
        "\"\<\!\(\*SubscriptBox[\(\[Alpha]\), \(B\)]\)\>\""}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", " ", "23"}], "]"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ConstantArray", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MatrixQ", "[", "sens", "]"}], ",", "1", ",", 
              RowBox[{"Length", "@", "sens"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Thick", ",", "Gray"}], "}"}], ",", "1"}], "]"}]}], 
         "}"}], ",", "1"}], "]"}]}], ",", 
     RowBox[{"Filling", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "sens", "]"}], "+", "1"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Top", ",", 
          RowBox[{"Directive", "[", 
           RowBox[{"Gray", ",", 
            RowBox[{"Opacity", "[", "0.3", "]"}]}], "]"}]}], "}"}]}], "}"}]}],
      ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1.01", 
           RowBox[{"mminmaxOverall", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"1.1", 
           RowBox[{"mminmaxOverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Alpha]Bminmaxoverall", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"0.99", 
           RowBox[{"\[Alpha]Bminmaxoverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{
          "\"\<\!\(\*SubscriptBox[\(N\), \(events\)]\) \[GreaterEqual] \>\"", 
           ",", "NevMinVal"}], "}"}], "]"}], ",", "18", ",", "Black"}], 
       "]"}]}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"Placed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"#", ",", "15"}], "]"}], "&"}], "/@", 
         RowBox[{"{", "GivenExperimentForSensitivityComputation", "}"}]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"0.2", ",", "0.15"}], "}"}]}], "]"}]}]}], "]"}], 
   RowBox[{"(*", 
    RowBox[{",", 
     RowBox[{"LogLogPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", 
         SuperscriptBox["x", "2"], ",", 
         SuperscriptBox["x", "3"], ",", 
         SuperscriptBox["x", "4"], ",", 
         SuperscriptBox["x", "5"], ",", 
         SuperscriptBox["x", "6"]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0.05", ",", "62.49"}], "}"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.006", "]"}], ",", "Blue"}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.006", "]"}], ",", 
            RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.006", "]"}], ",", 
            RowBox[{"Darker", "@", "Red"}], ",", 
            RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.006", "]"}], ",", "Black"}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.01", "]"}], ",", 
            RowBox[{"Darker", "@", "Cyan"}], ",", 
            RowBox[{"Dashing", "[", "0.007", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", 
             RowBox[{"Darker", "@", "Green"}]}], ",", 
            RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", "Red"}]}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"#", ",", "15"}], "]"}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{
            "\"\<SHiP\>\"", ",", 
             "\"\<\!\(\*SubscriptBox[\(SHADOWS\), \(specified\\\ in\\\ LoI\)]\
\)\>\"", ",", 
             "\"\<\!\(\*SubscriptBox[\(SHADOWS\), \(specified\\\ by\\\ \
Gaia\)]\)\>\"", ",", " ", 
             "\"\<\!\(\*SubscriptBox[\(SHADOWS\), \(collab\\\ estimate\)]\)\>\
\""}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"0.26", ",", "0.15"}], "}"}]}], "]"}]}]}], "]"}]}], "*)"}],
    ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{"Text", "[", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"\"\<Excluded\>\"", ",", "24", ",", "Black"}], "]"}], ",", 
       RowBox[{"Scaled", "[", 
        RowBox[{"{", 
         RowBox[{"0.25", ",", "0.4"}], "}"}], "]"}]}], "]"}], "}"}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8891549915062704`*^9, 3.889154993345764*^9}, {
   3.8891550726092916`*^9, 3.8891550770006027`*^9}, {3.889155121639572*^9, 
   3.8891551652523565`*^9}, {3.8891552062371397`*^9, 3.889155265897581*^9}, {
   3.889155479601365*^9, 3.8891554816320353`*^9}, {3.893571372676326*^9, 
   3.8935713726903877`*^9}, {3.893571601881855*^9, 3.893571615039663*^9}, {
   3.8941029931930504`*^9, 3.8941029932221355`*^9}, 3.8941030486139164`*^9, 
   3.894119629020233*^9, 3.8941214839853907`*^9, {3.8941215210634184`*^9, 
   3.8941215236138077`*^9}, {3.894383762827285*^9, 3.8943837640994616`*^9}, {
   3.8950533766697893`*^9, 3.895053415330301*^9}, {3.8950537620454226`*^9, 
   3.895053768679489*^9}, {3.895054284537841*^9, 3.8950543001748314`*^9}, {
   3.895075741151188*^9, 3.8950757411643105`*^9}, {3.8950760588249235`*^9, 
   3.895076059035973*^9}, {3.8950776791008973`*^9, 3.8950776793146563`*^9}, {
   3.895655247634441*^9, 3.8956553080642867`*^9}, {3.896328714412816*^9, 
   3.8963287515284367`*^9}, {3.8963336431045375`*^9, 3.896333646053982*^9}, {
   3.8975481743723593`*^9, 3.897548193147577*^9}, {3.8977292209696465`*^9, 
   3.8977292289654875`*^9}},
 CellTags->{"Sensitivity", "Re-evaluation"},
 CellLabel->"In[40]:=",ExpressionUUID->"19c4a6cb-9ddf-48b5-a0fe-0c09ba565a1a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Deleting generated cells", "Title",
 CellChangeTimes->{{3.9025559465149946`*^9, 3.9025559494966087`*^9}},
 CellTags->{
  "Sensitivity", 
   "Re-evaluation"},ExpressionUUID->"0d9909f6-9490-4d2d-8202-096c8dd291ea"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"relaunch", "=", 
  RowBox[{"dropdownDialog", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\"\<Yes\>\"", ",", "\"\<No\>\""}], "}"}], ",", 
    RowBox[{"Row", "[", 
     RowBox[{
     "{", "\"\<Would you like to re-launch the sensitivity calculation for \
another experiment after the given computation?\>\"", "}"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"relaunch", "==", "\"\<Yes\>\""}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nb", "=", 
     RowBox[{"EvaluationNotebook", "[", "]"}]}], ";", "\n", 
    RowBox[{"NotebookFind", "[", 
     RowBox[{
     "nb", ",", "\"\<Re-evaluation\>\"", ",", "All", ",", "CellTags"}], "]"}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"relaunch", "==", "\"\<No\>\""}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"deletecellsopt", "=", 
     RowBox[{"dropdownDialog", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<Yes\>\"", ",", "\"\<No\>\""}], "}"}], ",", 
       RowBox[{"Row", "[", 
        RowBox[{
        "{", "\"\<Would you like to remove all the generated output \
cells?\>\"", "}"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"deletecellsopt", "==", "\"\<Yes\>\""}], ",", 
      RowBox[{
      "FrontEndTokenExecute", "[", "\"\<DeleteGeneratedCells\>\"", "]"}]}], 
     "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.9025559062888603`*^9, 3.9025559062888603`*^9}, {
  3.902555964086707*^9, 3.902555989355214*^9}, {3.902762914518731*^9, 
  3.9027629153685484`*^9}, {3.903971794302909*^9, 3.9039717948258586`*^9}, {
  3.9039718378117294`*^9, 3.9039718501952457`*^9}},
 CellTags->{"Sensitivity", "Re-evaluation"},
 CellLabel->"In[6]:=",ExpressionUUID->"279ad324-a369-4e15-9b38-d3bd7b52a2a6"]
}, Open  ]]
},
WindowSize->{1142.1, 570.9},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
ShowCellTags->True,
Magnification:>0.8 Inherited,
FrontEndVersion->"13.2 for Microsoft Windows (64-bit) (November 18, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"3b75f23e-e2cf-4606-b88f-358b7525490d"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Number-of-events"->{
  Cell[5675, 156, 283, 5, 89, "Title",ExpressionUUID->"eeccabcd-0c15-4514-9558-c56b32930132",
   CellTags->"Number-of-events"],
  Cell[5983, 165, 214, 4, 66, "Chapter",ExpressionUUID->"b0daed8d-c809-4422-9ee4-6612c9305a11",
   CellTags->"Number-of-events"],
  Cell[6200, 171, 6100, 163, 480, "Input",ExpressionUUID->"50979767-da80-48f9-b503-a276bde193fb",
   CellTags->"Number-of-events"],
  Cell[12337, 339, 343, 5, 66, "Chapter",ExpressionUUID->"059f5520-6181-4a09-92d4-f731378eccca",
   CellTags->"Number-of-events"],
  Cell[12705, 348, 180, 3, 66, "Section",ExpressionUUID->"25c60688-e782-46f3-9845-f0ddefe385dd",
   CellTags->"Number-of-events"],
  Cell[12888, 353, 7907, 199, 417, "Input",ExpressionUUID->"7f5d8f66-2da9-4671-940a-c53ba14987fb",
   CellTags->"Number-of-events"],
  Cell[20832, 557, 302, 5, 66, "Section",ExpressionUUID->"758fdb70-8fc0-4950-9280-a0db48e98f7d",
   CellTags->"Number-of-events"],
  Cell[21159, 566, 195, 3, 54, "Subsection",ExpressionUUID->"7a963466-3bc9-4e72-90f4-e32dd6169f27",
   CellTags->"Number-of-events"],
  Cell[21379, 573, 271, 4, 47, "Subsubsection",ExpressionUUID->"c956b9b9-02cf-4bba-b3b1-70f5c90d674b",
   CellTags->"Number-of-events"],
  Cell[21653, 579, 8250, 214, 381, "Input",ExpressionUUID->"4edbb780-206f-46e2-a0d6-f6e3f1acde51",
   CellTags->"Number-of-events"],
  Cell[29940, 798, 208, 3, 47, "Subsubsection",ExpressionUUID->"c4747bba-72ee-43ee-8fc9-5627f0d94a94",
   CellTags->"Number-of-events"],
  Cell[30151, 803, 22280, 554, 1000, "Input",ExpressionUUID->"396a3a98-4364-49a7-b52d-e1e8f4a5d79e",
   CellTags->"Number-of-events"],
  Cell[52480, 1363, 257, 5, 54, "Subsection",ExpressionUUID->"02e50908-da43-47aa-a1ba-caa52cc8b93c",
   CellTags->"Number-of-events"],
  Cell[52740, 1370, 6729, 178, 283, "Input",ExpressionUUID->"8d814f01-b0dd-4f8a-9760-73e57faaeabe",
   CellTags->"Number-of-events"],
  Cell[59506, 1553, 188, 3, 54, "Subsection",ExpressionUUID->"19f885f5-e34f-4c81-b419-80a9a356d56c",
   CellTags->"Number-of-events"],
  Cell[59697, 1558, 5305, 129, 215, "Input",ExpressionUUID->"5c368474-a50e-4442-ac88-0d8dba43c47f",
   CellTags->"Number-of-events"],
  Cell[65063, 1694, 245, 5, 66, "Chapter",ExpressionUUID->"1b378212-4ed2-4d4c-8d36-a259eabd1c69",
   CellTags->"Number-of-events"],
  Cell[65333, 1703, 239, 4, 54, "Subsection",ExpressionUUID->"0a03eb70-f700-40ba-bcf8-ed45270cc911",
   CellTags->"Number-of-events"],
  Cell[65575, 1709, 7659, 184, 234, "Input",ExpressionUUID->"af307eea-4f87-4f93-bef6-910257d2885a",
   CellTags->"Number-of-events"],
  Cell[73271, 1898, 240, 4, 54, "Subsection",ExpressionUUID->"8d9498ec-3be6-4cde-a641-d92e2914033a",
   CellTags->"Number-of-events"],
  Cell[73514, 1904, 7512, 182, 234, "Input",ExpressionUUID->"8aae74ab-0b98-486f-b29e-af2b72cca351",
   CellTags->"Number-of-events"],
  Cell[81087, 2093, 201, 3, 69, "Title",ExpressionUUID->"968fa4f0-ff0e-49b5-9961-c8c532a97325",
   CellTags->"Number-of-events"],
  Cell[81291, 2098, 6651, 171, 371, "Input",ExpressionUUID->"c8579664-56cf-4aa3-a66d-4bb791136bbc",
   CellTags->"Number-of-events"],
  Cell[87967, 2273, 204, 3, 66, "Chapter",ExpressionUUID->"fe521a3b-3582-49b1-81f8-e7d0eb93e787",
   CellTags->"Number-of-events"],
  Cell[88174, 2278, 1894, 47, 248, "Input",ExpressionUUID->"5523c656-a023-44f0-81eb-5c9ec9f88388",
   CellTags->"Number-of-events"]},
 "Number-of-events-computation"->{
  Cell[90117, 2331, 204, 4, 89, "Title",ExpressionUUID->"ce2dc008-ba4c-4a1a-8777-34a2b932d2e7",
   CellTags->"Number-of-events-computation"],
  Cell[90346, 2339, 321, 6, 66, "Chapter",ExpressionUUID->"3bf68ab5-5da5-4e0e-a052-8e2595821946",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[90670, 2347, 17112, 469, 656, "Input",ExpressionUUID->"3a5a6575-80ee-4cc7-9603-1ec1f7d2d73e",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[107819, 2821, 507, 8, 58, "Chapter",ExpressionUUID->"2b0c5ecf-637e-42d4-8c72-c549a93b78a3",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[108351, 2833, 390, 7, 66, "Section",ExpressionUUID->"94820fe4-9ed1-49db-9902-baab0aff5d85",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[108744, 2842, 4018, 85, 217, "Input",ExpressionUUID->"326b39eb-4dc5-4af4-9b14-cae30fe2ccc8",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[112787, 2931, 248, 5, 54, "Subsection",ExpressionUUID->"242c9d2b-8dc7-4cea-b5e4-45807660d765",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[113038, 2938, 15319, 360, 542, "Input",ExpressionUUID->"c68655f5-4ba7-45b7-a70e-eb18f7ab3776",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[128360, 3300, 248, 4, 33, "Input",ExpressionUUID->"2ea69e6b-61be-4500-8f1b-6304499ba3b9",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[128645, 3309, 402, 9, 54, "Subsection",ExpressionUUID->"14a3864a-8923-4412-bbcd-65b446371328",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[129050, 3320, 23375, 595, 898, "Input",ExpressionUUID->"efd77778-60aa-478f-b3d8-cf711a70f74f",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[152486, 3922, 206, 4, 66, "Chapter",ExpressionUUID->"3fad0b29-bda7-4b7e-8f8e-8517f7262dd1",
   CellTags->"Number-of-events-computation"],
  Cell[152717, 3930, 233, 5, 66, "Section",ExpressionUUID->"418b0952-2e9a-456b-a8ef-78547bcc5f0b",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[152975, 3939, 291, 7, 54, "Subsection",ExpressionUUID->"db5e4d17-f371-4aa3-8311-31007c7c1c41",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[153269, 3948, 8017, 205, 310, "Input",ExpressionUUID->"2f3d25d9-523e-4ee7-93f7-08039734efda",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[161323, 4158, 276, 5, 54, "Subsection",ExpressionUUID->"1b7a61a8-6485-4f40-a96e-fbb6bbf90301",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[161602, 4165, 9307, 236, 343, "Input",ExpressionUUID->"565a3fe4-60a3-4b63-bfc4-6e9b716a7fca",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[170946, 4406, 351, 8, 54, "Subsection",ExpressionUUID->"847d1c02-0635-4180-9069-8105322cce45",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[171322, 4418, 266, 5, 47, "Subsubsection",ExpressionUUID->"4c4d35f9-dd2c-4ef6-a8e7-31ec43e57227",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[171591, 4425, 6614, 164, 287, "Input",ExpressionUUID->"1eaf7d72-f752-41c9-9222-5542316adcef",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[178242, 4594, 320, 6, 47, "Subsubsection",ExpressionUUID->"75be5dca-64c8-4035-a075-babcc12d6bf0",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[178565, 4602, 6067, 143, 300, "Input",ExpressionUUID->"ef90f43e-a66a-49d5-8cc7-9e859d3b6b45",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[184669, 4750, 267, 6, 47, "Subsubsection",ExpressionUUID->"d7b4ef26-0c39-4d8c-a90d-581ad642651d",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[184939, 4758, 3740, 83, 247, "Input",ExpressionUUID->"0454e6e6-ecf7-490a-b55d-33c2c8a9a71c",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[188740, 4848, 333, 6, 55, "Section",ExpressionUUID->"b70d3573-fb66-4ce2-b91a-09b310ff32c9",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[189076, 4856, 14851, 383, 429, "Input",ExpressionUUID->"9aa543f6-150b-4691-842b-5745bb235721",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[203952, 5243, 272, 5, 54, "Subsection",ExpressionUUID->"67b88b6c-892c-46ab-8d4a-4354be07db4e",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[204249, 5252, 237, 5, 47, "Subsubsection",ExpressionUUID->"132302de-53b0-4056-aa25-a58f622fce52",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[204489, 5259, 4688, 118, 196, "Input",ExpressionUUID->"09cc2475-50a1-4ddb-aa78-137d9bf9521a",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[209238, 5384, 206, 4, 66, "Section",ExpressionUUID->"73f205b8-f71d-465d-9625-478487a24f75",
   CellTags->"Number-of-events-computation"],
  Cell[209469, 5392, 197, 4, 54, "Subsection",ExpressionUUID->"e4770abc-19fe-4cf6-825a-246b07470464",
   CellTags->"Number-of-events-computation"],
  Cell[209669, 5398, 4794, 112, 173, "Input",ExpressionUUID->"e6e962c0-2232-405b-b3c7-28d2dc549e27",
   CellTags->"Number-of-events-computation"],
  Cell[214500, 5515, 269, 6, 54, "Subsection",ExpressionUUID->"050324e4-707f-48bd-b9d9-3866d31d4b7b",
   CellTags->"Number-of-events-computation"],
  Cell[214772, 5523, 5136, 128, 160, "Input",ExpressionUUID->"c6c0066d-7176-4c92-8c9d-56b5e6e223d9",
   CellTags->"Number-of-events-computation"],
  Cell[219933, 5655, 202, 4, 47, "Subsubsection",ExpressionUUID->"dc966617-dbbe-4e9b-933e-15e892d12356",
   CellTags->"Number-of-events-computation"],
  Cell[220138, 5661, 8165, 197, 234, "Input",ExpressionUUID->"4293c3a7-1543-42f2-9c2b-e9669e08df1c",
   CellTags->"Number-of-events-computation"],
  Cell[228352, 5864, 220, 4, 54, "Subsection",ExpressionUUID->"7c6afd69-2676-4e30-bbef-f9e1c59327e2",
   CellTags->"Number-of-events-computation"],
  Cell[228575, 5870, 21843, 534, 849, "Input",ExpressionUUID->"8fdfedd9-98d6-4880-a73b-5685858a03c6",
   CellTags->"Number-of-events-computation"],
  Cell[250491, 6412, 250, 5, 89, "Title",ExpressionUUID->"e88c37c1-5672-42b0-a672-f37f37980725",
   CellTags->"Number-of-events-computation"],
  Cell[250766, 6421, 201, 4, 66, "Chapter",ExpressionUUID->"467731da-736f-4990-a383-f7a9634caf34",
   CellTags->"Number-of-events-computation"],
  Cell[250970, 6427, 8073, 181, 289, "Input",ExpressionUUID->"174ebf85-9857-4386-8470-e65a5626569a",
   CellTags->"Number-of-events-computation"],
  Cell[259080, 6613, 197, 4, 66, "Chapter",ExpressionUUID->"5f5b828d-8b4c-4810-b7e1-40220dc731f8",
   CellTags->"Number-of-events-computation"],
  Cell[259302, 6621, 209, 4, 66, "Section",ExpressionUUID->"44858871-cd0c-4847-b635-72be80b9d716",
   CellTags->"Number-of-events-computation"],
  Cell[259514, 6627, 3194, 71, 126, "Input",ExpressionUUID->"424f3dc4-256b-4d2e-b60e-346e465a221e",
   CellTags->"Number-of-events-computation"],
  Cell[262745, 6703, 463, 8, 66, "Section",ExpressionUUID->"2f9a7d64-af54-475f-aa75-4450513f3b90",
   CellTags->"Number-of-events-computation"],
  Cell[263211, 6713, 1171, 20, 33, "Input",ExpressionUUID->"c77110e8-a24e-4c88-ad89-111bc65c6742",
   CellTags->"Number-of-events-computation"],
  Cell[264419, 6738, 453, 12, 66, "Section",ExpressionUUID->"a041b4eb-6c23-4e7e-acf2-26da09bed5bd",
   CellTags->"Number-of-events-computation"],
  Cell[264875, 6752, 1161, 20, 37, "Input",ExpressionUUID->"63096b32-8586-4512-b56f-3c17a6bf2970",
   CellTags->"Number-of-events-computation"],
  Cell[266073, 6777, 305, 6, 66, "Section",ExpressionUUID->"e5d55d54-2ef1-4ca0-8c57-a5bf7891d57a",
   CellTags->"Number-of-events-computation"],
  Cell[266381, 6785, 1135, 19, 33, "Input",ExpressionUUID->"599da06f-0910-49a0-b917-1e643ca8f020",
   CellTags->"Number-of-events-computation"],
  Cell[267553, 6809, 372, 6, 66, "Section",ExpressionUUID->"460821e0-fe26-4568-9a11-ecfd96998e58",
   CellTags->"Number-of-events-computation"],
  Cell[267928, 6817, 1114, 19, 33, "Input",ExpressionUUID->"493c5b24-1484-45e7-a56d-461c1340dbc7",
   CellTags->"Number-of-events-computation"],
  Cell[269079, 6841, 403, 7, 66, "Section",ExpressionUUID->"61e408ed-b1d0-40c3-920b-811b280dd11b",
   CellTags->"Number-of-events-computation"],
  Cell[269485, 6850, 1263, 21, 33, "Input",ExpressionUUID->"200de915-86bb-4415-8b82-8f9668a26856",
   CellTags->"Number-of-events-computation"],
  Cell[270785, 6876, 410, 7, 66, "Section",ExpressionUUID->"3896d254-eb64-406f-b10e-f44b00c42fd6",
   CellTags->"Number-of-events-computation"],
  Cell[271198, 6885, 1164, 19, 33, "Input",ExpressionUUID->"d3f683e3-6a2f-4fcd-a632-06bfa20799c6",
   CellTags->"Number-of-events-computation"]},
 "Acceptance-computation"->{
  Cell[90346, 2339, 321, 6, 66, "Chapter",ExpressionUUID->"3bf68ab5-5da5-4e0e-a052-8e2595821946",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[90670, 2347, 17112, 469, 656, "Input",ExpressionUUID->"3a5a6575-80ee-4cc7-9603-1ec1f7d2d73e",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[107819, 2821, 507, 8, 58, "Chapter",ExpressionUUID->"2b0c5ecf-637e-42d4-8c72-c549a93b78a3",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[108351, 2833, 390, 7, 66, "Section",ExpressionUUID->"94820fe4-9ed1-49db-9902-baab0aff5d85",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[108744, 2842, 4018, 85, 217, "Input",ExpressionUUID->"326b39eb-4dc5-4af4-9b14-cae30fe2ccc8",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[112787, 2931, 248, 5, 54, "Subsection",ExpressionUUID->"242c9d2b-8dc7-4cea-b5e4-45807660d765",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[113038, 2938, 15319, 360, 542, "Input",ExpressionUUID->"c68655f5-4ba7-45b7-a70e-eb18f7ab3776",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[128360, 3300, 248, 4, 33, "Input",ExpressionUUID->"2ea69e6b-61be-4500-8f1b-6304499ba3b9",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[128645, 3309, 402, 9, 54, "Subsection",ExpressionUUID->"14a3864a-8923-4412-bbcd-65b446371328",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[129050, 3320, 23375, 595, 898, "Input",ExpressionUUID->"efd77778-60aa-478f-b3d8-cf711a70f74f",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[152717, 3930, 233, 5, 66, "Section",ExpressionUUID->"418b0952-2e9a-456b-a8ef-78547bcc5f0b",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[152975, 3939, 291, 7, 54, "Subsection",ExpressionUUID->"db5e4d17-f371-4aa3-8311-31007c7c1c41",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[153269, 3948, 8017, 205, 310, "Input",ExpressionUUID->"2f3d25d9-523e-4ee7-93f7-08039734efda",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[161323, 4158, 276, 5, 54, "Subsection",ExpressionUUID->"1b7a61a8-6485-4f40-a96e-fbb6bbf90301",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[161602, 4165, 9307, 236, 343, "Input",ExpressionUUID->"565a3fe4-60a3-4b63-bfc4-6e9b716a7fca",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[170946, 4406, 351, 8, 54, "Subsection",ExpressionUUID->"847d1c02-0635-4180-9069-8105322cce45",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[171322, 4418, 266, 5, 47, "Subsubsection",ExpressionUUID->"4c4d35f9-dd2c-4ef6-a8e7-31ec43e57227",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[171591, 4425, 6614, 164, 287, "Input",ExpressionUUID->"1eaf7d72-f752-41c9-9222-5542316adcef",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[178242, 4594, 320, 6, 47, "Subsubsection",ExpressionUUID->"75be5dca-64c8-4035-a075-babcc12d6bf0",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[178565, 4602, 6067, 143, 300, "Input",ExpressionUUID->"ef90f43e-a66a-49d5-8cc7-9e859d3b6b45",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[184669, 4750, 267, 6, 47, "Subsubsection",ExpressionUUID->"d7b4ef26-0c39-4d8c-a90d-581ad642651d",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[184939, 4758, 3740, 83, 247, "Input",ExpressionUUID->"0454e6e6-ecf7-490a-b55d-33c2c8a9a71c",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[188740, 4848, 333, 6, 55, "Section",ExpressionUUID->"b70d3573-fb66-4ce2-b91a-09b310ff32c9",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[189076, 4856, 14851, 383, 429, "Input",ExpressionUUID->"9aa543f6-150b-4691-842b-5745bb235721",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[203952, 5243, 272, 5, 54, "Subsection",ExpressionUUID->"67b88b6c-892c-46ab-8d4a-4354be07db4e",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[204249, 5252, 237, 5, 47, "Subsubsection",ExpressionUUID->"132302de-53b0-4056-aa25-a58f622fce52",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
  Cell[204489, 5259, 4688, 118, 196, "Input",ExpressionUUID->"09cc2475-50a1-4ddb-aa78-137d9bf9521a",
   CellTags->{"Number-of-events-computation", "Acceptance-computation"}]},
 "Sensitivity"->{
  Cell[272423, 6911, 212, 4, 69, "Title",ExpressionUUID->"b325d0e7-8149-4766-b60a-f8bf01de77e1",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[272660, 6919, 325, 7, 66, "Chapter",ExpressionUUID->"45591364-b684-40cc-bddc-205fa3d2c3f1",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[272988, 6928, 14760, 392, 681, "Input",ExpressionUUID->"df4d9c4d-9d21-44e6-a82d-5888c4707675",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[287773, 7324, 264, 5, 66, "Section",ExpressionUUID->"266e00eb-c0b0-4e4d-b15a-43e3f24ebbdf",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[288040, 7331, 4814, 119, 141, "Input",ExpressionUUID->"f973800a-aeba-4984-a6dc-1e86d5e8f2bd",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[292903, 7456, 219, 4, 66, "Chapter",ExpressionUUID->"259adc86-d81a-4351-8fcc-3f984b19bc2e",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[293125, 7462, 13692, 345, 540, "Input",ExpressionUUID->"19c4a6cb-9ddf-48b5-a0fe-0c09ba565a1a",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[306866, 7813, 218, 4, 89, "Title",ExpressionUUID->"0d9909f6-9490-4d2d-8202-096c8dd291ea",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[307087, 7819, 2629, 65, 187, "Input",ExpressionUUID->"279ad324-a369-4e15-9b38-d3bd7b52a2a6",
   CellTags->{"Sensitivity", "Re-evaluation"}]},
 "Re-evaluation"->{
  Cell[272423, 6911, 212, 4, 69, "Title",ExpressionUUID->"b325d0e7-8149-4766-b60a-f8bf01de77e1",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[272660, 6919, 325, 7, 66, "Chapter",ExpressionUUID->"45591364-b684-40cc-bddc-205fa3d2c3f1",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[272988, 6928, 14760, 392, 681, "Input",ExpressionUUID->"df4d9c4d-9d21-44e6-a82d-5888c4707675",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[287773, 7324, 264, 5, 66, "Section",ExpressionUUID->"266e00eb-c0b0-4e4d-b15a-43e3f24ebbdf",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[288040, 7331, 4814, 119, 141, "Input",ExpressionUUID->"f973800a-aeba-4984-a6dc-1e86d5e8f2bd",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[292903, 7456, 219, 4, 66, "Chapter",ExpressionUUID->"259adc86-d81a-4351-8fcc-3f984b19bc2e",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[293125, 7462, 13692, 345, 540, "Input",ExpressionUUID->"19c4a6cb-9ddf-48b5-a0fe-0c09ba565a1a",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[306866, 7813, 218, 4, 89, "Title",ExpressionUUID->"0d9909f6-9490-4d2d-8202-096c8dd291ea",
   CellTags->{"Sensitivity", "Re-evaluation"}],
  Cell[307087, 7819, 2629, 65, 187, "Input",ExpressionUUID->"279ad324-a369-4e15-9b38-d3bd7b52a2a6",
   CellTags->{"Sensitivity", "Re-evaluation"}]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Number-of-events", 310145, 7900},
 {"Number-of-events-computation", 313510, 7951},
 {"Acceptance-computation", 322501, 8064},
 {"Sensitivity", 327253, 8119},
 {"Re-evaluation", 328602, 8138}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 207, 3, 78, "Title",ExpressionUUID->"f98d21ab-2805-4064-81d3-17ebb7a0a0ef"],
Cell[790, 27, 4848, 124, 314, "Input",ExpressionUUID->"f63b9531-20f4-416c-88e5-4505a63d238e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5675, 156, 283, 5, 89, "Title",ExpressionUUID->"eeccabcd-0c15-4514-9558-c56b32930132",
 CellTags->"Number-of-events"],
Cell[CellGroupData[{
Cell[5983, 165, 214, 4, 66, "Chapter",ExpressionUUID->"b0daed8d-c809-4422-9ee4-6612c9305a11",
 CellTags->"Number-of-events"],
Cell[6200, 171, 6100, 163, 480, "Input",ExpressionUUID->"50979767-da80-48f9-b503-a276bde193fb",
 CellTags->"Number-of-events"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12337, 339, 343, 5, 66, "Chapter",ExpressionUUID->"059f5520-6181-4a09-92d4-f731378eccca",
 CellTags->"Number-of-events"],
Cell[CellGroupData[{
Cell[12705, 348, 180, 3, 66, "Section",ExpressionUUID->"25c60688-e782-46f3-9845-f0ddefe385dd",
 CellTags->"Number-of-events"],
Cell[12888, 353, 7907, 199, 417, "Input",ExpressionUUID->"7f5d8f66-2da9-4671-940a-c53ba14987fb",
 CellTags->"Number-of-events"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20832, 557, 302, 5, 66, "Section",ExpressionUUID->"758fdb70-8fc0-4950-9280-a0db48e98f7d",
 CellTags->"Number-of-events"],
Cell[CellGroupData[{
Cell[21159, 566, 195, 3, 54, "Subsection",ExpressionUUID->"7a963466-3bc9-4e72-90f4-e32dd6169f27",
 CellTags->"Number-of-events"],
Cell[CellGroupData[{
Cell[21379, 573, 271, 4, 47, "Subsubsection",ExpressionUUID->"c956b9b9-02cf-4bba-b3b1-70f5c90d674b",
 CellTags->"Number-of-events"],
Cell[21653, 579, 8250, 214, 381, "Input",ExpressionUUID->"4edbb780-206f-46e2-a0d6-f6e3f1acde51",
 CellTags->"Number-of-events"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29940, 798, 208, 3, 47, "Subsubsection",ExpressionUUID->"c4747bba-72ee-43ee-8fc9-5627f0d94a94",
 CellTags->"Number-of-events"],
Cell[30151, 803, 22280, 554, 1000, "Input",ExpressionUUID->"396a3a98-4364-49a7-b52d-e1e8f4a5d79e",
 CellTags->"Number-of-events"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[52480, 1363, 257, 5, 54, "Subsection",ExpressionUUID->"02e50908-da43-47aa-a1ba-caa52cc8b93c",
 CellTags->"Number-of-events"],
Cell[52740, 1370, 6729, 178, 283, "Input",ExpressionUUID->"8d814f01-b0dd-4f8a-9760-73e57faaeabe",
 CellTags->"Number-of-events"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59506, 1553, 188, 3, 54, "Subsection",ExpressionUUID->"19f885f5-e34f-4c81-b419-80a9a356d56c",
 CellTags->"Number-of-events"],
Cell[59697, 1558, 5305, 129, 215, "Input",ExpressionUUID->"5c368474-a50e-4442-ac88-0d8dba43c47f",
 CellTags->"Number-of-events"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[65063, 1694, 245, 5, 66, "Chapter",ExpressionUUID->"1b378212-4ed2-4d4c-8d36-a259eabd1c69",
 CellTags->"Number-of-events"],
Cell[CellGroupData[{
Cell[65333, 1703, 239, 4, 54, "Subsection",ExpressionUUID->"0a03eb70-f700-40ba-bcf8-ed45270cc911",
 CellTags->"Number-of-events"],
Cell[65575, 1709, 7659, 184, 234, "Input",ExpressionUUID->"af307eea-4f87-4f93-bef6-910257d2885a",
 CellTags->"Number-of-events"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73271, 1898, 240, 4, 54, "Subsection",ExpressionUUID->"8d9498ec-3be6-4cde-a641-d92e2914033a",
 CellTags->"Number-of-events"],
Cell[73514, 1904, 7512, 182, 234, "Input",ExpressionUUID->"8aae74ab-0b98-486f-b29e-af2b72cca351",
 CellTags->"Number-of-events"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[81087, 2093, 201, 3, 69, "Title",ExpressionUUID->"968fa4f0-ff0e-49b5-9961-c8c532a97325",
 CellTags->"Number-of-events"],
Cell[81291, 2098, 6651, 171, 371, "Input",ExpressionUUID->"c8579664-56cf-4aa3-a66d-4bb791136bbc",
 CellTags->"Number-of-events"],
Cell[CellGroupData[{
Cell[87967, 2273, 204, 3, 66, "Chapter",ExpressionUUID->"fe521a3b-3582-49b1-81f8-e7d0eb93e787",
 CellTags->"Number-of-events"],
Cell[88174, 2278, 1894, 47, 248, "Input",ExpressionUUID->"5523c656-a023-44f0-81eb-5c9ec9f88388",
 CellTags->"Number-of-events"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[90117, 2331, 204, 4, 89, "Title",ExpressionUUID->"ce2dc008-ba4c-4a1a-8777-34a2b932d2e7",
 CellTags->"Number-of-events-computation"],
Cell[CellGroupData[{
Cell[90346, 2339, 321, 6, 66, "Chapter",ExpressionUUID->"3bf68ab5-5da5-4e0e-a052-8e2595821946",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[90670, 2347, 17112, 469, 656, "Input",ExpressionUUID->"3a5a6575-80ee-4cc7-9603-1ec1f7d2d73e",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Closed]],
Cell[CellGroupData[{
Cell[107819, 2821, 507, 8, 58, "Chapter",ExpressionUUID->"2b0c5ecf-637e-42d4-8c72-c549a93b78a3",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[108351, 2833, 390, 7, 66, "Section",ExpressionUUID->"94820fe4-9ed1-49db-9902-baab0aff5d85",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[108744, 2842, 4018, 85, 217, "Input",ExpressionUUID->"326b39eb-4dc5-4af4-9b14-cae30fe2ccc8",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[112787, 2931, 248, 5, 54, "Subsection",ExpressionUUID->"242c9d2b-8dc7-4cea-b5e4-45807660d765",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[113038, 2938, 15319, 360, 542, "Input",ExpressionUUID->"c68655f5-4ba7-45b7-a70e-eb18f7ab3776",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[128360, 3300, 248, 4, 33, "Input",ExpressionUUID->"2ea69e6b-61be-4500-8f1b-6304499ba3b9",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[128645, 3309, 402, 9, 54, "Subsection",ExpressionUUID->"14a3864a-8923-4412-bbcd-65b446371328",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[129050, 3320, 23375, 595, 898, "Input",ExpressionUUID->"efd77778-60aa-478f-b3d8-cf711a70f74f",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[152486, 3922, 206, 4, 66, "Chapter",ExpressionUUID->"3fad0b29-bda7-4b7e-8f8e-8517f7262dd1",
 CellTags->"Number-of-events-computation"],
Cell[CellGroupData[{
Cell[152717, 3930, 233, 5, 66, "Section",ExpressionUUID->"418b0952-2e9a-456b-a8ef-78547bcc5f0b",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[152975, 3939, 291, 7, 54, "Subsection",ExpressionUUID->"db5e4d17-f371-4aa3-8311-31007c7c1c41",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[153269, 3948, 8017, 205, 310, "Input",ExpressionUUID->"2f3d25d9-523e-4ee7-93f7-08039734efda",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[161323, 4158, 276, 5, 54, "Subsection",ExpressionUUID->"1b7a61a8-6485-4f40-a96e-fbb6bbf90301",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[161602, 4165, 9307, 236, 343, "Input",ExpressionUUID->"565a3fe4-60a3-4b63-bfc4-6e9b716a7fca",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[170946, 4406, 351, 8, 54, "Subsection",ExpressionUUID->"847d1c02-0635-4180-9069-8105322cce45",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[171322, 4418, 266, 5, 47, "Subsubsection",ExpressionUUID->"4c4d35f9-dd2c-4ef6-a8e7-31ec43e57227",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[171591, 4425, 6614, 164, 287, "Input",ExpressionUUID->"1eaf7d72-f752-41c9-9222-5542316adcef",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[178242, 4594, 320, 6, 47, "Subsubsection",ExpressionUUID->"75be5dca-64c8-4035-a075-babcc12d6bf0",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[178565, 4602, 6067, 143, 300, "Input",ExpressionUUID->"ef90f43e-a66a-49d5-8cc7-9e859d3b6b45",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]],
Cell[CellGroupData[{
Cell[184669, 4750, 267, 6, 47, "Subsubsection",ExpressionUUID->"d7b4ef26-0c39-4d8c-a90d-581ad642651d",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[184939, 4758, 3740, 83, 247, "Input",ExpressionUUID->"0454e6e6-ecf7-490a-b55d-33c2c8a9a71c",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[188740, 4848, 333, 6, 55, "Section",ExpressionUUID->"b70d3573-fb66-4ce2-b91a-09b310ff32c9",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[189076, 4856, 14851, 383, 429, "Input",ExpressionUUID->"9aa543f6-150b-4691-842b-5745bb235721",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[203952, 5243, 272, 5, 54, "Subsection",ExpressionUUID->"67b88b6c-892c-46ab-8d4a-4354be07db4e",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[CellGroupData[{
Cell[204249, 5252, 237, 5, 47, "Subsubsection",ExpressionUUID->"132302de-53b0-4056-aa25-a58f622fce52",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}],
Cell[204489, 5259, 4688, 118, 196, "Input",ExpressionUUID->"09cc2475-50a1-4ddb-aa78-137d9bf9521a",
 CellTags->{"Number-of-events-computation", "Acceptance-computation"}]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[209238, 5384, 206, 4, 66, "Section",ExpressionUUID->"73f205b8-f71d-465d-9625-478487a24f75",
 CellTags->"Number-of-events-computation"],
Cell[CellGroupData[{
Cell[209469, 5392, 197, 4, 54, "Subsection",ExpressionUUID->"e4770abc-19fe-4cf6-825a-246b07470464",
 CellTags->"Number-of-events-computation"],
Cell[209669, 5398, 4794, 112, 173, "Input",ExpressionUUID->"e6e962c0-2232-405b-b3c7-28d2dc549e27",
 CellTags->"Number-of-events-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[214500, 5515, 269, 6, 54, "Subsection",ExpressionUUID->"050324e4-707f-48bd-b9d9-3866d31d4b7b",
 CellTags->"Number-of-events-computation"],
Cell[214772, 5523, 5136, 128, 160, "Input",ExpressionUUID->"c6c0066d-7176-4c92-8c9d-56b5e6e223d9",
 CellTags->"Number-of-events-computation"],
Cell[CellGroupData[{
Cell[219933, 5655, 202, 4, 47, "Subsubsection",ExpressionUUID->"dc966617-dbbe-4e9b-933e-15e892d12356",
 CellTags->"Number-of-events-computation"],
Cell[220138, 5661, 8165, 197, 234, "Input",ExpressionUUID->"4293c3a7-1543-42f2-9c2b-e9669e08df1c",
 CellTags->"Number-of-events-computation"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[228352, 5864, 220, 4, 54, "Subsection",ExpressionUUID->"7c6afd69-2676-4e30-bbef-f9e1c59327e2",
 CellTags->"Number-of-events-computation"],
Cell[228575, 5870, 21843, 534, 849, "Input",ExpressionUUID->"8fdfedd9-98d6-4880-a73b-5685858a03c6",
 CellTags->"Number-of-events-computation"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[250491, 6412, 250, 5, 89, "Title",ExpressionUUID->"e88c37c1-5672-42b0-a672-f37f37980725",
 CellTags->"Number-of-events-computation"],
Cell[CellGroupData[{
Cell[250766, 6421, 201, 4, 66, "Chapter",ExpressionUUID->"467731da-736f-4990-a383-f7a9634caf34",
 CellTags->"Number-of-events-computation"],
Cell[250970, 6427, 8073, 181, 289, "Input",ExpressionUUID->"174ebf85-9857-4386-8470-e65a5626569a",
 CellTags->"Number-of-events-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[259080, 6613, 197, 4, 66, "Chapter",ExpressionUUID->"5f5b828d-8b4c-4810-b7e1-40220dc731f8",
 CellTags->"Number-of-events-computation"],
Cell[CellGroupData[{
Cell[259302, 6621, 209, 4, 66, "Section",ExpressionUUID->"44858871-cd0c-4847-b635-72be80b9d716",
 CellTags->"Number-of-events-computation"],
Cell[259514, 6627, 3194, 71, 126, "Input",ExpressionUUID->"424f3dc4-256b-4d2e-b60e-346e465a221e",
 CellTags->"Number-of-events-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[262745, 6703, 463, 8, 66, "Section",ExpressionUUID->"2f9a7d64-af54-475f-aa75-4450513f3b90",
 CellTags->"Number-of-events-computation"],
Cell[263211, 6713, 1171, 20, 33, "Input",ExpressionUUID->"c77110e8-a24e-4c88-ad89-111bc65c6742",
 CellTags->"Number-of-events-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[264419, 6738, 453, 12, 66, "Section",ExpressionUUID->"a041b4eb-6c23-4e7e-acf2-26da09bed5bd",
 CellTags->"Number-of-events-computation"],
Cell[264875, 6752, 1161, 20, 37, "Input",ExpressionUUID->"63096b32-8586-4512-b56f-3c17a6bf2970",
 CellTags->"Number-of-events-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[266073, 6777, 305, 6, 66, "Section",ExpressionUUID->"e5d55d54-2ef1-4ca0-8c57-a5bf7891d57a",
 CellTags->"Number-of-events-computation"],
Cell[266381, 6785, 1135, 19, 33, "Input",ExpressionUUID->"599da06f-0910-49a0-b917-1e643ca8f020",
 CellTags->"Number-of-events-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[267553, 6809, 372, 6, 66, "Section",ExpressionUUID->"460821e0-fe26-4568-9a11-ecfd96998e58",
 CellTags->"Number-of-events-computation"],
Cell[267928, 6817, 1114, 19, 33, "Input",ExpressionUUID->"493c5b24-1484-45e7-a56d-461c1340dbc7",
 CellTags->"Number-of-events-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[269079, 6841, 403, 7, 66, "Section",ExpressionUUID->"61e408ed-b1d0-40c3-920b-811b280dd11b",
 CellTags->"Number-of-events-computation"],
Cell[269485, 6850, 1263, 21, 33, "Input",ExpressionUUID->"200de915-86bb-4415-8b82-8f9668a26856",
 CellTags->"Number-of-events-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[270785, 6876, 410, 7, 66, "Section",ExpressionUUID->"3896d254-eb64-406f-b10e-f44b00c42fd6",
 CellTags->"Number-of-events-computation"],
Cell[271198, 6885, 1164, 19, 33, "Input",ExpressionUUID->"d3f683e3-6a2f-4fcd-a632-06bfa20799c6",
 CellTags->"Number-of-events-computation"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[272423, 6911, 212, 4, 69, "Title",ExpressionUUID->"b325d0e7-8149-4766-b60a-f8bf01de77e1",
 CellTags->{"Sensitivity", "Re-evaluation"}],
Cell[CellGroupData[{
Cell[272660, 6919, 325, 7, 66, "Chapter",ExpressionUUID->"45591364-b684-40cc-bddc-205fa3d2c3f1",
 CellTags->{"Sensitivity", "Re-evaluation"}],
Cell[272988, 6928, 14760, 392, 681, "Input",ExpressionUUID->"df4d9c4d-9d21-44e6-a82d-5888c4707675",
 CellTags->{"Sensitivity", "Re-evaluation"}],
Cell[CellGroupData[{
Cell[287773, 7324, 264, 5, 66, "Section",ExpressionUUID->"266e00eb-c0b0-4e4d-b15a-43e3f24ebbdf",
 CellTags->{"Sensitivity", "Re-evaluation"}],
Cell[288040, 7331, 4814, 119, 141, "Input",ExpressionUUID->"f973800a-aeba-4984-a6dc-1e86d5e8f2bd",
 CellTags->{"Sensitivity", "Re-evaluation"}]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[292903, 7456, 219, 4, 66, "Chapter",ExpressionUUID->"259adc86-d81a-4351-8fcc-3f984b19bc2e",
 CellTags->{"Sensitivity", "Re-evaluation"}],
Cell[293125, 7462, 13692, 345, 540, "Input",ExpressionUUID->"19c4a6cb-9ddf-48b5-a0fe-0c09ba565a1a",
 CellTags->{"Sensitivity", "Re-evaluation"}]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[306866, 7813, 218, 4, 89, "Title",ExpressionUUID->"0d9909f6-9490-4d2d-8202-096c8dd291ea",
 CellTags->{"Sensitivity", "Re-evaluation"}],
Cell[307087, 7819, 2629, 65, 187, "Input",ExpressionUUID->"279ad324-a369-4e15-9b38-d3bd7b52a2a6",
 CellTags->{"Sensitivity", "Re-evaluation"}]
}, Open  ]]
}
]
*)

